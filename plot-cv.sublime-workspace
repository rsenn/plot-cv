{
	"auto_complete":
	{
		"selected_items":
		[
			[
				"Extra",
				"ExtractRotation"
			],
			[
				"tra",
				"transformation"
			],
			[
				"define",
				"defineProperties"
			],
			[
				"getters",
				"gettersSetters"
			],
			[
				"circui",
				"circuitFilePath"
			],
			[
				"Conn",
				"ConnectionPoint"
			],
			[
				"parseCom",
				"parseCommentOrEmpty"
			],
			[
				"circ",
				"circuitFilePath"
			],
			[
				"built",
				"builtin_attr"
			],
			[
				"dep",
				"depthOrPred"
			],
			[
				"exte",
				"extendAsyncGenerator"
			],
			[
				"extend",
				"extendArray"
			],
			[
				"allo",
				"allowedDirs"
			],
			[
				"getOwnPr",
				"getOwnPropertyNames(...)"
			],
			[
				"Prom",
				"PromiseWorker"
			],
			[
				"trans",
				"transformation"
			],
			[
				"allow",
				"allowedDirs"
			],
			[
				"Get",
				"GetElementsBySignal"
			],
			[
				"GetEle",
				"GetElementsBySignal"
			],
			[
				"getOwn",
				"getOwnPropertyNames(...)"
			],
			[
				"ColorSi",
				"ColorSignals"
			],
			[
				"HTML",
				"HTMLTableRow"
			],
			[
				"HTMLTable",
				"HTMLTableColumn"
			],
			[
				"rend",
				"renderToString"
			],
			[
				"Pack",
				"Package2Circuit"
			],
			[
				"lazyP",
				"lazyProperties"
			],
			[
				"JS_Get",
				"JS_GetProperty"
			],
			[
				"Ret",
				"ReturnValuePathFunction"
			],
			[
				"cFunc",
				"cFuncListObjects"
			],
			[
				"isC",
				"isCFuncCall"
			],
			[
				"En",
				"EntityNames"
			],
			[
				"parseFrom",
				"parseFromString"
			],
			[
				"pseu",
				"pseudoClassArg"
			],
			[
				"pseudoC",
				"pseudoClassName"
			],
			[
				"Key",
				"KeyboardEvent"
			],
			[
				"getOp",
				"getOptionEntries"
			],
			[
				"setProp",
				"setPropertyValue"
			],
			[
				"parse",
				"parseSelectors"
			],
			[
				"JS_SetPr",
				"JS_SetPropertyStr"
			],
			[
				"jsm_buil",
				"jsm_builtin_init"
			],
			[
				"JS_Free",
				"JS_FreeCString"
			],
			[
				"JS_Set",
				"JS_SetProperty"
			],
			[
				"JS_New",
				"JS_NewObject"
			],
			[
				"ide",
				"importIdentifiers"
			],
			[
				"iden",
				"importIdentifiers"
			],
			[
				"import",
				"importIdentifiers"
			],
			[
				"ident",
				"identifierSets"
			],
			[
				"path_is",
				"path_is_absolute"
			],
			[
				"js_is_",
				"js_is_null_or_undefined"
			],
			[
				"path_skip_se",
				"path_skip_separator_s"
			],
			[
				"WRITABLE_METHO",
				"WRITABLE_METHOD_CLOSE"
			],
			[
				"list_fo",
				"list_for_each_prev"
			],
			[
				"JS_Th",
				"JS_ThrowOutOfMemory"
			],
			[
				"JS_",
				"JS_ThrowOutOfMemory"
			],
			[
				"underly",
				"underlying_source"
			],
			[
				"Tok",
				"TokenSequence"
			],
			[
				"JS_GetPr",
				"JS_GetPropertyStr"
			],
			[
				"JS_Thro",
				"JS_ThrowOutOfMemory"
			],
			[
				"getAt",
				"getAttributeNames"
			],
			[
				"self",
				"self_closing_tags"
			],
			[
				"self_",
				"self_closing_tags"
			],
			[
				"JS_PROP",
				"JS_PROP_ENUMERABLE"
			],
			[
				"depe",
				"dependencyMap"
			],
			[
				"de",
				"dependencyMap"
			],
			[
				"js_is_null",
				"js_is_null_or_undefined"
			],
			[
				"JS_P",
				"JS_PROP_ENUMERABLE"
			],
			[
				"JS_SetP",
				"JS_SetPropertyUint32"
			],
			[
				"spec",
				"specifiers"
			],
			[
				"Num",
				"NumericRange"
			],
			[
				"token_r",
				"token_release_rt"
			],
			[
				"JS_Thr",
				"JS_ThrowTypeError"
			],
			[
				"js_",
				"js_location_data"
			],
			[
				"debug_js_mall",
				"debug_js_malloc_usable_size"
			],
			[
				"repl",
				"replaceRange"
			],
			[
				"js_malloc_u",
				"js_malloc_usable_size_rt"
			],
			[
				"malloc",
				"malloc_usable_size"
			],
			[
				"all",
				"alloc_block_list"
			],
			[
				"alloc",
				"alloc_block_list"
			],
			[
				"path_skip",
				"path_skip_component"
			],
			[
				"jsm_mo",
				"jsm_module_loader"
			],
			[
				"JS_Throw",
				"JS_ThrowInternalError"
			],
			[
				"JS_AtomTo",
				"JS_AtomToValue"
			],
			[
				"inspect",
				"inspectSymbol"
			],
			[
				"at",
				"attributes"
			],
			[
				"parent",
				"parentElement"
			],
			[
				"owner",
				"ownerElement"
			],
			[
				"get",
				"getPrototypeOf"
			],
			[
				"child",
				"childElementCount"
			],
			[
				"getO",
				"getOwnPropertyNames"
			],
			[
				"js_misc_im",
				"js_misc_immutable_constructor"
			],
			[
				"obj",
				"object_tostring"
			],
			[
				"js_misc_immu",
				"js_misc_immutable_free"
			],
			[
				"js_misc_imm",
				"js_misc_immutable_constructor"
			],
			[
				"CMAKE_IMPORT",
				"CMAKE_IMPORT_LIBRARY_SUFFIX"
			],
			[
				"CMAKE_CUR",
				"CMAKE_CURRENT_BINARY_DIR"
			],
			[
				"js_is",
				"js_is_null_or_undefined"
			],
			[
				"js_asy",
				"js_async_socket_class_id"
			],
			[
				"JS_NewObj",
				"JS_NewObjectProtoClass"
			],
			[
				"async_",
				"async_socket_proto"
			],
			[
				"js_socket_class",
				"js_socket_class_id"
			],
			[
				"g",
				"getOwnPropertyNames(...)"
			],
			[
				"js_sockaddr_cl",
				"js_sockaddr_class_id"
			],
			[
				"js_so",
				"js_sockaddr_constructor"
			],
			[
				"js_sys",
				"js_syscallerror_class_id"
			],
			[
				"js_string",
				"js_stringdecoder_class_id"
			],
			[
				"js_pred",
				"js_predicate_class_id"
			],
			[
				"js_syn",
				"js_syntaxerror_class"
			],
			[
				"js_child",
				"js_child_process_class_id"
			],
			[
				"js_b",
				"js_blob_class_id"
			],
			[
				"js_loca",
				"js_location_class_id"
			],
			[
				"js_token_in",
				"js_token_inspect_funcs"
			],
			[
				"set",
				"setReadHandler"
			],
			[
				"js_get_",
				"js_get_propertystr_bool"
			],
			[
				"js_misc_ate",
				"js_misc_atexit_functions"
			],
			[
				"isF",
				"isFunction"
			],
			[
				"tab",
				"tab_atom_len"
			],
			[
				"isARr",
				"isArrayBuffer"
			],
			[
				"BIT",
				"BITFIELD_FROMARRAY"
			],
			[
				"to",
				"toStringTag"
			],
			[
				"inotify",
				"inotify_add_watch"
			],
			[
				"JS_SetProp",
				"JS_SetPropertyUint32"
			],
			[
				"JS_GEt",
				"JS_GetGlobalObject"
			],
			[
				"dbuf_put",
				"dbuf_put_colorstr"
			],
			[
				"REPEATER_",
				"REPEATER_REJECTED"
			],
			[
				"REP",
				"REPEATER_DONE"
			],
			[
				"resol",
				"resolving_funcs"
			],
			[
				"JS_NEwCFun",
				"JS_NewCFunctionData"
			],
			[
				"js_function",
				"js_function_bind_this"
			]
		]
	},
	"buffers":
	[
		{
			"contents": "  value =>\n  (level, message) =>\nAsyncCollect(iter)\nExecTool(cmd, ...args)\nGetMime(file)\nMatcher(pattern, t = arg => arg)\n  (...args) =>\nKeyOrValueMatcher(pattern)\n  ([key, value]) =>\nGetRootDirectories(pattern = '*')\nMakeUUID = (rng = Math.random) =>\n  n =>\n  dd =>\n  d =>\n  d =>\n  d =>\nGetDir(dir)\n  n =>\nDirName(name)\n  it =>\nDateStr(date)\nModeStr(mode)\nHTMLPage = ({ title, style, scripts = [], children, ...props }) =>\n  script =>\nFilterForm = ({ ...props }) =>\nHTMLTable = ({ rows, ...props }) =>\nHTMLTableRow = ({ columns, ...props }) =>\nHTMLTableColumn = ({ columns, children, tag = 'td', ...props }) =>\nFileLink = ({ file, ...props }) =>\nFileObject = ({ file, stat = {}, ...props }) =>\nFileTable = ({ files, ...props }) =>\n(a, b) =>\n  field =>\n  file =>\nReadExiv2(file)\n([k, v]) =>\n([k, v]) =>\n([k, v]) =>\n(a, b) =>\n([k, v]) =>\nReadExiftool(file)\n  l =>\n  line =>\n([line, idx]) =>\nHeifConvert(src, dst, quality = 100)\nMagickResize(src, dst, rotate = 0, width, height)\n  main(...args)\n  (a, v) =>\n  (v, pv, o) =>\n  (module, ...args) =>\n  m =>\n  .show = arg =>\n  .cleanup = () =>\n  (...args) =>\n() =>\n  puts(s)\n() =>\nParseBody(gen)\n  .createWS = (url, callbacks, listen) =>\n  .out = s =>\n  test(req, resp)\n  proxy(req, resp)\n  config(req, resp)\n  file(req, resp)\n  dir =>\n  f =>\n  file =>\n  uploads(req, resp)\n  s =>\n  files(req, resp)\n  n =>\n([name, type]) =>\n  files2(req, resp)\n  n =>\n  n =>\n  n =>\n(a, b) =>\n  name =>\n  file =>\n  file =>\n([file, rel]) =>\n(acc, [file, st]) =>\n  string(a, b)\n  number(a, b)\n([name, obj]) =>\n({ name }) =>\n  onConnect(ws, req)\n  .sendCommand = function(data)\n  onClose(ws, reason)\n  onHttp(ws, req, resp)\n  onOpen(name, filename)\n  onContent(name, data)\n  onClose(name, file)\n  f = x =>\n  onFinalize()\n  (match, p1, p0, p2, p3, offset) =>\n  onMessage(ws, data)\n  onFd(fd, rd, wr)\n  get connections()\n  get by_uuid()\n  uuid(data)\n  onFd(fd, rd, wr)\n  onClose(ws, reason)\n  onMessage(ws, data)\n  quit(why)",
			"settings":
			{
				"buffer_size": 1945,
				"line_ending": "Unix",
				"name": "ùåÜ Outline",
				"scratch": true
			},
			"undo_stack":
			[
			]
		},
		{
			"file": "upload-server.js",
			"settings":
			{
				"buffer_size": 34600,
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					8,
					1,
					"insert",
					{
						"characters": " |"
					},
					"AgAAAO92AAAAAAAA8HYAAAAAAAAAAAAA8HYAAAAAAADxdgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA73YAAAAAAADvdgAAAAAAAAAAAAAAAPC/"
				],
				[
					9,
					1,
					"left_delete",
					null,
					"AQAAAPB2AAAAAAAA8HYAAAAAAAABAAAAfA",
					"AQAAAAAAAAABAAAA8XYAAAAAAADxdgAAAAAAAAAAAAAAAPC/"
				],
				[
					10,
					1,
					"insert",
					{
						"characters": "??"
					},
					"AgAAAPB2AAAAAAAA8XYAAAAAAAAAAAAA8XYAAAAAAADydgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA8HYAAAAAAADwdgAAAAAAAAAAAAAAAPC/"
				],
				[
					11,
					1,
					"insert",
					{
						"characters": " }{"
					},
					"AwAAAPJ2AAAAAAAA83YAAAAAAAAAAAAA83YAAAAAAAD0dgAAAAAAAAAAAAD0dgAAAAAAAPV2AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA8nYAAAAAAADydgAAAAAAAAAAAAAAAPC/"
				],
				[
					12,
					2,
					"left_delete",
					null,
					"AgAAAPR2AAAAAAAA9HYAAAAAAAABAAAAe/N2AAAAAAAA83YAAAAAAAABAAAAfQ",
					"AQAAAAAAAAABAAAA9XYAAAAAAAD1dgAAAAAAAAAAAAAAAPC/"
				],
				[
					13,
					1,
					"insert",
					{
						"characters": "{}"
					},
					"AgAAAPN2AAAAAAAA9HYAAAAAAAAAAAAA9HYAAAAAAAD1dgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA83YAAAAAAADzdgAAAAAAAAAAAAAAAPC/"
				],
				[
					66,
					1,
					"insert",
					{
						"characters": "\n\n"
					},
					"AgAAAKN2AAAAAAAApHYAAAAAAAAAAAAApHYAAAAAAACldgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAo3YAAAAAAACjdgAAAAAAAAAAAAAAAPC/"
				],
				[
					68,
					1,
					"insert",
					{
						"characters": "if"
					},
					"AgAAAKR2AAAAAAAApXYAAAAAAAAAAAAApXYAAAAAAACmdgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAApHYAAAAAAACkdgAAAAAAAAAAAAAAAAAA"
				],
				[
					69,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAKZ2AAAAAAAAqHYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAApnYAAAAAAACmdgAAAAAAAAAAAAAAAPC/"
				],
				[
					70,
					1,
					"insert",
					{
						"characters": "!req.headers"
					},
					"DAAAAKd2AAAAAAAAqHYAAAAAAAAAAAAAqHYAAAAAAACpdgAAAAAAAAAAAACpdgAAAAAAAKp2AAAAAAAAAAAAAKp2AAAAAAAAq3YAAAAAAAAAAAAAq3YAAAAAAACsdgAAAAAAAAAAAACsdgAAAAAAAK12AAAAAAAAAAAAAK12AAAAAAAArnYAAAAAAAAAAAAArnYAAAAAAACvdgAAAAAAAAAAAACvdgAAAAAAALB2AAAAAAAAAAAAALB2AAAAAAAAsXYAAAAAAAAAAAAAsXYAAAAAAACydgAAAAAAAAAAAACydgAAAAAAALN2AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAp3YAAAAAAACndgAAAAAAAAAAAAAAAPC/"
				],
				[
					72,
					1,
					"insert",
					{
						"characters": "\nconsole.log"
					},
					"DQAAALR2AAAAAAAAtXYAAAAAAAAAAAAAtXYAAAAAAAC3dgAAAAAAAAAAAAC3dgAAAAAAALh2AAAAAAAAAAAAALh2AAAAAAAAuXYAAAAAAAAAAAAAuXYAAAAAAAC6dgAAAAAAAAAAAAC6dgAAAAAAALt2AAAAAAAAAAAAALt2AAAAAAAAvHYAAAAAAAAAAAAAvHYAAAAAAAC9dgAAAAAAAAAAAAC9dgAAAAAAAL52AAAAAAAAAAAAAL52AAAAAAAAv3YAAAAAAAAAAAAAv3YAAAAAAADAdgAAAAAAAAAAAADAdgAAAAAAAMF2AAAAAAAAAAAAAMF2AAAAAAAAwnYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAtHYAAAAAAAC0dgAAAAAAAAAAAAAAAPC/"
				],
				[
					73,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAMJ2AAAAAAAAxHYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAwnYAAAAAAADCdgAAAAAAAAAAAAAAAPC/"
				],
				[
					74,
					1,
					"insert_snippet",
					{
						"contents": "'$0'"
					},
					"AQAAAMN2AAAAAAAAxXYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAw3YAAAAAAADDdgAAAAAAAAAAAAAAAPC/"
				],
				[
					75,
					1,
					"insert",
					{
						"characters": "No"
					},
					"AgAAAMR2AAAAAAAAxXYAAAAAAAAAAAAAxXYAAAAAAADGdgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAxHYAAAAAAADEdgAAAAAAAAAAAAAAAPC/"
				],
				[
					76,
					1,
					"insert",
					{
						"characters": " headers"
					},
					"CAAAAMZ2AAAAAAAAx3YAAAAAAAAAAAAAx3YAAAAAAADIdgAAAAAAAAAAAADIdgAAAAAAAMl2AAAAAAAAAAAAAMl2AAAAAAAAynYAAAAAAAAAAAAAynYAAAAAAADLdgAAAAAAAAAAAADLdgAAAAAAAMx2AAAAAAAAAAAAAMx2AAAAAAAAzXYAAAAAAAAAAAAAzXYAAAAAAADOdgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAxnYAAAAAAADGdgAAAAAAAAAAAAAAAPC/"
				],
				[
					78,
					1,
					"insert",
					{
						"characters": ","
					},
					"AQAAAM92AAAAAAAA0HYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAz3YAAAAAAADPdgAAAAAAAAAAAAAAAPC/"
				],
				[
					79,
					1,
					"insert",
					{
						"characters": " req"
					},
					"BAAAANB2AAAAAAAA0XYAAAAAAAAAAAAA0XYAAAAAAADSdgAAAAAAAAAAAADSdgAAAAAAANN2AAAAAAAAAAAAANN2AAAAAAAA1HYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA0HYAAAAAAADQdgAAAAAAAAAAAAAAAPC/"
				],
				[
					81,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAANV2AAAAAAAA1nYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA1XYAAAAAAADVdgAAAAAAAAAAAAAAAPC/"
				],
				[
					90,
					1,
					"left_delete",
					null,
					"AQAAACN3AAAAAAAAI3cAAAAAAAAGAAAAID8/IHt9",
					"AQAAAAAAAAABAAAAI3cAAAAAAAApdwAAAAAAAAAAAAAAAPC/"
				],
				[
					99,
					2,
					"indent",
					null,
					"BAAAAKR2AAAAAAAApnYAAAAAAAAAAAAAt3YAAAAAAAC5dgAAAAAAAAAAAACkdgAAAAAAAKZ2AAAAAAAAAAAAALl2AAAAAAAAu3YAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAApHYAAAAAAADXdgAAAAAAAAAAAAAAAAAA"
				],
				[
					105,
					2,
					"left_delete",
					null,
					"AgAAALd2AAAAAAAAt3YAAAAAAAABAAAAKbZ2AAAAAAAAtnYAAAAAAAABAAAAcw",
					"AQAAAAAAAAABAAAAuHYAAAAAAAC4dgAAAAAAAP///////+9/"
				],
				[
					106,
					1,
					"insert",
					{
						"characters": "s"
					},
					"AQAAALZ2AAAAAAAAt3YAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAtnYAAAAAAAC2dgAAAAAAAAAAAAAAAPC/"
				],
				[
					107,
					1,
					"insert",
					{
						"characters": " ||"
					},
					"AwAAALd2AAAAAAAAuHYAAAAAAAAAAAAAuHYAAAAAAAC5dgAAAAAAAAAAAAC5dgAAAAAAALp2AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAt3YAAAAAAAC3dgAAAAAAAAAAAAAAAPC/"
				],
				[
					108,
					1,
					"insert",
					{
						"characters": " typeof"
					},
					"BwAAALp2AAAAAAAAu3YAAAAAAAAAAAAAu3YAAAAAAAC8dgAAAAAAAAAAAAC8dgAAAAAAAL12AAAAAAAAAAAAAL12AAAAAAAAvnYAAAAAAAAAAAAAvnYAAAAAAAC/dgAAAAAAAAAAAAC/dgAAAAAAAMB2AAAAAAAAAAAAAMB2AAAAAAAAwXYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAunYAAAAAAAC6dgAAAAAAAAAAAAAAAPC/"
				],
				[
					109,
					1,
					"insert",
					{
						"characters": " req.headers"
					},
					"DAAAAMF2AAAAAAAAwnYAAAAAAAAAAAAAwnYAAAAAAADDdgAAAAAAAAAAAADDdgAAAAAAAMR2AAAAAAAAAAAAAMR2AAAAAAAAxXYAAAAAAAAAAAAAxXYAAAAAAADGdgAAAAAAAAAAAADGdgAAAAAAAMd2AAAAAAAAAAAAAMd2AAAAAAAAyHYAAAAAAAAAAAAAyHYAAAAAAADJdgAAAAAAAAAAAADJdgAAAAAAAMp2AAAAAAAAAAAAAMp2AAAAAAAAy3YAAAAAAAAAAAAAy3YAAAAAAADMdgAAAAAAAAAAAADMdgAAAAAAAM12AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAwXYAAAAAAADBdgAAAAAAAAAAAAAAAPC/"
				],
				[
					110,
					1,
					"insert",
					{
						"characters": " !="
					},
					"AwAAAM12AAAAAAAAznYAAAAAAAAAAAAAznYAAAAAAADPdgAAAAAAAAAAAADPdgAAAAAAANB2AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAzXYAAAAAAADNdgAAAAAAAAAAAAAAAPC/"
				],
				[
					111,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAANB2AAAAAAAA0XYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA0HYAAAAAAADQdgAAAAAAAAAAAAAAAPC/"
				],
				[
					112,
					1,
					"insert_snippet",
					{
						"contents": "'$0'"
					},
					"AQAAANF2AAAAAAAA03YAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA0XYAAAAAAADRdgAAAAAAAAAAAAAAAPC/"
				],
				[
					113,
					1,
					"insert",
					{
						"characters": "object"
					},
					"BgAAANJ2AAAAAAAA03YAAAAAAAAAAAAA03YAAAAAAADUdgAAAAAAAAAAAADUdgAAAAAAANV2AAAAAAAAAAAAANV2AAAAAAAA1nYAAAAAAAAAAAAA1nYAAAAAAADXdgAAAAAAAAAAAADXdgAAAAAAANh2AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA0nYAAAAAAADSdgAAAAAAAAAAAAAAAPC/"
				],
				[
					115,
					1,
					"insert",
					{
						"characters": ")"
					},
					"AQAAANl2AAAAAAAA2nYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA2XYAAAAAAADZdgAAAAAAAAAAAAAAAPC/"
				],
				[
					118,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAAC9hgAAaW1wb3J0ICogYXMgc3RkIGZyb20gJ3N0ZCc7CmltcG9ydCAqIGFzIG9zIGZyb20gJ29zJzsKaW1wb3J0ICogYXMgZGVlcCBmcm9tICcuL2xpYi9kZWVwLmpzJzsKaW1wb3J0ICogYXMgeG1sIGZyb20gJ3htbCc7CmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7CmltcG9ydCB7IENvbnNvbGUgfSBmcm9tICdjb25zb2xlJzsKaW1wb3J0IHsgRGlyZWN0b3J5LCBCT1RILCBUWVBFX0RJUiwgVFlQRV9MTkssIFRZUEVfUkVHLCBUWVBFX01BU0sgfSBmcm9tICdkaXJlY3RvcnknOwppbXBvcnQgUkVQTCBmcm9tICcuL3F1aWNranMvcWpzLW1vZHVsZXMvbGliL3JlcGwuanMnOwppbXBvcnQgaW5zcGVjdCBmcm9tICcuL2xpYi9vYmplY3RJbnNwZWN0LmpzJzsKaW1wb3J0ICogYXMgVGVybWluYWwgZnJvbSAnLi90ZXJtaW5hbC5qcyc7CmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJzsKaW1wb3J0IHsgbGluaywgdW5saW5rLCBlcnJvciwgZm5tYXRjaCwgRk5NX0VYVE1BVENIIH0gZnJvbSAnbWlzYyc7CmltcG9ydCB7IHRvU3RyaW5nLCBkZWZpbmUsIHRvVW5peFRpbWUsIGdldE9wdCwgcmFuZFN0ciwgaXNPYmplY3QsIGlzTnVtZXJpYywgaXNBcnJheUJ1ZmZlciwgZ2xvYiwgR0xPQl9CUkFDRSwgd2FpdEZvciB9IGZyb20gJ3V0aWwnOwppbXBvcnQgeyBzZXRMb2csIExMTF9VU0VSLCBMTExfTk9USUNFLCBMTExfV0FSTiwgTExMX0lORk8sIGNsaWVudCwgc2VydmVyLCBGb3JtUGFyc2VyLCBIYXNoLCBSZXNwb25zZSwgU29ja2V0IH0gZnJvbSAnbmV0JzsKaW1wb3J0IHsgcGFyc2VEYXRlLCBkYXRlVG9PYmplY3QgfSBmcm9tICcuL2RhdGUtaGVscGVycy5qcyc7CmltcG9ydCB7IElmRGVidWcsIExvZ0lmRGVidWcsIFJlYWRGaWxlLCBMb2FkSGlzdG9yeSwgUmVhZEpTT04sIFJlYWRYTUwsIE1hcEZpbGUsIFdyaXRlRmlsZSwgV3JpdGVKU09OLCBXcml0ZVhNTCwgUmVhZEJKU09OLCBXcml0ZUJKU09OLCBEaXJJdGVyYXRvciwgUmVjdXJzaXZlRGlySXRlcmF0b3IsIFJlYWREaXJSZWN1cnNpdmUsIEZpbHRlciwgRmlsdGVySW1hZ2VzLCBTb3J0RmlsZXMsIFN0YXRGaWxlcywgUmVhZEZkLCBGZFJlYWRlciwgQ29weVRvQ2xpcGJvYXJkLCBSZWFkQ2FsbGJhY2ssIExvZ0NhbGwsIFNwYXduLCBGZXRjaFVSTCB9IGZyb20gJy4vaW8taGVscGVycy5qcyc7CmltcG9ydCB7IHBhcnNlRGVnTWluU2VjLCBwYXJzZUdQU0xvY2F0aW9uIH0gZnJvbSAnLi9zdHJpbmctaGVscGVycy5qcyc7CmltcG9ydCB7IGgsIGh0bWwsIHJlbmRlciwgQ29tcG9uZW50LCB1c2VTdGF0ZSwgdXNlTGF5b3V0RWZmZWN0LCB1c2VSZWYgfSBmcm9tICcuL2xpYi9wcmVhY3QubWpzJzsKaW1wb3J0IHJlbmRlclRvU3RyaW5nIGZyb20gJy4vbGliL3ByZWFjdC1yZW5kZXItdG8tc3RyaW5nLmpzJzsKaW1wb3J0IHsgZXhlYywgc3Bhd24gfSBmcm9tICdjaGlsZF9wcm9jZXNzJzsKaW1wb3J0IHsgRXhlY3V0ZSB9IGZyb20gJy4vb3MtaGVscGVycy5qcyc7CmltcG9ydCB0cmtsIGZyb20gJy4vbGliL3Rya2wuanMnOwppbXBvcnQgeyB0YWtlIH0gZnJvbSAnLi9saWIvaXRlcmF0b3IvaGVscGVycy5qcyc7CmltcG9ydCB7IGV4dGVuZEFycmF5LCBleHRlbmRHZW5lcmF0b3IsIGV4dGVuZEFzeW5jR2VuZXJhdG9yIH0gZnJvbSAndXRpbCc7CgpleHRlbmRBcnJheSgpOwpleHRlbmRHZW5lcmF0b3IoKTsKZXh0ZW5kR2VuZXJhdG9yKE9iamVjdC5nZXRQcm90b3R5cGVPZihuZXcgTWFwKCkua2V5cygpKSk7CmV4dGVuZEdlbmVyYXRvcihPYmplY3QuZ2V0UHJvdG90eXBlT2YobmV3IERpcmVjdG9yeSgnLicpKSk7CmV4dGVuZEFzeW5jR2VuZXJhdG9yKCk7CgpnbG9iYWxUaGlzLmZzID0gZnM7Cmdsb2JhbFRoaXMubG9nRmlsdGVyID0KICAvKHdzX3NldF90aW1lb3V0OiBvbiBpbW1vcnRhbCBzdHJlYW18VW5oYW5kbGVkfFBST1hZLXxWSE9TVF9DRVJUX0FHSU5HfEJJTkR8RVZFTlRfV0FJVHxXUklUQUJMRSkvOwoKdHJrbC5wcm9wZXJ0eShnbG9iYWxUaGlzLCAnbG9nTGV2ZWwnKS5zdWJzY3JpYmUodmFsdWUgPT4KICBzZXRMb2codmFsdWUsIChsZXZlbCwgbWVzc2FnZSkgPT4gewogICAgaWYoCiAgICAgIC9fX2x3c3xzZXJ2ZV8ocmVzb2x2ZWR8Z2VuZXJhdG9yfHByb21pc2V8cmVzcG9uc2UpfChcKFsxMjNdXCkuKndyaXRhYmxlfHhcKFsvXVwpLipXUklURUFCTEUpfGx3c18vLnRlc3QobWVzc2FnZSkKICAgICkKICAgICAgcmV0dXJuOwogICAgaWYobGV2ZWwgPT0gTExMX0lORk8gJiYgIS9wcm94eS8udGVzdChtZXNzYWdlKSkgcmV0dXJuOwogICAgaWYobG9nRmlsdGVyLnRlc3QobWVzc2FnZSkpIHJldHVybjsKCiAgICAvL2lmKHBhcmFtcy5kZWJ1ZyB8fCBsZXZlbCA8PSBMTExfV0FSTikKICAgIG91dCgKICAgICAgKAogICAgICAgIFsnRVJSJywgJ1dBUk4nLCAnTk9USUNFJywgJ0lORk8nLCAnREVCVUcnLCAnUEFSU0VSJywgJ0hFQURFUicsICdFWFQnLCAnQ0xJRU5UJywgJ0xBVEVOQ1knLCAnTUlOTkVUJywgJ1RIUkVBRCddWwogICAgICAgICAgTWF0aC5sb2cyKGxldmVsKQogICAgICAgIF0gPz8gbGV2ZWwgKyAnJwogICAgICApLnBhZEVuZCg4KSArIG1lc3NhZ2UucmVwbGFjZSgvXG4vZywgJ1xcbicpLnJlcGxhY2UoL1xyL2csICdcXHInKQogICAgKTsKICB9KQopOwoKYXN5bmMgZnVuY3Rpb24gQXN5bmNDb2xsZWN0KGl0ZXIpIHsKICBsZXQgcmV0ID0gW107CiAgZm9yIGF3YWl0KGxldCBjaHVuayBvZiBhd2FpdCBpdGVyKSByZXQucHVzaChjaHVuayk7CiAgcmV0dXJuIHJldDsKfQoKZnVuY3Rpb24gRXhlY1Rvb2woY21kLCAuLi5hcmdzKSB7CiAgbGV0IGNoaWxkID0gc3Bhd24oY21kLCBhcmdzLCB7IHN0ZGlvOiBbMCwgJ3BpcGUnLCAyXSB9KTsKICBsZXQgW3N0ZGluLCBzdGRvdXQsIHN0ZGVycl0gPSBjaGlsZC5zdGRpbzsKICBsZXQgcjsKICBsZXQgYiA9IG5ldyBBcnJheUJ1ZmZlcigxMDI0KTsKICByID0gY2hpbGQud2FpdCgpOwogIC8vIGNvbnNvbGUubG9nKCdFeGVjVG9vbCcsIHsgYXJncywgY2hpbGQgfSk7CgogIHIgPSBvcy5yZWFkKHN0ZG91dCwgYiwgMCwgMTAyNCk7CiAgbGV0IGRhdGEgPSBiLnNsaWNlKDAsIHIpOwogIGxldCBzdHIgPSB0b1N0cmluZyhkYXRhKTsKCiAgcmV0dXJuIHN0cjsKfQoKZnVuY3Rpb24gR2V0TWltZShmaWxlKSB7CiAgbGV0IG91dHB1dCA9IEV4ZWNUb29sKCdmaWxlJywgJy1pJywgZmlsZSk7CiAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UoL1tcclxuXSokL2csICcnKTsKICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZShuZXcgUmVnRXhwKGZpbGUgKyAnOlxccysnKSwgJycpOwogIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC9cO1xzKi4qL2csICcnKTsKICByZXR1cm4gb3V0cHV0Owp9CgpmdW5jdGlvbiBNYXRjaGVyKHBhdHRlcm4sIHQgPSBhcmcgPT4gYXJnKSB7CiAgcmV0dXJuICguLi5hcmdzKSA9PiBwYXR0ZXJuID09IHQoLi4uYXJncykgfHwgMCA9PSBmbm1hdGNoKHBhdHRlcm4sIHQoLi4uYXJncyksIEZOTV9FWFRNQVRDSCk7Cn0KCmZ1bmN0aW9uIEtleU9yVmFsdWVNYXRjaGVyKHBhdHRlcm4pIHsKICBsZXQgbWF0Y2hlciA9IE1hdGNoZXIocGF0dGVybik7CiAgcmV0dXJuIChba2V5LCB2YWx1ZV0pID0+IG1hdGNoZXIoa2V5KSB8fCBtYXRjaGVyKHZhbHVlKTsKfQoKZnVuY3Rpb24gR2V0Um9vdERpcmVjdG9yaWVzKHBhdHRlcm4gPSAnKicpIHsKICByZXR1cm4gYWxsb3dlZERpcnMua2V5cygpLmZpbHRlcihNYXRjaGVyKHBhdHRlcm4pKTsKfQoKY29uc3QgTWFrZVVVSUQgPSAocm5nID0gTWF0aC5yYW5kb20pID0+IFs4LCA0LCA0LCA0LCAxMl0ubWFwKG4gPT4gcmFuZFN0cihuLCAnMDEyMzQ1Njc4OWFiY2RlZicpLCBybmcpLmpvaW4oJy0nKTsKCmNvbnN0IGRlZmF1bHREaXJzID0gKGdsb2JhbFRoaXMuZGVmYXVsdERpcnMgPSBbCiAgJy4nLAogIC4uLmdsb2IoJy4uLyovZWFnbGUnKSwKICAnLi91cGxvYWRzLyoue3NjaCxicmQsbGJyfScsCiAgJy9tbnQvZXh0ZXh0L1Bob3Rvcy8qQVBQTEUvKi57SlBHLFBORyxHSUYsQUFFLE1PVixIRUlDLE1QNCxXRUJQfScsCiAgWycvaG9tZS9yb21hbi9CaWxkZXInLCBuZXcgUmVnRXhwKCcuKGpwZ3xqcGVnfHBuZ3xoZWljfHRpZnx0aWZmKSQnLCAnaScpXQpdKTsKCmNvbnN0IGFsbG93ZWREaXJzID0gKGdsb2JhbFRoaXMuYWxsb3dlZERpcnMgPSBuZXcgTWFwKAogIGRlZmF1bHREaXJzCiAgICAubWFwKGRkID0+IEdldERpcihBcnJheS5pc0FycmF5KGRkKSA/IGRkWzBdIDogZGQpKQogICAgLm1hcChkID0+IHBhdGgucmVzb2x2ZShkKSkKICAgIC5tYXAoZCA9PiBwYXRoLnJlbGF0aXZlKGQpKQogICAgLm1hcChkID0+IFtEaXJOYW1lKGQpLCBkXSkKKSk7CgpmdW5jdGlvbiBHZXREaXIoZGlyKSB7CiAgbGV0IGEgPSBwYXRoLnRvQXJyYXkoZGlyKTsKICBsZXQgaSA9IGEuZmluZEluZGV4KG4gPT4gL1sqe31dLy50ZXN0KG4pKTsKICByZXR1cm4gaSAhPSAtMSA/IHBhdGguc2xpY2UoZGlyLCAwLCBpKSA6IGRpcjsKfQoKZnVuY3Rpb24gRGlyTmFtZShuYW1lKSB7CiAgbGV0IHAgPSBwYXRoLnJlbGF0aXZlKG5hbWUpOwoKICBwID0gcGF0aC5zbGljZSgKICAgIHAsCiAgICBwYXRoLnRvQXJyYXkocCkuZmluZEluZGV4KGl0ID0+IGl0ICE9ICcuLicpCiAgKTsKICByZXR1cm4gcDsKfQpmdW5jdGlvbiBEYXRlU3RyKGRhdGUpIHsKICBsZXQgc3RyID0gZGF0ZS50b0lTT1N0cmluZygpOwogIGxldCB0aSA9IHN0ci5pbmRleE9mKCdUJyk7CiAgcmV0dXJuICgKICAgIHN0ci5zdWJzdHJpbmcoMCwgdGkpIC8qLnJlcGxhY2UoLy0vZywgJycpKi8gKyAnICcgKyBzdHIuc3Vic3RyaW5nKHRpICsgMSwgdGkgKyAxICsgOCkgLy8ucmVwbGFjZSgvOi9nLCAnJykKICApOwp9CgpmdW5jdGlvbiBNb2RlU3RyKG1vZGUpIHsKICByZXR1cm4gKAogICAgKG1vZGUgJiAoMG8xMjAwMDAgPT0gMG8xMjAwMDApID8gJ2wnIDogbW9kZSAmIDBvNDAwMDAgPyAnZCcgOiAnLScpICsKICAgIChtb2RlICYgMGIxMDAwMDAwMDAgPyAncicgOiAnLScpICsKICAgIChtb2RlICYgMGIwMTAwMDAwMDAgPyAndycgOiAnLScpICsKICAgIChtb2RlICYgMGIwMDEwMDAwMDAgPyAneCcgOiAnLScpICsKICAgIChtb2RlICYgMGIxMDAwMDAgPyAncicgOiAnLScpICsKICAgIChtb2RlICYgMGIwMTAwMDAgPyAndycgOiAnLScpICsKICAgIChtb2RlICYgMGIwMDEwMDAgPyAneCcgOiAnLScpICsKICAgIChtb2RlICYgMGIxMDAgPyAncicgOiAnLScpICsKICAgIChtb2RlICYgMGIwMTAgPyAndycgOiAnLScpICsKICAgIChtb2RlICYgMGIwMDEgPyAneCcgOiAnLScpCiAgKTsKfQoKY29uc3QgSFRNTFBhZ2UgPSAoeyB0aXRsZSwgc3R5bGUsIHNjcmlwdHMgPSBbXSwgY2hpbGRyZW4sIC4uLnByb3BzIH0pID0+IHsKICByZXR1cm4gaCgnaHRtbCcsIHt9LCBbCiAgICBoKAogICAgICAnaGVhZCcsCiAgICAgIHt9LAogICAgICBbCiAgICAgICAgaCgndGl0bGUnLCB7fSwgW3RpdGxlXSksCiAgICAgICAgLi4uKHN0eWxlID8gW2goJ3N0eWxlJywgeyB0eXBlOiAndGV4dC9jc3MnIH0sIFtzdHlsZV0pXSA6IFtdKSwKICAgICAgICBoKAogICAgICAgICAgJ2xpbmsnLAogICAgICAgICAgewogICAgICAgICAgICByZWw6ICdzdHlsZXNoZWV0JywKICAgICAgICAgICAgaHJlZjogJ3N0YXRpYy9jc3MvbGlzdC5jc3MnCiAgICAgICAgICB9LAogICAgICAgICAgW10KICAgICAgICApCiAgICAgIF0uY29uY2F0KHNjcmlwdHMubWFwKHNjcmlwdCA9PiBoKCdzY3JpcHQnLCB7IHR5cGU6ICdtb2R1bGUnLCBzcmM6IHNjcmlwdCB9KSkpCiAgICApLAogICAgaCgnYm9keScsIHt9LCBjaGlsZHJlbiA/PyBbXSkKICBdKTsKfTsKCmNvbnN0IEZpbHRlckZvcm0gPSAoeyAuLi5wcm9wcyB9KSA9PgogIGgoJ2Zvcm0nLCB7IGFjdGlvbjogJ2ZpbGUnLCBtZXRob2Q6ICdQT1NUJyB9LCBbCiAgICBoKAogICAgICAnaW5wdXQnLAogICAgICB7CiAgICAgICAgdHlwZTogJ3RleHQnLAogICAgICAgIHNpemU6IDIwLAogICAgICAgIG5hbWU6ICdmaWx0ZXInLAogICAgICAgIHZhbHVlOiAnLionIC8qLAogICAgICAgICAgb25jaGFuZ2U6IGUgPT4gewogICAgICAgICAgICBjb25zb2xlLmxvZygnb25jaGFuZ2UnLCBlKTsKICAgICAgICAgIH0qLwogICAgICB9LAogICAgICBbXQogICAgKSwKICAgIGgoJ2lucHV0JywgeyB0eXBlOiAnc3VibWl0JywgdmFsdWU6ICdTdWJtaXQnLCBjbGFzczogJ2hpZGRlbicgfSwgW10pCiAgXSk7Cgpjb25zdCBIVE1MVGFibGUgPSAoeyByb3dzLCAuLi5wcm9wcyB9KSA9PiBoKCd0YWJsZScsIHByb3BzLCByb3dzKTsKY29uc3QgSFRNTFRhYmxlUm93ID0gKHsgY29sdW1ucywgLi4ucHJvcHMgfSkgPT4gaCgndHInLCBwcm9wcywgY29sdW1ucyk7CmNvbnN0IEhUTUxUYWJsZUNvbHVtbiA9ICh7IGNvbHVtbnMsIGNoaWxkcmVuLCB0YWcgPSAndGQnLCAuLi5wcm9wcyB9KSA9PiBoKHRhZywgcHJvcHMsIGNoaWxkcmVuKTsKCmNvbnN0IEZpbGVMaW5rID0gKHsgZmlsZSwgLi4ucHJvcHMgfSkgPT4gewogIHJldHVybiBoKCdhJywgeyBocmVmOiAnZmlsZS91cGxvYWRzLycgKyBmaWxlIH0sIFtmaWxlXSk7Cn07CmNvbnN0IEZpbGVPYmplY3QgPSAoeyBmaWxlLCBzdGF0ID0ge30sIC4uLnByb3BzIH0pID0+IHsKICBzdGF0ID8/PSBmcy5sc3RhdFN5bmMoJ3VwbG9hZHMvJyArIGZpbGUpOwogIC8vIGNvbnNvbGUubG9nKCdGaWxlT2JqZWN0JywgeyBmaWxlLCBzdGF0IH0pOwogIGxldCBpc0RpciA9IHN0YXQuaXNEaXJlY3RvcnkoKTsKCiAgcmV0dXJuIGgoSFRNTFRhYmxlUm93LCB7fSwgWwogICAgaChIVE1MVGFibGVDb2x1bW4sIHsgY2xhc3M6ICdtb2RlJyB9LCBbCiAgICAgIC8vKHN0YXQubW9kZSAmIDBiMTExMTExMTExKS50b1N0cmluZyg4KSwKICAgICAgTW9kZVN0cihzdGF0Lm1vZGUpCiAgICBdKSwKICAgIGgoSFRNTFRhYmxlQ29sdW1uLCB7IGNsYXNzOiAnZmlsZScgfSwgW2goRmlsZUxpbmssIHsgZmlsZTogZmlsZSArIChpc0RpciA/ICcvJyA6ICcnKSB9LCBbXSldKSwKICAgIGgoSFRNTFRhYmxlQ29sdW1uLCB7IGNsYXNzOiAnc2l6ZScgfSwgW3N0YXQuc2l6ZSArICcnXSksCiAgICBoKEhUTUxUYWJsZUNvbHVtbiwgeyBjbGFzczogJ2RhdGUnIH0sIFtEYXRlU3RyKG5ldyBEYXRlKHN0YXQuYXRpbWUpKV0pCiAgXSk7Cn07Cgpjb25zdCBGaWxlVGFibGUgPSAoeyBmaWxlcywgLi4ucHJvcHMgfSkgPT4gewogIC8vY29uc29sZS5sb2coJ0ZpbGVUYWJsZScsIGZpbGVzKTsKCiAgbGV0IGZpZWxkcyA9IFsnbW9kZScsICdmaWxlJywgJ3NpemUnLCAnYXRpbWUnXTsKCiAgZmlsZXMgPSBmaWxlcy5zb3J0KChhLCBiKSA9PiBhLmZpbGUubG9jYWxlQ29tcGFyZShiLmZpbGUpKTsKCiAgcmV0dXJuIGgoCiAgICBIVE1MVGFibGUsCiAgICB7CiAgICAgIC4uLnByb3BzLAogICAgICBjZWxsc3BhY2luZzogMCwKICAgICAgY2VsbHBhZGRpbmc6IDAsCiAgICAgIGJvcmRlcjogMCwKICAgICAgcm93czogWwogICAgICAgIGgoCiAgICAgICAgICBIVE1MVGFibGVSb3csCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbHVtbnM6IGZpZWxkcy5tYXAoZmllbGQgPT4gaChIVE1MVGFibGVDb2x1bW4sIHsgdGFnOiAndGgnIH0sIFtmaWVsZF0pKQogICAgICAgICAgfSwKICAgICAgICAgIFtdCiAgICAgICAgKQogICAgICBdLmNvbmNhdChmaWxlcy5tYXAoZmlsZSA9PiBoKEZpbGVPYmplY3QsIGZpbGUsIFtdKSkpCiAgICB9LAogICAgW10KICApOwp9OwoKZnVuY3Rpb24gUmVhZEV4aXYyKGZpbGUpIHsKICBjb25zb2xlLmxvZygnUmVhZEV4aXYyJywgZmlsZSk7CiAgbGV0IFtyZGYsIHN0ZG91dF0gPSBvcy5waXBlKCk7CiAgb3MuZXhlYyhbJ2V4aXYyJywgJy1lJywgJ1gtJywgJ2V4JywgZmlsZV0sIHsgc3Rkb3V0IH0pOwogIG9zLmNsb3NlKHN0ZG91dCk7CiAgbGV0IHhtcGRhdCA9IGZzLnJlYWRBbGxTeW5jKHJkZik7CiAgZnMuY2xvc2VTeW5jKHJkZik7CiAgLy8gY29uc29sZS5sb2coJ3htcGRhdCcsIHhtcGRhdCk7CiAgbGV0IHhtcCA9IHhtbC5yZWFkKHhtcGRhdCk7CiAgLy8gY29uc29sZS5sb2coJ3htcCcsIHhtcCk7CiAgbGV0IGZsYXQgPSBPYmplY3QuZnJvbUVudHJpZXMoCiAgICBkZWVwCiAgICAgIC5mbGF0dGVuKHhtcCwgW10pCiAgICAgIC5maWx0ZXIoKFtrLCB2XSkgPT4gdiAhPT0gJycgJiYgL2F0dHJpYnV0ZXMuKjovLnRlc3QoaykgJiYgIS9cLnhtbG5zLy50ZXN0KGspICYmICFpc09iamVjdCh2KSkKICAgICAgLmZpbHRlcigoW2ssIHZdKSA9PiAvKEdQU3xbWFldRGltfFtYWV1SZXN8RGF0ZSR8TWFrZSR8TW9kZWwkKS8udGVzdChrKSkKICAgICAgLm1hcCgoW2ssIHZdKSA9PiBbay5yZXBsYWNlKC8uKlwuYXR0cmlidXRlc1wuL2csICcnKSwgdl0pCiAgICAgIC5zb3J0KChhLCBiKSA9PiBhWzBdLmxvY2FsZUNvbXBhcmUoYlswXSkpCiAgICAgIC5tYXAoKFtrLCB2XSkgPT4gW2ssIGlzTmFOKCt2KSA/IChpc05hTihEYXRlLnBhcnNlKHYpKSA/IHYgOiBuZXcgRGF0ZSh2KSkgOiArdl0pCiAgKTsKICByZXR1cm4gZmxhdDsKfQoKZnVuY3Rpb24gUmVhZEV4aWZ0b29sKGZpbGUpIHsKICBjb25zb2xlLmxvZygnUmVhZEV4aWZ0b29sJywgZmlsZSk7CgogIGxldCBbcmV0LCBvdXRdID0gRXhlY3V0ZSgnZXhpZnRvb2wnLCAnLVMnLCAnLWVlJywgZmlsZSk7CgogIGxldCBhID0gb3V0LnNwbGl0KC9ccj9cbi9nKS5maWx0ZXIobCA9PiBsICE9ICcnKTsKCiAgYSA9IGEubWFwKGxpbmUgPT4gW2xpbmUsIGxpbmUuaW5kZXhPZignOiAnKV0pLm1hcCgoW2xpbmUsIGlkeF0pID0+IFtsaW5lLnNsaWNlKDAsIGlkeCksIGxpbmUuc2xpY2UoaWR4ICsgMildKTsKICBsZXQgbyA9IE9iamVjdC5mcm9tRW50cmllcyhhKTsKCiAgLy9jb25zb2xlLmxvZygnUmVhZEV4aWZ0b29sJyxvKTsKICByZXR1cm4gbzsKfQoKZnVuY3Rpb24gSGVpZkNvbnZlcnQoc3JjLCBkc3QsIHF1YWxpdHkgPSAxMDApIHsKICBjb25zb2xlLmxvZygnSGVpZkNvbnZlcnQnLCBzcmMsIGRzdCk7CiAgbGV0IGFyZ3MgPSBbJ2hlaWYtY29udmVydCcsICctcScsIHF1YWxpdHkgKyAnJywgc3JjLCBkc3RdOwogIGxldCBbcmV0LCBvdXRdID0gRXhlY3V0ZSguLi5hcmdzKTsKCiAgY29uc29sZS5sb2coJ0hlaWZDb252ZXJ0JywgeyBhcmdzLCByZXQsIG91dCB9KTsKICByZXR1cm4gW3JldCwgb3V0XTsKfQoKZnVuY3Rpb24gTWFnaWNrUmVzaXplKHNyYywgZHN0LCByb3RhdGUgPSAwLCB3aWR0aCwgaGVpZ2h0KSB7CiAgY29uc29sZS5sb2coJ01hZ2lja1Jlc2l6ZScsIHsKICAgIHdpZHRoLAogICAgaGVpZ2h0LAogICAgZHN0LAogICAgcm90YXRlCiAgfSk7CiAgbGV0IGFyZ3MgPSBbJ2NvbnZlcnQnLCBzcmMsICctcmVzaXplJywgd2lkdGggKyAneCcgKyBoZWlnaHQsIC4uLihyb3RhdGUgPyBbJy1yb3RhdGUnLCAnLScgKyByb3RhdGVdIDogW10pLCBkc3RdOwogIGxldCBbcmV0LCBvdXRdID0gRXhlY3V0ZSguLi5hcmdzKTsKCiAgY29uc29sZS5sb2coJ01hZ2lja1Jlc2l6ZScsIHsgYXJncywgcmV0LCBvdXQgfSk7CiAgcmV0dXJuIFtyZXQsIG91dF07Cn0KCmZ1bmN0aW9uIG1haW4oLi4uYXJncykgewogIGNvbnN0IGJhc2UgPSBwYXRoLmJhc2VuYW1lKHNjcmlwdEFyZ3NbMF0sICcuanMnKS5yZXBsYWNlKC9cLlthLXpdKiQvLCAnJyk7CiAgY29uc3QgY29uZmlnID0gUmVhZEpTT04oYC4ke2Jhc2V9LWNvbmZpZ2ApID8/IHt9OwoKICBnbG9iYWxUaGlzLmNvbnNvbGUgPSBuZXcgQ29uc29sZSh7CiAgICBpbnNwZWN0T3B0aW9uczogewogICAgICBjb21wYWN0OiAyLAogICAgICBkZXB0aDogSW5maW5pdHksCiAgICAgIGN1c3RvbUluc3BlY3Q6IHRydWUsCiAgICAgIG1heEFycmF5TGVuZ3RoOiAyMDAKICAgIH0KICB9KTsKICBsZXQgcGFyYW1zID0gZ2V0T3B0KAogICAgewogICAgICB2ZXJib3NlOiBbZmFsc2UsIChhLCB2KSA9PiAodiB8IDApICsgMSwgJ3YnXSwKICAgICAgbGlzdGVuOiBbZmFsc2UsIG51bGwsICdsJ10sCiAgICAgIGNvbm5lY3Q6IFtmYWxzZSwgbnVsbCwgJ2MnXSwKICAgICAgY2xpZW50OiBbZmFsc2UsIG51bGwsICdDJ10sCiAgICAgIHNlcnZlcjogW2ZhbHNlLCBudWxsLCAnUyddLAogICAgICBkZWJ1ZzogW2ZhbHNlLCBudWxsLCAneCddLAogICAgICB0bHM6IFtmYWxzZSwgbnVsbCwgJ3QnXSwKICAgICAgJ25vLXRscyc6IFtmYWxzZSwgKHYsIHB2LCBvKSA9PiAoKG8udGxzID0gZmFsc2UpLCB0cnVlKSwgJ1QnXSwKICAgICAgYWRkcmVzczogW3RydWUsIG51bGwsICdhJ10sCiAgICAgIHBvcnQ6IFt0cnVlLCBudWxsLCAncCddLAogICAgICAnc3NsLWNlcnQnOiBbdHJ1ZSwgbnVsbF0sCiAgICAgICdzc2wtcHJpdmF0ZS1rZXknOiBbdHJ1ZSwgbnVsbF0sCiAgICAgICdAJzogJ2FkZHJlc3MscG9ydCcKICAgIH0sCiAgICBhcmdzCiAgKTsKICBpZihwYXJhbXNbJ25vLXRscyddID09PSB0cnVlKSBwYXJhbXMudGxzID0gZmFsc2U7CgogIGNvbnN0IHsKICAgIGFkZHJlc3MgPSAnMC4wLjAuMCcsCiAgICBwb3J0ID0gODk5OSwKICAgICdzc2wtY2VydCc6IHNzbENlcnQgPSAnbG9jYWxob3N0LmNydCcsCiAgICAnc3NsLXByaXZhdGUta2V5Jzogc3NsUHJpdmF0ZUtleSA9ICdsb2NhbGhvc3Qua2V5JwogIH0gPSBwYXJhbXM7CiAgY29uc3QgbGlzdGVuID0gcGFyYW1zLmNvbm5lY3QgJiYgIXBhcmFtcy5saXN0ZW4gPyBmYWxzZSA6IHRydWU7CiAgY29uc3QgaXNfc2VydmVyID0gIXBhcmFtcy5jbGllbnQgfHwgcGFyYW1zLnNlcnZlcjsKCiAgbGV0IG5hbWUgPSBwcm9jZXNzLmVudlsnTkFNRSddID8/IGJhc2U7CgogIG5hbWUgPSBuYW1lCiAgICAucmVwbGFjZSgvLipcLy8sICcnKQogICAgLnJlcGxhY2UoLy0vZywgJyAnKQogICAgLnJlcGxhY2UoL1wuW15cLy5dKiQvLCAnJyk7CgogIGxldCBbcHJlZml4LCBzdWZmaXhdID0gbmFtZS5zcGxpdCgnICcpOwoKICBsZXQgcmVwbCA9IG5ldyBSRVBMKGBceDFiWzM4OzU7MTY1bSR7cHJlZml4fSBceDFiWzM4OzU7MzltJHtzdWZmaXh9XHgxYlswbWAsIGZhbHNlKTsKICBjb25zdCBoaXN0ZmlsZSA9ICcudXBsb2FkLXNlcnZlci1oaXN0b3J5JzsKICByZXBsLmhpc3RvcnlMb2FkKGhpc3RmaWxlLCBmYWxzZSk7CiAgcmVwbC5sb2FkU2F2ZU9wdGlvbnMoKTsKICByZXBsLmRpcmVjdGl2ZXMuaSA9IFsKICAgIChtb2R1bGUsIC4uLmFyZ3MpID0+IHsKICAgICAgY29uc29sZS5sb2coJ2FyZ3MnLCBhcmdzKTsKICAgICAgdHJ5IHsKICAgICAgICByZXR1cm4gcmVxdWlyZShtb2R1bGUpOwogICAgICB9IGNhdGNoKGUpIHt9CiAgICAgIGltcG9ydChtb2R1bGUpLnRoZW4obSA9PiAoZ2xvYmFsVGhpc1ttb2R1bGVdID0gbSkpOwogICAgfSwKICAgICdpbXBvcnQgbW9kdWxlJwogIF07CgogIGxldCB7IGxvZyB9ID0gY29uc29sZTsKICByZXBsLnNob3cgPSBhcmcgPT4gc3RkLnB1dHMoKHR5cGVvZiBhcmcgPT0gJ3N0cmluZycgPyBhcmcgOiBpbnNwZWN0KGFyZywgZ2xvYmFsVGhpcy5jb25zb2xlLm9wdGlvbnMpKSArICdcbicpOwoKICByZXBsLmNsZWFudXAgPSAoKSA9PiB7CiAgICByZXBsLnJlYWRsaW5lUmVtb3ZlUHJvbXB0KCk7CiAgICBUZXJtaW5hbC5tb3VzZXRyYWNraW5nRGlzYWJsZSgpOwogICAgbGV0IG51bUxpbmVzID0gcmVwbC5oaXN0b3J5U2F2ZShoaXN0ZmlsZSk7CgogICAgcmVwbC5wcmludFN0YXR1cyhgRVhJVCAod3JvdGUgJHtudW1MaW5lc30gaGlzdG9yeSBlbnRyaWVzKWAsIGZhbHNlKTsKCiAgICBzdGQuZXhpdCgwKTsKICB9OwoKICByZXBsLmluc3BlY3RPcHRpb25zID0gewogICAgLi4uKHJlcGwuaW5zcGVjdE9wdGlvbnMgPz8gY29uc29sZS5vcHRpb25zKSwKICAgIGRlcHRoOiBJbmZpbml0eSwKICAgIGNvbXBhY3Q6IGZhbHNlCiAgfTsKCiAgY29uc29sZS5sb2cgPSAoLi4uYXJncykgPT4gcmVwbC5wcmludFN0YXR1cygoKSA9PiBsb2coY29uc29sZS5jb25maWcocmVwbC5pbnNwZWN0T3B0aW9ucyksIC4uLmFyZ3MpKTsKCiAgbGV0IGxvZ0ZpbGUgPQogICAgewogICAgICBwdXRzKHMpIHsKICAgICAgICByZXBsLnByaW50U3RhdHVzKCgpID0+IHN0ZC5wdXRzKHMpKTsKICAgICAgfQogICAgfSA/PyBzdGQub3BlbigndXBsb2FkLXNlcnZlci5sb2cnLCAndysnKTsKCiAgbGV0IGNvbm5lY3Rpb25zID0gbmV3IFNldCgpOwogIGxldCBieV91dWlkID0ge307CgogIGZ1bmN0aW9uIFBhcnNlQm9keShnZW4pIHsKICAgIGxldCBwcm9tLAogICAgICBvID0gJycsCiAgICAgIHg7CgogICAgd2hpbGUoKHggPSBnZW4ubmV4dCgpKSkgewogICAgICBsZXQgeyB2YWx1ZSwgZG9uZSB9ID0geDsKICAgICAgbyArPSB2YWx1ZTsKICAgIH0KICAgIHJldHVybiBvOwogIH0KCiAgY29uc3QgY3JlYXRlV1MgPSAoZ2xvYmFsVGhpcy5jcmVhdGVXUyA9ICh1cmwsIGNhbGxiYWNrcywgbGlzdGVuKSA9PiB7CiAgICAvL2NvbnNvbGUubG9nKCdjcmVhdGVXUycsIHsgdXJsLCBjYWxsYmFja3MsIGxpc3RlbiB9KTsKCiAgICBnbG9iYWxUaGlzLm91dCA9IHMgPT4gbG9nRmlsZS5wdXRzKHMgKyAnXG4nKTsKCiAgICBsb2dMZXZlbCA9IChwYXJhbXMuZGVidWcgPyBMTExfVVNFUiA6IDApIHwgKCgocGFyYW1zLmRlYnVnID8gTExMX0lORk8gOiBMTExfV0FSTikgPDwgMSkgLSAxKTsKICAgIGNvbnNvbGUubG9nKCdjcmVhdGVXUycsIHsgbG9nTGV2ZWwgfSk7CgogICAgcmV0dXJuIFtjbGllbnQsIHNlcnZlcl1bK2xpc3Rlbl0oewogICAgICB0bHM6IHBhcmFtcy50bHMsCiAgICAgIHNzbENlcnQsCiAgICAgIHNzbFByaXZhdGVLZXksCiAgICAgIG1pbWV0eXBlczogWwogICAgICAgIFsnLnN2Z3onLCAnYXBwbGljYXRpb24vZ3ppcCddLAogICAgICAgIFsnLm1qcycsICdhcHBsaWNhdGlvbi9qYXZhc2NyaXB0J10sCiAgICAgICAgWycuanMnLCAnYXBwbGljYXRpb24vamF2YXNjcmlwdCddLAogICAgICAgIFsnLndhc20nLCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJ10sCiAgICAgICAgWycuZW90JywgJ2FwcGxpY2F0aW9uL3ZuZC5tcy1mb250b2JqZWN0J10sCiAgICAgICAgWycubGliJywgJ2FwcGxpY2F0aW9uL3gtYXJjaGl2ZSddLAogICAgICAgIFsnLmJ6MicsICdhcHBsaWNhdGlvbi94LWJ6aXAyJ10sCiAgICAgICAgWycuZ2l0aWdub3JlJywgJ3RleHQvcGxhaW4nXSwKICAgICAgICBbJy5jbWFrZScsICd0ZXh0L3BsYWluJ10sCiAgICAgICAgWycuaGV4JywgJ3RleHQvcGxhaW4nXSwKICAgICAgICBbJy5tZCcsICd0ZXh0L3BsYWluJ10sCiAgICAgICAgWycucGJ4cHJvaicsICd0ZXh0L3BsYWluJ10sCiAgICAgICAgWycud2F0JywgJ3RleHQvcGxhaW4nXSwKICAgICAgICBbJy5jJywgJ3RleHQveC1jJ10sCiAgICAgICAgWycuaCcsICd0ZXh0L3gtYyddLAogICAgICAgIFsnLmNwcCcsICd0ZXh0L3gtYysrJ10sCiAgICAgICAgWycuaHBwJywgJ3RleHQveC1jKysnXSwKICAgICAgICBbJy5maWx0ZXJzJywgJ3RleHQveG1sJ10sCiAgICAgICAgWycucGxpc3QnLCAndGV4dC94bWwnXSwKICAgICAgICBbJy5zdG9yeWJvYXJkJywgJ3RleHQveG1sJ10sCiAgICAgICAgWycudmN4cHJvaicsICd0ZXh0L3htbCddLAogICAgICAgIFsnLmJhdCcsICd0ZXh0L3gtbXNkb3MtYmF0Y2gnXSwKICAgICAgICBbJy5tbScsICd0ZXh0L3gtb2JqZWN0aXZlLWMnXSwKICAgICAgICBbJy5tJywgJ3RleHQveC1vYmplY3RpdmUtYyddLAogICAgICAgIFsnLnNoJywgJ3RleHQveC1zaGVsbHNjcmlwdCddCiAgICAgIF0sCiAgICAgIG1vdW50czogWwogICAgICAgIFsnLycsICcuJywgJ3VwbG9hZC5odG1sJ10sCiAgICAgICAgWycvZ2V0JywgJy4vdXBsb2FkcycsICcnXSwKICAgICAgICBbJy93YXJtY2F0JywgJ2h0dHBzOi8vd2FybWNhdC5jb20vJywgJ2luZGV4Lmh0bWwnXSwKICAgICAgICBbJy9kaXN0cmVsZWMnLCAnaHR0cHM6Ly93d3cuZGlzdHJlbGVjLmNoLycsICdsb2dpbiddLAogICAgICAgIFsnL2hhc3VyYScsICdodHRwOi8vd2lsZC1iZWF1dHkuaGVyb2t1YXBwLmNvbS92MS8nLCAnZ3JhcGhxbCddLAogICAgICAgIC8vIFsnL3VwbG9hZCcsICdsd3MtZGVhZGRyb3AnLCBudWxsLCAnbHdzLWRlYWRkcm9wJ10sCiAgICAgICAgYXN5bmMgZnVuY3Rpb24qIHRlc3QocmVxLCByZXNwKSB7CiAgICAgICAgICByZXNwLnR5cGUgPSAndGV4dC9wbGFpbic7CgogICAgICAgICAgY29uc29sZS5sb2coJyp0ZXN0JywgeyByZXEsIHJlc3AgfSk7CgogICAgICAgICAgbGV0IGJvZHlTdHIgPSAnJzsKICAgICAgICAgIGlmKHJlcS5tZXRob2QgPT0gJ1BPU1QnKSB7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ3JlcS5ib2R5JywgcmVxLmJvZHkpOwogICAgICAgICAgICAvLyAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcS5ib2R5Lm5leHQoKScsIGF3YWl0IHJlcS5ib2R5Lm5leHQoKSk7CgogICAgICAgICAgICBmb3IgYXdhaXQobGV0IGNodW5rIG9mIGF3YWl0IHJlcS5ib2R5KSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NodW5rJywgY2h1bmspOwogICAgICAgICAgICAgIGJvZHlTdHIgKz0gdG9TdHJpbmcoY2h1bmspOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBjb25zb2xlLmxvZygnYm9keVN0cicsIGJvZHlTdHIpOwoKICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7CiAgICAgICAgICAgIHlpZWxkIGBsaW5lICMke2l9XG5gOwogICAgICAgICAgICBhd2FpdCB3YWl0Rm9yKCgxMCAtIGkgKyAxKSAqIDEwKTsKICAgICAgICAgIH0KCiAgICAgICAgICB5aWVsZCAnZG9uZSEnOwogICAgICAgIH0sCiAgICAgICAgZnVuY3Rpb24gcHJveHkocmVxLCByZXNwKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygncHJveHknLCB7IHJlcSwgcmVzcCB9KTsKICAgICAgICAgIGNvbnN0IHsgdXJsLCBtZXRob2QsIGhlYWRlcnMgfSA9IHJlcTsKICAgICAgICAgIGNvbnNvbGUubG9nKCdwcm94eScsIHsgdXJsLCBtZXRob2QsIGhlYWRlcnMgfSk7CiAgICAgICAgICBjb25zdCB7IHN0YXR1cywgb2ssIHR5cGUgfSA9IHJlc3A7CgogICAgICAgICAgY29uc29sZS5sb2coJ3Byb3h5JywgeyBzdGF0dXMsIG9rLCB1cmwsIHR5cGUgfSk7CiAgICAgICAgfSwKICAgICAgICBmdW5jdGlvbiogY29uZmlnKHJlcSwgcmVzcCkgewogICAgICAgICAgY29uc29sZS5sb2coJypjb25maWcnLCB7IHJlcSwgcmVzcCB9KTsKICAgICAgICAgIHlpZWxkICd7fSc7CiAgICAgICAgfSwKICAgICAgICBmdW5jdGlvbiogZmlsZShyZXEsIHJlc3ApIHsKICAgICAgICAgIGxldCB7IGJvZHksIGhlYWRlcnMsIGpzb24sIHVybCB9ID0gcmVxOwogICAgICAgICAgbGV0IHsgcXVlcnkgfSA9IHVybDsKCiAgICAgICAgICBpZih0eXBlb2YgYm9keSA9PSAnc3RyaW5nJykKICAgICAgICAgICAgcXVlcnkgPSB7CiAgICAgICAgICAgICAgLi4ucXVlcnksCiAgICAgICAgICAgICAgLi4uKEpTT04ucGFyc2UoYm9keSkgPz8ge30pCiAgICAgICAgICAgIH07CgogICAgICAgICAgbGV0IHsgYWN0aW9uID0gJ2xpc3QnLCBjaGFyc2V0ID0gJ3V0Zi04JywgYmluYXJ5ID0gZmFsc2UsIGZpbGUsIGNvbnRlbnRzIH0gPSBxdWVyeSA/PyB7fTsKCiAgICAgICAgICBpZigvXlwvZmlsZVwvLi8udGVzdCh1cmwucGF0aCkpIHsKICAgICAgICAgICAgZmlsZSA9IHVybC5wYXRoLnJlcGxhY2UoL15cL2ZpbGVcLy8sICcnKTsKICAgICAgICAgICAgYWN0aW9uID0gJ2xvYWQnOwogICAgICAgICAgfQogICAgICAgICAgY29uc29sZS5sb2coJypmaWxlJywgeyBxdWVyeSwgYm9keSwgZmlsZSB9KTsKCiAgICAgICAgICBjb25zb2xlLmxvZyhgKmZpbGVgLCB7IGFjdGlvbiwgZmlsZSB9KTsKCiAgICAgICAgICBpZihmaWxlKSB7CiAgICAgICAgICAgIGZpbGUgPSBwYXRoLmFic29sdXRlKGZpbGUpOwogICAgICAgICAgICBmaWxlID0gcGF0aC5jb2xsYXBzZShmaWxlKTsKICAgICAgICAgICAgY29uc29sZS5sb2coCiAgICAgICAgICAgICAgYGFsbG93ZWREaXJzOmAsCiAgICAgICAgICAgICAgYWxsb3dlZERpcnMgLy8ubWFwKGRpciA9PiBwYXRoLm5vcm1hbGl6ZShkaXIpKQogICAgICAgICAgICApOwoKICAgICAgICAgICAgLy8gICAgY29uc29sZS5sb2coYGFsbG93ZWQ6YCwgYWxsb3dlZERpcnMubWFwKGRpciA9PiBwYXRoLmlzaW4oZmlsZSwgZGlyKSkpOwogICAgICAgICAgICBsZXQgYWxsb3dlZCA9IGFsbG93ZWREaXJzLnNvbWUoZGlyID0+IHBhdGguaXNpbihmaWxlLCBwYXRoLm5vcm1hbGl6ZShkaXIpKSk7CgogICAgICAgICAgICBpZighYWxsb3dlZCkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBOb3QgYWxsb3dlZDogJyR7ZmlsZX0nYCk7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBOb3QgYWxsb3dlZDogJyR7ZmlsZX0nYCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBzd2l0Y2ggKGFjdGlvbikgewogICAgICAgICAgICBjYXNlICdsb2FkJzoKICAgICAgICAgICAgICBsZXQgbWltZSA9IEdldE1pbWUoZmlsZSk7CiAgICAgICAgICAgICAgcmVzcC50eXBlID0gbWltZTsKICAgICAgICAgICAgICBsZXQgZGF0YSA9IGZzLnJlYWRGaWxlU3luYyhmaWxlLCAxIHwgYmluYXJ5ID8gbnVsbCA6IGNoYXJzZXQpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAqZmlsZS5sb2FkYCwgeyBkYXRhIH0pOwogICAgICAgICAgICAgIHlpZWxkIGRhdGE7CiAgICAgICAgICAgICAgcmVzcC5ib2R5ID0gZGF0YTsKICAgICAgICAgICAgICAvL3lpZWxkCiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ3NhdmUnOgogICAgICAgICAgICAgIGZzLndyaXRlRmlsZVN5bmMoZmlsZSwgY29udGVudHMpOwogICAgICAgICAgICAgIHlpZWxkICdkb25lIVxyXG4nOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICdsaXN0JzoKICAgICAgICAgICAgICBsZXQgZmlsZXMgPSBmcy5yZWFkZGlyU3luYygndXBsb2FkcycpLmZpbHRlcihmID0+ICEvXlwuJC8udGVzdChmKSk7CiAgICAgICAgICAgICAgbGV0IGNvbXBvbmVudCA9IGgoCiAgICAgICAgICAgICAgICBIVE1MUGFnZSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgdGl0bGU6ICdGaWxlIGxpc3QnLAogICAgICAgICAgICAgICAgICBzdHlsZTogYAogIGJvZHksICogewogICAgZm9udC1mYW1pbHk6IE1pc2NGaXhlZFNDNjEzLEZpeGVkLCJDb3VyaWVyIE5ldyI7CiAgfQoKICAgICAgICAgICAgICAgICAgYCwKICAgICAgICAgICAgICAgICAgc2NyaXB0czogWydmaWxlbGlzdC5qcyddCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgICBoKEZpbHRlckZvcm0sIHt9LCBbXSksCiAgICAgICAgICAgICAgICAgIGgoRmlsZVRhYmxlLCB7CiAgICAgICAgICAgICAgICAgICAgZmlsZXM6IGZpbGVzLm1hcChmaWxlID0+ICh7CiAgICAgICAgICAgICAgICAgICAgICBmaWxlLAogICAgICAgICAgICAgICAgICAgICAgc3RhdDogZnMuc3RhdFN5bmMoZmlsZSkKICAgICAgICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIHlpZWxkIHJlbmRlclRvU3RyaW5nKGNvbXBvbmVudCk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgeWllbGQgZmlsZXMuam9pbignXG4nKTsKCiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBzdWNoIGNvbW1hbmQ6ICcke2FjdGlvbn0nYCk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBmdW5jdGlvbiogdXBsb2FkcyhyZXEsIHJlc3ApIHsKICAgICAgICAgIHJlc3AudHlwZSA9ICdhcHBsaWNhdGlvbi9qc29uJzsKICAgICAgICAgIGNvbnNvbGUubG9nKCd1cGxvYWRzJywgcmVxLCByZXNwKTsKCiAgICAgICAgICBjb25zdCB7IGxpbWl0ID0gJzAsMTAwJywgcHJldHR5ID0gMCB9ID0gcmVxLnVybC5xdWVyeSA/PyB7fTsKCiAgICAgICAgICBsZXQgW3N0YXJ0LCBlbmRdID0gbGltaXQuc3BsaXQoLywvZykubWFwKHMgPT4gK3MpOwoKICAgICAgICAgIGNvbnNvbGUubG9nKCd1cGxvYWRzJywgeyBzdGFydCwgZW5kIH0pOwoKICAgICAgICAgIGxldCByZXN1bHQgPSBbXTsKCiAgICAgICAgICBmb3IobGV0IGVudHJ5IG9mIChnbG9iKCd1cGxvYWRzLyouanNvbicpID8/IFtdKS5zbGljZShzdGFydCwgZW5kKSkgewogICAgICAgICAgICBsZXQganNvbiA9IFJlYWRKU09OKGVudHJ5KTsKICAgICAgICAgICAgcmVzdWx0LnB1c2goanNvbik7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc29sZS5sb2coJ3VwbG9hZHMnLCBjb25zb2xlLmNvbmZpZyh7IGRlcHRoOiAxLCBjb21wYWN0OiAyLCBtYXhBcnJheUxlbmd0aDogMTAgfSksIHJlc3VsdCk7CiAgICAgICAgICB5aWVsZCBKU09OLnN0cmluZ2lmeShyZXN1bHQsIC4uLigrcHJldHR5ID8gW251bGwsIDJdIDogW10pKTsKICAgICAgICB9LAogICAgICAgIGFzeW5jIGZ1bmN0aW9uKiBmaWxlcyhyZXEsIHJlc3ApIHsKICAgICAgICAgIC8vY29uc29sZS5sb2coJypmaWxlcycse3JlcSxyZXNwfSk7CiAgICAgICAgICBjb25zb2xlLmxvZygnKmZpbGVzIHF1ZXJ5ID0nLCByZXEudXJsLnF1ZXJ5KTsKICAgICAgICAgIC8qaWYocmVxLmJvZHkpIHsKICAgICAgICAgICBsZXQgY2h1bmtzID0gW107CiAgICAgICAgICAgIGNvbnN0IHsgYm9keSB9ID0gcmVxOwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnKmZpbGVzIGF3YWl0IHJlcS5hcnJheUJ1ZmZlcigpJywgYXdhaXQgcmVxLmFycmF5QnVmZmVyKCkpOwogICAgICAgICAgICAvL2NvbnNvbGUubG9nKCcqZmlsZXMgYXdhaXQgcmVxLnRleHQoKScsIGF3YWl0IHJlcS50ZXh0KCkpOwogICAgICAgICAgfSovCiAgICAgICAgICBjb25zdCB7IGZpbHRlciA9ICcqJywgcm9vdCwgdHlwZSA9IFRZUEVfRElSIHwgVFlQRV9SRUcgfCBUWVBFX0xOSywgbGltaXQgPSAnMCcgfSA9IHJlcS51cmwucXVlcnk7CgogICAgICAgICAgY29uc29sZS5sb2coJypmaWxlcycsIHsgcm9vdCwgZmlsdGVyLCB0eXBlIH0pOwoKICAgICAgICAgIGNvbnN0IFtvZmZzZXQgPSAwLCBzaXplID0gSW5maW5pdHldID0gbGltaXQuc3BsaXQoJywnKS5tYXAobiA9PiArbik7CgogICAgICAgICAgY29uc29sZS5sb2coJypmaWxlcycsIHsgb2Zmc2V0LCBzaXplIH0pOwoKICAgICAgICAgIGxldCBpID0gMDsKICAgICAgICAgIGxldCBmID0gTWF0Y2hlcihmaWx0ZXIpOwoKICAgICAgICAgIC8qICBsZXQgZ2VuID0gKGZ1bmN0aW9uKiBpdGVyKCkgeyovCiAgICAgICAgICBpZighcm9vdCkgewogICAgICAgICAgICBmb3IobGV0IG5hbWUgb2YgYWxsb3dlZERpcnMua2V5cygpLmZpbHRlcihmKSkgeWllbGQgbmFtZSArICcvXHJcbic7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmb3IobGV0IFtrZXksIHZhbHVlXSBvZiBhbGxvd2VkRGlycy5lbnRyaWVzKCkuZmlsdGVyKEtleU9yVmFsdWVNYXRjaGVyKHJvb3QpKSkgewogICAgICAgICAgICAgIGxldCBkaXIgPSBuZXcgRGlyZWN0b3J5KHZhbHVlLCBCT1RILCArdHlwZSk7CgogICAgICAgICAgICAgIHlpZWxkIGtleSArICc6XHJcbic7CgogICAgICAgICAgICAgIGZvcihsZXQgW25hbWUsIHR5cGVdIG9mIGRpci5maWx0ZXIoKFtuYW1lLCB0eXBlXSkgPT4gZihuYW1lKSkpCiAgICAgICAgICAgICAgICB5aWVsZCBuYW1lICsgKCt0eXBlID09IFRZUEVfRElSID8gJy8nIDogJycpICsgJ1xyXG4nOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBjb25zb2xlLmxvZygnKmZpbGVzJywgeyBpLCBmIH0pOwogICAgICAgICAgLyogfSkoKTsKICAgICAgICAgICAgY29uc29sZS5sb2coJypmaWxlcycsIHsgaSxmLGdlbiB9KTsKCiAgICAgICAgICAgIHlpZWxkKiBnZW4ucmFuZ2Uob2Zmc2V0LCBzaXplKTsqLwoKICAgICAgICAgIC8veWllbGQgJ1xyXG4nOwogICAgICAgIH0sCiAgICAgICAgZnVuY3Rpb24qIGZpbGVzMihyZXEsIHJlc3ApIHsKICAgICAgICAgIGxldCB7IGJvZHksIGhlYWRlcnMsIGpzb24sIHVybCB9ID0gcmVxOwogICAgICAgICAgbGV0IHsgcXVlcnkgfSA9IHVybDsKICAgICAgICAgIGRlZmluZShnbG9iYWxUaGlzLCB7IGZpbGVzUmVxdWVzdDogeyByZXEsIHJlc3AsIGJvZHksIHF1ZXJ5IH0gfSk7CiAgICAgICAgICBjb25zb2xlLmxvZygnKmZpbGVzJywgeyByZXEsIHJlc3AsIGJvZHksIHF1ZXJ5IH0pOwogICAgICAgICAgY29uc3QgZGF0YSA9IHF1ZXJ5ID8/IHt9OwogICAgICAgICAgcmVzcC50eXBlID0gJ2FwcGxpY2F0aW9uL2pzb24nOwogICAgICAgICAgbGV0IHsKICAgICAgICAgICAgZGlycyA9IGRlZmF1bHREaXJzLAogICAgICAgICAgICBmaWx0ZXIgPSAnW14uXS4qJyA/PyAnLihicmR8c2NofEdbQS1aXVtBLVpdKSQnLAogICAgICAgICAgICB2ZXJib3NlID0gZmFsc2UsCiAgICAgICAgICAgIG9iamVjdHMgPSB0cnVlLAogICAgICAgICAgICBrZXkgPSAnbXRpbWUnLAogICAgICAgICAgICBsaW1pdCA9IG51bGwsCiAgICAgICAgICAgIGZsYXQgPSBmYWxzZQogICAgICAgICAgfSA9IGRhdGEgPz8ge307CiAgICAgICAgICBsZXQgcmVzdWx0cyA9IFtdOwogICAgICAgICAgZm9yKGxldCBkaXIgb2YgZGlycykgewogICAgICAgICAgICBsZXQgc3QsCiAgICAgICAgICAgICAgbmFtZXMgPSBbXTsKICAgICAgICAgICAgaWYoQXJyYXkuaXNBcnJheShkaXIpKSB7CiAgICAgICAgICAgICAgbGV0IFssIHJlXSA9IGRpcjsKICAgICAgICAgICAgICBsZXQgYWJzZGlyID0gcGF0aC5yZWFscGF0aChkaXJbMF0pOwogICAgICAgICAgICAgIG5hbWVzID0gWy4uLlJlY3Vyc2l2ZURpckl0ZXJhdG9yKGFic2RpciwgbiA9PiByZS50ZXN0KG4pKV07CiAgICAgICAgICAgICAgZGlyID0gcGF0aC5yZWxhdGl2ZShhYnNkaXIsIHBhdGguZ2V0Y3dkKCkpOwogICAgICAgICAgICB9IGVsc2UgaWYoKHN0ID0gZnMuc3RhdFN5bmMoZGlyKSkgJiYgc3QuaXNEaXJlY3RvcnkoKSkgewogICAgICAgICAgICAgIGxldCBhYnNkaXIgPSBwYXRoLnJlYWxwYXRoKGRpcik7CiAgICAgICAgICAgICAgbGV0IGNvbXBvbmVudHMgPSBhYnNkaXIuc3BsaXQocGF0aC5zZXApOwogICAgICAgICAgICAgIGlmKGNvbXBvbmVudHMubGVuZ3RoICYmIGNvbXBvbmVudHNbMF0gPT09ICcnKSBjb21wb25lbnRzLnNoaWZ0KCk7CiAgICAgICAgICAgICAgaWYoY29tcG9uZW50cy5sZW5ndGggPCAyIHx8IGNvbXBvbmVudHNbMF0gIT0gJ2hvbWUnKSB0aHJvdyBuZXcgRXJyb3IoYEFjY2VzcyBlcnJvcmApOwogICAgICAgICAgICAgIG5hbWVzID0gZnMucmVhZGRpclN5bmMoYWJzZGlyKSA/PyBbXTsKICAgICAgICAgICAgICBkaXIgPSBwYXRoLnJlbGF0aXZlKGFic2RpciwgcGF0aC5nZXRjd2QoKSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgbmFtZXMgPSBnbG9iKGRpciwgR0xPQl9CUkFDRSk7CiAgICAgICAgICAgICAgaWYoIUFycmF5LmlzQXJyYXkobmFtZXMpKSBuYW1lcyA9IFtdOwogICAgICAgICAgICAgIGxldCBhID0gcGF0aC50b0FycmF5KGRpcik7CiAgICAgICAgICAgICAgbGV0IGkgPSBhLmZpbmRJbmRleChuID0+IC9bKnt9XS8udGVzdChuKSk7CiAgICAgICAgICAgICAgZGlyID0gcGF0aC5zbGljZShkaXIsIDAsIGkpOwogICAgICAgICAgICAgIG5hbWVzID0gbmFtZXMubWFwKG4gPT4gbi5zbGljZShkaXIubGVuZ3RoICsgMSkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCFBcnJheS5pc0FycmF5KG5hbWVzKSkgY29udGludWU7CiAgICAgICAgICAgIG5hbWVzID0gbmFtZXMuc29ydCgoYSwgYikgPT4gJycgKyBiIDwgJycgKyBhKTsKICAgICAgICAgICAgaWYoZmlsdGVyKSB7CiAgICAgICAgICAgICAgY29uc3QgcmUgPSBuZXcgUmVnRXhwKGZpbHRlciwgJ2dpJyk7CiAgICAgICAgICAgICAgbmFtZXMgPSBuYW1lcy5maWx0ZXIobmFtZSA9PiByZS50ZXN0KG5hbWUpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZihsaW1pdCkgewogICAgICAgICAgICAgIGxldCBbb2Zmc2V0ID0gMF0gPSBsaW1pdDsKICAgICAgICAgICAgICBsZXQgWywgbGVuZ3RoID0gbmFtZXMubGVuZ3RoIC0gc3RhcnRdID0gbGltaXQ7CiAgICAgICAgICAgICAgbmFtZXMgPSBuYW1lcy5zbGljZShvZmZzZXQsIG9mZnNldCArIGxlbmd0aCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IGVudHJpZXMgPSBuYW1lcwogICAgICAgICAgICAgIC5tYXAoZmlsZSA9PiAoZnMuZXhpc3RzU3luYyhgJHtkaXJ9LyR7ZmlsZX1gKSA/IGAke2Rpcn0vJHtmaWxlfWAgOiBmaWxlKSkKICAgICAgICAgICAgICAubWFwKGZpbGUgPT4gW2ZpbGUsIHBhdGgucmVsYXRpdmUoZmlsZSwgcGF0aC5nZXRjd2QoKSldKQogICAgICAgICAgICAgIC5tYXAoKFtmaWxlLCByZWxdKSA9PiBbZmlsZSwgZnMuc3RhdFN5bmMocmVsKV0pOwogICAgICAgICAgICBlbnRyaWVzID0gZW50cmllcy5yZWR1Y2UoKGFjYywgW2ZpbGUsIHN0XSkgPT4gewogICAgICAgICAgICAgIGxldCBuYW1lID0gZmlsZSArIChzdCAmJiBzdC5pc0RpcmVjdG9yeSgpID8gJy8nIDogJycpOwogICAgICAgICAgICAgIGxldCBvYmogPSB7CiAgICAgICAgICAgICAgICBuYW1lCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBhY2MucHVzaChbCiAgICAgICAgICAgICAgICBuYW1lLAogICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbigKICAgICAgICAgICAgICAgICAgb2JqLAogICAgICAgICAgICAgICAgICBzdAogICAgICAgICAgICAgICAgICAgID8gewogICAgICAgICAgICAgICAgICAgICAgICBtdGltZTogdG9Vbml4VGltZShzdC5tdGltZSksCiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWU6IHRvVW5peFRpbWUoc3QuY3RpbWUpLAogICAgICAgICAgICAgICAgICAgICAgICBtb2RlOiBgMCR7KHN0Lm1vZGUgJiAweDA5ZmYpLnRvU3RyaW5nKDgpfWAsCiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IHN0LnNpemUKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICA6IHt9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgICAgcmV0dXJuIGFjYzsKICAgICAgICAgICAgfSwgW10pOwogICAgICAgICAgICBpZihlbnRyaWVzLmxlbmd0aCkgewogICAgICAgICAgICAgIGxldCBjbXAgPSB7CiAgICAgICAgICAgICAgICBzdHJpbmcoYSwgYikgewogICAgICAgICAgICAgICAgICByZXR1cm4gYVsxXVtrZXldLmxvY2FsZUNvbXBhcmUoYlsxXVtrZXldKTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBudW1iZXIoYSwgYikgewogICAgICAgICAgICAgICAgICByZXR1cm4gYVsxXVtrZXldIC0gYlsxXVtrZXldOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH1bdHlwZW9mIGVudHJpZXNbMF1bMV1ba2V5XV07CiAgICAgICAgICAgICAgZW50cmllcyA9IGVudHJpZXMuc29ydChjbXApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG5hbWVzID0gZW50cmllcy5tYXAoKFtuYW1lLCBvYmpdKSA9PiAob2JqZWN0cyA/IG9iaiA6IG5hbWUpKTsKICAgICAgICAgICAgaWYobmFtZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIGlmKGZsYXQpIG5hbWVzLm1hcCgoeyBuYW1lIH0pID0+IHJlc3VsdHMucHVzaCh7IG5hbWU6IHBhdGgubm9ybWFsaXplKHBhdGguam9pbihkaXIsIG5hbWUpKSB9KSk7CiAgICAgICAgICAgICAgZWxzZSByZXN1bHRzLnB1c2goeyBkaXIsIG5hbWVzIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICB5aWVsZCBKU09OLnN0cmluZ2lmeSguLi5bcmVzdWx0cywgLi4uKHZlcmJvc2UgPyBbbnVsbCwgMl0gOiBbXSldKTsKICAgICAgICB9CiAgICAgIF0sCiAgICAgIC4uLnVybCwKCiAgICAgIC4uLmNhbGxiYWNrcywKICAgICAgb25Db25uZWN0KHdzLCByZXEpIHsKICAgICAgICBjb25zb2xlLmxvZygnb25Db25uZWN0XHgxYicpOwogICAgICAgIGNvbnN0IHsgcGVlciwgYWRkcmVzcywgcG9ydCwgcHJvdG9jb2wgfSA9IHdzOwoKICAgICAgICBjb25zb2xlLmxvZygnXHgxYlszODs1OzMzbW9uQ29ubmVjdFx4MWJbMG0nLCB7IGFkZHJlc3MsIHBvcnQsIHByb3RvY29sIH0pOwoKICAgICAgICB3cy5zZW5kQ29tbWFuZCA9IGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgICAgIGlmKCFpc0FycmF5QnVmZmVyKGRhdGEpIC8qJiYgaXNPYmplY3QoZGF0YSkqLykgZGF0YSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpOwoKICAgICAgICAgIHJldHVybiB0aGlzLnNlbmQoZGF0YSk7CiAgICAgICAgfTsKICAgICAgICBpZighd3MudXVpZCkgewogICAgICAgICAgbGV0IGRhdGEgPSAod3MudXVpZCA9IE1ha2VVVUlEKCkpOwoKICAgICAgICAgIHdzLnNlbmRDb21tYW5kKHsgdHlwZTogJ3V1aWQnLCBkYXRhIH0pOwogICAgICAgICAgYnlfdXVpZFtkYXRhXSA9IHdzOwogICAgICAgIH0KICAgICAgICBjb25uZWN0aW9ucy5hZGQod3MpOwoKICAgICAgICBpZihjYWxsYmFja3Mub25Db25uZWN0KSByZXR1cm4gY2FsbGJhY2tzLm9uQ29ubmVjdCh3cywgcmVxKTsKICAgICAgfSwKICAgICAgb25DbG9zZSh3cywgcmVhc29uKSB7CiAgICAgICAgY29ubmVjdGlvbnMuZGVsZXRlKHdzKTsKCiAgICAgICAgcmV0dXJuIGNhbGxiYWNrcy5vbkNsb3NlKHdzLCByZWFzb24pOwogICAgICB9LAogICAgICAvKiAgICAgIG9uUmVhZChkYXRhKSB7CiAgICAgICAgICAgY29uc3QgcmVxID0gdGhpczsKICAgICAgICAgIGNvbnNvbGUubG9nKCdvblJlYWQnLCB7IHJlcSwgZGF0YSB9KTsKICAgICAgICB9LCovCiAgICAgIC8qIG9uUG9zdChkYXRhKSB7CiAgICAgICAgIGNvbnN0IHJlcSA9IHRoaXM7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICByZXEuanNvbiA9IEpTT04ucGFyc2UoZGF0YSk7CiAgICAgICAgICB9IGNhdGNoKGVycm9yKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvblBvc3QnLCB7IHJlcSwgZGF0YSwgZXJyb3IgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSwqLwogICAgICBvbkh0dHAod3MsIHJlcSwgcmVzcCkgewogICAgICAgIC8qIGlmKHJlcS5tZXRob2QgIT0gJ0dFVCcpKi8gLy9jb25zb2xlLmxvZygnb25IdHRwJywgY29uc29sZS5jb25maWcoeyBjb21wYWN0OiAwIH0pLCB3cyk7CiAgICAgICAgLy8gICBjb25zb2xlLmxvZygnXHgxYlszODs1OzIyMG1vbkh0dHAoMSlceDFiWzBtJywgY29uc29sZS5jb25maWcoeyBjb21wYWN0OiAwIH0pLCB7IHJlcSB9KTsKCiAgICAgICAgZGVmaW5lKGdsb2JhbFRoaXMsIHsgd3MsIHJlcSwgcmVzcCB9KTsKCiAgICAgICAgY29uc3QgeyBwZWVyLCBhZGRyZXNzLCBwb3J0IH0gPSB3czsKICAgICAgICBjb25zdCB7IG1ldGhvZCwgaGVhZGVycyB9ID0gcmVxOwoKICAgICAgICBpZigocmVxLnVybC5wYXRoID8/ICcnKS5lbmRzV2l0aCgnZmlsZXMnKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgICAgLy9yZXNwLnR5cGUgPSAnYXBwbGljYXRpb24vanNvbic7CiAgICAgICAgfSBlbHNlIGlmKAogICAgICAgICAgcmVxLm1ldGhvZCAhPSAnR0VUJyAmJgogICAgICAgICAgKHJlcS5oZWFkZXJzWydjb250ZW50LXR5cGUnXSA9PSAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyB8fAogICAgICAgICAgICByZXEuaGVhZGVyc1snY29udGVudC10eXBlJ10uc3RhcnRzV2l0aCgnbXVsdGlwYXJ0L2Zvcm0tZGF0YScpKQogICAgICAgICkgewogICAgICAgICAgbGV0IGZwLAogICAgICAgICAgICBoYXNoLAogICAgICAgICAgICB0bXBuYW0sCiAgICAgICAgICAgIGV4dCwKICAgICAgICAgICAgcHJvZ3Jlc3MgPSAwOwogICAgICAgICAgY29uc29sZS5sb2cocmVxLm1ldGhvZCwgaGVhZGVycyk7CiAgICAgICAgICBpZihyZXEudXJsLnBhdGguZW5kc1dpdGgoJ3VwbG9hZCcpKSByZXNwLnN0YXR1cyA9IDIwMDsKICAgICAgICAgIHJlc3AudHlwZSA9ICd0ZXh0L3Jhdyc7CgogICAgICAgICAgZnAgPSBuZXcgRm9ybVBhcnNlcih3cywgWydmaWxlcycsICd1dWlkJ10sIHsKICAgICAgICAgICAgY2h1bmtTaXplOiA4MTkyIC8qKiAyNTYqLywKICAgICAgICAgICAgb25PcGVuKG5hbWUsIGZpbGVuYW1lKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coYG9uT3Blbigke25hbWV9LCAke2ZpbGVuYW1lfSlgKTsKICAgICAgICAgICAgICBpZih0aGlzLmZpbGUpIHsKICAgICAgICAgICAgICAgIHRoaXMub25jbG9zZS5jYWxsKHRoaXMsIG5hbWUpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGhpcy5uYW1lID0gbmFtZTsKICAgICAgICAgICAgICB0aGlzLmZpbGVuYW1lID0gZmlsZW5hbWU7CiAgICAgICAgICAgICAgZXh0ID0gcGF0aC5leHRuYW1lKGZpbGVuYW1lKS50b0xvd2VyQ2FzZSgpOwoKICAgICAgICAgICAgICB0aGlzLmZpbGUgPSBmcy5vcGVuU3luYygodGhpcy50ZW1wID0gJ3VwbG9hZHMvJyArICh0bXBuYW0gPSByYW5kU3RyKDIwKSArICcudG1wJykpLCAndysnLCAwbzY0NCk7CiAgICAgICAgICAgICAgaGFzaCA9IG5ldyBIYXNoKEhhc2guVFlQRV9TSEExKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25Db250ZW50KG5hbWUsIGRhdGEpIHsKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgb25Db250ZW50KCR7dGhpcy5maWxlbmFtZX0pYCxkYXRhLmJ5dGVMZW5ndGgpOwogICAgICAgICAgICAgIHByb2dyZXNzICs9IGRhdGEuYnl0ZUxlbmd0aDsKCiAgICAgICAgICAgICAgbGV0IHdzMiA9IGJ5X3V1aWRbd3MudXVpZCA/PyB0aGlzLnV1aWRdOwoKICAgICAgICAgICAgICBmcy53cml0ZVN5bmModGhpcy5maWxlLCBkYXRhKTsKICAgICAgICAgICAgICBoYXNoLnVwZGF0ZShkYXRhKTsKICAgICAgICAgICAgICBpZih3czIpCiAgICAgICAgICAgICAgICB3czIuc2VuZENvbW1hbmQoewogICAgICAgICAgICAgICAgICB0eXBlOiAncHJvZ3Jlc3MnLAogICAgICAgICAgICAgICAgICBkb25lOiBwcm9ncmVzcywKICAgICAgICAgICAgICAgICAgbmFtZSwKICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6IHRoaXMuZmlsZW5hbWUsCiAgICAgICAgICAgICAgICAgIHRvdGFsOiAraGVhZGVyc1snY29udGVudC1sZW5ndGgnXQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sCgogICAgICAgICAgICBvbkNsb3NlKG5hbWUsIGZpbGUpIHsKICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYG9uQ2xvc2VbMV0oJHtuYW1lfSwgJHtmaWxlfSlgLCB0aGlzLnV1aWQpOwogICAgICAgICAgICAgICAgbGV0IGV4aWYsIGNhY2hlLCBzaGExOwogICAgICAgICAgICAgICAgaWYoaGFzaCkgewogICAgICAgICAgICAgICAgICBoYXNoLmZpbmFsaXplKCk7CiAgICAgICAgICAgICAgICAgIHNoYTEgPSBoYXNoLnRvU3RyaW5nKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZih0aGlzLmZpbGUpIHsKICAgICAgICAgICAgICAgICAgZnMuY2xvc2VTeW5jKHRoaXMuZmlsZSk7CiAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZSA9IG51bGw7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZihzaGExKSB7CiAgICAgICAgICAgICAgICAgIGxldCBmID0geCA9PiAndXBsb2Fkcy8nICsgc2hhMSArIHg7CiAgICAgICAgICAgICAgICAgIGxldCByZXQgPSBsaW5rKHRoaXMudGVtcCwgZihleHQpKTsKICAgICAgICAgICAgICAgICAgbGV0IHsgZXJybm8gfSA9IGVycm9yKCk7CiAgICAgICAgICAgICAgICAgIGxldCBqc29uID0gZignLmpzb24nKTsKICAgICAgICAgICAgICAgICAgaWYoZnMuZXhpc3RzU3luYyhqc29uKSAmJiAoY2FjaGUgPSBSZWFkSlNPTihqc29uKSkpIHsKICAgICAgICAgICAgICAgICAgICBleGlmID0gY2FjaGUuZXhpZjsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZighLyhwbmd8c3ZnfGdpZnx0Z2EpJC9pLnRlc3QoZXh0KSkgewogICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgZXhpZiA9IFJlYWRFeGlmdG9vbChmKGV4dCkpOwogICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaChlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgZXhpZiA9IFJlYWRFeGlmdG9vbCh0aGlzLnRlbXApOwogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoKGUpIHt9CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGxldCBvYmogPSB7CiAgICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZTogdGhpcy5maWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICAgIHN0b3JhZ2U6IGYoZXh0KSwKICAgICAgICAgICAgICAgICAgICAgIHVwbG9hZGVkOiBEYXRlLm5vdygpLAogICAgICAgICAgICAgICAgICAgICAgYWRkcmVzcywKICAgICAgICAgICAgICAgICAgICAgIGV4aWYKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGlmKCEvanBlP2ckLy50ZXN0KGV4dCkpIHsKICAgICAgICAgICAgICAgICAgICAgIEhlaWZDb252ZXJ0KGYoZXh0KSwgZignLmpwZycpKTsKICAgICAgICAgICAgICAgICAgICAgIGlmKGZzLmV4aXN0c1N5bmMoZignLmpwZycpKSkgb2JqLmpwZyA9IGYoJy5qcGcnKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgbGV0IHdpZHRoID0gJycsCiAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSAnMjU2JzsKCiAgICAgICAgICAgICAgICAgICAgaWYoZXhpZikgewogICAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBJbWFnZVNpemUsIEltYWdlSGVpZ2h0LCBJbWFnZVdpZHRoIH0gPSBleGlmOwogICAgICAgICAgICAgICAgICAgICAgbGV0IGFzcGVjdCA9IEltYWdlV2lkdGggLyBJbWFnZUhlaWdodDsKICAgICAgICAgICAgICAgICAgICAgIGlmKGFzcGVjdCA+PSAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoID0gMjU2OwogICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSB3aWR0aCAvIGFzcGVjdDsKICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8qIGhlaWdodCA9IDI1NjsKICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aCA9IGhlaWdodCAqIGFzcGVjdDsqLwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgTWFnaWNrUmVzaXplKG9iai5qcGcgPz8gZihleHQpLCBmKCcudGh1bWIuanBnJyksIG9iai5leGlmPy5Sb3RhdGlvbiA/PyAwLCB3aWR0aCwgaGVpZ2h0KTsKCiAgICAgICAgICAgICAgICAgICAgaWYoZnMuZXhpc3RzU3luYyhmKCcudGh1bWIuanBnJykpKSBvYmoudGh1bWJuYWlsID0gZignLnRodW1iLmpwZycpOwogICAgICAgICAgICAgICAgICAgIFdyaXRlSlNPTihqc29uLCBvYmopOwogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGBieV91dWlkYCwgYnlfdXVpZCk7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYHV1aWRgLCB3cy51dWlkID8/IHRoaXMudXVpZCk7CiAgICAgICAgICAgICAgICAgICAgY2FjaGUgPSBvYmo7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgaWYocmV0ID09IDAgfHwgZXJybm8gPT0gMTcpIHsKICAgICAgICAgICAgICAgICAgICB1bmxpbmsodGhpcy50ZW1wKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXAgPSBudWxsOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zdCB7IGZpbGVuYW1lIH0gPSB0aGlzOwogICAgICAgICAgICAgICAgbGV0IHdzMiA9IGJ5X3V1aWRbd3MudXVpZCA/PyB0aGlzLnV1aWRdOwogICAgICAgICAgICAgICAgaWYod3MyKQogICAgICAgICAgICAgICAgICB3czIuc2VuZENvbW1hbmQoewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICd1cGxvYWQnLAogICAgICAgICAgICAgICAgICAgIC4uLihjYWNoZSA/PyB7fSksCiAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUsCiAgICAgICAgICAgICAgICAgICAgZXhpZgogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIC8vICBjb25zb2xlLmxvZyhgb25DbG9zZVsyXSgke25hbWV9LCAke2ZpbGV9KWApOwogICAgICAgICAgICAgIH0gY2F0Y2goZSkgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYG9uQ2xvc2UgRVJST1I6YCwgZS5tZXNzYWdlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9uRmluYWxpemUoKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coYG9uRmluYWxpemUoKSBmb3JtIHBhcnNlcmAsIHRoaXMudXVpZCk7CiAgICAgICAgICAgICAgcmVzcC5ib2R5ID0gYGRvbmU6ICR7cHJvZ3Jlc3N9IGJ5dGVzIHJlYWRcclxuYDsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgIGlmKCFyZXEuaGVhZGVycyB8fCB0eXBlb2YgcmVxLmhlYWRlcnMgIT0gJ29iamVjdCcpCiAgICAgIGNvbnNvbGUubG9nKCdObyBoZWFkZXJzJywgcmVxKTsKCiAgICAgICAgY29uc3QgeyBib2R5LCB1cmwgfSA9IHJlc3A7CiAgICAgICAgY29uc3QgeyByZWZlcmVyIH0gPSByZXEuaGVhZGVyczsKCiAgICAgICAgbGV0IGZpbGUgPSB1cmwucGF0aC5zbGljZSgxKTsKICAgICAgICBjb25zdCBkaXIgPSBwYXRoLmRpcm5hbWUoZmlsZSk7IC8vZmlsZS5yZXBsYWNlKC9cL1teXC9dKiQvZywgJycpOwoKICAgICAgICBpZihmaWxlLmVuZHNXaXRoKCcudHh0JykgfHwgZmlsZS5lbmRzV2l0aCgnLmh0bWwnKSB8fCBmaWxlLmVuZHNXaXRoKCcuY3NzJykpIHsKICAgICAgICAgIHJlc3AuYm9keSA9IGZzLnJlYWRGaWxlU3luYyhmaWxlLCAndXRmLTgnKTsKICAgICAgICB9IGVsc2UgaWYoZmlsZS5lbmRzV2l0aCgnLmpzJykpIHsKICAgICAgICAgIGxldCBmaWxlMSA9IGZpbGU7CiAgICAgICAgICBpZigvcWpzLW1vZHVsZXNcL2xpYi8udGVzdChmaWxlKSAmJiAhLyhkb218dXRpbClcLmpzLy50ZXN0KGZpbGUpKSB7CiAgICAgICAgICAgIGxldCBmaWxlMiA9IGZpbGUucmVwbGFjZSgvLipxanMtbW9kdWxlc1wvL2csICcnKTsKICAgICAgICAgICAgaWYoZnMuZXhpc3RzU3luYyhmaWxlMikpIHsKICAgICAgICAgICAgICBmaWxlID0gZmlsZTI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZighZnMuZXhpc3RzU3luYyhmaWxlKSkgewogICAgICAgICAgICBmb3IobGV0IGRpciBvZiBbJ3F1aWNranMvcWpzLW1vZHVsZXMnLCAncXVpY2tqcy9xanMtbW9kdWxlcy9saWInLCAnLicsICdsaWInXSkgewogICAgICAgICAgICAgIGxldCBmaWxlMiA9IGRpciArICcvJyArIGZpbGU7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2luZXhpc3RlbnQgZmlsZScsIGZpbGUsIGZpbGUyLCBmcy5leGlzdHNTeW5jKGZpbGUyKSwgcmVmZXJlcik7CiAgICAgICAgICAgICAgaWYoZnMuZXhpc3RzU3luYyhmaWxlMikpIHsKICAgICAgICAgICAgICAgIGZpbGUgPSBmaWxlMjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmKGZpbGUxICE9IGZpbGUpIHsKICAgICAgICAgICAgLy8gIGNvbnNvbGUubG9nKCdceDFiWzM4OzU7MjE0bW9uSHR0cFx4MWJbMG0nLCBmaWxlMSwgJy0+JywgZmlsZSk7CiAgICAgICAgICAgIHJlc3Auc3RhdHVzID0gMzAyOwogICAgICAgICAgICByZXNwLmhlYWRlcnMgPSB7IFsnTG9jYXRpb24nXTogJy8nICsgZmlsZSB9OwogICAgICAgICAgICByZXR1cm4gcmVzcDsKICAgICAgICAgIH0KICAgICAgICAgIC8vY29uc29sZS5sb2coJ1x4MWJbMzg7NTszM21vbkh0dHBceDFiWzBtJywgZmlsZTEsIGZpbGUpOwoKICAgICAgICAgIC8vCiAgICAgICAgICBsZXQgYm9keSA9IGZzLnJlYWRGaWxlU3luYyhmaWxlLCAndXRmLTgnKTsKCiAgICAgICAgICBjb25zdCByZSA9IC9eKFxzKihpbXxleClwb3J0W15cbl0qZnJvbSBbJyJdKShbXi4vJyJdKikoWyciXVxzKjtbXHQgXSpcbj8pL2dtOwoKICAgICAgICAgIHJlc3AuYm9keSA9IGJvZHkucmVwbGFjZUFsbChyZSwgKG1hdGNoLCBwMSwgcDAsIHAyLCBwMywgb2Zmc2V0KSA9PiB7CiAgICAgICAgICAgIGlmKCEvW1wvXC5dLy50ZXN0KHAyKSkgewogICAgICAgICAgICAgIGxldCBmbmFtZSA9IGAke3AyfS5qc2A7CiAgICAgICAgICAgICAgbGV0IHJlbCA9IHBhdGgucmVsYXRpdmUoZm5hbWUsIGRpcik7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ29uSHR0cCcsIHsgbWF0Y2gsIGZuYW1lIH0sIHJlbCk7CgogICAgICAgICAgICAgIC8vIGlmKCFmcy5leGlzdHNTeW5jKCAgcmVsKSkgcmV0dXJuIGBgOwoKICAgICAgICAgICAgICBtYXRjaCA9IFtwMSwgcmVsLCBwM10uam9pbignJyk7CgogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhcmdzJywgewogICAgICAgICAgICAgICAgbWF0Y2gsCiAgICAgICAgICAgICAgICBwMSwKICAgICAgICAgICAgICAgIHAyLAogICAgICAgICAgICAgICAgcDMsCiAgICAgICAgICAgICAgICBvZmZzZXQKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbWF0Y2g7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgewogICAgICAgICAgbGV0IHsgYm9keSB9ID0gcmVzcDsKICAgICAgICAgIC8vY29uc29sZS5sb2coJ1x4MWJbMzg7NTsyMTJtb25IdHRwKDIpXHgxYlswbScsIHsgYm9keSB9KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXNwOwogICAgICB9LAogICAgICBvbk1lc3NhZ2Uod3MsIGRhdGEpIHsKICAgICAgICBjb25zb2xlLmxvZygnb25NZXNzYWdlJywgd3MsIGRhdGEpOwogICAgICAgIHJldHVybiBjYWxsYmFja3Mub25NZXNzYWdlKHdzLCBkYXRhKTsKICAgICAgfSwKICAgICAgb25GZChmZCwgcmQsIHdyKSB7CiAgICAgICAgcmV0dXJuIGNhbGxiYWNrcy5vbkZkKGZkLCByZCwgd3IpOwogICAgICB9LAogICAgICAuLi4odXJsICYmIHVybC5ob3N0ID8gdXJsIDoge30pCiAgICB9KTsKICB9KTsKCiAgZGVmaW5lKGdsb2JhbFRoaXMsIHsKICAgIGdldCBjb25uZWN0aW9ucygpIHsKICAgICAgcmV0dXJuIFsuLi5jb25uZWN0aW9uc107CiAgICB9LAogICAgZ2V0IGJ5X3V1aWQoKSB7CiAgICAgIHJldHVybiBieV91dWlkOwogICAgfSwKICAgIHV1aWQoZGF0YSkgewogICAgICByZXR1cm4gYnlfdXVpZFtkYXRhXTsKICAgIH0KICB9KTsKCiAgT2JqZWN0LmFzc2lnbihnbG9iYWxUaGlzLCB7CiAgICByZXBsLAogICAgcXVpdCwKICAgIGV4aXQ6IHF1aXQsCiAgICBzdGQsCiAgICBvcywKICAgIGRlZXAsCiAgICBmcywKICAgIHBhdGgsCiAgICBSZWFkSlNPTiwKICAgIFdyaXRlSlNPTiwKICAgIFJlYWRGaWxlLAogICAgV3JpdGVGaWxlLAogICAgUmVhZEJKU09OLAogICAgV3JpdGVCSlNPTiwKICAgIHBhcnNlRGF0ZSwKICAgIGRhdGVUb09iamVjdCwKICAgIEhhc2gsCiAgICBGb3JtUGFyc2VyLAogICAgRXhlY1Rvb2wsCiAgICBFeGVjdXRlLAogICAgZXh0ZW5kR2VuZXJhdG9yLAogICAgZXh0ZW5kQXJyYXksCiAgICBleHRlbmRBc3luY0dlbmVyYXRvciwKICAgIE1hdGNoZXIsCiAgICBFeGVjVG9vbCwKICAgIEdldE1pbWUsCiAgICBNYXRjaGVyLAogICAgS2V5T3JWYWx1ZU1hdGNoZXIsCiAgICBHZXRSb290RGlyZWN0b3JpZXMsCiAgICBHZXREaXIsCiAgICBEaXJOYW1lLAogICAgRGF0ZVN0ciwKICAgIE1vZGVTdHIsCiAgICBSZWFkRXhpdjIsCiAgICBSZWFkRXhpZnRvb2wsCiAgICBIZWlmQ29udmVydCwKICAgIE1hZ2lja1Jlc2l6ZSwKICAgIERpcmVjdG9yeSwKICAgIG5ldDogeyBzZXRMb2csIExMTF9VU0VSLCBMTExfTk9USUNFLCBMTExfV0FSTiwgTExMX0lORk8sIGNsaWVudCwgc2VydmVyLCBGb3JtUGFyc2VyLCBIYXNoLCBSZXNwb25zZSwgU29ja2V0IH0KICB9KTsKCiAgZGVsZXRlIGdsb2JhbFRoaXMuREVCVUc7CgogIGNyZWF0ZVdTKAogICAgeyBwcm90b2NvbDogJ3dzJywgaG9zdDogJzAuMC4wLjAnLCBwb3J0OiA4OTk5IH0sCiAgICB7CiAgICAgIG9uRmQoZmQsIHJkLCB3cikgewogICAgICAgIG9zLnNldFJlYWRIYW5kbGVyKGZkLCByZCk7CiAgICAgICAgb3Muc2V0V3JpdGVIYW5kbGVyKGZkLCB3cik7CiAgICAgIH0sCiAgICAgIG9uQ2xvc2Uod3MsIHJlYXNvbikge30sCiAgICAgIG9uTWVzc2FnZSh3cywgZGF0YSkge30KICAgIH0sCiAgICB0cnVlCiAgKTsKCiAgZnVuY3Rpb24gcXVpdCh3aHkpIHsKICAgIGNvbnNvbGUubG9nKGBxdWl0KCcke3doeX0nKWApOwoKICAgIGxldCBjZmcgPSB7IGluc3BlY3RPcHRpb25zOiBjb25zb2xlLm9wdGlvbnMgfTsKICAgIFdyaXRlSlNPTihgLiR7YmFzZX0tY29uZmlnYCwgY2ZnKTsKICAgIHJlcGwuY2xlYW51cCh3aHkpOwogIH0KCiAgcmVwbC5ydW5TeW5jKCk7Cn0KCnRyeSB7CiAgbWFpbiguLi5zY3JpcHRBcmdzLnNsaWNlKDEpKTsKfSBjYXRjaChlcnJvcikgewogIGNvbnNvbGUubG9nKGBGQUlMOiAke2Vycm9yPy5tZXNzYWdlID8/IGVycm9yfVxuJHtlcnJvcj8uc3RhY2t9YCk7CiAgMTsKICBzdGQuZXhpdCgxKTsKfSBmaW5hbGx5IHsKfQoAAAAAAAAAALuGAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA2nYAAAAAAADadgAAAAAAAAAAAAAAAPC/"
				],
				[
					156,
					1,
					"insert",
					{
						"characters": "\n\n"
					},
					"AgAAAKN2AAAAAAAApHYAAAAAAAAAAAAApHYAAAAAAACldgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAo3YAAAAAAACjdgAAAAAAAAAAAAAAAPC/"
				],
				[
					159,
					1,
					"insert",
					{
						"characters": "throw"
					},
					"BQAAAKV2AAAAAAAApnYAAAAAAAAAAAAApnYAAAAAAACndgAAAAAAAAAAAACndgAAAAAAAKh2AAAAAAAAAAAAAKh2AAAAAAAAqXYAAAAAAAAAAAAAqXYAAAAAAACqdgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAApXYAAAAAAACldgAAAAAAAAAAAAAAAAAA"
				],
				[
					160,
					1,
					"insert",
					{
						"characters": " new"
					},
					"BAAAAKp2AAAAAAAAq3YAAAAAAAAAAAAAq3YAAAAAAACsdgAAAAAAAAAAAACsdgAAAAAAAK12AAAAAAAAAAAAAK12AAAAAAAArnYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAqnYAAAAAAACqdgAAAAAAAAAAAAAAAPC/"
				],
				[
					161,
					1,
					"insert",
					{
						"characters": " Error"
					},
					"BgAAAK52AAAAAAAAr3YAAAAAAAAAAAAAr3YAAAAAAACwdgAAAAAAAAAAAACwdgAAAAAAALF2AAAAAAAAAAAAALF2AAAAAAAAsnYAAAAAAAAAAAAAsnYAAAAAAACzdgAAAAAAAAAAAACzdgAAAAAAALR2AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAArnYAAAAAAACudgAAAAAAAAAAAAAAAPC/"
				],
				[
					162,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAALR2AAAAAAAAtnYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAtHYAAAAAAAC0dgAAAAAAAAAAAAAAAPC/"
				],
				[
					163,
					1,
					"insert_snippet",
					{
						"contents": "`$0`"
					},
					"AQAAALV2AAAAAAAAt3YAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAtXYAAAAAAAC1dgAAAAAAAAAAAAAAAPC/"
				],
				[
					164,
					1,
					"left_delete",
					null,
					"AQAAALV2AAAAAAAAtXYAAAAAAAABAAAAYA",
					"AQAAAAAAAAABAAAAtnYAAAAAAAC2dgAAAAAAAAAAAAAAAPC/"
				],
				[
					166,
					1,
					"insert",
					{
						"characters": "http"
					},
					"BAAAALZ2AAAAAAAAt3YAAAAAAAAAAAAAt3YAAAAAAAC4dgAAAAAAAAAAAAC4dgAAAAAAALl2AAAAAAAAAAAAALl2AAAAAAAAunYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAtnYAAAAAAAC2dgAAAAAAAAAAAAAAAPC/"
				],
				[
					167,
					1,
					"insert",
					{
						"characters": " request"
					},
					"CAAAALp2AAAAAAAAu3YAAAAAAAAAAAAAu3YAAAAAAAC8dgAAAAAAAAAAAAC8dgAAAAAAAL12AAAAAAAAAAAAAL12AAAAAAAAvnYAAAAAAAAAAAAAvnYAAAAAAAC/dgAAAAAAAAAAAAC/dgAAAAAAAMB2AAAAAAAAAAAAAMB2AAAAAAAAwXYAAAAAAAAAAAAAwXYAAAAAAADCdgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAunYAAAAAAAC6dgAAAAAAAAAAAAAAAPC/"
				],
				[
					168,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAMJ2AAAAAAAAw3YAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAwnYAAAAAAADCdgAAAAAAAAAAAAAAAPC/"
				],
				[
					170,
					1,
					"insert",
					{
						"characters": "${"
					},
					"AgAAALt2AAAAAAAAvHYAAAAAAAAAAAAAvHYAAAAAAAC9dgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAu3YAAAAAAAC7dgAAAAAAAAAAAAAAAPC/"
				],
				[
					171,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAL12AAAAAAAAvnYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAvXYAAAAAAAC9dgAAAAAAAAAAAAAAAPC/"
				],
				[
					172,
					1,
					"left_delete",
					null,
					"AQAAAL12AAAAAAAAvXYAAAAAAAABAAAAIA",
					"AQAAAAAAAAABAAAAvnYAAAAAAAC+dgAAAAAAAAAAAAAAAPC/"
				],
				[
					173,
					1,
					"insert",
					{
						"characters": "method}"
					},
					"BwAAAL12AAAAAAAAvnYAAAAAAAAAAAAAvnYAAAAAAAC/dgAAAAAAAAAAAAC/dgAAAAAAAMB2AAAAAAAAAAAAAMB2AAAAAAAAwXYAAAAAAAAAAAAAwXYAAAAAAADCdgAAAAAAAAAAAADCdgAAAAAAAMN2AAAAAAAAAAAAAMN2AAAAAAAAxHYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAvXYAAAAAAAC9dgAAAAAAAAAAAAAAAPC/"
				],
				[
					174,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAMR2AAAAAAAAxXYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAxHYAAAAAAADEdgAAAAAAAAAAAAAAAPC/"
				],
				[
					176,
					1,
					"left_delete",
					null,
					"AQAAAMx2AAAAAAAAzHYAAAAAAAABAAAAIA",
					"AQAAAAAAAAABAAAAzXYAAAAAAADNdgAAAAAAAAAAAAAAAPC/"
				],
				[
					177,
					1,
					"insert",
					{
						"characters": "`"
					},
					"AQAAAMx2AAAAAAAAzXYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAzHYAAAAAAADMdgAAAAAAAAAAAAAAAPC/"
				],
				[
					179,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAM52AAAAAAAAz3YAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAznYAAAAAAADOdgAAAAAAAAAAAAAAAPC/"
				],
				[
					201,
					1,
					"insert",
					{
						"characters": "\n"
					},
					"AQAAAM92AAAAAAAA0HYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAz3YAAAAAAADPdgAAAAAAAP///////+9/"
				],
				[
					203,
					1,
					"insert",
					{
						"characters": "\t\t\t"
					},
					"AwAAAKV2AAAAAAAAp3YAAAAAAAAAAAAAp3YAAAAAAACpdgAAAAAAAAAAAACpdgAAAAAAAKt2AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAApXYAAAAAAACldgAAAAAAAAAAAAAAAAAA"
				],
				[
					205,
					1,
					"left_delete",
					null,
					"AQAAAKN2AAAAAAAAo3YAAAAAAAABAAAACg",
					"AQAAAAAAAAABAAAApHYAAAAAAACkdgAAAAAAAAAAAAAAAEhA"
				],
				[
					211,
					1,
					"insert",
					{
						"characters": "\t"
					},
					"AQAAAKR2AAAAAAAApnYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAApHYAAAAAAACkdgAAAAAAAAAAAAAAAAAA"
				],
				[
					215,
					1,
					"insert",
					{
						"characters": "//"
					},
					"AgAAAKx2AAAAAAAArXYAAAAAAAAAAAAArXYAAAAAAACudgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAArHYAAAAAAACsdgAAAAAAAAAAAAAAAPC/"
				],
				[
					230,
					3,
					"right_delete",
					null,
					"AwAAAKt2AAAAAAAAq3YAAAAAAAABAAAAIKt2AAAAAAAAq3YAAAAAAAABAAAAL6t2AAAAAAAAq3YAAAAAAAABAAAALw",
					"AQAAAAAAAAABAAAAq3YAAAAAAACrdgAAAAAAAAAAAAAAAPC/"
				],
				[
					235,
					1,
					"left_delete",
					null,
					"AQAAAKp2AAAAAAAAqnYAAAAAAAABAAAAIA",
					"AQAAAAAAAAABAAAAq3YAAAAAAACrdgAAAAAAAAAAAAAAAPC/"
				],
				[
					238,
					1,
					"insert",
					{
						"characters": "//"
					},
					"AgAAAKp2AAAAAAAAq3YAAAAAAAAAAAAAq3YAAAAAAACsdgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAqnYAAAAAAACqdgAAAAAAAAAAAAAAAPC/"
				],
				[
					243,
					1,
					"left_delete",
					null,
					"AQAAAKt2AAAAAAAAq3YAAAAAAAABAAAALw",
					"AQAAAAAAAAABAAAArHYAAAAAAACsdgAAAAAAAAAAAAAAAPC/"
				],
				[
					244,
					1,
					"insert",
					{
						"characters": "/"
					},
					"AQAAAKt2AAAAAAAArHYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAq3YAAAAAAACrdgAAAAAAAAAAAAAAAPC/"
				],
				[
					281,
					1,
					"cut",
					null,
					"AQAAAJFGAAAAAAAAkUYAAAAAAAAWAAAAZ2xvYigndXBsb2Fkcy8qLmpzb24nKQ",
					"AQAAAAAAAAABAAAAkUYAAAAAAACnRgAAAAAAAAAAAAAAAPC/"
				],
				[
					282,
					1,
					"paste",
					null,
					"AQAAAJFGAAAAAAAAp0YAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAkUYAAAAAAACRRgAAAAAAAAAAAAAAAPC/"
				],
				[
					288,
					1,
					"left_delete",
					null,
					"AQAAAHJGAAAAAAAAckYAAAAAAAABAAAAOw",
					"AQAAAAAAAAABAAAAc0YAAAAAAABzRgAAAAAAAAAAAAAAAPC/"
				],
				[
					289,
					1,
					"insert",
					{
						"characters": ","
					},
					"AQAAAHJGAAAAAAAAc0YAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAckYAAAAAAAByRgAAAAAAAAAAAAAAAPC/"
				],
				[
					290,
					1,
					"insert",
					{
						"characters": " entries="
					},
					"CQAAAHNGAAAAAAAAdEYAAAAAAAAAAAAAdEYAAAAAAAB1RgAAAAAAAAAAAAB1RgAAAAAAAHZGAAAAAAAAAAAAAHZGAAAAAAAAd0YAAAAAAAAAAAAAd0YAAAAAAAB4RgAAAAAAAAAAAAB4RgAAAAAAAHlGAAAAAAAAAAAAAHlGAAAAAAAAekYAAAAAAAAAAAAAekYAAAAAAAB7RgAAAAAAAAAAAAB7RgAAAAAAAHxGAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAc0YAAAAAAABzRgAAAAAAAAAAAAAAAPC/"
				],
				[
					291,
					1,
					"paste",
					null,
					"AQAAAHxGAAAAAAAAkkYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAfEYAAAAAAAB8RgAAAAAAAAAAAAAAAPC/"
				],
				[
					292,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAJJGAAAAAAAAk0YAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAkkYAAAAAAACSRgAAAAAAAAAAAAAAAPC/"
				],
				[
					297,
					1,
					"insert",
					{
						"characters": "typeof"
					},
					"BgAAALFGAAAAAAAAskYAAAAAAAAAAAAAskYAAAAAAACzRgAAAAAAAAAAAACzRgAAAAAAALRGAAAAAAAAAAAAALRGAAAAAAAAtUYAAAAAAAAAAAAAtUYAAAAAAAC2RgAAAAAAAAAAAAC2RgAAAAAAALdGAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAsUYAAAAAAACxRgAAAAAAAAAAAAAAAPC/"
				],
				[
					298,
					1,
					"insert",
					{
						"characters": " entries"
					},
					"CAAAALdGAAAAAAAAuEYAAAAAAAAAAAAAuEYAAAAAAAC5RgAAAAAAAAAAAAC5RgAAAAAAALpGAAAAAAAAAAAAALpGAAAAAAAAu0YAAAAAAAAAAAAAu0YAAAAAAAC8RgAAAAAAAAAAAAC8RgAAAAAAAL1GAAAAAAAAAAAAAL1GAAAAAAAAvkYAAAAAAAAAAAAAvkYAAAAAAAC/RgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAt0YAAAAAAAC3RgAAAAAAAAAAAAAAAPC/"
				],
				[
					299,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAL9GAAAAAAAAwEYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAv0YAAAAAAAC/RgAAAAAAAAAAAAAAAPC/"
				],
				[
					300,
					15,
					"left_delete",
					null,
					"DwAAAL9GAAAAAAAAv0YAAAAAAAABAAAAIL5GAAAAAAAAvkYAAAAAAAABAAAAc71GAAAAAAAAvUYAAAAAAAABAAAAZbxGAAAAAAAAvEYAAAAAAAABAAAAabtGAAAAAAAAu0YAAAAAAAABAAAAcrpGAAAAAAAAukYAAAAAAAABAAAAdLlGAAAAAAAAuUYAAAAAAAABAAAAbrhGAAAAAAAAuEYAAAAAAAABAAAAZbdGAAAAAAAAt0YAAAAAAAABAAAAILZGAAAAAAAAtkYAAAAAAAABAAAAZrVGAAAAAAAAtUYAAAAAAAABAAAAb7RGAAAAAAAAtEYAAAAAAAABAAAAZbNGAAAAAAAAs0YAAAAAAAABAAAAcLJGAAAAAAAAskYAAAAAAAABAAAAebFGAAAAAAAAsUYAAAAAAAABAAAAdA",
					"AQAAAAAAAAABAAAAwEYAAAAAAADARgAAAAAAAAAAAAAAAPC/"
				],
				[
					301,
					1,
					"insert",
					{
						"characters": "Array.isAr"
					},
					"CgAAALFGAAAAAAAAskYAAAAAAAAAAAAAskYAAAAAAACzRgAAAAAAAAAAAACzRgAAAAAAALRGAAAAAAAAAAAAALRGAAAAAAAAtUYAAAAAAAAAAAAAtUYAAAAAAAC2RgAAAAAAAAAAAAC2RgAAAAAAALdGAAAAAAAAAAAAALdGAAAAAAAAuEYAAAAAAAAAAAAAuEYAAAAAAAC5RgAAAAAAAAAAAAC5RgAAAAAAALpGAAAAAAAAAAAAALpGAAAAAAAAu0YAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAsUYAAAAAAACxRgAAAAAAAAAAAAAAAPC/"
				],
				[
					302,
					1,
					"insert",
					{
						"characters": "ray(entries)"
					},
					"DAAAALtGAAAAAAAAvEYAAAAAAAAAAAAAvEYAAAAAAAC9RgAAAAAAAAAAAAC9RgAAAAAAAL5GAAAAAAAAAAAAAL5GAAAAAAAAv0YAAAAAAAAAAAAAv0YAAAAAAADARgAAAAAAAAAAAADARgAAAAAAAMFGAAAAAAAAAAAAAMFGAAAAAAAAwkYAAAAAAAAAAAAAwkYAAAAAAADDRgAAAAAAAAAAAADDRgAAAAAAAMRGAAAAAAAAAAAAAMRGAAAAAAAAxUYAAAAAAAAAAAAAxUYAAAAAAADGRgAAAAAAAAAAAADGRgAAAAAAAMdGAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAu0YAAAAAAAC7RgAAAAAAAAAAAAAAAPC/"
				],
				[
					303,
					1,
					"insert",
					{
						"characters": " ?"
					},
					"AgAAAMdGAAAAAAAAyEYAAAAAAAAAAAAAyEYAAAAAAADJRgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAx0YAAAAAAADHRgAAAAAAAAAAAAAAAPC/"
				],
				[
					304,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAMlGAAAAAAAAykYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAyUYAAAAAAADJRgAAAAAAAAAAAAAAAPC/"
				],
				[
					307,
					1,
					"insert",
					{
						"characters": "entries"
					},
					"CAAAAMpGAAAAAAAAy0YAAAAAAAAAAAAAy0YAAAAAAADLRgAAAAAAABcAAABnbG9iKCd1cGxvYWRzLyouanNvbicpIMtGAAAAAAAAzEYAAAAAAAAAAAAAzEYAAAAAAADNRgAAAAAAAAAAAADNRgAAAAAAAM5GAAAAAAAAAAAAAM5GAAAAAAAAz0YAAAAAAAAAAAAAz0YAAAAAAADQRgAAAAAAAAAAAADQRgAAAAAAANFGAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAykYAAAAAAADhRgAAAAAAAAAAAAAAAPC/"
				],
				[
					308,
					1,
					"insert",
					{
						"characters": " :"
					},
					"AgAAANFGAAAAAAAA0kYAAAAAAAAAAAAA0kYAAAAAAADTRgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA0UYAAAAAAADRRgAAAAAAAAAAAAAAAPC/"
				],
				[
					309,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAANNGAAAAAAAA1EYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA00YAAAAAAADTRgAAAAAAAAAAAAAAAPC/"
				],
				[
					310,
					3,
					"right_delete",
					null,
					"AwAAANRGAAAAAAAA1EYAAAAAAAABAAAAP9RGAAAAAAAA1EYAAAAAAAABAAAAP9RGAAAAAAAA1EYAAAAAAAABAAAAIA",
					"AQAAAAAAAAABAAAA1EYAAAAAAADURgAAAAAAAAAAAAAAAPC/"
				],
				[
					311,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAANRGAAAAAAAA1UYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA1EYAAAAAAADURgAAAAAAAAAAAAAAAPC/"
				],
				[
					318,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAAAZhwAAaW1wb3J0ICogYXMgc3RkIGZyb20gJ3N0ZCc7CmltcG9ydCAqIGFzIG9zIGZyb20gJ29zJzsKaW1wb3J0ICogYXMgZGVlcCBmcm9tICcuL2xpYi9kZWVwLmpzJzsKaW1wb3J0ICogYXMgeG1sIGZyb20gJ3htbCc7CmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7CmltcG9ydCB7IENvbnNvbGUgfSBmcm9tICdjb25zb2xlJzsKaW1wb3J0IHsgRGlyZWN0b3J5LCBCT1RILCBUWVBFX0RJUiwgVFlQRV9MTkssIFRZUEVfUkVHLCBUWVBFX01BU0sgfSBmcm9tICdkaXJlY3RvcnknOwppbXBvcnQgUkVQTCBmcm9tICcuL3F1aWNranMvcWpzLW1vZHVsZXMvbGliL3JlcGwuanMnOwppbXBvcnQgaW5zcGVjdCBmcm9tICcuL2xpYi9vYmplY3RJbnNwZWN0LmpzJzsKaW1wb3J0ICogYXMgVGVybWluYWwgZnJvbSAnLi90ZXJtaW5hbC5qcyc7CmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJzsKaW1wb3J0IHsgbGluaywgdW5saW5rLCBlcnJvciwgZm5tYXRjaCwgRk5NX0VYVE1BVENIIH0gZnJvbSAnbWlzYyc7CmltcG9ydCB7IHRvU3RyaW5nLCBkZWZpbmUsIHRvVW5peFRpbWUsIGdldE9wdCwgcmFuZFN0ciwgaXNPYmplY3QsIGlzTnVtZXJpYywgaXNBcnJheUJ1ZmZlciwgZ2xvYiwgR0xPQl9CUkFDRSwgd2FpdEZvciB9IGZyb20gJ3V0aWwnOwppbXBvcnQgeyBzZXRMb2csIExMTF9VU0VSLCBMTExfTk9USUNFLCBMTExfV0FSTiwgTExMX0lORk8sIGNsaWVudCwgc2VydmVyLCBGb3JtUGFyc2VyLCBIYXNoLCBSZXNwb25zZSwgU29ja2V0IH0gZnJvbSAnbmV0JzsKaW1wb3J0IHsgcGFyc2VEYXRlLCBkYXRlVG9PYmplY3QgfSBmcm9tICcuL2RhdGUtaGVscGVycy5qcyc7CmltcG9ydCB7IElmRGVidWcsIExvZ0lmRGVidWcsIFJlYWRGaWxlLCBMb2FkSGlzdG9yeSwgUmVhZEpTT04sIFJlYWRYTUwsIE1hcEZpbGUsIFdyaXRlRmlsZSwgV3JpdGVKU09OLCBXcml0ZVhNTCwgUmVhZEJKU09OLCBXcml0ZUJKU09OLCBEaXJJdGVyYXRvciwgUmVjdXJzaXZlRGlySXRlcmF0b3IsIFJlYWREaXJSZWN1cnNpdmUsIEZpbHRlciwgRmlsdGVySW1hZ2VzLCBTb3J0RmlsZXMsIFN0YXRGaWxlcywgUmVhZEZkLCBGZFJlYWRlciwgQ29weVRvQ2xpcGJvYXJkLCBSZWFkQ2FsbGJhY2ssIExvZ0NhbGwsIFNwYXduLCBGZXRjaFVSTCB9IGZyb20gJy4vaW8taGVscGVycy5qcyc7CmltcG9ydCB7IHBhcnNlRGVnTWluU2VjLCBwYXJzZUdQU0xvY2F0aW9uIH0gZnJvbSAnLi9zdHJpbmctaGVscGVycy5qcyc7CmltcG9ydCB7IGgsIGh0bWwsIHJlbmRlciwgQ29tcG9uZW50LCB1c2VTdGF0ZSwgdXNlTGF5b3V0RWZmZWN0LCB1c2VSZWYgfSBmcm9tICcuL2xpYi9wcmVhY3QubWpzJzsKaW1wb3J0IHJlbmRlclRvU3RyaW5nIGZyb20gJy4vbGliL3ByZWFjdC1yZW5kZXItdG8tc3RyaW5nLmpzJzsKaW1wb3J0IHsgZXhlYywgc3Bhd24gfSBmcm9tICdjaGlsZF9wcm9jZXNzJzsKaW1wb3J0IHsgRXhlY3V0ZSB9IGZyb20gJy4vb3MtaGVscGVycy5qcyc7CmltcG9ydCB0cmtsIGZyb20gJy4vbGliL3Rya2wuanMnOwppbXBvcnQgeyB0YWtlIH0gZnJvbSAnLi9saWIvaXRlcmF0b3IvaGVscGVycy5qcyc7CmltcG9ydCB7IGV4dGVuZEFycmF5LCBleHRlbmRHZW5lcmF0b3IsIGV4dGVuZEFzeW5jR2VuZXJhdG9yIH0gZnJvbSAndXRpbCc7CgpleHRlbmRBcnJheSgpOwpleHRlbmRHZW5lcmF0b3IoKTsKZXh0ZW5kR2VuZXJhdG9yKE9iamVjdC5nZXRQcm90b3R5cGVPZihuZXcgTWFwKCkua2V5cygpKSk7CmV4dGVuZEdlbmVyYXRvcihPYmplY3QuZ2V0UHJvdG90eXBlT2YobmV3IERpcmVjdG9yeSgnLicpKSk7CmV4dGVuZEFzeW5jR2VuZXJhdG9yKCk7CgpnbG9iYWxUaGlzLmZzID0gZnM7Cmdsb2JhbFRoaXMubG9nRmlsdGVyID0KICAvKHdzX3NldF90aW1lb3V0OiBvbiBpbW1vcnRhbCBzdHJlYW18VW5oYW5kbGVkfFBST1hZLXxWSE9TVF9DRVJUX0FHSU5HfEJJTkR8RVZFTlRfV0FJVHxXUklUQUJMRSkvOwoKdHJrbC5wcm9wZXJ0eShnbG9iYWxUaGlzLCAnbG9nTGV2ZWwnKS5zdWJzY3JpYmUodmFsdWUgPT4KICBzZXRMb2codmFsdWUsIChsZXZlbCwgbWVzc2FnZSkgPT4gewogICAgaWYoCiAgICAgIC9fX2x3c3xzZXJ2ZV8ocmVzb2x2ZWR8Z2VuZXJhdG9yfHByb21pc2V8cmVzcG9uc2UpfChcKFsxMjNdXCkuKndyaXRhYmxlfHhcKFsvXVwpLipXUklURUFCTEUpfGx3c18vLnRlc3QobWVzc2FnZSkKICAgICkKICAgICAgcmV0dXJuOwogICAgaWYobGV2ZWwgPT0gTExMX0lORk8gJiYgIS9wcm94eS8udGVzdChtZXNzYWdlKSkgcmV0dXJuOwogICAgaWYobG9nRmlsdGVyLnRlc3QobWVzc2FnZSkpIHJldHVybjsKCiAgICAvL2lmKHBhcmFtcy5kZWJ1ZyB8fCBsZXZlbCA8PSBMTExfV0FSTikKICAgIG91dCgKICAgICAgKAogICAgICAgIFsnRVJSJywgJ1dBUk4nLCAnTk9USUNFJywgJ0lORk8nLCAnREVCVUcnLCAnUEFSU0VSJywgJ0hFQURFUicsICdFWFQnLCAnQ0xJRU5UJywgJ0xBVEVOQ1knLCAnTUlOTkVUJywgJ1RIUkVBRCddWwogICAgICAgICAgTWF0aC5sb2cyKGxldmVsKQogICAgICAgIF0gPz8gbGV2ZWwgKyAnJwogICAgICApLnBhZEVuZCg4KSArIG1lc3NhZ2UucmVwbGFjZSgvXG4vZywgJ1xcbicpLnJlcGxhY2UoL1xyL2csICdcXHInKQogICAgKTsKICB9KQopOwoKYXN5bmMgZnVuY3Rpb24gQXN5bmNDb2xsZWN0KGl0ZXIpIHsKICBsZXQgcmV0ID0gW107CiAgZm9yIGF3YWl0KGxldCBjaHVuayBvZiBhd2FpdCBpdGVyKSByZXQucHVzaChjaHVuayk7CiAgcmV0dXJuIHJldDsKfQoKZnVuY3Rpb24gRXhlY1Rvb2woY21kLCAuLi5hcmdzKSB7CiAgbGV0IGNoaWxkID0gc3Bhd24oY21kLCBhcmdzLCB7IHN0ZGlvOiBbMCwgJ3BpcGUnLCAyXSB9KTsKICBsZXQgW3N0ZGluLCBzdGRvdXQsIHN0ZGVycl0gPSBjaGlsZC5zdGRpbzsKICBsZXQgcjsKICBsZXQgYiA9IG5ldyBBcnJheUJ1ZmZlcigxMDI0KTsKICByID0gY2hpbGQud2FpdCgpOwogIC8vIGNvbnNvbGUubG9nKCdFeGVjVG9vbCcsIHsgYXJncywgY2hpbGQgfSk7CgogIHIgPSBvcy5yZWFkKHN0ZG91dCwgYiwgMCwgMTAyNCk7CiAgbGV0IGRhdGEgPSBiLnNsaWNlKDAsIHIpOwogIGxldCBzdHIgPSB0b1N0cmluZyhkYXRhKTsKCiAgcmV0dXJuIHN0cjsKfQoKZnVuY3Rpb24gR2V0TWltZShmaWxlKSB7CiAgbGV0IG91dHB1dCA9IEV4ZWNUb29sKCdmaWxlJywgJy1pJywgZmlsZSk7CiAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UoL1tcclxuXSokL2csICcnKTsKICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZShuZXcgUmVnRXhwKGZpbGUgKyAnOlxccysnKSwgJycpOwogIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC9cO1xzKi4qL2csICcnKTsKICByZXR1cm4gb3V0cHV0Owp9CgpmdW5jdGlvbiBNYXRjaGVyKHBhdHRlcm4sIHQgPSBhcmcgPT4gYXJnKSB7CiAgcmV0dXJuICguLi5hcmdzKSA9PiBwYXR0ZXJuID09IHQoLi4uYXJncykgfHwgMCA9PSBmbm1hdGNoKHBhdHRlcm4sIHQoLi4uYXJncyksIEZOTV9FWFRNQVRDSCk7Cn0KCmZ1bmN0aW9uIEtleU9yVmFsdWVNYXRjaGVyKHBhdHRlcm4pIHsKICBsZXQgbWF0Y2hlciA9IE1hdGNoZXIocGF0dGVybik7CiAgcmV0dXJuIChba2V5LCB2YWx1ZV0pID0+IG1hdGNoZXIoa2V5KSB8fCBtYXRjaGVyKHZhbHVlKTsKfQoKZnVuY3Rpb24gR2V0Um9vdERpcmVjdG9yaWVzKHBhdHRlcm4gPSAnKicpIHsKICByZXR1cm4gYWxsb3dlZERpcnMua2V5cygpLmZpbHRlcihNYXRjaGVyKHBhdHRlcm4pKTsKfQoKY29uc3QgTWFrZVVVSUQgPSAocm5nID0gTWF0aC5yYW5kb20pID0+IFs4LCA0LCA0LCA0LCAxMl0ubWFwKG4gPT4gcmFuZFN0cihuLCAnMDEyMzQ1Njc4OWFiY2RlZicpLCBybmcpLmpvaW4oJy0nKTsKCmNvbnN0IGRlZmF1bHREaXJzID0gKGdsb2JhbFRoaXMuZGVmYXVsdERpcnMgPSBbCiAgJy4nLAogIC4uLmdsb2IoJy4uLyovZWFnbGUnKSwKICAnLi91cGxvYWRzLyoue3NjaCxicmQsbGJyfScsCiAgJy9tbnQvZXh0ZXh0L1Bob3Rvcy8qQVBQTEUvKi57SlBHLFBORyxHSUYsQUFFLE1PVixIRUlDLE1QNCxXRUJQfScsCiAgWycvaG9tZS9yb21hbi9CaWxkZXInLCBuZXcgUmVnRXhwKCcuKGpwZ3xqcGVnfHBuZ3xoZWljfHRpZnx0aWZmKSQnLCAnaScpXQpdKTsKCmNvbnN0IGFsbG93ZWREaXJzID0gKGdsb2JhbFRoaXMuYWxsb3dlZERpcnMgPSBuZXcgTWFwKAogIGRlZmF1bHREaXJzCiAgICAubWFwKGRkID0+IEdldERpcihBcnJheS5pc0FycmF5KGRkKSA/IGRkWzBdIDogZGQpKQogICAgLm1hcChkID0+IHBhdGgucmVzb2x2ZShkKSkKICAgIC5tYXAoZCA9PiBwYXRoLnJlbGF0aXZlKGQpKQogICAgLm1hcChkID0+IFtEaXJOYW1lKGQpLCBkXSkKKSk7CgpmdW5jdGlvbiBHZXREaXIoZGlyKSB7CiAgbGV0IGEgPSBwYXRoLnRvQXJyYXkoZGlyKTsKICBsZXQgaSA9IGEuZmluZEluZGV4KG4gPT4gL1sqe31dLy50ZXN0KG4pKTsKICByZXR1cm4gaSAhPSAtMSA/IHBhdGguc2xpY2UoZGlyLCAwLCBpKSA6IGRpcjsKfQoKZnVuY3Rpb24gRGlyTmFtZShuYW1lKSB7CiAgbGV0IHAgPSBwYXRoLnJlbGF0aXZlKG5hbWUpOwoKICBwID0gcGF0aC5zbGljZSgKICAgIHAsCiAgICBwYXRoLnRvQXJyYXkocCkuZmluZEluZGV4KGl0ID0+IGl0ICE9ICcuLicpCiAgKTsKICByZXR1cm4gcDsKfQpmdW5jdGlvbiBEYXRlU3RyKGRhdGUpIHsKICBsZXQgc3RyID0gZGF0ZS50b0lTT1N0cmluZygpOwogIGxldCB0aSA9IHN0ci5pbmRleE9mKCdUJyk7CiAgcmV0dXJuICgKICAgIHN0ci5zdWJzdHJpbmcoMCwgdGkpIC8qLnJlcGxhY2UoLy0vZywgJycpKi8gKyAnICcgKyBzdHIuc3Vic3RyaW5nKHRpICsgMSwgdGkgKyAxICsgOCkgLy8ucmVwbGFjZSgvOi9nLCAnJykKICApOwp9CgpmdW5jdGlvbiBNb2RlU3RyKG1vZGUpIHsKICByZXR1cm4gKAogICAgKG1vZGUgJiAoMG8xMjAwMDAgPT0gMG8xMjAwMDApID8gJ2wnIDogbW9kZSAmIDBvNDAwMDAgPyAnZCcgOiAnLScpICsKICAgIChtb2RlICYgMGIxMDAwMDAwMDAgPyAncicgOiAnLScpICsKICAgIChtb2RlICYgMGIwMTAwMDAwMDAgPyAndycgOiAnLScpICsKICAgIChtb2RlICYgMGIwMDEwMDAwMDAgPyAneCcgOiAnLScpICsKICAgIChtb2RlICYgMGIxMDAwMDAgPyAncicgOiAnLScpICsKICAgIChtb2RlICYgMGIwMTAwMDAgPyAndycgOiAnLScpICsKICAgIChtb2RlICYgMGIwMDEwMDAgPyAneCcgOiAnLScpICsKICAgIChtb2RlICYgMGIxMDAgPyAncicgOiAnLScpICsKICAgIChtb2RlICYgMGIwMTAgPyAndycgOiAnLScpICsKICAgIChtb2RlICYgMGIwMDEgPyAneCcgOiAnLScpCiAgKTsKfQoKY29uc3QgSFRNTFBhZ2UgPSAoeyB0aXRsZSwgc3R5bGUsIHNjcmlwdHMgPSBbXSwgY2hpbGRyZW4sIC4uLnByb3BzIH0pID0+IHsKICByZXR1cm4gaCgnaHRtbCcsIHt9LCBbCiAgICBoKAogICAgICAnaGVhZCcsCiAgICAgIHt9LAogICAgICBbCiAgICAgICAgaCgndGl0bGUnLCB7fSwgW3RpdGxlXSksCiAgICAgICAgLi4uKHN0eWxlID8gW2goJ3N0eWxlJywgeyB0eXBlOiAndGV4dC9jc3MnIH0sIFtzdHlsZV0pXSA6IFtdKSwKICAgICAgICBoKAogICAgICAgICAgJ2xpbmsnLAogICAgICAgICAgewogICAgICAgICAgICByZWw6ICdzdHlsZXNoZWV0JywKICAgICAgICAgICAgaHJlZjogJ3N0YXRpYy9jc3MvbGlzdC5jc3MnCiAgICAgICAgICB9LAogICAgICAgICAgW10KICAgICAgICApCiAgICAgIF0uY29uY2F0KHNjcmlwdHMubWFwKHNjcmlwdCA9PiBoKCdzY3JpcHQnLCB7IHR5cGU6ICdtb2R1bGUnLCBzcmM6IHNjcmlwdCB9KSkpCiAgICApLAogICAgaCgnYm9keScsIHt9LCBjaGlsZHJlbiA/PyBbXSkKICBdKTsKfTsKCmNvbnN0IEZpbHRlckZvcm0gPSAoeyAuLi5wcm9wcyB9KSA9PgogIGgoJ2Zvcm0nLCB7IGFjdGlvbjogJ2ZpbGUnLCBtZXRob2Q6ICdQT1NUJyB9LCBbCiAgICBoKAogICAgICAnaW5wdXQnLAogICAgICB7CiAgICAgICAgdHlwZTogJ3RleHQnLAogICAgICAgIHNpemU6IDIwLAogICAgICAgIG5hbWU6ICdmaWx0ZXInLAogICAgICAgIHZhbHVlOiAnLionIC8qLAogICAgICAgICAgb25jaGFuZ2U6IGUgPT4gewogICAgICAgICAgICBjb25zb2xlLmxvZygnb25jaGFuZ2UnLCBlKTsKICAgICAgICAgIH0qLwogICAgICB9LAogICAgICBbXQogICAgKSwKICAgIGgoJ2lucHV0JywgeyB0eXBlOiAnc3VibWl0JywgdmFsdWU6ICdTdWJtaXQnLCBjbGFzczogJ2hpZGRlbicgfSwgW10pCiAgXSk7Cgpjb25zdCBIVE1MVGFibGUgPSAoeyByb3dzLCAuLi5wcm9wcyB9KSA9PiBoKCd0YWJsZScsIHByb3BzLCByb3dzKTsKY29uc3QgSFRNTFRhYmxlUm93ID0gKHsgY29sdW1ucywgLi4ucHJvcHMgfSkgPT4gaCgndHInLCBwcm9wcywgY29sdW1ucyk7CmNvbnN0IEhUTUxUYWJsZUNvbHVtbiA9ICh7IGNvbHVtbnMsIGNoaWxkcmVuLCB0YWcgPSAndGQnLCAuLi5wcm9wcyB9KSA9PiBoKHRhZywgcHJvcHMsIGNoaWxkcmVuKTsKCmNvbnN0IEZpbGVMaW5rID0gKHsgZmlsZSwgLi4ucHJvcHMgfSkgPT4gewogIHJldHVybiBoKCdhJywgeyBocmVmOiAnZmlsZS91cGxvYWRzLycgKyBmaWxlIH0sIFtmaWxlXSk7Cn07CmNvbnN0IEZpbGVPYmplY3QgPSAoeyBmaWxlLCBzdGF0ID0ge30sIC4uLnByb3BzIH0pID0+IHsKICBzdGF0ID8/PSBmcy5sc3RhdFN5bmMoJ3VwbG9hZHMvJyArIGZpbGUpOwogIC8vIGNvbnNvbGUubG9nKCdGaWxlT2JqZWN0JywgeyBmaWxlLCBzdGF0IH0pOwogIGxldCBpc0RpciA9IHN0YXQuaXNEaXJlY3RvcnkoKTsKCiAgcmV0dXJuIGgoSFRNTFRhYmxlUm93LCB7fSwgWwogICAgaChIVE1MVGFibGVDb2x1bW4sIHsgY2xhc3M6ICdtb2RlJyB9LCBbCiAgICAgIC8vKHN0YXQubW9kZSAmIDBiMTExMTExMTExKS50b1N0cmluZyg4KSwKICAgICAgTW9kZVN0cihzdGF0Lm1vZGUpCiAgICBdKSwKICAgIGgoSFRNTFRhYmxlQ29sdW1uLCB7IGNsYXNzOiAnZmlsZScgfSwgW2goRmlsZUxpbmssIHsgZmlsZTogZmlsZSArIChpc0RpciA/ICcvJyA6ICcnKSB9LCBbXSldKSwKICAgIGgoSFRNTFRhYmxlQ29sdW1uLCB7IGNsYXNzOiAnc2l6ZScgfSwgW3N0YXQuc2l6ZSArICcnXSksCiAgICBoKEhUTUxUYWJsZUNvbHVtbiwgeyBjbGFzczogJ2RhdGUnIH0sIFtEYXRlU3RyKG5ldyBEYXRlKHN0YXQuYXRpbWUpKV0pCiAgXSk7Cn07Cgpjb25zdCBGaWxlVGFibGUgPSAoeyBmaWxlcywgLi4ucHJvcHMgfSkgPT4gewogIC8vY29uc29sZS5sb2coJ0ZpbGVUYWJsZScsIGZpbGVzKTsKCiAgbGV0IGZpZWxkcyA9IFsnbW9kZScsICdmaWxlJywgJ3NpemUnLCAnYXRpbWUnXTsKCiAgZmlsZXMgPSBmaWxlcy5zb3J0KChhLCBiKSA9PiBhLmZpbGUubG9jYWxlQ29tcGFyZShiLmZpbGUpKTsKCiAgcmV0dXJuIGgoCiAgICBIVE1MVGFibGUsCiAgICB7CiAgICAgIC4uLnByb3BzLAogICAgICBjZWxsc3BhY2luZzogMCwKICAgICAgY2VsbHBhZGRpbmc6IDAsCiAgICAgIGJvcmRlcjogMCwKICAgICAgcm93czogWwogICAgICAgIGgoCiAgICAgICAgICBIVE1MVGFibGVSb3csCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbHVtbnM6IGZpZWxkcy5tYXAoZmllbGQgPT4gaChIVE1MVGFibGVDb2x1bW4sIHsgdGFnOiAndGgnIH0sIFtmaWVsZF0pKQogICAgICAgICAgfSwKICAgICAgICAgIFtdCiAgICAgICAgKQogICAgICBdLmNvbmNhdChmaWxlcy5tYXAoZmlsZSA9PiBoKEZpbGVPYmplY3QsIGZpbGUsIFtdKSkpCiAgICB9LAogICAgW10KICApOwp9OwoKZnVuY3Rpb24gUmVhZEV4aXYyKGZpbGUpIHsKICBjb25zb2xlLmxvZygnUmVhZEV4aXYyJywgZmlsZSk7CiAgbGV0IFtyZGYsIHN0ZG91dF0gPSBvcy5waXBlKCk7CiAgb3MuZXhlYyhbJ2V4aXYyJywgJy1lJywgJ1gtJywgJ2V4JywgZmlsZV0sIHsgc3Rkb3V0IH0pOwogIG9zLmNsb3NlKHN0ZG91dCk7CiAgbGV0IHhtcGRhdCA9IGZzLnJlYWRBbGxTeW5jKHJkZik7CiAgZnMuY2xvc2VTeW5jKHJkZik7CiAgLy8gY29uc29sZS5sb2coJ3htcGRhdCcsIHhtcGRhdCk7CiAgbGV0IHhtcCA9IHhtbC5yZWFkKHhtcGRhdCk7CiAgLy8gY29uc29sZS5sb2coJ3htcCcsIHhtcCk7CiAgbGV0IGZsYXQgPSBPYmplY3QuZnJvbUVudHJpZXMoCiAgICBkZWVwCiAgICAgIC5mbGF0dGVuKHhtcCwgW10pCiAgICAgIC5maWx0ZXIoKFtrLCB2XSkgPT4gdiAhPT0gJycgJiYgL2F0dHJpYnV0ZXMuKjovLnRlc3QoaykgJiYgIS9cLnhtbG5zLy50ZXN0KGspICYmICFpc09iamVjdCh2KSkKICAgICAgLmZpbHRlcigoW2ssIHZdKSA9PiAvKEdQU3xbWFldRGltfFtYWV1SZXN8RGF0ZSR8TWFrZSR8TW9kZWwkKS8udGVzdChrKSkKICAgICAgLm1hcCgoW2ssIHZdKSA9PiBbay5yZXBsYWNlKC8uKlwuYXR0cmlidXRlc1wuL2csICcnKSwgdl0pCiAgICAgIC5zb3J0KChhLCBiKSA9PiBhWzBdLmxvY2FsZUNvbXBhcmUoYlswXSkpCiAgICAgIC5tYXAoKFtrLCB2XSkgPT4gW2ssIGlzTmFOKCt2KSA/IChpc05hTihEYXRlLnBhcnNlKHYpKSA/IHYgOiBuZXcgRGF0ZSh2KSkgOiArdl0pCiAgKTsKICByZXR1cm4gZmxhdDsKfQoKZnVuY3Rpb24gUmVhZEV4aWZ0b29sKGZpbGUpIHsKICBjb25zb2xlLmxvZygnUmVhZEV4aWZ0b29sJywgZmlsZSk7CgogIGxldCBbcmV0LCBvdXRdID0gRXhlY3V0ZSgnZXhpZnRvb2wnLCAnLVMnLCAnLWVlJywgZmlsZSk7CgogIGxldCBhID0gb3V0LnNwbGl0KC9ccj9cbi9nKS5maWx0ZXIobCA9PiBsICE9ICcnKTsKCiAgYSA9IGEubWFwKGxpbmUgPT4gW2xpbmUsIGxpbmUuaW5kZXhPZignOiAnKV0pLm1hcCgoW2xpbmUsIGlkeF0pID0+IFtsaW5lLnNsaWNlKDAsIGlkeCksIGxpbmUuc2xpY2UoaWR4ICsgMildKTsKICBsZXQgbyA9IE9iamVjdC5mcm9tRW50cmllcyhhKTsKCiAgLy9jb25zb2xlLmxvZygnUmVhZEV4aWZ0b29sJyxvKTsKICByZXR1cm4gbzsKfQoKZnVuY3Rpb24gSGVpZkNvbnZlcnQoc3JjLCBkc3QsIHF1YWxpdHkgPSAxMDApIHsKICBjb25zb2xlLmxvZygnSGVpZkNvbnZlcnQnLCBzcmMsIGRzdCk7CiAgbGV0IGFyZ3MgPSBbJ2hlaWYtY29udmVydCcsICctcScsIHF1YWxpdHkgKyAnJywgc3JjLCBkc3RdOwogIGxldCBbcmV0LCBvdXRdID0gRXhlY3V0ZSguLi5hcmdzKTsKCiAgY29uc29sZS5sb2coJ0hlaWZDb252ZXJ0JywgeyBhcmdzLCByZXQsIG91dCB9KTsKICByZXR1cm4gW3JldCwgb3V0XTsKfQoKZnVuY3Rpb24gTWFnaWNrUmVzaXplKHNyYywgZHN0LCByb3RhdGUgPSAwLCB3aWR0aCwgaGVpZ2h0KSB7CiAgY29uc29sZS5sb2coJ01hZ2lja1Jlc2l6ZScsIHsKICAgIHdpZHRoLAogICAgaGVpZ2h0LAogICAgZHN0LAogICAgcm90YXRlCiAgfSk7CiAgbGV0IGFyZ3MgPSBbJ2NvbnZlcnQnLCBzcmMsICctcmVzaXplJywgd2lkdGggKyAneCcgKyBoZWlnaHQsIC4uLihyb3RhdGUgPyBbJy1yb3RhdGUnLCAnLScgKyByb3RhdGVdIDogW10pLCBkc3RdOwogIGxldCBbcmV0LCBvdXRdID0gRXhlY3V0ZSguLi5hcmdzKTsKCiAgY29uc29sZS5sb2coJ01hZ2lja1Jlc2l6ZScsIHsgYXJncywgcmV0LCBvdXQgfSk7CiAgcmV0dXJuIFtyZXQsIG91dF07Cn0KCmZ1bmN0aW9uIG1haW4oLi4uYXJncykgewogIGNvbnN0IGJhc2UgPSBwYXRoLmJhc2VuYW1lKHNjcmlwdEFyZ3NbMF0sICcuanMnKS5yZXBsYWNlKC9cLlthLXpdKiQvLCAnJyk7CiAgY29uc3QgY29uZmlnID0gUmVhZEpTT04oYC4ke2Jhc2V9LWNvbmZpZ2ApID8/IHt9OwoKICBnbG9iYWxUaGlzLmNvbnNvbGUgPSBuZXcgQ29uc29sZSh7CiAgICBpbnNwZWN0T3B0aW9uczogewogICAgICBjb21wYWN0OiAyLAogICAgICBkZXB0aDogSW5maW5pdHksCiAgICAgIGN1c3RvbUluc3BlY3Q6IHRydWUsCiAgICAgIG1heEFycmF5TGVuZ3RoOiAyMDAKICAgIH0KICB9KTsKICBsZXQgcGFyYW1zID0gZ2V0T3B0KAogICAgewogICAgICB2ZXJib3NlOiBbZmFsc2UsIChhLCB2KSA9PiAodiB8IDApICsgMSwgJ3YnXSwKICAgICAgbGlzdGVuOiBbZmFsc2UsIG51bGwsICdsJ10sCiAgICAgIGNvbm5lY3Q6IFtmYWxzZSwgbnVsbCwgJ2MnXSwKICAgICAgY2xpZW50OiBbZmFsc2UsIG51bGwsICdDJ10sCiAgICAgIHNlcnZlcjogW2ZhbHNlLCBudWxsLCAnUyddLAogICAgICBkZWJ1ZzogW2ZhbHNlLCBudWxsLCAneCddLAogICAgICB0bHM6IFtmYWxzZSwgbnVsbCwgJ3QnXSwKICAgICAgJ25vLXRscyc6IFtmYWxzZSwgKHYsIHB2LCBvKSA9PiAoKG8udGxzID0gZmFsc2UpLCB0cnVlKSwgJ1QnXSwKICAgICAgYWRkcmVzczogW3RydWUsIG51bGwsICdhJ10sCiAgICAgIHBvcnQ6IFt0cnVlLCBudWxsLCAncCddLAogICAgICAnc3NsLWNlcnQnOiBbdHJ1ZSwgbnVsbF0sCiAgICAgICdzc2wtcHJpdmF0ZS1rZXknOiBbdHJ1ZSwgbnVsbF0sCiAgICAgICdAJzogJ2FkZHJlc3MscG9ydCcKICAgIH0sCiAgICBhcmdzCiAgKTsKICBpZihwYXJhbXNbJ25vLXRscyddID09PSB0cnVlKSBwYXJhbXMudGxzID0gZmFsc2U7CgogIGNvbnN0IHsKICAgIGFkZHJlc3MgPSAnMC4wLjAuMCcsCiAgICBwb3J0ID0gODk5OSwKICAgICdzc2wtY2VydCc6IHNzbENlcnQgPSAnbG9jYWxob3N0LmNydCcsCiAgICAnc3NsLXByaXZhdGUta2V5Jzogc3NsUHJpdmF0ZUtleSA9ICdsb2NhbGhvc3Qua2V5JwogIH0gPSBwYXJhbXM7CiAgY29uc3QgbGlzdGVuID0gcGFyYW1zLmNvbm5lY3QgJiYgIXBhcmFtcy5saXN0ZW4gPyBmYWxzZSA6IHRydWU7CiAgY29uc3QgaXNfc2VydmVyID0gIXBhcmFtcy5jbGllbnQgfHwgcGFyYW1zLnNlcnZlcjsKCiAgbGV0IG5hbWUgPSBwcm9jZXNzLmVudlsnTkFNRSddID8/IGJhc2U7CgogIG5hbWUgPSBuYW1lCiAgICAucmVwbGFjZSgvLipcLy8sICcnKQogICAgLnJlcGxhY2UoLy0vZywgJyAnKQogICAgLnJlcGxhY2UoL1wuW15cLy5dKiQvLCAnJyk7CgogIGxldCBbcHJlZml4LCBzdWZmaXhdID0gbmFtZS5zcGxpdCgnICcpOwoKICBsZXQgcmVwbCA9IG5ldyBSRVBMKGBceDFiWzM4OzU7MTY1bSR7cHJlZml4fSBceDFiWzM4OzU7MzltJHtzdWZmaXh9XHgxYlswbWAsIGZhbHNlKTsKICBjb25zdCBoaXN0ZmlsZSA9ICcudXBsb2FkLXNlcnZlci1oaXN0b3J5JzsKICByZXBsLmhpc3RvcnlMb2FkKGhpc3RmaWxlLCBmYWxzZSk7CiAgcmVwbC5sb2FkU2F2ZU9wdGlvbnMoKTsKICByZXBsLmRpcmVjdGl2ZXMuaSA9IFsKICAgIChtb2R1bGUsIC4uLmFyZ3MpID0+IHsKICAgICAgY29uc29sZS5sb2coJ2FyZ3MnLCBhcmdzKTsKICAgICAgdHJ5IHsKICAgICAgICByZXR1cm4gcmVxdWlyZShtb2R1bGUpOwogICAgICB9IGNhdGNoKGUpIHt9CiAgICAgIGltcG9ydChtb2R1bGUpLnRoZW4obSA9PiAoZ2xvYmFsVGhpc1ttb2R1bGVdID0gbSkpOwogICAgfSwKICAgICdpbXBvcnQgbW9kdWxlJwogIF07CgogIGxldCB7IGxvZyB9ID0gY29uc29sZTsKICByZXBsLnNob3cgPSBhcmcgPT4gc3RkLnB1dHMoKHR5cGVvZiBhcmcgPT0gJ3N0cmluZycgPyBhcmcgOiBpbnNwZWN0KGFyZywgZ2xvYmFsVGhpcy5jb25zb2xlLm9wdGlvbnMpKSArICdcbicpOwoKICByZXBsLmNsZWFudXAgPSAoKSA9PiB7CiAgICByZXBsLnJlYWRsaW5lUmVtb3ZlUHJvbXB0KCk7CiAgICBUZXJtaW5hbC5tb3VzZXRyYWNraW5nRGlzYWJsZSgpOwogICAgbGV0IG51bUxpbmVzID0gcmVwbC5oaXN0b3J5U2F2ZShoaXN0ZmlsZSk7CgogICAgcmVwbC5wcmludFN0YXR1cyhgRVhJVCAod3JvdGUgJHtudW1MaW5lc30gaGlzdG9yeSBlbnRyaWVzKWAsIGZhbHNlKTsKCiAgICBzdGQuZXhpdCgwKTsKICB9OwoKICByZXBsLmluc3BlY3RPcHRpb25zID0gewogICAgLi4uKHJlcGwuaW5zcGVjdE9wdGlvbnMgPz8gY29uc29sZS5vcHRpb25zKSwKICAgIGRlcHRoOiBJbmZpbml0eSwKICAgIGNvbXBhY3Q6IGZhbHNlCiAgfTsKCiAgY29uc29sZS5sb2cgPSAoLi4uYXJncykgPT4gcmVwbC5wcmludFN0YXR1cygoKSA9PiBsb2coY29uc29sZS5jb25maWcocmVwbC5pbnNwZWN0T3B0aW9ucyksIC4uLmFyZ3MpKTsKCiAgbGV0IGxvZ0ZpbGUgPQogICAgewogICAgICBwdXRzKHMpIHsKICAgICAgICByZXBsLnByaW50U3RhdHVzKCgpID0+IHN0ZC5wdXRzKHMpKTsKICAgICAgfQogICAgfSA/PyBzdGQub3BlbigndXBsb2FkLXNlcnZlci5sb2cnLCAndysnKTsKCiAgbGV0IGNvbm5lY3Rpb25zID0gbmV3IFNldCgpOwogIGxldCBieV91dWlkID0ge307CgogIGZ1bmN0aW9uIFBhcnNlQm9keShnZW4pIHsKICAgIGxldCBwcm9tLAogICAgICBvID0gJycsCiAgICAgIHg7CgogICAgd2hpbGUoKHggPSBnZW4ubmV4dCgpKSkgewogICAgICBsZXQgeyB2YWx1ZSwgZG9uZSB9ID0geDsKICAgICAgbyArPSB2YWx1ZTsKICAgIH0KICAgIHJldHVybiBvOwogIH0KCiAgY29uc3QgY3JlYXRlV1MgPSAoZ2xvYmFsVGhpcy5jcmVhdGVXUyA9ICh1cmwsIGNhbGxiYWNrcywgbGlzdGVuKSA9PiB7CiAgICAvL2NvbnNvbGUubG9nKCdjcmVhdGVXUycsIHsgdXJsLCBjYWxsYmFja3MsIGxpc3RlbiB9KTsKCiAgICBnbG9iYWxUaGlzLm91dCA9IHMgPT4gbG9nRmlsZS5wdXRzKHMgKyAnXG4nKTsKCiAgICBsb2dMZXZlbCA9IChwYXJhbXMuZGVidWcgPyBMTExfVVNFUiA6IDApIHwgKCgocGFyYW1zLmRlYnVnID8gTExMX0lORk8gOiBMTExfV0FSTikgPDwgMSkgLSAxKTsKICAgIGNvbnNvbGUubG9nKCdjcmVhdGVXUycsIHsgbG9nTGV2ZWwgfSk7CgogICAgcmV0dXJuIFtjbGllbnQsIHNlcnZlcl1bK2xpc3Rlbl0oewogICAgICB0bHM6IHBhcmFtcy50bHMsCiAgICAgIHNzbENlcnQsCiAgICAgIHNzbFByaXZhdGVLZXksCiAgICAgIG1pbWV0eXBlczogWwogICAgICAgIFsnLnN2Z3onLCAnYXBwbGljYXRpb24vZ3ppcCddLAogICAgICAgIFsnLm1qcycsICdhcHBsaWNhdGlvbi9qYXZhc2NyaXB0J10sCiAgICAgICAgWycuanMnLCAnYXBwbGljYXRpb24vamF2YXNjcmlwdCddLAogICAgICAgIFsnLndhc20nLCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJ10sCiAgICAgICAgWycuZW90JywgJ2FwcGxpY2F0aW9uL3ZuZC5tcy1mb250b2JqZWN0J10sCiAgICAgICAgWycubGliJywgJ2FwcGxpY2F0aW9uL3gtYXJjaGl2ZSddLAogICAgICAgIFsnLmJ6MicsICdhcHBsaWNhdGlvbi94LWJ6aXAyJ10sCiAgICAgICAgWycuZ2l0aWdub3JlJywgJ3RleHQvcGxhaW4nXSwKICAgICAgICBbJy5jbWFrZScsICd0ZXh0L3BsYWluJ10sCiAgICAgICAgWycuaGV4JywgJ3RleHQvcGxhaW4nXSwKICAgICAgICBbJy5tZCcsICd0ZXh0L3BsYWluJ10sCiAgICAgICAgWycucGJ4cHJvaicsICd0ZXh0L3BsYWluJ10sCiAgICAgICAgWycud2F0JywgJ3RleHQvcGxhaW4nXSwKICAgICAgICBbJy5jJywgJ3RleHQveC1jJ10sCiAgICAgICAgWycuaCcsICd0ZXh0L3gtYyddLAogICAgICAgIFsnLmNwcCcsICd0ZXh0L3gtYysrJ10sCiAgICAgICAgWycuaHBwJywgJ3RleHQveC1jKysnXSwKICAgICAgICBbJy5maWx0ZXJzJywgJ3RleHQveG1sJ10sCiAgICAgICAgWycucGxpc3QnLCAndGV4dC94bWwnXSwKICAgICAgICBbJy5zdG9yeWJvYXJkJywgJ3RleHQveG1sJ10sCiAgICAgICAgWycudmN4cHJvaicsICd0ZXh0L3htbCddLAogICAgICAgIFsnLmJhdCcsICd0ZXh0L3gtbXNkb3MtYmF0Y2gnXSwKICAgICAgICBbJy5tbScsICd0ZXh0L3gtb2JqZWN0aXZlLWMnXSwKICAgICAgICBbJy5tJywgJ3RleHQveC1vYmplY3RpdmUtYyddLAogICAgICAgIFsnLnNoJywgJ3RleHQveC1zaGVsbHNjcmlwdCddCiAgICAgIF0sCiAgICAgIG1vdW50czogWwogICAgICAgIFsnLycsICcuJywgJ3VwbG9hZC5odG1sJ10sCiAgICAgICAgWycvZ2V0JywgJy4vdXBsb2FkcycsICcnXSwKICAgICAgICBbJy93YXJtY2F0JywgJ2h0dHBzOi8vd2FybWNhdC5jb20vJywgJ2luZGV4Lmh0bWwnXSwKICAgICAgICBbJy9kaXN0cmVsZWMnLCAnaHR0cHM6Ly93d3cuZGlzdHJlbGVjLmNoLycsICdsb2dpbiddLAogICAgICAgIFsnL2hhc3VyYScsICdodHRwOi8vd2lsZC1iZWF1dHkuaGVyb2t1YXBwLmNvbS92MS8nLCAnZ3JhcGhxbCddLAogICAgICAgIC8vIFsnL3VwbG9hZCcsICdsd3MtZGVhZGRyb3AnLCBudWxsLCAnbHdzLWRlYWRkcm9wJ10sCiAgICAgICAgYXN5bmMgZnVuY3Rpb24qIHRlc3QocmVxLCByZXNwKSB7CiAgICAgICAgICByZXNwLnR5cGUgPSAndGV4dC9wbGFpbic7CgogICAgICAgICAgY29uc29sZS5sb2coJyp0ZXN0JywgeyByZXEsIHJlc3AgfSk7CgogICAgICAgICAgbGV0IGJvZHlTdHIgPSAnJzsKICAgICAgICAgIGlmKHJlcS5tZXRob2QgPT0gJ1BPU1QnKSB7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ3JlcS5ib2R5JywgcmVxLmJvZHkpOwogICAgICAgICAgICAvLyAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlcS5ib2R5Lm5leHQoKScsIGF3YWl0IHJlcS5ib2R5Lm5leHQoKSk7CgogICAgICAgICAgICBmb3IgYXdhaXQobGV0IGNodW5rIG9mIGF3YWl0IHJlcS5ib2R5KSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NodW5rJywgY2h1bmspOwogICAgICAgICAgICAgIGJvZHlTdHIgKz0gdG9TdHJpbmcoY2h1bmspOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBjb25zb2xlLmxvZygnYm9keVN0cicsIGJvZHlTdHIpOwoKICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7CiAgICAgICAgICAgIHlpZWxkIGBsaW5lICMke2l9XG5gOwogICAgICAgICAgICBhd2FpdCB3YWl0Rm9yKCgxMCAtIGkgKyAxKSAqIDEwKTsKICAgICAgICAgIH0KCiAgICAgICAgICB5aWVsZCAnZG9uZSEnOwogICAgICAgIH0sCiAgICAgICAgZnVuY3Rpb24gcHJveHkocmVxLCByZXNwKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygncHJveHknLCB7IHJlcSwgcmVzcCB9KTsKICAgICAgICAgIGNvbnN0IHsgdXJsLCBtZXRob2QsIGhlYWRlcnMgfSA9IHJlcTsKICAgICAgICAgIGNvbnNvbGUubG9nKCdwcm94eScsIHsgdXJsLCBtZXRob2QsIGhlYWRlcnMgfSk7CiAgICAgICAgICBjb25zdCB7IHN0YXR1cywgb2ssIHR5cGUgfSA9IHJlc3A7CgogICAgICAgICAgY29uc29sZS5sb2coJ3Byb3h5JywgeyBzdGF0dXMsIG9rLCB1cmwsIHR5cGUgfSk7CiAgICAgICAgfSwKICAgICAgICBmdW5jdGlvbiogY29uZmlnKHJlcSwgcmVzcCkgewogICAgICAgICAgY29uc29sZS5sb2coJypjb25maWcnLCB7IHJlcSwgcmVzcCB9KTsKICAgICAgICAgIHlpZWxkICd7fSc7CiAgICAgICAgfSwKICAgICAgICBmdW5jdGlvbiogZmlsZShyZXEsIHJlc3ApIHsKICAgICAgICAgIGxldCB7IGJvZHksIGhlYWRlcnMsIGpzb24sIHVybCB9ID0gcmVxOwogICAgICAgICAgbGV0IHsgcXVlcnkgfSA9IHVybDsKCiAgICAgICAgICBpZih0eXBlb2YgYm9keSA9PSAnc3RyaW5nJykKICAgICAgICAgICAgcXVlcnkgPSB7CiAgICAgICAgICAgICAgLi4ucXVlcnksCiAgICAgICAgICAgICAgLi4uKEpTT04ucGFyc2UoYm9keSkgPz8ge30pCiAgICAgICAgICAgIH07CgogICAgICAgICAgbGV0IHsgYWN0aW9uID0gJ2xpc3QnLCBjaGFyc2V0ID0gJ3V0Zi04JywgYmluYXJ5ID0gZmFsc2UsIGZpbGUsIGNvbnRlbnRzIH0gPSBxdWVyeSA/PyB7fTsKCiAgICAgICAgICBpZigvXlwvZmlsZVwvLi8udGVzdCh1cmwucGF0aCkpIHsKICAgICAgICAgICAgZmlsZSA9IHVybC5wYXRoLnJlcGxhY2UoL15cL2ZpbGVcLy8sICcnKTsKICAgICAgICAgICAgYWN0aW9uID0gJ2xvYWQnOwogICAgICAgICAgfQogICAgICAgICAgY29uc29sZS5sb2coJypmaWxlJywgeyBxdWVyeSwgYm9keSwgZmlsZSB9KTsKCiAgICAgICAgICBjb25zb2xlLmxvZyhgKmZpbGVgLCB7IGFjdGlvbiwgZmlsZSB9KTsKCiAgICAgICAgICBpZihmaWxlKSB7CiAgICAgICAgICAgIGZpbGUgPSBwYXRoLmFic29sdXRlKGZpbGUpOwogICAgICAgICAgICBmaWxlID0gcGF0aC5jb2xsYXBzZShmaWxlKTsKICAgICAgICAgICAgY29uc29sZS5sb2coCiAgICAgICAgICAgICAgYGFsbG93ZWREaXJzOmAsCiAgICAgICAgICAgICAgYWxsb3dlZERpcnMgLy8ubWFwKGRpciA9PiBwYXRoLm5vcm1hbGl6ZShkaXIpKQogICAgICAgICAgICApOwoKICAgICAgICAgICAgLy8gICAgY29uc29sZS5sb2coYGFsbG93ZWQ6YCwgYWxsb3dlZERpcnMubWFwKGRpciA9PiBwYXRoLmlzaW4oZmlsZSwgZGlyKSkpOwogICAgICAgICAgICBsZXQgYWxsb3dlZCA9IGFsbG93ZWREaXJzLnNvbWUoZGlyID0+IHBhdGguaXNpbihmaWxlLCBwYXRoLm5vcm1hbGl6ZShkaXIpKSk7CgogICAgICAgICAgICBpZighYWxsb3dlZCkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBOb3QgYWxsb3dlZDogJyR7ZmlsZX0nYCk7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBOb3QgYWxsb3dlZDogJyR7ZmlsZX0nYCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBzd2l0Y2ggKGFjdGlvbikgewogICAgICAgICAgICBjYXNlICdsb2FkJzoKICAgICAgICAgICAgICBsZXQgbWltZSA9IEdldE1pbWUoZmlsZSk7CiAgICAgICAgICAgICAgcmVzcC50eXBlID0gbWltZTsKICAgICAgICAgICAgICBsZXQgZGF0YSA9IGZzLnJlYWRGaWxlU3luYyhmaWxlLCAxIHwgYmluYXJ5ID8gbnVsbCA6IGNoYXJzZXQpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAqZmlsZS5sb2FkYCwgeyBkYXRhIH0pOwogICAgICAgICAgICAgIHlpZWxkIGRhdGE7CiAgICAgICAgICAgICAgcmVzcC5ib2R5ID0gZGF0YTsKICAgICAgICAgICAgICAvL3lpZWxkCiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ3NhdmUnOgogICAgICAgICAgICAgIGZzLndyaXRlRmlsZVN5bmMoZmlsZSwgY29udGVudHMpOwogICAgICAgICAgICAgIHlpZWxkICdkb25lIVxyXG4nOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICdsaXN0JzoKICAgICAgICAgICAgICBsZXQgZmlsZXMgPSBmcy5yZWFkZGlyU3luYygndXBsb2FkcycpLmZpbHRlcihmID0+ICEvXlwuJC8udGVzdChmKSk7CiAgICAgICAgICAgICAgbGV0IGNvbXBvbmVudCA9IGgoCiAgICAgICAgICAgICAgICBIVE1MUGFnZSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgdGl0bGU6ICdGaWxlIGxpc3QnLAogICAgICAgICAgICAgICAgICBzdHlsZTogYAogIGJvZHksICogewogICAgZm9udC1mYW1pbHk6IE1pc2NGaXhlZFNDNjEzLEZpeGVkLCJDb3VyaWVyIE5ldyI7CiAgfQoKICAgICAgICAgICAgICAgICAgYCwKICAgICAgICAgICAgICAgICAgc2NyaXB0czogWydmaWxlbGlzdC5qcyddCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgICBoKEZpbHRlckZvcm0sIHt9LCBbXSksCiAgICAgICAgICAgICAgICAgIGgoRmlsZVRhYmxlLCB7CiAgICAgICAgICAgICAgICAgICAgZmlsZXM6IGZpbGVzLm1hcChmaWxlID0+ICh7CiAgICAgICAgICAgICAgICAgICAgICBmaWxlLAogICAgICAgICAgICAgICAgICAgICAgc3RhdDogZnMuc3RhdFN5bmMoZmlsZSkKICAgICAgICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIHlpZWxkIHJlbmRlclRvU3RyaW5nKGNvbXBvbmVudCk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgeWllbGQgZmlsZXMuam9pbignXG4nKTsKCiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBzdWNoIGNvbW1hbmQ6ICcke2FjdGlvbn0nYCk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBmdW5jdGlvbiogdXBsb2FkcyhyZXEsIHJlc3ApIHsKICAgICAgICAgIHJlc3AudHlwZSA9ICdhcHBsaWNhdGlvbi9qc29uJzsKICAgICAgICAgIGNvbnNvbGUubG9nKCd1cGxvYWRzJywgcmVxLCByZXNwKTsKCiAgICAgICAgICBjb25zdCB7IGxpbWl0ID0gJzAsMTAwJywgcHJldHR5ID0gMCB9ID0gcmVxLnVybC5xdWVyeSA/PyB7fTsKCiAgICAgICAgICBsZXQgW3N0YXJ0LCBlbmRdID0gbGltaXQuc3BsaXQoLywvZykubWFwKHMgPT4gK3MpOwoKICAgICAgICAgIGNvbnNvbGUubG9nKCd1cGxvYWRzJywgeyBzdGFydCwgZW5kIH0pOwoKICAgICAgICAgIGxldCByZXN1bHQgPSBbXSwgZW50cmllcz1nbG9iKCd1cGxvYWRzLyouanNvbicpOwoKICAgICAgICAgIGZvcihsZXQgZW50cnkgb2YgKEFycmF5LmlzQXJyYXkoZW50cmllcykgPyBlbnRyaWVzIDogIFtdKS5zbGljZShzdGFydCwgZW5kKSkgewogICAgICAgICAgICBsZXQganNvbiA9IFJlYWRKU09OKGVudHJ5KTsKICAgICAgICAgICAgcmVzdWx0LnB1c2goanNvbik7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc29sZS5sb2coJ3VwbG9hZHMnLCBjb25zb2xlLmNvbmZpZyh7IGRlcHRoOiAxLCBjb21wYWN0OiAyLCBtYXhBcnJheUxlbmd0aDogMTAgfSksIHJlc3VsdCk7CiAgICAgICAgICB5aWVsZCBKU09OLnN0cmluZ2lmeShyZXN1bHQsIC4uLigrcHJldHR5ID8gW251bGwsIDJdIDogW10pKTsKICAgICAgICB9LAogICAgICAgIGFzeW5jIGZ1bmN0aW9uKiBmaWxlcyhyZXEsIHJlc3ApIHsKICAgICAgICAgIC8vY29uc29sZS5sb2coJypmaWxlcycse3JlcSxyZXNwfSk7CiAgICAgICAgICBjb25zb2xlLmxvZygnKmZpbGVzIHF1ZXJ5ID0nLCByZXEudXJsLnF1ZXJ5KTsKICAgICAgICAgIC8qaWYocmVxLmJvZHkpIHsKICAgICAgICAgICBsZXQgY2h1bmtzID0gW107CiAgICAgICAgICAgIGNvbnN0IHsgYm9keSB9ID0gcmVxOwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnKmZpbGVzIGF3YWl0IHJlcS5hcnJheUJ1ZmZlcigpJywgYXdhaXQgcmVxLmFycmF5QnVmZmVyKCkpOwogICAgICAgICAgICAvL2NvbnNvbGUubG9nKCcqZmlsZXMgYXdhaXQgcmVxLnRleHQoKScsIGF3YWl0IHJlcS50ZXh0KCkpOwogICAgICAgICAgfSovCiAgICAgICAgICBjb25zdCB7IGZpbHRlciA9ICcqJywgcm9vdCwgdHlwZSA9IFRZUEVfRElSIHwgVFlQRV9SRUcgfCBUWVBFX0xOSywgbGltaXQgPSAnMCcgfSA9IHJlcS51cmwucXVlcnk7CgogICAgICAgICAgY29uc29sZS5sb2coJypmaWxlcycsIHsgcm9vdCwgZmlsdGVyLCB0eXBlIH0pOwoKICAgICAgICAgIGNvbnN0IFtvZmZzZXQgPSAwLCBzaXplID0gSW5maW5pdHldID0gbGltaXQuc3BsaXQoJywnKS5tYXAobiA9PiArbik7CgogICAgICAgICAgY29uc29sZS5sb2coJypmaWxlcycsIHsgb2Zmc2V0LCBzaXplIH0pOwoKICAgICAgICAgIGxldCBpID0gMDsKICAgICAgICAgIGxldCBmID0gTWF0Y2hlcihmaWx0ZXIpOwoKICAgICAgICAgIC8qICBsZXQgZ2VuID0gKGZ1bmN0aW9uKiBpdGVyKCkgeyovCiAgICAgICAgICBpZighcm9vdCkgewogICAgICAgICAgICBmb3IobGV0IG5hbWUgb2YgYWxsb3dlZERpcnMua2V5cygpLmZpbHRlcihmKSkgeWllbGQgbmFtZSArICcvXHJcbic7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmb3IobGV0IFtrZXksIHZhbHVlXSBvZiBhbGxvd2VkRGlycy5lbnRyaWVzKCkuZmlsdGVyKEtleU9yVmFsdWVNYXRjaGVyKHJvb3QpKSkgewogICAgICAgICAgICAgIGxldCBkaXIgPSBuZXcgRGlyZWN0b3J5KHZhbHVlLCBCT1RILCArdHlwZSk7CgogICAgICAgICAgICAgIHlpZWxkIGtleSArICc6XHJcbic7CgogICAgICAgICAgICAgIGZvcihsZXQgW25hbWUsIHR5cGVdIG9mIGRpci5maWx0ZXIoKFtuYW1lLCB0eXBlXSkgPT4gZihuYW1lKSkpCiAgICAgICAgICAgICAgICB5aWVsZCBuYW1lICsgKCt0eXBlID09IFRZUEVfRElSID8gJy8nIDogJycpICsgJ1xyXG4nOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBjb25zb2xlLmxvZygnKmZpbGVzJywgeyBpLCBmIH0pOwogICAgICAgICAgLyogfSkoKTsKICAgICAgICAgICAgY29uc29sZS5sb2coJypmaWxlcycsIHsgaSxmLGdlbiB9KTsKCiAgICAgICAgICAgIHlpZWxkKiBnZW4ucmFuZ2Uob2Zmc2V0LCBzaXplKTsqLwoKICAgICAgICAgIC8veWllbGQgJ1xyXG4nOwogICAgICAgIH0sCiAgICAgICAgZnVuY3Rpb24qIGZpbGVzMihyZXEsIHJlc3ApIHsKICAgICAgICAgIGxldCB7IGJvZHksIGhlYWRlcnMsIGpzb24sIHVybCB9ID0gcmVxOwogICAgICAgICAgbGV0IHsgcXVlcnkgfSA9IHVybDsKICAgICAgICAgIGRlZmluZShnbG9iYWxUaGlzLCB7IGZpbGVzUmVxdWVzdDogeyByZXEsIHJlc3AsIGJvZHksIHF1ZXJ5IH0gfSk7CiAgICAgICAgICBjb25zb2xlLmxvZygnKmZpbGVzJywgeyByZXEsIHJlc3AsIGJvZHksIHF1ZXJ5IH0pOwogICAgICAgICAgY29uc3QgZGF0YSA9IHF1ZXJ5ID8/IHt9OwogICAgICAgICAgcmVzcC50eXBlID0gJ2FwcGxpY2F0aW9uL2pzb24nOwogICAgICAgICAgbGV0IHsKICAgICAgICAgICAgZGlycyA9IGRlZmF1bHREaXJzLAogICAgICAgICAgICBmaWx0ZXIgPSAnW14uXS4qJyA/PyAnLihicmR8c2NofEdbQS1aXVtBLVpdKSQnLAogICAgICAgICAgICB2ZXJib3NlID0gZmFsc2UsCiAgICAgICAgICAgIG9iamVjdHMgPSB0cnVlLAogICAgICAgICAgICBrZXkgPSAnbXRpbWUnLAogICAgICAgICAgICBsaW1pdCA9IG51bGwsCiAgICAgICAgICAgIGZsYXQgPSBmYWxzZQogICAgICAgICAgfSA9IGRhdGEgPz8ge307CiAgICAgICAgICBsZXQgcmVzdWx0cyA9IFtdOwogICAgICAgICAgZm9yKGxldCBkaXIgb2YgZGlycykgewogICAgICAgICAgICBsZXQgc3QsCiAgICAgICAgICAgICAgbmFtZXMgPSBbXTsKICAgICAgICAgICAgaWYoQXJyYXkuaXNBcnJheShkaXIpKSB7CiAgICAgICAgICAgICAgbGV0IFssIHJlXSA9IGRpcjsKICAgICAgICAgICAgICBsZXQgYWJzZGlyID0gcGF0aC5yZWFscGF0aChkaXJbMF0pOwogICAgICAgICAgICAgIG5hbWVzID0gWy4uLlJlY3Vyc2l2ZURpckl0ZXJhdG9yKGFic2RpciwgbiA9PiByZS50ZXN0KG4pKV07CiAgICAgICAgICAgICAgZGlyID0gcGF0aC5yZWxhdGl2ZShhYnNkaXIsIHBhdGguZ2V0Y3dkKCkpOwogICAgICAgICAgICB9IGVsc2UgaWYoKHN0ID0gZnMuc3RhdFN5bmMoZGlyKSkgJiYgc3QuaXNEaXJlY3RvcnkoKSkgewogICAgICAgICAgICAgIGxldCBhYnNkaXIgPSBwYXRoLnJlYWxwYXRoKGRpcik7CiAgICAgICAgICAgICAgbGV0IGNvbXBvbmVudHMgPSBhYnNkaXIuc3BsaXQocGF0aC5zZXApOwogICAgICAgICAgICAgIGlmKGNvbXBvbmVudHMubGVuZ3RoICYmIGNvbXBvbmVudHNbMF0gPT09ICcnKSBjb21wb25lbnRzLnNoaWZ0KCk7CiAgICAgICAgICAgICAgaWYoY29tcG9uZW50cy5sZW5ndGggPCAyIHx8IGNvbXBvbmVudHNbMF0gIT0gJ2hvbWUnKSB0aHJvdyBuZXcgRXJyb3IoYEFjY2VzcyBlcnJvcmApOwogICAgICAgICAgICAgIG5hbWVzID0gZnMucmVhZGRpclN5bmMoYWJzZGlyKSA/PyBbXTsKICAgICAgICAgICAgICBkaXIgPSBwYXRoLnJlbGF0aXZlKGFic2RpciwgcGF0aC5nZXRjd2QoKSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgbmFtZXMgPSBnbG9iKGRpciwgR0xPQl9CUkFDRSk7CiAgICAgICAgICAgICAgaWYoIUFycmF5LmlzQXJyYXkobmFtZXMpKSBuYW1lcyA9IFtdOwogICAgICAgICAgICAgIGxldCBhID0gcGF0aC50b0FycmF5KGRpcik7CiAgICAgICAgICAgICAgbGV0IGkgPSBhLmZpbmRJbmRleChuID0+IC9bKnt9XS8udGVzdChuKSk7CiAgICAgICAgICAgICAgZGlyID0gcGF0aC5zbGljZShkaXIsIDAsIGkpOwogICAgICAgICAgICAgIG5hbWVzID0gbmFtZXMubWFwKG4gPT4gbi5zbGljZShkaXIubGVuZ3RoICsgMSkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCFBcnJheS5pc0FycmF5KG5hbWVzKSkgY29udGludWU7CiAgICAgICAgICAgIG5hbWVzID0gbmFtZXMuc29ydCgoYSwgYikgPT4gJycgKyBiIDwgJycgKyBhKTsKICAgICAgICAgICAgaWYoZmlsdGVyKSB7CiAgICAgICAgICAgICAgY29uc3QgcmUgPSBuZXcgUmVnRXhwKGZpbHRlciwgJ2dpJyk7CiAgICAgICAgICAgICAgbmFtZXMgPSBuYW1lcy5maWx0ZXIobmFtZSA9PiByZS50ZXN0KG5hbWUpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZihsaW1pdCkgewogICAgICAgICAgICAgIGxldCBbb2Zmc2V0ID0gMF0gPSBsaW1pdDsKICAgICAgICAgICAgICBsZXQgWywgbGVuZ3RoID0gbmFtZXMubGVuZ3RoIC0gc3RhcnRdID0gbGltaXQ7CiAgICAgICAgICAgICAgbmFtZXMgPSBuYW1lcy5zbGljZShvZmZzZXQsIG9mZnNldCArIGxlbmd0aCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IGVudHJpZXMgPSBuYW1lcwogICAgICAgICAgICAgIC5tYXAoZmlsZSA9PiAoZnMuZXhpc3RzU3luYyhgJHtkaXJ9LyR7ZmlsZX1gKSA/IGAke2Rpcn0vJHtmaWxlfWAgOiBmaWxlKSkKICAgICAgICAgICAgICAubWFwKGZpbGUgPT4gW2ZpbGUsIHBhdGgucmVsYXRpdmUoZmlsZSwgcGF0aC5nZXRjd2QoKSldKQogICAgICAgICAgICAgIC5tYXAoKFtmaWxlLCByZWxdKSA9PiBbZmlsZSwgZnMuc3RhdFN5bmMocmVsKV0pOwogICAgICAgICAgICBlbnRyaWVzID0gZW50cmllcy5yZWR1Y2UoKGFjYywgW2ZpbGUsIHN0XSkgPT4gewogICAgICAgICAgICAgIGxldCBuYW1lID0gZmlsZSArIChzdCAmJiBzdC5pc0RpcmVjdG9yeSgpID8gJy8nIDogJycpOwogICAgICAgICAgICAgIGxldCBvYmogPSB7CiAgICAgICAgICAgICAgICBuYW1lCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBhY2MucHVzaChbCiAgICAgICAgICAgICAgICBuYW1lLAogICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbigKICAgICAgICAgICAgICAgICAgb2JqLAogICAgICAgICAgICAgICAgICBzdAogICAgICAgICAgICAgICAgICAgID8gewogICAgICAgICAgICAgICAgICAgICAgICBtdGltZTogdG9Vbml4VGltZShzdC5tdGltZSksCiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWU6IHRvVW5peFRpbWUoc3QuY3RpbWUpLAogICAgICAgICAgICAgICAgICAgICAgICBtb2RlOiBgMCR7KHN0Lm1vZGUgJiAweDA5ZmYpLnRvU3RyaW5nKDgpfWAsCiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IHN0LnNpemUKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICA6IHt9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgICAgcmV0dXJuIGFjYzsKICAgICAgICAgICAgfSwgW10pOwogICAgICAgICAgICBpZihlbnRyaWVzLmxlbmd0aCkgewogICAgICAgICAgICAgIGxldCBjbXAgPSB7CiAgICAgICAgICAgICAgICBzdHJpbmcoYSwgYikgewogICAgICAgICAgICAgICAgICByZXR1cm4gYVsxXVtrZXldLmxvY2FsZUNvbXBhcmUoYlsxXVtrZXldKTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBudW1iZXIoYSwgYikgewogICAgICAgICAgICAgICAgICByZXR1cm4gYVsxXVtrZXldIC0gYlsxXVtrZXldOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH1bdHlwZW9mIGVudHJpZXNbMF1bMV1ba2V5XV07CiAgICAgICAgICAgICAgZW50cmllcyA9IGVudHJpZXMuc29ydChjbXApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG5hbWVzID0gZW50cmllcy5tYXAoKFtuYW1lLCBvYmpdKSA9PiAob2JqZWN0cyA/IG9iaiA6IG5hbWUpKTsKICAgICAgICAgICAgaWYobmFtZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIGlmKGZsYXQpIG5hbWVzLm1hcCgoeyBuYW1lIH0pID0+IHJlc3VsdHMucHVzaCh7IG5hbWU6IHBhdGgubm9ybWFsaXplKHBhdGguam9pbihkaXIsIG5hbWUpKSB9KSk7CiAgICAgICAgICAgICAgZWxzZSByZXN1bHRzLnB1c2goeyBkaXIsIG5hbWVzIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICB5aWVsZCBKU09OLnN0cmluZ2lmeSguLi5bcmVzdWx0cywgLi4uKHZlcmJvc2UgPyBbbnVsbCwgMl0gOiBbXSldKTsKICAgICAgICB9CiAgICAgIF0sCiAgICAgIC4uLnVybCwKCiAgICAgIC4uLmNhbGxiYWNrcywKICAgICAgb25Db25uZWN0KHdzLCByZXEpIHsKICAgICAgICBjb25zb2xlLmxvZygnb25Db25uZWN0XHgxYicpOwogICAgICAgIGNvbnN0IHsgcGVlciwgYWRkcmVzcywgcG9ydCwgcHJvdG9jb2wgfSA9IHdzOwoKICAgICAgICBjb25zb2xlLmxvZygnXHgxYlszODs1OzMzbW9uQ29ubmVjdFx4MWJbMG0nLCB7IGFkZHJlc3MsIHBvcnQsIHByb3RvY29sIH0pOwoKICAgICAgICB3cy5zZW5kQ29tbWFuZCA9IGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgICAgIGlmKCFpc0FycmF5QnVmZmVyKGRhdGEpIC8qJiYgaXNPYmplY3QoZGF0YSkqLykgZGF0YSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpOwoKICAgICAgICAgIHJldHVybiB0aGlzLnNlbmQoZGF0YSk7CiAgICAgICAgfTsKICAgICAgICBpZighd3MudXVpZCkgewogICAgICAgICAgbGV0IGRhdGEgPSAod3MudXVpZCA9IE1ha2VVVUlEKCkpOwoKICAgICAgICAgIHdzLnNlbmRDb21tYW5kKHsgdHlwZTogJ3V1aWQnLCBkYXRhIH0pOwogICAgICAgICAgYnlfdXVpZFtkYXRhXSA9IHdzOwogICAgICAgIH0KICAgICAgICBjb25uZWN0aW9ucy5hZGQod3MpOwoKICAgICAgICBpZihjYWxsYmFja3Mub25Db25uZWN0KSByZXR1cm4gY2FsbGJhY2tzLm9uQ29ubmVjdCh3cywgcmVxKTsKICAgICAgfSwKICAgICAgb25DbG9zZSh3cywgcmVhc29uKSB7CiAgICAgICAgY29ubmVjdGlvbnMuZGVsZXRlKHdzKTsKCiAgICAgICAgcmV0dXJuIGNhbGxiYWNrcy5vbkNsb3NlKHdzLCByZWFzb24pOwogICAgICB9LAogICAgICAvKiAgICAgIG9uUmVhZChkYXRhKSB7CiAgICAgICAgICAgY29uc3QgcmVxID0gdGhpczsKICAgICAgICAgIGNvbnNvbGUubG9nKCdvblJlYWQnLCB7IHJlcSwgZGF0YSB9KTsKICAgICAgICB9LCovCiAgICAgIC8qIG9uUG9zdChkYXRhKSB7CiAgICAgICAgIGNvbnN0IHJlcSA9IHRoaXM7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICByZXEuanNvbiA9IEpTT04ucGFyc2UoZGF0YSk7CiAgICAgICAgICB9IGNhdGNoKGVycm9yKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvblBvc3QnLCB7IHJlcSwgZGF0YSwgZXJyb3IgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSwqLwogICAgICBvbkh0dHAod3MsIHJlcSwgcmVzcCkgewogICAgICAgIC8qIGlmKHJlcS5tZXRob2QgIT0gJ0dFVCcpKi8gLy9jb25zb2xlLmxvZygnb25IdHRwJywgY29uc29sZS5jb25maWcoeyBjb21wYWN0OiAwIH0pLCB3cyk7CiAgICAgICAgLy8gICBjb25zb2xlLmxvZygnXHgxYlszODs1OzIyMG1vbkh0dHAoMSlceDFiWzBtJywgY29uc29sZS5jb25maWcoeyBjb21wYWN0OiAwIH0pLCB7IHJlcSB9KTsKCiAgICAgICAgZGVmaW5lKGdsb2JhbFRoaXMsIHsgd3MsIHJlcSwgcmVzcCB9KTsKCiAgICAgICAgY29uc3QgeyBwZWVyLCBhZGRyZXNzLCBwb3J0IH0gPSB3czsKICAgICAgICBjb25zdCB7IG1ldGhvZCwgaGVhZGVycyB9ID0gcmVxOwoKICAgICAgICBpZigocmVxLnVybC5wYXRoID8/ICcnKS5lbmRzV2l0aCgnZmlsZXMnKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgICAgLy9yZXNwLnR5cGUgPSAnYXBwbGljYXRpb24vanNvbic7CiAgICAgICAgfSBlbHNlIGlmKAogICAgICAgICAgcmVxLm1ldGhvZCAhPSAnR0VUJyAmJgogICAgICAgICAgKHJlcS5oZWFkZXJzWydjb250ZW50LXR5cGUnXSA9PSAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyB8fAogICAgICAgICAgICByZXEuaGVhZGVyc1snY29udGVudC10eXBlJ10uc3RhcnRzV2l0aCgnbXVsdGlwYXJ0L2Zvcm0tZGF0YScpKQogICAgICAgICkgewogICAgICAgICAgbGV0IGZwLAogICAgICAgICAgICBoYXNoLAogICAgICAgICAgICB0bXBuYW0sCiAgICAgICAgICAgIGV4dCwKICAgICAgICAgICAgcHJvZ3Jlc3MgPSAwOwogICAgICAgICAgY29uc29sZS5sb2cocmVxLm1ldGhvZCwgaGVhZGVycyk7CiAgICAgICAgICBpZihyZXEudXJsLnBhdGguZW5kc1dpdGgoJ3VwbG9hZCcpKSByZXNwLnN0YXR1cyA9IDIwMDsKICAgICAgICAgIHJlc3AudHlwZSA9ICd0ZXh0L3Jhdyc7CgogICAgICAgICAgZnAgPSBuZXcgRm9ybVBhcnNlcih3cywgWydmaWxlcycsICd1dWlkJ10sIHsKICAgICAgICAgICAgY2h1bmtTaXplOiA4MTkyIC8qKiAyNTYqLywKICAgICAgICAgICAgb25PcGVuKG5hbWUsIGZpbGVuYW1lKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coYG9uT3Blbigke25hbWV9LCAke2ZpbGVuYW1lfSlgKTsKICAgICAgICAgICAgICBpZih0aGlzLmZpbGUpIHsKICAgICAgICAgICAgICAgIHRoaXMub25jbG9zZS5jYWxsKHRoaXMsIG5hbWUpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgdGhpcy5uYW1lID0gbmFtZTsKICAgICAgICAgICAgICB0aGlzLmZpbGVuYW1lID0gZmlsZW5hbWU7CiAgICAgICAgICAgICAgZXh0ID0gcGF0aC5leHRuYW1lKGZpbGVuYW1lKS50b0xvd2VyQ2FzZSgpOwoKICAgICAgICAgICAgICB0aGlzLmZpbGUgPSBmcy5vcGVuU3luYygodGhpcy50ZW1wID0gJ3VwbG9hZHMvJyArICh0bXBuYW0gPSByYW5kU3RyKDIwKSArICcudG1wJykpLCAndysnLCAwbzY0NCk7CiAgICAgICAgICAgICAgaGFzaCA9IG5ldyBIYXNoKEhhc2guVFlQRV9TSEExKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25Db250ZW50KG5hbWUsIGRhdGEpIHsKICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgb25Db250ZW50KCR7dGhpcy5maWxlbmFtZX0pYCxkYXRhLmJ5dGVMZW5ndGgpOwogICAgICAgICAgICAgIHByb2dyZXNzICs9IGRhdGEuYnl0ZUxlbmd0aDsKCiAgICAgICAgICAgICAgbGV0IHdzMiA9IGJ5X3V1aWRbd3MudXVpZCA/PyB0aGlzLnV1aWRdOwoKICAgICAgICAgICAgICBmcy53cml0ZVN5bmModGhpcy5maWxlLCBkYXRhKTsKICAgICAgICAgICAgICBoYXNoLnVwZGF0ZShkYXRhKTsKICAgICAgICAgICAgICBpZih3czIpCiAgICAgICAgICAgICAgICB3czIuc2VuZENvbW1hbmQoewogICAgICAgICAgICAgICAgICB0eXBlOiAncHJvZ3Jlc3MnLAogICAgICAgICAgICAgICAgICBkb25lOiBwcm9ncmVzcywKICAgICAgICAgICAgICAgICAgbmFtZSwKICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6IHRoaXMuZmlsZW5hbWUsCiAgICAgICAgICAgICAgICAgIHRvdGFsOiAraGVhZGVyc1snY29udGVudC1sZW5ndGgnXQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sCgogICAgICAgICAgICBvbkNsb3NlKG5hbWUsIGZpbGUpIHsKICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYG9uQ2xvc2VbMV0oJHtuYW1lfSwgJHtmaWxlfSlgLCB0aGlzLnV1aWQpOwogICAgICAgICAgICAgICAgbGV0IGV4aWYsIGNhY2hlLCBzaGExOwogICAgICAgICAgICAgICAgaWYoaGFzaCkgewogICAgICAgICAgICAgICAgICBoYXNoLmZpbmFsaXplKCk7CiAgICAgICAgICAgICAgICAgIHNoYTEgPSBoYXNoLnRvU3RyaW5nKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZih0aGlzLmZpbGUpIHsKICAgICAgICAgICAgICAgICAgZnMuY2xvc2VTeW5jKHRoaXMuZmlsZSk7CiAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZSA9IG51bGw7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZihzaGExKSB7CiAgICAgICAgICAgICAgICAgIGxldCBmID0geCA9PiAndXBsb2Fkcy8nICsgc2hhMSArIHg7CiAgICAgICAgICAgICAgICAgIGxldCByZXQgPSBsaW5rKHRoaXMudGVtcCwgZihleHQpKTsKICAgICAgICAgICAgICAgICAgbGV0IHsgZXJybm8gfSA9IGVycm9yKCk7CiAgICAgICAgICAgICAgICAgIGxldCBqc29uID0gZignLmpzb24nKTsKICAgICAgICAgICAgICAgICAgaWYoZnMuZXhpc3RzU3luYyhqc29uKSAmJiAoY2FjaGUgPSBSZWFkSlNPTihqc29uKSkpIHsKICAgICAgICAgICAgICAgICAgICBleGlmID0gY2FjaGUuZXhpZjsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZighLyhwbmd8c3ZnfGdpZnx0Z2EpJC9pLnRlc3QoZXh0KSkgewogICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgZXhpZiA9IFJlYWRFeGlmdG9vbChmKGV4dCkpOwogICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaChlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgZXhpZiA9IFJlYWRFeGlmdG9vbCh0aGlzLnRlbXApOwogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoKGUpIHt9CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGxldCBvYmogPSB7CiAgICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZTogdGhpcy5maWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICAgIHN0b3JhZ2U6IGYoZXh0KSwKICAgICAgICAgICAgICAgICAgICAgIHVwbG9hZGVkOiBEYXRlLm5vdygpLAogICAgICAgICAgICAgICAgICAgICAgYWRkcmVzcywKICAgICAgICAgICAgICAgICAgICAgIGV4aWYKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGlmKCEvanBlP2ckLy50ZXN0KGV4dCkpIHsKICAgICAgICAgICAgICAgICAgICAgIEhlaWZDb252ZXJ0KGYoZXh0KSwgZignLmpwZycpKTsKICAgICAgICAgICAgICAgICAgICAgIGlmKGZzLmV4aXN0c1N5bmMoZignLmpwZycpKSkgb2JqLmpwZyA9IGYoJy5qcGcnKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgbGV0IHdpZHRoID0gJycsCiAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSAnMjU2JzsKCiAgICAgICAgICAgICAgICAgICAgaWYoZXhpZikgewogICAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBJbWFnZVNpemUsIEltYWdlSGVpZ2h0LCBJbWFnZVdpZHRoIH0gPSBleGlmOwogICAgICAgICAgICAgICAgICAgICAgbGV0IGFzcGVjdCA9IEltYWdlV2lkdGggLyBJbWFnZUhlaWdodDsKICAgICAgICAgICAgICAgICAgICAgIGlmKGFzcGVjdCA+PSAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoID0gMjU2OwogICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSB3aWR0aCAvIGFzcGVjdDsKICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8qIGhlaWdodCA9IDI1NjsKICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aCA9IGhlaWdodCAqIGFzcGVjdDsqLwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgTWFnaWNrUmVzaXplKG9iai5qcGcgPz8gZihleHQpLCBmKCcudGh1bWIuanBnJyksIG9iai5leGlmPy5Sb3RhdGlvbiA/PyAwLCB3aWR0aCwgaGVpZ2h0KTsKCiAgICAgICAgICAgICAgICAgICAgaWYoZnMuZXhpc3RzU3luYyhmKCcudGh1bWIuanBnJykpKSBvYmoudGh1bWJuYWlsID0gZignLnRodW1iLmpwZycpOwogICAgICAgICAgICAgICAgICAgIFdyaXRlSlNPTihqc29uLCBvYmopOwogICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGBieV91dWlkYCwgYnlfdXVpZCk7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYHV1aWRgLCB3cy51dWlkID8/IHRoaXMudXVpZCk7CiAgICAgICAgICAgICAgICAgICAgY2FjaGUgPSBvYmo7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgaWYocmV0ID09IDAgfHwgZXJybm8gPT0gMTcpIHsKICAgICAgICAgICAgICAgICAgICB1bmxpbmsodGhpcy50ZW1wKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnRlbXAgPSBudWxsOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zdCB7IGZpbGVuYW1lIH0gPSB0aGlzOwogICAgICAgICAgICAgICAgbGV0IHdzMiA9IGJ5X3V1aWRbd3MudXVpZCA/PyB0aGlzLnV1aWRdOwogICAgICAgICAgICAgICAgaWYod3MyKQogICAgICAgICAgICAgICAgICB3czIuc2VuZENvbW1hbmQoewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICd1cGxvYWQnLAogICAgICAgICAgICAgICAgICAgIC4uLihjYWNoZSA/PyB7fSksCiAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWUsCiAgICAgICAgICAgICAgICAgICAgZXhpZgogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIC8vICBjb25zb2xlLmxvZyhgb25DbG9zZVsyXSgke25hbWV9LCAke2ZpbGV9KWApOwogICAgICAgICAgICAgIH0gY2F0Y2goZSkgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coYG9uQ2xvc2UgRVJST1I6YCwgZS5tZXNzYWdlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9uRmluYWxpemUoKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coYG9uRmluYWxpemUoKSBmb3JtIHBhcnNlcmAsIHRoaXMudXVpZCk7CiAgICAgICAgICAgICAgcmVzcC5ib2R5ID0gYGRvbmU6ICR7cHJvZ3Jlc3N9IGJ5dGVzIHJlYWRcclxuYDsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgLy90aHJvdyBuZXcgRXJyb3IoYGh0dHAgJHttZXRob2R9IHJlcXVlc3RgKTsKCiAgICAgICAgaWYoIXJlcS5oZWFkZXJzIHx8IHR5cGVvZiByZXEuaGVhZGVycyAhPSAnb2JqZWN0JykgY29uc29sZS5sb2coJ05vIGhlYWRlcnMnLCByZXEpOwoKICAgICAgICBjb25zdCB7IGJvZHksIHVybCB9ID0gcmVzcDsKICAgICAgICBjb25zdCB7IHJlZmVyZXIgfSA9IHJlcS5oZWFkZXJzOwoKICAgICAgICBsZXQgZmlsZSA9IHVybC5wYXRoLnNsaWNlKDEpOwogICAgICAgIGNvbnN0IGRpciA9IHBhdGguZGlybmFtZShmaWxlKTsgLy9maWxlLnJlcGxhY2UoL1wvW15cL10qJC9nLCAnJyk7CgogICAgICAgIGlmKGZpbGUuZW5kc1dpdGgoJy50eHQnKSB8fCBmaWxlLmVuZHNXaXRoKCcuaHRtbCcpIHx8IGZpbGUuZW5kc1dpdGgoJy5jc3MnKSkgewogICAgICAgICAgcmVzcC5ib2R5ID0gZnMucmVhZEZpbGVTeW5jKGZpbGUsICd1dGYtOCcpOwogICAgICAgIH0gZWxzZSBpZihmaWxlLmVuZHNXaXRoKCcuanMnKSkgewogICAgICAgICAgbGV0IGZpbGUxID0gZmlsZTsKICAgICAgICAgIGlmKC9xanMtbW9kdWxlc1wvbGliLy50ZXN0KGZpbGUpICYmICEvKGRvbXx1dGlsKVwuanMvLnRlc3QoZmlsZSkpIHsKICAgICAgICAgICAgbGV0IGZpbGUyID0gZmlsZS5yZXBsYWNlKC8uKnFqcy1tb2R1bGVzXC8vZywgJycpOwogICAgICAgICAgICBpZihmcy5leGlzdHNTeW5jKGZpbGUyKSkgewogICAgICAgICAgICAgIGZpbGUgPSBmaWxlMjsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmKCFmcy5leGlzdHNTeW5jKGZpbGUpKSB7CiAgICAgICAgICAgIGZvcihsZXQgZGlyIG9mIFsncXVpY2tqcy9xanMtbW9kdWxlcycsICdxdWlja2pzL3Fqcy1tb2R1bGVzL2xpYicsICcuJywgJ2xpYiddKSB7CiAgICAgICAgICAgICAgbGV0IGZpbGUyID0gZGlyICsgJy8nICsgZmlsZTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygnaW5leGlzdGVudCBmaWxlJywgZmlsZSwgZmlsZTIsIGZzLmV4aXN0c1N5bmMoZmlsZTIpLCByZWZlcmVyKTsKICAgICAgICAgICAgICBpZihmcy5leGlzdHNTeW5jKGZpbGUyKSkgewogICAgICAgICAgICAgICAgZmlsZSA9IGZpbGUyOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYoZmlsZTEgIT0gZmlsZSkgewogICAgICAgICAgICAvLyAgY29uc29sZS5sb2coJ1x4MWJbMzg7NTsyMTRtb25IdHRwXHgxYlswbScsIGZpbGUxLCAnLT4nLCBmaWxlKTsKICAgICAgICAgICAgcmVzcC5zdGF0dXMgPSAzMDI7CiAgICAgICAgICAgIHJlc3AuaGVhZGVycyA9IHsgWydMb2NhdGlvbiddOiAnLycgKyBmaWxlIH07CiAgICAgICAgICAgIHJldHVybiByZXNwOwogICAgICAgICAgfQogICAgICAgICAgLy9jb25zb2xlLmxvZygnXHgxYlszODs1OzMzbW9uSHR0cFx4MWJbMG0nLCBmaWxlMSwgZmlsZSk7CgogICAgICAgICAgLy8KICAgICAgICAgIGxldCBib2R5ID0gZnMucmVhZEZpbGVTeW5jKGZpbGUsICd1dGYtOCcpOwoKICAgICAgICAgIGNvbnN0IHJlID0gL14oXHMqKGltfGV4KXBvcnRbXlxuXSpmcm9tIFsnIl0pKFteLi8nIl0qKShbJyJdXHMqO1tcdCBdKlxuPykvZ207CgogICAgICAgICAgcmVzcC5ib2R5ID0gYm9keS5yZXBsYWNlQWxsKHJlLCAobWF0Y2gsIHAxLCBwMCwgcDIsIHAzLCBvZmZzZXQpID0+IHsKICAgICAgICAgICAgaWYoIS9bXC9cLl0vLnRlc3QocDIpKSB7CiAgICAgICAgICAgICAgbGV0IGZuYW1lID0gYCR7cDJ9LmpzYDsKICAgICAgICAgICAgICBsZXQgcmVsID0gcGF0aC5yZWxhdGl2ZShmbmFtZSwgZGlyKTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygnb25IdHRwJywgeyBtYXRjaCwgZm5hbWUgfSwgcmVsKTsKCiAgICAgICAgICAgICAgLy8gaWYoIWZzLmV4aXN0c1N5bmMoICByZWwpKSByZXR1cm4gYGA7CgogICAgICAgICAgICAgIG1hdGNoID0gW3AxLCByZWwsIHAzXS5qb2luKCcnKTsKCiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2FyZ3MnLCB7CiAgICAgICAgICAgICAgICBtYXRjaCwKICAgICAgICAgICAgICAgIHAxLAogICAgICAgICAgICAgICAgcDIsCiAgICAgICAgICAgICAgICBwMywKICAgICAgICAgICAgICAgIG9mZnNldAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBtYXRjaDsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICB7CiAgICAgICAgICBsZXQgeyBib2R5IH0gPSByZXNwOwogICAgICAgICAgLy9jb25zb2xlLmxvZygnXHgxYlszODs1OzIxMm1vbkh0dHAoMilceDFiWzBtJywgeyBib2R5IH0pOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJlc3A7CiAgICAgIH0sCiAgICAgIG9uTWVzc2FnZSh3cywgZGF0YSkgewogICAgICAgIGNvbnNvbGUubG9nKCdvbk1lc3NhZ2UnLCB3cywgZGF0YSk7CiAgICAgICAgcmV0dXJuIGNhbGxiYWNrcy5vbk1lc3NhZ2Uod3MsIGRhdGEpOwogICAgICB9LAogICAgICBvbkZkKGZkLCByZCwgd3IpIHsKICAgICAgICByZXR1cm4gY2FsbGJhY2tzLm9uRmQoZmQsIHJkLCB3cik7CiAgICAgIH0sCiAgICAgIC4uLih1cmwgJiYgdXJsLmhvc3QgPyB1cmwgOiB7fSkKICAgIH0pOwogIH0pOwoKICBkZWZpbmUoZ2xvYmFsVGhpcywgewogICAgZ2V0IGNvbm5lY3Rpb25zKCkgewogICAgICByZXR1cm4gWy4uLmNvbm5lY3Rpb25zXTsKICAgIH0sCiAgICBnZXQgYnlfdXVpZCgpIHsKICAgICAgcmV0dXJuIGJ5X3V1aWQ7CiAgICB9LAogICAgdXVpZChkYXRhKSB7CiAgICAgIHJldHVybiBieV91dWlkW2RhdGFdOwogICAgfQogIH0pOwoKICBPYmplY3QuYXNzaWduKGdsb2JhbFRoaXMsIHsKICAgIHJlcGwsCiAgICBxdWl0LAogICAgZXhpdDogcXVpdCwKICAgIHN0ZCwKICAgIG9zLAogICAgZGVlcCwKICAgIGZzLAogICAgcGF0aCwKICAgIFJlYWRKU09OLAogICAgV3JpdGVKU09OLAogICAgUmVhZEZpbGUsCiAgICBXcml0ZUZpbGUsCiAgICBSZWFkQkpTT04sCiAgICBXcml0ZUJKU09OLAogICAgcGFyc2VEYXRlLAogICAgZGF0ZVRvT2JqZWN0LAogICAgSGFzaCwKICAgIEZvcm1QYXJzZXIsCiAgICBFeGVjVG9vbCwKICAgIEV4ZWN1dGUsCiAgICBleHRlbmRHZW5lcmF0b3IsCiAgICBleHRlbmRBcnJheSwKICAgIGV4dGVuZEFzeW5jR2VuZXJhdG9yLAogICAgTWF0Y2hlciwKICAgIEV4ZWNUb29sLAogICAgR2V0TWltZSwKICAgIE1hdGNoZXIsCiAgICBLZXlPclZhbHVlTWF0Y2hlciwKICAgIEdldFJvb3REaXJlY3RvcmllcywKICAgIEdldERpciwKICAgIERpck5hbWUsCiAgICBEYXRlU3RyLAogICAgTW9kZVN0ciwKICAgIFJlYWRFeGl2MiwKICAgIFJlYWRFeGlmdG9vbCwKICAgIEhlaWZDb252ZXJ0LAogICAgTWFnaWNrUmVzaXplLAogICAgRGlyZWN0b3J5LAogICAgbmV0OiB7IHNldExvZywgTExMX1VTRVIsIExMTF9OT1RJQ0UsIExMTF9XQVJOLCBMTExfSU5GTywgY2xpZW50LCBzZXJ2ZXIsIEZvcm1QYXJzZXIsIEhhc2gsIFJlc3BvbnNlLCBTb2NrZXQgfQogIH0pOwoKICBkZWxldGUgZ2xvYmFsVGhpcy5ERUJVRzsKCiAgY3JlYXRlV1MoCiAgICB7IHByb3RvY29sOiAnd3MnLCBob3N0OiAnMC4wLjAuMCcsIHBvcnQ6IDg5OTkgfSwKICAgIHsKICAgICAgb25GZChmZCwgcmQsIHdyKSB7CiAgICAgICAgb3Muc2V0UmVhZEhhbmRsZXIoZmQsIHJkKTsKICAgICAgICBvcy5zZXRXcml0ZUhhbmRsZXIoZmQsIHdyKTsKICAgICAgfSwKICAgICAgb25DbG9zZSh3cywgcmVhc29uKSB7fSwKICAgICAgb25NZXNzYWdlKHdzLCBkYXRhKSB7fQogICAgfSwKICAgIHRydWUKICApOwoKICBmdW5jdGlvbiBxdWl0KHdoeSkgewogICAgY29uc29sZS5sb2coYHF1aXQoJyR7d2h5fScpYCk7CgogICAgbGV0IGNmZyA9IHsgaW5zcGVjdE9wdGlvbnM6IGNvbnNvbGUub3B0aW9ucyB9OwogICAgV3JpdGVKU09OKGAuJHtiYXNlfS1jb25maWdgLCBjZmcpOwogICAgcmVwbC5jbGVhbnVwKHdoeSk7CiAgfQoKICByZXBsLnJ1blN5bmMoKTsKfQoKdHJ5IHsKICBtYWluKC4uLnNjcmlwdEFyZ3Muc2xpY2UoMSkpOwp9IGNhdGNoKGVycm9yKSB7CiAgY29uc29sZS5sb2coYEZBSUw6ICR7ZXJyb3I/Lm1lc3NhZ2UgPz8gZXJyb3J9XG4ke2Vycm9yPy5zdGFja31gKTsKICAxOwogIHN0ZC5leGl0KDEpOwp9IGZpbmFsbHkgewp9CgAAAAAAAAAAKIcAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAlEYAAAAAAACURgAAAAAAAAAAAAAAwIBA"
				]
			]
		},
		{
			"file": "clang-ast.js",
			"settings":
			{
				"buffer_size": 79597,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					120,
					1,
					"insert",
					{
						"characters": " "
					},
					"AgAAAHRiAAAAAAAAdWIAAAAAAAAAAAAAdWIAAAAAAAB1YgAAAAAAAAYAAAAgICAvLyA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAB6YgAAAAAAAHRiAAAAAAAAAAAAAAAA8L8"
				],
				[
					131,
					1,
					"insert",
					{
						"characters": "l"
					},
					"AQAAAFBiAAAAAAAAUWIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABQYgAAAAAAAFBiAAAAAAAAAAAAAAAA8L8"
				],
				[
					132,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAFFiAAAAAAAAUmIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABRYgAAAAAAAFFiAAAAAAAAAAAAAAAA8L8"
				],
				[
					133,
					2,
					"left_delete",
					null,
					"AgAAAFFiAAAAAAAAUWIAAAAAAAABAAAAIFBiAAAAAAAAUGIAAAAAAAABAAAAbA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABSYgAAAAAAAFJiAAAAAAAAAAAAAAAA8L8"
				],
				[
					138,
					1,
					"insert",
					{
						"characters": ","
					},
					"AQAAAFBiAAAAAAAAUWIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABQYgAAAAAAAFBiAAAAAAAAAAAAAAAA8L8"
				],
				[
					139,
					1,
					"insert",
					{
						"characters": " deep."
					},
					"BgAAAFFiAAAAAAAAUmIAAAAAAAAAAAAAUmIAAAAAAABTYgAAAAAAAAAAAABTYgAAAAAAAFRiAAAAAAAAAAAAAFRiAAAAAAAAVWIAAAAAAAAAAAAAVWIAAAAAAABWYgAAAAAAAAAAAABWYgAAAAAAAFdiAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABRYgAAAAAAAFFiAAAAAAAAAAAAAAAA8L8"
				],
				[
					140,
					1,
					"insert",
					{
						"characters": "RETURN_VALUE"
					},
					"DAAAAFdiAAAAAAAAWGIAAAAAAAAAAAAAWGIAAAAAAABZYgAAAAAAAAAAAABZYgAAAAAAAFpiAAAAAAAAAAAAAFpiAAAAAAAAW2IAAAAAAAAAAAAAW2IAAAAAAABcYgAAAAAAAAAAAABcYgAAAAAAAF1iAAAAAAAAAAAAAF1iAAAAAAAAXmIAAAAAAAAAAAAAXmIAAAAAAABfYgAAAAAAAAAAAABfYgAAAAAAAGBiAAAAAAAAAAAAAGBiAAAAAAAAYWIAAAAAAAAAAAAAYWIAAAAAAABiYgAAAAAAAAAAAABiYgAAAAAAAGNiAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABXYgAAAAAAAFdiAAAAAAAAAAAAAAAA8L8"
				],
				[
					149,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAAALNwEAaW1wb3J0IHsgYXNzZXJ0LCBsYXp5UHJvcGVydGllcywgZGVmaW5lLCBpc09iamVjdCwgbWVtb2l6ZSwgdW5pcXVlIH0gZnJvbSAnLi9saWIvbWlzYy5qcyc7CmltcG9ydCBVdGlsIGZyb20gJy4vbGliL3V0aWwuanMnOwppbXBvcnQgKiBhcyBwYXRoIGZyb20gJy4vbGliL3BhdGguanMnOwppbXBvcnQgKiBhcyBkZWVwIGZyb20gJy4vbGliL2RlZXAuanMnOwppbXBvcnQgeyBQb2ludGVyIH0gZnJvbSAnLi9saWIvcG9pbnRlci5qcyc7CmltcG9ydCB7IEFjcXVpcmVSZWFkZXIgfSBmcm9tICcuL2xpYi9zdHJlYW0vdXRpbHMuanMnOwppbXBvcnQgeyBJZkRlYnVnLCBMb2dJZkRlYnVnLCBSZWFkRmlsZSwgTG9hZEhpc3RvcnksIFJlYWRKU09OLCBSZWFkWE1MLCBNYXBGaWxlLCBXcml0ZUZpbGUsIFdyaXRlSlNPTiwgV3JpdGVYTUwsIFJlYWRCSlNPTiwgV3JpdGVCSlNPTiwgRGlySXRlcmF0b3IsIFJlY3Vyc2l2ZURpckl0ZXJhdG9yLCBSZWFkRGlyUmVjdXJzaXZlLCBGaWx0ZXIsIEZpbHRlckltYWdlcywgU29ydEZpbGVzLCBTdGF0RmlsZXMsIFJlYWRGZCwgRmRSZWFkZXIsIENvcHlUb0NsaXBib2FyZCwgUmVhZENhbGxiYWNrLCBMb2dDYWxsLCBTcGF3biwgRmV0Y2hVUkwgfSBmcm9tICcuL2lvLWhlbHBlcnMuanMnOwpleHBvcnQgbGV0IFNJWkVPRl9QT0lOVEVSID0gODsKZXhwb3J0IGxldCBTSVpFT0ZfSU5UID0gNDsKaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnOwppbXBvcnQgeyBjb3VudFN1YnN0cmluZywgZmluZEFsbEluZGV4ZXMgfSBmcm9tICcuL3N0cmluZy1oZWxwZXJzLmpzJzsKCmZ1bmN0aW9uIEZpbGVUaW1lKGZpbGVuYW1lKSB7CiAgbGV0IHN0ID0gZnMuc3RhdFN5bmMoZmlsZW5hbWUpOwogIHJldHVybiBzdCA/IHN0Lm10aW1lID8/IHN0LnRpbWUgOiAtMTsKfQoKZnVuY3Rpb24gTmV3ZXIoZmlsZSwgLi4ub3RoZXIpIHsKICAvL2NvbnNvbGUubG9nKCdOZXdlcicsIHsgZmlsZSwgb3RoZXIgfSk7CiAgcmV0dXJuIG90aGVyLmV2ZXJ5KG90aGVyID0+IEZpbGVUaW1lKGZpbGUpID4gRmlsZVRpbWUob3RoZXIpKTsKfQpmdW5jdGlvbiBPbGRlcihmaWxlLCBvdGhlcikgewogIHJldHVybiBGaWxlVGltZShmaWxlKSA8IEZpbGVUaW1lKG90aGVyKTsKfQoKZnVuY3Rpb24gR2V0U3Vic2NyaXB0cyhzdHIpIHsKICBsZXQgbWF0Y2hlcyA9IFsuLi5VdGlsLm1hdGNoQWxsKC9cWyhbMC05XSopXF0vZywgc3RyKV07CiAgcmV0dXJuIG1hdGNoZXMubWFwKG0gPT4gW20uaW5kZXgsICttWzFdXSk7Cn0KCmZ1bmN0aW9uIFRyaW1TdWJzY3JpcHRzKHN0ciwgc3ViKSB7CiAgbGV0IFtzdWJzY3JpcHQgPSBbc3RyLmxlbmd0aF1dID0gc3ViID8/IEdldFN1YnNjcmlwdHMoc3RyKSA/PyBbW3N0ci5sZW5ndGhdXTsKICAvL2NvbnNvbGUubG9nKCJzdWJzY3JpcHQ6IixzdWJzY3JpcHQpOwogIHJldHVybiBzdHIuc2xpY2UoMCwgc3Vic2NyaXB0WzBdKS50cmltRW5kKCk7Cn0KCmV4cG9ydCBjbGFzcyBMaXN0IGV4dGVuZHMgQXJyYXkgewogIGNvbnN0cnVjdG9yKC4uLmFyZ3MpIHsKICAgIHN1cGVyKC4uLmFyZ3MpOwogIH0KCiAgc3RhdGljIGdldCBbU3ltYm9sLnNwZWNpZXNdKCkgewogICAgcmV0dXJuIExpc3Q7CiAgfQogIC8qIHByZXR0aWVyLWlnbm9yZSAqLyBnZXQgW1N5bWJvbC5zcGVjaWVzXSgpIHsKICAgIHJldHVybiBMaXN0OwogIH0KCiAgZmlsdGVyKGNhbGxiYWNrLCB0aGlzQXJnID0gbnVsbCkgewogICAgbGV0IHJldCA9IG5ldyBMaXN0KCk7CiAgICBsZXQgaSA9IDA7CgogICAgaWYodHlwZW9mIGNhbGxiYWNrID09ICdvYmplY3QnICYmIGNhbGxiYWNrICE9IG51bGwgJiYgY2FsbGJhY2sgaW5zdGFuY2VvZiBSZWdFeHApIHsKICAgICAgdmFyIHJlID0gY2FsbGJhY2s7CiAgICAgIGNhbGxiYWNrID0gZWxlbSA9PgogICAgICAgIHR5cGVvZiBlbGVtID09ICdvYmplY3QnICYmIGVsZW0gIT0gbnVsbCAmJiAocmUudGVzdChlbGVtLm5hbWUpIHx8IChHZXRMb2MoZWxlbSkgJiYgcmUudGVzdChHZXRMb2MoZWxlbSkuZmlsZSkpKTsKICAgIH0KCiAgICBmb3IobGV0IGVsZW0gb2YgdGhpcykgewogICAgICBpZihjYWxsYmFjay5jYWxsKHRoaXNBcmcsIGVsZW0sIGksIHRoaXMpKSByZXRbaV0gPSBlbGVtOwogICAgICBpKys7CiAgICB9CiAgICByZXR1cm4gcmV0OwogIH0KCiAgc2xpY2Uoc3RhcnQsIGVuZCkgewogICAgbGV0IHJldCA9IG5ldyBMaXN0KCk7CiAgICBsZXQgaSA9IDA7CgogICAgaWYoc3RhcnQgPCAwKSBzdGFydCA9IChzdGFydCAlIHRoaXMubGVuZ3RoKSArIHRoaXMubGVuZ3RoOwogICAgc3RhcnQgPz89IDA7CiAgICBpZihlbmQgPCAwKSBlbmQgPSAoZW5kICUgdGhpcy5sZW5ndGgpICsgdGhpcy5sZW5ndGg7CiAgICBlbmQgPz89IHRoaXMubGVuZ3RoOwoKICAgIGZvcihsZXQgaSA9IHN0YXJ0OyBpIDwgZW5kOyBpKyspIHJldFtpXSA9IHRoaXNbaV07CiAgICByZXR1cm4gcmV0OwogIH0KCiAgLyogcHJldHRpZXItaWdub3JlICovIGdldCBmaXJzdCgpIHsKICAgIHJldHVybiB0aGlzLmZpbmQoZWxlbSA9PiBlbGVtICE9PSB1bmRlZmluZWQpOwogIH0KCiAgZW50cmllcygpIHsKICAgIGxldCByZXQgPSBbXTsKICAgIGZvcihsZXQgW2ksIGVsZW1dIG9mIHN1cGVyLmVudHJpZXMoKSkgewogICAgICBpZihlbGVtKSByZXQucHVzaChbaSwgZWxlbV0pOwogICAgfQogICAgcmV0dXJuIHJldDsKICB9CgogIGtleXMoKSB7CiAgICBsZXQgcmV0ID0gW107CiAgICBmb3IobGV0IFtpLCBlbGVtXSBvZiBzdXBlci5lbnRyaWVzKCkpIHsKICAgICAgaWYoZWxlbSkgcmV0LnB1c2goaSk7CiAgICB9CiAgICByZXR1cm4gcmV0OwogIH0KCiAgdmFsdWVzKCkgewogICAgbGV0IHJldCA9IFtdOwogICAgZm9yKGxldCBbaSwgZWxlbV0gb2Ygc3VwZXIuZW50cmllcygpKSB7CiAgICAgIGlmKGVsZW0pIHJldC5wdXNoKGVsZW0pOwogICAgfQogICAgcmV0dXJuIHJldDsKICB9CgogIHRvQXJyYXkoKSB7CiAgICByZXR1cm4gdGhpcy5yZWR1Y2UoKGEsIG4pID0+IFsuLi5hLCBuXSwgW10pOwogIH0KfQoKZGVmaW5lKExpc3QucHJvdG90eXBlLCB7IFtTeW1ib2wudG9TdHJpbmdUYWddOiAnTGlzdCcgfSk7CgpleHBvcnQgY2xhc3MgTm9kZSB7CiAgc3RhdGljIGFzdDJub2RlID0gbmV3IFdlYWtNYXAoKTsKICBzdGF0aWMgbm9kZTJhc3QgPSBuZXcgV2Vha01hcCgpOwoKICBjb25zdHJ1Y3Rvcihhc3QpIHsKICAgIGlmKHR5cGVvZiBhc3QgPT0gJ29iamVjdCcgJiYgYXN0ICE9IG51bGwpIHsKICAgICAgaWYoJ3BhdGgnIGluIGFzdCAmJiAndmFsdWUnIGluIGFzdCkgYXN0ID0gYXN0LnZhbHVlOwoKICAgICAgLy8gICB0aHJvdyBuZXcgRXJyb3IoYE5vZGUgY29uc3RydWN0b3IgJHtpbnNwZWN0KGFzdCl9YCk7CiAgICAgIE5vZGUuYXN0Mm5vZGUuc2V0KGFzdCwgdGhpcyk7CiAgICAgIE5vZGUubm9kZTJhc3Quc2V0KHRoaXMsIGFzdCk7CiAgICB9CiAgfQoKICBzdGF0aWMgZ2V0KGFzdCkgewogICAgcmV0dXJuIE5vZGUuYXN0Mm5vZGUuZ2V0KGFzdCk7CiAgfQoKICAvKiBwcmV0dGllci1pZ25vcmUgKi8gZ2V0IGFzdCgpIHsKICAgIHJldHVybiBOb2RlLm5vZGUyYXN0LmdldCh0aGlzKTsKICB9CgogIC8qIHByZXR0aWVyLWlnbm9yZSAqLyBnZXQgaWQoKSB7CiAgICByZXR1cm4gdGhpcy5hc3QuaWQ7CiAgfQogIC8qIHByZXR0aWVyLWlnbm9yZSAqLyBnZXQgbG9jKCkgewogICAgcmV0dXJuIG5ldyBMb2NhdGlvbihHZXRMb2ModGhpcy5hc3QpKTsKICB9CiAgLyogcHJldHRpZXItaWdub3JlICovIGdldCBmaWxlKCkgewogICAgY29uc3QgbG9jID0gdGhpcy5hc3QubG9jID8/IGRlZXAuZmluZCh0aGlzLmFzdCwgKHYsaykgPT4gaz09J2xvYycpID8/IGRlZXAuZmluZCh0LmFzdCwgKHYsaykgPT4gdHlwZW9mIHYgPT0gJ29iamVjdCcgJiYgdiAhPSBudWxsICYmICdmaWxlJyBpbiB2KTsKICAgIGlmKGxvYykgcmV0dXJuIGxvYy5maWxlOwogIH0KCiAgLyogcHJldHRpZXItaWdub3JlICovIGdldCByYW5nZSgpIHsKICAgIGNvbnN0IHsgcmFuZ2UgfSA9IHRoaXMuYXN0OwogbGV0IGxvYyxmaWxlOwogICAgaWYocmFuZ2UpIHsKICAgICAgbGV0IHsgYmVnaW4sZW5kfSA9IHJhbmdlOwogICAgICBpZighKCdsaW5lJyBpbiBiZWdpbikpCiAgICAgICAgYmVnaW4ubGluZSA9IChsb2MgPz89IHRoaXMubG9jKS5saW5lOwogICAgICByZXR1cm4gW2JlZ2luLGVuZF0ubWFwKHIgPT4gewogICAgIGlmKCEoJ2ZpbGUnIGluIHIpKSAKICAgICAgci5maWxlID0gZmlsZSA/Pz0gdGhpcy5maWxlOwogICAgICAgIHJldHVybiBuZXcgTG9jYXRpb24ocik7CiAgICAgIH0pOwogICAgfQogICAgICByZXR1cm4gWwogICAgICAgIG5ldyBMb2NhdGlvbihyYW5nZS5iZWdpbiksIAogICAgICAgIG5ldyBMb2NhdGlvbihyYW5nZS5lbmQpCiAgICAgIF07CiAgfQoKICAvKiAgW1N5bWJvbC5mb3IoIm5vZGVqcy51dGlsLmluc3BlY3QuY3VzdG9tIildKGRlcHRoLCBvcHRzID0ge30pIHsKICAgIGNvbnN0IHRleHQgPSBvcHRzLmNvbG9ycyA/ICh0LCAuLi5jKSA9PiAnXHgxYlsnICsgYy5qb2luKCc7JykgKyAnbScgKyB0ICsgJ1x4MWJbbScgOiB0ID0+IHQ7CiAgICBjb25zdCB0eXBlID0gdGhpcy5jb25zdHJ1Y3Rvcj8ubmFtZSA/PyBVdGlsLmNsYXNzTmFtZSh0aGlzKTsKCiAgICByZXR1cm4gKHRleHQodHlwZSwgMSwgMzEpICsKICAgICAgJyAnICsKICAgICAgaW5zcGVjdCh0aGlzID8/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRoaXMpLnJlZHVjZSgoYWNjLG5hbWUpID0+ICh7Li4uYWNjLCBbbmFtZV06IHRoaXNbbmFtZV0gfSksIHt9KSwgZGVwdGgsIHsgLi4ub3B0cywgY3VzdG9tSW5zcGVjdDogdHJ1ZSB9KQogICAgKTsKICB9Ki8KCiAgdG9KU09OKG9iaikgewogICAgY29uc3QgeyBraW5kIH0gPSB0aGlzOwogICAgb2JqID8/PSB7IGtpbmQgfTsKICAgIGlmKCFvYmoua2luZCkgb2JqLmtpbmQgPSBVdGlsLmNsYXNzTmFtZSh0aGlzKTsKICAgIHJldHVybiBvYmo7CiAgfQoKICAvKiBwcmV0dGllci1pZ25vcmUgKi8gZ2V0IFtTeW1ib2wudG9TdHJpbmdUYWddKCkgewogICAgcmV0dXJuIHRoaXMuY29uc3RydWN0b3IubmFtZTsKICB9Cn0KCmNvbnN0IGdldFR5cGVGcm9tTm9kZSA9IG1lbW9pemUoKG5vZGUsIGFzdCkgPT4gbmV3IFR5cGUobm9kZS50eXBlLCBhc3QpLCBuZXcgV2Vha01hcCgpKTsKCmV4cG9ydCBmdW5jdGlvbiBQYXRoT2Yobm9kZSwgYXN0ID0gJC5kYXRhKSB7CiAgcmV0dXJuIG5ldyBQb2ludGVyKGRlZXAucGF0aE9mKGFzdCwgbm9kZSwgZGVlcC5SRVRVUk5fUEFUSCkpOwp9CgpleHBvcnQgZnVuY3Rpb24qIEhpZXIobm9kZV9vcl9wYXRoLCB0ID0gKHAsIGFzdCwgYWJvcnQpID0+IHAuZGVyZWYoYXN0KSwgYXN0ID0gJC5kYXRhKSB7CiAgbGV0IHA7CiAgaWYobm9kZV9vcl9wYXRoICYmIG5vZGVfb3JfcGF0aC5raW5kKSBwID0gUGF0aE9mKG5vZGVfb3JfcGF0aCwgYXN0KTsKICBlbHNlIHAgPSBuZXcgUG9pbnRlcihub2RlX29yX3BhdGgpOwogIGxldCBoaWVyID0gcAogICAgLmhpZXIoKQogICAgLnJldmVyc2UoKQogICAgLmZpbHRlcihwID0+IHAuYXQoLTEpICE9ICdpbm5lcicpOwoKICBmb3IobGV0IHBwIG9mIGhpZXIpIHsKICAgIGxldCBkb0Fib3J0ID0gZmFsc2U7CiAgICBsZXQgYWJvcnRGbiA9ICgpID0+IChkb0Fib3J0ID0gdHJ1ZSk7CiAgICB5aWVsZCB0KHBwLCBhc3QsIGFib3J0Rm4pOwogICAgaWYoZG9BYm9ydCkgYnJlYWs7CiAgfQp9CgpleHBvcnQgZnVuY3Rpb24gRmluZFR5cGUodHlwZU5hbWUsIGFzdCA9ICQuZGF0YSkgewogIGxldCB0b2tlbnMgPSBbLi4udHlwZU5hbWUubWF0Y2hBbGwoL1tBLVphLXpfXVtBLVphLXowLTlfXSsvZyldLm1hcCgoW3Rva10pID0+IHRvayk7CgogIHdoaWxlKFsnY29uc3QnXS5pbmRleE9mKHRva2Vuc1swXSkgIT0gLTEpIHsKICAgIHRva2Vucy5zaGlmdCgpOwogICAgdHlwZU5hbWUgPSB0eXBlTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoJ14nICsgdG9rZW5zWzBdICsgJ1xccyonKSwgJycpOwogIH0KICAvLyAgY29uc29sZS5sb2coJ3Rva2VucycsIHRva2Vucyk7CgogIGxldCBub2RlcyA9IGRlZXAuc2VsZWN0KGFzdCwgbiA9PiBuLm5hbWUgPT0gdG9rZW5zWzBdLCBkZWVwLlJFVFVSTl9WQUxVRSk7CgogIG5vZGVzID0gbm9kZXMuZmlsdGVyKG5vZGUgPT4gbm9kZS5pbm5lciAmJiBub2RlLmlubmVyLmxlbmd0aCk7CiAgY29uc29sZS5sb2coJ25vZGVzJywgbm9kZXMpOwoKICByZXR1cm4gbmV3IFR5cGUodHlwZU5hbWUsIGFzdCk7Cn0KCmV4cG9ydCBjbGFzcyBUeXBlIGV4dGVuZHMgTm9kZSB7CiAgc3RhdGljIGRlY2xhcmF0aW9ucyA9IG5ldyBNYXAoKTsKICBzdGF0aWMgbm9kZTJ0eXBlID0gZ2V0VHlwZUZyb21Ob2RlLmNhY2hlOwoKICBjb25zdHJ1Y3Rvcihub2RlLCBhc3QpIHsKICAgIGxldCBuYW1lLCBkZXN1Z2FyZWQsIHR5cGVBbGlhcywgcXVhbFR5cGU7CgogICAgLy9jb25zb2xlLmxvZygnVHlwZScsIHR5cGVvZiBub2RlLCB0eXBlb2Ygbm9kZSA9PSAnc3RyaW5nJyA/IG5vZGUgOiBub2RlLmtpbmQgPz8gbm9kZS5uYW1lID8/IG5vZGUucXVhbFR5cGUpOwoKICAgIGFzdCA/Pz0gZ2xvYmFsVGhpc1snJCddPy5kYXRhOwoKICAgIGlmKHR5cGVvZiBub2RlID09ICdzdHJpbmcnKSB7CiAgICAgIGxldCB0bXA7CiAgICAgIG5hbWUgPSBub2RlOwogICAgICBxdWFsVHlwZSA9IG5vZGU7CiAgICAgIG5vZGUgPSBudWxsOwogICAgICBpZihUeXBlLmRlY2xhcmF0aW9ucy5oYXMobmFtZSkpIHsKICAgICAgICBub2RlID0gVHlwZS5kZWNsYXJhdGlvbnMuZ2V0KG5hbWUpLmFzdDsKICAgICAgfQogICAgICAvLyBhc3QgPz89IGdsb2JhbFRoaXNbJyQnXT8uZGF0YTsKICAgICAgaWYoCiAgICAgICAgYXN0ICYmCiAgICAgICAgdHlwZW9mICh0bXAgPSBkZWVwLmZpbmQoYXN0LCBuID0+IHR5cGVvZiBuID09ICdvYmplY3QnICYmIG4gJiYgbi5uYW1lID09IG5hbWUpKSA9PSAnb2JqZWN0JyAmJgogICAgICAgIHRtcCAhPSBudWxsCiAgICAgICkgewogICAgICAgIC8vY29uc29sZS5sb2coJ1R5cGUnLCB0bXAsIG5hbWU7CiAgICAgICAgdG1wID0gJ2tpbmQnIGluIHRtcCA/IFR5cGVGYWN0b3J5KHRtcCwgYXN0KSA6IG5ldyBUeXBlKHRtcCwgYXN0KTsKCiAgICAgICAgaWYodG1wKSBub2RlID0gJ2FzdCcgaW4gdG1wID8gdG1wLmFzdCA6IHRtcDsKICAgICAgfQoKICAgICAgY29uc3QgaXNQb2ludGVyID0gbmFtZS5lbmRzV2l0aCgnKicpOwogICAgICBjb25zdCBpc1JlZmVyZW5jZSA9IG5hbWUuZW5kc1dpdGgoJyYnKTsKCiAgICAgIGlmKGlzUG9pbnRlcikgewogICAgICAgIG5vZGUgPSB7CiAgICAgICAgICBraW5kOiAnQ3VzdG9tVHlwZScsCiAgICAgICAgICBxdWFsVHlwZTogbmFtZSwKICAgICAgICAgIGRlc3VnYXJlZFF1YWxUeXBlOiAndm9pZCAqJwogICAgICAgIH07CiAgICAgIH0KICAgICAgaWYoIWlzUG9pbnRlciAmJiAhaXNSZWZlcmVuY2UgJiYgIW5vZGUpIHsKICAgICAgICBsZXQgc3Vic2NyaXB0cyA9IEdldFN1YnNjcmlwdHMobmFtZSk7CiAgICAgICAgbmFtZSA9IFRyaW1TdWJzY3JpcHRzKG5hbWUsIHN1YnNjcmlwdHMpOwogICAgICAgIC8vY29uc29sZS5sb2coJ1R5cGUnLCB7IG5hbWUsIHN1YnNjcmlwdHMgfSk7CgogICAgICAgIG5vZGUgPSBHZXRUeXBlKG5hbWUsIGFzdCk7CgogICAgICAgIGlmKCFub2RlKSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vIHN1Y2ggdHlwZSAnJHtuYW1lfSdgKTsKICAgICAgICAgIG5vZGUgPSB7fTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coYEZvdW5kIHR5cGUgJHtuYW1lfWAsIG5vZGUpOwogICAgICAgIH0KICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYoJ3BhdGgnIGluIG5vZGUgJiYgJ3ZhbHVlJyBpbiBub2RlKSBub2RlID0gbm9kZS52YWx1ZTsKICAgIH0KCiAgICBpZihub2RlIGluc3RhbmNlb2YgTm9kZSkgewogICAgICAvL2NvbnNvbGUubG9nKCdub2RlJywgVXRpbC5jbGFzc05hbWUobm9kZSksIG5vZGUpOwogICAgICBVdGlsLnB1dFN0YWNrKCk7CiAgICAgIHRocm93IG5ldyBFcnJvcigpOwogICAgfQoKICAgIHN1cGVyKG5vZGUpOwogICAgLy9jb25zb2xlLmxvZygnbm9kZTonLCBub2RlKTsKCiAgICBpZihub2RlLnRhZ1VzZWQgJiYgbmFtZSkgbmFtZSA9IChub2RlLnRhZ1VzZWQgPyBub2RlLnRhZ1VzZWQgKyAnICcgOiAnJykgKyBuYW1lOwogICAgaWYobm9kZS5raW5kICYmIG5vZGUua2luZC5zdGFydHNXaXRoKCdFbnVtJykpIG5hbWUgPSAnZW51bSAnICsgbmFtZTsKCiAgICBsZXQgdHlwZSA9ICd0eXBlJyBpbiBub2RlID8gbm9kZS50eXBlIDogbm9kZTsKCiAgICBuYW1lID0gdHlwZS5uYW1lID8/IG5vZGUubmFtZTsKICAgIHF1YWxUeXBlID0gdHlwZS5xdWFsVHlwZSA/PyBub2RlLnF1YWxUeXBlOwoKICAgIGRlc3VnYXJlZCA9IHR5cGUuZGVzdWdhcmVkUXVhbFR5cGUgPz8gbm9kZS5kZXN1Z2FyZWRRdWFsVHlwZTsKICAgIHR5cGVBbGlhcyA9IHR5cGUudHlwZUFsaWFzRGVjbElkID8/IG5vZGUudHlwZUFsaWFzRGVjbElkOwoKICAgIGlmKG5vZGUuaW5uZXIgJiYgbm9kZS5pbm5lclswXSAmJiBub2RlLmlubmVyWzBdLmtpbmQgPT0gJ0VsYWJvcmF0ZWRUeXBlJykgewogICAgICB0eXBlQWxpYXMgPz89IG5vZGUuaW5uZXJbMF0/Lm93bmVkVGFnRGVjbD8uaWQ7CgogICAgICBpZih0eXBlQWxpYXMpIHsKICAgICAgICBsZXQgYWxpYXMgPSBuZXcgVHlwZSgKICAgICAgICAgIGFzdC5pbm5lci5maW5kKG4gPT4gbi5pZCA9PSB0eXBlQWxpYXMpLAogICAgICAgICAgYXN0CiAgICAgICAgKTsKICAgICAgICBpZihuYW1lKSBhbGlhcy5uYW1lID0gbmFtZTsKICAgICAgICBpZihxdWFsVHlwZSkgYWxpYXMucXVhbFR5cGUgPSBxdWFsVHlwZTsKICAgICAgICBpZihkZXN1Z2FyZWQpIGFsaWFzLmRlc3VnYXJlZCA9IGRlc3VnYXJlZDsKICAgICAgfQogICAgfQoKICAgIGlmKGRlc3VnYXJlZCA9PT0gcXVhbFR5cGUpIGRlc3VnYXJlZCA9IHVuZGVmaW5lZDsKICAgIGlmKG5hbWUgPT0gJycpIG5hbWUgPSB1bmRlZmluZWQ7CgogICAgaWYobmFtZSkgewogICAgICBpZighVHlwZS5kZWNsYXJhdGlvbnMuaGFzKG5hbWUpKSBUeXBlLmRlY2xhcmF0aW9ucy5zZXQobmFtZSwgdGhpcyk7CiAgICB9IGVsc2UgaWYocXVhbFR5cGUpIHsKICAgICAgaWYoIVR5cGUuZGVjbGFyYXRpb25zLmhhcyhxdWFsVHlwZSkpIFR5cGUuZGVjbGFyYXRpb25zLnNldChxdWFsVHlwZSwgdGhpcyk7CiAgICB9CgogICAgaWYodHlwZUFsaWFzKSB0eXBlQWxpYXMgPSArdHlwZUFsaWFzOwoKICAgIFV0aWwud2Vha0Fzc2lnbih0aGlzLCB7IG5hbWUsIGRlc3VnYXJlZCwgdHlwZUFsaWFzLCBxdWFsVHlwZSB9KTsKCiAgICBpZih0aGlzLmlzUG9pbnRlcigpKSB7CiAgICAgIGxldCBwdHIgPSAobmFtZSA/PyB0aGlzICsgJycpLnJlcGxhY2UoL1wqJC8sICcnKS50cmltRW5kKCk7CiAgICAgIC8vY29uc29sZS5sb2coJ3B0cjonLCBwdHIpOwogICAgICBpZihhc3QpIHsKICAgICAgICBsZXQgbm9kZSA9IGRlZXAuZmluZChhc3QsIChuLCBwKSA9PiAocC5sZW5ndGggPiAyID8gLTEgOiB0eXBlb2YgbiA9PSAnb2JqZWN0JyAmJiBuICYmIG4ubmFtZSA9PSBwdHIpKT8udmFsdWU7CgogICAgICAgIGlmKG5vZGUpIG5ldyBUeXBlKG5vZGUsIGFzdCk7CiAgICAgIH0KICAgIH0gZWxzZSBpZih0aGlzLmlzRW51bSgpKSB7CiAgICAgIHRoaXMuZGVzdWdhcmVkID0gJ2ludCc7CiAgICB9CiAgfQoKICAvKiBwcmV0dGllci1pZ25vcmUgKi8gZ2V0IHJlZ0V4cCgpIHsKICAgIHJldHVybiBuZXcgUmVnRXhwKGAoPzoke3RoaXMucXVhbFR5cGV9JHt0aGlzLnR5cGVBbGlhcyA/ICd8JyArIHRoaXMudHlwZUFsaWFzIDogJyd9KWAucmVwbGFjZSgvXCovZywgJ1xcKicpLAogICAgICAnZycKICAgICAgKTsKICB9CiAgaXNFbnVtKCkgewogICAgbGV0IHN0ciA9IHRoaXMucXVhbFR5cGUgfHwgdGhpcyArICcnOwogICAgcmV0dXJuIC9eZW51bVxzLy50ZXN0KHN0cik7CiAgfQogIGlzUG9pbnRlcigpIHsKICAgIGxldCB7IGRlc3VnYXJlZCwgcXVhbFR5cGUgfSA9IHRoaXM7CiAgICByZXR1cm4gLyg/OlwoXCpcKVwofFwqJCkvLnRlc3QoZGVzdWdhcmVkKSB8fCAvXCokLy50ZXN0KHF1YWxUeXBlKTsKICB9CgogIGlzRnVuY3Rpb24oKSB7CiAgICBsZXQgc3RyID0gdGhpcyArICcnOwogICAgcmV0dXJuIC9cKC4qXCkkLy50ZXN0KHN0cikgJiYgIS9cKFwqXClcKC8udGVzdChzdHIpOwogIH0KCiAgaXNBcnJheSgpIHsKICAgIGxldCBzdHIgPSB0aGlzICsgJyc7CiAgICByZXR1cm4gL1xbWzAtOV0qXF0kLy50ZXN0KHN0cik7CiAgfQoKICBhcnJheU9mKCkgewogICAgbGV0IHR5cGVOYW1lID0gdGhpcy50cmltU3Vic2NyaXB0cygpOwogICAgcmV0dXJuIFR5cGUuZGVjbGFyYXRpb25zLmdldCh0eXBlTmFtZSk7CiAgfQoKICAvKiBwcmV0dGllci1pZ25vcmUgKi8gZ2V0IHN1YnNjcmlwdHMoKSB7CiAgICBpZih0aGlzLmlzQXJyYXkoKSkKICAgICAgcmV0dXJuIEdldFN1YnNjcmlwdHModGhpcysnJyk7CiAgfQoKICB0cmltU3Vic2NyaXB0cygpIHsKICAgIGxldCBzdHIgPSB0aGlzICsgJyc7CiAgICByZXR1cm4gVHJpbVN1YnNjcmlwdHMoc3RyKTsKICB9CgogIC8qIHByZXR0aWVyLWlnbm9yZSAqLyBnZXQgcG9pbnRlcigpIHsKICAgIGxldCBzdHIgPSB0aGlzICsgJyc7CiAgICBsZXQgbmFtZTsKCiAgICBuYW1lID0gc3RyLnJlcGxhY2UoLyhcKiR8XChcKlwpKS8sICcnKTsKICAgIGlmKG5hbWUgPT0gc3RyKSByZXR1cm4gdW5kZWZpbmVkOwoKICAgIHJldHVybiBuYW1lOwogICAgLyoKICAgIGxldCBtYXRjaCA9IFV0aWwuaWYoL14oW15cKFwpXSopKFwoP1wqXCk/XHMqKShcKC4qXCkkfCkvZy5leGVjKHN0ciksCiAgICAgIChtKSA9PiBbLi4ubV0uc2xpY2UoMSksCiAgICAgICgpID0+IFtdCiAgICAgICk7CiAgIC8vIGNvbnNvbGUubG9nKCJUeXBlLmdldCBwb2ludGVyIix7c3RyLG1hdGNofSk7CiAgICBpZihtYXRjaFsxXSkgewogICAgIGxldCBuYW1lID0gW21hdGNoWzBdLnRyaW1FbmQoKSwgbWF0Y2hbMl1dLmpvaW4oJycpOwogICAgIGlmKC9eY29uc3QvLnRlc3QobmFtZSkgJiYgIVR5cGUuZGVjbGFyYXRpb25zLmhhcyhuYW1lKSkKICAgICAgbmFtZSA9IG5hbWUucmVwbGFjZSgnY29uc3QgJywgJycpOwogICAgcmV0dXJuIG5hbWU7CiAgfSovCn0KICBnZXRQb2ludGVyKGFzdCkgewogICAgY29uc3QgdGFyZ2V0ID0gdGhpcy5wb2ludGVyOwoKICAgIGlmKHRhcmdldCkgewogICAgICBsZXQgbm9kZSA9IGRlZXAuZmluZChhc3QsIG4gPT4gdHlwZW9mIG4gPT0gJ29iamVjdCcgJiYgbiAmJiBuLm5hbWUgPT0gdGFyZ2V0KTsKICAgICAgLy8gICBjb25zb2xlLmxvZygiZ2V0UG9pbnRlciIsbm9kZSk7CiAgICAgIGlmKG5vZGUpIHJldHVybiBUeXBlRmFjdG9yeShub2RlLCBhc3QpOwoKICAgICAgaWYoVHlwZS5kZWNsYXJhdGlvbnMuaGFzKHRhcmdldCkpIHJldHVybiBUeXBlLmRlY2xhcmF0aW9ucy5nZXQodGFyZ2V0KTsKICAgIH0KICB9CgogIC8qIHByZXR0aWVyLWlnbm9yZSAqLyBnZXQgdW5zaWduZWQoKSB7CiAgbGV0IHN0ciA9IHRoaXMgKyAnJzsKICByZXR1cm4gLyg/OnVuc2lnbmVkfHVzaG9ydHx1aW50fHVsb25nKS8udGVzdChzdHIpOwp9CgogIC8qIHByZXR0aWVyLWlnbm9yZSAqLyBnZXQgc2lnbmVkKCkgewogIHJldHVybiAvKD86XnxbXm5dKXNpZ25lZC8udGVzdCh0aGlzKycnKSB8fCAhdGhpcy51bnNpZ25lZDsKfQoKICBpc0NvbXBvdW5kKCkgewogICAgcmV0dXJuIC8oPzpzdHJ1Y3R8dW5pb24pXHMvLnRlc3QodGhpcyArICcnKTsKICB9CgogIGlzRmxvYXRpbmdQb2ludCgpIHsKICAgIHJldHVybiAvKD86XCB8XikoZmxvYXR8ZG91YmxlKSQvLnRlc3QodGhpcyArICcnKTsKICB9CgogIC8qIHByZXR0aWVyLWlnbm9yZSAqLyBnZXQgYWxpYXMoKSB7CiAgICBpZih0aGlzLnR5cGVBbGlhcykKICAgICAgcmV0dXJuIFR5cGUuZ2V0KHRoaXMudHlwZUFsaWFzKTsKICB9CgogIC8qIHByZXR0aWVyLWlnbm9yZSAqLyBnZXQgYWxpYXNlcygpIHsKICAgIGxldCB0eXBlID0gdGhpczsKICAgIGxldCBsaXN0ID0gW107CgogICAgd2hpbGUodHlwZSkgewogICAgICBsaXN0LnB1c2godHlwZSk7CiAgICAgIHR5cGUgPSB0eXBlLmFsaWFzOwogICAgfQogICAgcmV0dXJuIGxpc3Q7CiAgfQoKICBpc0VudW0oKSB7CiAgICBmb3IobGV0IGFsaWFzIG9mIHRoaXMuYWxpYXNlcykgaWYoL15lbnVtXHMvLnRlc3QoYWxpYXMgKyAnJykpIHJldHVybiB0cnVlOwogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgaXNTdHJpbmcoKSB7CiAgICBjb25zdCB7IGRlc3VnYXJlZCwgcXVhbFR5cGUgfSA9IHRoaXM7CiAgICByZXR1cm4gKAogICAgICAvXihjb25zdCB8KWNoYXIgXCokLy50ZXN0KGRlc3VnYXJlZCkgfHwKICAgICAgL14oY29uc3QgfCljaGFyIFwqJC8udGVzdChxdWFsVHlwZSkgfHwKICAgICAgL14oY29uc3QgfCljaGFyJC8udGVzdCh0aGlzLnBvaW50ZXIpCiAgICApOwogIH0KCiAgLyogcHJldHRpZXItaWdub3JlICovIGdldCBmZmkoKSB7CiAgICBjb25zdCB7ICBkZXN1Z2FyZWQsIHF1YWxUeXBlIH0gPSB0aGlzOwoKICAgIGxldCBzdHIgPSB0aGlzKycnOwogICAgaWYoc3RyLnN0YXJ0c1dpdGgoJ2NvbnN0ICcpKQogICAgICBzdHIgPSBzdHIuc3Vic3RyaW5nKDYpOwogICAgaWYoL15jaGFyXHMqXCokLy50ZXN0KHN0cil8fHRoaXMuaXNTdHJpbmcoKSkKICAgICAgIHJldHVybiAnY2hhciAqJzsKCiAgICBmb3IoY29uc3QgdHlwZSBvZiBbc3RyLCBkZXN1Z2FyZWRdKQogICAgICBpZihbInZvaWQiLCAic2ludDgiLCAic2ludDE2IiwgInNpbnQzMiIsICJzaW50NjQiLCAidWludDgiLCAidWludDE2IiwgInVpbnQzMiIsICJ1aW50NjQiLCAiZmxvYXQiLCAiZG91YmxlIiwgInNjaGFyIiwgInVjaGFyIiwgInNzaG9ydCIsICJ1c2hvcnQiLCAic2ludCIsICJ1aW50IiwgInNsb25nIiwgInVsb25nIiwgImxvbmdkb3VibGUiLCAicG9pbnRlciIsICJpbnQiLCAibG9uZyIsICJzaG9ydCIsICJjaGFyIiwgInNpemVfdCIsICJ1bnNpZ25lZCBjaGFyIiwgInVuc2lnbmVkIGludCIsICJ1bnNpZ25lZCBsb25nIiwgInZvaWQgKiIsICJjaGFyICoiLCAic3RyaW5nIl0uaW5kZXhPZih0eXBlKSAhPSAtMSkKICAgICAgICByZXR1cm4gdHlwZTsKY29uc3QgeyBzaXplLHVuc2lnbmVkIH0gPSB0aGlzOwoKICAgIGlmKHNpemUgPT0gU0laRU9GX1BPSU5URVIgJiYgIXRoaXMuaXNQb2ludGVyKCkpCiAgICAgIHJldHVybiBbJycsICd1bnNpZ25lZCAnXVt1bnNpZ25lZCB8IDBdICsgJ2xvbmcnOwogICAgLy8gaWYoc2l6ZSA9PSBTSVpFT0ZfUE9JTlRFUiAmJiB1bnNpZ25lZCkgcmV0dXJuICdzaXplX3QnOwogICAgaWYoc2l6ZSA9PSBTSVpFT0ZfUE9JTlRFUiAvIDIgJiYgIXVuc2lnbmVkKSByZXR1cm4gJ2ludCc7CiAgICBpZihzaXplID09IDQpIHJldHVybiBbJ3MnLCAndSddW3Vuc2lnbmVkIHwgMF0gKyAnaW50MzInOwogICAgaWYoc2l6ZSA9PSAyKSByZXR1cm4gWydzJywgJ3UnXVt1bnNpZ25lZCB8IDBdICsgJ2ludDE2JzsKICAgIGlmKHNpemUgPT0gMSkgcmV0dXJuIFsncycsICd1J11bdW5zaWduZWQgfCAwXSArICdpbnQ4JzsKCiAgICBpZih0aGlzLmlzUG9pbnRlcigpKSByZXR1cm4gJ3ZvaWQgKic7CiAgICBpZihzaXplID4gU0laRU9GX1BPSU5URVIpIHJldHVybiAndm9pZCAqJzsKICAgIGlmKHNpemUgPT09IDApIHJldHVybiAndm9pZCc7CgogICAgc3RyPz89IHRoaXMrJyc7CgogICAgaWYoVHlwZS5kZWNsYXJhdGlvbnMuaGFzKHN0cikpIHsKICAgICAgbGV0IGRlY2wgPSBUeXBlLmRlY2xhcmF0aW9ucy5nZXQoc3RyKTsKICAgICAgaWYoZGVjbC5raW5kID09ICdFbnVtRGVjbCcpIHJldHVybiAnaW50JzsKICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gZmZpIHR5cGUgJyR7c3RyfScgJHtzaXplfSAke1V0aWwuY2xhc3NOYW1lKHRoaXMpfSAke3RoaXMuYXN0LmtpbmR9YCk7CiAgICB9CiAgfQoKICAvKiBwcmV0dGllci1pZ25vcmUgKi8gZ2V0IHNpemUoKSB7CiAgICBpZih0aGlzLmlzUG9pbnRlcigpKSByZXR1cm4gU0laRU9GX1BPSU5URVI7CiAgICBpZih0aGlzLmlzRW51bSgpKSByZXR1cm4gU0laRU9GX0lOVDsKICAgIGlmKHRoaXMuaXNDb21wb3VuZCgpKSB7CiAgICAgIGxldCBub2RlOwogICAgIGlmKChub2RlPSBUeXBlLmdldCh0aGlzKycnKSkgJiYgIG5vZGUgIT09IHRoaXMpCiAgICAgICByZXR1cm4gbm9kZS5zaXplOwogICAgfQogICAgICAgICAgY29uc3QgIGRlc3VnYXJlZCA9IHRoaXMuZGVzdWdhcmVkIHx8IHRoaXMrJycgfHwgdGhpcy5uYW1lOwogICAgaWYoZGVzdWdhcmVkID09ICdjaGFyJykgcmV0dXJuIDE7CiAgICBjb25zdCByZSA9IC8oPzpefFxzKV8qdT9pbnQoWzAtOV0rKShfdHwpJC87CiAgICBsZXQgc2l6ZSwgbWF0Y2g7CiAgICAgIGlmKHRoaXMuaXNBcnJheSgpKSB7CiBzaXplICA/Pz0gdGhpcy5hcnJheU9mKCk/LnNpemU7CiAgICAgICAgZm9yKGxldCBbaW5kZXgsc3Vic2NyaXB0XSBvZiB0aGlzLnN1YnNjcmlwdHMpCiAgICAgICAgICBzaXplICo9IHN1YnNjcmlwdDsKICAgICAgfQogICAgICAKICAgIGlmKChtYXRjaCA9IHJlLmV4ZWMoZGVzdWdhcmVkKSkpIHsKICAgICAgY29uc3QgWywgYml0c10gPSBtYXRjaDsKICAgICAgaWYoIWlzTmFOKCtiaXRzKSkgcmV0dXJuICtiaXRzIC8gODsKICAgIH0KICAgIGlmKChtYXRjaCA9IC9eW15cKF0qXCgoW15cKV0qKVwpLiovLmV4ZWMoZGVzdWdhcmVkKSkpIHsKICAgICAgaWYobWF0Y2hbMV0gPT0gJyonKSByZXR1cm4gU0laRU9GX1BPSU5URVI7CiAgICB9CiAgICBtYXRjaCA9IC9eKHVuc2lnbmVkXHMrfHNpZ25lZFxzK3xjb25zdFxzK3x2b2xhdGlsZVxzK3xsb25nXHMrfHNob3J0XHMrKSooW15cW10qW14gXFtcXV0pICpcWz8oW15cXV0qKS4qJC9nLmV4ZWMoZGVzdWdhcmVkCiAgICAgICk7CiAgLyogIGNvbnNvbGUubG9nKCJhc3Q6IiwgdGhpcy5hc3QpOwogICAgY29uc29sZS5sb2coInN0cjoiLCB0aGlzKycnKTsKICAgIGNvbnNvbGUubG9nKCJxdWFsVHlwZToiLCB0aGlzLnF1YWxUeXBlKTsKICAgIGNvbnNvbGUubG9nKCJtYXRjaDoiLCBtYXRjaCk7Ki8KICAgIGlmKG1hdGNoKSB7CiAgICAgIHN3aXRjaCAobWF0Y2hbMl0pIHsKICAgICAgICBjYXNlICdjaGFyJzogCiAgICAgICAgc2l6ZSA9IDE7CiAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnaW50OF90JzoKICAgICAgICBjYXNlICd1aW50OF90JzoKICAgICAgICBjYXNlICdib29sJzogCiAgICAgICAgc2l6ZSA9IDE7CiAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnc2l6ZV90JzoKICAgICAgICBjYXNlICdwdHJkaWZmX3QnOgogICAgICAgIGNhc2UgJ3ZvaWQgKic6CiAgICAgICAgY2FzZSAnbG9uZyc6IAogICAgICAgIHNpemUgPSBTSVpFT0ZfUE9JTlRFUjsKICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdpbnQxNl90JzoKICAgICAgICBjYXNlICd1aW50MTZfdCc6CiAgICAgICAgY2FzZSAnc2hvcnQnOiAKICAgICAgICBzaXplID0gMjsKICAgICAgICBicmVhazsgICAKICAgICAgICBjYXNlICdpbnQzMl90JzogCiAgICAgICAgY2FzZSAndWludDMyX3QnOiAgICAgICAgCiAgICAgICAgY2FzZSAndW5zaWduZWQgaW50JzoKICAgICAgICBjYXNlICdpbnQnOiAKICAgICAgICBzaXplID0gNDsKICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdsb25nIGRvdWJsZSc6IAogICAgICAgIHNpemUgPSAxNjsKICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdpbnQ2NF90JzogCiAgICAgICAgY2FzZSAndWludDY0X3QnOiAKICAgICAgICBjYXNlICdsb25nIGxvbmcnOiAKICAgICAgICBzaXplID0gODsKICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdmbG9hdCc6IAogICAgICAgIHNpemUgPSA0OwogICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ2RvdWJsZSc6IAogICAgICAgIHNpemUgPSA4OwogICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ3ZvaWQnOiAKICAgICAgICBzaXplID0gMDsKICAgICAgICBicmVhazsKCiAgICAgIH0KICAgICAgaWYoc2l6ZSA9PT0gdW5kZWZpbmVkICYmIG1hdGNoWzJdLmVuZHNXaXRoKCcqJykpIHNpemUgPSBTSVpFT0ZfUE9JTlRFUjsKICAgICAgaWYoc2l6ZSA9PT0gdW5kZWZpbmVkICYmICh0aGlzLnF1YWxUeXBlIHx8ICcnKS5zdGFydHNXaXRoKCdlbnVtICcpKSBzaXplID0gNDsKCiAgICB9CiAgICBpZihzaXplID09PSB1bmRlZmluZWQpIHsKICAgICAgLy8gdGhyb3cgbmV3IEVycm9yKGBUeXBlIHNpemVvZigke2Rlc3VnYXJlZH0pICR7dGhpcy5kZXN1Z2FyZWRRdWFsVHlwZX1gKTsKICAgICAgc2l6ZSA9IE5hTjsKICAgIH0KICAgIHJldHVybiBzaXplOwogIH0KCiAgLyogW1N5bWJvbC5mb3IoIm5vZGVqcy51dGlsLmluc3BlY3QuY3VzdG9tIildKGRlcHRoLCBvcHRzID0ge30pIHsKICAgIGNvbnN0IHRleHQgPSBvcHRzLmNvbG9ycyA/ICh0LCAuLi5jKSA9PiAnXHgxYlsnICsgYy5qb2luKCc7JykgKyAnbScgKyB0ICsgJ1x4MWJbbScgOiB0ID0+IHQ7CiAgICBjb25zdCB7IG5hbWUsIHNpemUgfSA9IHRoaXM7CiAgICBsZXQgcHJvcHMgPSB7Li4udGhpc30gPz8gT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXModGhpcykucmVkdWNlKChhY2MsbmFtZSkgPT4gKHsuLi5hY2MsIFtuYW1lXTogdGhpc1tuYW1lXSB9KSwge30pOwogICAgaWYoc2l6ZSkgcHJvcHMuc2l6ZSA9IHNpemU7CiAgICByZXR1cm4gKHRleHQodGhpcy5jb25zdHJ1Y3Rvcj8ubmFtZSA/PyBVdGlsLmNsYXNzTmFtZSh0aGlzKSwgMSwgMzEpICsKICAgICAgJyAnICsKICAgICAgaW5zcGVjdChwcm9wcywgZGVwdGgsIHsgLi4ub3B0cywgY29tcGFjdDogZmFsc2UsIGN1c3RvbUluc3BlY3Q6IHRydWUsIG51bWJlckJhc2U6IDE2IH0pCiAgICApOwogIH0qLwogIHRvSlMoKSB7CiAgICBpZih0aGlzLmlzU3RyaW5nKCkpIHJldHVybiAnU3RyaW5nJzsKICAgIHJldHVybiAnTnVtYmVyJzsKICB9CgogIFtTeW1ib2wudG9QcmltaXRpdmVdKGhpbnQpIHsKICAgIGlmKGhpbnQgPT0gJ2RlZmF1bHQnIHx8IGhpbnQgPT0gJ3N0cmluZycpCiAgICAgIHJldHVybiAodGhpcy5xdWFsVHlwZSA/PyB0aGlzLmRlc3VnYXJlZFF1YWxUeXBlID8/IHRoaXM/LmFzdD8ubmFtZSA/PyAnJykucmVwbGFjZSgvXHMrKFwqKykkLywgJyQxJyk7IC8vdGhpcysnJzsKICAgIHJldHVybiB0aGlzOwogIH0KCiAgdG9KU09OKG9iaikgewogICAgY29uc3QgeyBxdWFsVHlwZSwgc2l6ZSB9ID0gdGhpczsKICAgIHJldHVybiBzdXBlci50b0pTT04oeyAuLi5vYmosIHF1YWxUeXBlLCBzaXplIH0pOwogIH0KCiAgc3RhdGljIGdldChuYW1lX29yX2lkLCBhc3QgPSAkLmRhdGEpIHsKICAgIGxldCB0eXBlOwogICAgLy8gaWYodHlwZW9mIG5hbWVfb3JfaWQgPT0gJ3N0cmluZycgJiYgKHR5cGUgPSBUeXBlLmRlY2xhcmF0aW9ucy5nZXQobmFtZV9vcl9pZCkpKSByZXR1cm4gdHlwZTsKICAgIGxldCBub2RlID0KICAgICAgYXN0LmlubmVyLmZpbmQoCiAgICAgICAgdHlwZW9mIG5hbWVfb3JfaWQgPT0gJ251bWJlcicKICAgICAgICAgID8gbm9kZSA9PiAvKD86RGVjbHxUeXBlKS8udGVzdChub2RlLmtpbmQpICYmICtub2RlLmlkID09IG5hbWVfb3JfaWQKICAgICAgICAgIDogbm9kZSA9PiAvKD86RGVjbHxUeXBlKS8udGVzdChub2RlLmtpbmQpICYmIG5vZGUubmFtZSA9PSBuYW1lX29yX2lkCiAgICAgICkgPz8gR2V0VHlwZShuYW1lX29yX2lkLCBhc3QpOwogICAgaWYobm9kZSkgewogICAgICBpZihub2RlLnR5cGUpIHR5cGUgPSBnZXRUeXBlRnJvbU5vZGUobm9kZSwgYXN0KTsKICAgICAgZWxzZSB0eXBlID0gVHlwZUZhY3Rvcnkobm9kZSwgYXN0KTsKICAgICAgaWYobm9kZS5uYW1lICYmIHR5cGVvZiBuYW1lX29yX2lkICE9ICdzdHJpbmcnKSBuYW1lX29yX2lkID0gbm9kZS5uYW1lOwogICAgfQogICAgaWYodHlwZW9mIG5hbWVfb3JfaWQgPT0gJ3N0cmluZycgJiYgIVR5cGUuZGVjbGFyYXRpb25zLmhhcyhuYW1lX29yX2lkKSkgVHlwZS5kZWNsYXJhdGlvbnMuc2V0KG5hbWVfb3JfaWQsIHR5cGUpOwogICAgcmV0dXJuIHR5cGU7CiAgfQp9CgpUeXBlLmRlY2xhcmF0aW9ucy5zZXQoJ3ZvaWQnLCBuZXcgVHlwZSh7IHF1YWxUeXBlOiAndm9pZCcgfSkpOwpUeXBlLmRlY2xhcmF0aW9ucy5zZXQoJ2NoYXInLCBuZXcgVHlwZSh7IHF1YWxUeXBlOiAnY2hhcicgfSkpOwpUeXBlLmRlY2xhcmF0aW9ucy5zZXQoJ2ludCcsIG5ldyBUeXBlKHsgcXVhbFR5cGU6ICdpbnQnIH0pKTsKVHlwZS5kZWNsYXJhdGlvbnMuc2V0KCdzaG9ydCcsIG5ldyBUeXBlKHsgcXVhbFR5cGU6ICdzaG9ydCcgfSkpOwpUeXBlLmRlY2xhcmF0aW9ucy5zZXQoJ2xvbmcnLCBuZXcgVHlwZSh7IHF1YWxUeXBlOiAnbG9uZycgfSkpOwpUeXBlLmRlY2xhcmF0aW9ucy5zZXQoJ2xvbmcgbG9uZycsIG5ldyBUeXBlKHsgcXVhbFR5cGU6ICdsb25nIGxvbmcnIH0pKTsKVHlwZS5kZWNsYXJhdGlvbnMuc2V0KCdfX2ludDEyOCcsIG5ldyBUeXBlKHsgcXVhbFR5cGU6ICdfX2ludDEyOCcgfSkpOwpUeXBlLmRlY2xhcmF0aW9ucy5zZXQoJ3Vuc2lnbmVkIGNoYXInLCBuZXcgVHlwZSh7IHF1YWxUeXBlOiAndW5zaWduZWQgY2hhcicgfSkpOwpUeXBlLmRlY2xhcmF0aW9ucy5zZXQoJ3Vuc2lnbmVkIGludCcsIG5ldyBUeXBlKHsgcXVhbFR5cGU6ICd1bnNpZ25lZCBpbnQnIH0pKTsKVHlwZS5kZWNsYXJhdGlvbnMuc2V0KCd1bnNpZ25lZCBzaG9ydCcsIG5ldyBUeXBlKHsgcXVhbFR5cGU6ICd1bnNpZ25lZCBzaG9ydCcgfSkpOwpUeXBlLmRlY2xhcmF0aW9ucy5zZXQoJ3Vuc2lnbmVkIGxvbmcnLCBuZXcgVHlwZSh7IHF1YWxUeXBlOiAndW5zaWduZWQgbG9uZycgfSkpOwpUeXBlLmRlY2xhcmF0aW9ucy5zZXQoJ3Vuc2lnbmVkIGxvbmcgbG9uZycsIG5ldyBUeXBlKHsgcXVhbFR5cGU6ICd1bnNpZ25lZCBsb25nIGxvbmcnIH0pKTsKVHlwZS5kZWNsYXJhdGlvbnMuc2V0KCd1bnNpZ25lZCBfX2ludDEyOCcsIG5ldyBUeXBlKHsgcXVhbFR5cGU6ICd1bnNpZ25lZCBfX2ludDEyOCcgfSkpOwpUeXBlLmRlY2xhcmF0aW9ucy5zZXQoJ2Zsb2F0JywgbmV3IFR5cGUoeyBxdWFsVHlwZTogJ2Zsb2F0JyB9KSk7ClR5cGUuZGVjbGFyYXRpb25zLnNldCgnZG91YmxlJywgbmV3IFR5cGUoeyBxdWFsVHlwZTogJ2RvdWJsZScgfSkpOwpUeXBlLmRlY2xhcmF0aW9ucy5zZXQoJ3ZvaWQgKicsIG5ldyBUeXBlKHsgcXVhbFR5cGU6ICd2b2lkIConIH0pKTsKVHlwZS5kZWNsYXJhdGlvbnMuc2V0KCdjaGFyIConLCBuZXcgVHlwZSh7IHF1YWxUeXBlOiAnY2hhciAqJyB9KSk7ClR5cGUuZGVjbGFyYXRpb25zLnNldCgnY29uc3QgY2hhciAqJywgbmV3IFR5cGUoeyBxdWFsVHlwZTogJ2NvbnN0IGNoYXIgKicgfSkpOwpUeXBlLmRlY2xhcmF0aW9ucy5zZXQoJ2Jvb2wnLCBuZXcgVHlwZSh7IHF1YWxUeXBlOiAnYm9vbCcgfSkpOwoKZnVuY3Rpb24gUm91bmRUbyh2YWx1ZSwgYWxpZ24pIHsKICByZXR1cm4gTWF0aC5mbG9vcigodmFsdWUgKyAoYWxpZ24gLSAxKSkgLyBhbGlnbikgKiBhbGlnbjsKfQoKZXhwb3J0IGNsYXNzIFJlY29yZERlY2wgZXh0ZW5kcyBUeXBlIHsKICBjb25zdHJ1Y3Rvcihub2RlLCBhc3QpIHsKICAgIHN1cGVyKG5vZGUsIGFzdCk7CiAgICBjb25zdCB7IGlkLCB0YWdVc2VkLCBuYW1lLCBpbm5lciB9ID0gbm9kZTsKICAgIGlmKG5hbWUgJiYgbmFtZSAhPSAnc3RydWN0JykgdGhpcy5uYW1lID0gbmFtZTsKICAgIHRoaXMubmFtZSA/Pz0gTmFtZUZvcihub2RlLCBhc3QpOwogICAgaWYoaW5uZXI/LmZpbmQoY2hpbGQgPT4gY2hpbGQua2luZCA9PSAnUGFja2VkQXR0cicpKSB0aGlzLnBhY2tlZCA9IHRydWU7CiAgICBsZXQgZmllbGRzID0gaW5uZXI/LmZpbHRlcihjaGlsZCA9PiBjaGlsZC5raW5kLmVuZHNXaXRoKCdEZWNsJykpOwoKICAgIC8vY29uc29sZS5sb2coJ1JlY29yZERlY2wuZmllbGRzJywgZmllbGRzKTsKCiAgICBpZih0YWdVc2VkKSB0aGlzLnRhZyA9IHRhZ1VzZWQ7CgogICAgaWYoZmllbGRzKSB7CiAgICAgIHRoaXMubWVtYmVycyA9IGZpZWxkcwogICAgICAgIC5maWx0ZXIobm9kZSA9PiAhKCdwYXJlbnREZWNsQ29udGV4dElkJyBpbiBub2RlKSkKICAgICAgICAucmVkdWNlKChhY2MsIG5vZGUpID0+IHsKICAgICAgICAgIGxldCB7IG5hbWUsIGtpbmQgfSA9IG5vZGU7CiAgICAgICAgICBsZXQgdHlwZTsKICAgICAgICAgIGlmKG5vZGUuaXNCaXRmaWVsZCkgewogICAgICAgICAgICBuYW1lICs9ICc6JyArIG5vZGUuaW5uZXJbMF0uaW5uZXJbMF0udmFsdWU7CiAgICAgICAgICB9CiAgICAgICAgICBpZihraW5kLmVuZHNXaXRoKCdEZWNsJykpIHsKICAgICAgICAgICAgaWYobm9kZS5raW5kLnN0YXJ0c1dpdGgoJ0luZGlyZWN0JykpIHsKICAgICAgICAgICAgICB0eXBlID0gbnVsbDsKICAgICAgICAgICAgfSBlbHNlIGlmKG5vZGU/LnR5cGU/LnF1YWxUeXBlICYmIC8oIGF0ICkvLnRlc3Qobm9kZS50eXBlLnF1YWxUeXBlKSkgewogICAgICAgICAgICAgIGxldCBsb2MgPSBub2RlLnR5cGUucXVhbFR5cGUuc3BsaXQoLyg/OlxzKlsoKV18IGF0ICkvZylbMl07CiAgICAgICAgICAgICAgbGV0IFtmaWxlLCBsaW5lLCBjb2x1bW5dID0gbG9jLnNwbGl0KC86L2cpLm1hcChpID0+ICghaXNOYU4oK2kpID8gK2kgOiBpKSk7CgogICAgICAgICAgICAgIGxldCB0eXBlUGF0aHMgPSBkZWVwLnNlbGVjdChpbm5lciwgbiA9PiBuLmxpbmUgPT0gbGluZSwgZGVlcC5SRVRVUk5fUEFUSCk7CiAgICAgICAgICAgICAgbGV0IHR5cGVQYXRoID0gUGF0aFJlbW92ZUxvYyh0eXBlUGF0aHNbMF0pOwogICAgICAgICAgICAgIGxldCB0eXBlTm9kZSA9IGRlZXAuZ2V0KGlubmVyLCB0eXBlUGF0aCk7CiAgICAgICAgICAgICAgdHlwZSA9IFR5cGVGYWN0b3J5KHR5cGVOb2RlLCBhc3QpOwogICAgICAgICAgICB9IGVsc2UgaWYobm9kZS5raW5kLnN0YXJ0c1dpdGgoJ0NYWCcpKSB7CiAgICAgICAgICAgICAgdHlwZSA9IFR5cGVGYWN0b3J5KG5vZGUsIGFzdCk7CiAgICAgICAgICAgIH0gZWxzZSBpZihub2RlLnR5cGUpIHsKICAgICAgICAgICAgICB0eXBlID0gbmV3IFR5cGUobm9kZS50eXBlLCBhc3QpOwogICAgICAgICAgICAgIGlmKHR5cGUuZGVzdWdhcmVkICYmIHR5cGUuZGVzdWdhcmVkLnN0YXJ0c1dpdGgoJ3N0cnVjdCAnKSkgewogICAgICAgICAgICAgICAgbGV0IHRtcCA9IGFzdC5pbm5lci5maW5kKG4gPT4gbi5raW5kID09ICdSZWNvcmREZWNsJyAmJiBuLm5hbWUgPT0gL15zdHJ1Y3QuLy50ZXN0KG4ubmFtZSkpOwogICAgICAgICAgICAgICAgaWYodG1wKSB0eXBlID0gVHlwZUZhY3RvcnkodG1wLnZhbHVlLCBhc3QpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIGlmKG5vZGUua2luZC5zdGFydHNXaXRoKCdSZWNvcmQnKSkgewogICAgICAgICAgICAgIHR5cGUgPSBuZXcgUmVjb3JkRGVjbChub2RlLCBhc3QpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgbm9kZS5raW5kPSR7bm9kZS5raW5kfSBgKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaWYodHlwZSkgYWNjLnB1c2goW25hbWUsIHR5cGVdKTsKICAgICAgICAgIGVsc2UgaWYobmFtZSkgYWNjLnB1c2goW25hbWUsIG5vZGUua2luZC5zdGFydHNXaXRoKCdJbmRpcmVjdCcpID8gbnVsbCA6IFR5cGVGYWN0b3J5KG5vZGUsIGFzdCldKTsKICAgICAgICAgIHJldHVybiBhY2M7CiAgICAgICAgfSwgW10pOwogICAgfQogIH0KCiAgLyogcHJldHRpZXItaWdub3JlICovIGdldCBzaXplKCkgewogICAgbGV0IHsgbWVtYmVycyA9IFtdIH0gPSB0aGlzOwogICAgcmV0dXJuIFJvdW5kVG8oWy4uLm1lbWJlcnNdLnJlZHVjZSgoYWNjLFtuYW1lLHR5cGVdKSA9PiB7CiAgICAgIGlmKE51bWJlci5pc0Zpbml0ZSh0eXBlPy5zaXplKSkgewogICAgICAgICAgICBpZih0eXBlLnNpemUgPT0gOCkKICAgICAgICBhY2MgPSBSb3VuZFRvKGFjYywgOCk7CiAgICAgIHJldHVybiBhY2MgKyBSb3VuZFRvKHR5cGUuc2l6ZSw0KTsKICAgIH0KICAgIHJldHVybiBhY2M7CiAgICB9LCAwKSwgU0laRU9GX1BPSU5URVIpOwogIH0KCiAgdG9KU09OKCkgewogICAgY29uc3QgeyBuYW1lLCBzaXplLCBtZW1iZXJzIH0gPSB0aGlzOwogICAgcmV0dXJuIHN1cGVyLnRvSlNPTih7CiAgICAgIG5hbWUsCiAgICAgIHNpemUsCiAgICAgIG1lbWJlcnM6IG1lbWJlcnMubWFwKChbbmFtZSwgbWVtYmVyXSkgPT4gW25hbWUsIG1lbWJlciAhPSBudWxsICYmIG1lbWJlci50b0pTT04gPyBtZW1iZXIudG9KU09OKCkgOiBtZW1iZXJdKQogICAgfSk7CiAgfQp9CgpleHBvcnQgY2xhc3MgRW51bURlY2wgZXh0ZW5kcyBUeXBlIHsKICBjb25zdHJ1Y3Rvcihub2RlLCBhc3QpIHsKICAgIHN1cGVyKG5vZGUsIGFzdCk7CgogICAgaWYobm9kZS5uYW1lKSB0aGlzLm5hbWUgPSBgZW51bSAke25vZGUubmFtZX1gOwoKICAgIGxldCBjb25zdGFudHMgPSBub2RlLmlubmVyLmZpbHRlcihjaGlsZCA9PiBjaGlsZC5raW5kID09ICdFbnVtQ29uc3RhbnREZWNsJyk7CiAgICBsZXQgbnVtYmVyID0gMTsKCiAgICB0aGlzLm1lbWJlcnMgPSBuZXcgTWFwKAogICAgICBjb25zdGFudHMubWFwKCh7IG5hbWUsIHR5cGUsIGlubmVyIH0pID0+IHsKICAgICAgICBsZXQgdmFsdWUgPSBpbm5lciA/IFByaW50Tm9kZShpbm5lclswXSkgOiBudW1iZXI7CiAgICAgICAgaWYoIWlzTmFOKCt2YWx1ZSkpIHZhbHVlID0gK3ZhbHVlOwogICAgICAgIG51bWJlciA9IHR5cGVvZiB2YWx1ZSA9PSAnc3RyaW5nJyA/IGAke3ZhbHVlfSArIDFgIDogdmFsdWUgKyAxOwogICAgICAgIHJldHVybiBbbmFtZSwgW25ldyBUeXBlKHR5cGUsIGFzdCksIHZhbHVlXV07CiAgICAgIH0pCiAgICApOwogIH0KICB0b0pTT04oKSB7CiAgICBjb25zdCB7IG5hbWUsIHNpemUsIG1lbWJlcnMgfSA9IHRoaXM7CiAgICByZXR1cm4gc3VwZXIudG9KU09OKHsgbmFtZSwgc2l6ZSwgbWVtYmVycyB9KTsKICB9Cn0KCmV4cG9ydCBjbGFzcyBUeXBlZGVmRGVjbCBleHRlbmRzIFR5cGUgewogIGNvbnN0cnVjdG9yKG5vZGUsIGFzdCkgewogICAgc3VwZXIobm9kZSwgYXN0KTsKCiAgICBsZXQgaW5uZXIgPSAobm9kZS5pbm5lciA/PyBbXSkuZmlsdGVyKG4gPT4gIS9Db21tZW50Ly50ZXN0KG4ua2luZCkpOwogICAgbGV0IHR5cGU7CgogICAgbGV0IHsgdHlwZUFsaWFzIH0gPSBub2RlOwoKICAgIGxldCB0eXBlSWQgPSBkZWVwLmZpbmQoaW5uZXIsICh2LCBrKSA9PiBrID09ICdkZWNsJyk/LmlkOwoKICAgIGlmKHR5cGVBbGlhcykgdHlwZSA9IGFzdC5pbm5lci5maW5kKG4gPT4gbi5pZCA9PSB0eXBlQWxpYXMpOwogICAgZWxzZSBpZih0eXBlSWQpIHR5cGUgPSBhc3QuaW5uZXIuZmluZChuID0+IG4uaWQgPT0gdHlwZUlkKTsKICAgIGVsc2UgdHlwZSA9IG5vZGUuaW5uZXIuZmluZChuID0+IC9UeXBlLy50ZXN0KG4ua2luZCkpOwoKICAgIC8vdHlwZSA/Pz0gR2V0VHlwZShub2RlLCBhc3QpOwogICAgYXNzZXJ0KGlubmVyLmxlbmd0aCwgMSk7CiAgICAvLyBjb25zb2xlLmxvZygnVHlwZWRlZkRlY2wuY29uc3RydWN0b3InLCB7IG5vZGUsIHR5cGVJZCwgdHlwZSB9KTsKCiAgICBpZih0eXBlPy5kZWNsKSB0eXBlID0gdHlwZS5kZWNsOwogICAgaWYodHlwZT8ua2luZCAmJiB0eXBlLmtpbmQuZW5kc1dpdGgoJ1R5cGUnKSkgdHlwZSA9IHR5cGUudHlwZTsKCiAgICB0aGlzLm5hbWUgPSBub2RlLm5hbWU7CiAgICB0aGlzLnR5cGUgPSB0eXBlLmtpbmQgPyBUeXBlRmFjdG9yeSh0eXBlLCBhc3QsIGZhbHNlKSA6IG5ldyBUeXBlKHR5cGUsIGFzdCk7CiAgICAvL2NvbnNvbGUubG9nKCdUeXBlZGVmRGVjbC5jb25zdHJ1Y3RvcicsICAgICB0aGlzLnR5cGUpOwogIH0KCiAgLyogcHJldHRpZXItaWdub3JlICovIGdldCBzaXplKCkgewogICAgcmV0dXJuIHRoaXMudHlwZT8uc2l6ZTsKICB9CgogIHRvSlNPTigpIHsKICAgIGNvbnN0IHsgbmFtZSwgc2l6ZSB9ID0gdGhpczsKICAgIHJldHVybiBzdXBlci50b0pTT04oeyBuYW1lLCBzaXplIH0pOwogIH0KfQoKZXhwb3J0IGNsYXNzIEZpZWxkRGVjbCBleHRlbmRzIE5vZGUgewogIGNvbnN0cnVjdG9yKG5vZGUsIGFzdCkgewogICAgc3VwZXIobm9kZSwgYXN0KTsKICAgIC8vY29uc29sZS5sb2coJ0ZpZWxkRGVjbCcsIG5vZGUpOwoKICAgIGxldCBpbm5lciA9IChub2RlLmlubmVyID8/IFtdKS5maWx0ZXIobiA9PiAhL0NvbW1lbnQvLnRlc3Qobi5raW5kKSk7CiAgICBsZXQgdHlwZSA9IEdldFR5cGUobm9kZSwgYXN0KTsKCiAgICBhc3NlcnQoaW5uZXIubGVuZ3RoLCAxKTsKCiAgICBpZih0eXBlLmRlY2wpIHR5cGUgPSB0eXBlLmRlY2w7CiAgICBpZih0eXBlLmtpbmQgJiYgdHlwZS5raW5kLmVuZHNXaXRoKCdUeXBlJykpIHR5cGUgPSB0eXBlLnR5cGU7CgogICAgaWYobm9kZS5pc0JpdGZpZWxkKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcihgaXNCaXRmaWVsZCAke25vZGUua2luZH1gKTsKICAgIH0KCiAgICB0aGlzLm5hbWUgPSBub2RlLm5hbWU7CiAgICB0aGlzLnR5cGUgPSB0eXBlLmtpbmQgPyBUeXBlRmFjdG9yeSh0eXBlLCBhc3QpIDogbmV3IFR5cGUodHlwZSwgYXN0KTsKICB9Cn0KCmV4cG9ydCBjbGFzcyBGdW5jdGlvbkRlY2wgZXh0ZW5kcyBOb2RlIHsKICBjb25zdHJ1Y3Rvcihub2RlLCBhc3QpIHsKICAgIHN1cGVyKG5vZGUsIGFzdCk7CgogICAgdGhpcy5uYW1lID0gbm9kZS5uYW1lOwoKICAgIGlmKG5vZGUubWFuZ2xlZE5hbWUgJiYgbm9kZS5tYW5nbGVkTmFtZSAhPSBub2RlLm5hbWUpIHRoaXMubWFuZ2xlZE5hbWUgPSBub2RlLm1hbmdsZWROYW1lOwoKICAgIGxldCBwYXJhbWV0ZXJzID0gbm9kZS5pbm5lcj8uZmlsdGVyKGNoaWxkID0+IGNoaWxkLmtpbmQgPT0gJ1Bhcm1WYXJEZWNsJyk7CiAgICBsZXQgYm9keSA9IG5vZGUuaW5uZXI/LmZpbmQoY2hpbGQgPT4gY2hpbGQua2luZCAhPSAnUGFybVZhckRlY2wnKTsKICAgIGxldCB0eXBlID0gbm9kZS50eXBlPy5xdWFsVHlwZTsKICAgIGxldCByZXR1cm5UeXBlID0gdHlwZS5yZXBsYWNlKC9ccz9cKC4qLywgJycpOwoKICAgIC8vIGNvbnNvbGUubG9nKCdhc3Q6JywgYXN0KTsKCiAgICBsZXQgdG1wID0gZGVlcC5maW5kKGFzdCA/PyAkLmRhdGEsIG4gPT4gdHlwZW9mIG4gPT0gJ29iamVjdCcgJiYgbiAmJiBuLm5hbWUgPT0gcmV0dXJuVHlwZSwgZGVlcC5SRVRVUk5fVkFMVUUpOwoKICAgIGlmKHRtcCkgcmV0dXJuVHlwZSA9IHRtcDsKCiAgY29uc29sZS5sb2coJ0Z1bmN0aW9uRGVjbCcsIHsgdHlwZSwgcmV0dXJuVHlwZSx0bXAgfSk7CgogICAgdGhpcy5yZXR1cm5UeXBlID0gcmV0dXJuVHlwZS5raW5kID8gVHlwZUZhY3RvcnkocmV0dXJuVHlwZSwgYXN0KSA6IG5ldyBUeXBlKHJldHVyblR5cGUsIGFzdCk7CiAgICB0aGlzLnBhcmFtZXRlcnMgPSBwYXJhbWV0ZXJzICYmIC8qbmV3IE1hcCovIHBhcmFtZXRlcnMubWFwKCh7IG5hbWUsIHR5cGUgfSkgPT4gW25hbWUsIG5ldyBUeXBlKHR5cGUsIGFzdCldKTsKCiAgICB0aGlzLmJvZHkgPSBib2R5OwogIH0KCiAgdG9KU09OKCkgewogICAgY29uc3QgeyBuYW1lLCBwYXJhbWV0ZXJzIH0gPSB0aGlzOwogICAgcmV0dXJuIHN1cGVyLnRvSlNPTih7IG5hbWUsIHBhcmFtZXRlcnMgfSk7CiAgfQp9CgpleHBvcnQgY2xhc3MgVmFyRGVjbCBleHRlbmRzIE5vZGUgewogIGNvbnN0cnVjdG9yKG5vZGUsIGFzdCkgewogICAgc3VwZXIobm9kZSwgYXN0KTsKCiAgICB0aGlzLm5hbWUgPSBub2RlLm5hbWU7CgogICAgaWYobm9kZS5tYW5nbGVkTmFtZSAmJiBub2RlLm1hbmdsZWROYW1lICE9IG5vZGUubmFtZSkgdGhpcy5tYW5nbGVkTmFtZSA9IG5vZGUubWFuZ2xlZE5hbWU7CgogICAgbGV0IHR5cGUgPSBub2RlLnR5cGU/LnF1YWxUeXBlOwogICAgLy9jb25zb2xlLmxvZygnVmFyRGVjbCcsIHsgdHlwZSB9KTsKCiAgICB0aGlzLnR5cGUgPSB0eXBlLmtpbmQgPyBUeXBlRmFjdG9yeSh0eXBlLCBhc3QpIDogbmV3IFR5cGUodHlwZSwgYXN0KTsKCiAgICAvL2NvbnNvbGUubG9nKCdWYXJEZWNsJywgdGhpcyk7CiAgfQoKICB0b0pTT04oKSB7CiAgICBjb25zdCB7IG5hbWUsIHR5cGUgfSA9IHRoaXM7CiAgICByZXR1cm4gc3VwZXIudG9KU09OKHsgbmFtZSwgdHlwZSB9KTsKICB9Cn0KCmV4cG9ydCBjbGFzcyBDbGFzc0RlY2wgZXh0ZW5kcyBSZWNvcmREZWNsIHt9CgpleHBvcnQgY2xhc3MgQnVpbHRpblR5cGUgZXh0ZW5kcyBUeXBlIHsKICBjb25zdHJ1Y3Rvcihub2RlLCBhc3QpIHsKICAgIHN1cGVyKG5vZGUudHlwZSwgYXN0KTsKICB9Cn0KCmV4cG9ydCBjbGFzcyBQb2ludGVyVHlwZSBleHRlbmRzIE5vZGUgewogIGNvbnN0cnVjdG9yKG5vZGUsIGFzdCkgewogICAgc3VwZXIobm9kZSwgYXN0KTsKICAgIGFzc2VydChub2RlLmlubmVyLmxlbmd0aCwgMSk7CgogICAgdGhpcy50eXBlID0gbmV3IFR5cGUobm9kZS50eXBlLCBhc3QpOwogICAgdGhpcy5wb2ludGVlID0gVHlwZUZhY3Rvcnkobm9kZS5pbm5lclswXSwgYXN0KTsKICB9CgogIHRvSlNPTigpIHsKICAgIGNvbnN0IHsgcG9pbnRlZSwgdHlwZSB9ID0gdGhpczsKICAgIHJldHVybiBzdXBlci50b0pTT04oeyBwb2ludGVlLCB0eXBlIH0pOwogIH0KfQoKZXhwb3J0IGNsYXNzIENvbnN0YW50QXJyYXlUeXBlIGV4dGVuZHMgTm9kZSB7CiAgY29uc3RydWN0b3Iobm9kZSwgYXN0KSB7CiAgICBzdXBlcihub2RlLCBhc3QpOwogICAgbGV0IGVsZW1lbnRUeXBlID0gbm9kZS5pbm5lclswXTsKICAgIGFzc2VydChub2RlLmlubmVyLmxlbmd0aCwgMSk7CiAgICBpZihlbGVtZW50VHlwZS5kZWNsKSBlbGVtZW50VHlwZSA9IGVsZW1lbnRUeXBlLmRlY2w7CiAgICB0aGlzLnR5cGUgPSBuZXcgVHlwZShub2RlLnR5cGUsIGFzdCk7CiAgICB0aGlzLmVsZW1lbnRUeXBlID0gVHlwZUZhY3RvcnkoZWxlbWVudFR5cGUsIGFzdCk7CiAgfQoKICB0b0pTT04oKSB7CiAgICBjb25zdCB7IHR5cGUsIGVsZW1lbnRUeXBlIH0gPSB0aGlzOwogICAgcmV0dXJuIHN1cGVyLnRvSlNPTih7IHR5cGUsIGVsZW1lbnRUeXBlIH0pOwogIH0KfQoKZXhwb3J0IGNsYXNzIFJhbmdlIHsKICAjYmVnaW4gPSB1bmRlZmluZWQ7CiAgI2VuZCA9IHVuZGVmaW5lZDsKCiAgY29uc3RydWN0b3IoYmVnaW4sIGVuZCkgewogICAgaWYoYmVnaW4gIT09IHVuZGVmaW5lZCkgdGhpcy5iZWdpbiA9IGJlZ2luOwogICAgaWYoZW5kICE9PSB1bmRlZmluZWQpIHRoaXMuZW5kID0gZW5kOwogIH0KCiAgLyogcHJldHRpZXItaWdub3JlICovIGdldCBiZWdpbigpIHsgcmV0dXJuIHRoaXMuI2JlZ2luOyB9CiAgLyogcHJldHRpZXItaWdub3JlICovIHNldCBiZWdpbih2KSB7IHRoaXMuI2JlZ2luID0gTG9jYXRpb24uZnJvbSh2KTsgfQoKICAvKiBwcmV0dGllci1pZ25vcmUgKi8gZ2V0IGVuZCgpIHsgcmV0dXJuIHRoaXMuI2VuZDsgfQogIC8qIHByZXR0aWVyLWlnbm9yZSAqLyBzZXQgZW5kKHYpIHsgdGhpcy4jZW5kID0gTG9jYXRpb24uZnJvbSh2KTsgfQoKICB0b1N0cmluZyhvcHRzID0geyBwcmludEZpbGU6IHRydWUgfSkgewogICAgb3B0cy5vbmx5T2Zmc2V0ID0gdHJ1ZTsKICAgIHJldHVybiB0aGlzLiNiZWdpbi50b1N0cmluZyhvcHRzKSArICctJyArIHRoaXMuI2VuZC50b1N0cmluZyh7IC4uLm9wdHMsIHByaW50RmlsZTogZmFsc2UgfSk7CiAgfQoKICBbU3ltYm9sLmluc3BlY3RdKGRlcHRoLCBvcHRzKSB7CiAgICBjb25zdCB7IGJlZ2luLCBlbmQgfSA9IHRoaXM7CiAgICByZXR1cm4gaW5zcGVjdCgKICAgICAgewogICAgICAgIGZpbGU6IGJlZ2luLmZpbGUgPz8gZW5kLmZpbGUsCiAgICAgICAgYmVnaW46IG5ldyBMb2NhdGlvbih7IC4uLmJlZ2luLnRvT2JqZWN0KCksIGZpbGU6IHVuZGVmaW5lZCwgbGluZTogdW5kZWZpbmVkLCBjb2w6IHVuZGVmaW5lZCB9KSwKICAgICAgICBlbmQ6IG5ldyBMb2NhdGlvbih7IC4uLmVuZC50b09iamVjdCgpLCBmaWxlOiB1bmRlZmluZWQsIGxpbmU6IHVuZGVmaW5lZCwgY29sOiB1bmRlZmluZWQgfSksCiAgICAgICAgW1N5bWJvbC50b1N0cmluZ1RhZ106ICdSYW5nZScKICAgICAgfSwKICAgICAgeyAuLi5vcHRzLCBjb21wYWN0OiBmYWxzZSwgY3VzdG9tSW5zcGVjdDogdHJ1ZSwgb25seU9mZnNldDogdHJ1ZSB9CiAgICApOwogIH0KCiAgZ2V0IGxlbmd0aCgpIHsKICAgIHJldHVybiB0aGlzLiNlbmQgLSB0aGlzLiNiZWdpbjsKICB9CgogIHRvQXJyYXkoKSB7CiAgICByZXR1cm4gW3RoaXMuI2JlZ2luLCB0aGlzLiNlbmRdOwogIH0KCiAgdG9PYmplY3QoKSB7CiAgICBjb25zdCB7IGJlZ2luLCBlbmQgfSA9IHRoaXM7CiAgICByZXR1cm4geyBiZWdpbjogYmVnaW4udG9PYmplY3QoKSwgZW5kOiBlbmQudG9PYmplY3QoKSB9OwogIH0KCiAgKltTeW1ib2wuaXRlcmF0b3JdKCkgewogICAgeWllbGQgK3RoaXMuI2JlZ2luOwogICAgeWllbGQgK3RoaXMuI2VuZDsKICB9Cn0KClJhbmdlLnByb3RvdHlwZVtTeW1ib2wudG9TdHJpbmdUYWddID0gJ1JhbmdlJzsKCmV4cG9ydCBjbGFzcyBMb2NhdGlvbiB7CiAgI2xpbmUgPSB1bmRlZmluZWQ7CiAgI2NvbHVtbiA9IHVuZGVmaW5lZDsKICAjb2Zmc2V0ID0gdW5kZWZpbmVkOwogIGZpbGUgPSB1bmRlZmluZWQ7CgogIHN0YXRpYyBhdChmaWxlLCBvZmZzZXQpIHsKICAgIGxldCBkYXRhID0gZnMucmVhZEZpbGVTeW5jKGZpbGUsICd1dGYtOCcpLnNsaWNlKDAsIG9mZnNldCk7CiAgICBsZXQgbGFzdExpbmUgPSBkYXRhLnNsaWNlKGRhdGEubGFzdEluZGV4T2YoJ1xuJykgKyAxKTsKCiAgICByZXR1cm4gbmV3IHRoaXMoeyBsaW5lOiBjb3VudFN1YnN0cmluZyhkYXRhLCAnXG4nKSArIDEsIGNvbDogbGFzdExpbmUubGVuZ3RoICsgMSwgZmlsZSwgb2Zmc2V0IH0pOwogIH0KCiAgc3RhdGljIGZyb20obG9jKSB7CiAgICBpZih0eXBlb2YgbG9jID09ICdvYmplY3QnICYmIGxvYyAhPSBudWxsICYmIGxvYyBpbnN0YW5jZW9mIExvY2F0aW9uKSByZXR1cm4gbG9jOwogICAgdHJ5IHsKICAgICAgcmV0dXJuIG5ldyBMb2NhdGlvbihsb2MpOwogICAgfSBjYXRjaChlKSB7CiAgICAgIGNvbnNvbGUubG9nKCdFUlJPUicsIGUubWVzc2FnZSwgbG9jKTsKICAgICAgdGhyb3cgZTsKICAgIH0KICB9CgogIGNvbnN0cnVjdG9yKGxvYykgewogICAgY29uc3QgeyBsaW5lLCBjb2wsIGZpbGUsIG9mZnNldCB9ID0gbG9jOwoKICAgIGlmKCdsaW5lJyBpbiBsb2MpIHRoaXMuI2xpbmUgPSBsb2MubGluZTsKICAgIGlmKCdjb2wnIGluIGxvYykgdGhpcy4jY29sdW1uID0gbG9jLmNvbDsKICAgIGlmKCdmaWxlJyBpbiBsb2MpIHRoaXMuZmlsZSA9IGxvYy5maWxlOwogICAgaWYoJ29mZnNldCcgaW4gbG9jKSB0aGlzLiNvZmZzZXQgPSBsb2Mub2Zmc2V0OwogIH0KCiAgdXBkYXRlKG90aGVyKSB7CiAgICBmb3IobGV0IHByb3Agb2YgWydmaWxlJywgJ29mZnNldCcsICdsaW5lJywgJ2NvbHVtbiddKSB7CiAgICAgIGlmKG90aGVyW3Byb3BdKSB0aGlzW3Byb3BdID0gb3RoZXJbcHJvcF07CiAgICB9CiAgfQoKICAvKiBwcmV0dGllci1pZ25vcmUgKi8gZ2V0IGxpbmUoKSB7IHJldHVybiB0aGlzLiNsaW5lOyB9CiAgLyogcHJldHRpZXItaWdub3JlICovIHNldCBsaW5lKHYpIHsgaWYodiAhPSB0aGlzLiNsaW5lKSB0aGlzLiNjb2x1bW4gPSB1bmRlZmluZWQ7IHRoaXMuI2xpbmUgPSB2OyB9CgogIC8qIHByZXR0aWVyLWlnbm9yZSAqLyBnZXQgY29sdW1uKCkgeyByZXR1cm4gdGhpcy4jY29sdW1uOyB9CiAgLyogcHJldHRpZXItaWdub3JlICovIHNldCBjb2x1bW4odikgeyB0aGlzLiNjb2x1bW4gPSB2OyB9CgogIC8qIHByZXR0aWVyLWlnbm9yZSAqLyBnZXQgb2Zmc2V0KCkgeyByZXR1cm4gdGhpcy4jb2Zmc2V0OyB9CiAgLyogcHJldHRpZXItaWdub3JlICovIHNldCBvZmZzZXQodikgeyBpZih0aGlzLiNvZmZzZXQgLSB2IDwgdGhpcy4jY29sdW1uKSB0aGlzLiNjb2x1bW4gLT0gdGhpcy4jb2Zmc2V0IC0gdjsgZWxzZSB7IHRoaXMuI2NvbHVtbiA9IHVuZGVmaW5lZDsgdGhpcy4jbGluZSA9IHVuZGVmaW5lZDsgfSB0aGlzLiNvZmZzZXQgPSB2OyB9CgogIFtTeW1ib2wuZm9yKCdub2RlanMudXRpbC5pbnNwZWN0LmN1c3RvbScpXShkZXB0aCwgb3B0cyA9IHt9KSB7CiAgICBjb25zdCB0ZXh0ID0gb3B0cy5jb2xvcnMgPyAodCwgLi4uYykgPT4gJ1x4MWJbJyArIGMuam9pbignOycpICsgJ20nICsgdCArICdceDFiW20nIDogdCA9PiB0OwogICAgcmV0dXJuIHRleHQoJ0xvY2F0aW9uJywgMzgsIDUsIDExMSkgKyAnICcgKyB0aGlzLnRvU3RyaW5nKG9wdHMpOwogIH0KCiAgdG9TdHJpbmcob3B0cyA9IHsgcHJpbnRGaWxlOiB0cnVlLCBvbmx5T2Zmc2V0OiBmYWxzZSB9KSB7CiAgICBsZXQgZmlsZSA9IHRoaXMuZmlsZSwKICAgICAgY29sID0gdGhpcy4jY29sdW1uLAogICAgICBsaW5lID0gdGhpcy4jbGluZTsKICAgIGNvbnN0IHsgcHJpbnRGaWxlID0gdHJ1ZSwgb25seU9mZnNldCA9IGZhbHNlIH0gPSBvcHRzOwoKICAgIGlmKGxpbmUgIT09IHVuZGVmaW5lZCAmJiBjb2wgIT09IHVuZGVmaW5lZCAmJiAhb25seU9mZnNldCkKICAgICAgcmV0dXJuIFtmaWxlID8/ICc8YnVpbHRpbj4nLCBsaW5lLCBjb2xdLnNsaWNlKHByaW50RmlsZSA/IDAgOiAxKS5qb2luKCc6Jyk7CiAgICByZXR1cm4gYCR7cHJpbnRGaWxlICYmIGZpbGUgPyBmaWxlICsgJ0AnIDogJyd9JHt0aGlzLiNvZmZzZXR9YDsKICB9CgogIFtTeW1ib2wudG9QcmltaXRpdmVdKGhpbnQpIHsKICAgIHN3aXRjaCAoaGludCkgewogICAgICBjYXNlICdudW1iZXInOgogICAgICAgIHJldHVybiB0aGlzLm9mZnNldDsKICAgICAgY2FzZSAnc3RyaW5nJzoKICAgICAgZGVmYXVsdDoKICAgICAgICByZXR1cm4gdGhpcy50b1N0cmluZygpOwogICAgfQogIH0KCiAgdG9PYmplY3QoKSB7CiAgICBsZXQgcmV0ID0ge307CiAgICBpZih0aGlzLmZpbGUpIHJldC5maWxlID0gdGhpcy5maWxlOwogICAgaWYodGhpcy4jY29sdW1uKSByZXQuY29sID0gdGhpcy4jY29sdW1uOwogICAgaWYodGhpcy4jbGluZSkgcmV0LmxpbmUgPSB0aGlzLiNsaW5lOwogICAgLyppZih0eXBlb2YgdGhpcy4jb2Zmc2V0ID09ICdudW1iZXInKSovIHJldC5vZmZzZXQgPSB0aGlzLiNvZmZzZXQ7CgogICAgcmV0dXJuIHJldDsKICB9CgogIGxvY2FsZUNvbXBhcmUob3RoZXIpIHsKICAgIGxldCBzdHIgPSB0aGlzICsgJyc7CiAgICByZXR1cm4gc3RyLmxvY2FsZUNvbXBhcmUob3RoZXIgKyAnJyk7CiAgfQp9CgpleHBvcnQgZnVuY3Rpb24gVHlwZUZhY3Rvcnkobm9kZSwgYXN0LCBjYWNoZSA9IHRydWUpIHsKICBsZXQgb2JqOwoKICAvLyBjb25zb2xlLmxvZygnVHlwZUZhY3Rvcnk6JywgeyBub2RlIH0pOwoKICBVdGlsLmFzc2VydCgKICAgIG5vZGUua2luZCwKICAgIGBOb3QgYW4gQVNUIG5vZGU6ICR7aW5zcGVjdChub2RlLCB7CiAgICAgIGNvbG9yczogZmFsc2UsCiAgICAgIGNvbXBhY3Q6IDAsCiAgICAgIGRlcHRoOiBJbmZpbml0eQogICAgfSl9YAogICk7CgogIGlmKGNhY2hlICYmIChvYmogPSBUeXBlLmFzdDJub2RlLmdldChub2RlKSkpIHJldHVybiBvYmo7CgogIHN3aXRjaCAobm9kZS5raW5kKSB7CiAgICBjYXNlICdFbnVtRGVjbCc6CiAgICAgIG9iaiA9IG5ldyBFbnVtRGVjbChub2RlLCBhc3QpOwogICAgICBicmVhazsKICAgIGNhc2UgJ1JlY29yZERlY2wnOgogICAgICBvYmogPSBuZXcgUmVjb3JkRGVjbChub2RlLCBhc3QpOwogICAgICBicmVhazsKICAgIGNhc2UgJ0ZpZWxkRGVjbCc6CiAgICAgIG9iaiA9IG5ldyBGaWVsZERlY2wobm9kZSwgYXN0KTsKICAgICAgYnJlYWs7CiAgICBjYXNlICdUeXBlZGVmRGVjbCc6CiAgICAgIG9iaiA9IG5ldyBUeXBlZGVmRGVjbChub2RlLCBhc3QpOwogICAgICBicmVhazsKICAgIGNhc2UgJ0NYWENvbnN0cnVjdG9yRGVjbCc6CiAgICBjYXNlICdDWFhNZXRob2REZWNsJzoKICAgIGNhc2UgJ0NYWERlc3RydWN0b3JEZWNsJzoKICAgIGNhc2UgJ0Z1bmN0aW9uRGVjbCc6CiAgICAgIG9iaiA9IG5ldyBGdW5jdGlvbkRlY2wobm9kZSwgYXN0KTsKICAgICAgYnJlYWs7CiAgICBjYXNlICdCdWlsdGluVHlwZSc6CiAgICAgIG9iaiA9IG5ldyBCdWlsdGluVHlwZShub2RlLCBhc3QpOwogICAgICBicmVhazsKICAgIGNhc2UgJ1BvaW50ZXJUeXBlJzoKICAgICAgb2JqID0gbmV3IFBvaW50ZXJUeXBlKG5vZGUsIGFzdCk7CiAgICAgIGJyZWFrOwogICAgY2FzZSAnQ29uc3RhbnRBcnJheVR5cGUnOgogICAgICBvYmogPSBuZXcgQ29uc3RhbnRBcnJheVR5cGUobm9kZSwgYXN0KTsKICAgICAgYnJlYWs7CiAgICBjYXNlICdDWFhSZWNvcmREZWNsJzoKICAgICAgb2JqID0gbmV3IENsYXNzRGVjbChub2RlLCBhc3QpOwogICAgICBicmVhazsKICAgIGNhc2UgJ1ZhckRlY2wnOgogICAgICBvYmogPSBuZXcgVmFyRGVjbChub2RlLCBhc3QpOwogICAgICBicmVhazsKICAgIGNhc2UgdW5kZWZpbmVkOgogICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vdCBhbiBBU1Qgbm9kZTogJHtpbnNwZWN0KG5vZGUsIHsgY29sb3JzOiBmYWxzZSwgY29tcGFjdDogMCB9KX1gKTsKICAgICAgYnJlYWs7CgogICAgZGVmYXVsdDoKICAgICAgY29uc29sZS5sb2coJ25vZGU6Jywgbm9kZSk7CiAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gc3VjaCBraW5kIG9mIEFTVCBub2RlOiAke25vZGUua2luZH1gKTsKICAgICAgLy9vYmogPSBuZXcgVHlwZShub2RlLCBhc3QpOwogICAgICBicmVhazsKICB9CiAgcmV0dXJuIG9iajsKfQoKZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFNwYXduQ29tcGlsZXIoY29tcGlsZXIsIGlucHV0LCBvdXRwdXQsIGFyZ3MgPSBbXSkgewogIC8vY29uc29sZS5sb2coYFNwYXduQ29tcGlsZXJgLCB7IGNvbXBpbGVyLCBpbnB1dCwgb3V0cHV0LCBhcmdzIH0pOwogIGxldCBiYXNlID0gcGF0aC5iYXNlbmFtZShpbnB1dCwgcGF0aC5leHRuYW1lKGlucHV0KSk7CgogIGFyZ3MucHVzaChpbnB1dCk7CgogIGlmKGFyZ3MuaW5kZXhPZignLWFzdC1kdW1wPWpzb24nKSAhPSAtMSkgewogICAgYXJncy51bnNoaWZ0KGNvbXBpbGVyID8/ICdjbGFuZycpOwogICAgYXJncyA9IFsKICAgICAgJ3NoJywKICAgICAgJy1jJywKICAgICAgJ2V4ZWMgJyArIGFyZ3MubWFwKHAgPT4gKHAuaW5kZXhPZignICcpICE9IC0xID8gYCcke3B9J2AgOiBwKSkuam9pbignICcpICsgKG91dHB1dCA/IGAgMT4ke291dHB1dH1gIDogJycpCiAgICBdOwogIH0gZWxzZSB7CiAgICBpZihvdXRwdXQpIHsKICAgICAgYXJncy51bnNoaWZ0KG91dHB1dCk7CiAgICAgIGFyZ3MudW5zaGlmdCgnLW8nKTsKICAgIH0KICAgIGFyZ3MudW5zaGlmdChjb21waWxlciA/PyAnY2xhbmcnKTsKICB9CgogIGNvbnNvbGUubG9nKAogICAgJ1NwYXduQ29tcGlsZXInLAogICAgYXJncy5tYXAocCA9PiAocC5pbmRleE9mKCcgJykgIT0gLTEgPyBgJyR7cH0nYCA6IHApKS5qb2luKCcgJykgKyAob3V0cHV0ID8gYCAxPiR7b3V0cHV0fWAgOiAnJykKICApOwoKICBsZXQgY2hpbGQgPSBzcGF3bihhcmdzLCB7CiAgICBibG9jazogZmFsc2UsCiAgICBzdGRpbzogWydpbmhlcml0Jywgb3V0cHV0ID8gJ2luaGVyaXQnIDogJ3BpcGUnLCAncGlwZSddCiAgfSk7CgogIGxldCBqc29uID0gJycsCiAgICBlcnJvcnMgPSAnJzsKICBsZXQgZG9uZSA9IGZhbHNlOwoKICBpZihVdGlsLnBsYXRmb3JtID09ICdxdWlja2pzJykgewogICAgbGV0IHsgZmQgfSA9IGNoaWxkLnN0ZGVycjsKICAgIC8vY29uc29sZS5sb2coJ1NwYXduQ29tcGlsZXIgY2hpbGQuc3RkZXJyOicsIGNoaWxkLnN0ZGVycik7CiAgICAvL2NvbnNvbGUubG9nKCdTcGF3bkNvbXBpbGVyIGNoaWxkLnN0ZG91dDonLCBjaGlsZC5zdGRvdXQpOwogICAgYXdhaXQgUGlwZVJlYWRlcihjaGlsZC5zdGRlcnIuZmQsIGRhdGEgPT4gKGVycm9ycyArPSBkYXRhID8/ICcnKSk7CgogICAgaWYoY2hpbGQuc3Rkb3V0KSB7CiAgICAgIG91dHB1dCA9ICcnOwogICAgICBhd2FpdCBQaXBlUmVhZGVyKGNoaWxkLnN0ZG91dC5mZCwgZGF0YSA9PiAob3V0cHV0ICs9IGRhdGEgPz8gJycpKTsKICAgIH0KICB9IGVsc2UgewogICAgQWNxdWlyZVJlYWRlcihjaGlsZC5zdGRlcnIsIGFzeW5jIHJlYWRlciA9PiB7CiAgICAgIGxldCByOwogICAgICB3aGlsZSgociA9IGF3YWl0IHJlYWRlci5yZWFkKCkpKSB7CiAgICAgICAgaWYoIXIuZG9uZSkgZXJyb3JzICs9IHIudmFsdWUudG9TdHJpbmcoKTsKICAgICAgfQogICAgfSk7CiAgfQogIGxldCBbc3RhdHVzLCBleGl0Y29kZV0gPSBhd2FpdCBjaGlsZC53YWl0KCk7CiAgY29uc29sZS5sb2coJ1NwYXduQ29tcGlsZXIgY2hpbGQud2FpdCgpOicsIHsgc3RhdHVzLCBleGl0Y29kZSB9KTsKCiAgZG9uZSA9IHRydWU7CiAgbGV0IGVycm9yTGluZXMgPSBlcnJvcnMuc3BsaXQoL1xuL2cpLmZpbHRlcihsaW5lID0+IGxpbmUudHJpbSgpICE9ICcnKTsKICBlcnJvckxpbmVzID0gZXJyb3JMaW5lcy5maWx0ZXIobGluZSA9PiAvZXJyb3I6Ly50ZXN0KGxpbmUpKTsKICBjb25zdCBudW1FcnJvcnMgPQogICAgWy4uLigvXihbMC05XSspXHMvZy5leGVjKGVycm9yTGluZXMuZmluZChsaW5lID0+IC9lcnJvcnNcc2dlbmVyYXRlZC8udGVzdChsaW5lKSkgfHwgJzAnKSB8fCBbXSldWzBdIHx8CiAgICBlcnJvckxpbmVzLmxlbmd0aDsKICBpZihudW1FcnJvcnMpIHsKICAgIGNvbnNvbGUubG9nKCdlcnJvcnM6JywgZXJyb3JzKTsKICAgIHRocm93IG5ldyBFcnJvcihlcnJvckxpbmVzLmpvaW4oJ1xuJykpOwogIH0KCiAgZnVuY3Rpb24gUGlwZVJlYWRlcihmZCwgY2FsbGJhY2spIHsKICAgIGxldCByZXQ7CiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICBvcy5zZXRSZWFkSGFuZGxlcihmZCwgKCkgPT4KICAgICAgICBSZWFkUGlwZShmZCwgZGF0YSA9PiB7CiAgICAgICAgICBpZihkYXRhKSByZXQgPSBjYWxsYmFjayhkYXRhKTsKICAgICAgICAgIGVsc2UgcmVzb2x2ZShyZXQpOwogICAgICAgIH0pCiAgICAgICk7CiAgICB9KTsKICB9CgogIGZ1bmN0aW9uIFJlYWRQaXBlKGZkLCBjYWxsYmFjaykgewogICAgbGV0IGJ1ZiA9IG5ldyBBcnJheUJ1ZmZlcigxMDI0KTsKICAgIGxldCByID0gb3MucmVhZChmZCwgYnVmLCAwLCBidWYuYnl0ZUxlbmd0aCk7CiAgICBsZXQgZGF0YTsKICAgIGlmKHIgPiAwKSB7CiAgICAgIGRhdGEgPSBmcy5idWZmZXJUb1N0cmluZyhidWYuc2xpY2UoMCwgcikpOwogICAgfSBlbHNlIHsKICAgICAgb3Muc2V0UmVhZEhhbmRsZXIoZmQsIG51bGwpOwogICAgICBkYXRhID0gbnVsbDsKICAgIH0KICAgIC8vY29uc29sZS5sb2coJ1JlYWRQaXBlJywgeyBmZCwgciwgZGF0YSB9KTsKICAgIGNhbGxiYWNrKGRhdGEpOwogIH0KICBmdW5jdGlvbiBSZWFkT3V0cHV0KGZkKSB7CiAgICBsZXQgYnVmID0gbmV3IEFycmF5QnVmZmVyKDEwMjQpOwogICAgbGV0IHIgPSBvcy5yZWFkKGZkLCBidWYsIDAsIGJ1Zi5ieXRlTGVuZ3RoKTsKICAgIGlmKHIgPiAwKSB7CiAgICAgIG91dHB1dCArPSBmcy5idWZmZXJUb1N0cmluZyhidWYuc2xpY2UoMCwgcikpOwogICAgICAvL2NvbnNvbGUubG9nKCdyOicsIHIsICdvdXRwdXQ6Jywgb3V0cHV0Lmxlbmd0aCk7CiAgICB9IGVsc2UgewogICAgICBvcy5zZXRSZWFkSGFuZGxlcihmZCwgbnVsbCk7CiAgICB9CiAgfQogIGxldCByZXQgPSB7IG91dHB1dCwgZXhpdGNvZGUsIGVycm9yczogZXJyb3JMaW5lcyB9OwogIC8vIGNvbnNvbGUubG9nKCdTcGF3bkNvbXBpbGVyIHJldHVybicsIHJldCk7CgogIHJldHVybiByZXQ7Cn0KCmV4cG9ydCBhc3luYyBmdW5jdGlvbiBTb3VyY2VEZXBlbmRlbmNpZXMoLi4uYXJncykgewogIGlmKGFyZ3MubGVuZ3RoIDwgMykgYXJncy51bnNoaWZ0KHBhcmFtcy5jb21waWxlcik7CgogIGxldCBbY29tcGlsZXIsIHNvdXJjZSwgZmxhZ3MgPSBbXV0gPSBhcmdzOwoKICAvL2NvbnNvbGUubG9nKCdTb3VyY2VEZXBlbmRlbmNpZXMnLCB7IGNvbXBpbGVyLCBzb3VyY2UsIGZsYWdzIH0pOwoKICBsZXQgciA9IGF3YWl0IFNwYXduQ29tcGlsZXIoY29tcGlsZXIsIHNvdXJjZSwgbnVsbCwgWyctTU0nLCAnLUkuJywgLi4uZmxhZ3NdKTsKICBsZXQgeyBvdXRwdXQsIHJlc3VsdCwgZXJyb3JzIH0gPSAoZ2xvYmFsVGhpcy5yZXNwb25zZSA9IHIpOwogIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC9ccypcXFxuXHMqL2csICcgJyk7CiAgbGV0IFtvYmplY3QsIHNvdXJjZXNdID0gb3V0cHV0LnNwbGl0KC86XHMrLyk7CiAgLy9jb25zb2xlLmxvZygnU291cmNlRGVwZW5kZW5jaWVzJywgeyBzb3VyY2VzIH0pOwoKICBzb3VyY2VzID0gKHNvdXJjZXMgPz8gJycpLnRyaW0oKS5zcGxpdCgvIC9nKTsKICBsZXQgW2NvbXBpbGF0aW9uX3VuaXQsIC4uLmluY2x1ZGVzXSA9IHNvdXJjZXM7CgogIC8vY29uc29sZS5sb2coJ291dHB1dFsxXTonLCB7IGNvbXBpbGF0aW9uX3VuaXQsIGluY2x1ZGVzIH0pOwoKICByZXR1cm4gc291cmNlczsKfQoKZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEFzdER1bXAoY29tcGlsZXIsIHNvdXJjZSwgYXJncywgZm9yY2UpIHsKICBjb21waWxlciA/Pz0gJ2NsYW5nJzsKICAvLyBjb25zb2xlLmxvZygnQXN0RHVtcCcsIHsgY29tcGlsZXIsIHNvdXJjZSwgYXJncywgZm9yY2UgfSk7CiAgbGV0IG91dHB1dCA9IHBhdGguYmFzZW5hbWUoc291cmNlLCBwYXRoLmV4dG5hbWUoc291cmNlKSkgKyAnLmFzdC5qc29uJzsKICBsZXQgcjsKICBsZXQgc291cmNlcyA9IGF3YWl0IFNvdXJjZURlcGVuZGVuY2llcyhjb21waWxlciwgc291cmNlLCBhcmdzKTsKICBsZXQgbmV3ZXI7CiAgbGV0IGV4aXN0c0FuZE5vdEVtcHR5ID0gZnMuZXhpc3RzU3luYyhvdXRwdXQpICYmIGZzLnNpemVTeW5jKG91dHB1dCkgPiAwOwoKICBpZihleGlzdHNBbmROb3RFbXB0eSkgbmV3ZXIgPSBOZXdlcihvdXRwdXQsIC4uLnNvdXJjZXMpOwoKICAvL2NvbnNvbGUubG9nKCdBc3REdW1wJywgeyBvdXRwdXQsIHNvdXJjZSwgc291cmNlcyxmb3JjZSwgZXhpc3RzQW5kTm90RW1wdHksIG5ld2VyIH0pOwogIGNvbnNvbGUubG9nKCdBc3REdW1wJywgeyBvdXRwdXQgfSk7CgogIGlmKCFmb3JjZSAmJiBleGlzdHNBbmROb3RFbXB0eSAmJiBuZXdlcikgewogICAgY29uc29sZS5sb2coYExvYWRpbmcgY2FjaGVkICcke291dHB1dH0nLi4uYCk7CiAgfSBlbHNlIHsKICAgIGNvbnNvbGUubG9nKGBDb21waWxpbmcgJyR7c291cmNlfScgdG8gJyR7b3V0cHV0fScuLi5gKTsKCiAgICB0cnkgewogICAgICBpZihmcy5leGlzdHNTeW5jKG91dHB1dCkpIGZzLnVubGlua1N5bmMob3V0cHV0KTsKICAgIH0gY2F0Y2goZSkge30KCiAgICBjb25zb2xlLmxvZyhgQ29tcGlsaW5nLi4uYCwgeyBzb3VyY2UsIGNvbXBpbGVyIH0pOwoKICAgIGxldCB7IGV4aXRjb2RlLCBlcnJvcnMsIC4uLnJlc3VsdCB9ID0gYXdhaXQgU3Bhd25Db21waWxlcihjb21waWxlciwgc291cmNlLCBvdXRwdXQsIFsKICAgICAgJy1YY2xhbmcnLAogICAgICAnLWFzdC1kdW1wPWpzb24nLAogICAgICAnLWZzeW50YXgtb25seScsCiAgICAgICctSS4nLAogICAgICAuLi5hcmdzCiAgICBdKTsKICAgIGNvbnNvbGUubG9nKGBDb21waWxpbmcgJyR7c291cmNlfScuLi5gLCB7IG91dHB1dCwgZXhpdGNvZGUsIC4uLnJlc3VsdCB9KTsKICB9CiAgciA9IHsgZmlsZTogb3V0cHV0IH07CgogIGNvbnNvbGUubG9nKCdBc3REdW1wJywgeyAuLi5yIH0pOwoKICAvL3Iuc2l6ZSA9IChhd2FpdCBmcy5zdGF0KHIuZmlsZSkpLnNpemU7CiAgciA9IGxhenlQcm9wZXJ0aWVzKHIsIHsKICAgIHNpemUoKSB7CiAgICAgIHJldHVybiBmcy5zdGF0KG91dHB1dCk/LnNpemU7CiAgICB9LAogICAganNvbigpIHsKICAgICAgY29uc29sZS5sb2coYHIuanNvbmAsIHRoaXMuZmlsZSk7CgogICAgICBsZXQganNvbiA9IGZzLnJlYWRGaWxlU3luYyh0aGlzLmZpbGUsICd1dGYtOCcpOwogICAgICByZXR1cm4ganNvbjsKICAgIH0sCiAgICBkYXRhKCkgewogICAgICBsZXQgZGF0YSA9IEpTT04ucGFyc2UodGhpcy5qc29uKTsKICAgICAgbGV0IGZpbGU7CiAgICAgIGxldCBtYXhEZXB0aCA9IDA7CiAgICAgIGZvcihsZXQgbm9kZSBvZiBkYXRhLmlubmVyKSB7CiAgICAgICAgbGV0IHJhbmdlOwoKICAgICAgICBjb25zdCBTZXRGaWxlID0gbG9jID0+IHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmKGxvYykgewogICAgICAgICAgICAgIGlmKGxvYy5maWxlKSBmaWxlID0gbG9jLmZpbGU7CiAgICAgICAgICAgICAgZWxzZSBsb2MuZmlsZSA9IGZpbGU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gY2F0Y2goZSkge30KICAgICAgICB9OwogICAgICAgIFNldEZpbGUobm9kZS5sb2MpOwogICAgICAgIFNldEZpbGUobm9kZS5yYW5nZT8uYmVnaW4pOwogICAgICAgIFNldEZpbGUobm9kZS5yYW5nZT8uZW5kKTsKICAgICAgfQogICAgICBXcml0ZUJKU09OKHRoaXMuZmlsZS5yZXBsYWNlKCcuanNvbicsICcuYmpzb24nKSwgZGF0YSk7CiAgICAgIHJldHVybiBkYXRhOwogICAgfSwKICAgIGZpbGVzKCkgewogICAgICByZXR1cm4gdW5pcXVlKHRoaXMuZGF0YS5pbm5lci5tYXAobiA9PiBuLmxvYy5maWxlKS5maWx0ZXIoZmlsZSA9PiBmaWxlICE9IHVuZGVmaW5lZCkpOwogICAgfQogIH0pOwoKICByID0gZGVmaW5lKHIsIHsKICAgIG1hdGNoRmlsZXM6IG51bGwsCiAgICBub21hdGNoRmlsZXM6IC9eXC91c3IvLAogICAgZmlsdGVyKHByZWQsIHByZWQyID0gKHVzZWQsIGltcGxpY2l0KSA9PiB1c2VkICYmICFpbXBsaWNpdCkgewogICAgICByZXR1cm4gdGhpcy5kYXRhLmlubmVyLmZpbHRlcigKICAgICAgICBub2RlID0+CiAgICAgICAgICAoKG5vZGUubG9jLmZpbGUgIT09IHVuZGVmaW5lZCAmJgogICAgICAgICAgICAoKHRoaXMubWF0Y2hGaWxlcyAmJiB0aGlzLm1hdGNoRmlsZXMudGVzdChub2RlLmxvYy5maWxlID8/ICcnKSkgfHwKICAgICAgICAgICAgICAhdGhpcy5ub21hdGNoRmlsZXMudGVzdChub2RlLmxvYy5maWxlID8/ICcnKSkpIHx8CiAgICAgICAgICAgIChwcmVkMiA/IHByZWQyKG5vZGUuaXNVc2VkLCBub2RlLmlzSW1wbGljaXQpIDogZmFsc2UpKSAmJgogICAgICAgICAgcHJlZChub2RlKQogICAgICApOwogICAgfQogIH0pOwogIHIgPSBsYXp5UHJvcGVydGllcyhyLCB7CiAgICB0eXBlcygpIHsKICAgICAgcmV0dXJuIE9iamVjdC5zZXRQcm90b3R5cGVPZigKICAgICAgICB0aGlzLmZpbHRlcigKICAgICAgICAgIG4gPT4gLyg/OlJlY29yZHxUeXBlZGVmfEVudW0pRGVjbC8udGVzdChuLmtpbmQpLAogICAgICAgICAgKCkgPT4gdHJ1ZQogICAgICAgICksCiAgICAgICAgTGlzdC5wcm90b3R5cGUKICAgICAgKTsKICAgIH0sCiAgICBmdW5jdGlvbnMoKSB7CiAgICAgIGxldCBsaXN0ID0gdGhpcy5maWx0ZXIoCiAgICAgICAgbiA9PiAvKD86RnVuY3Rpb24pRGVjbC8udGVzdChuLmtpbmQpLAogICAgICAgICgpID0+IHRydWUKICAgICAgKTsKCiAgICAgIGlmKGxpc3QubGVuZ3RoID09IDApIGxpc3QgPSBkZWVwLnNlbGVjdCh0aGlzLmRhdGEsIG4gPT4gbi5raW5kLnN0YXJ0c1dpdGgoJ0Z1bmN0aW9uRGVjbCcpLCBkZWVwLlJFVFVSTl9WQUxVRSk7CgogICAgICByZXR1cm4gT2JqZWN0LnNldFByb3RvdHlwZU9mKGxpc3QsIExpc3QucHJvdG90eXBlKTsKICAgIH0sCiAgICBuYW1lc3BhY2VzKCkgewogICAgICByZXR1cm4gT2JqZWN0LnNldFByb3RvdHlwZU9mKAogICAgICAgIGRlZXAuc2VsZWN0KHRoaXMuZGF0YSwgbiA9PiAnTmFtZXNwYWNlRGVjbCcgPT0gbi5raW5kLCBkZWVwLlJFVFVSTl9WQUxVRSwgMTApLAogICAgICAgIExpc3QucHJvdG90eXBlCiAgICAgICk7CiAgICB9LAogICAgY2xhc3NlcygpIHsKICAgICAgbGV0IHByZWRpY2F0ZSA9IG4gPT4gbi5raW5kID09ICdDWFhSZWNvcmREZWNsJyAmJiAhbi5pc0ltcGxpY2l0OwogICAgICAvKihQcmVkaWNhdGUucHJvcGVydHkoJ2tpbmQnLCBQcmVkaWNhdGUuZXF1YWwoJ0NYWFJlY29yZERlY2wnKSksCiAgICAgICAgUHJlZGljYXRlLm5vdChQcmVkaWNhdGUucHJvcGVydHkoJ2lzSW1wbGljaXQnLCBQcmVkaWNhdGUuZXF1YWwodHJ1ZSkpKSk7Ki8KICAgICAgLy9wcmVkaWNhdGUgPSBuID0+ICdDWFhSZWNvcmREZWNsJyA9PSBuLmtpbmQgJiYgIW4uaXNJbXBsaWNpdDsKICAgICAgcmV0dXJuIE9iamVjdC5zZXRQcm90b3R5cGVPZihkZWVwLnNlbGVjdCh0aGlzLmRhdGEsIHByZWRpY2F0ZSwgZGVlcC5SRVRVUk5fVkFMVUUsIDEwKSwgTGlzdC5wcm90b3R5cGUpOwogICAgfSwKICAgIHZhcmlhYmxlcygpIHsKICAgICAgcmV0dXJuIE9iamVjdC5zZXRQcm90b3R5cGVPZigKICAgICAgICB0aGlzLmZpbHRlcihuID0+IC8oPzpWYXIpRGVjbC8udGVzdChuLmtpbmQpKSwKICAgICAgICBMaXN0LnByb3RvdHlwZQogICAgICApOwogICAgfSwKICAgIG5hbWVzKGRlcHRoID0gMSkgewogICAgICByZXR1cm4gdGhpcy5kYXRhLmlubmVyLmZpbHRlcihuID0+ICduYW1lJyBpbiBuKS5tYXAobiA9PiBuLm5hbWUpOwogICAgfQogIH0pOwogIHJldHVybiByOwp9CgpleHBvcnQgZnVuY3Rpb24gTmFtZUZvcihkZWNsLCBhc3QgPSB0aGlzLmRhdGEpIHsKICBjb25zdCB7IGlkIH0gPSBkZWNsOwogIGxldCBwOwogIGlmKChwID0gZGVlcC5maW5kKGFzdCwgKHZhbHVlLCBrZXkpID0+IGtleSA9PSAnb3duZWRUYWdEZWNsJyAmJiB2YWx1ZS5pZCA9PSBpZCwgZGVlcC5SRVRVUk5fUEFUSCkpKSB7CiAgICBwID0gcC5zbGljZSgwLCAtMSk7CgogICAgbGV0IG5vZGUgPSBkZWVwLmdldChhc3QsIHApOwogICAgbGV0IHBhcmVudCA9IGRlZXAuZ2V0KGFzdCwgcC5zbGljZSgwLCAtMikpOwoKICAgIGlmKHBhcmVudC5raW5kID09ICdUeXBlZGVmRGVjbCcgJiYgcGFyZW50Lm5hbWUpIHJldHVybiBwYXJlbnQubmFtZTsKCiAgICAvL2NvbnNvbGUubG9nKCdwOicsIHAsICdub2RlOicsIG5vZGUsICdwYXJlbnQ6JywgcGFyZW50KTsKCiAgICByZXR1cm4gbm9kZT8udHlwZT8uZGVzdWdhcmVkUXVhbFR5cGU7CiAgfQp9CgpleHBvcnQgZnVuY3Rpb24gTm9kZVR5cGUobikgewogIHJldHVybiBuLnR5cGUKICAgID8gKHQgPT4gewogICAgICAgIGxldCB7IHR5cGVBbGlhc0RlY2xJZCwgLi4udHlwZSB9ID0gdDsKICAgICAgICBpZih0eXBlb2YgdHlwZUFsaWFzRGVjbElkID09ICdzdHJpbmcnKSB0eXBlLnR5cGVBbGlhc0RlY2wgPSBpZE5vZGVzLmdldCh0eXBlQWxpYXNEZWNsSWQpOwoKICAgICAgICBpZihUeXBlLmRlY2xhcmF0aW9ucyAmJiBUeXBlLmRlY2xhcmF0aW9ucy5oYXModC5kZXN1Z2FyZWRRdWFsVHlwZSkpIHsKICAgICAgICAgIHR5cGUgPSBUeXBlLmRlY2xhcmF0aW9ucy5nZXQodC5kZXN1Z2FyZWRRdWFsVHlwZSk7CiAgICAgICAgfQoKICAgICAgICBpZihpc09iamVjdCh0eXBlKSAmJiBpc09iamVjdCh0eXBlLnR5cGUpKSB0eXBlID0gdHlwZS50eXBlOwogICAgICAgIHJldHVybiBuZXcgVHlwZSh0eXBlKTsKICAgICAgfSkobi50eXBlKQogICAgOiBOb2RlVHlwZShkZWVwLmZpbmQoYXN0LCBuID0+IGlzT2JqZWN0KG4pICYmIG4udHlwZSkudmFsdWUpOwp9CgpleHBvcnQgZnVuY3Rpb24gTm9kZU5hbWUobiwgbmFtZSkgewogIGlmKHR5cGVvZiBuYW1lICE9ICdzdHJpbmcnKSBuYW1lID0gJyc7CiAgaWYobmFtZSA9PSAnJyAmJiBuLm5hbWUpIG5hbWUgPSBuLm5hbWU7CiAgaWYodHlwZW9mIG4gPT0gJ29iamVjdCcgJiYgbiAhPSBudWxsICYmIG4udGFnVXNlZCkgbmFtZSA9IG4udGFnVXNlZCArICcgJyArIG5hbWU7CiAgcmV0dXJuIG5hbWU7Cn0KCmV4cG9ydCBmdW5jdGlvbiogUmF3TG9jYXRpb24ocGF0aCkgewogIGZvcihsZXQgbm9kZSBvZiBIaWVyKHBhdGgpKSB7CiAgICBpZihub2RlLmxvYykgewogICAgICB5aWVsZCBub2RlLmxvYzsKICAgIH0gZWxzZSBpZihub2RlLnJhbmdlKSB7CiAgICAgIHlpZWxkIG5vZGUucmFuZ2UuYmVnaW47CiAgICAgIHlpZWxkIG5vZGUucmFuZ2UuZW5kOwogICAgfQogIH0KfQoKZXhwb3J0IGZ1bmN0aW9uKiBSYXdSYW5nZShwYXRoKSB7CiAgZm9yKGxldCBub2RlIG9mIEhpZXIocGF0aCkpIGlmKG5vZGUucmFuZ2UpIHlpZWxkIG5vZGUucmFuZ2U7Cn0KCmV4cG9ydCBmdW5jdGlvbiBDb21wbGV0ZUxvY2F0aW9uKHBhdGgpIHsKICBsZXQgYSA9IFtdOwogIGZvcihsZXQgcmF3IG9mIFJhd0xvY2F0aW9uKHBhdGgpKSB7CiAgICBhLnB1c2gocmF3KTsKICAgIGlmKHJhdy5maWxlKSBicmVhazsKICB9CiAgaWYoYVswXS5vZmZzZXQpIGEgPSBhLmZpbHRlcihsID0+ICEobC5vZmZzZXQgPiBhWzBdLm9mZnNldCkpOwogIGxldCBsb2MgPSB7fTsKICBmb3IobGV0IHJhdyBvZiBhLnJldmVyc2UoKSkgT2JqZWN0LmFzc2lnbihsb2MsIHJhdyk7CiAgcmV0dXJuIG5ldyBMb2NhdGlvbihsb2MpOwp9CgpleHBvcnQgZnVuY3Rpb24gQ29tcGxldGVSYW5nZShwYXRoKSB7CiAgbGV0IGEgPSBbXTsKICBmb3IobGV0IHJhdyBvZiBSYXdSYW5nZShwYXRoKSkgewogICAgYS5wdXNoKHJhdyk7CiAgfQogIGlmKGFbMF0uYmVnaW4ub2Zmc2V0KSBhID0gYS5maWx0ZXIobCA9PiAhKGwuYmVnaW4ub2Zmc2V0ID4gYVswXS5iZWdpbi5vZmZzZXQpKTsKICBsZXQgcmFuZ2UgPSB7IGJlZ2luOiB7fSwgZW5kOiB7fSB9OwogIGZvcihsZXQgeyBiZWdpbiwgZW5kIH0gb2YgYS5yZXZlcnNlKCkpIHsKICAgIE9iamVjdC5hc3NpZ24ocmFuZ2UuYmVnaW4sIGJlZ2luKTsKICAgIE9iamVjdC5hc3NpZ24ocmFuZ2UuZW5kLCBlbmQpOwogICAgLy9jb25zb2xlLmxvZygnQ29tcGxldGVSYW5nZScscmFuZ2UpCiAgfQogIHJldHVybiBuZXcgUmFuZ2UocmFuZ2UuYmVnaW4sIHJhbmdlLmVuZCk7Cn0KCmV4cG9ydCBmdW5jdGlvbiBHZXRMb2Mobm9kZSkgewogIGxldCBsb2MsIHJldDsKICBpZignbG9jJyBpbiBub2RlKSBsb2MgPSBub2RlLmxvYzsKICBlbHNlIGlmKCdyYW5nZScgaW4gbm9kZSkgbG9jID0gbm9kZS5yYW5nZTsKICBlbHNlIHJldHVybiBudWxsOwogIGlmKCdiZWdpbicgaW4gbG9jKSBsb2MgPSBsb2MuYmVnaW47CiAgaWYoJ2V4cGFuc2lvbkxvYycgaW4gbG9jKSBsb2MgPSBsb2MuZXhwYW5zaW9uTG9jOwoKICAvLyBpZighKCdvZmZzZXQnIGluIGxvYykpIHJldHVybiBudWxsOwoKICByZXQgPSBuZXcgTG9jYXRpb24obG9jKTsKCiAgcmV0dXJuIHJldDsKfQoKLypleHBvcnQgZnVuY3Rpb24gR2V0VHlwZShub2RlLCBhc3QpIHsKICBsZXQgdHlwZSwgZWxhYm9yYXRlZDsKCiAgLy8gIGNvbnNvbGUubG9nKCdHZXRUeXBlJywgbm9kZSk7CgogIGlmKChlbGFib3JhdGVkID0gbm9kZS5pbm5lcj8uZmluZChuID0+IG4ua2luZC5lbmRzV2l0aCgnVHlwZScpKSkpIHsKICAgIGlmKCh0eXBlID0gKGVsYWJvcmF0ZWQuaW5uZXIgPz8gW10pLmZpbmQobiA9PiBuLmRlY2wpKSkgdHlwZSA9IHR5cGUuZGVjbDsKICAgIGVsc2UgdHlwZSA9IGVsYWJvcmF0ZWQub3duZWRUYWdEZWNsOwogICAgaWYodHlwZSkgewogICAgICAvL2NvbnNvbGUubG9nKCdHZXRUeXBlJywgeyB0eXBlLCBpZDogdHlwZS5pZCB9KTsKICAgICAgbGV0IGRlY2xUeXBlID0gYXN0LmlubmVyLmZpbmQobiA9PiBuLmlkID09IHR5cGUuaWQpOwogICAgICBpZighZGVjbFR5cGUpIHRocm93IG5ldyBFcnJvcihgVHlwZSAke3R5cGUuaWR9IG5vdCBmb3VuZGApOwogICAgICB0eXBlID0gZGVjbFR5cGU7CiAgICB9CiAgfSBlbHNlIGlmKG5vZGUub3duZWRUYWdEZWNsKSB7CiAgICB0eXBlID0gbm9kZS5vd25lZFRhZ0RlY2w7CiAgfSBlbHNlIGlmKG5vZGUuaW5uZXIgJiYgbm9kZS5pbm5lci5sZW5ndGggPT0gMSAmJiBub2RlLmlubmVyWzBdLmtpbmQuZW5kc1dpdGgoJ1R5cGUnKSkKICAgIHR5cGUgPSBub2RlLmlubmVyWzBdOwoKICB0eXBlID8/PSBub2RlLnR5cGU7CiAgcmV0dXJuIHR5cGU7Cn0qLwoKZXhwb3J0IGZ1bmN0aW9uIEdldFR5cGVOb2RlKG5vZGUsIGFzdCA9ICQuZGF0YSkgewogIGZvcihsZXQgbiA9IFtub2RlXTsgblswXTsgbiA9IG5bMF0uaW5uZXIpIHsKICAgIGxldCBpOwoKICAgIGlmKChpID0gbi5maW5kKG5vZGUgPT4gL1R5cGUvLnRlc3Qobm9kZS5raW5kKSkpKQogICAgICBpZihpPy5kZWNsPy5pZCkgcmV0dXJuIGFzdC5pbm5lci5maW5kKG5vZGUgPT4gbm9kZS5pZCA9PSBpLmRlY2wuaWQpOwogIH0KfQoKZXhwb3J0IGZ1bmN0aW9uIEdldFR5cGVTdHIobm9kZSkgewogIGxldCB0eXBlOwogIGlmKG5vZGUudHlwZSkgdHlwZSA9IG5vZGUudHlwZTsKICBlbHNlIGlmKCdpbm5lcicgaW4gbm9kZSAmJiBub2RlLmlubmVyLnNvbWUoaW5uZXIgPT4gJ25hbWUnIGluIGlubmVyIHx8ICd0eXBlJyBpbiBpbm5lcikpIHsKICAgIHR5cGUgPSBub2RlLmlubmVyLm1hcChpbm5lciA9PiBbaW5uZXIubmFtZSwgR2V0VHlwZVN0cihpbm5lcildKTsKICAgIHJldHVybiAneyAnICsgdHlwZS5tYXAoKFtuLCB0XSkgPT4gYCR7dH0gJHtufTtgKS5qb2luKCcgJykgKyAnIH0nOwogIH0KICBpZih0eXBlb2YgdHlwZSAhPSAnb2JqZWN0JykgcmV0dXJuIHR5cGU7CgogIGlmKHR5cGUucXVhbFR5cGUpIHR5cGUgPSB0eXBlLnF1YWxUeXBlOwogIHJldHVybiB0eXBlOwp9CgpleHBvcnQgY2xhc3MgTm9kZUVycm9yIGV4dGVuZHMgRXJyb3IgewogIGNvbnN0cnVjdG9yKG1lc3NhZ2UsIG5vZGUpIHsKICAgIHN1cGVyKG1lc3NhZ2UpOwoKICAgIHRoaXMubm9kZSA9IG5vZGU7CiAgfQp9CgpOb2RlRXJyb3IucHJvdG90eXBlW1N5bWJvbC50b1N0cmluZ1RhZ10gPSAnTm9kZUVycm9yJzsKCmV4cG9ydCBmdW5jdGlvbiBOb2RlUHJpbnRlcihhc3QpIHsKICBsZXQgb3V0ID0gJyc7CiAgbGV0IGRlcHRoID0gMDsKICBsZXQgcHJpbnRlcjsKCiAgZnVuY3Rpb24gcHV0KHN0cikgewogICAgb3V0ICs9IChzdHIgPz8gJycpLnJlcGxhY2VBbGwoJ1xuJywgJ1xuJyArICcgICcucmVwZWF0KGRlcHRoKSk7CiAgfQoKICBmdW5jdGlvbiB0cmltKCkgewogICAgb3V0ID0gb3V0LnRyaW1FbmQoKTsKICB9CgogIHByaW50ZXIgPSBmdW5jdGlvbihub2RlKSB7CiAgICBwcmludGVyLm5vZGVQcmludGVyLmFzdCA/Pz0gcHJpbnRlci5hc3Q7CgogICAgLy8gIGNvbnNvbGUubG9nKCdwcmludGVyKCknLCBpbnNwZWN0KHsgbm9kZSB9LCB7IGRlcHRoOiAxIH0pKTsKICAgIHByaW50ZXIucHJpbnQobm9kZSk7CgogICAgcmV0dXJuIHByaW50ZXI7CiAgfTsKICBwcmludGVyLmFzdCA9IGFzdDsKCiAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMocHJpbnRlciwgewogICAgb3V0cHV0OiB7CiAgICAgIGdldCgpIHsKICAgICAgICByZXR1cm4gb3V0OwogICAgICB9CiAgICB9LAogICAgY2xlYXI6IHsKICAgICAgdmFsdWUoKSB7CiAgICAgICAgb3V0ID0gJyc7CiAgICAgIH0KICAgIH0sCiAgICBwdXQ6IHsgdmFsdWU6IHB1dCB9LAoKICAgIHByaW50OiB7CiAgICAgIHZhbHVlKG5vZGUpIHsKICAgICAgICBsZXQgZm4gPSB0aGlzLm5vZGVQcmludGVyW25vZGUua2luZF07CiAgICAgICAgbGV0IG9sZGxlbiA9IG91dC5sZW5ndGg7CiAgICAgICAgaWYoIWZuKSB0aHJvdyAodGhpcy5lcnJvciA9IG5ldyBOb2RlRXJyb3IoYE5vIHN1Y2ggcHJpbnRlciBmb3IgJHtub2RlLmtpbmR9YCwgbm9kZSkpOwogICAgICAgIHRoaXMubm9kZSA9IG5vZGU7CgogICAgICAgIGxldCBzdWNjZXNzID0gZm4uY2FsbCh0aGlzLm5vZGVQcmludGVyLCBub2RlLCB0aGlzLmFzdCk7CgogICAgICAgIGxldCB7IGxvYyB9ID0gbm9kZTsKICAgICAgICAvLyAgbGV0IGxvY2F0aW9uID0gbmV3IExvY2F0aW9uKG5vZGUpOwoKICAgICAgICBpZihsb2M/LmxpbmUgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgY29uc3QgeyBsaW5lLCBjb2x1bW4gfSA9IGxvYzsKICAgICAgICAgIHRoaXMubG9jID0gewogICAgICAgICAgICBsaW5lLAogICAgICAgICAgICBjb2x1bW4sCiAgICAgICAgICAgIHRvU3RyaW5nKCkgewogICAgICAgICAgICAgIHJldHVybiBbbGluZSwgY29sdW1uXS5maWx0ZXIoaSA9PiBpKS5qb2luKCc6Jyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAgIGlmKG91dC5sZW5ndGggPT0gb2xkbGVuKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhgcHJpbnRlciBlcnJvciBhdCAke2xvY31gLCBub2RlKTsKICAgICAgICAgIHRocm93ICh0aGlzLmVycm9yID0gbmV3IE5vZGVFcnJvcihgTm9kZSBwcmludGVyIGZvciAke25vZGUua2luZH0gKCR7dGhpcy5sb2N9KSBmYWlsZWRcbmAsIG5vZGUpKTsKICAgICAgICB9CiAgICAgICAgLy8gZWxzZSBjb25zb2xlLmxvZygnb3V0OicsIG91dCk7CiAgICAgICAgcmV0dXJuIG91dDsKICAgICAgfQogICAgfSwKCiAgICBub2RlUHJpbnRlcjogewogICAgICB2YWx1ZTogbmV3IChjbGFzcyBOb2RlUHJpbnRlciB7CiAgICAgICAgQWJpVGFnQXR0cihhYmlfdGFnX2F0dHIpIHsKICAgICAgICAgIHB1dCgnX19hdHRyaWJ1dGVfXygoX19hYmlfdGFnX18pKScpOwogICAgICAgIH0KICAgICAgICBBY2Nlc3NTcGVjRGVjbChhY2Nlc3Nfc3BlY19kZWNsKSB7CiAgICAgICAgICBjb25zdCB7IGFjY2VzcyB9ID0gYWNjZXNzX3NwZWNfZGVjbDsKICAgICAgICAgIC8vY29uc29sZS5sb2coIkFjY2Vzc1NwZWNEZWNsIixhY2Nlc3Nfc3BlY19kZWNsKQogICAgICAgICAgcHV0KGFjY2VzcyArICc6Jyk7CiAgICAgICAgfQogICAgICAgIEFsaWduZWRBdHRyKGFsaWduZWRfYXR0cikgewogICAgICAgICAgcHV0KCdfX2F0dHJpYnV0ZV9fKChhbGlnbmVkKSknKTsKICAgICAgICB9CiAgICAgICAgQWx3YXlzSW5saW5lQXR0cihhbHdheXNfaW5saW5lX2F0dHIpIHsKICAgICAgICAgIHB1dCgnX19hdHRyaWJ1dGVfXygoYWx3YXlzX2lubGluZSkpJyk7CiAgICAgICAgfQogICAgICAgIEFycmF5U3Vic2NyaXB0RXhwcihhcnJheV9zdWJzY3JpcHRfZXhwcikgewogICAgICAgICAgY29uc3QgeyB2YWx1ZUNhdGVnb3J5IH0gPSBhcnJheV9zdWJzY3JpcHRfZXhwcjsKICAgICAgICAgIGNvbnN0IFthcnJheSwgc3Vic2NyaXB0XSA9IGFycmF5X3N1YnNjcmlwdF9leHByLmlubmVyOwogICAgICAgICAgcHJpbnRlci5wcmludChhcnJheSk7CiAgICAgICAgICBwdXQoJ1snKTsKICAgICAgICAgIHByaW50ZXIucHJpbnQoc3Vic2NyaXB0KTsKICAgICAgICAgIHB1dCgnXScpOwogICAgICAgIH0KICAgICAgICBBc21MYWJlbEF0dHIoYXNtX2xhYmVsX2F0dHIpIHsKICAgICAgICAgIHB1dCgnX19hc21fXycpOwogICAgICAgIH0KICAgICAgICBCaW5hcnlPcGVyYXRvcihiaW5hcnlfb3BlcmF0b3IpIHsKICAgICAgICAgIGNvbnN0IHsgdmFsdWVDYXRlZ29yeSwgb3Bjb2RlIH0gPSBiaW5hcnlfb3BlcmF0b3I7CiAgICAgICAgICBsZXQgW2xlZnQsIHJpZ2h0XSA9IGJpbmFyeV9vcGVyYXRvci5pbm5lcjsKCiAgICAgICAgICBwcmludGVyLnByaW50KGxlZnQpOwogICAgICAgICAgcHV0KGAgJHtvcGNvZGV9IGApOwogICAgICAgICAgcHJpbnRlci5wcmludChyaWdodCk7CiAgICAgICAgfQogICAgICAgIEJsb2NrQ29tbWFuZENvbW1lbnQoYmxvY2tfY29tbWFuZF9jb21tZW50KSB7CiAgICAgICAgICBjb25zdCB7IG5hbWUgfSA9IGJsb2NrX2NvbW1hbmRfY29tbWVudDsKCiAgICAgICAgICBwdXQoYFxcJHtuYW1lfWApOwogICAgICAgICAgZm9yKGxldCBpbm5lciBvZiBibG9ja19jb21tYW5kX2NvbW1lbnQuaW5uZXIpIHByaW50ZXIucHJpbnQoaW5uZXIpOwoKICAgICAgICAgIC8vICAgIHRyaW0oKTsKICAgICAgICB9CiAgICAgICAgQnVpbHRpbkF0dHIoYnVpbHRpbl9hdHRyKSB7CiAgICAgICAgICBjb25zdCB7IGltcGxpY2l0IH0gPSBidWlsdGluX2F0dHI7CiAgICAgICAgICAvL2NvbnNvbGUubG9nKCdCdWlsdGluQXR0cicsIGJ1aWx0aW5fYXR0cik7CiAgICAgICAgICBwdXQoYC8qKipCdWlsdGluQXR0cioqKi9gKTsKICAgICAgICB9CiAgICAgICAgQnJlYWtTdG10KGJyZWFrX3N0bXQpIHsKICAgICAgICAgIHB1dCgnYnJlYWsnKTsKICAgICAgICB9CiAgICAgICAgQ2FsbEV4cHIoY2FsbF9leHByKSB7CiAgICAgICAgICAvL2NvbnNvbGUubG9nKCdDYWxsRXhwcicsIGNhbGxfZXhwcik7CiAgICAgICAgICBsZXQgW2Z1bmMsIC4uLmFyZ3NdID0gY2FsbF9leHByLmlubmVyID8/IFtdOwoKICAgICAgICAgIHByaW50ZXIucHJpbnQoZnVuYyk7CgogICAgICAgICAgcHV0KCcoJyk7CiAgICAgICAgICBsZXQgaSA9IDA7CiAgICAgICAgICBmb3IobGV0IGlubmVyIG9mIGFyZ3MpIHsKICAgICAgICAgICAgaWYoaSsrID4gMCkgcHV0KCcsICcpOwogICAgICAgICAgICBwcmludGVyLnByaW50KGlubmVyKTsKICAgICAgICAgIH0KICAgICAgICAgIHB1dCgnKScpOwogICAgICAgIH0KICAgICAgICBSZWNvdmVyeUV4cHIocmVjb3ZlcnlfZXhwcikgewogICAgICAgICAgcmV0dXJuIHRoaXMuQ2FsbEV4cHIocmVjb3ZlcnlfZXhwcik7CiAgICAgICAgfQogICAgICAgIENhc2VTdG10KGNhc2Vfc3RtdCkgewogICAgICAgICAgcHV0KGBjYXNlIGApOwogICAgICAgICAgY29uc3QgW3ZhbHVlLCAuLi5yZXN0XSA9IGNhc2Vfc3RtdC5pbm5lcjsKCiAgICAgICAgICBwcmludGVyLnByaW50KHZhbHVlKTsKICAgICAgICAgIHB1dCgnOiAnKTsKICAgICAgICAgIGZvcihsZXQgbm9kZSBvZiByZXN0KSBwcmludGVyLnByaW50KG5vZGUpOwogICAgICAgIH0KICAgICAgICBDaGFyYWN0ZXJMaXRlcmFsKGNoYXJhY3Rlcl9saXRlcmFsKSB7CiAgICAgICAgICBjb25zdCB7IHZhbHVlIH0gPSBjaGFyYWN0ZXJfbGl0ZXJhbDsKICAgICAgICAgIHB1dChgJyR7U3RyaW5nLmZyb21DaGFyQ29kZSh2YWx1ZSl9J2ApOwogICAgICAgIH0KICAgICAgICBDb21wb3VuZEFzc2lnbk9wZXJhdG9yKGNvbXBvdW5kX2Fzc2lnbl9vcGVyYXRvcikgewogICAgICAgICAgY29uc3QgeyB2YWx1ZUNhdGVnb3J5LCBvcGNvZGUgfSA9IGNvbXBvdW5kX2Fzc2lnbl9vcGVyYXRvcjsKICAgICAgICAgIGxldCBbbGVmdCwgcmlnaHRdID0gY29tcG91bmRfYXNzaWduX29wZXJhdG9yLmlubmVyOwogICAgICAgICAgcHJpbnRlci5wcmludChsZWZ0KTsKICAgICAgICAgIHB1dChgICR7b3Bjb2RlfSBgKTsKICAgICAgICAgIHByaW50ZXIucHJpbnQocmlnaHQpOwogICAgICAgIH0KICAgICAgICBDb21wb3VuZFN0bXQoY29tcG91bmRfc3RtdCkgewogICAgICAgICAgZGVwdGgrKzsKICAgICAgICAgIHB1dCgneycpOwogICAgICAgICAgbGV0IGkgPSAwOwogICAgICAgICAgbGV0IG9mZnNldCA9IG91dC5sZW5ndGg7CiAgICAgICAgICBpZihjb21wb3VuZF9zdG10Py5pbm5lcj8ubGVuZ3RoKSBwdXQoJ1xuJyk7CgogICAgICAgICAgZm9yKGxldCBpbm5lciBvZiBjb21wb3VuZF9zdG10LmlubmVyID8/IFtdKSB7CiAgICAgICAgICAgIGlmKGkrKyA+IDApIHB1dCgnfTsgXHRcbicuaW5kZXhPZihvdXRbb3V0Lmxlbmd0aCAtIDFdKSAhPSAtMSA/ICdcbicgOiAnO1xuJyk7CiAgICAgICAgICAgIHByaW50ZXIucHJpbnQoaW5uZXIpOwogICAgICAgICAgfQogICAgICAgICAgLy9jb25zb2xlLmxvZygnQ29tcG91bmRTdG10JywgeyBvdXQgfSk7CiAgICAgICAgICBpZihvdXQubGVuZ3RoID4gb2Zmc2V0ICYmIG91dFtvdXQubGVuZ3RoIC0gMV0gIT0gJzsnKSBwdXQoJzsnKTsKICAgICAgICAgIGRlcHRoLS07CiAgICAgICAgICAvL2lmKG91dC5sZW5ndGggPiBvZmZzZXQpCiAgICAgICAgICBpZihjb21wb3VuZF9zdG10Py5pbm5lcj8ubGVuZ3RoKSBwdXQoJ1xuJyk7CiAgICAgICAgICBwdXQoJ31cbicpOwogICAgICAgIH0KICAgICAgICBDb25kaXRpb25hbE9wZXJhdG9yKGNvbmRpdGlvbmFsX29wZXJhdG9yKSB7CiAgICAgICAgICBjb25zdCBbY29uZCwgaWZfdHJ1ZSwgaWZfZmFsc2VdID0gY29uZGl0aW9uYWxfb3BlcmF0b3IuaW5uZXI7CgogICAgICAgICAgcHJpbnRlci5wcmludChjb25kKTsKICAgICAgICAgIHB1dCgnID8gJyk7CiAgICAgICAgICBwcmludGVyLnByaW50KGlmX3RydWUpOwogICAgICAgICAgcHV0KCcgOiAnKTsKICAgICAgICAgIHByaW50ZXIucHJpbnQoaWZfZmFsc2UpOwogICAgICAgIH0KICAgICAgICBDb25zdGFudEV4cHIoY29uc3RhbnRfZXhwcikgewogICAgICAgICAgY29uc3QgeyB2YWx1ZUNhdGVnb3J5IH0gPSBjb25zdGFudF9leHByOwoKICAgICAgICAgIGZvcihsZXQgaW5uZXIgb2YgY29uc3RhbnRfZXhwci5pbm5lcikgcHJpbnRlci5wcmludChpbm5lcik7CiAgICAgICAgfQogICAgICAgIENvbnN0QXR0cihjb25zdF9hdHRyKSB7CiAgICAgICAgICBwdXQoJ19fYXR0cmlidXRlX18oKGNvbnN0KScpOwogICAgICAgIH0KICAgICAgICBDb250aW51ZVN0bXQoY29udGludWVfc3RtdCkgewogICAgICAgICAgcHV0KCdicmVhaycpOwogICAgICAgIH0KICAgICAgICBDU3R5bGVDYXN0RXhwcihjc3R5bGVfY2FzdF9leHByKSB7CiAgICAgICAgICBsZXQgdHlwZSA9IG5ldyBUeXBlKGNzdHlsZV9jYXN0X2V4cHIudHlwZSwgdGhpcy5hc3QpOwogICAgICAgICAgY29uc3QgeyB2YWx1ZUNhdGVnb3J5LCBjYXN0S2luZCB9ID0gY3N0eWxlX2Nhc3RfZXhwcjsKICAgICAgICAgIHB1dChgKCR7dHlwZX0pYCk7CiAgICAgICAgICBmb3IobGV0IGlubmVyIG9mIGNzdHlsZV9jYXN0X2V4cHIuaW5uZXIpIHByaW50ZXIucHJpbnQoaW5uZXIpOwogICAgICAgIH0KICAgICAgICBEZWNsUmVmRXhwcihkZWNsX3JlZl9leHByKSB7CiAgICAgICAgICBjb25zdCB7IHR5cGUsIHZhbHVlQ2F0ZWdvcnksIHJlZmVyZW5jZWREZWNsIH0gPSBkZWNsX3JlZl9leHByOwogICAgICAgICAgcHV0KHJlZmVyZW5jZWREZWNsLm5hbWUgPz8gJzxEZWNsUmVmRXhwcj4nKTsKCiAgICAgICAgICAvLyBwcmludGVyLnByaW50KHJlZmVyZW5jZWREZWNsKTsKICAgICAgICB9CiAgICAgICAgRGVjbFN0bXQoZGVjbF9zdG10KSB7CiAgICAgICAgICBsZXQgaSA9IDA7CiAgICAgICAgICBsZXQgdHlwZSwgYmFzZVR5cGU7CiAgICAgICAgICBmb3IobGV0IGlubmVyIG9mIGRlY2xfc3RtdC5pbm5lcikgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGlmKCF0eXBlICYmIGlubmVyLnR5cGUpIHsKICAgICAgICAgICAgICAgIHR5cGUgPSBuZXcgVHlwZShpbm5lci50eXBlLCB0aGlzLmFzdCk7CiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCd0eXBlOicsIHR5cGUpOwogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygndHlwZS50eXBlQWxpYXM6JywgdHlwZS50eXBlQWxpYXMpOwogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygndHlwZS50cmltU3Vic2NyaXB0cygpOicsIHR5cGUudHJpbVN1YnNjcmlwdHMoKSk7CiAgICAgICAgICAgICAgICBiYXNlVHlwZSA9IHR5cGUudHJpbVN1YnNjcmlwdHMoKSA/PyB0eXBlLnF1YWxUeXBlOwogICAgICAgICAgICAgICAgcHV0KGAke2Jhc2VUeXBlfSBgKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2goZXJyKSB7fQogICAgICAgICAgICBpZihpKysgPiAwKSBwdXQoJywgJyk7CiAgICAgICAgICAgIHByaW50ZXIucHJpbnQoaW5uZXIsIGJhc2VUeXBlKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgRGVmYXVsdFN0bXQoZGVmYXVsdF9zdG10KSB7CiAgICAgICAgICBwdXQoJ2RlZmF1bHQ6Jyk7CiAgICAgICAgfQogICAgICAgIERlcHJlY2F0ZWRBdHRyKGRlcHJlY2F0ZWRfYXR0cikgewogICAgICAgICAgcHV0KCdfX2F0dHJpYnV0ZV9fKChkZXByZWNhdGVkKSknKTsKICAgICAgICB9CiAgICAgICAgRG9TdG10KGRvX3N0bXQpIHsKICAgICAgICAgIGxldCBbYm9keSwgY29uZF0gPSBkb19zdG10LmlubmVyOwogICAgICAgICAgcHV0KGBkbyBgKTsKICAgICAgICAgIHByaW50ZXIucHJpbnQoYm9keSk7CiAgICAgICAgICBwdXQoYCB3aGlsZShgKTsKICAgICAgICAgIHByaW50ZXIucHJpbnQoY29uZCk7CiAgICAgICAgICBwdXQoYClgKTsKICAgICAgICB9CiAgICAgICAgRW1wdHlEZWNsKGVtcHR5X2RlY2wpIHsKICAgICAgICAgIHB1dCgnXG4nKTsKICAgICAgICAgIC8vIGlmKCc7fScuaW5kZXhPZihvdXRbb3V0Lmxlbmd0aCAtIDFdID8/ICdcbicpID09IC0xKSBwdXQoJzsnKTsKICAgICAgICB9CiAgICAgICAgRW51bUNvbnN0YW50RGVjbChlbnVtX2NvbnN0YW50X2RlY2wpIHsKICAgICAgICAgIGNvbnN0IHsgbmFtZSwgaW5uZXIgfSA9IGVudW1fY29uc3RhbnRfZGVjbDsKICAgICAgICAgIGxldCB2YWx1ZSA9IGlubmVyWzBdOwogICAgICAgICAgcHV0KG5hbWUpOwogICAgICAgICAgaWYodmFsdWUpIHsKICAgICAgICAgICAgcHV0KCcgPSAnKTsKICAgICAgICAgICAgcHJpbnRlci5wcmludCh2YWx1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIEVudW1EZWNsKGVudW1fZGVjbCkgewogICAgICAgICAgY29uc3QgeyBuYW1lIH0gPSBlbnVtX2RlY2w7CiAgICAgICAgICAvL2NvbnNvbGUubG9nKCdSZWNvcmREZWNsJywgcmVjb3JkX2RlY2wpOwogICAgICAgICAgcHV0KCdlbnVtJyk7CiAgICAgICAgICBpZihuYW1lKSB7CiAgICAgICAgICAgIHB1dCgnICcpOwogICAgICAgICAgICBwdXQobmFtZSk7CiAgICAgICAgICB9CiAgICAgICAgICBwdXQoJyAnKTsKICAgICAgICAgIHB1dCgne1xuJyk7CiAgICAgICAgICBsZXQgaSA9IDA7CiAgICAgICAgICBmb3IobGV0IGZpZWxkIG9mIGVudW1fZGVjbC5pbm5lciA/PyBbXSkgewogICAgICAgICAgICBwcmludGVyLnByaW50KGZpZWxkLCB0aGlzLmFzdCk7CiAgICAgICAgICB9CiAgICAgICAgICBwdXQoJ307Jyk7CiAgICAgICAgfQogICAgICAgIEZpZWxkRGVjbChmaWVsZF9kZWNsKSB7CiAgICAgICAgICBsZXQgeyBpc1JlZmVyZW5jZWQsIG5hbWUgfSA9IGZpZWxkX2RlY2w7CiAgICAgICAgICBsZXQgdHlwZSA9IG5ldyBUeXBlKGZpZWxkX2RlY2wudHlwZSwgdGhpcy5hc3QpOwogICAgICAgICAgcHV0KHR5cGUgKyAnJyk7CiAgICAgICAgICBwdXQoJyAnKTsKICAgICAgICAgIHB1dChuYW1lKTsKICAgICAgICAgIHB1dCgnOycpOwogICAgICAgIH0KICAgICAgICBGbG9hdGluZ0xpdGVyYWwoZmxvYXRpbmdfbGl0ZXJhbCkgewogICAgICAgICAgcHV0KGZsb2F0aW5nX2xpdGVyYWwudmFsdWUpOwogICAgICAgIH0KICAgICAgICBGb3JtYXRBdHRyKGZvcm1hdF9hdHRyKSB7CiAgICAgICAgICBwdXQoJ19fYXR0cmlidXRlX18oKGZvcm1hdCkpJyk7CiAgICAgICAgfQogICAgICAgIEZvclN0bXQoZm9yX3N0bXQpIHsKICAgICAgICAgIGxldCBpbm5lciA9IFsuLi5mb3Jfc3RtdC5pbm5lcl07CiAgICAgICAgICBsZXQgYm9keSA9IGlubmVyLnBvcCgpOwogICAgICAgICAgbGV0IG51bUluaXQgPSBpbm5lci5maW5kSW5kZXgobiA9PiBuLmtpbmQgPT0gdW5kZWZpbmVkKTsKICAgICAgICAgIGxldCBpbml0ID0gaW5uZXIuc3BsaWNlKDAsIG51bUluaXQpOwogICAgICAgICAgaWYoaW5uZXIubGVuZ3RoICYmIGlubmVyW2lubmVyLmxlbmd0aCAtIDFdLmtpbmQgPT0gdW5kZWZpbmVkKSBpbm5lci5wb3AoKTsKICAgICAgICAgIGxldCBpbmNyID0gaW5uZXIucG9wKCk7CiAgICAgICAgICBsZXQgY29uZCA9IGlubmVyLnBvcCgpOwogICAgICAgICAgLy9jb25zb2xlLmxvZygnRm9yU3RtdCcsIGNvbnNvbGUuY29uZmlnKHtkZXB0aDogNCwgY29tcGFjdDogZmFsc2UsIG1heEFycmF5TGVuZ3RoOiA1LCBoaWRlS2V5czogWydyYW5nZScsICdsb2MnXSB9KSwgeyBib2R5LCBpbml0LCBjb25kLCBpbmNyIH0pOwogICAgICAgICAgcHV0KCdmb3IoJyk7CiAgICAgICAgICBsZXQgaSA9IDA7CiAgICAgICAgICBmb3IobGV0IG4gb2YgaW5pdCkgewogICAgICAgICAgICBpZihpKysgPiAwKSBwdXQoJywgJyk7CiAgICAgICAgICAgIHByaW50ZXIucHJpbnQobik7CiAgICAgICAgICB9CiAgICAgICAgICBwdXQoJzsnKTsKICAgICAgICAgIGlmKGNvbmQua2luZCkgewogICAgICAgICAgICBwdXQoJyAnKTsKICAgICAgICAgICAgcHJpbnRlci5wcmludChjb25kKTsKICAgICAgICAgIH0KICAgICAgICAgIHB1dCgnOycpOwogICAgICAgICAgaWYoaW5jci5raW5kKSB7CiAgICAgICAgICAgIHB1dCgnICcpOwogICAgICAgICAgICBwcmludGVyLnByaW50KGluY3IpOwogICAgICAgICAgfQogICAgICAgICAgcHV0KCcpICcpOwogICAgICAgICAgcHJpbnRlci5wcmludChib2R5KTsKICAgICAgICB9CiAgICAgICAgRnVsbENvbW1lbnQoZnVsbF9jb21tZW50KSB7CiAgICAgICAgICBwdXQoJy8qJyk7CgogICAgICAgICAgZm9yKGxldCBpbm5lciBvZiBmdWxsX2NvbW1lbnQuaW5uZXIpIHsKICAgICAgICAgICAgcHJpbnRlci5wcmludChpbm5lcik7CiAgICAgICAgICAgIC8vICBwdXQoJ1xuJyk7CiAgICAgICAgICB9CiAgICAgICAgICBwdXQoJyovJyk7CiAgICAgICAgICBwdXQoJ1xuJyk7CiAgICAgICAgfQogICAgICAgIEZ1bmN0aW9uRGVjbChmdW5jdGlvbl9kZWNsKSB7CiAgICAgICAgICBjb25zdCB7IHN0b3JhZ2VDbGFzcywgbWFuZ2xlZE5hbWUsIGlzSW1wbGljaXQsIGlzVXNlZCB9ID0gZnVuY3Rpb25fZGVjbDsKICAgICAgICAgIGxldCBpID0gMDsKICAgICAgICAgIGlmKHN0b3JhZ2VDbGFzcykgcHV0KHN0b3JhZ2VDbGFzcyArICcgJyk7CiAgICAgICAgICBsZXQgbm9kZSA9IG5ldyBGdW5jdGlvbkRlY2woZnVuY3Rpb25fZGVjbCwgdGhpcy5hc3QpOwogICAgICAgICAgLy9jb25zb2xlLmxvZygnRnVuY3Rpb25EZWNsJywgbm9kZS5yZXR1cm5UeXBlKTsKICAgICAgICAgIGxldCByZXR1cm5UeXBlID0gbm9kZS5yZXR1cm5UeXBlOwogICAgICAgICAgcHV0KHJldHVyblR5cGUgKyAnXG4nICsgZnVuY3Rpb25fZGVjbC5uYW1lICsgJygnKTsKICAgICAgICAgIGkgPSAwOwogICAgICAgICAgZm9yKGxldCBpbm5lciBvZiAoZnVuY3Rpb25fZGVjbC5pbm5lciA/PyBbXSkuZmlsdGVyKG4gPT4gbi5raW5kID09ICdQYXJtVmFyRGVjbCcpKSB7CiAgICAgICAgICAgIGlmKGkrKyA+IDApIHB1dCgnLCAnKTsKICAgICAgICAgICAgcHJpbnRlci5wcmludChpbm5lcik7CiAgICAgICAgICB9CiAgICAgICAgICBwdXQoJykgJyk7CiAgICAgICAgICBpID0gMDsKICAgICAgICAgIGZvcihsZXQgaW5uZXIgb2YgKGZ1bmN0aW9uX2RlY2wuaW5uZXIgPz8gW10pLmZpbHRlcigKICAgICAgICAgICAgbiA9PiBuLmtpbmQgIT0gJ1Bhcm1WYXJEZWNsJyAmJiAhL0NvbW1lbnQvLnRlc3Qobi5raW5kKQogICAgICAgICAgKSkgewogICAgICAgICAgICBpZihpKysgPiAwKSBwdXQoJyAnKTsKICAgICAgICAgICAgcHJpbnRlci5wcmludChpbm5lcik7CiAgICAgICAgICB9CiAgICAgICAgICAvLyBwdXQoJycpOwogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIEdvdG9TdG10KGdvdG9fc3RtdCkgewogICAgICAgICAgY29uc3QgeyB0YXJnZXRMYWJlbERlY2xJZCB9ID0gZ290b19zdG10OwoKICAgICAgICAgIGxldCB0YXJnZXQgPSBkZWVwLmZpbmQodGhpcy5hc3QsIG4gPT4gdHlwZW9mIG4gPT0gJ29iamVjdCcgJiYgbiAmJiBuLmRlY2xJZCA9PSB0YXJnZXRMYWJlbERlY2xJZCk/LnZhbHVlOwogICAgICAgICAgY29uc3QgeyBuYW1lIH0gPSB0YXJnZXQ7CgogICAgICAgICAgcHV0KGBnb3RvICR7bmFtZX1gKTsKICAgICAgICB9CiAgICAgICAgSFRNTEVuZFRhZ0NvbW1lbnQoaHRtbF9lbmRfdGFnX2NvbW1lbnQpIHsKICAgICAgICAgIGNvbnN0IHsgbmFtZSB9ID0gaHRtbF9lbmRfdGFnX2NvbW1lbnQ7CiAgICAgICAgICBwdXQoYDwvJHtuYW1lfT5gKTsKICAgICAgICB9CiAgICAgICAgSFRNTFN0YXJ0VGFnQ29tbWVudChodG1sX3N0YXJ0X3RhZ19jb21tZW50KSB7CiAgICAgICAgICBjb25zdCB7IG5hbWUsIGF0dHJzIH0gPSBodG1sX3N0YXJ0X3RhZ19jb21tZW50OwoKICAgICAgICAgIHB1dChgPCR7bmFtZX1gKTsKCiAgICAgICAgICBmb3IobGV0IFtrLCB2XSBvZiBhdHRycykgewogICAgICAgICAgICBwdXQoYCAke2t9PSIke3Z9ImApOwogICAgICAgICAgfQogICAgICAgICAgcHV0KGA+YCk7CiAgICAgICAgfQogICAgICAgIElmU3RtdChpZl9zdG10KSB7CiAgICAgICAgICBsZXQgW2NvbmQsIGJvZHldID0gaWZfc3RtdC5pbm5lcjsKICAgICAgICAgIHB1dChgaWYoYCk7CiAgICAgICAgICBwcmludGVyLnByaW50KGNvbmQpOwogICAgICAgICAgcHV0KGApIGApOwogICAgICAgICAgcHJpbnRlci5wcmludChib2R5KTsKICAgICAgICB9CiAgICAgICAgSW1wbGljaXRDYXN0RXhwcihpbXBsaWNpdF9jYXN0X2V4cHIpIHsKICAgICAgICAgIGZvcihsZXQgaW5uZXIgb2YgaW1wbGljaXRfY2FzdF9leHByLmlubmVyKSBwcmludGVyLnByaW50KGlubmVyKTsKICAgICAgICB9CiAgICAgICAgSW5pdExpc3RFeHByKGluaXRfbGlzdF9leHByKSB7CiAgICAgICAgICBjb25zdCB7IHZhbHVlQ2F0ZWdvcnkgfSA9IGluaXRfbGlzdF9leHByOwoKICAgICAgICAgIHB1dCgneyAnKTsKICAgICAgICAgIGxldCBpID0gMDsKICAgICAgICAgIGZvcihsZXQgaW5uZXIgb2YgaW5pdF9saXN0X2V4cHIuaW5uZXIpIHsKICAgICAgICAgICAgaWYoaSsrID4gMCkgcHV0KCcsICcpOwoKICAgICAgICAgICAgcHJpbnRlci5wcmludChpbm5lcik7CiAgICAgICAgICB9CiAgICAgICAgICBwdXQoJyB9Jyk7CiAgICAgICAgfQogICAgICAgIElubGluZUNvbW1hbmRDb21tZW50KGlubGluZV9jb21tYW5kX2NvbW1lbnQpIHsKICAgICAgICAgIHB1dCgnIElubGluZUNvbW1hbmRDb21tZW50ICcpOwogICAgICAgIH0KICAgICAgICBJbnRlZ2VyTGl0ZXJhbChpbnRlZ2VyX2xpdGVyYWwpIHsKICAgICAgICAgIHB1dChpbnRlZ2VyX2xpdGVyYWwudmFsdWUpOwogICAgICAgIH0KICAgICAgICBMYWJlbFN0bXQobGFiZWxfc3RtdCkgewogICAgICAgICAgcHV0KGAke2xhYmVsX3N0bXQubmFtZX06YCk7CiAgICAgICAgfQogICAgICAgIE1lbWJlckV4cHIobWVtYmVyX2V4cHIpIHsKICAgICAgICAgIGNvbnN0IHsgdmFsdWVDYXRlZ29yeSwgbmFtZSwgaXNBcnJheSwgcmVmZXJlbmNlZE1lbWJlckRlY2wgfSA9IG1lbWJlcl9leHByOwogICAgICAgICAgLypjb25zdCB7IHJlZmVyZW5jZWREZWNsIH0gPSBtZW1iZXJfZXhwci5pbm5lclswXTsKICAgICAgICBwdXQocmVmZXJlbmNlZERlY2wubmFtZSk7Ki8KICAgICAgICAgIGZvcihsZXQgaW5uZXIgb2YgbWVtYmVyX2V4cHIuaW5uZXIpIHsKICAgICAgICAgICAgbGV0IHR5cGUgPSBuZXcgVHlwZShpbm5lci50eXBlLCB0aGlzLmFzdCk7CgogICAgICAgICAgICBwcmludGVyLnByaW50KGlubmVyKTsKICAgICAgICAgICAgcHV0KHR5cGUuaXNQb2ludGVyKCkgPyAnLT4nIDogJy4nKTsKICAgICAgICAgIH0KICAgICAgICAgIHB1dChuYW1lKTsKICAgICAgICB9CiAgICAgICAgTm9uTnVsbEF0dHIobm9uX251bGxfYXR0cikgewogICAgICAgICAgcHV0KCdfX2F0dHJpYnV0ZV9fKChfX25vbm51bGxfXykpJyk7CiAgICAgICAgfQogICAgICAgIE5vVGhyb3dBdHRyKG5vX3Rocm93X2F0dHIpIHsKICAgICAgICAgIHB1dCgnX19hdHRyaWJ1dGVfXygobm90aHJvdykpJyk7CiAgICAgICAgfQogICAgICAgIE51bGxTdG10KG51bGxfc3RtdCkgewogICAgICAgICAgcHV0KCc7Jyk7CiAgICAgICAgfQoKICAgICAgICBQYXJhZ3JhcGhDb21tZW50KHBhcmFncmFwaF9jb21tZW50KSB7CiAgICAgICAgICBmb3IobGV0IGlubmVyIG9mIHBhcmFncmFwaF9jb21tZW50LmlubmVyKSB7CiAgICAgICAgICAgIHByaW50ZXIucHJpbnQoaW5uZXIpOwogICAgICAgICAgICAvLyAgICAgICBwdXQoJ1xuJyk7CiAgICAgICAgICB9CiAgICAgICAgICBwdXQoJ1xuJyk7CiAgICAgICAgfQogICAgICAgIFBhcmFtQ29tbWFuZENvbW1lbnQocGFyYW1fY29tbWFuZF9jb21tZW50KSB7CiAgICAgICAgICBjb25zdCB7IHBhcmFtIH0gPSBwYXJhbV9jb21tYW5kX2NvbW1lbnQ7CiAgICAgICAgICBwdXQoYFxccGFyYW0gJHtwYXJhbX1gKTsKICAgICAgICAgIGZvcihsZXQgaW5uZXIgb2YgcGFyYW1fY29tbWFuZF9jb21tZW50LmlubmVyKSBwcmludGVyLnByaW50KGlubmVyKTsKICAgICAgICB9CiAgICAgICAgUGFyZW5FeHByKHBhcmVuX2V4cHIpIHsKICAgICAgICAgIGNvbnN0IHsgdmFsdWVDYXRlZ29yeSB9ID0gcGFyZW5fZXhwcjsKICAgICAgICAgIHB1dCgnKCcpOwogICAgICAgICAgZm9yKGxldCBpbm5lciBvZiBwYXJlbl9leHByLmlubmVyKSBwcmludGVyLnByaW50KGlubmVyKTsKICAgICAgICAgIHB1dCgnKScpOwogICAgICAgIH0KICAgICAgICBQYXJlbkxpc3RFeHByKHBhcmVuX2xpc3RfZXhwcikgewogICAgICAgICAgY29uc3QgeyB0eXBlLCB2YWx1ZUNhdGVnb3J5IH0gPSBwYXJlbl9saXN0X2V4cHI7CgogICAgICAgICAgcHV0KGAoYCk7CgogICAgICAgICAgaWYocGFyZW5fbGlzdF9leHByLmlubmVyKSBmb3IobGV0IGlubmVyIG9mIHBhcmVuX2xpc3RfZXhwci5pbm5lcikgcHJpbnRlci5wcmludChpbm5lcik7CiAgICAgICAgICBwdXQoYClgKTsKICAgICAgICB9CiAgICAgICAgUGFybVZhckRlY2wocGFybV92YXJfZGVjbCkgewogICAgICAgICAgbGV0IHsKICAgICAgICAgICAgbmFtZSwKICAgICAgICAgICAgdHlwZTogeyBxdWFsVHlwZTogdHlwZSB9CiAgICAgICAgICB9ID0gcGFybV92YXJfZGVjbDsKCiAgICAgICAgICBwdXQoKHR5cGUgKyAnJykucmVwbGFjZSgvXHMrXCovZywgJyonKSk7CgogICAgICAgICAgaWYobmFtZSkgewogICAgICAgICAgICBpZihvdXRbb3V0Lmxlbmd0aCAtIDFdICE9ICcgJykgcHV0KCcgJyk7CiAgICAgICAgICAgIHB1dChuYW1lKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZihwYXJtX3Zhcl9kZWNsLmlubmVyKSB7CiAgICAgICAgICAgIHB1dChgID0gYCk7CiAgICAgICAgICAgIGZvcihsZXQgaW5uZXIgb2YgcGFybV92YXJfZGVjbC5pbm5lcikgcHJpbnRlci5wcmludChpbm5lcik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIFB1cmVBdHRyKHB1cmVfYXR0cikgewogICAgICAgICAgcHV0KCdfX2F0dHJpYnV0ZV9fKChwdXJlKSknKTsKICAgICAgICB9CiAgICAgICAgUmVjb3JkRGVjbChyZWNvcmRfZGVjbCkgewogICAgICAgICAgY29uc3QgeyB0YWdVc2VkLCBuYW1lLCBjb21wbGV0ZURlZmluaXRpb24sIHBhcmVudERlY2xDb250ZXh0SWQgfSA9IHJlY29yZF9kZWNsOwogICAgICAgICAgLy9jb25zb2xlLmxvZygnUmVjb3JkRGVjbCcsIHJlY29yZF9kZWNsKTsKICAgICAgICAgIHB1dCh0YWdVc2VkKTsKICAgICAgICAgIGlmKG5hbWUpIHsKICAgICAgICAgICAgcHV0KCcgJyk7CiAgICAgICAgICAgIHB1dChuYW1lKTsKICAgICAgICAgIH0KICAgICAgICAgIHB1dCgnICcpOwoKICAgICAgICAgIGlmKHJlY29yZF9kZWNsLmlubmVyKSB7CiAgICAgICAgICAgIHB1dCgne1xuJyk7CiAgICAgICAgICAgIGZvcihsZXQgZmllbGQgb2YgcmVjb3JkX2RlY2wuaW5uZXIgPz8gW10pIHsKICAgICAgICAgICAgICBwdXQoJyAgJyk7CiAgICAgICAgICAgICAgcHJpbnRlci5wcmludChmaWVsZCk7CiAgICAgICAgICAgICAgcHV0KCdcbicpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHB1dCgnfTsnKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgUmVzdHJpY3RBdHRyKHJlc3RyaWN0X2F0dHIpIHsKICAgICAgICAgIHB1dCgnX19yZXN0cmljdCcpOwogICAgICAgIH0KICAgICAgICBSZXR1cm5TdG10KHJldHVybl9zdG10KSB7CiAgICAgICAgICBwdXQoJ3JldHVybiAnKTsKICAgICAgICAgIGlmKHJldHVybl9zdG10LmlubmVyKSBmb3IobGV0IGlubmVyIG9mIHJldHVybl9zdG10LmlubmVyKSBwcmludGVyLnByaW50KGlubmVyKTsKICAgICAgICAgIHB1dCgnOycpOwogICAgICAgIH0KICAgICAgICBSZXR1cm5zVHdpY2VBdHRyKHJldHVybnNfdHdpY2VfYXR0cikgewogICAgICAgICAgcHV0KCdfX2F0dHJpYnV0ZV9fKChyZXR1cm5zX3R3aWNlKSknKTsKICAgICAgICB9CiAgICAgICAgU3RyaW5nTGl0ZXJhbChzdHJpbmdfbGl0ZXJhbCkgewogICAgICAgICAgcHV0KHN0cmluZ19saXRlcmFsLnZhbHVlKTsKICAgICAgICB9CiAgICAgICAgU3dpdGNoU3RtdChzd2l0Y2hfc3RtdCkgewogICAgICAgICAgbGV0IFtjb25kLCBib2R5XSA9IHN3aXRjaF9zdG10LmlubmVyOwogICAgICAgICAgcHV0KGBzd2l0Y2goYCk7CiAgICAgICAgICBwcmludGVyLnByaW50KGNvbmQpOwogICAgICAgICAgcHV0KGApIGApOwogICAgICAgICAgcHJpbnRlci5wcmludChib2R5KTsKICAgICAgICB9CiAgICAgICAgVGV4dENvbW1lbnQodGV4dF9jb21tZW50KSB7CiAgICAgICAgICBjb25zdCB7IHRleHQgfSA9IHRleHRfY29tbWVudDsKCiAgICAgICAgICBwdXQodGV4dCk7CiAgICAgICAgfQogICAgICAgIFRyYW5zbGF0aW9uVW5pdERlY2wodHJhbnNsYXRpb25fdW5pdF9kZWNsKSB7CiAgICAgICAgICBmb3IobGV0IGlubmVyIG9mIHRyYW5zbGF0aW9uX3VuaXRfZGVjbC5pbm5lcikgcHJpbnRlci5wcmludChpbm5lcik7CiAgICAgICAgfQogICAgICAgIFR5cGVkZWZEZWNsKHR5cGVkZWZfZGVjbCkgewogICAgICAgICAgY29uc3QgeyBuYW1lIH0gPSB0eXBlZGVmX2RlY2w7CgogICAgICAgICAgLy9jb25zb2xlLmxvZyhgVHlwZWRlZkRlY2xgLCB0eXBlZGVmX2RlY2wpOwoKICAgICAgICAgIGxldCB0eXBlID0gbmV3IFR5cGUodHlwZWRlZl9kZWNsLmlubmVyWzBdLnR5cGUsIHRoaXMuYXN0KTsKCiAgICAgICAgICBwdXQoJ3R5cGVkZWYgJyk7CiAgICAgICAgICBwdXQodHlwZSArICcnKTsKICAgICAgICAgIHB1dCgnICcpOwogICAgICAgICAgcHV0KG5hbWUpOwogICAgICAgICAgcHV0KCc7XG4nKTsKICAgICAgICB9CiAgICAgICAgVW5hcnlFeHByT3JUeXBlVHJhaXRFeHByKHVuYXJ5X2V4cHJfb3JfdHlwZV90cmFpdF9leHByKSB7CiAgICAgICAgICBjb25zdCB7IHZhbHVlQ2F0ZWdvcnksIG5hbWUgfSA9IHVuYXJ5X2V4cHJfb3JfdHlwZV90cmFpdF9leHByOwoKICAgICAgICAgIHB1dChuYW1lKTsKICAgICAgICAgIGlmKHVuYXJ5X2V4cHJfb3JfdHlwZV90cmFpdF9leHByLmlubmVyKQogICAgICAgICAgICBmb3IobGV0IGlubmVyIG9mIHVuYXJ5X2V4cHJfb3JfdHlwZV90cmFpdF9leHByLmlubmVyKSBwcmludGVyLnByaW50KGlubmVyKTsKICAgICAgICB9CiAgICAgICAgVW5hcnlPcGVyYXRvcih1bmFyeV9vcGVyYXRvcikgewogICAgICAgICAgY29uc3QgeyB2YWx1ZUNhdGVnb3J5LCBpc1Bvc3RmaXgsIG9wY29kZSwgY2FuT3ZlcmZsb3cgfSA9IHVuYXJ5X29wZXJhdG9yOwogICAgICAgICAgaWYoIWlzUG9zdGZpeCkgcHV0KG9wY29kZSk7CiAgICAgICAgICBmb3IobGV0IGlubmVyIG9mIHVuYXJ5X29wZXJhdG9yLmlubmVyKSBwcmludGVyLnByaW50KGlubmVyKTsKICAgICAgICAgIGlmKGlzUG9zdGZpeCkgcHV0KG9wY29kZSk7CiAgICAgICAgfQogICAgICAgIFVucmVzb2x2ZWRMb29rdXBFeHByKHVucmVzb2x2ZWRfbG9va3VwX2V4cHIpIHsKICAgICAgICAgIGNvbnN0IHsgdHlwZSwgdmFsdWVDYXRlZ29yeSwgdXNlc0FETCwgbmFtZSwgbG9va3VwcyB9ID0gdW5yZXNvbHZlZF9sb29rdXBfZXhwcjsKICAgICAgICAgIHB1dChuYW1lKTsKICAgICAgICB9CiAgICAgICAgVW5yZXNvbHZlZE1lbWJlckV4cHIodW5yZXNvbHZlZF9tZW1iZXJfZXhwcikgewogICAgICAgICAgY29uc3QgeyB0eXBlLCB2YWx1ZUNhdGVnb3J5IH0gPSB1bnJlc29sdmVkX21lbWJlcl9leHByOwogICAgICAgIH0KICAgICAgICBWYXJEZWNsKHZhcl9kZWNsLCBiYXNlX3R5cGUpIHsKICAgICAgICAgIGxldCB0eXBlID0gbmV3IFR5cGUodmFyX2RlY2wudHlwZSwgdGhpcy5hc3QpOwogICAgICAgICAgcHV0KHZhcl9kZWNsLm5hbWUpOwogICAgICAgICAgbGV0IHN1YnNjcmlwdHMgPSAodHlwZS5zdWJzY3JpcHRzID8/IFtdKS5tYXAoKFtvZmZzZXQsIHN1YnNjcmlwdF0pID0+IGBbJHtzdWJzY3JpcHR9XWApLmpvaW4oJycpOwogICAgICAgICAgaWYoc3Vic2NyaXB0cykgcHV0KHN1YnNjcmlwdHMpOwogICAgICAgICAgaWYodmFyX2RlY2wuaW5uZXIgJiYgdmFyX2RlY2wuaW5uZXIubGVuZ3RoKSB7CiAgICAgICAgICAgIHB1dCgnID0gJyk7CiAgICAgICAgICAgIGZvcihsZXQgaW5uZXIgb2YgdmFyX2RlY2wuaW5uZXIpIHByaW50ZXIucHJpbnQoaW5uZXIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBWZXJiYXRpbUJsb2NrQ29tbWVudCh2ZXJiYXRpbV9ibG9ja19jb21tZW50KSB7CiAgICAgICAgICBjb25zdCB7IG5hbWUsIGNsb3NlTmFtZSB9ID0gdmVyYmF0aW1fYmxvY2tfY29tbWVudDsKICAgICAgICAgIC8vY29uc29sZS5sb2coJ1ZlcmJhdGltQmxvY2tDb21tZW50JywgdmVyYmF0aW1fYmxvY2tfY29tbWVudCk7CiAgICAgICAgICBwdXQoYFxcJHtuYW1lfWApOwogICAgICAgICAgZm9yKGxldCBpbm5lciBvZiB2ZXJiYXRpbV9ibG9ja19jb21tZW50LmlubmVyKSB7CiAgICAgICAgICAgIHByaW50ZXIucHJpbnQoaW5uZXIpOwogICAgICAgICAgfQogICAgICAgICAgcHV0KGBcXCR7Y2xvc2VOYW1lfWApOwogICAgICAgIH0KICAgICAgICBWZXJiYXRpbUJsb2NrTGluZUNvbW1lbnQodmVyYmF0aW1fYmxvY2tfbGluZV9jb21tZW50KSB7CiAgICAgICAgICBjb25zdCB7IHRleHQgfSA9IHZlcmJhdGltX2Jsb2NrX2xpbmVfY29tbWVudDsKICAgICAgICAgIHB1dCh0ZXh0KTsKICAgICAgICB9CgogICAgICAgIFdhcm5VbnVzZWRSZXN1bHRBdHRyKHdhcm5fdW51c2VkX3Jlc3VsdF9hdHRyKSB7CiAgICAgICAgICBwdXQoJ19fYXR0cmlidXRlX18oKHdhcm5fdW51c2VkX3Jlc3VsdCkpJyk7CiAgICAgICAgfQogICAgICAgIFdlYWtBdHRyKHdlYWtfYXR0cikgewogICAgICAgICAgcHV0KCdfX2F0dHJpYnV0ZV9fKCh3ZWFrKSknKTsKICAgICAgICB9CiAgICAgICAgV2hpbGVTdG10KHdoaWxlX3N0bXQpIHsKICAgICAgICAgIGxldCBbY29uZCwgYm9keV0gPSB3aGlsZV9zdG10LmlubmVyOwogICAgICAgICAgcHV0KGB3aGlsZShgKTsKICAgICAgICAgIHByaW50ZXIucHJpbnQoY29uZCk7CiAgICAgICAgICBwdXQoYCkgYCk7CiAgICAgICAgICBwcmludGVyLnByaW50KGJvZHkpOwogICAgICAgIH0KCiAgICAgICAgT3ZlcnJpZGVBdHRyKG92ZXJyaWRlX2F0dHIpIHsKICAgICAgICAgIHB1dCgnb3ZlcnJpZGUnKTsKICAgICAgICB9CgogICAgICAgIEFkZHJMYWJlbEV4cHIoYWRkcl9sYWJlbF9leHByKSB7fQogICAgICAgIEFsaWFzQXR0cihhbGlhc19hdHRyKSB7fQogICAgICAgIEFsaWduVmFsdWVBdHRyKGFsaWduX3ZhbHVlX2F0dHIpIHsKICAgICAgICAgIHB1dChgX19hdHRyaWJ1dGVfXygoYWxpZ25fdmFsdWUoYCk7CiAgICAgICAgICBwcmludGVyLnByaW50KGFsaWduX3ZhbHVlX2F0dHIuaW5uZXJbMF0pOwoKICAgICAgICAgIHB1dChgKSkpYCk7CiAgICAgICAgfQogICAgICAgIEFsbG9jU2l6ZUF0dHIoYWxsb2Nfc2l6ZV9hdHRyKSB7fQogICAgICAgIEFycmF5SW5pdEluZGV4RXhwcihhcnJheV9pbml0X2luZGV4X2V4cHIpIHt9CiAgICAgICAgQXJyYXlJbml0TG9vcEV4cHIoYXJyYXlfaW5pdF9sb29wX2V4cHIpIHt9CiAgICAgICAgQXRvbWljRXhwcihhdG9taWNfZXhwcikge30KICAgICAgICBBdG9taWNUeXBlKGF0b21pY190eXBlKSB7fQogICAgICAgIEF1dG9UeXBlKGF1dG9fdHlwZSkge30KICAgICAgICBCdWlsdGluVGVtcGxhdGVEZWNsKGJ1aWx0aW5fdGVtcGxhdGVfZGVjbCkge30KICAgICAgICBCdWlsdGluVHlwZShidWlsdGluX3R5cGUpIHt9CiAgICAgICAgQ2FsbGJhY2tBdHRyKGNhbGxiYWNrX2F0dHIpIHt9CiAgICAgICAgQ2xhc3NUZW1wbGF0ZURlY2woY2xhc3NfdGVtcGxhdGVfZGVjbCkge30KICAgICAgICBDbGFzc1RlbXBsYXRlUGFydGlhbFNwZWNpYWxpemF0aW9uRGVjbChjbGFzc190ZW1wbGF0ZV9wYXJ0aWFsX3NwZWNpYWxpemF0aW9uX2RlY2wpIHt9CiAgICAgICAgQ2xhc3NUZW1wbGF0ZVNwZWNpYWxpemF0aW9uRGVjbChjbGFzc190ZW1wbGF0ZV9zcGVjaWFsaXphdGlvbl9kZWNsKSB7fQogICAgICAgIENvbXBsZXhUeXBlKGNvbXBsZXhfdHlwZSkge30KICAgICAgICBDb21wb3VuZExpdGVyYWxFeHByKGNvbXBvdW5kX2xpdGVyYWxfZXhwcikge30KICAgICAgICBDb25zdGFudEFycmF5VHlwZShjb25zdGFudF9hcnJheV90eXBlKSB7fQogICAgICAgIENvbnN0cnVjdG9yVXNpbmdTaGFkb3dEZWNsKGNvbnN0cnVjdG9yX3VzaW5nX3NoYWRvd19kZWNsKSB7fQogICAgICAgIENvbnZlcnRWZWN0b3JFeHByKGNvbnZlcnRfdmVjdG9yX2V4cHIpIHt9CiAgICAgICAgRGVjYXllZFR5cGUoZGVjYXllZF90eXBlKSB7fQogICAgICAgIERlY2x0eXBlVHlwZShkZWNsdHlwZV90eXBlKSB7fQogICAgICAgIERlcGVuZGVudE5hbWVUeXBlKGRlcGVuZGVudF9uYW1lX3R5cGUpIHt9CiAgICAgICAgRGVwZW5kZW50U2NvcGVEZWNsUmVmRXhwcihkZXBlbmRlbnRfc2NvcGVfZGVjbF9yZWZfZXhwcikgewogICAgICAgICAgY29uc3QgeyB0eXBlLCB2YWx1ZUNhdGVnb3J5IH0gPSBkZXBlbmRlbnRfc2NvcGVfZGVjbF9yZWZfZXhwcjsKICAgICAgICB9CiAgICAgICAgRGVwZW5kZW50U2l6ZWRBcnJheVR5cGUoZGVwZW5kZW50X3NpemVkX2FycmF5X3R5cGUpIHt9CiAgICAgICAgRGVwZW5kZW50VGVtcGxhdGVTcGVjaWFsaXphdGlvblR5cGUoZGVwZW5kZW50X3RlbXBsYXRlX3NwZWNpYWxpemF0aW9uX3R5cGUpIHt9CiAgICAgICAgRWxhYm9yYXRlZFR5cGUoZWxhYm9yYXRlZF90eXBlKSB7fQogICAgICAgIEVudW1UeXBlKGVudW1fdHlwZSkge30KICAgICAgICBFeHByV2l0aENsZWFudXBzKGV4cHJfd2l0aF9jbGVhbnVwcykgewogICAgICAgICAgZm9yKGxldCBpbm5lciBvZiBleHByX3dpdGhfY2xlYW51cHMuaW5uZXIpIHByaW50ZXIucHJpbnQoaW5uZXIpOwogICAgICAgIH0KICAgICAgICBGaW5hbEF0dHIoZmluYWxfYXR0cikge30KICAgICAgICBGb3JtYXRBcmdBdHRyKGZvcm1hdF9hcmdfYXR0cikge30KICAgICAgICBGcmllbmREZWNsKGZyaWVuZF9kZWNsKSB7fQogICAgICAgIEZ1bmN0aW9uTm9Qcm90b1R5cGUoZnVuY3Rpb25fbm9fcHJvdG9fdHlwZSkge30KICAgICAgICBGdW5jdGlvblByb3RvVHlwZShmdW5jdGlvbl9wcm90b190eXBlKSB7fQogICAgICAgIEZ1bmN0aW9uVGVtcGxhdGVEZWNsKGZ1bmN0aW9uX3RlbXBsYXRlX2RlY2wpIHt9CiAgICAgICAgR0NDQXNtU3RtdChnY2NfYXNtX3N0bXQpIHsKICAgICAgICAgIHB1dCgnX19hc21fXyAnKTsKICAgICAgICAgIGZvcihsZXQgaW5uZXIgb2YgZ2NjX2FzbV9zdG10LmlubmVyKSBwcmludGVyLnByaW50KGlubmVyKTsKICAgICAgICB9CiAgICAgICAgR05VSW5saW5lQXR0cihnbnVfaW5saW5lX2F0dHIpIHt9CiAgICAgICAgR05VTnVsbEV4cHIoZ251X251bGxfZXhwcikgewogICAgICAgICAgcHV0KGBOVUxMYCk7CiAgICAgICAgfQogICAgICAgIEltcGxpY2l0VmFsdWVJbml0RXhwcihpbXBsaWNpdF92YWx1ZV9pbml0X2V4cHIpIHt9CiAgICAgICAgSW5jb21wbGV0ZUFycmF5VHlwZShpbmNvbXBsZXRlX2FycmF5X3R5cGUpIHt9CiAgICAgICAgSW5kaXJlY3RGaWVsZERlY2woaW5kaXJlY3RfZmllbGRfZGVjbCkge30KICAgICAgICBJbmRpcmVjdEdvdG9TdG10KGluZGlyZWN0X2dvdG9fc3RtdCkge30KICAgICAgICBJbmplY3RlZENsYXNzTmFtZVR5cGUoaW5qZWN0ZWRfY2xhc3NfbmFtZV90eXBlKSB7fQogICAgICAgIExhbWJkYUV4cHIobGFtYmRhX2V4cHIpIHt9CiAgICAgICAgTGlua2FnZVNwZWNEZWNsKGxpbmthZ2Vfc3BlY19kZWNsKSB7CiAgICAgICAgICBjb25zdCB7IGxhbmd1YWdlIH0gPSBsaW5rYWdlX3NwZWNfZGVjbDsKICAgICAgICAgIHB1dChsYW5ndWFnZSA/IGBleHRlcm4gIiR7bGFuZ3VhZ2V9IiBgIDogYGV4dGVybiBgKTsKICAgICAgICAgIGZvcihsZXQgaW5uZXIgb2YgbGlua2FnZV9zcGVjX2RlY2wuaW5uZXIpIHByaW50ZXIucHJpbnQoaW5uZXIpOwogICAgICAgIH0KICAgICAgICBMVmFsdWVSZWZlcmVuY2VUeXBlKGxfdmFsdWVfcmVmZXJlbmNlX3R5cGUpIHt9CiAgICAgICAgTWF0ZXJpYWxpemVUZW1wb3JhcnlFeHByKG1hdGVyaWFsaXplX3RlbXBvcmFyeV9leHByKSB7CiAgICAgICAgICBmb3IobGV0IGlubmVyIG9mIG1hdGVyaWFsaXplX3RlbXBvcmFyeV9leHByLmlubmVyKSBwcmludGVyLnByaW50KGlubmVyKTsKICAgICAgICB9CiAgICAgICAgTWF4RmllbGRBbGlnbm1lbnRBdHRyKG1heF9maWVsZF9hbGlnbm1lbnRfYXR0cikge30KICAgICAgICBNYXlBbGlhc0F0dHIobWF5X2FsaWFzX2F0dHIpIHt9CiAgICAgICAgTWVtYmVyUG9pbnRlclR5cGUobWVtYmVyX3BvaW50ZXJfdHlwZSkge30KICAgICAgICBNaW5WZWN0b3JXaWR0aEF0dHIobWluX3ZlY3Rvcl93aWR0aF9hdHRyKSB7fQogICAgICAgIE1vZGVBdHRyKG1vZGVfYXR0cikge30KICAgICAgICBOYW1lc3BhY2VEZWNsKG5hbWVzcGFjZV9kZWNsKSB7fQogICAgICAgIE5vRGVidWdBdHRyKG5vX2RlYnVnX2F0dHIpIHt9CiAgICAgICAgTm9JbmxpbmVBdHRyKG5vX2lubGluZV9hdHRyKSB7fQogICAgICAgIE5vblR5cGVUZW1wbGF0ZVBhcm1EZWNsKG5vbl90eXBlX3RlbXBsYXRlX3Bhcm1fZGVjbCkge30KICAgICAgICBPZmZzZXRPZkV4cHIob2Zmc2V0X29mX2V4cHIpIHt9CiAgICAgICAgT3BhcXVlVmFsdWVFeHByKG9wYXF1ZV92YWx1ZV9leHByKSB7CiAgICAgICAgICAvL2NvbnNvbGUubG9nKCdPcGFxdWVWYWx1ZUV4cHInLG9wYXF1ZV92YWx1ZV9leHByKTsKICAgICAgICAgIHB1dChgLyoqKkZJWE1FOiBPcGFxdWVWYWx1ZUV4cHIqKiovYCk7CiAgICAgICAgfQogICAgICAgIE93bmVyQXR0cihvd25lcl9hdHRyKSB7fQogICAgICAgIFBhY2tlZEF0dHIocGFja2VkX2F0dHIpIHt9CiAgICAgICAgUGFja0V4cGFuc2lvbkV4cHIocGFja19leHBhbnNpb25fZXhwcikge30KICAgICAgICBQYWNrRXhwYW5zaW9uVHlwZShwYWNrX2V4cGFuc2lvbl90eXBlKSB7fQogICAgICAgIFBhcmVuVHlwZShwYXJlbl90eXBlKSB7fQogICAgICAgIFBvaW50ZXJBdHRyKHBvaW50ZXJfYXR0cikge30KICAgICAgICBQb2ludGVyVHlwZShwb2ludGVyX3R5cGUpIHt9CiAgICAgICAgUHJlZGVmaW5lZEV4cHIocHJlZGVmaW5lZF9leHByKSB7fQogICAgICAgIFF1YWxUeXBlKHF1YWxfdHlwZSkge30KICAgICAgICBSZWNvcmRUeXBlKHJlY29yZF90eXBlKSB7fQogICAgICAgIFJldHVybnNOb25OdWxsQXR0cihyZXR1cm5zX25vbl9udWxsX2F0dHIpIHt9CiAgICAgICAgUlZhbHVlUmVmZXJlbmNlVHlwZShyX3ZhbHVlX3JlZmVyZW5jZV90eXBlKSB7fQogICAgICAgIFNlbnRpbmVsQXR0cihzZW50aW5lbF9hdHRyKSB7fQogICAgICAgIFNodWZmbGVWZWN0b3JFeHByKHNodWZmbGVfdmVjdG9yX2V4cHIpIHt9CiAgICAgICAgU2l6ZU9mUGFja0V4cHIoc2l6ZV9vZl9wYWNrX2V4cHIpIHt9CiAgICAgICAgU3RhdGljQXNzZXJ0RGVjbChzdGF0aWNfYXNzZXJ0X2RlY2wpIHt9CiAgICAgICAgU3RtdEV4cHIoc3RtdF9leHByKSB7fQogICAgICAgIFN1YnN0Tm9uVHlwZVRlbXBsYXRlUGFybUV4cHIoc3Vic3Rfbm9uX3R5cGVfdGVtcGxhdGVfcGFybV9leHByKSB7fQogICAgICAgIFN1YnN0VGVtcGxhdGVUeXBlUGFybVR5cGUoc3Vic3RfdGVtcGxhdGVfdHlwZV9wYXJtX3R5cGUpIHt9CiAgICAgICAgVGFyZ2V0QXR0cih0YXJnZXRfYXR0cikge30KICAgICAgICBUZW1wbGF0ZUFyZ3VtZW50KHRlbXBsYXRlX2FyZ3VtZW50KSB7fQogICAgICAgIFRlbXBsYXRlU3BlY2lhbGl6YXRpb25UeXBlKHRlbXBsYXRlX3NwZWNpYWxpemF0aW9uX3R5cGUpIHt9CiAgICAgICAgVGVtcGxhdGVUZW1wbGF0ZVBhcm1EZWNsKHRlbXBsYXRlX3RlbXBsYXRlX3Bhcm1fZGVjbCkge30KICAgICAgICBUZW1wbGF0ZVR5cGVQYXJtRGVjbCh0ZW1wbGF0ZV90eXBlX3Bhcm1fZGVjbCkge30KICAgICAgICBUZW1wbGF0ZVR5cGVQYXJtVHlwZSh0ZW1wbGF0ZV90eXBlX3Bhcm1fdHlwZSkge30KICAgICAgICBUUGFyYW1Db21tYW5kQ29tbWVudCh0X3BhcmFtX2NvbW1hbmRfY29tbWVudCkge30KICAgICAgICBUeXBlQWxpYXNEZWNsKHR5cGVfYWxpYXNfZGVjbCkge30KICAgICAgICBUeXBlQWxpYXNUZW1wbGF0ZURlY2wodHlwZV9hbGlhc190ZW1wbGF0ZV9kZWNsKSB7fQogICAgICAgIFR5cGVkZWZUeXBlKHR5cGVkZWZfdHlwZSkge30KICAgICAgICBUeXBlT2ZFeHByVHlwZSh0eXBlX29mX2V4cHJfdHlwZSkge30KICAgICAgICBUeXBlVHJhaXRFeHByKHR5cGVfdHJhaXRfZXhwcikge30KICAgICAgICBVbmFyeVRyYW5zZm9ybVR5cGUodW5hcnlfdHJhbnNmb3JtX3R5cGUpIHt9CiAgICAgICAgVW5yZXNvbHZlZFVzaW5nVmFsdWVEZWNsKHVucmVzb2x2ZWRfdXNpbmdfdmFsdWVfZGVjbCkge30KICAgICAgICBVbnVzZWRBdHRyKHVudXNlZF9hdHRyKSB7fQogICAgICAgIFVzaW5nRGVjbCh1c2luZ19kZWNsKSB7fQogICAgICAgIFVzaW5nRGlyZWN0aXZlRGVjbCh1c2luZ19kaXJlY3RpdmVfZGVjbCkge30KICAgICAgICBVc2luZ1NoYWRvd0RlY2wodXNpbmdfc2hhZG93X2RlY2wpIHt9CiAgICAgICAgVkFBcmdFeHByKHZhX2FyZ19leHByKSB7fQogICAgICAgIFZhclRlbXBsYXRlRGVjbCh2YXJfdGVtcGxhdGVfZGVjbCkge30KICAgICAgICBWZWN0b3JUeXBlKHZlY3Rvcl90eXBlKSB7fQogICAgICAgIFZlcmJhdGltTGluZUNvbW1lbnQodmVyYmF0aW1fbGluZV9jb21tZW50KSB7fQogICAgICAgIFZpc2liaWxpdHlBdHRyKHZpc2liaWxpdHlfYXR0cikge30KICAgICAgICBXZWFrUmVmQXR0cih3ZWFrX3JlZl9hdHRyKSB7fQoKICAgICAgICBDWFhSZWNvcmREZWNsKGN4eF9yZWNvcmRfZGVjbCkgewogICAgICAgICAgY29uc3QgeyBuYW1lLCB0YWdVc2VkIH0gPSBjeHhfcmVjb3JkX2RlY2w7CiAgICAgICAgICBkZXB0aCsrOwoKICAgICAgICAgIHB1dChgJHt0YWdVc2VkfSAke25hbWV9IHtcbmApOwoKICAgICAgICAgIGlmKGN4eF9yZWNvcmRfZGVjbC5pbm5lcikgewogICAgICAgICAgICBsZXQgaSA9IC0xOwogICAgICAgICAgICBmb3IobGV0IGlubmVyIG9mIGN4eF9yZWNvcmRfZGVjbC5pbm5lcikgewogICAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgICBpZihpbm5lci5raW5kICYmIChpbm5lci5raW5kLmVuZHNXaXRoKCdDb21tZW50JykgfHwgaW5uZXIua2luZCA9PSAnQ1hYUmVjb3JkRGVjbCcpKSBjb250aW51ZTsKICAgICAgICAgICAgICAvLyAgY29uc29sZS5sb2coYENYWFJlY29yZERlY2wgaW5uZXJbJHtpfV1gLCBpbm5lcik7CiAgICAgICAgICAgICAgcHJpbnRlci5wcmludChpbm5lcik7CiAgICAgICAgICAgICAgcHV0KGBcbmApOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBkZXB0aC0tOwogICAgICAgICAgcHV0KGBcbn1gKTsKICAgICAgICB9CiAgICAgICAgQ1hYQ29uc3RydWN0b3JEZWNsKGN4eF9jb25zdHJ1Y3Rvcl9kZWNsKSB7CiAgICAgICAgICBjb25zdCB7IG5hbWUsIHR5cGUgfSA9IGN4eF9jb25zdHJ1Y3Rvcl9kZWNsOwogICAgICAgICAgbGV0IGkgPSAwLAogICAgICAgICAgICBwYXJhbSwKICAgICAgICAgICAgaW5pdGlhbGl6ZXI7CiAgICAgICAgICBsZXQgbCA9IGN4eF9jb25zdHJ1Y3Rvcl9kZWNsPy5pbm5lcgogICAgICAgICAgICA/IFsuLi5jeHhfY29uc3RydWN0b3JfZGVjbC5pbm5lcl0uZmlsdGVyKG4gPT4gbi5raW5kICYmICFuLmtpbmQuZW5kc1dpdGgoJ0NvbW1lbnQnKSkKICAgICAgICAgICAgOiBbXTsKICAgICAgICAgIHB1dChgJHtuYW1lfShgKTsKICAgICAgICAgIHdoaWxlKGwubGVuZ3RoICYmIGxbMF0ua2luZCA9PSAnUGFybVZhckRlY2wnICYmIChwYXJhbSA9IGwuc2hpZnQoKSkpIHsKICAgICAgICAgICAgLyppZihwYXJhbS5uYW1lKSovIHsKICAgICAgICAgICAgICBpZihpID4gMCkgcHV0KCcsICcpOwogICAgICAgICAgICAgIHByaW50ZXIucHJpbnQocGFyYW0pOwogICAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgcHV0KGApYCk7CiAgICAgICAgICBkZXB0aCsrOwogICAgICAgICAgaWYobC5sZW5ndGggJiYgbFswXS5raW5kID09ICdDWFhDdG9ySW5pdGlhbGl6ZXInKSB7CiAgICAgICAgICAgIHB1dChgXG46IGApOwogICAgICAgICAgICBpID0gMDsKICAgICAgICAgICAgd2hpbGUobC5sZW5ndGggJiYgbFswXS5raW5kID09ICdDWFhDdG9ySW5pdGlhbGl6ZXInICYmIChpbml0aWFsaXplciA9IGwuc2hpZnQoKSkpIHsKICAgICAgICAgICAgICBpZihpKysgPiAwKSBwdXQoJ1xuLCAnKTsKICAgICAgICAgICAgICBsZXQgaW1wbGljaXRfY2FzdCA9IGluaXRpYWxpemVyLmlubmVyWzBdOwogICAgICAgICAgICAgIGlmKGltcGxpY2l0X2Nhc3Q/LmlubmVyKSB7CiAgICAgICAgICAgICAgICBsZXQgbWVtYmVyX2V4cHIgPSBpbXBsaWNpdF9jYXN0LmlubmVyWzBdOwoKICAgICAgICAgICAgICAgIHB1dChtZW1iZXJfZXhwci5uYW1lICsgYChgKTsKICAgICAgICAgICAgICAgIGlmKG1lbWJlcl9leHByPy5pbm5lcikgcHJpbnRlci5wcmludChtZW1iZXJfZXhwci5pbm5lclswXSk7CgogICAgICAgICAgICAgICAgcHV0KGApYCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBkZXB0aC0tOwogICAgICAgICAgaWYobC5sZW5ndGgpIHsKICAgICAgICAgICAgcHV0KGBcbmApOwogICAgICAgICAgICBmb3IobGV0IG5vZGUgb2YgbCkgcHJpbnRlci5wcmludChub2RlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHB1dChgO2ApOwogICAgICAgICAgfQogICAgICAgICAgcHV0KGBcbmApOwogICAgICAgIH0KCiAgICAgICAgQ1hYQ3RvckluaXRpYWxpemVyKGN4eF9jdG9yX2luaXRpYWxpemVyKSB7CiAgICAgICAgICBjb25zdCB7CiAgICAgICAgICAgIGFueUluaXQ6IHsgbmFtZSB9CiAgICAgICAgICB9ID0gY3h4X2N0b3JfaW5pdGlhbGl6ZXI7CgogICAgICAgICAgcHV0KG5hbWUpOwogICAgICAgICAgcHV0KGAoYCk7CiAgICAgICAgICBpZihjeHhfY3Rvcl9pbml0aWFsaXplci5pbm5lcikKICAgICAgICAgICAgZm9yKGxldCBpbm5lciBvZiBjeHhfY3Rvcl9pbml0aWFsaXplci5pbm5lcikgewogICAgICAgICAgICAgIGlmKGlubmVyLmtpbmQuZW5kc1dpdGgoJ0NvbW1lbnQnKSkgY29udGludWU7CiAgICAgICAgICAgICAgcHJpbnRlci5wcmludChpbm5lciA/PyAnJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIHB1dChgKWApOwogICAgICAgIH0KICAgICAgICBDWFhEZXBlbmRlbnRTY29wZU1lbWJlckV4cHIoY3h4X2RlcGVuZGVudF9zY29wZV9tZW1iZXJfZXhwcikgewogICAgICAgICAgY29uc3QgeyB0eXBlLCB2YWx1ZUNhdGVnb3J5LCBpc0Fycm93LCBtZW1iZXIgfSA9IGN4eF9kZXBlbmRlbnRfc2NvcGVfbWVtYmVyX2V4cHI7CgogICAgICAgICAgLy8gaWYoY3h4X2RlcGVuZGVudF9zY29wZV9tZW1iZXJfZXhwci5pbm5lcikKICAgICAgICAgIGZvcihsZXQgaW5uZXIgb2YgY3h4X2RlcGVuZGVudF9zY29wZV9tZW1iZXJfZXhwci5pbm5lcikgewogICAgICAgICAgICBpZihpbm5lci5raW5kLmVuZHNXaXRoKCdDb21tZW50JykpIGNvbnRpbnVlOwogICAgICAgICAgICAvLyBjb25zb2xlLmxvZygnQ1hYRGVwZW5kZW50U2NvcGVNZW1iZXJFeHByJywgaW5uZXIpOwogICAgICAgICAgICBwcmludGVyLnByaW50KGlubmVyKTsKICAgICAgICAgIH0KCiAgICAgICAgICBwdXQoYC4ke21lbWJlcn1gKTsKICAgICAgICB9CiAgICAgICAgQ1hYVGhpc0V4cHIoY3h4X3RoaXNfZXhwcikgewogICAgICAgICAgY29uc3QgeyB2YWx1ZUNhdGVnb3J5LCBpc0ltcGxpY2l0IH0gPSBjeHhfdGhpc19leHByOwoKICAgICAgICAgIHB1dCgndGhpcycpOwogICAgICAgIH0KICAgICAgICBDWFhEZXN0cnVjdG9yRGVjbChjeHhfZGVzdHJ1Y3Rvcl9kZWNsKSB7CiAgICAgICAgICBjb25zdCB7IGlzSW1wbGljaXQsIG5hbWUsIG1hbmdsZWROYW1lLCB0eXBlLCBpbmxpbmUsIGV4cGxpY2l0bHlEZWZhdWx0ZWQgfSA9IGN4eF9kZXN0cnVjdG9yX2RlY2w7CgogICAgICAgICAgbGV0IGwgPSBjeHhfZGVzdHJ1Y3Rvcl9kZWNsLmlubmVyCiAgICAgICAgICAgID8gWy4uLmN4eF9kZXN0cnVjdG9yX2RlY2wuaW5uZXJdLmZpbHRlcihuID0+IG4ua2luZCAmJiAhbi5raW5kLmVuZHNXaXRoKCdDb21tZW50JykpCiAgICAgICAgICAgIDogW107CiAgICAgICAgICBwdXQoYCR7bmFtZX0oYCk7CgogICAgICAgICAgcHV0KGApYCk7CgogICAgICAgICAgaWYobC5sZW5ndGgpIHsKICAgICAgICAgICAgcHV0KGBcbmApOwogICAgICAgICAgICBmb3IobGV0IG5vZGUgb2YgbCkgcHJpbnRlci5wcmludChub2RlKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHB1dChgO2ApOwogICAgICAgICAgfQogICAgICAgICAgcHV0KGBcbmApOwogICAgICAgIH0KICAgICAgICBDWFhNZXRob2REZWNsKGN4eF9tZXRob2RfZGVjbCkgewogICAgICAgICAgY29uc3QgewogICAgICAgICAgICBuYW1lLAogICAgICAgICAgICB0eXBlOiB7IHF1YWxUeXBlOiBmdW5jdGlvblR5cGUgfSwKICAgICAgICAgICAgc3RvcmFnZUNsYXNzCiAgICAgICAgICB9ID0gY3h4X21ldGhvZF9kZWNsOwogICAgICAgICAgY29uc3QgcmV0dXJuVHlwZSA9IGZ1bmN0aW9uVHlwZS5zbGljZSgwLCBmdW5jdGlvblR5cGUuaW5kZXhPZignKCcpKTsKCiAgICAgICAgICAvLyAgY29uc29sZS5sb2coJ0NYWE1ldGhvZERlY2wnLCBjb25zb2xlLmNvbmZpZyh7IGRlcHRoOiAxMCB9KSwgY3h4X21ldGhvZF9kZWNsKTsKICAgICAgICAgIGxldCBpID0gMCwKICAgICAgICAgICAgcGFyYW0sCiAgICAgICAgICAgIGluaXRpYWxpemVyOwogICAgICAgICAgbGV0IGlubmVyID0gY3h4X21ldGhvZF9kZWNsLmlubmVyCiAgICAgICAgICAgID8gWy4uLmN4eF9tZXRob2RfZGVjbC5pbm5lcl0uZmlsdGVyKG4gPT4gbi5raW5kICYmICFuLmtpbmQuZW5kc1dpdGgoJ0NvbW1lbnQnKSkKICAgICAgICAgICAgOiBbXTsKICAgICAgICAgIGlmKHN0b3JhZ2VDbGFzcykgcHV0KGAke3N0b3JhZ2VDbGFzc30gYCk7CiAgICAgICAgICBwdXQoYCR7cmV0dXJuVHlwZX1cbmApOwogICAgICAgICAgcHV0KGAke25hbWV9KGApOwogICAgICAgICAgd2hpbGUoaW5uZXIubGVuZ3RoICYmIGlubmVyWzBdLmtpbmQgPT0gJ1Bhcm1WYXJEZWNsJyAmJiAocGFyYW0gPSBpbm5lci5zaGlmdCgpKSkgewogICAgICAgICAgICBpZihpKysgPiAwKSBwdXQoJywgJyk7CiAgICAgICAgICAgIHByaW50ZXIucHJpbnQocGFyYW0pOwogICAgICAgICAgfQogICAgICAgICAgcHV0KGApYCk7CiAgICAgICAgICAvL2NvbnNvbGUubG9nKCdDWFhNZXRob2REZWNsJywgeyBpbm5lciB9KTsKICAgICAgICAgIGlmKGlubmVyLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgcHV0KGAgYCk7CiAgICAgICAgICAgIGRlcHRoKys7CiAgICAgICAgICAgIGZvcihsZXQgbm9kZSBvZiBpbm5lcikgcHJpbnRlci5wcmludChub2RlKTsKICAgICAgICAgICAgZGVwdGgtLTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHB1dChgO2ApOwogICAgICAgICAgfQogICAgICAgICAgcHV0KGBcbmApOwogICAgICAgIH0KCiAgICAgICAgQ1hYU3RhdGljQ2FzdEV4cHIoY3h4X3N0YXRpY19jYXN0X2V4cHIpIHsKICAgICAgICAgIGNvbnN0IHsKICAgICAgICAgICAgdHlwZTogeyBxdWFsVHlwZTogdHlwZU5hbWUgfSwKICAgICAgICAgICAgdmFsdWVDYXRlZ29yeSwKICAgICAgICAgICAgY2FzdEtpbmQKICAgICAgICAgIH0gPSBjeHhfc3RhdGljX2Nhc3RfZXhwcjsKCiAgICAgICAgICBpZihjYXN0S2luZCA9PSAnTm9PcCcpIHsKICAgICAgICAgICAgcHV0KGAwYCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KICAgICAgICAgIC8vY29uc29sZS5sb2coJ0NYWFN0YXRpY0Nhc3RFeHByJywgY3h4X3N0YXRpY19jYXN0X2V4cHIpOwogICAgICAgICAgcHV0KGBzdGF0aWNfY2FzdDxgKTsKICAgICAgICAgIHB1dCh0eXBlTmFtZSk7CiAgICAgICAgICBwdXQoYD4oYCk7CgogICAgICAgICAgaWYoY3h4X3N0YXRpY19jYXN0X2V4cHIuaW5uZXIpCiAgICAgICAgICAgIGZvcihsZXQgaW5uZXIgb2YgY3h4X3N0YXRpY19jYXN0X2V4cHIuaW5uZXIpIHsKICAgICAgICAgICAgICBpZihpbm5lci5raW5kID09ICdEZWNsUmVmRXhwcicgJiYgaW5uZXIucmVmZXJlbmNlZERlY2wubmFtZSA9PSAnJykgY29udGludWU7CiAgICAgICAgICAgICAgcHJpbnRlci5wcmludChpbm5lcik7CiAgICAgICAgICAgIH0KICAgICAgICAgIHB1dChgKWApOwogICAgICAgIH0KCiAgICAgICAgQ1hYVW5yZXNvbHZlZENvbnN0cnVjdEV4cHIoY3h4X3VucmVzb2x2ZWRfY29uc3RydWN0X2V4cHIpIHsKICAgICAgICAgIGNvbnN0IHsgdHlwZSwgdmFsdWVDYXRlZ29yeSB9ID0gY3h4X3VucmVzb2x2ZWRfY29uc3RydWN0X2V4cHI7CiAgICAgICAgICBpZihjeHhfdW5yZXNvbHZlZF9jb25zdHJ1Y3RfZXhwci5pbm5lcikKICAgICAgICAgICAgZm9yKGxldCBpbm5lciBvZiBjeHhfdW5yZXNvbHZlZF9jb25zdHJ1Y3RfZXhwci5pbm5lcikgewogICAgICAgICAgICAgIGlmKGlubmVyLmtpbmQuZW5kc1dpdGgoJ0NvbW1lbnQnKSkgY29udGludWU7CiAgICAgICAgICAgICAgcHJpbnRlci5wcmludChpbm5lcik7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgQ1hYTmV3RXhwcihjeHhfbmV3X2V4cHIpIHsKICAgICAgICAgIGNvbnN0IHsKICAgICAgICAgICAgdHlwZTogeyBxdWFsVHlwZTogdHlwZSB9LAogICAgICAgICAgICB2YWx1ZUNhdGVnb3J5LAogICAgICAgICAgICBpc0FycmF5CiAgICAgICAgICB9ID0gY3h4X25ld19leHByOwogICAgICAgICAgLy9jb25zb2xlLmxvZygnQ1hYTmV3RXhwcicsIGN4eF9uZXdfZXhwcik7CiAgICAgICAgICB0eXBlID0gdHlwZS50cmltKCk7CiAgICAgICAgICBpZihpc0FycmF5KSB7CiAgICAgICAgICAgIHB1dCgnbmV3ICcgKyB0eXBlICsgJ1snKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHB1dCgnbmV3ICcgKyB0eXBlICsgJygnKTsKICAgICAgICAgIH0KICAgICAgICAgIHByaW50ZXIucHJpbnQoY3h4X25ld19leHByLmlubmVyWzBdKTsKCiAgICAgICAgICBpZihpc0FycmF5KSBwdXQoYF1gKTsKICAgICAgICAgIGVsc2UgcHV0KGApYCk7CiAgICAgICAgfQogICAgICAgIENYWERlbGV0ZUV4cHIoY3h4X2RlbGV0ZV9leHByKSB7CiAgICAgICAgICBjb25zdCB7CiAgICAgICAgICAgIHR5cGU6IHsgcXVhbFR5cGU6IHR5cGUgfSwKICAgICAgICAgICAgdmFsdWVDYXRlZ29yeSwKICAgICAgICAgICAgaXNBcnJheSwKICAgICAgICAgICAgaXNBcnJheUFzV3JpdHRlbgogICAgICAgICAgfSA9IGN4eF9kZWxldGVfZXhwcjsKICAgICAgICAgIHB1dChgZGVsZXRlIGApOwoKICAgICAgICAgIHByaW50ZXIucHJpbnQoY3h4X2RlbGV0ZV9leHByLmlubmVyWzBdKTsKICAgICAgICB9CiAgICAgICAgQ1hYQm9vbExpdGVyYWxFeHByKGN4eF9ib29sX2xpdGVyYWxfZXhwcikgewogICAgICAgICAgY29uc3QgeyB0eXBlLCB2YWx1ZUNhdGVnb3J5LCB2YWx1ZSB9ID0gY3h4X2Jvb2xfbGl0ZXJhbF9leHByOwoKICAgICAgICAgIHB1dCh2YWx1ZSA/ICd0cnVlJyA6ICdmYWxzZScpOwogICAgICAgIH0KICAgICAgICBDWFgxMU5vUmV0dXJuQXR0cihjeHgxMV9ub19yZXR1cm5fYXR0cikge30KICAgICAgICBDWFhCaW5kVGVtcG9yYXJ5RXhwcihjeHhfYmluZF90ZW1wb3JhcnlfZXhwcikge30KICAgICAgICBDWFhDYXRjaFN0bXQoY3h4X2NhdGNoX3N0bXQpIHt9CiAgICAgICAgQ1hYQ29uc3RydWN0RXhwcihjeHhfY29uc3RydWN0X2V4cHIpIHsKICAgICAgICAgIGNvbnN0IHsgdHlwZSB9ID0gY3h4X2NvbnN0cnVjdF9leHByOwoKICAgICAgICAgIGZvcihsZXQgaW5uZXIgb2YgY3h4X2NvbnN0cnVjdF9leHByLmlubmVyKSBwcmludGVyLnByaW50KGlubmVyKTsKICAgICAgICB9CiAgICAgICAgQ1hYQ29udmVyc2lvbkRlY2woY3h4X2NvbnZlcnNpb25fZGVjbCkge30KICAgICAgICBDWFhEZWZhdWx0QXJnRXhwcihjeHhfZGVmYXVsdF9hcmdfZXhwcikge30KICAgICAgICBDWFhEZWZhdWx0SW5pdEV4cHIoY3h4X2RlZmF1bHRfaW5pdF9leHByKSB7fQogICAgICAgIENYWEZvclJhbmdlU3RtdChjeHhfZm9yX3JhbmdlX3N0bXQpIHt9CiAgICAgICAgQ1hYRnVuY3Rpb25hbENhc3RFeHByKGN4eF9mdW5jdGlvbmFsX2Nhc3RfZXhwcikge30KICAgICAgICBDWFhNZW1iZXJDYWxsRXhwcihjeHhfbWVtYmVyX2NhbGxfZXhwcikge30KCiAgICAgICAgQ1hYTm9leGNlcHRFeHByKGN4eF9ub2V4Y2VwdF9leHByKSB7fQogICAgICAgIENYWE51bGxQdHJMaXRlcmFsRXhwcihjeHhfbnVsbF9wdHJfbGl0ZXJhbF9leHByKSB7fQogICAgICAgIENYWE9wZXJhdG9yQ2FsbEV4cHIoY3h4X29wZXJhdG9yX2NhbGxfZXhwcikge30KICAgICAgICBDWFhSZWludGVycHJldENhc3RFeHByKGN4eF9yZWludGVycHJldF9jYXN0X2V4cHIpIHt9CiAgICAgICAgQ1hYU2NhbGFyVmFsdWVJbml0RXhwcihjeHhfc2NhbGFyX3ZhbHVlX2luaXRfZXhwcikge30KICAgICAgICBDWFhUZW1wb3JhcnlPYmplY3RFeHByKGN4eF90ZW1wb3Jhcnlfb2JqZWN0X2V4cHIpIHsKICAgICAgICAgIGNvbnN0IHsgdHlwZSB9ID0gY3h4X3RlbXBvcmFyeV9vYmplY3RfZXhwcjsKCiAgICAgICAgICBwdXQodHlwZS5xdWFsVHlwZSk7CiAgICAgICAgICBwdXQoYChgKTsKICAgICAgICAgIGZvcihsZXQgaW5uZXIgb2YgY3h4X3RlbXBvcmFyeV9vYmplY3RfZXhwci5pbm5lcikgewogICAgICAgICAgICBwcmludGVyLnByaW50KGlubmVyKTsKICAgICAgICAgIH0KICAgICAgICAgIHB1dChgKWApOwogICAgICAgIH0KICAgICAgICBDWFhUcnlTdG10KGN4eF90cnlfc3RtdCkge30KICAgICAgfSkoKQogICAgfQogIH0pOwoKICByZXR1cm4gcHJpbnRlcjsKfQoKZXhwb3J0IGZ1bmN0aW9uIFByaW50Tm9kZShub2RlKSB7CiAgbGV0IG91dDsKICBsZXQgc2VwID0gJyAnOwogIHN3aXRjaCAobm9kZS5raW5kKSB7CiAgICBjYXNlICdDb25zdGFudEV4cHInOgogICAgICBvdXQgPSBub2RlLmlubmVyLm1hcChQcmludE5vZGUpOwogICAgICBicmVhazsKICAgIGNhc2UgJ0ludGVnZXJMaXRlcmFsJzoKICAgICAgb3V0ID0gbm9kZS52YWx1ZTsKICAgICAgYnJlYWs7CiAgICBjYXNlICdCaW5hcnlPcGVyYXRvcic6CiAgICAgIG91dCA9IG5vZGUuaW5uZXIubWFwKFByaW50Tm9kZSk7CiAgICAgIHNlcCA9IGAgJHtub2RlLm9wY29kZX0gYDsKICAgICAgYnJlYWs7CiAgfQogIGlmKEFycmF5LmlzQXJyYXkob3V0KSkgb3V0ID0gb3V0LmpvaW4oc2VwKTsKICByZXR1cm4gb3V0Owp9CgpleHBvcnQgZnVuY3Rpb24gUHJpbnRBc3Qobm9kZSwgYXN0KSB7CiAgaWYoJ2FzdCcgaW4gbm9kZSkgbm9kZSA9IG5vZGUuYXN0OwogIGFzdCA/Pz0gJC5kYXRhOwogIGxldCBwcmludGVyID0gTm9kZVByaW50ZXIoYXN0KTsKICBnbG9iYWxUaGlzLnByaW50ZXIgPSBwcmludGVyOwogIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHByaW50ZXIsIHsKICAgIHBhdGg6IHsKICAgICAgZ2V0KCkgewogICAgICAgIHJldHVybiBkZWVwLnBhdGhPZihhc3QsIHRoaXMubm9kZSk7CiAgICAgIH0KICAgIH0KICB9KTsKICBpZihBcnJheS5pc0FycmF5KG5vZGUpKSB7CiAgICBmb3IobGV0IGVsZW0gb2Ygbm9kZSkgewogICAgICBpZihwcmludGVyLm91dHB1dCkgcHJpbnRlci5wdXQoJ1xuJyk7CiAgICAgIHByaW50ZXIoZWxlbSwgYXN0KTsKICAgIH0KICB9IGVsc2UgewogICAgcHJpbnRlcihub2RlLCBhc3QpOwogIH0KICByZXR1cm4gcHJpbnRlci5vdXRwdXQ7Cn0KCmV4cG9ydCBmdW5jdGlvbiBpc05vZGUob2JqKSB7CiAgcmV0dXJuIGlzT2JqZWN0KG9iaikgJiYgdHlwZW9mIG9iai5raW5kID09ICdzdHJpbmcnOwp9CgpleHBvcnQgZnVuY3Rpb24gR2V0VHlwZShuYW1lX29yX2lkLCBhc3QgPSAkLmRhdGEpIHsKICAvL2NvbnNvbGUubG9nKCdHZXRUeXBlOicsIG5hbWVfb3JfaWQpOwogIGxldCByZXN1bHQsIGlkeDsKCiAgaWYodHlwZW9mIG5hbWVfb3JfaWQgPT0gJ29iamVjdCcgJiYgbmFtZV9vcl9pZCkgewogICAgcmVzdWx0ID0gbmFtZV9vcl9pZDsKICB9IGVsc2UgewogICAgY29uc3QgdHlwZXMgPSBhc3QuaW5uZXIuZmlsdGVyKG4gPT4gLyg/OlJlY29yZERlY2x8VHlwZWRlZkRlY2x8RW51bURlY2wpLy50ZXN0KG4ua2luZCkpOwogICAgaWYodHlwZW9mIG5hbWVfb3JfaWQgPT0gJ3N0cmluZycpIHsKICAgICAgbGV0IHRhZ1VzZWQsCiAgICAgICAgd2FudEtpbmQgPSAvXi4qLzsKICAgICAgaWYoL14oPzpzdHJ1Y3R8dW5pb258ZW51bSlccy8udGVzdChuYW1lX29yX2lkKSkgewogICAgICAgIHRhZ1VzZWQgPSBuYW1lX29yX2lkLnJlcGxhY2UoL1xzLiovZywgJycpOwogICAgICAgIG5hbWVfb3JfaWQgPSBuYW1lX29yX2lkLnN1YnN0cmluZyh0YWdVc2VkLmxlbmd0aCArIDEpOwogICAgICB9CiAgICAgIHN3aXRjaCAodGFnVXNlZCkgewogICAgICAgIGNhc2UgJ3N0cnVjdCc6CiAgICAgICAgY2FzZSAndW5pb24nOgogICAgICAgICAgd2FudEtpbmQgPSAvXlJlY29yZERlY2wvOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnZW51bSc6CiAgICAgICAgICB3YW50S2luZCA9IC9eRW51bURlY2wvOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgbGV0IHJlc3VsdHMgPSB0eXBlcy5maWx0ZXIoCiAgICAgICAgbmFtZV9vcl9pZC5zdGFydHNXaXRoKCcweCcpCiAgICAgICAgICA/IG5vZGUgPT4gbm9kZS5pZCA9PSBuYW1lX29yX2lkICYmIHdhbnRLaW5kLnRlc3Qobm9kZS5raW5kKQogICAgICAgICAgOiBub2RlID0+IG5vZGUubmFtZSA9PSBuYW1lX29yX2lkICYmIHdhbnRLaW5kLnRlc3Qobm9kZS5raW5kKQogICAgICApOwogICAgICBpZihyZXN1bHRzLmxlbmd0aCA8PSAxIHx8IChpZHggPSByZXN1bHRzLmZpbmRJbmRleChyID0+IHIuY29tcGxldGVEZWZpbml0aW9uKSkgPT0gLTEpIGlkeCA9IDA7CiAgICAgIHJlc3VsdCA9IHJlc3VsdHNbaWR4XTsKCiAgICAgIGlmKCFyZXN1bHQgJiYgVHlwZS5kZWNsYXJhdGlvbnMuaGFzKG5hbWVfb3JfaWQpKSByZXN1bHQgPSBUeXBlLmRlY2xhcmF0aW9ucy5nZXQobmFtZV9vcl9pZCk7CiAgICB9IGVsc2UgewogICAgICByZXN1bHQgPSB0eXBlc1tuYW1lX29yX2lkXTsKICAgIH0KICB9CiAgcmV0dXJuIHJlc3VsdDsKfQoKZXhwb3J0IGZ1bmN0aW9uIEdldEZpZWxkcyhub2RlKSB7CiAgbGV0IGZpZWxkcyA9IGRlZXAKICAgIC5zZWxlY3Qobm9kZSwgKHYsIGspID0+IC8gYXQgLy50ZXN0KHYpICYmIGsgPT0gJ3F1YWxUeXBlJywgZGVlcC5SRVRVUk5fVkFMVUVfUEFUSCkKICAgIC5tYXAoKFt2LCBwXSkgPT4gW3Yuc3BsaXQoLyg/OlxzKlsoKV18IGF0ICkvZylbMl0sIHAuc2xpY2UoMCwgLTIpXSk7CgogIHJldHVybiBmaWVsZHMubWFwKChbbG9jLCBwdHJdKSA9PgogICAgbG9jCiAgICAgIC5zcGxpdCgvOi9nKQogICAgICAubWFwKGkgPT4gKCFpc05hTigraSkgPyAraSA6IGkpKQogICAgICAuY29uY2F0KFtkZWVwLmdldChub2RlLCBwdHIpLm5hbWVdKQogICk7Cn0KZXhwb3J0IGZ1bmN0aW9uIEdldFBhcmFtcyhub2RlKSB7CiAgcmV0dXJuIChub2RlPy5pbm5lciA/PyBbXSkuZmlsdGVyKGNoaWxkID0+IGNoaWxkLmtpbmQuc3RhcnRzV2l0aCgnUGFybScpKTsKfQpleHBvcnQgZnVuY3Rpb24gUGF0aFJlbW92ZUxvYyhwYXRoKSB7CiAgbGV0IGlkeCA9IHBhdGguZmluZEluZGV4KHAgPT4gcCA9PSAnbG9jJyB8fCBwID09ICdyYW5nZScpOwogIGlmKGlkeCAhPSAtMSkgcGF0aCA9IHBhdGguc2xpY2UoMCwgaWR4KTsKICByZXR1cm4gcGF0aDsKfQovL2V4cG9ydCBkZWZhdWx0IEFzdER1bXA7CgAAAAAAAAAADjcBAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABjYgAAAAAAAGNiAAAAAAAAAAAAAAAAjEA"
				],
				[
					155,
					1,
					"cut",
					null,
					"AQAAANFhAAAAAAAA0WEAAAAAAAAiAAAAICAgIC8vIGNvbnNvbGUubG9nKCdhc3Q6JywgYXN0KTsKCg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADRYQAAAAAAAPNhAAAAAAAAAAAAAAAAAAA"
				],
				[
					159,
					1,
					"insert",
					{
						"characters": "(("
					},
					"AgAAAGhiAAAAAAAAaWIAAAAAAAAAAAAAaWIAAAAAAABqYgAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABoYgAAAAAAAGhiAAAAAAAAAAAAAAAA8L8"
				],
				[
					160,
					2,
					"left_delete",
					null,
					"AgAAAGliAAAAAAAAaWIAAAAAAAABAAAAKGhiAAAAAAAAaGIAAAAAAAABAAAAKA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABqYgAAAAAAAGpiAAAAAAAAAAAAAAAA8L8"
				],
				[
					161,
					1,
					"insert",
					{
						"characters": "//"
					},
					"AgAAAGhiAAAAAAAAaWIAAAAAAAAAAAAAaWIAAAAAAABqYgAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABoYgAAAAAAAGhiAAAAAAAAAAAAAAAA8L8"
				],
				[
					167,
					1,
					"left_delete",
					null,
					"AQAAAHVjAAAAAAAAdWMAAAAAAAABAAAACg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAB2YwAAAAAAAHZjAAAAAAAAAAAAAAAASEA"
				]
			]
		},
		{
			"file": "io-helpers.js",
			"settings":
			{
				"buffer_size": 11744,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					22,
					1,
					"cut",
					null,
					"AQAAACwMAAAAAAAALAwAAAAAAAAOAAAAY29tcGFjdCA9IHRydWU",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAsDAAAAAAAADoMAAAAAAAAAAAAAAAA8L8"
				],
				[
					23,
					1,
					"insert",
					{
						"characters": "...args"
					},
					"BwAAACwMAAAAAAAALQwAAAAAAAAAAAAALQwAAAAAAAAuDAAAAAAAAAAAAAAuDAAAAAAAAC8MAAAAAAAAAAAAAC8MAAAAAAAAMAwAAAAAAAAAAAAAMAwAAAAAAAAxDAAAAAAAAAAAAAAxDAAAAAAAADIMAAAAAAAAAAAAADIMAAAAAAAAMwwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAsDAAAAAAAACwMAAAAAAAAAAAAAAAA8L8"
				],
				[
					25,
					1,
					"insert",
					{
						"characters": "\nconst"
					},
					"BwAAADYMAAAAAAAANwwAAAAAAAAAAAAANwwAAAAAAAA5DAAAAAAAAAAAAAA5DAAAAAAAADoMAAAAAAAAAAAAADoMAAAAAAAAOwwAAAAAAAAAAAAAOwwAAAAAAAA8DAAAAAAAAAAAAAA8DAAAAAAAAD0MAAAAAAAAAAAAAD0MAAAAAAAAPgwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA2DAAAAAAAADYMAAAAAAAAAAAAAAAA8L8"
				],
				[
					26,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAD4MAAAAAAAAPwwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA+DAAAAAAAAD4MAAAAAAAAAAAAAAAA8L8"
				],
				[
					27,
					1,
					"insert_snippet",
					{
						"contents": "[$0]"
					},
					"AQAAAD8MAAAAAAAAQQwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA/DAAAAAAAAD8MAAAAAAAAAAAAAAAA8L8"
				],
				[
					28,
					1,
					"insert",
					{
						"characters": "compat"
					},
					"BgAAAEAMAAAAAAAAQQwAAAAAAAAAAAAAQQwAAAAAAABCDAAAAAAAAAAAAABCDAAAAAAAAEMMAAAAAAAAAAAAAEMMAAAAAAAARAwAAAAAAAAAAAAARAwAAAAAAABFDAAAAAAAAAAAAABFDAAAAAAAAEYMAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABADAAAAAAAAEAMAAAAAAAAAAAAAAAA8L8"
				],
				[
					29,
					1,
					"left_delete",
					null,
					"AQAAAEUMAAAAAAAARQwAAAAAAAABAAAAdA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABGDAAAAAAAAEYMAAAAAAAAAAAAAAAA8L8"
				],
				[
					30,
					1,
					"insert",
					{
						"characters": "ct=true"
					},
					"BwAAAEUMAAAAAAAARgwAAAAAAAAAAAAARgwAAAAAAABHDAAAAAAAAAAAAABHDAAAAAAAAEgMAAAAAAAAAAAAAEgMAAAAAAAASQwAAAAAAAAAAAAASQwAAAAAAABKDAAAAAAAAAAAAABKDAAAAAAAAEsMAAAAAAAAAAAAAEsMAAAAAAAATAwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABFDAAAAAAAAEUMAAAAAAAAAAAAAAAA8L8"
				],
				[
					32,
					1,
					"insert",
					{
						"characters": "="
					},
					"AQAAAE0MAAAAAAAATgwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABNDAAAAAAAAE0MAAAAAAAAAAAAAAAA8L8"
				],
				[
					33,
					1,
					"insert",
					{
						"characters": " args;"
					},
					"BgAAAE4MAAAAAAAATwwAAAAAAAAAAAAATwwAAAAAAABQDAAAAAAAAAAAAABQDAAAAAAAAFEMAAAAAAAAAAAAAFEMAAAAAAAAUgwAAAAAAAAAAAAAUgwAAAAAAABTDAAAAAAAAAAAAABTDAAAAAAAAFQMAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABODAAAAAAAAE4MAAAAAAAAAAAAAAAA8L8"
				],
				[
					38,
					1,
					"insert",
					{
						"characters": "\n"
					},
					"AgAAAFQMAAAAAAAAVQwAAAAAAAAAAAAAVQwAAAAAAABXDAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABUDAAAAAAAAFQMAAAAAAAAAAAAAAAA8L8"
				],
				[
					87,
					1,
					"cut",
					null,
					"AQAAAEcMAAAAAAAARwwAAAAAAAAFAAAAPXRydWU",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABHDAAAAAAAAEwMAAAAAAAAAAAAAAAA8L8"
				],
				[
					90,
					1,
					"insert",
					{
						"characters": "\nif"
					},
					"BQAAAE8MAAAAAAAAUAwAAAAAAAAAAAAAUAwAAAAAAABSDAAAAAAAAAAAAABTDAAAAAAAAFMMAAAAAAAAAgAAACAgUgwAAAAAAABTDAAAAAAAAAAAAABTDAAAAAAAAFQMAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABPDAAAAAAAAE8MAAAAAAAAAAAAAAAA8L8"
				],
				[
					91,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAFQMAAAAAAAAVgwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABUDAAAAAAAAFQMAAAAAAAAAAAAAAAA8L8"
				],
				[
					92,
					1,
					"insert",
					{
						"characters": "typeof"
					},
					"BgAAAFUMAAAAAAAAVgwAAAAAAAAAAAAAVgwAAAAAAABXDAAAAAAAAAAAAABXDAAAAAAAAFgMAAAAAAAAAAAAAFgMAAAAAAAAWQwAAAAAAAAAAAAAWQwAAAAAAABaDAAAAAAAAAAAAABaDAAAAAAAAFsMAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABVDAAAAAAAAFUMAAAAAAAAAAAAAAAA8L8"
				],
				[
					93,
					1,
					"insert",
					{
						"characters": " compact"
					},
					"CAAAAFsMAAAAAAAAXAwAAAAAAAAAAAAAXAwAAAAAAABdDAAAAAAAAAAAAABdDAAAAAAAAF4MAAAAAAAAAAAAAF4MAAAAAAAAXwwAAAAAAAAAAAAAXwwAAAAAAABgDAAAAAAAAAAAAABgDAAAAAAAAGEMAAAAAAAAAAAAAGEMAAAAAAAAYgwAAAAAAAAAAAAAYgwAAAAAAABjDAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABbDAAAAAAAAFsMAAAAAAAAAAAAAAAA8L8"
				],
				[
					94,
					1,
					"insert",
					{
						"characters": " =="
					},
					"AwAAAGMMAAAAAAAAZAwAAAAAAAAAAAAAZAwAAAAAAABlDAAAAAAAAAAAAABlDAAAAAAAAGYMAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABjDAAAAAAAAGMMAAAAAAAAAAAAAAAA8L8"
				],
				[
					95,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAGYMAAAAAAAAZwwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABmDAAAAAAAAGYMAAAAAAAAAAAAAAAA8L8"
				],
				[
					96,
					1,
					"insert_snippet",
					{
						"contents": "'$0'"
					},
					"AQAAAGcMAAAAAAAAaQwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABnDAAAAAAAAGcMAAAAAAAAAAAAAAAA8L8"
				],
				[
					97,
					1,
					"insert",
					{
						"characters": "boolean"
					},
					"BwAAAGgMAAAAAAAAaQwAAAAAAAAAAAAAaQwAAAAAAABqDAAAAAAAAAAAAABqDAAAAAAAAGsMAAAAAAAAAAAAAGsMAAAAAAAAbAwAAAAAAAAAAAAAbAwAAAAAAABtDAAAAAAAAAAAAABtDAAAAAAAAG4MAAAAAAAAAAAAAG4MAAAAAAAAbwwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABoDAAAAAAAAGgMAAAAAAAAAAAAAAAA8L8"
				],
				[
					99,
					1,
					"insert",
					{
						"characters": "‚Åæ"
					},
					"AQAAAHAMAAAAAAAAcQwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABwDAAAAAAAAHAMAAAAAAAAAAAAAAAA8L8"
				],
				[
					100,
					1,
					"left_delete",
					null,
					"AQAAAHAMAAAAAAAAcAwAAAAAAAADAAAA4oG+",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABxDAAAAAAAAHEMAAAAAAAAAAAAAAAA8L8"
				],
				[
					102,
					1,
					"insert",
					{
						"characters": "\nargs"
					},
					"CAAAAHEMAAAAAAAAcgwAAAAAAAAAAAAAcgwAAAAAAAB0DAAAAAAAAAAAAAByDAAAAAAAAHIMAAAAAAAAAgAAACAgcgwAAAAAAAB2DAAAAAAAAAAAAAB2DAAAAAAAAHcMAAAAAAAAAAAAAHcMAAAAAAAAeAwAAAAAAAAAAAAAeAwAAAAAAAB5DAAAAAAAAAAAAAB5DAAAAAAAAHoMAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABxDAAAAAAAAHEMAAAAAAAAAAAAAAAA8L8"
				],
				[
					103,
					4,
					"left_delete",
					null,
					"BAAAAHkMAAAAAAAAeQwAAAAAAAABAAAAc3gMAAAAAAAAeAwAAAAAAAABAAAAZ3cMAAAAAAAAdwwAAAAAAAABAAAAcnYMAAAAAAAAdgwAAAAAAAABAAAAYQ",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAB6DAAAAAAAAHoMAAAAAAAAAAAAAAAA8L8"
				],
				[
					104,
					1,
					"insert",
					{
						"characters": "args="
					},
					"BQAAAHYMAAAAAAAAdwwAAAAAAAAAAAAAdwwAAAAAAAB4DAAAAAAAAAAAAAB4DAAAAAAAAHkMAAAAAAAAAAAAAHkMAAAAAAAAegwAAAAAAAAAAAAAegwAAAAAAAB7DAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAB2DAAAAAAAAHYMAAAAAAAAAAAAAAAA8L8"
				],
				[
					105,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAHsMAAAAAAAAfAwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAB7DAAAAAAAAHsMAAAAAAAAAAAAAAAA8L8"
				],
				[
					106,
					1,
					"insert_completion",
					{
						"completion": "LogCall(fn, thisObj);",
						"format": "snippet",
						"keep_prefix": false,
						"must_insert": true,
						"trigger": "function LogCall"
					},
					"AQAAAHwMAAAAAAAAkQwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAB8DAAAAAAAAHwMAAAAAAAAAAAAAAAA8L8"
				],
				[
					111,
					1,
					"cut",
					null,
					"AQAAAMUMAAAAAAAAxQwAAAAAAAAYAAAAY29tcGFjdCA/IFtdIDogW251bGwsIDJd",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADFDAAAAAAAAN0MAAAAAAAAAAAAAAAA8L8"
				],
				[
					112,
					1,
					"paste",
					null,
					"AQAAAMUMAAAAAAAA3QwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADFDAAAAAAAAMUMAAAAAAAAAAAAAAAA8L8"
				],
				[
					115,
					1,
					"paste",
					null,
					"AgAAAHsMAAAAAAAAkwwAAAAAAAAAAAAAkwwAAAAAAACTDAAAAAAAABYAAAAgTG9nQ2FsbChmbiwgdGhpc09iaik7",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAB7DAAAAAAAAJEMAAAAAAAAAAAAAAAA8L8"
				],
				[
					116,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAJMMAAAAAAAAlAwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACTDAAAAAAAAJMMAAAAAAAAAAAAAAAA8L8"
				],
				[
					123,
					1,
					"left_delete",
					null,
					"AQAAAMgMAAAAAAAAyAwAAAAAAAAaAAAAY29tcGFjdCA/IFtdIDogW251bGwsIDJdKSk",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADIDAAAAAAAAOIMAAAAAAAAAAAAAAAA8L8"
				],
				[
					124,
					1,
					"run_macro_file",
					{
						"file": "res://Packages/Default/Delete Left Right.sublime-macro"
					},
					"AgAAAMcMAAAAAAAAxwwAAAAAAAABAAAAKMcMAAAAAAAAxwwAAAAAAAABAAAAKQ",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADIDAAAAAAAAMgMAAAAAAAAAAAAAAAA8L8"
				],
				[
					125,
					1,
					"insert",
					{
						"characters": "arfgs"
					},
					"BQAAAMcMAAAAAAAAyAwAAAAAAAAAAAAAyAwAAAAAAADJDAAAAAAAAAAAAADJDAAAAAAAAMoMAAAAAAAAAAAAAMoMAAAAAAAAywwAAAAAAAAAAAAAywwAAAAAAADMDAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADHDAAAAAAAAMcMAAAAAAAAAAAAAAAA8L8"
				],
				[
					126,
					3,
					"left_delete",
					null,
					"AwAAAMsMAAAAAAAAywwAAAAAAAABAAAAc8oMAAAAAAAAygwAAAAAAAABAAAAZ8kMAAAAAAAAyQwAAAAAAAABAAAAZg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADMDAAAAAAAAMwMAAAAAAAAAAAAAAAA8L8"
				],
				[
					127,
					1,
					"insert",
					{
						"characters": "gs))"
					},
					"BAAAAMkMAAAAAAAAygwAAAAAAAAAAAAAygwAAAAAAADLDAAAAAAAAAAAAADLDAAAAAAAAMwMAAAAAAAAAAAAAMwMAAAAAAAAzQwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADJDAAAAAAAAMkMAAAAAAAAAAAAAAAA8L8"
				]
			]
		},
		{
			"file": "quickjs/qjs-modules/lib/util.js",
			"settings":
			{
				"buffer_size": 60278,
				"line_ending": "Unix"
			}
		},
		{
			"file": "ast-shell.js",
			"settings":
			{
				"buffer_size": 39942,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					53,
					1,
					"revert",
					null,
					"AwAAAAAAAAAAAAAAAAAAAAAAAAAanAAAaW1wb3J0IFBvcnRhYmxlU3Bhd24gZnJvbSAnLi9saWIvc3Bhd24uanMnOwppbXBvcnQgVXRpbCBmcm9tICcuL2xpYi91dGlsLmpzJzsKaW1wb3J0IHBhdGggZnJvbSAnLi9saWIvcGF0aC5qcyc7CmltcG9ydCAqIGFzIGRlZXAgZnJvbSAnLi9saWIvZGVlcC5qcyc7CmltcG9ydCB7IENvbnNvbGUgfSBmcm9tICdjb25zb2xlJzsKaW1wb3J0IFJFUEwgZnJvbSAnLi9xdWlja2pzL3Fqcy1tb2R1bGVzL2xpYi9yZXBsLmpzJzsKaW1wb3J0IHsgU0laRU9GX1BPSU5URVIsIE5vZGUsIFR5cGUsIFJlY29yZERlY2wsIEVudW1EZWNsLCBUeXBlZGVmRGVjbCwgVmFyRGVjbCwgRnVuY3Rpb25EZWNsLCBMb2NhdGlvbiwgUmFuZ2UsIFR5cGVGYWN0b3J5LCBTcGF3bkNvbXBpbGVyLCBBc3REdW1wLCBGaW5kVHlwZSwgSGllciwgUGF0aE9mLCBOb2RlVHlwZSwgTm9kZU5hbWUsIEdldExvYywgQ29tcGxldGVMb2NhdGlvbiwgUmF3TG9jYXRpb24sIENvbXBsZXRlUmFuZ2UsIFJhd1JhbmdlLCBHZXRUeXBlLCBHZXRUeXBlU3RyLCBOb2RlUHJpbnRlciwgaXNOb2RlLCBTb3VyY2VEZXBlbmRlbmNpZXMsIEdldFR5cGVOb2RlLCBHZXRGaWVsZHMsIFBhdGhSZW1vdmVMb2MsIFByaW50QXN0LCBHZXRQYXJhbXMsIExpc3QgfSBmcm9tICcuL2NsYW5nLWFzdC5qcyc7CmltcG9ydCBUcmVlIGZyb20gJy4vbGliL3RyZWUuanMnOwppbXBvcnQgeyBQb2ludGVyIH0gZnJvbSAnLi9saWIvcG9pbnRlci5qcyc7CmltcG9ydCAqIGFzIFRlcm1pbmFsIGZyb20gJy4vdGVybWluYWwuanMnOwppbXBvcnQgKiBhcyBFQ01BU2NyaXB0IGZyb20gJy4vbGliL2VjbWFzY3JpcHQuanMnOwppbXBvcnQgeyBFQ01BU2NyaXB0UGFyc2VyIH0gZnJvbSAnLi9saWIvZWNtYXNjcmlwdC5qcyc7CmltcG9ydCAqIGFzIGZzIGZyb20gJy4vbGliL2ZpbGVzeXN0ZW0uanMnOwppbXBvcnQgeyBpc09iamVjdCwgZXh0ZW5kQXJyYXksIHRvU3RyaW5nLCB0b0FycmF5QnVmZmVyIH0gZnJvbSAnLi9saWIvbWlzYy5qcyc7CmltcG9ydCB7IFJlYWRGaWxlLCBMb2FkSGlzdG9yeSwgUmVhZEpTT04sIE1hcEZpbGUsIFJlYWRCSlNPTiwgV3JpdGVGaWxlLCBXcml0ZUpTT04sIFdyaXRlQkpTT04sIERpckl0ZXJhdG9yLCBSZWN1cnNpdmVEaXJJdGVyYXRvciB9IGZyb20gJy4vaW8taGVscGVycy5qcyc7CgpleHRlbmRBcnJheShBcnJheS5wcm90b3R5cGUpOwoKZ2xvYmFsVGhpcy5mcyA9IGZzOwoKbGV0IHBhcmFtczsKbGV0IGZpbGVzOwpsZXQgc3Bhd24sIGJhc2UsIGNtZGhpc3QsIGNvbmZpZzsKbGV0IGRlZnMsIGluY2x1ZGVzLCBsaWJzLCBzb3VyY2VzOwpsZXQgbGliZGlycyA9IFsKICAnL2xpYicsCiAgJy9saWIvaTM4Ni1saW51eC1nbnUnLAogICcvbGliL3g4Nl82NC1saW51eC1nbnUnLAogICcvbGliMzInLAogICcvbGlieDMyJywKICAnL3Vzci9saWInLAogICcvdXNyL2xpYi9pMzg2LWxpbnV4LWdudScsCiAgJy91c3IvbGliL2kzODYtbGludXgtZ251L2k2ODYvc3NlMicsCiAgJy91c3IvbGliL2kzODYtbGludXgtZ251L3NzZTInLAogICcvdXNyL2xpYi94ODZfNjQtbGludXgtZ251JywKICAnL3Vzci9saWIveDg2XzY0LWxpbnV4LWdudS9saWJmYWtlcm9vdCcsCiAgJy91c3IvbGliMzInLAogICcvdXNyL2xpYngzMicsCiAgJy91c3IvbG9jYWwvbGliJywKICAnL3Vzci9sb2NhbC9saWIvaTM4Ni1saW51eC1nbnUnLAogICcvdXNyL2xvY2FsL2xpYi94ODZfNjQtbGludXgtZ251JwpdOwpsZXQgbGliZGlyczMyID0gbGliZGlycy5maWx0ZXIoZCA9PiAvKDMyJHxpWzAtOV04NikvLnRlc3QoZCkpOwpsZXQgbGliZGlyczY0ID0gbGliZGlycy5maWx0ZXIoZCA9PiAhLygzMiR8aVswLTldODYpLy50ZXN0KGQpKTsKCmNvbnN0IFN0cmluZ0dlbmVyYXRvciA9CiAgZ2VuID0+CiAgKC4uLmFyZ3MpID0+IHsKICAgIGxldCBpdGVyYXRvciA9IGdlbiguLi5hcmdzKTsKCiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihpdGVyYXRvciwgewogICAgICB0b1N0cmluZygpIHsKICAgICAgICBsZXQgcmVzdWx0LAogICAgICAgICAgcyA9ICcnOwoKICAgICAgICB3aGlsZSgocmVzdWx0ID0gaXRlcmF0b3IubmV4dCgpKSAmJiAhcmVzdWx0LmRvbmUpIHsKICAgICAgICAgIGlmKHMgIT0gJycpIHMgKz0gJ1xuJzsKICAgICAgICAgIHMgKz0gcmVzdWx0LnZhbHVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gczsKICAgICAgfQogICAgfSk7CiAgfTsKCmFzeW5jIGZ1bmN0aW9uIEltcG9ydE1vZHVsZShtb2R1bGVQYXRoLCAuLi5hcmdzKSB7CiAgbGV0IGRvbmUgPSBmYWxzZTsKICBsZXQgbW9kdWxlTmFtZSA9IHBhdGguYmFzZW5hbWUobW9kdWxlUGF0aCwgJy5qcycpOwogIHJldHVybiBhd2FpdCBpbXBvcnQobW9kdWxlUGF0aCkudGhlbihtb2R1bGUgPT4gewogICAgZG9uZSA9IHRydWU7CiAgICBtb2R1bGUgPSBPYmplY3QuY3JlYXRlKAogICAgICBudWxsLAogICAgICBVdGlsLmdldE1lbWJlck5hbWVzKG1vZHVsZSwgSW5maW5pdHksIDApLnJlZHVjZSgKICAgICAgICAoYWNjLCBpdGVtKSA9PiAoewogICAgICAgICAgLi4uYWNjLAogICAgICAgICAgW2l0ZW1dOiB7IHZhbHVlOiBtb2R1bGVbaXRlbV0sIGVudW1lcmFibGU6IHRydWUgfQogICAgICAgIH0pLAogICAgICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKG1vZHVsZSkKICAgICAgKQogICAgKTsKCiAgICBpZighZ2xvYmFsVGhpcy5tb2R1bGVzKSBnbG9iYWxUaGlzLm1vZHVsZXMgPSB7fTsKICAgIGdsb2JhbFRoaXMubW9kdWxlc1ttb2R1bGVOYW1lXSA9IG1vZHVsZTsKCiAgICBPYmplY3QuYXNzaWduKGdsb2JhbFRoaXMsIG1vZHVsZSk7CiAgICByZXR1cm4geyBtb2R1bGVOYW1lLCBtb2R1bGVQYXRoLCBtb2R1bGUgfTsKICB9KTsKICAvKi5jYXRjaChlID0+IHsKICAgICAgZG9uZSA9IHRydWU7CiAgICAgIHJldHVybiB7IG1vZHVsZU5hbWUsIG1vZHVsZVBhdGgsIG1vZHVsZTogZS5tZXNzYWdlIH07CiAgICB9KSovCn0KCmZ1bmN0aW9uIENvbW1hbmRMaW5lKCkgewogIGxldCBsb2cgPSBjb25zb2xlLnJlYWxsb2c7CiAgLy8gbGV0IG91dHB1dExvZyA9IGZzLm9wZW5TeW5jKCdvdXRwdXQubG9nJywgJ3crJyk7CgogIGxldCByZXBsOwogIHJlcGwgPSBnbG9iYWxUaGlzLnJlcGwgPSBuZXcgUkVQTCgnQVNUJywgZmFsc2UpOwogIC8vY29uc29sZS5sb2coJ3JlcGwnLCByZXBsKTsKCiAgbGV0IGNmZyA9IFJlYWRKU09OKGNvbmZpZyk7CgogIGlmKGNmZykgT2JqZWN0LmFzc2lnbihjb25zb2xlLm9wdGlvbnMsIGNmZy5pbnNwZWN0T3B0aW9ucyk7CgogIHJlcGwuaW1wb3J0TW9kdWxlID0gSW1wb3J0TW9kdWxlOwogIHJlcGwuaGlzdG9yeSA9IExvYWRIaXN0b3J5KGNtZGhpc3QpOwogIE9iamVjdC5hc3NpZ24ocmVwbC5kaXJlY3RpdmVzLCB7CiAgICBjOiBbCiAgICAgICguLi5hcmdzKSA9PiB7CiAgICAgICAgQ29tcGlsZSguLi5hcmdzKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0sCiAgICAgICdjb21waWxlIHNvdXJjZScKICAgIF0sCiAgICBsOiBbCiAgICAgICguLi5hcmdzKSA9PiB7CiAgICAgICAgUHJvY2Vzc0ZpbGUoLi4uYXJncyk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9LAogICAgICAnbG9hZCBzb3VyY2UgZmlsZScKICAgIF0sCiAgICBpOiBbCiAgICAgIChtb2R1bGUsIC4uLmFyZ3MpID0+IHsKICAgICAgICBjb25zb2xlLmxvZygnYXJncycsIGFyZ3MpOwogICAgICAgIHRyeSB7CiAgICAgICAgICByZXR1cm4gcmVxdWlyZShtb2R1bGUpOwogICAgICAgIH0gY2F0Y2goZSkge30KICAgICAgICBpbXBvcnQobW9kdWxlKS50aGVuKG0gPT4gKGdsb2JhbFRoaXNbbW9kdWxlXSA9IG0pKTsKICAgICAgfSwKICAgICAgJ2ltcG9ydCBtb2R1bGUnCiAgICBdCiAgfSk7CiAgcmVwbC5pbnNwZWN0T3B0aW9ucyA9IGNvbnNvbGUub3B0aW9uczsKICByZXBsLnNob3cgPSB2YWx1ZSA9PiB7CiAgICBsZXQgZmlyc3QsIHN0cjsKICAgIGlmKGlzT2JqZWN0KHZhbHVlKSAmJiAoZmlyc3QgPSB2YWx1ZS5maXJzdCA/PyB2YWx1ZVswXSkgJiYgaXNPYmplY3QoZmlyc3QpICYmICgnaWQnIGluIGZpcnN0IHx8ICdraW5kJyBpbiBmaXJzdCkpCiAgICAgIHN0ciA9IFRhYmxlKHZhbHVlKTsKICAgIGVsc2UgaWYodHlwZW9mIHZhbHVlID09ICdzdHJpbmcnKSBzdHIgPSB2YWx1ZTsKICAgIGVsc2UKICAgICAgc3RyID0gaW5zcGVjdCh2YWx1ZSwgewogICAgICAgIC4uLmNmZy5pbnNwZWN0T3B0aW9ucywKICAgICAgICAuLi5yZXBsLmluc3BlY3RPcHRpb25zLAogICAgICAgIGhpZGVLZXlzOiBbJ2xvYycsICdyYW5nZSddCiAgICAgIH0pOwogICAgc3RkLm91dC5wdXRzKHN0ciArICdcbicpOwogIH07CgogIGxldCBkZWJ1Z0xvZyA9IGZzLm9wZW5TeW5jKCdkZWJ1Zy5sb2cnLCAnYScpOwogIHJlcGwuZGVidWdMb2cgPSBkZWJ1Z0xvZzsKCiAgZ2xvYmFsVGhpcy5wcmludE5vZGUgPSBhcmcgPT4gewogICAgY29uc29sZS5sb2coTm9kZVByaW50ZXIoJC5kYXRhKS5wcmludChhcmcpKTsKICB9OwoKICByZXBsLmRlYnVnID0gKC4uLmFyZ3MpID0+IHsKICAgIGxldCBzID0gJyc7CiAgICBmb3IobGV0IGFyZyBvZiBhcmdzKSB7CiAgICAgIGlmKHMpIHMgKz0gJyAnOwogICAgICBpZih0eXBlb2YgYXJnICE9ICdzdHJwaW5nJyB8fCBhcmcuaW5kZXhPZignXHgxYicpID09IC0xKQogICAgICAgIHMgKz0gaW5zcGVjdChhcmcsIHsgZGVwdGg6IEluZmluaXR5LCBkZXB0aDogNiwgY29tcGFjdDogZmFsc2UgfSk7CiAgICAgIGVsc2UgcyArPSBhcmc7CiAgICB9CiAgICBmcy53cml0ZVN5bmMoZGVidWdMb2csIHMgKyAnXG4nKTsKICAgIGlmKGRlYnVnTG9nLmZsdXNoKSBkZWJ1Z0xvZy5mbHVzaCgpOwogIH07CgogIHJlcGwuYWRkQ2xlYW51cEhhbmRsZXIoKCkgPT4gewogICAgVGVybWluYWwubW91c2V0cmFja2luZ0Rpc2FibGUoKTsKICAgIGxldCBoaXN0ID0gcmVwbC5oaXN0b3J5LmZpbHRlcigoaXRlbSwgaSwgYSkgPT4gYS5sYXN0SW5kZXhPZihpdGVtKSA9PSBpKTsKICAgIGZzLndyaXRlRmlsZVN5bmMoCiAgICAgIGNtZGhpc3QsCiAgICAgIGhpc3QKICAgICAgICAuZmlsdGVyKGVudHJ5ID0+IChlbnRyeSArICcnKS50cmltKCkgIT0gJycpCiAgICAgICAgLm1hcChlbnRyeSA9PiBlbnRyeS5yZXBsYWNlKC9cbi9nLCAnXFxuJykgKyAnXG4nKQogICAgICAgIC5qb2luKCcnKQogICAgKTsKCiAgICBsZXQgY2ZnID0geyBpbnNwZWN0T3B0aW9uczogY29uc29sZS5vcHRpb25zIH07CiAgICBXcml0ZUpTT04oY29uZmlnLCBjZmcpOwoKICAgIGNvbnNvbGUubG9nKGBFWElUICh3cm90ZSAke2hpc3QubGVuZ3RofSBoaXN0b3J5IGVudHJpZXMpYCk7CiAgICBzdGQuZXhpdCgwKTsKICB9KTsKCiAgVXRpbC5hdGV4aXQoKCkgPT4gcmVwbC5jbGVhbnVwKCkpOwoKICByZXBsID0gVXRpbC50cmFjZVByb3h5KHJlcGwpOwoKICBpZihwYXJhbXMuZXhlYykgcmVwbC5ldmFsQW5kUHJpbnQocGFyYW1zLmV4ZWMpOwogIGVsc2UgcmVwbC5ydW4oZmFsc2UpOwp9CgpmdW5jdGlvbiogSW5jbHVkZUFsbChkaXIsIG1heERlcHRoID0gSW5maW5pdHksIHByZWQgPSBlbnRyeSA9PiAvXC5bY2hdJC8udGVzdChlbnRyeSkpIHsKICBmb3IobGV0IGVudHJ5IG9mIFJlY3Vyc2l2ZURpckl0ZXJhdG9yKGRpciwgbWF4RGVwdGgsIHByZWQpKSB5aWVsZCBgI2luY2x1ZGUgIiR7ZW50cnl9ImA7Cn0KCmZ1bmN0aW9uIFNlbGVjdExvY2F0aW9ucyhub2RlKSB7CiAgbGV0IHJlc3VsdCA9IGRlZXAuc2VsZWN0KG5vZGUsIG4gPT4gWydvZmZzZXQnLCAnbGluZScsICdmaWxlJ10uc29tZShwcm9wID0+IG5bcHJvcF0gIT09IHVuZGVmaW5lZCkpOwogIC8vY29uc29sZS5sb2coJ3Jlc3VsdDonLCBjb25zb2xlLmNvbmZpZyh7IGRlcHRoOiAxIH0pLCByZXN1bHQpOwogIHJldHVybiByZXN1bHQ7Cn0KCmZ1bmN0aW9uIExvY2F0aW9uU3RyaW5nKGxvYykgewogIGlmKHR5cGVvZiBsb2MgPT0gJ29iamVjdCcgJiYgbG9jICE9IG51bGwpIHsKICAgIGxldCBmaWxlID0gbG9jLmZpbGUgPz8gKGxvYy5pbmNsdWRlZEZyb20gJiYgbG9jLmluY2x1ZGVkRnJvbS5maWxlKTsKICAgIC8vaWYoZmlsZSkgZmlsZSA9IHBhdGgucmVsYXRpdmUoZmlsZSwgcHJvY2Vzcy5jd2QoKSk7CiAgICBpZih0eXBlb2YgbG9jLmxpbmUgPT0gJ251bWJlcicpCiAgICAgIHJldHVybiBgJHtmaWxlID8gZmlsZSArICc6JyA6ICcnfSR7bG9jLmxpbmV9JHt0eXBlb2YgbG9jLmNvbCA9PSAnbnVtYmVyJyA/ICc6JyArIGxvYy5jb2wgOiAnJ31gOwogICAgcmV0dXJuIGAke2ZpbGUgPyBmaWxlIDogJyd9QCR7bG9jLm9mZnNldH1gOwogIH0KfQoKY29uc3QgVHlwZU1hcCA9IFV0aWwud2Vha01hcHBlcihub2RlID0+IG5ldyBUeXBlKG5vZGUpKTsKCmZ1bmN0aW9uIFN0cnVjdHMobm9kZXMpIHsKICByZXR1cm4gbm9kZXMKICAgIC5maWx0ZXIobm9kZSA9PiBub2RlLmlubmVyICYmIG5vZGUuaW5uZXIuc29tZShmaWVsZCA9PiBmaWVsZC5raW5kID09ICdGaWVsZERlY2wnKSkKICAgIC5tYXAobm9kZSA9PiBbCiAgICAgIC8vZGVlcC5maW5kKG5vZGUsIG4gPT4gdHlwZW9mIG4ubGluZSA9PSAnbnVtYmVyJyksCiAgICAgIG5ldyBMb2NhdGlvbihHZXRMb2Mobm9kZSkpLAogICAgICAoKG5vZGUudGFnVXNlZCA/IG5vZGUudGFnVXNlZCArICcgJyA6ICcnKSArIChub2RlLm5hbWUgPz8gJycpKS50cmltKCksCiAgICAgIG5ldyBNYXAoCiAgICAgICAgbm9kZS5pbm5lci5tYXAoKGZpZWxkLCBpKSA9PgogICAgICAgICAgL0F0dHIvLnRlc3QoZmllbGQua2luZCkKICAgICAgICAgICAgPyBbU3ltYm9sKGZpZWxkLmtpbmQpLCBmaWVsZC5pZF0KICAgICAgICAgICAgOiBbZmllbGQubmFtZSB8fCBpLCAoZmllbGQudHlwZSAmJiBUeXBlRmFjdG9yeShmaWVsZC50eXBlKSkgfHwgZmllbGQua2luZF0KICAgICAgICApCiAgICAgICkKICAgIF0pOwogIC8qLm1hcChub2RlID0+IHR5cGVzKG5vZGUpKSovCn0KCmZ1bmN0aW9uIFRhYmxlKGxpc3QsIHByZWQgPSAobiwgbCkgPT4gdHJ1ZSkgewogIGxldCBlbnRyaWVzID0gWy4uLmxpc3RdLm1hcCgobiwgaSkgPT4gKG4gPyBbaSwgTG9jYXRpb25TdHJpbmcoR2V0TG9jKG4pKSwgbl0gOiB1bmRlZmluZWQpKS5maWx0ZXIoZSA9PiBlKTsKICBsZXQgdHlwZUtleSA9ICd0eXBlJyBpbiBsaXN0WzBdID8gJ3R5cGUnIDogJ2tpbmQnOwogIGxldCBrZXlzID0gWydpZCcsIHR5cGVLZXksICduYW1lJ10uZmlsdGVyKGsgPT4gISFrKTsKICBsZXQgaXRlbXMgPSBlbnRyaWVzLmZpbHRlcigoW2ksIGwsIG5dKSA9PiBwcmVkKG4sIGwpKTsKICBjb25zdCBmaXJzdCA9IGl0ZW1zWzBdWzJdOwogIGlmKC9GdW5jdGlvbi8udGVzdChmaXJzdFt0eXBlS2V5XSkpIHsKICAgIGtleXMgPSBbCiAgICAgIC4uLmtleXMsCiAgICAgIGZ1bmN0aW9uIHJldHVyblR5cGUobikgewogICAgICAgIGlmKG4udHlwZSAmJiB0eXBlb2Ygbi50eXBlID09ICdvYmplY3QnKSB7CiAgICAgICAgICBjb25zdCB7IHF1YWxUeXBlIH0gPSBuLnR5cGU7CiAgICAgICAgICByZXR1cm4gcXVhbFR5cGUucmVwbGFjZSgvXHMqXCguKiQvZywgJycpOwogICAgICAgIH0KICAgICAgICBpZihuW3R5cGVLZXldKQogICAgICAgICAgcmV0dXJuIG5bdHlwZUtleV07CiAgICAgIH0sCiAgICAgIGZ1bmN0aW9uIG51bUFyZ3MobikgewogICAgICAgIGxldCBwYXJhbXMgPSBHZXRQYXJhbXMobik7CiAgICAgICAgcmV0dXJuIHBhcmFtcyA/IHBhcmFtcy5sZW5ndGggOiB1bmRlZmluZWQ7CiAgICAgIH0sCiAgICAgIGZ1bmN0aW9uIFBhcmFtcyhuKSB7CiAgICAgICAgbGV0IHBhcmFtcyA9IEdldFBhcmFtcyhuKTsKICAgICAgICByZXR1cm4gcGFyYW1zID8gcGFyYW1zLm1hcChwID0+IFByaW50QXN0KHApKS5qb2luKCcsJykgOiB1bmRlZmluZWQ7CiAgICAgIH0KICAgIF07CiAgfQogIGtleXMgPSBbJ24nLCAuLi5rZXlzLCAnbG9jYXRpb24nXTsKICBjb25zdCBuYW1lcyA9IGtleXMubWFwKGsgPT4gKHR5cGVvZiBrID09ICdmdW5jdGlvbicgPyBrLm5hbWUgOiBrKSk7CiAgbGV0IHJvd3MgPSBpdGVtcy5tYXAoKFtpLCBsLCBuXSkgPT4KICAgIE9iamVjdC5mcm9tRW50cmllcyhbCiAgICAgIFsnbicsIGldLAogICAgICAuLi5rZXlzLnNsaWNlKDEsIC0xKS5tYXAoKGssIGopID0+IFtuYW1lc1tqICsgMV0sIHR5cGVvZiBrID09ICdzdHJpbmcnID8gbltrXSA6IGsobikgPz8gJyddKSwKICAgICAgWydsb2NhdGlvbicsIGxdCiAgICBdKQogICk7CiAgbGV0IHNpemVzID0ge307CiAgZm9yKGxldCByb3cgb2Ygcm93cykgewogICAgZm9yKGxldCBbaiwgaV0gb2YgbmFtZXMuZW50cmllcygpKSB7CiAgICAgIGNvbnN0IGNvbCA9IHJvd1tpXSArICcnOwogICAgICBpZigoc2l6ZXNbaV0gPz8gMCkgPCBjb2wubGVuZ3RoKSBzaXplc1tpXSA9IGNvbC5sZW5ndGg7CiAgICB9CiAgfQogIGxldCB3aWR0aCA9IG5hbWVzLnJlZHVjZSgoYWNjLCBuYW1lKSA9PiAoYWNjID8gYWNjICsgMyArIHNpemVzW25hbWVdIDogc2l6ZXNbbmFtZV0pLCAwKTsKICBpZih3aWR0aCA+IHJlcGwudGVybVdpZHRoKSBzaXplc1snUGFyYW1zJ10gLT0gd2lkdGggLSByZXBsLnRlcm1XaWR0aDsKCiAgY29uc3QgdHJ1bmMgPSBuYW1lcy5tYXAoKG5hbWUsIGkpID0+IFV0aWwucGFkVHJ1bmMoKGkgPT0gMCA/IC0xIDogMSkgKiBzaXplc1tuYW1lXSkpOwogIGNvbnN0IHBhZCA9IChjb2xzLCBwYWQsIHNlcCkgPT4gewogICAgaWYoIUFycmF5LmlzQXJyYXkoY29scykpIGNvbHMgPSBuYW1lcy5tYXAoKGtleSwgaSkgPT4gY29sc1trZXldKTsKICAgIHJldHVybiBjb2xzCiAgICAgIC5tYXAoKHMsIGNvbCkgPT4gdHJ1bmNbY29sXShzLCBwYWQpKQogICAgICAuam9pbihzZXAgPz8gJyDilIIgJykKICAgICAgLnRyaW1FbmQoKTsKICB9OwogIHJldHVybiAoCiAgICBwYWQobmFtZXMpICsKICAgICdcbicgKwogICAgcGFkKAogICAgICBuYW1lcy5yZWR1Y2UoKGFjYywgbikgPT4gKHsgLi4uYWNjLCBbbl06ICcnIH0pLCB7fSksCiAgICAgICfilIAnLAogICAgICAn4pSA4pS84pSAJwogICAgKSArCiAgICAnXG4nICsKICAgIHJvd3MucmVkdWNlKChhY2MsIHJvdykgPT4gewogICAgICByZXR1cm4gYWNjICsgcGFkKHJvdykuc2xpY2UoMCwgcmVwbC5jb2x1bW5zKSArICdcbic7CiAgICB9LCAnJykKICApOwp9CgpmdW5jdGlvbiBQcmludFJhbmdlKHJhbmdlLCBmaWxlKSB7CiAgaWYoJ3JhbmdlJyBpbiByYW5nZSkgcmFuZ2UgPSByYW5nZS5yYW5nZTsKCiAgY29uc3QgeyBiZWdpbiwgZW5kIH0gPSByYW5nZTsKCiAgZmlsZSA/Pz0gYmVnaW4uZmlsZSA/PyAkLnNvdXJjZTsKCiAgbGV0IGRhdGEgPSBmcy5yZWFkRmlsZVN5bmMoZmlsZSwgJ3V0Zi04Jyk7CiAgcmV0dXJuIGRhdGEgPyBkYXRhLnNsaWNlKGJlZ2luLm9mZnNldCwgZW5kLm9mZnNldCArIChlbmQudG9rTGVuIHwgMCkpIDogbnVsbDsKfQoKZnVuY3Rpb24gT3ZlcmxhcFJhbmdlKHIxLCByMikgewogIGNvbnN0IEdldFJhbmdlID0gciA9PiBbci5iZWdpbi5vZmZzZXQsIHIuZW5kLm9mZnNldCArIChyLmVuZC50b2tMZW4gfCAwKV07CiAgY29uc3QgSW5SYW5nZSA9IChpLCByKSA9PiBpID49IHJbMF0gJiYgaSA8IHJbMV07CgogIHIxID0gR2V0UmFuZ2UocjEpOwogIHIyID0gR2V0UmFuZ2UocjIpOwoKICBpZihJblJhbmdlKHIxWzBdLCByMikgfHwgSW5SYW5nZShyMVsxXSwgcjIpKSByZXR1cm4gdHJ1ZTsKICBpZihJblJhbmdlKHIyWzBdLCByMSkgfHwgSW5SYW5nZShyMlsxXSwgcjEpKSByZXR1cm4gdHJ1ZTsKCiAgcmV0dXJuIGZhbHNlOwp9CgpmdW5jdGlvbiBQYXJlbnROb2RlKG5vZGUsIGFzdCA9ICQuZGF0YSkgewogIGxldCBwID0gUGF0aE9mKG5vZGUsIGFzdCk7CgogIHJldHVybiBwLnVwKDIpLmRlcmVmKGFzdCk7Cn0KCmZ1bmN0aW9uIE5leHRTaWJsaW5nKG5vZGUsIGFzdCA9ICQuZGF0YSkgewogIGxldCBwID0gUGF0aE9mKG5vZGUsIGFzdCk7CiAgcFtwLmxlbmd0aCAtIDFdICs9IDE7CgogIHJldHVybiBwLmRlcmVmKGFzdCk7Cn0KCmZ1bmN0aW9uIFByZXZpb3VzU2libGluZyhub2RlLCBhc3QgPSAkLmRhdGEpIHsKICBsZXQgcCA9IFBhdGhPZihub2RlLCBhc3QpOwogIHBbcC5sZW5ndGggLSAxXSArPSAxOwogIHJldHVybiBwLmRlcmVmKGFzdCk7Cn0KCmZ1bmN0aW9uIEZpcnN0Q2hpbGQobm9kZSwgYXN0ID0gJC5kYXRhKSB7CiAgcmV0dXJuIFBhdGhPZihub2RlLCBhc3QpLmRvd24oJ2lubmVyJywgMCkuZGVyZWYoYXN0KTsKfQoKZnVuY3Rpb24gTGFzdENoaWxkKG5vZGUsIGFzdCA9ICQuZGF0YSkgewogIGxldCBhID0gUGF0aE9mKG5vZGUsIGFzdCkuZG93bignaW5uZXInKS5kZXJlZihhc3QpOwogIHJldHVybiBhW2EubGVuZ3RoIC0gMV07Cn0KCmZ1bmN0aW9uIFRlcm1pbmF0ZShleGl0Q29kZSkgewogIGNvbnNvbGUubG9nKCdUZXJtaW5hdGUnLCBleGl0Q29kZSk7CgogIFV0aWwuZXhpdChleGl0Q29kZSk7Cn0KCmZ1bmN0aW9uIFNoZWxsKGNtZCkgewogIGxldCBmID0gc3RkLnBvcGVuKGNtZCwgJ3InKTsKICBsZXQgcyA9ICcnOwogIHdoaWxlKCFmLmVvZigpICYmICFmLmVycm9yKCkpIHsKICAgIHMgKz0gZi5yZWFkQXNTdHJpbmcoKTsKICB9CiAgZi5jbG9zZSgpOwogIHJldHVybiBzOwp9CgpmdW5jdGlvbiBQYXJzZVN0cnVjdHModGV4dCkgewogIGNvbnN0IHJlID0gLyhbXlxuXSopXHI/XG4vZ215OwogIGxldCBsaW5lLAogICAgZmllbGRzLAogICAgc3RydWN0cyA9IFtdOwoKICB3aGlsZSgobGluZSA9IHJlLmV4ZWModGV4dCkpKSB7CiAgICBpZigvXlxzKiQvZy50ZXN0KGxpbmVbMV0pKSBjb250aW51ZTsKICAgIGxldCBjb2x1bW5zID0gbGluZVsxXS5zcGxpdCgvXHMrL2cpOwoKICAgIGlmKGlzTmFOKCtjb2x1bW5zWzFdKSkgY29udGludWU7CiAgICBsZXQgW25hbWVdID0gY29sdW1uczsKICAgIGlmKGZpZWxkcyAmJiBuYW1lWzBdID09ICcuJykgewogICAgICBsZXQgWywgb2Zmc2V0LCBzaXplXSA9IGNvbHVtbnM7CiAgICAgIGZpZWxkcy5wdXNoKFtuYW1lLCArb2Zmc2V0LCArc2l6ZV0pOwogICAgfSBlbHNlIHsKICAgICAgc3RydWN0cy5wdXNoKFtuYW1lLCB7IHNpemU6ICtjb2x1bW5zWzFdLCBmaWVsZHM6IChmaWVsZHMgPSBbXSkgfV0pOwogICAgfQogIH0KICByZXR1cm4gbmV3IE1hcChzdHJ1Y3RzKTsKfQoKY29uc3QgR2VuZXJhdGVJbnNwZWN0U3RydWN0ID0gU3RyaW5nR2VuZXJhdG9yKGZ1bmN0aW9uKiAoZGVjbCwgaW5jbHVkZXMpIHsKICBsZXQgeyBuYW1lLCBtZW1iZXJzIH0gPSBkZWNsOwoKICBpbmNsdWRlcyA/Pz0gW2RlY2wubG9jLmZpbGUucmVwbGFjZSgvXlwvdXNyXC9pbmNsdWRlXC8vLCAnJyldOwoKICAvL2NvbnNvbGUubG9nKCdHZW5lcmF0ZUluc3BlY3RTdHJ1Y3QnLCB7IG5hbWUsIG1lbWJlcnMsIGluY2x1ZGVzIH0pOwoKICB5aWVsZCAnI2luY2x1ZGUgPHN0ZGlvLmg+JzsKICB5aWVsZCAnI2luY2x1ZGUgPHN0ZGRlZi5oPic7CgogIGlmKE1lbWJlck5hbWVzKG1lbWJlcnMpLnNvbWUobmFtZSA9PiAvOi8udGVzdChuYW1lKSkpCiAgICB5aWVsZCBgCnNpemVfdApieXRlX2ZpcnN0bm90KGNvbnN0IHZvaWQqIHAsIHNpemVfdCBsZW4sIHVuc2lnbmVkIGNoYXIgdikgewogIGNvbnN0IHVuc2lnbmVkIGNoYXIqIHg7CiAgZm9yKHggPSBwOyBsZW47IGxlbi0tLCB4KyspCiAgICBpZigqeCAhPSB2KSBicmVhazsKICByZXR1cm4geCAtIChjb25zdCB1bnNpZ25lZCBjaGFyKilwOwp9CnNpemVfdApieXRlX2xhc3Rub3QoY29uc3Qgdm9pZCogcCwgc2l6ZV90IGxlbiwgdW5zaWduZWQgY2hhciB2KSB7CiAgY29uc3QgdW5zaWduZWQgY2hhciogeDsKICBmb3IoeCA9IChjb25zdCB1bnNpZ25lZCBjaGFyKilwICsgbGVuIC0gMTsgbGVuOyBsZW4tLSwgeC0tKQogICAgaWYoKnggIT0gdikgYnJlYWs7CiAgcmV0dXJuIHggLSAoY29uc3QgdW5zaWduZWQgY2hhciopcDsKfQpzaXplX3QKYml0X2ZpcnN0bm90KHVuc2lnbmVkIGNoYXIgdiwgdW5zaWduZWQgY2hhciBiKSB7CiAgaW50IGk7CiAgZm9yKGkgPSAwOyBpIDwgODsgaSsrLCB2ID4+PSAxKSAKICAgIGlmKCh2ICYgMSkgPT0gIWIpIGJyZWFrOwogIHJldHVybiBpOwp9CnNpemVfdApiaXRfbGFzdG5vdCh1bnNpZ25lZCBjaGFyIHYsIHVuc2lnbmVkIGNoYXIgYikgewogIGludCBpOwogIGZvcihpID0gNzsgaSA+PSAwOyBpLS0pIAogICAgaWYoISEodiAmICgxIDw8IGkpKSA9PSAhYikgYnJlYWs7CiAgcmV0dXJuIGkgPj0gMCA/IGkgOiA4Owp9CnNpemVfdApmaXJzdG5vdChjb25zdCB2b2lkKiBwLCBzaXplX3QgbGVuLCB1bnNpZ25lZCBjaGFyIHYpIHsKIGNvbnN0IGNoYXIqIHggPSBwOwogc2l6ZV90IGkgPSBieXRlX2ZpcnN0bm90KHAsIGxlbiwgdik7CiByZXR1cm4gaSAqIDggKyBiaXRfZmlyc3Rub3QoeFtpXSwgdik7Cn0Kc2l6ZV90Cmxhc3Rub3QoY29uc3Qgdm9pZCogcCwgc2l6ZV90IGxlbiwgdW5zaWduZWQgY2hhciB2KSB7CiBjb25zdCB1bnNpZ25lZCBjaGFyKiB4ID0gcDsKIHNpemVfdCBpID0gYnl0ZV9sYXN0bm90KHAsIGxlbiwgdik7CiByZXR1cm4gaSAqIDggKyBiaXRfbGFzdG5vdCh4W2ldLCB2KTsKfQpzaXplX3QKYml0c2l6ZShjb25zdCB2b2lkKiBwLCBzaXplX3QgbGVuKSB7CiByZXR1cm4gbGFzdG5vdChwLCBsZW4sIDB4ZmYpICsgMSAtIGZpcnN0bm90KHAsIGxlbiwgMHhmZik7Cn0KYDsKCiAgZm9yKGxldCBpbmNsdWRlIG9mIGluY2x1ZGVzKSB5aWVsZCBgI2luY2x1ZGUgIiR7aW5jbHVkZX0iYDsKICB5aWVsZCBgJHtuYW1lfSBzdmFyO2A7CiAgeWllbGQgYGludCBtYWluKCkge2A7CiAgeWllbGQgYCAgcHJpbnRmKCIke25hbWV9ICV6dVxcbiIsIHNpemVvZihzdmFyKSAqIDgpO2A7CgogIGZvcihsZXQgbWVtYmVyIG9mIE1lbWJlck5hbWVzKG1lbWJlcnMpKSB7CiAgICBpZih0cnVlIC8qKHR5cGUgPT0gbnVsbCB8fCB0eXBlb2YgdHlwZS5zaXplID09ICdudW1iZXInKSAmJiBtZW1iZXIgIT0gdW5kZWZpbmVkKi8pIHsKICAgICAgbGV0IGZpZWxkID0gbWVtYmVyLnJlcGxhY2UoLzouKi8sICcnKTsKICAgICAgaWYoLzovLnRlc3QobWVtYmVyKSkgewogICAgICAgIHlpZWxkIGAKICBtZW1zZXQoJnN2YXIsIDB4ZmYsIHNpemVvZihzdmFyKSk7CiAgc3Zhci4ke2ZpZWxkfSA9IDA7CiAgcHJpbnRmKCIuJHtmaWVsZH0gJXp1ICV6aVxcbiIsIGZpcnN0bm90KCZzdmFyLCBzaXplb2Yoc3ZhciksIDB4ZmYpLCBiaXRzaXplKCZzdmFyLCBzaXplb2Yoc3ZhcikpKTtgOwogICAgICB9IGVsc2UgewogICAgICAgIHlpZWxkIGAgIHByaW50ZigiLiR7ZmllbGR9ICV6dSAlenVcXG4iLCBvZmZzZXRvZigke25hbWV9LCAke2ZpZWxkfSkgKiA4LCBzaXplb2Yoc3Zhci4ke2ZpZWxkfSkgKiA4KTtgOwogICAgICB9CiAgICB9CiAgfQoKICB5aWVsZCBgICByZXR1cm4gMDtgOwogIHlpZWxkIGB9YDsKfSk7CgpmdW5jdGlvbiBJbnNwZWN0U3RydWN0KGRlY2wsIGluY2x1ZGVzLCBjb21waWxlciA9ICdjbGFuZycpIHsKICBpZih0eXBlb2YgZGVjbCA9PSAnc3RyaW5nJykgewogICAgbGV0IG5hbWUgPSAoZGVjbC5pbmRleE9mKCcgJykgIT0gLTEgPyAnJyA6ICdzdHJ1Y3QgJykgKyBkZWNsOwogICAgZGVjbCA9IFR5cGUuZ2V0KG5hbWUsICQuZGF0YSk7CiAgICBkZWNsID8/PSAkLmdldFR5cGUobmFtZSk7CiAgICBkZWNsLm5hbWUgPSBuYW1lOwogIH0KICBjb25zb2xlLmxvZygnSW5zcGVjdFN0cnVjdCcsIGRlY2wpOwoKICBjb25zdCBjb2RlID0gWy4uLkdlbmVyYXRlSW5zcGVjdFN0cnVjdChkZWNsLCBpbmNsdWRlcyldLmpvaW4oJ1xuJyk7CiAgY29uc3QgcHJvZ3JhbSA9IGAvdG1wL2luc3BlY3QtJHtkZWNsLm5hbWUucmVwbGFjZSgvIC9nLCAnXycpfWA7CiAgV3JpdGVGaWxlKHByb2dyYW0gKyAnLmMnLCBjb2RlKTsKCiAgbGV0IGNvbW1hbmQgPSBbY29tcGlsZXIsICctTzInLCAnLWcnLCAnLXcnLCAnLW8nLCBwcm9ncmFtLCBwcm9ncmFtICsgJy5jJywgLi4uZmxhZ3NdOwogIGNvbnNvbGUubG9nKCdJbnNwZWN0U3RydWN0JywgeyBjb21tYW5kOiBjb21tYW5kLmpvaW4oJyAnKSB9KTsKCiAgbGV0IHJlc3VsdCA9IG9zLmV4ZWMoY29tbWFuZCk7CgogIGlmKHJlc3VsdCA9PSAwKSB7CiAgICBsZXQgW2ZkLCBzdGRvdXRdID0gb3MucGlwZSgpOwoKICAgIG9zLmV4ZWMoWyhwcm9ncmFtLnN0YXJ0c1dpdGgoJy8nKSA/ICcnIDogYC4vYCkgKyBwcm9ncmFtXSwgeyBzdGRvdXQgfSk7CiAgICBsZXQgb3V0cHV0ID0gZnMucmVhZEFsbChmZCk7CgogICAgbGV0IGxpbmVzID0gb3V0cHV0LnRyaW0oKS5zcGxpdCgnXG4nKTsKICAgIGxldCBmaXJzdExpbmUgPSBsaW5lcy5zaGlmdCgpOwoKICAgIGxldCBbbmFtZSwgc2l6ZV0gPSBbLi4uVXRpbC5zcGxpdEF0KGZpcnN0TGluZSwgWy4uLmZpcnN0TGluZV0ubGFzdEluZGV4T2YoJyAnKSldOwoKICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoL14oc3RydWN0fHVuaW9ufGVudW0pXCAvLCAnJyk7CgogICAgLy9jb25zb2xlLmxvZygibGluZXM6IiwgbGluZXMpOwogICAgcmVzdWx0ID0gbGluZXMKICAgICAgLm1hcChsaW5lID0+ICh0eXBlb2YgbGluZSA9PSAnc3RyaW5nJyA/IGxpbmUuc3BsaXQoJyAnKSA6IGxpbmUpKQogICAgICAubWFwKGxpbmUgPT4gbGluZS5tYXAoKGNvbCwgaSkgPT4gKGlzTmFOKCtjb2wpID8gY29sIDogK2NvbCkpKQogICAgICAubWFwKChbZmllbGQsIG9mZnNldCwgc2l6ZV0pID0+IFtmaWVsZC5yZXBsYWNlKC86LiovLCAnJykucmVwbGFjZSgvXlwuLywgbmFtZSArICcuJyksIG9mZnNldCwgc2l6ZV0pOwoKICAgIGxldCBlbmQgPSAwOwogICAgcmVzdWx0ID0gcmVzdWx0LnJlZHVjZSgoYWNjLCBsaW5lKSA9PiB7CiAgICAgIGlmKGFjYy5sZW5ndGgpIHsKICAgICAgICBpZihlbmQgPCBhY2MubGFzdFsxXSArIGFjYy5sYXN0WzJdKSBlbmQgPSBhY2MubGFzdFsxXSArIGFjYy5sYXN0WzJdOwoKICAgICAgICBpZihlbmQgPCBsaW5lWzFdKSBhY2MucHVzaChbbnVsbCwgZW5kLCBsaW5lWzFdIC0gZW5kXSk7CiAgICAgIH0KICAgICAgYWNjLnB1c2gobGluZSk7CiAgICAgIHJldHVybiBhY2M7CiAgICB9LCBbXSk7CgogICAgcmVzdWx0LnVuc2hpZnQoW25hbWUsICctJywgK3NpemVdKTsKCiAgICBVdGlsLmRlZmluZShyZXN1bHQsIHsKICAgICAgdG9TdHJpbmcoc2VwID0gJyAnKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubWFwKGxpbmUgPT4gbGluZS5qb2luKHNlcCkucmVwbGFjZSgnLicsICcgJykpLmpvaW4oJ1xuJyk7CiAgICAgIH0KICAgIH0pOwogIH0KCiAgcmV0dXJuIHJlc3VsdDsKfQoKZnVuY3Rpb24gUm91bmRUbyh2YWx1ZSwgYWxpZ24pIHsKICByZXR1cm4gTWF0aC5mbG9vcigodmFsdWUgKyAoYWxpZ24gLSAxKSkgLyBhbGlnbikgKiBhbGlnbjsKfQoKZnVuY3Rpb24gTWFrZVN0cnVjdENsYXNzKGRlY2wsIGZpbGVuYW1lKSB7CiAgbGV0IGNvZGUgPSBbLi4uR2VuZXJhdGVTdHJ1Y3RDbGFzcyhkZWNsKV0uam9pbignXG4nKTsKCiAgV3JpdGVGaWxlKChmaWxlbmFtZSA/PyBkZWNsLm5hbWUucmVwbGFjZSgvW15BLVphLXowLTlfXS9nLCAnLScpKSArICcuanMnLCBjb2RlKTsKCiAgaWYoIWZpbGVuYW1lKSByZXR1cm4gY29kZTsKfQoKZnVuY3Rpb24qIEdlbmVyYXRlU3RydWN0Q2xhc3MoZGVjbCwgZmZpUHJlZml4ID0gJycpIHsKICBsZXQgbmFtZTsKICBpZihkZWNsIGluc3RhbmNlb2YgVHlwZWRlZkRlY2wpIHsKICAgIG5hbWUgPSBkZWNsLm5hbWU7CiAgICBkZWNsID0gZGVjbC50eXBlOwogIH0KCiAgbGV0IHsgc2l6ZSwgbWVtYmVycyB9ID0gZGVjbDsKICBuYW1lID8/PSBkZWNsLm5hbWU7CgogIGxldCBjbGFzc05hbWUgPSBuYW1lLnJlcGxhY2UoL3N0cnVjdFxzKi8sICcnKTsKICB5aWVsZCBgY2xhc3MgJHtjbGFzc05hbWV9IGV4dGVuZHMgQXJyYXlCdWZmZXIge2A7CiAgeWllbGQgYCAgY29uc3RydWN0b3Iob2JqID0ge30pIHtcbiAgICBzdXBlcigke3NpemV9KTtcbiAgICBPYmplY3QuYXNzaWduKHRoaXMsIG9iaik7XG4gIH1gOwogIHlpZWxkIGAgIGdldCBbU3ltYm9sLnRvU3RyaW5nVGFnXSgpIHsgcmV0dXJuIFxgWyR7bmFtZX0gQCBcJHt0aGlzfSBdXGA7IH1gOwogIGxldCBmaWVsZHMgPSBbXTsKICBsZXQgb2Zmc2V0ID0gMDsKCiAgY29uc29sZS5sb2coJ0dlbmVyYXRlU3RydWN0Q2xhc3MnLCBkZWNsKTsKICBmb3IobGV0IFtuYW1lLCB0eXBlXSBvZiBtZW1iZXJzKSB7CiAgICBpZigvcmVzZXJ2ZWQvLnRlc3QobmFtZSkpIGNvbnRpbnVlOwoKICAgIGlmKHR5cGUuc2l6ZSA9PSA4KSBvZmZzZXQgPSBSb3VuZFRvKG9mZnNldCwgOCk7CiAgICBsZXQgZGVzdWdhcmVkID0gdHlwZS5kZXN1Z2FyZWQgJiYgdHlwZS5kZXN1Z2FyZWQgIT0gdHlwZSA/IGAgKCR7dHlwZS5kZXN1Z2FyZWR9KWAgOiAnJzsKICAgIGxldCBwb2ludGVyID0gdHlwZS5wb2ludGVyOwoKICAgIHlpZWxkICcnOwogICAgbGV0IHN1YnNjcmlwdCA9IHR5cGUuc3Vic2NyaXB0ID8/ICcnOwogICAgeWllbGQgYCAgLyogJHtvZmZzZXR9OiAke3R5cGV9JHtkZXN1Z2FyZWR9ICR7bmFtZX0ke3N1YnNjcmlwdH0gKi9gOwogICAgdHJ5IHsKICAgICAgeWllbGQqIEdlbmVyYXRlR2V0U2V0KG5hbWUsIG9mZnNldCwgdHlwZSwgZmZpUHJlZml4KS5tYXAobGluZSA9PiBgICAke2xpbmV9YCk7CiAgICB9IGNhdGNoKGUpIHt9CiAgICBmaWVsZHMucHVzaChuYW1lKTsKCiAgICBvZmZzZXQgKz0gUm91bmRUbyh0eXBlLnNpemUsIDQpOwogIH0KICB5aWVsZCAnJzsKICB5aWVsZCBgICBzdGF0aWMgZnJvbShhZGRyZXNzKSB7XG4gICAgbGV0IHJldCA9ICR7ZmZpUHJlZml4fXRvQXJyYXlCdWZmZXIoYWRkcmVzcywgJHtvZmZzZXR9KTtcbiAgICByZXR1cm4gT2JqZWN0LnNldFByb3RvdHlwZU9mKHJldCwgJHtjbGFzc05hbWV9LnByb3RvdHlwZSk7XG4gIH1gOwogIHlpZWxkICcnOwoKICB5aWVsZCBgICB0b1N0cmluZygpIHtcbiAgICBjb25zdCB7ICR7ZmllbGRzLmpvaW4oJywgJyl9IH0gPSB0aGlzO1xuICAgIHJldHVybiBcYCR7bmFtZX0geyR7Wy4uLm1lbWJlcnNdCiAgICAubWFwKAogICAgICAoW2ZpZWxkLCBtZW1iZXJdKSA9PgogICAgICAgICdcXG5cXHQuJyArCiAgICAgICAgZmllbGQgKwogICAgICAgICcgPSAnICsKICAgICAgICAobWVtYmVyLmlzUG9pbnRlcigpID8gJzB4JyA6ICcnKSArCiAgICAgICAgJyR7JyArCiAgICAgICAgZmllbGQgKwogICAgICAgIChtZW1iZXIuaXNQb2ludGVyKCkgPyAnLnRvU3RyaW5nKDE2KScgOiAnJykgKwogICAgICAgICd9JwogICAgKQogICAgLmpvaW4oJywnKX1cXG59XGA7XG4gIH1gOwogIHlpZWxkICd9JzsKfQoKZnVuY3Rpb24gR2VuZXJhdGVHZXRTZXQobmFtZSwgb2Zmc2V0LCB0eXBlLCBmZmlQcmVmaXgpIHsKICBjb25zdCB7IHNpemUsIHNpZ25lZCB9ID0gdHlwZTsKICBjb25zdCBmbG9hdGluZyA9IHR5cGUuaXNGbG9hdGluZ1BvaW50KCk7CiAgY29uc3QgcG9pbnRlciA9IHR5cGUuZ2V0UG9pbnRlcigkLmRhdGEpOwogIGxldCBjdG9yID0gQnl0ZUxlbmd0aDJUeXBlZEFycmF5KHNpemUsIHNpZ25lZCwgZmxvYXRpbmcpOwogIGxldCB0b0hleCA9IHYgPT4gdjsKICBpZih0eXBlLmlzUG9pbnRlcigpKSB0b0hleCA9IHYgPT4gYCcweCcrJHt2fS50b1N0cmluZygxNilgOwoKICBsZXQgYSA9IFtdOwoKICBpZihwb2ludGVyKSB7CiAgICBsZXQgeyBuYW1lLCBzaXplLCBzaWduZWQsIGRlc3VnYXJlZCB9ID0gcG9pbnRlcjsKICAgIGEudW5zaGlmdChgLyogJHtuYW1lfSR7ZGVzdWdhcmVkID8gYCAoJHtkZXN1Z2FyZWR9KWAgOiAnJ30gJHtzaXplfSAke3NpZ25lZH0gKi9gKTsKICAgIGNvbnNvbGUubG9nKCdHZW5lcmF0ZVN0cnVjdENsYXNzJywgeyBwb2ludGVyIH0pOwogIH0KICByZXR1cm4gWwogICAgLi4uYSwKICAgIGBzZXQgJHtuYW1lfSh2YWx1ZSkgeyBpZih0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCcgJiYgdmFsdWUgIT0gbnVsbCAmJiB2YWx1ZSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB2YWx1ZSA9ICR7ZmZpUHJlZml4fXRvUG9pbnRlcih2YWx1ZSk7IG5ldyAke2N0b3J9KHRoaXMsICR7b2Zmc2V0fSlbMF0gPSAke0J5dGVMZW5ndGgyVmFsdWUoCiAgICAgIHNpemUsCiAgICAgIHNpZ25lZCwKICAgICAgZmxvYXRpbmcKICAgICl9OyB9YCwKICAgIGBnZXQgJHtuYW1lfSgpIHsgcmV0dXJuICR7dG9IZXgoYG5ldyAke2N0b3J9KHRoaXMsICR7b2Zmc2V0fSlbMF1gKX07IH1gCiAgXTsKfQoKZnVuY3Rpb24gQnl0ZUxlbmd0aDJUeXBlZEFycmF5KGJ5dGVMZW5ndGgsIHNpZ25lZCwgZmxvYXRpbmcpIHsKICBpZihmbG9hdGluZykgewogICAgc3dpdGNoIChieXRlTGVuZ3RoKSB7CiAgICAgIGNhc2UgNDoKICAgICAgICByZXR1cm4gJ0Zsb2F0MzJBcnJheSc7CiAgICAgIGNhc2UgODoKICAgICAgICByZXR1cm4gJ0Zsb2F0NjRBcnJheSc7CiAgICAgIGRlZmF1bHQ6CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGbG9hdGluZyBwb2ludCwgYnV0ICR7Ynl0ZUxlbmd0aH0gc2l6ZWApOwogICAgfQogIH0KICBzd2l0Y2ggKGJ5dGVMZW5ndGgpIHsKICAgIGNhc2UgMToKICAgICAgcmV0dXJuIHNpZ25lZCA/ICdJbnQ4QXJyYXknIDogJ1VpbnQ4QXJyYXknOwogICAgY2FzZSAyOgogICAgICByZXR1cm4gc2lnbmVkID8gJ0ludDE2QXJyYXknIDogJ1VpbnQxNkFycmF5JzsKICAgIGNhc2UgNDoKICAgICAgcmV0dXJuIHNpZ25lZCA/ICdJbnQzMkFycmF5JyA6ICdVaW50MzJBcnJheSc7CiAgICBjYXNlIDg6CiAgICAgIHJldHVybiBzaWduZWQgPyAnQmlnSW50NjRBcnJheScgOiAnQmlnVWludDY0QXJyYXknOwogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuIHNpZ25lZCA/ICdJbnQ4QXJyYXknIDogJ1VpbnQ4QXJyYXknOwogIH0KfQoKZnVuY3Rpb24gQnl0ZUxlbmd0aDJWYWx1ZShieXRlTGVuZ3RoLCBzaWduZWQsIGZsb2F0aW5nKSB7CiAgaWYoYnl0ZUxlbmd0aCA9PSA4ICYmICFmbG9hdGluZykgcmV0dXJuICdCaWdJbnQodmFsdWUpJzsKICByZXR1cm4gJ3ZhbHVlJzsKfQoKZXhwb3J0IGNsYXNzIEZGSV9GdW5jdGlvbiB7CiAgY29uc3RydWN0b3Iobm9kZSwgcHJlZml4ID0gJycpIHsKICAgIGNvbnN0IHsgbmFtZSwgcmV0dXJuVHlwZSA9ICd2b2lkJywgcGFyYW1ldGVycyA9IFtdIH0gPSBub2RlOwogICAgY29uc29sZS5sb2coJ0ZGSV9GdW5jdGlvbi5jb25zdHJ1Y3RvcicsIG5vZGUsIHsgbmFtZSwgcGFyYW1ldGVycyB9KTsKICAgIHRoaXMubmFtZSA9IG5hbWU7CiAgICB0aGlzLnByZWZpeCA9IHByZWZpeDsKICAgIHRoaXMucmV0dXJuVHlwZSA9IHJldHVyblR5cGUuZmZpOwogICAgdGhpcy5wYXJhbWV0ZXJzID0gWy4uLihwYXJhbWV0ZXJzIHx8IFtdKV0ubWFwKChbbmFtZSwgdHlwZV0sIGlkeCkgPT4gW25hbWUgPz8gYGFyZyR7aWR4ICsgMX1gLCB0eXBlLmZmaV0pOwogIH0KCiAgZ2VuZXJhdGVEZWZpbmUoZnAsIGxpYikgewogICAgY29uc3QgeyBwcmVmaXgsIG5hbWUsIHJldHVyblR5cGUsIHBhcmFtZXRlcnMgfSA9IHRoaXM7CiAgICBmcCA/Pz0gKG5hbWUsIGxpYikgPT4gYCR7cHJlZml4fWRsc3ltKCR7bGliID8/ICdSVExEX0RFRkFVTFQnfSwgJyR7bmFtZX0nKWA7CiAgICBsZXQgY29kZSA9IGAnJHtuYW1lfScsICR7ZnAobmFtZSwgbGliKX0sIG51bGwsICcke3JldHVyblR5cGV9J2A7CiAgICBjb25zb2xlLmxvZygnZnVuY3Rpb24nLCBVdGlsLmNvbG9yVGV4dChuYW1lLCAxLCAzMyksICdyZXR1cm5UeXBlOicsIFV0aWwuY29sb3JUZXh0KHJldHVyblR5cGUsIDEsIDMxKSk7CiAgICBsZXQgcGFyYW1JbmRleCA9IDA7CiAgICBmb3IobGV0IFtwYXJhbU5hbWUsIHR5cGVdIG9mIHBhcmFtZXRlcnMpIHsKICAgICAgKytwYXJhbUluZGV4OwogICAgICAvL2NvbnNvbGUubG9nKGBwYXJhbSAjJHtwYXJhbUluZGV4fWAsIC4uLihwYXJhbU5hbWUgPyBbJ25hbWU6JywgcGFyYW1OYW1lXSA6IFtdKSwgJ3R5cGU6JywgdHlwZSk7CiAgICAgIGNvZGUgKz0gJywgJzsKICAgICAgY29kZSArPSBgJyR7dHlwZX0nYDsKICAgIH0KICAgIHJldHVybiBgJHtwcmVmaXh9ZGVmaW5lKCR7Y29kZX0pO2A7CiAgfQoKICBnZW5lcmF0ZURvYygpIHsKICAgIGNvbnN0IHsgcHJlZml4LCBuYW1lLCByZXR1cm5UeXBlLCBwYXJhbWV0ZXJzIH0gPSB0aGlzOwogICAgY29uc3QgbGluZXMgPSBbXTsKICAgIGNvbnN0IGNvbHVtbnMgPSBbMTAsIDE2XTsKICAgIGNvbnN0IHB1c2ggPSAoLi4uYXJncykgPT4KICAgICAgbGluZXMucHVzaCgKICAgICAgICBbLi4uYXJnc10KICAgICAgICAgIC5tYXAoZmllbGQgPT4gKHR5cGVvZiBmaWVsZCAhPSAnc3RyaW5nJyA/ICcnIDogZmllbGQpKQogICAgICAgICAgLm1hcCgoZmllbGQsIGNvbCkgPT4gZmllbGQucGFkRW5kKGNvbHVtbnNbY29sXSA/PyAwKSkKICAgICAgICAgIC5qb2luKCcnKQogICAgICApOwogICAgcHVzaCgnLyoqJyk7CgogICAgcHVzaChgQGZ1bmN0aW9uYCwgYCR7bmFtZX1gKTsKICAgIGlmKHBhcmFtZXRlcnMubGVuZ3RoKSBwdXNoKCk7CgogICAgbGV0IGpzID0gdHlwZSA9PiB7CiAgICAgIGxldCB0eXBlT2JqID0gVHlwZS5kZWNsYXJhdGlvbnMuZ2V0KHR5cGUpOwogICAgICByZXR1cm4gdHlwZU9iaiA/IHR5cGVPYmoudG9KUygpIDogdHlwZTsKICAgIH07CgogICAgZm9yKGxldCBbcGFyYW1OYW1lLCB0eXBlXSBvZiBwYXJhbWV0ZXJzKSB7CiAgICAgIC8vY29uc29sZS5sb2coY29uc29sZS5jb25maWcoeyBicmVha0xlbmd0aDogSW5maW5pdHkgfSksIHsgcGFyYW1OYW1lLCB0eXBlIH0pOwoKICAgICAgcHVzaChgQHBhcmFtYCwgYHske2pzKHR5cGUpfX1gLCBwYXJhbU5hbWUpOwogICAgfQogICAgaWYocmV0dXJuVHlwZSAhPSAndm9pZCcpIHsKICAgICAgcHVzaCgpOwogICAgICBwdXNoKGBAcmV0dXJuYCwgYHske2pzKHJldHVyblR5cGUpfX1gKTsKICAgIH0KICAgIHJldHVybiBsaW5lcy5qb2luKCdcbiAqICcpICsgJ1xuICovXG4nOwogIH0KCiAgZ2VuZXJhdGVDYWxsKCkgewogICAgY29uc3QgeyBwcmVmaXgsIG5hbWUsIHJldHVyblR5cGUsIHBhcmFtZXRlcnMgfSA9IHRoaXM7CiAgICBjb25zdCBwYXJhbU5hbWVzID0gcGFyYW1ldGVycy5tYXAoKFtuYW1lLCB0eXBlXSkgPT4gbmFtZSk7CiAgICBsZXQgY29kZSA9IGBmdW5jdGlvbiAke25hbWV9KCR7cGFyYW1OYW1lcy5qb2luKCcsICcpfSkge1xuYDsKICAgIGNvZGUgKz0gYCAgJHtyZXR1cm5UeXBlICE9ICd2b2lkJyA/ICdyZXR1cm4gJyA6ICcnfSR7cHJlZml4fWNhbGwoJyR7bmFtZX0nLCAke3BhcmFtTmFtZXMuam9pbignLCAnKX0pO1xuYDsKICAgIGNvZGUgKz0gYH1gOwogICAgcmV0dXJuIGNvZGU7CiAgfQoKICBnZW5lcmF0ZShmcCwgbGliLCBleHApIHsKICAgIHJldHVybiBbdGhpcy5nZW5lcmF0ZURlZmluZShmcCwgbGliKSwgJ1xuJywgZXhwID8gJ2V4cG9ydCAnIDogJycsIHRoaXMuZ2VuZXJhdGVDYWxsKCksICdcbiddLmpvaW4oJycpOwogIH0KCiAgZ2VuZXJhdGVGdW5jdGlvbihmcCwgbGliKSB7CiAgICBjb25zdCB7IHByZWZpeCwgbmFtZSwgcmV0dXJuVHlwZSwgcGFyYW1ldGVycyB9ID0gdGhpczsKICAgIGNvbnN0IHBhcmFtTmFtZXMgPSBwYXJhbWV0ZXJzLm1hcCgoW25hbWUsIHR5cGVdKSA9PiBuYW1lKTsKICAgIGxldCBjb2RlID0gYG5ldyBGdW5jdGlvbigke3BhcmFtTmFtZXMubWFwKHAgPT4gYCcke3B9J2ApLmpvaW4oJywgJyl9LCBgOwoKICAgIGNvZGUgKz0gYCdyZXR1cm4gJHtwcmVmaXh9Y2FsbCgiJHtuYW1lfSIke3BhcmFtTmFtZXMubWFwKHAgPT4gYCwgJHtwfWApLmpvaW4oJycpfSknKTtgOwogICAgcmV0dXJuIGNvZGU7CiAgfQoKICBjb21waWxlRnVuY3Rpb24oZnAsIGxpYikgewogICAgbGV0IGNvZGUgPSB0aGlzLmdlbmVyYXRlQ2FsbChmcCwgbGliKTsKICAgIGxldCBmbiA9IG5ldyBGdW5jdGlvbihgcmV0dXJuICR7Y29kZX1gKTsKICAgIHJldHVybiBmbigpOwogIH0KfQoKZnVuY3Rpb24gRmRSZWFkZXIoZmQsIGJ1ZmZlclNpemUgPSAxMDI0KSB7CiAgbGV0IGJ1ZiA9IGZzLmJ1ZmZlcihidWZmZXJTaXplKTsKICByZXR1cm4gbmV3IFJlcGVhdGVyKGFzeW5jIChwdXNoLCBzdG9wKSA9PiB7CiAgICBsZXQgcmV0OwogICAgZG8gewogICAgICBsZXQgciA9IGF3YWl0IGZzLndhaXRSZWFkKGZkKTsKICAgICAgcmV0ID0gZnMucmVhZChmZCwgYnVmKTsKICAgICAgaWYocmV0ID4gMCkgewogICAgICAgIGxldCBkYXRhID0gYnVmLnNsaWNlKDAsIHJldCk7CiAgICAgICAgYXdhaXQgcHVzaChmcy5idWZmZXJUb1N0cmluZyhkYXRhKSk7CiAgICAgIH0KICAgIH0gd2hpbGUocmV0ID09IGJ1ZmZlclNpemUpOwogICAgc3RvcCgpOwogICAgZnMuY2xvc2UoZmQpOwogIH0pOwp9CgpleHBvcnQgYXN5bmMgZnVuY3Rpb24gQ29tbWFuZFJlYWQoYXJncykgewogIGxldCBjaGlsZCA9IHNwYXduKGFyZ3MsIHsKICAgIGJsb2NrOiBmYWxzZSwKICAgIHN0ZGlvOiBbJ2luaGVyaXQnLCAncGlwZScsICdpbmhlcml0J10KICB9KTsKICBsZXQgb3V0cHV0ID0gJyc7CiAgbGV0IGRvbmUgPSBmYWxzZTsKICBsZXQgYnVmID0gbmV3IEFycmF5QnVmZmVyKDEwMjQpOwogIGlmKFV0aWwucGxhdGZvcm0gPT0gJ3F1aWNranMnKSB7CiAgICBsZXQgeyBmZCB9ID0gY2hpbGQuc3Rkb3V0OwogICAgLy9yZXR1cm4gYXdhaXQgKGFzeW5jIGZ1bmN0aW9uKCkgewogICAgZm9yKDs7KSB7CiAgICAgIDE7CiAgICAgIGxldCByOwogICAgICBhd2FpdCBmcy53YWl0UmVhZChmZCk7CiAgICAgIHIgPSBSZWFkT3V0cHV0KGZkKTsKICAgICAgaWYociA+IDAgJiYgciA8IGJ1Zi5ieXRlTGVuZ3RoKSBicmVhazsKICAgIH0KICAgIGxldCByZXN1bHQgPSBhd2FpdCBjaGlsZC53YWl0KCk7CiAgICAvL2NvbnNvbGUubG9nKCdjaGlsZC53YWl0KCk6JywgcmVzdWx0KTsKICAgIHJldHVybiBvdXRwdXQudHJpbUVuZCgpOwogICAgLy99KSgpOwogIH0gZWxzZSB7CiAgICBBY3F1aXJlUmVhZGVyKGNoaWxkLnN0ZG91dCwgYXN5bmMgcmVhZGVyID0+IHsKICAgICAgbGV0IHI7CiAgICAgIHdoaWxlKChyID0gYXdhaXQgcmVhZGVyLnJlYWQoKSkpIHsKICAgICAgICBpZighci5kb25lKSBlcnJvcnMgKz0gci52YWx1ZS50b1N0cmluZygpOwogICAgICB9CiAgICB9KTsKICB9CiAgZnVuY3Rpb24gUmVhZE91dHB1dChmZCkgewogICAgbGV0IGJ1ZiA9IG5ldyBBcnJheUJ1ZmZlcigxMDI0KTsKICAgIGxldCByID0gb3MucmVhZChmZCwgYnVmLCAwLCBidWYuYnl0ZUxlbmd0aCk7CiAgICBvdXRwdXQgKz0gZnMuYnVmZmVyVG9TdHJpbmcoYnVmLnNsaWNlKDAsIHIpKTsKICAgIC8vaWYociA+IDApIGNvbnNvbGUubG9nKCdyOicsIHIsICdvdXRwdXQ6Jywgb3V0cHV0LnNsaWNlKC0xMDApKTsKICAgIHJldHVybiByOwogIH0KfQoKZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIExpYnJhcnlFeHBvcnRzKGZpbGUpIHsKICBjb25zb2xlLmxvZyhgTGlicmFyeUV4cG9ydHM6YCwgZmlsZSk7CgogIGxldCBvdXRwdXQgPSBhd2FpdCBDb21tYW5kUmVhZChbJy9vcHQvZGlldC9iaW4vb2JqZHVtcCcsICctVCcsIGZpbGVdKTsKICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZSgvLipEWU5BTUlDIFNZTUJPTCBUQUJMRTpccy9tLCAnJyk7CiAgbGV0IGxpbmVzID0gb3V0cHV0LnNwbGl0KC9cbi9nKS5maWx0ZXIobGluZSA9PiAvXHNCYXNlXHMvLnRlc3QobGluZSkpOwogIGxldCBjb2x1bW5zID0gVXRpbC5jb2xJbmRleGVzKGxpbmVzWzBdKTsKCiAgbGV0IGVudHJpZXMgPSBsaW5lcy5tYXAobGluZSA9PiBVdGlsLmNvbFNwbGl0KGxpbmUsIGNvbHVtbnMpLm1hcChjb2x1bW4gPT4gY29sdW1uLnRyaW1FbmQoKSkpOwogIGVudHJpZXMuc29ydCgoYSwgYikgPT4gYVswXS5sb2NhbGVDb21wYXJlKGJbMF0pKTsKCiAgcmV0dXJuIGVudHJpZXMubWFwKGVudHJ5ID0+IGVudHJ5W2VudHJ5Lmxlbmd0aCAtIDFdLnRyaW1TdGFydCgpKTsKfQoKZnVuY3Rpb24gU2F2ZUxpYnJhcmllcygpIHsKICBjb25zdCBsYXllcnMgPSBPYmplY3QudmFsdWVzKAogICAgWy4uLnByb2plY3Quc2NoZW1hdGljLmxheWVycywgLi4ucHJvamVjdC5ib2FyZC5sYXllcnNdLnJlZHVjZSgoYWNjLCBbbiwgZV0pID0+ICh7IC4uLmFjYywgW25dOiBlLnJhdyB9KSwge30pCiAgKTsKfQoKZnVuY3Rpb24gUHJvY2Vzc0ZpbGUoZmlsZSwgZGVidWcgPSB0cnVlKSB7CiAgY29uc3QgZXh0ID0gcGF0aC5leHRuYW1lKGZpbGUpOwogIGxldCByZXQgPSBudWxsOwogIHN3aXRjaCAoZXh0KSB7CiAgICBjYXNlICcuanMnOgogICAgICByZXQgPSBQYXJzZUVDTUFTY3JpcHQoZmlsZSwgZGVidWcpOwogICAgICBicmVhazsKICAgIGNhc2UgJy5jcHAnOgogICAgY2FzZSAnLmN4eCc6CiAgICBjYXNlICcuY2MnOgogICAgY2FzZSAnLmMnOgogICAgY2FzZSAnLmgnOgogICAgICByZXQgPSBDb21waWxlKGZpbGUgLyosIGRlYnVnKi8pOwogICAgICBicmVhazsKICB9CiAgcmV0dXJuIHJldDsKfQoKZnVuY3Rpb24gUGFyc2VFQ01BU2NyaXB0KGZpbGUsIHBhcmFtcyA9IHt9KSB7CiAgbGV0IGRhdGEsIGIsIHJldDsKICBjb25zdCB7IGRlYnVnIH0gPSBwYXJhbXM7CiAgaWYoZmlsZSA9PSAnLScpIGZpbGUgPSAnL2Rldi9zdGRpbic7CiAgaWYoZmlsZSAmJiBmcy5leGlzdHNTeW5jKGZpbGUpKSB7CiAgICBkYXRhID0gZnMucmVhZEZpbGVTeW5jKGZpbGUsICd1dGY4Jyk7CiAgICBjb25zb2xlLmxvZygnb3BlbmVkOicsIGZpbGUpOwogIH0gZWxzZSB7CiAgICBmaWxlID0gJ3N0ZGluJzsKICAgIGRhdGEgPSBzb3VyY2U7CiAgfQogIGNvbnNvbGUubG9nKCdPSywgZGF0YTogJywgVXRpbC5hYmJyZXZpYXRlKFV0aWwuZXNjYXBlKGRhdGEpKSk7CiAgaWYoZGVidWcpIEVDTUFTY3JpcHRQYXJzZXIuaW5zdHJ1bWVudGF0ZSgpOwogIGNvbnNvbGUubG9nKCdFQ01BU2NyaXB0UGFyc2VyOicsIEVDTUFTY3JpcHRQYXJzZXIpOwoKICBsZXQgcGFyc2VyLCBhc3QsIGVycm9yOwogIGdsb2JhbFRoaXMucGFyc2VyID0gcGFyc2VyID0gbnVsbDsKICBnbG9iYWxUaGlzLnBhcnNlciA9IHBhcnNlciA9IG5ldyBFQ01BU2NyaXB0UGFyc2VyKGRhdGEgPyBkYXRhLnRvU3RyaW5nKCkgOiBkYXRhLCBmaWxlLCBkZWJ1Zyk7CgogIHRyeSB7CiAgICBhc3QgPSBwYXJzZXIucGFyc2VQcm9ncmFtKCk7CiAgfSBjYXRjaChlcnIpIHsKICAgIGNvbnN0IHRva2VucyA9IFsuLi5wYXJzZXIucHJvY2Vzc2VkLCAuLi5wYXJzZXIudG9rZW5zXTsKICAgIGNvbnN0IHRva2VuID0gdG9rZW5zW3Rva2Vucy5sZW5ndGggLSAxXTsKCiAgICBjb25zb2xlLmxvZygncGFyc2VQcm9ncmFtIHRva2VuJywgdG9rZW4pOwoKICAgIGlmKGVyciAhPT0gbnVsbCkgewogICAgICBjb25zb2xlLmxvZygncGFyc2VQcm9ncmFtIEVSUk9SIG1lc3NhZ2U6JywgZXJyPy5tZXNzYWdlKTsKICAgICAgY29uc29sZS5sb2coCiAgICAgICAgJ3BhcnNlUHJvZ3JhbSBFUlJPUiBzdGFjazpcbiAgJyArCiAgICAgICAgICBuZXcgU3RhY2soZXJyPy5zdGFjaywgKGZyLCBpKSA9PiBmci5mdW5jdGlvbk5hbWUgIT0gJ2VzZmFjdG9yeScgJiYgaSA8IDUpLnRvU3RyaW5nKCkucmVwbGFjZSgvXG4vZywgJ1xuICAnKQogICAgICApOwoKICAgICAgdGhyb3cgZXJyOwogICAgfSBlbHNlIHsKICAgICAgY29uc29sZS5sb2coJ3BhcnNlUHJvZ3JhbSBFUlJPUjonLCBlcnIpOwogICAgICB0aHJvdyBuZXcgRXJyb3IoJ3BhcnNlUHJvZ3JhbScpOwogICAgfQogIH0KCiAgcGFyc2VyLmFkZENvbW1lbnRzVG9Ob2Rlcyhhc3QpOwogIHJldHVybiBhc3Q7Cn0KCi8qZnVuY3Rpb24gUGFyc2VFQ01BU2NyaXB0KGZpbGUsIGRlYnVnID0gZmFsc2UpIHsKICBjb25zb2xlLmxvZyhgUGFyc2luZyAnJHtmaWxlfScuLi5gKTsKICBsZXQgZGF0YSA9IGZzLnJlYWRGaWxlU3luYyhmaWxlLCAndXRmLTgnKTsKICBsZXQgYXN0LCBlcnJvcjsKICBsZXQgcGFyc2VyOwogIGNvbnNvbGUubG9nKCdkYXRhJywgZGF0YSk7CiAgZ2xvYmFsVGhpcy5wYXJzZXIgPSBwYXJzZXIgPSBuZXcgRUNNQVNjcmlwdFBhcnNlcihkYXRhPy50b1N0cmluZyA/IGRhdGEudG9TdHJpbmcoKSA6IGRhdGEsIGZpbGUsIGRlYnVnKTsKCiAgZ2xvYmFsVGhpcy5hc3QgPSBhc3QgPSBwYXJzZXIucGFyc2VQcm9ncmFtKCk7CiAgcGFyc2VyLmFkZENvbW1lbnRzVG9Ob2Rlcyhhc3QpOwoKICBnbG9iYWxUaGlzLmZpbGVzW2ZpbGVdID0gYXN0OwoKICByZXR1cm4gewogICAgYXN0LAogICAgZ2V0IGRhdGEoKSB7CiAgICAgIHJldHVybiB0aGlzLmFzdDsKICAgIH0KICB9Owp9Ki8KCmZ1bmN0aW9uIFByaW50RUNNQVNjcmlwdChhc3QsIGNvbW1lbnRzLCBwcmludGVyID0gbmV3IEVDTUFTY3JpcHQuUHJpbnRlcih7IGluZGVudDogNCB9LCBjb21tZW50cykpIHsKICByZXR1cm4gcHJpbnRlci5wcmludChhc3QpOwp9CgpmdW5jdGlvbiBQcmludENBcnJheShzdHJpbmdzKSB7CiAgbGV0IG8gPSAnJzsKCiAgZm9yKGxldCBzdHIgb2Ygc3RyaW5ncykgewogICAgaWYobyAhPSAnJykgbyArPSAnLCAnOwoKICAgIGlmKHR5cGVvZiBzdHIgPT0gJ3N0cmluZycpIG8gKz0gJyInICsgc3RyICsgJyInOwogICAgZWxzZSBvICs9ICcwJzsKICB9CgogIC8qICAgICArCiAgICBzdHJpbmdzLm1hcChzdHIgPT4gKHR5cGVvZiBzdHIgPT0gJ3N0cmluZycgJiYgc3RyID8gJyInICsgc3RyICsgJyInIDogJyIiJykpLm1hcChzdHIgPT4gc3RyICE9ICcnID8gc3RyIDogJyIiJykuam9pbignLFxuJykgKyovCgogIG8gKz0gYCB9KTtgOwogIHJldHVybiBgKChjb25zdCBjaGFyKmNvbnN0IFtdKXsgYCArIG87Cn0KCmZ1bmN0aW9uIE5hbWVzcGFjZXMobm9kZVBhdGgsIGFzdCA9ICQuZGF0YSkgewogIGxldCBwdHIgPSBuZXcgUG9pbnRlcihub2RlUGF0aCk7CiAgbGV0IHB0cnMgPSBwdHIuY2hhaW4oMik7CiAgbGV0IGdldCA9IGRlZXAuZ2V0KGFzdCk7CgogIGxldCBucyA9IHB0cnMubWFwKHAgPT4gZ2V0KHApKS5maWx0ZXIobiA9PiBuLmtpbmQgPT0gJ05hbWVzcGFjZURlY2wnKTsKICByZXR1cm4gbnM7Cn0KCmZ1bmN0aW9uKiBDb25zdGFudHMobm9kZSwgdCA9IChuYW1lLCB2YWx1ZSkgPT4gW25hbWUsICFpc05hTigrdmFsdWUpID8gK3ZhbHVlIDogdmFsdWVdKSB7CiAgZm9yKGxldCBpbm5lciBvZiBub2RlLmlubmVyKSB7CiAgICB5aWVsZCB0KC4uLlByaW50QXN0KGlubmVyKS5zcGxpdCgvID0gL2cpKTsKICB9Cn0KCk1lbWJlck5hbWVzLlVQUEVSID0gMTsKTWVtYmVyTmFtZXMuTUVUSE9EUyA9IDI7Ck1lbWJlck5hbWVzLlBST1BFUlRJRVMgPSA0OwoKZnVuY3Rpb24gR2V0SW1wb3J0cyhhc3QgPSAkLmRhdGEpIHsKICBjb25zdCByID0gW107CiAgZm9yKGxldCBbbiwgcF0gb2YgZGVlcC5zZWxlY3QoJC5kYXRhLCBuID0+IChuLnR5cGUgPz8gbi5raW5kKS5zdGFydHNXaXRoKCdJbXBvcnQnKSkpIHsKICAgIHIucHVzaChuKTsKICB9CiAgcmV0dXJuIHI7Cn0KZnVuY3Rpb24gR2V0SWRlbnRpZmllcnMobm9kZXMsIGtleSA9IG51bGwpIHsKICBjb25zdCByID0gW107CiAgZm9yKGxldCBub2RlIG9mIG5vZGVzKSB7CiAgICBmb3IobGV0IG4gb2YgZGVlcC5zZWxlY3QoCiAgICAgIG5vZGUsCiAgICAgIChuLCBrKSA9PiAobi50eXBlID8/IG4ua2luZCkgPT0gJ0lkZW50aWZpZXInICYmIChrZXkgPT09IG51bGwgfHwgayA9PSBrZXkpLAogICAgICBkZWVwLlJFVFVSTl9WQUxVRQogICAgKSkKICAgICAgci5wdXNoKG4ubmFtZSk7CiAgfQogIHJldHVybiByOwp9CgpmdW5jdGlvbiBNZW1iZXJOYW1lcyhtZW1iZXJzLCBmbGFncyA9IDApIHsKICBsZXQgcmV0ID0gW107CiAgaWYobWVtYmVycy5tZW1iZXJzKSBtZW1iZXJzID0gbWVtYmVycy5tZW1iZXJzOwogIGlmKCFBcnJheS5pc0FycmF5KG1lbWJlcnMpKSB7CiAgICBmb3IobGV0IHB0ciBvZiBkZWVwCiAgICAgIC5zZWxlY3QobWVtYmVycywgbiA9PiBuLmtpbmQuZW5kc1dpdGgoJ0RlY2wnKSAmJiBuLm5hbWUsIGRlZXAuUkVUVVJOX1BBVEgpCiAgICAgIC5tYXAocGF0aCA9PiBuZXcgUG9pbnRlcihwYXRoKSkpIHsKICAgICAgbGV0IHB0cnMgPSBwdHIuY2hhaW4oMik7CiAgICAgIGNvbnNvbGUubG9nKCdwdHJzOicsIHB0cnMpOwogICAgICBsZXQgbmFtZXMgPSBwdHJzLm1hcChwID0+IGRlZXAuZ2V0KG1lbWJlcnMsIFsuLi5wLCAnbmFtZSddLCBkZWVwLk5PX1RIUk9XKSk7CiAgICAgIGxldCBraW5kcyA9IHB0cnMubWFwKHAgPT4gZGVlcC5nZXQobWVtYmVycywgWy4uLnAsICdraW5kJ10sIGRlZXAuTk9fVEhST1cpKTsKICAgICAgY29uc29sZS5sb2coJ2tpbmRzOicsIGtpbmRzKTsKICAgICAgY29uc29sZS5sb2coJ25hbWVzOicsIG5hbWVzKTsKICAgICAgcmV0LnB1c2gobmFtZXMuZmlsdGVyKG5hbWUgPT4gbmFtZSkuam9pbignLicpKTsKICAgIH0KICB9IGVsc2UgewogICAgY29uc3QgbWVtYmVyTmFtZVBvaW50ZXJzID0gZGVlcAogICAgICAuc2VsZWN0KAogICAgICAgIG1lbWJlcnMsCiAgICAgICAgbiA9PiBBcnJheS5pc0FycmF5KG4pICYmIG4ubGVuZ3RoID09IDIgJiYgdHlwZW9mIG5bMF0gPT0gJ3N0cmluZycgJiYgblsxXSAhPT0gbnVsbCwKICAgICAgICBkZWVwLlJFVFVSTl9WQUxVRV9QQVRICiAgICAgICkKICAgICAgLm1hcCgoW25vZGUsIHB0cl0pID0+IHB0cik7CiAgICAvLyAgY29uc29sZS5sb2coJ21lbWJlck5hbWVQb2ludGVycycsIG1lbWJlck5hbWVQb2ludGVycyk7CgogICAgZm9yKGxldCBwdHIgb2YgbWVtYmVyTmFtZVBvaW50ZXJzLm1hcChwYXRoID0+IG5ldyBQb2ludGVyKHBhdGgpKSkgewogICAgICBsZXQgcHRycyA9IHB0ci5jaGFpbigzKTsKICAgICAgbGV0IG5hbWVzID0gcHRycy5tYXAocCA9PiBkZWVwLmdldChtZW1iZXJzLCBbLi4ucCwgMF0pKTsKICAgICAgcmV0LnB1c2gobmFtZXMuZmlsdGVyKG5hbWUgPT4gbmFtZSkuam9pbignLicpKTsKICAgIH0KICB9CiAgaWYoZmxhZ3MgJiBNZW1iZXJOYW1lcy5VUFBFUikgewogICAgcmV0ID0gcmV0Lm1hcChuYW1lID0+IFV0aWwuZGVjYW1lbGl6ZShuYW1lLCAnXycpLnRvVXBwZXJDYXNlKCkpOwogIH0KICByZXR1cm4gcmV0Owp9CgpmdW5jdGlvbiBVbnNldExvYyhub2RlLCBwcmVkID0gKHYsIHApID0+IHRydWUpIHsKICBmb3IobGV0IFt2LCBwXSBvZiBkZWVwLnNlbGVjdChub2RlLCAodiwgaykgPT4gayA9PSAnbG9jJyB8fCBrID09ICdyYW5nZScsIGRlZXAuUkVUVVJOX1ZBTFVFX1BBVEgpKSB7CiAgICBjb25zb2xlLmxvZygnVW5zZXRMb2MnLCB7IHYsIHAgfSk7CiAgICBpZihwcmVkKGRlZXAuZ2V0KG5vZGUsIFsuLi5wXS5zbGljZSgwLCAtMSkpLCBbLi4ucF0ubGFzdCkpIGRlZXAudW5zZXQobm9kZSwgcCk7CiAgfQogIHJldHVybiBub2RlOwp9CgpmdW5jdGlvbiBNYWtlRkZJKG5vZGUsIGxpYiwgZXhwLCBmcCkgewogIGlmKEFycmF5LmlzQXJyYXkobm9kZSkpIHsKICAgIHJldHVybiAoZnVuY3Rpb24qICgpIHsKICAgICAgbGV0IGkgPSAwOwoKICAgICAgaWYoIWZwKSB5aWVsZCBgaW1wb3J0IHsgZGxvcGVuLCBkZWZpbmUsIGRsZXJyb3IsIGRsY2xvc2UsIGRsc3ltLCBjYWxsLCBlcnJubywgUlRMRF9OT1cgfSBmcm9tICdmZmknO1xuYDsKCiAgICAgIGlmKGxpYikgewogICAgICAgIGxldCBsaWJ2YXIgPSBsaWIucmVwbGFjZSgvXC5zbygkfFwuLiopL2csICcnKS5yZXBsYWNlKC9bXkEtWmEtejAtOV9dL2csICdfJyk7CiAgICAgICAgeWllbGQgYGNvbnN0ICR7bGlidmFyfSA9IGRsb3BlbignJHtsaWJ9JywgUlRMRF9OT1cpO1xuYDsKICAgICAgICBsaWIgPSBsaWJ2YXI7CiAgICAgIH0KICAgICAgZm9yKGxldCBpdGVtIG9mIG5vZGUpIHsKICAgICAgICBsZXQgb3V0ID0gJyc7CiAgICAgICAgY29uc29sZS5sb2coYE1ha2VGRkkgaXRlbSAjJHtpICsgMX0vJHtub2RlLmxlbmd0aH1gKTsKICAgICAgICB0cnkgewogICAgICAgICAgbGV0IHJldCA9IE1ha2VGRkkoaXRlbSwgbGliLCBleHAsIGZwKTsKICAgICAgICAgIGlmKHR5cGVvZiByZXQgPT0gJ3N0cmluZycgJiYgcmV0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgaWYob3V0KSBvdXQgKz0gJ1xuJzsKICAgICAgICAgICAgb3V0ICs9IHJldDsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoKGVycm9yKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhgRVJST1IgaXRlbSBbJHtpfV06YCwgZXJyb3IubWVzc2FnZSArICdcbicgKyBlcnJvci5zdGFjayk7CiAgICAgICAgfQogICAgICAgIGkrKzsKICAgICAgICB5aWVsZCBvdXQ7CiAgICAgIH0KICAgIH0pKCk7CiAgfQogIGlmKCEobm9kZSBpbnN0YW5jZW9mIE5vZGUpKSBub2RlID0gVHlwZUZhY3Rvcnkobm9kZSwgJC5kYXRhKTsKCiAgaWYodHlwZW9mIG5vZGUgPT0gJ29iamVjdCcgJiYgbm9kZSAmJiBub2RlLmtpbmQgPT0gJ0Z1bmN0aW9uRGVjbCcpIG5vZGUgPSBuZXcgRnVuY3Rpb25EZWNsKG5vZGUpOwoKICBpZihub2RlIGluc3RhbmNlb2YgRnVuY3Rpb25EZWNsKSB7CiAgICBjb25zb2xlLmxvZygnbm9kZScsIChnbG9iYWxUaGlzLm5vZGUgPSBub2RlKSk7CgogICAgbGV0IGZmaSA9IG5ldyBGRklfRnVuY3Rpb24obm9kZSk7CgogICAgbGV0IHByb3RvU3RyID0gUHJpbnRBc3Qobm9kZS5hc3QsICQuZGF0YSkKICAgICAgLnJlcGxhY2UoL14oW15cblwoXSopXG4vLCAnJDEgJykKICAgICAgLnNwbGl0KC9cbi9nKVswXQogICAgICAucmVwbGFjZSgvXCB7JC8sICc7Jyk7CgogICAgcHJvdG9TdHIgPSBwcm90b1N0ci5yZXBsYWNlKC9eXHMqZXh0ZXJuXHMrLywgJycpOwogICAgcmV0dXJuIChmZmkuZ2VuZXJhdGVEb2MoZnAsIGxpYiwgZXhwKSA/PyBgLyogJHtwcm90b1N0cn0gKi9cbmApICsgZmZpLmdlbmVyYXRlKGZwLCBsaWIsIGV4cCk7CiAgfSBlbHNlIGlmKG5vZGUgaW5zdGFuY2VvZiBSZWNvcmREZWNsIHx8IG5vZGUgaW5zdGFuY2VvZiBUeXBlZGVmRGVjbCkgewogICAgbGV0IGNvZGUgPSBbLi4uR2VuZXJhdGVTdHJ1Y3RDbGFzcyhub2RlKV0uam9pbignXG4nKTsKICAgIHJldHVybiBjb2RlOwogIH0KfQoKYXN5bmMgZnVuY3Rpb24gQVNUU2hlbGwoLi4uYXJncykgewogIGxldCBpbnNwZWN0T3B0aW9ucyA9IHsKICAgIC8qYnJlYWtMZW5ndGg6IDI0MCwgKi8gY3VzdG9tSW5zcGVjdDogdHJ1ZSwKICAgIGNvbXBhY3Q6IGZhbHNlLAogICAgZGVwdGg6IEluZmluaXR5LAogICAgbWF4QXJyYXlMZW5ndGg6IEluZmluaXR5LAogICAgaGlkZUtleXM6IFsnbG9jJywgJ3JhbmdlJ10KICB9OwogIGdsb2JhbFRoaXMuY29uc29sZSA9IG5ldyBDb25zb2xlKHsgc3Rkb3V0OiBwcm9jZXNzLnN0ZG91dCwgaW5zcGVjdE9wdGlvbnMgfSk7CiAgYXdhaXQgUG9ydGFibGVTcGF3bihmbiA9PiAoc3Bhd24gPSBmbikpOwoKICAvKiAgYXdhaXQgaW1wb3J0KCdianNvbicpLnRoZW4obW9kdWxlID0+IHsKICAgIGNvbnN0IHsgcmVhZCwgd3JpdGUgfSA9IG1vZHVsZTsKICAgIGdsb2JhbFRoaXMuYmpzb24gPSB7IHJlYWQsIHdyaXRlIH07CiAgfSk7CiAgY29uc29sZS5sb2coJ2Jqc29uOicsIGdsb2JhbFRoaXMuYmpzb24pOyovCiAgLyphd2FpdCBpbXBvcnQoJ21tYXAnKS50aGVuKG1vZHVsZSA9PiB7Y29uc3Qge21tYXAsIG11bm1hcCwgdG9TdHJpbmcsIFBST1RfUkVBRCwgUFJPVF9XUklURSwgUFJPVF9FWEVDLCBQUk9UX1NFTSwgUFJPVF9OT05FLCBQUk9UX0dST1dTRE9XTiwgUFJPVF9HUk9XU1VQLCBNQVBfU0hBUkVELCBNQVBfUFJJVkFURSwgTUFQX1RZUEUsIE1BUF9GSVhFRCwgTUFQX0FOT05ZTU9VUywgTUFQX0dST1dTRE9XTiwgTUFQX0RFTllXUklURSwgTUFQX0VYRUNVVEFCTEUsIE1BUF9MT0NLRUQsIE1BUF9OT1JFU0VSVkUsIE1BUF9QT1BVTEFURSwgTUFQX05PTkJMT0NLLCBNQVBfU1RBQ0sgfSA9IG1vZHVsZTsgZ2xvYmFsVGhpcy5tbWFwID0ge21tYXAsIG11bm1hcCwgdG9TdHJpbmcsIFBST1RfUkVBRCwgUFJPVF9XUklURSwgUFJPVF9FWEVDLCBQUk9UX1NFTSwgUFJPVF9OT05FLCBQUk9UX0dST1dTRE9XTiwgUFJPVF9HUk9XU1VQLCBNQVBfU0hBUkVELCBNQVBfUFJJVkFURSwgTUFQX1RZUEUsIE1BUF9GSVhFRCwgTUFQX0FOT05ZTU9VUywgTUFQX0dST1dTRE9XTiwgTUFQX0RFTllXUklURSwgTUFQX0VYRUNVVEFCTEUsIE1BUF9MT0NLRUQsIE1BUF9OT1JFU0VSVkUsIE1BUF9QT1BVTEFURSwgTUFQX05PTkJMT0NLLCBNQVBfU1RBQ0sgfTsgfSk7CiAgY29uc29sZS5sb2coJ21tYXA6JywgZ2xvYmFsVGhpcy5tbWFwKTsKKi8KICAvKiAgY29uc29sZS5vcHRpb25zID0gY29uc29sZU9wdGlvbnM7CiAgY29uc29sZS5vcHRpb25zLmNvbXBhY3QgPSAxOwogIGNvbnNvbGUub3B0aW9ucy5oaWRlS2V5cyA9IFsnbG9jJywgJ3JhbmdlJ107Ki8KICAvKmNvbnNvbGUub3B0aW9ucy5kZXB0aCA9IDI7CiAgY29uc29sZS5vcHRpb25zLmNvbXBhY3QgPSAxOyovCgogIGdsb2JhbFRoaXMuZmlsZXMgPSBmaWxlcyA9IHt9OwoKICBjb25zdCBwbGF0Zm9ybSA9IFV0aWwuZ2V0UGxhdGZvcm0oKTsKICBpZihwbGF0Zm9ybSA9PSAncXVpY2tqcycpIGF3YWl0IGltcG9ydCgnc3RkJykudGhlbihtb2R1bGUgPT4gKGdsb2JhbFRoaXMuc3RkID0gbW9kdWxlKSk7CgogIGlmKHBsYXRmb3JtID09ICdub2RlJykgYXdhaXQgaW1wb3J0KCcuL2xpYi9taXNjLmpzJykudGhlbihtb2R1bGUgPT4gKGdsb2JhbFRoaXMuaW5zcGVjdCA9IG1vZHVsZS5pbnNwZWN0KSk7CgogIChhd2FpdCBVdGlsLmdldFBsYXRmb3JtKCkpID09ICdxdWlja2pzJwogICAgPyBpbXBvcnQoJ2RlZXAuc28nKS50aGVuKG1vZHVsZSA9PiAoZ2xvYmFsVGhpcy5kZWVwID0gbW9kdWxlKSkKICAgIDogaW1wb3J0KCcuL2xpYi9kZWVwLmpzJykudGhlbihtb2R1bGUgPT4gKGdsb2JhbFRoaXMuZGVlcCA9IG1vZHVsZVsnZGVmYXVsdCddKSk7CgogIGJhc2UgPSBwYXRoLmJhc2VuYW1lKFV0aWwuZ2V0QXJndigpWzFdLCAnLmpzJykucmVwbGFjZSgvXC5bYS16XSokLywgJycpOwogIGNtZGhpc3QgPSBgLiR7YmFzZX0tY21kaGlzdG9yeWA7CiAgY29uZmlnID0gYC4ke2Jhc2V9LWNvbmZpZ2A7CgogIHBhcmFtcyA9IGdsb2JhbFRoaXMucGFyYW1zID0gVXRpbC5nZXRPcHQoCiAgICB7CiAgICAgIGluY2x1ZGU6IFt0cnVlLCAoYSwgcCkgPT4gKHAgfHwgW10pLmNvbmNhdChbYV0pLCAnSSddLAogICAgICBkZWZpbmU6IFt0cnVlLCAoYSwgcCkgPT4gKHAgfHwgW10pLmNvbmNhdChbYV0pLCAnRCddLAogICAgICBsaWJzOiBbdHJ1ZSwgKGEsIHApID0+IChwIHx8IFtdKS5jb25jYXQoW2FdKSwgJ2wnXSwKICAgICAgZGVidWc6IFtmYWxzZSwgbnVsbCwgJ3gnXSwKICAgICAgZm9yY2U6IFtmYWxzZSwgbnVsbCwgJ2YnXSwKICAgICAgZXhlYzogW3RydWUsIG51bGwsICdlJ10sCiAgICAgICdzeXN0ZW0taW5jbHVkZXMnOiBbZmFsc2UsIG51bGwsICdzJ10sCiAgICAgICduby1yZW1vdmUtZW1wdHknOiBbZmFsc2UsIG51bGwsICdFJ10sCiAgICAgICdvdXRwdXQtZGlyJzogW3RydWUsIG51bGwsICdkJ10sCiAgICAgIGNvbXBpbGVyOiBbJ2NsYW5nJywgbnVsbCwgJ2MnXSwKICAgICAgJ0AnOiAnaW5wdXQnCiAgICB9LAogICAgYXJncwogICk7CgogIC8vY29uc29sZS5sb2coJ3BhcmFtcycsIHBhcmFtcyk7CgogIGRlZnMgPSBwYXJhbXMuZGVmaW5lIHx8IFtdOwogIGluY2x1ZGVzID0gcGFyYW1zLmluY2x1ZGUgfHwgW107CiAgbGlicyA9IHBhcmFtcy5saWJzIHx8IFtdOwogIHNvdXJjZXMgPSBwYXJhbXNbJ0AnXSB8fCBbXTsKCiAgVXRpbC5kZWZpbmUoZ2xvYmFsVGhpcywgewogICAgZGVmcywKICAgIGluY2x1ZGVzLAogICAgbGlicywKICAgIC8qIHByZXR0aWVyLWlnbm9yZSAqLyBnZXQgZmxhZ3MoKSB7CiAgICAgIHJldHVybiBbLi4uaW5jbHVkZXMuZmlsdGVyKHYgPT4gdHlwZW9mIHYgPT0gJ3N0cmluZycpLm1hcCh2ID0+IGAtSSR7dn1gKSwgLi4uZGVmcy5tYXAoZCA9PiBgLUQke2R9YCksIC4uLmxpYnMubWFwKGwgPT4gYC1sJHtsfWApXTsKICAgIH0KICB9KTsKCiAgYXN5bmMgZnVuY3Rpb24gQ29tcGlsZShmaWxlLCAuLi5hcmdzKSB7CiAgICBjb25zb2xlLmxvZygnQ29tcGlsaW5nJywgeyBmaWxlLCBhcmdzIH0pOwogICAgbGV0IHI7CgogICAgdHJ5IHsKICAgICAgciA9IGF3YWl0IEFzdER1bXAocGFyYW1zLmNvbXBpbGVyLCBmaWxlLCBbLi4uZ2xvYmFsVGhpcy5mbGFncywgLi4uYXJnc10sIHBhcmFtcy5mb3JjZSk7CiAgICB9IGNhdGNoKGUpIHsKICAgICAgY29uc29sZS5sb2coJ0NvbXBpbGUgRVJST1I6JywgZS5tZXNzYWdlKTsKICAgICAgcmV0dXJuIGU7CiAgICB9CiAgICByLnNvdXJjZSA9IGZpbGU7CgogICAgZ2xvYmFsVGhpcy5maWxlc1tmaWxlXSA9IHI7CgogICAgZnVuY3Rpb24gbmFtZU9ySWRQcmVkKG5hbWVfb3JfaWQsIHByZWQgPSBuID0+IHRydWUpIHsKICAgICAgaWYoL14oc3RydWN0fHVuaW9uKVxzLy50ZXN0KG5hbWVfb3JfaWQpKSB7CiAgICAgICAgbGV0IGlkeCA9IG5hbWVfb3JfaWQuaW5kZXhPZignICcpOwogICAgICAgIGxldCB0YWcgPSBuYW1lX29yX2lkLnN1YnN0cmluZygwLCBpZHgpOwogICAgICAgIGxldCBuYW1lID0gbmFtZV9vcl9pZC5zdWJzdHJpbmcoaWR4ICsgMSk7CiAgICAgICAgcmV0dXJuIG5vZGUgPT4gbm9kZS5uYW1lID09IG5hbWUgJiYgbm9kZS50YWdVc2VkID09IHRhZzsKICAgICAgfQogICAgICBpZih0eXBlb2YgbmFtZV9vcl9pZCA9PSAnbnVtYmVyJykgbmFtZV9vcl9pZCA9ICcweCcgKyBuYW1lX29yX2lkLnRvU3RyaW5nKDE2KTsKICAgICAgcmV0dXJuIG5hbWVfb3JfaWQgaW5zdGFuY2VvZiBSZWdFeHAKICAgICAgICA/IG5vZGUgPT4gbmFtZV9vcl9pZC50ZXN0KG5vZGUubmFtZSkgJiYgcHJlZChub2RlKQogICAgICAgIDogbmFtZV9vcl9pZC5zdGFydHNXaXRoKCcweCcpCiAgICAgICAgPyBub2RlID0+IG5vZGUuaWQgPT0gbmFtZV9vcl9pZCAmJiBwcmVkKG5vZGUpCiAgICAgICAgOiBub2RlID0+IG5vZGUubmFtZSA9PSBuYW1lX29yX2lkICYmIHByZWQobm9kZSk7CiAgICB9CgogICAgVXRpbC5iaW5kTWV0aG9kcyhyLCB7CiAgICAgIHNlbGVjdChuYW1lX29yX2lkLCBwcmVkID0gbiA9PiB0cnVlKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5pbm5lci5maWx0ZXIobmFtZU9ySWRQcmVkKG5hbWVfb3JfaWQsIHByZWQpKTsKICAgICAgfSwKICAgICAgZ2V0QnlJZE9yTmFtZShuYW1lX29yX2lkLCBwcmVkID0gbiA9PiB0cnVlKSB7CiAgICAgICAgbGV0IG5vZGUgPSB0aGlzLmRhdGEuaW5uZXIuZmluZExhc3QobmFtZU9ySWRQcmVkKG5hbWVfb3JfaWQsIHByZWQpKTsKCiAgICAgICAgbm9kZSA/Pz0gdGhpcy5jbGFzc2VzLmZpbmRMYXN0KG5hbWVPcklkUHJlZChuYW1lX29yX2lkLCBwcmVkKSk7CiAgICAgICAgbm9kZSA/Pz0gZGVlcC5maW5kKHRoaXMuZGF0YSwgbmFtZU9ySWRQcmVkKG5hbWVfb3JfaWQsIHByZWQpLCBkZWVwLlJFVFVSTl9WQUxVRSk7CiAgICAgICAgcmV0dXJuIG5vZGU7CiAgICAgIH0sCiAgICAgIGdldFR5cGUobmFtZV9vcl9pZCkgewogICAgICAgIGxldCByZXN1bHQgPQogICAgICAgICAgdGhpcy5nZXRCeUlkT3JOYW1lKG5hbWVfb3JfaWQsIG4gPT4gIS8oRnVuY3Rpb25EZWNsKS8udGVzdChuLmtpbmQpICYmIC9EZWNsLy50ZXN0KG4ua2luZCkpID8/CiAgICAgICAgICBHZXRUeXBlKG5hbWVfb3JfaWQsIHRoaXMuZGF0YSk7CgogICAgICAgIGlmKHJlc3VsdCkgewogICAgICAgICAgbGV0IHR5cGUgPSBUeXBlRmFjdG9yeShyZXN1bHQsIHRoaXMuZGF0YSk7CiAgICAgICAgICBpZih0eXBlKSByZXN1bHQgPSB0eXBlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzdWx0OwogICAgICB9LAoKICAgICAgZ2V0RnVuY3Rpb24obmFtZV9vcl9pZCkgewogICAgICAgIGxldCByZXN1bHQgPSBpc05vZGUobmFtZV9vcl9pZCkKICAgICAgICAgID8gbmFtZV9vcl9pZAogICAgICAgICAgOiB0aGlzLmdldEJ5SWRPck5hbWUobmFtZV9vcl9pZCwgbiA9PiAvKEZ1bmN0aW9uRGVjbCkvLnRlc3Qobi5raW5kKSk7CgogICAgICAgIGlmKHJlc3VsdCkgcmV0dXJuIG5ldyBGdW5jdGlvbkRlY2wocmVzdWx0LCB0aGlzLmRhdGEpOwogICAgICB9LAogICAgICBnZXRWYXJpYWJsZShuYW1lX29yX2lkKSB7CiAgICAgICAgbGV0IHJlc3VsdCA9IGlzTm9kZShuYW1lX29yX2lkKSA/IG5hbWVfb3JfaWQgOiB0aGlzLmdldEJ5SWRPck5hbWUobmFtZV9vcl9pZCwgbiA9PiAvKFZhckRlY2wpLy50ZXN0KG4ua2luZCkpOwoKICAgICAgICBpZihyZXN1bHQpIHJldHVybiBuZXcgVmFyRGVjbChyZXN1bHQsIHRoaXMuZGF0YSk7CiAgICAgIH0sCiAgICAgIGdldExvYyhub2RlKSB7CiAgICAgICAgcmV0dXJuIENvbXBsZXRlTG9jYXRpb24obm9kZSk7CiAgICAgIH0KICAgIH0pOwogICAgVXRpbC5kZWZpbmVHZXR0ZXIoCiAgICAgIHIsCiAgICAgICd0cmVlJywKICAgICAgVXRpbC5tZW1vaXplKCgpID0+IG5ldyBUcmVlKHIuZGF0YSkpCiAgICApOwogICAgcmV0dXJuIFV0aWwuZGVmaW5lKHIsIHsKICAgICAgcGF0aE9mKG5lZWRsZSwgbWF4RGVwdGggPSAxMCkgewogICAgICAgIGlmKCdhc3QnIGluIG5lZWRsZSkgbmVlZGxlID0gbmVlZGxlLmFzdDsKCiAgICAgICAgZm9yKGxldCBbbm9kZSwgcGF0aF0gb2YgZGVlcC5pdGVyYXRlKAogICAgICAgICAgci5kYXRhLAogICAgICAgICAgbiA9PiB0eXBlb2YgbiA9PSAnb2JqZWN0JyAmJiBuICE9IG51bGwsCiAgICAgICAgICBkZWVwLlJFVFVSTl9WQUxVRV9QQVRILAogICAgICAgICAgbWF4RGVwdGgKICAgICAgICApKSB7CiAgICAgICAgICAvL2NvbnNvbGUubG9nKCJwYXRoT2YiLGNvbnNvbGUuY29uZmlnKHtkZXB0aDoxfSkse25vZGUscGF0aH0pOwogICAgICAgICAgaWYobm9kZSA9PT0gbmVlZGxlKSByZXR1cm4gbmV3IFBvaW50ZXIocGF0aCk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICB9CgogIE9iamVjdC5hc3NpZ24oZ2xvYmFsVGhpcywgewogICAgU0laRU9GX1BPSU5URVIsCiAgICBUeXBlLAogICAgQXN0RHVtcCwKICAgIFNvdXJjZURlcGVuZGVuY2llcywKICAgIE5vZGVQcmludGVyLAogICAgTm9kZVR5cGUsCiAgICBOb2RlTmFtZSwKICAgIEdldExvYywKICAgIFJhd0xvY2F0aW9uLAogICAgQ29tcGxldGVMb2NhdGlvbiwKICAgIFJhd1JhbmdlLAogICAgQ29tcGxldGVSYW5nZSwKICAgIEdldFR5cGVTdHIsCiAgICBSZWFkRmlsZSwKICAgIE1hcEZpbGUsCiAgICBSZWFkSlNPTiwKICAgIFJlYWRCSlNPTiwKICAgIFdyaXRlRmlsZSwKICAgIFdyaXRlSlNPTiwKICAgIFdyaXRlQkpTT04sCiAgICBQcmludFJhbmdlLAogICAgT3ZlcmxhcFJhbmdlLAogICAgUGFyZW50Tm9kZSwKICAgIE5leHRTaWJsaW5nLAogICAgUHJldmlvdXNTaWJsaW5nLAogICAgRmlyc3RDaGlsZCwKICAgIExhc3RDaGlsZCwKICAgIEdlbmVyYXRlSW5zcGVjdFN0cnVjdCwKICAgIEdlbmVyYXRlU3RydWN0Q2xhc3MsCiAgICBJbnNwZWN0U3RydWN0LAogICAgTWFrZVN0cnVjdENsYXNzLAogICAgRGlySXRlcmF0b3IsCiAgICBSZWN1cnNpdmVEaXJJdGVyYXRvciwKICAgIEluY2x1ZGVBbGwsCiAgICBUZXJtaW5hbCwKICAgIFByaW50QXN0LAogICAgTWFrZUZGSSwKICAgIFBhcnNlRUNNQVNjcmlwdCwKICAgIFByaW50RUNNQVNjcmlwdCwKICAgIFByb2Nlc3NGaWxlLAogICAgdG9BcnJheUJ1ZmZlciwKICAgIHRvU3RyaW5nLAogICAgQ29uc3RhbnRzLAogICAgUHJpbnRDQXJyYXksCiAgICBHZXRQYXJhbXMsCiAgICBMaXN0LAogICAgU2hlbGwsCiAgICBQYXJzZVN0cnVjdHMKICB9KTsKCiAgUG9pbnRlci5wcm90b3R5cGUuY2hhaW4gPSBmdW5jdGlvbihzdGVwLCBsaW1pdCA9IEluZmluaXR5KSB7CiAgICBsZXQgcHRyID0gdGhpczsKICAgIGxldCByZXQgPSBbXTsKICAgIGxldCBsZW4gPSBwdHIubGVuZ3RoOwogICAgZm9yKDs7KSB7CiAgICAgIGlmKHJldC5sZW5ndGggPj0gbGltaXQpIGJyZWFrOwogICAgICByZXQudW5zaGlmdChwdHIpOwogICAgICBsZW4gLT0gc3RlcDsKICAgICAgaWYobGVuIDw9IDApIGJyZWFrOwogICAgICBwdHIgPSBwdHIuc2xpY2UoMCwgLXN0ZXApOwogICAgfQogICAgcmV0dXJuIHJldDsKICB9OwoKICBPYmplY3QuYXNzaWduKGdsb2JhbFRoaXMsIHsKICAgIFBvaW50ZXIsCiAgICBUcmVlLAogICAgZGVlcCwKICAgIHBhdGgsCiAgICBDb21waWxlLAogICAgU2VsZWN0TG9jYXRpb25zLAogICAgTG9jYXRpb25TdHJpbmcsCiAgICBUYWJsZSwKICAgIFN0cnVjdHMsCiAgICBOb2RlLAogICAgVHlwZSwKICAgIFJlY29yZERlY2wsCiAgICBFbnVtRGVjbCwKICAgIFR5cGVkZWZEZWNsLAogICAgVmFyRGVjbCwKICAgIEZpbmRUeXBlLAogICAgSGllciwKICAgIFBhdGhPZiwKICAgIEZ1bmN0aW9uRGVjbCwKICAgIExvY2F0aW9uLAogICAgUmFuZ2UsCiAgICBUeXBlRmFjdG9yeSwKICAgIFNwYXduQ29tcGlsZXIsCiAgICBBc3REdW1wLAogICAgTm9kZVR5cGUsCiAgICBOb2RlTmFtZSwKICAgIEdldExvYywKICAgIEdldFR5cGUsCiAgICBHZXRUeXBlU3RyLAogICAgR2V0VHlwZU5vZGUsCiAgICBHZXRGaWVsZHMsCiAgICBQYXRoUmVtb3ZlTG9jLAogICAgRkZJX0Z1bmN0aW9uLAogICAgbGliZGlycywKICAgIGxpYmRpcnMzMiwKICAgIGxpYmRpcnM2NCwKICAgIExpYnJhcnlFeHBvcnRzLAogICAgTWVtYmVyTmFtZXMsCiAgICBHZXRJbXBvcnRzLAogICAgR2V0SWRlbnRpZmllcnMsCiAgICBOYW1lc3BhY2VzLAogICAgVW5zZXRMb2MKICB9KTsKICAvL2dsb2JhbFRoaXMuVXRpbCA9IFV0aWw7CiAgZ2xvYmFsVGhpcy5GID0gYXJnID0+ICQuZ2V0RnVuY3Rpb24oYXJnKTsKICBnbG9iYWxUaGlzLlQgPSBhcmcgPT4gJC5nZXRUeXBlKGFyZyk7CgogIFV0aWwubGF6eVByb3BlcnR5KGdsb2JhbFRoaXMsICdQJywgKCkgPT4gewogICAgbGV0IHByaW50ZXIgPSBOb2RlUHJpbnRlcigkLmRhdGEpOwoKICAgIHJldHVybiBub2RlID0+IHsKICAgICAgaWYoJ2FzdCcgaW4gbm9kZSkgbm9kZSA9IG5vZGUuYXN0OwogICAgICBwcmludGVyLmNsZWFyKCk7CiAgICAgIHJldHVybiBwcmludGVyLnByaW50KG5vZGUpOwogICAgfTsKICB9KTsKCiAgY29uc3QgdW5pdGhpc3QgPSBgLiR7YmFzZX0tdW5pdGhpc3RvcnlgOwogIGxldCBpdGVtcyA9IFtdOwogIGxldCBoaXN0ID0gUmVhZEpTT04odW5pdGhpc3QpIHx8IFtdOwoKICBjb25zdCBwdXNoVW5pcXVlID0gKGFyciwgaXRlbSkgPT4gewogICAgaWYoVXRpbC5maW5kSW5kZXgoYXJyLCBlbGVtID0+IGRlZXAuZXF1YWxzKGVsZW0sIGl0ZW0pKSA9PT0gLTEpIHsKICAgICAgYXJyLnB1c2goaXRlbSk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH07CgogIGNvbnNvbGUubG9nKCdMb2FkaW5nIHNvdXJjZXM6JyArIHNvdXJjZXMubWFwKHMgPT4gJyAnICsgcykuam9pbignLCcpKTsKCiAgZ2xvYmFsVGhpc1snXyddID0gaXRlbXM7CgogIGZvcihsZXQgc291cmNlIG9mIHNvdXJjZXMpIHsKICAgIGxldCBpdGVtOwogICAgaXRlbSA9IGF3YWl0IFByb2Nlc3NGaWxlKHNvdXJjZSk7CiAgICBnbG9iYWxUaGlzWyckJ10gPSBpdGVtOwogICAgLyogICAgaWYoL1wuanMkLy50ZXN0KHNvdXJjZSkpIGl0ZW0gPSBQYXJzZUVDTUFTY3JpcHQoc291cmNlKTsKICAgIGVsc2UgaXRlbSA9IGF3YWl0IENvbXBpbGUoc291cmNlKTsqLwogICAgaWYoaXRlbSkgewogICAgICBwdXNoVW5pcXVlKGhpc3QsIFsuLi5mbGFncywgc291cmNlXSk7CiAgICAgIGl0ZW1zLnB1c2goaXRlbSk7CiAgICB9CiAgfQoKICBXcml0ZUZpbGUodW5pdGhpc3QsIEpTT04uc3RyaW5naWZ5KGhpc3QsIG51bGwsIDIpKTsKCiAgLy8gZ2xvYmFsVGhpcy4kID0gaXRlbXMubGVuZ3RoID09IDEgPyBpdGVtc1swXSA6IGl0ZW1zOwogIGF3YWl0IENvbW1hbmRMaW5lKCk7Cn0KCmxldCBlcnJvcjsKdHJ5IHsKICBjb25zdCBhcmd2ID0gWy4uLihwcm9jZXNzPy5hcmd2ID8/IHNjcmlwdEFyZ3MpXS5zbGljZSgyKTsKICBBU1RTaGVsbCguLi5hcmd2KTsKfSBjYXRjaChlKSB7CiAgZXJyb3IgPSBlOwp9IGZpbmFsbHkgewogIGlmKGVycm9yKSB7CiAgICBjb25zb2xlLmxvZygKICAgICAgJ0ZBSUw6ICcgKyBlcnJvci5tZXNzYWdlLAogICAgICAnXG4gICcgKyBuZXcgU3RhY2soZXJyb3Iuc3RhY2ssIGZyID0+IGZyLmZ1bmN0aW9uTmFtZSAhPSAnZXNmYWN0b3J5JykudG9TdHJpbmcoKS5yZXBsYWNlKC9cbi9nLCAnXG4gICcpCiAgICApOwogICAgY29uc29sZS5sb2coJ0ZBSUwnKTsKICAgIHN0ZC5leGl0KDEpOwogIH0KfQoAAAAAAAAAAAacAAAAAAAAAAAAAAAAAAAAAAAABpwAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABLdwAAAAAAAFZ3AAAAAAAAAAAAAAAA8L8"
				]
			]
		},
		{
			"file": "sqlite3.js",
			"settings":
			{
				"buffer_size": 3858,
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					38,
					1,
					"insert",
					{
						"characters": "\n\n"
					},
					"AgAAAI8AAAAAAAAAkAAAAAAAAAAAAAAAkAAAAAAAAACRAAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACPAAAAAAAAAI8AAAAAAAAAAAAAAAAA8L8"
				],
				[
					41,
					1,
					"",
					null,
					"AQAAAJAAAAAAAAAAhAQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACQAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAA"
				],
				[
					52,
					1,
					"",
					null,
					"AgAAAI8AAAAAAAAA9QkAAAAAAAAAAAAA9QkAAAAAAAD1CQAAAAAAAPUDAAAKZXhwb3J0IGNvbnN0IFNRTElURV9PSyA9IDA7CmV4cG9ydCBjb25zdCBTUUxJVEVfRVJST1IgPSAxOwpleHBvcnQgY29uc3QgU1FMSVRFX0lOVEVSTkFMID0gMjsKZXhwb3J0IGNvbnN0IFNRTElURV9QRVJNID0gMzsKZXhwb3J0IGNvbnN0IFNRTElURV9BQk9SVCA9IDQ7CmV4cG9ydCBjb25zdCBTUUxJVEVfQlVTWSA9IDU7CmV4cG9ydCBjb25zdCBTUUxJVEVfTE9DS0VEID0gNjsKZXhwb3J0IGNvbnN0IFNRTElURV9OT01FTSA9IDc7CmV4cG9ydCBjb25zdCBTUUxJVEVfUkVBRE9OTFkgPSA4OwpleHBvcnQgY29uc3QgU1FMSVRFX0lOVEVSUlVQVCA9IDk7CmV4cG9ydCBjb25zdCBTUUxJVEVfSU9FUlIgPSAxMDsKZXhwb3J0IGNvbnN0IFNRTElURV9DT1JSVVBUID0gMTE7CmV4cG9ydCBjb25zdCBTUUxJVEVfTk9URk9VTkQgPSAxMjsKZXhwb3J0IGNvbnN0IFNRTElURV9GVUxMID0gMTM7CmV4cG9ydCBjb25zdCBTUUxJVEVfQ0FOVE9QRU4gPSAxNDsKZXhwb3J0IGNvbnN0IFNRTElURV9QUk9UT0NPTCA9IDE1OwpleHBvcnQgY29uc3QgU1FMSVRFX0VNUFRZID0gMTY7CmV4cG9ydCBjb25zdCBTUUxJVEVfU0NIRU1BID0gMTc7CmV4cG9ydCBjb25zdCBTUUxJVEVfVE9PQklHID0gMTg7CmV4cG9ydCBjb25zdCBTUUxJVEVfQ09OU1RSQUlOVCA9IDE5OwpleHBvcnQgY29uc3QgU1FMSVRFX01JU01BVENIID0gMjA7CmV4cG9ydCBjb25zdCBTUUxJVEVfTUlTVVNFID0gMjE7CmV4cG9ydCBjb25zdCBTUUxJVEVfTk9MRlMgPSAyMjsKZXhwb3J0IGNvbnN0IFNRTElURV9BVVRIID0gMjM7CmV4cG9ydCBjb25zdCBTUUxJVEVfRk9STUFUID0gMjQ7CmV4cG9ydCBjb25zdCBTUUxJVEVfUkFOR0UgPSAyNTsKZXhwb3J0IGNvbnN0IFNRTElURV9OT1RBREIgPSAyNjsKZXhwb3J0IGNvbnN0IFNRTElURV9OT1RJQ0UgPSAyNzsKZXhwb3J0IGNvbnN0IFNRTElURV9XQVJOSU5HID0gMjg7CmV4cG9ydCBjb25zdCBTUUxJVEVfUk9XID0gMTAwOwpleHBvcnQgY29uc3QgU1FMSVRFX0RPTkUgPSAxMDE7Cg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACPAAAAAAAAAIQEAAAAAAAAAAAAAAAA8L8"
				],
				[
					59,
					1,
					"insert",
					{
						"characters": "\n"
					},
					"AQAAAI4AAAAAAAAAjwAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACOAAAAAAAAAI4AAAAAAAAAAAAAAAAA8L8"
				],
				[
					62,
					1,
					"revert",
					null,
					"AwAAAAAAAAAAAAAAAAAAAAAAAABzEAAAaW1wb3J0IHsgZGxvcGVuLCBkZWZpbmUsIGRsZXJyb3IsIGRsY2xvc2UsIGRsc3ltLCBjYWxsLCBlcnJubywgUlRMRF9OT1cgfSBmcm9tICdmZmknOwoKY29uc3QgbGlic3FsaXRlMyA9IGRsb3BlbignbGlic3FsaXRlMy5zby4wJywgUlRMRF9OT1cpOwoKZXhwb3J0IGNvbnN0IFNRTElURV9PSyAgICAgICAgICAgPSAwOyAgICAvKiBTdWNjZXNzZnVsIHJlc3VsdCAqLwpleHBvcnQgY29uc3QgU1FMSVRFX0VSUk9SICAgICAgICA9IDE7ICAgIC8qIEdlbmVyaWMgZXJyb3IgKi8KZXhwb3J0IGNvbnN0IFNRTElURV9JTlRFUk5BTCAgICAgPSAyOyAgICAvKiBJbnRlcm5hbCBsb2dpYyBlcnJvciBpbiBTUUxpdGUgKi8KZXhwb3J0IGNvbnN0IFNRTElURV9QRVJNICAgICAgICAgPSAzOyAgICAvKiBBY2Nlc3MgcGVybWlzc2lvbiBkZW5pZWQgKi8KZXhwb3J0IGNvbnN0IFNRTElURV9BQk9SVCAgICAgICAgPSA0OyAgICAvKiBDYWxsYmFjayByb3V0aW5lIHJlcXVlc3RlZCBhbiBhYm9ydCAqLwpleHBvcnQgY29uc3QgU1FMSVRFX0JVU1kgICAgICAgICA9IDU7ICAgIC8qIFRoZSBkYXRhYmFzZSBmaWxlIGlzIGxvY2tlZCAqLwpleHBvcnQgY29uc3QgU1FMSVRFX0xPQ0tFRCAgICAgICA9IDY7ICAgIC8qIEEgdGFibGUgaW4gdGhlIGRhdGFiYXNlIGlzIGxvY2tlZCAqLwpleHBvcnQgY29uc3QgU1FMSVRFX05PTUVNICAgICAgICA9IDc7ICAgIC8qIEEgbWFsbG9jKCkgZmFpbGVkICovCmV4cG9ydCBjb25zdCBTUUxJVEVfUkVBRE9OTFkgICAgID0gODsgICAgLyogQXR0ZW1wdCB0byB3cml0ZSBhIHJlYWRvbmx5IGRhdGFiYXNlICovCmV4cG9ydCBjb25zdCBTUUxJVEVfSU5URVJSVVBUICAgID0gOTsgICAgLyogT3BlcmF0aW9uIHRlcm1pbmF0ZWQgYnkgc3FsaXRlM19pbnRlcnJ1cHQoKSovCmV4cG9ydCBjb25zdCBTUUxJVEVfSU9FUlIgICAgICAgPSAxMDsgICAgLyogU29tZSBraW5kIG9mIGRpc2sgSS9PIGVycm9yIG9jY3VycmVkICovCmV4cG9ydCBjb25zdCBTUUxJVEVfQ09SUlVQVCAgICAgPSAxMTsgICAgLyogVGhlIGRhdGFiYXNlIGRpc2sgaW1hZ2UgaXMgbWFsZm9ybWVkICovCmV4cG9ydCBjb25zdCBTUUxJVEVfTk9URk9VTkQgICAgPSAxMjsgICAgLyogVW5rbm93biBvcGNvZGUgaW4gc3FsaXRlM19maWxlX2NvbnRyb2woKSAqLwpleHBvcnQgY29uc3QgU1FMSVRFX0ZVTEwgICAgICAgID0gMTM7ICAgIC8qIEluc2VydGlvbiBmYWlsZWQgYmVjYXVzZSBkYXRhYmFzZSBpcyBmdWxsICovCmV4cG9ydCBjb25zdCBTUUxJVEVfQ0FOVE9QRU4gICAgPSAxNDsgICAgLyogVW5hYmxlIHRvIG9wZW4gdGhlIGRhdGFiYXNlIGZpbGUgKi8KZXhwb3J0IGNvbnN0IFNRTElURV9QUk9UT0NPTCAgICA9IDE1OyAgICAvKiBEYXRhYmFzZSBsb2NrIHByb3RvY29sIGVycm9yICovCmV4cG9ydCBjb25zdCBTUUxJVEVfRU1QVFkgICAgICAgPSAxNjsgICAgLyogSW50ZXJuYWwgdXNlIG9ubHkgKi8KZXhwb3J0IGNvbnN0IFNRTElURV9TQ0hFTUEgICAgICA9IDE3OyAgICAvKiBUaGUgZGF0YWJhc2Ugc2NoZW1hIGNoYW5nZWQgKi8KZXhwb3J0IGNvbnN0IFNRTElURV9UT09CSUcgICAgICA9IDE4OyAgICAvKiBTdHJpbmcgb3IgQkxPQiBleGNlZWRzIHNpemUgbGltaXQgKi8KZXhwb3J0IGNvbnN0IFNRTElURV9DT05TVFJBSU5UICA9IDE5OyAgICAvKiBBYm9ydCBkdWUgdG8gY29uc3RyYWludCB2aW9sYXRpb24gKi8KZXhwb3J0IGNvbnN0IFNRTElURV9NSVNNQVRDSCAgICA9IDIwOyAgICAvKiBEYXRhIHR5cGUgbWlzbWF0Y2ggKi8KZXhwb3J0IGNvbnN0IFNRTElURV9NSVNVU0UgICAgICA9IDIxOyAgICAvKiBMaWJyYXJ5IHVzZWQgaW5jb3JyZWN0bHkgKi8KZXhwb3J0IGNvbnN0IFNRTElURV9OT0xGUyAgICAgICA9IDIyOyAgICAvKiBVc2VzIE9TIGZlYXR1cmVzIG5vdCBzdXBwb3J0ZWQgb24gaG9zdCAqLwpleHBvcnQgY29uc3QgU1FMSVRFX0FVVEggICAgICAgID0gMjM7ICAgIC8qIEF1dGhvcml6YXRpb24gZGVuaWVkICovCmV4cG9ydCBjb25zdCBTUUxJVEVfRk9STUFUICAgICAgPSAyNDsgICAgLyogTm90IHVzZWQgKi8KZXhwb3J0IGNvbnN0IFNRTElURV9SQU5HRSAgICAgICA9IDI1OyAgICAvKiAybmQgcGFyYW1ldGVyIHRvIHNxbGl0ZTNfYmluZCBvdXQgb2YgcmFuZ2UgKi8KZXhwb3J0IGNvbnN0IFNRTElURV9OT1RBREIgICAgICA9IDI2OyAgICAvKiBGaWxlIG9wZW5lZCB0aGF0IGlzIG5vdCBhIGRhdGFiYXNlIGZpbGUgKi8KZXhwb3J0IGNvbnN0IFNRTElURV9OT1RJQ0UgICAgICA9IDI3OyAgICAvKiBOb3RpZmljYXRpb25zIGZyb20gc3FsaXRlM19sb2coKSAqLwpleHBvcnQgY29uc3QgU1FMSVRFX1dBUk5JTkcgICAgID0gMjg7ICAgIC8qIFdhcm5pbmdzIGZyb20gc3FsaXRlM19sb2coKSAqLwpleHBvcnQgY29uc3QgU1FMSVRFX1JPVyAgICAgICAgID0gMTAwOyAgIC8qIHNxbGl0ZTNfc3RlcCgpIGhhcyBhbm90aGVyIHJvdyByZWFkeSAqLwpleHBvcnQgY29uc3QgU1FMSVRFX0RPTkUgICAgICAgID0gMTAxOyAgIC8qIHNxbGl0ZTNfc3RlcCgpIGhhcyBmaW5pc2hlZCBleGVjdXRpbmcgKi8KCgovKiogICAgICAgCiAqIEBmdW5jdGlvbiBzcWxpdGUzX2Nsb3NlICAgCiAqIAogKiBAcGFyYW0gICAge051bWJlcn0gICAgICAgIGFyZzEKICogCiAqIEByZXR1cm4gICB7TnVtYmVyfSAgICAgICAgCiAqLwpkZWZpbmUoJ3NxbGl0ZTNfY2xvc2UnLCBkbHN5bShsaWJzcWxpdGUzLCAnc3FsaXRlM19jbG9zZScpLCBudWxsLCAnaW50JywgJ3ZvaWQgKicpOwpleHBvcnQgZnVuY3Rpb24gc3FsaXRlM19jbG9zZShhcmcxKSB7CiAgcmV0dXJuIGNhbGwoJ3NxbGl0ZTNfY2xvc2UnLCBhcmcxKTsKfQoKLyoqICAgICAgIAogKiBAZnVuY3Rpb24gc3FsaXRlM19leGVjICAgIAogKiAKICogQHBhcmFtICAgIHtOdW1iZXJ9ICAgICAgICBhcmcxCiAqIEBwYXJhbSAgICB7U3RyaW5nfSAgICAgICAgc3FsCiAqIEBwYXJhbSAgICB7TnVtYmVyfSAgICAgICAgY2FsbGJhY2sKICogQHBhcmFtICAgIHtOdW1iZXJ9ICAgICAgICBhcmc0CiAqIEBwYXJhbSAgICB7TnVtYmVyfSAgICAgICAgZXJybXNnCiAqIAogKiBAcmV0dXJuICAge051bWJlcn0gICAgICAgIAogKi8KZGVmaW5lKCdzcWxpdGUzX2V4ZWMnLCBkbHN5bShsaWJzcWxpdGUzLCAnc3FsaXRlM19leGVjJyksIG51bGwsICdpbnQnLCAndm9pZCAqJywgJ2NoYXIgKicsICdsb25nJywgJ3ZvaWQgKicsICd2b2lkIConKTsKZXhwb3J0IGZ1bmN0aW9uIHNxbGl0ZTNfZXhlYyhhcmcxLCBzcWwsIGNhbGxiYWNrLCBhcmc0LCBlcnJtc2cpIHsKICByZXR1cm4gY2FsbCgnc3FsaXRlM19leGVjJywgYXJnMSwgc3FsLCBjYWxsYmFjaywgYXJnNCwgZXJybXNnKTsKfQoKLyoqICAgICAgIAogKiBAZnVuY3Rpb24gc3FsaXRlM19mcmVlICAgIAogKiAKICogQHBhcmFtICAgIHtOdW1iZXJ9ICAgICAgICBhcmcxCiAqLwpkZWZpbmUoJ3NxbGl0ZTNfZnJlZScsIGRsc3ltKGxpYnNxbGl0ZTMsICdzcWxpdGUzX2ZyZWUnKSwgbnVsbCwgJ3ZvaWQnLCAndm9pZCAqJyk7CmV4cG9ydCBmdW5jdGlvbiBzcWxpdGUzX2ZyZWUoYXJnMSkgewogIGNhbGwoJ3NxbGl0ZTNfZnJlZScsIGFyZzEpOwp9CgovKiogICAgICAgCiAqIEBmdW5jdGlvbiBzcWxpdGUzX29wZW4gICAgCiAqIAogKiBAcGFyYW0gICAge1N0cmluZ30gICAgICAgIGZpbGVuYW1lCiAqIEBwYXJhbSAgICB7TnVtYmVyfSAgICAgICAgcHBEYgogKiAKICogQHJldHVybiAgIHtOdW1iZXJ9ICAgICAgICAKICovCmRlZmluZSgnc3FsaXRlM19vcGVuJywgZGxzeW0obGlic3FsaXRlMywgJ3NxbGl0ZTNfb3BlbicpLCBudWxsLCAnaW50JywgJ2NoYXIgKicsICd2b2lkIConKTsKZXhwb3J0IGZ1bmN0aW9uIHNxbGl0ZTNfb3BlbihmaWxlbmFtZSwgcHBEYikgewogIHJldHVybiBjYWxsKCdzcWxpdGUzX29wZW4nLCBmaWxlbmFtZSwgcHBEYik7Cn0KCi8qKiAgICAgICAKICogQGZ1bmN0aW9uIHNxbGl0ZTNfZXJybXNnICAKICogCiAqIEBwYXJhbSAgICB7TnVtYmVyfSAgICAgICAgYXJnMQogKiAKICogQHJldHVybiAgIHtTdHJpbmd9ICAgICAgICAKICovCmRlZmluZSgnc3FsaXRlM19lcnJtc2cnLCBkbHN5bShsaWJzcWxpdGUzLCAnc3FsaXRlM19lcnJtc2cnKSwgbnVsbCwgJ2NoYXIgKicsICd2b2lkIConKTsKZXhwb3J0IGZ1bmN0aW9uIHNxbGl0ZTNfZXJybXNnKGFyZzEpIHsKICByZXR1cm4gY2FsbCgnc3FsaXRlM19lcnJtc2cnLCBhcmcxKTsKfQoAAAAAAAAAABIPAAAAAAAAAAAAAAAAAAAAAAAAEg8AAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACPAAAAAAAAAI8AAAAAAAAAAAAAAAAA8L8"
				]
			]
		},
		{
			"file": "test-sqlite3.js",
			"settings":
			{
				"buffer_size": 778,
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					2,
					1,
					"insert",
					{
						"characters": "\n\n"
					},
					"AgAAADUCAAAAAAAANgIAAAAAAAAAAAAANgIAAAAAAAA3AgAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA1AgAAAAAAADUCAAAAAAAAAAAAAAAAAAA"
				],
				[
					4,
					1,
					"",
					null,
					"AQAAADcCAAAAAAAAaAIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA3AgAAAAAAADcCAAAAAAAAAAAAAAAA8L8"
				],
				[
					6,
					1,
					"insert",
					{
						"characters": "sqlite3_open("
					},
					"DQAAADcCAAAAAAAAOAIAAAAAAAAAAAAAOAIAAAAAAAA5AgAAAAAAAAAAAAA5AgAAAAAAADoCAAAAAAAAAAAAADoCAAAAAAAAOwIAAAAAAAAAAAAAOwIAAAAAAAA8AgAAAAAAAAAAAAA8AgAAAAAAAD0CAAAAAAAAAAAAAD0CAAAAAAAAPgIAAAAAAAAAAAAAPgIAAAAAAAA/AgAAAAAAAAAAAAA/AgAAAAAAAEACAAAAAAAAAAAAAEACAAAAAAAAQQIAAAAAAAAAAAAAQQIAAAAAAABCAgAAAAAAAAAAAABCAgAAAAAAAEMCAAAAAAAAAAAAAEMCAAAAAAAARAIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA3AgAAAAAAADcCAAAAAAAAAAAAAAAAAAA"
				],
				[
					7,
					1,
					"insert",
					{
						"characters": "'"
					},
					"AQAAAEQCAAAAAAAARQIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABEAgAAAAAAAEQCAAAAAAAAAAAAAAAA8L8"
				],
				[
					9,
					1,
					"insert",
					{
						"characters": "'\t"
					},
					"AgAAAHYCAAAAAAAAdwIAAAAAAAAAAAAAdwIAAAAAAAB5AgAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAB2AgAAAAAAAHYCAAAAAAAA////////738"
				],
				[
					10,
					1,
					"left_delete",
					null,
					"AQAAAHgCAAAAAAAAeAIAAAAAAAABAAAAIA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAB5AgAAAAAAAHkCAAAAAAAAAAAAAAAA8L8"
				],
				[
					11,
					1,
					"insert",
					{
						"characters": ","
					},
					"AQAAAHgCAAAAAAAAeQIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAB4AgAAAAAAAHgCAAAAAAAAAAAAAAAA8L8"
				],
				[
					12,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAHkCAAAAAAAAegIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAB5AgAAAAAAAHkCAAAAAAAAAAAAAAAA8L8"
				],
				[
					14,
					1,
					"insert",
					{
						"characters": "\n\n"
					},
					"AgAAADYCAAAAAAAANwIAAAAAAAAAAAAANwIAAAAAAAA4AgAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA2AgAAAAAAADYCAAAAAAAAAAAAAADAgEA"
				],
				[
					16,
					1,
					"insert",
					{
						"characters": "new"
					},
					"AwAAADcCAAAAAAAAOAIAAAAAAAAAAAAAOAIAAAAAAAA5AgAAAAAAAAAAAAA5AgAAAAAAADoCAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA3AgAAAAAAADcCAAAAAAAAAAAAAAAAAAA"
				],
				[
					17,
					1,
					"insert",
					{
						"characters": " Uint32Array"
					},
					"DAAAADoCAAAAAAAAOwIAAAAAAAAAAAAAOwIAAAAAAAA8AgAAAAAAAAAAAAA8AgAAAAAAAD0CAAAAAAAAAAAAAD0CAAAAAAAAPgIAAAAAAAAAAAAAPgIAAAAAAAA/AgAAAAAAAAAAAAA/AgAAAAAAAEACAAAAAAAAAAAAAEACAAAAAAAAQQIAAAAAAAAAAAAAQQIAAAAAAABCAgAAAAAAAAAAAABCAgAAAAAAAEMCAAAAAAAAAAAAAEMCAAAAAAAARAIAAAAAAAAAAAAARAIAAAAAAABFAgAAAAAAAAAAAABFAgAAAAAAAEYCAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA6AgAAAAAAADoCAAAAAAAAAAAAAAAA8L8"
				],
				[
					18,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAEYCAAAAAAAASAIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABGAgAAAAAAAEYCAAAAAAAAAAAAAAAA8L8"
				],
				[
					19,
					1,
					"insert",
					{
						"characters": "2"
					},
					"AQAAAEcCAAAAAAAASAIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABHAgAAAAAAAEcCAAAAAAAAAAAAAAAA8L8"
				],
				[
					21,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAEkCAAAAAAAASgIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABJAgAAAAAAAEkCAAAAAAAAAAAAAAAA8L8"
				],
				[
					23,
					1,
					"insert",
					{
						"characters": "a="
					},
					"AgAAADcCAAAAAAAAOAIAAAAAAAAAAAAAOAIAAAAAAAA5AgAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA3AgAAAAAAADcCAAAAAAAAAAAAAAAAAAA"
				],
				[
					25,
					1,
					"insert",
					{
						"characters": "let"
					},
					"AwAAADcCAAAAAAAAOAIAAAAAAAAAAAAAOAIAAAAAAAA5AgAAAAAAAAAAAAA5AgAAAAAAADoCAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA3AgAAAAAAADcCAAAAAAAAAAAAAAAA8L8"
				],
				[
					26,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAADoCAAAAAAAAOwIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA6AgAAAAAAADoCAAAAAAAAAAAAAAAA8L8"
				],
				[
					30,
					1,
					"insert",
					{
						"characters": "a.buffer);"
					},
					"CgAAAJUCAAAAAAAAlgIAAAAAAAAAAAAAlgIAAAAAAACXAgAAAAAAAAAAAACXAgAAAAAAAJgCAAAAAAAAAAAAAJgCAAAAAAAAmQIAAAAAAAAAAAAAmQIAAAAAAACaAgAAAAAAAAAAAACaAgAAAAAAAJsCAAAAAAAAAAAAAJsCAAAAAAAAnAIAAAAAAAAAAAAAnAIAAAAAAACdAgAAAAAAAAAAAACdAgAAAAAAAJ4CAAAAAAAAAAAAAJ4CAAAAAAAAnwIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACVAgAAAAAAAJUCAAAAAAAAAAAAAAAA8L8"
				],
				[
					38,
					1,
					"insert",
					{
						"characters": "let"
					},
					"AwAAAFICAAAAAAAAUwIAAAAAAAAAAAAAUwIAAAAAAABUAgAAAAAAAAAAAABUAgAAAAAAAFUCAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABSAgAAAAAAAFICAAAAAAAAAAAAAAAA8L8"
				],
				[
					39,
					1,
					"insert",
					{
						"characters": " ret="
					},
					"BQAAAFUCAAAAAAAAVgIAAAAAAAAAAAAAVgIAAAAAAABXAgAAAAAAAAAAAABXAgAAAAAAAFgCAAAAAAAAAAAAAFgCAAAAAAAAWQIAAAAAAAAAAAAAWQIAAAAAAABaAgAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABVAgAAAAAAAFUCAAAAAAAAAAAAAAAA8L8"
				],
				[
					42,
					1,
					"insert",
					{
						"characters": "ret,"
					},
					"BAAAADsCAAAAAAAAPAIAAAAAAAAAAAAAPAIAAAAAAAA9AgAAAAAAAAAAAAA9AgAAAAAAAD4CAAAAAAAAAAAAAD4CAAAAAAAAPwIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA7AgAAAAAAADsCAAAAAAAAAAAAAAAA8L8"
				],
				[
					46,
					3,
					"right_delete",
					null,
					"AwAAAFYCAAAAAAAAVgIAAAAAAAABAAAAbFYCAAAAAAAAVgIAAAAAAAABAAAAZVYCAAAAAAAAVgIAAAAAAAABAAAAdA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABWAgAAAAAAAFYCAAAAAAAAAAAAAAAA8L8"
				],
				[
					48,
					1,
					"insert",
					{
						"characters": "\n\nconsole.log"
					},
					"EAAAAKgCAAAAAAAAqQIAAAAAAAAAAAAAqQIAAAAAAACqAgAAAAAAAAAAAACqAgAAAAAAAKsCAAAAAAAAAAAAAKsCAAAAAAAArAIAAAAAAAAAAAAAqQIAAAAAAACpAgAAAAAAAAEAAAAgqwIAAAAAAACsAgAAAAAAAAAAAACsAgAAAAAAAK0CAAAAAAAAAAAAAK0CAAAAAAAArgIAAAAAAAAAAAAArgIAAAAAAACvAgAAAAAAAAAAAACvAgAAAAAAALACAAAAAAAAAAAAALACAAAAAAAAsQIAAAAAAAAAAAAAsQIAAAAAAACyAgAAAAAAAAAAAACyAgAAAAAAALMCAAAAAAAAAAAAALMCAAAAAAAAtAIAAAAAAAAAAAAAtAIAAAAAAAC1AgAAAAAAAAAAAAC1AgAAAAAAALYCAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACoAgAAAAAAAKgCAAAAAAAA////////738"
				],
				[
					49,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAALYCAAAAAAAAuAIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAC2AgAAAAAAALYCAAAAAAAAAAAAAAAA8L8"
				],
				[
					50,
					1,
					"insert_snippet",
					{
						"contents": "'$0'"
					},
					"AQAAALcCAAAAAAAAuQIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAC3AgAAAAAAALcCAAAAAAAAAAAAAAAA8L8"
				],
				[
					51,
					1,
					"insert",
					{
						"characters": "ret,"
					},
					"BAAAALgCAAAAAAAAuQIAAAAAAAAAAAAAuQIAAAAAAAC6AgAAAAAAAAAAAAC6AgAAAAAAALsCAAAAAAAAAAAAALsCAAAAAAAAvAIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAC4AgAAAAAAALgCAAAAAAAAAAAAAAAA8L8"
				],
				[
					52,
					1,
					"left_delete",
					null,
					"AQAAALsCAAAAAAAAuwIAAAAAAAABAAAALA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAC8AgAAAAAAALwCAAAAAAAAAAAAAAAA8L8"
				],
				[
					54,
					1,
					"insert",
					{
						"characters": ",ret"
					},
					"BAAAALwCAAAAAAAAvQIAAAAAAAAAAAAAvQIAAAAAAAC+AgAAAAAAAAAAAAC+AgAAAAAAAL8CAAAAAAAAAAAAAL8CAAAAAAAAwAIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAC8AgAAAAAAALwCAAAAAAAAAAAAAAAA8L8"
				],
				[
					56,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAMECAAAAAAAAwgIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADBAgAAAAAAAMECAAAAAAAAAAAAAAAA8L8"
				],
				[
					57,
					1,
					"ensure_newline_at_eof",
					null,
					"AQAAAMICAAAAAAAAwwIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADCAgAAAAAAAMICAAAAAAAAAAAAAAAA8L8"
				],
				[
					70,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAADDAgAAaW1wb3J0IHsgU1FMSVRFX09LLCBTUUxJVEVfRVJST1IsIFNRTElURV9JTlRFUk5BTCwgU1FMSVRFX1BFUk0sIFNRTElURV9BQk9SVCwgU1FMSVRFX0JVU1ksIFNRTElURV9MT0NLRUQsIFNRTElURV9OT01FTSwgU1FMSVRFX1JFQURPTkxZLCBTUUxJVEVfSU5URVJSVVBULCBTUUxJVEVfSU9FUlIsIFNRTElURV9DT1JSVVBULCBTUUxJVEVfTk9URk9VTkQsIFNRTElURV9GVUxMLCBTUUxJVEVfQ0FOVE9QRU4sIFNRTElURV9QUk9UT0NPTCwgU1FMSVRFX0VNUFRZLCBTUUxJVEVfU0NIRU1BLCBTUUxJVEVfVE9PQklHLCBTUUxJVEVfQ09OU1RSQUlOVCwgU1FMSVRFX01JU01BVENILCBTUUxJVEVfTUlTVVNFLCBTUUxJVEVfTk9MRlMsIFNRTElURV9BVVRILCBTUUxJVEVfRk9STUFULCBTUUxJVEVfUkFOR0UsIFNRTElURV9OT1RBREIsIFNRTElURV9OT1RJQ0UsIFNRTElURV9XQVJOSU5HLCBTUUxJVEVfUk9XLCBTUUxJVEVfRE9ORSwgc3FsaXRlM19jbG9zZSwgc3FsaXRlM19leGVjLCBzcWxpdGUzX2ZyZWUsIHNxbGl0ZTNfb3Blbiwgc3FsaXRlM19lcnJtc2cgfSBmcm9tICcuL3NxbGl0ZTMuanMnCgoKbGV0IHJldCxhPW5ldyBVaW50MzJBcnJheSgyKTsKCiByZXQ9c3FsaXRlM19vcGVuKCcvaG9tZS9yb21hbi8uY29uZmlnL2dvb2dsZS1jaHJvbWUvRGVmYXVsdC9IaXN0b3J5JyAsIGEuYnVmZmVyKTsKCiBjb25zb2xlLmxvZygncmV0JyxyZXQpOwoAAAAAAAAAAMgCAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA3AgAAAAAAADcCAAAAAAAAAAAAAAAA8L8"
				],
				[
					77,
					1,
					"insert",
					{
						"characters": "\nfunction"
					},
					"CQAAADYCAAAAAAAANwIAAAAAAAAAAAAANwIAAAAAAAA4AgAAAAAAAAAAAAA4AgAAAAAAADkCAAAAAAAAAAAAADkCAAAAAAAAOgIAAAAAAAAAAAAAOgIAAAAAAAA7AgAAAAAAAAAAAAA7AgAAAAAAADwCAAAAAAAAAAAAADwCAAAAAAAAPQIAAAAAAAAAAAAAPQIAAAAAAAA+AgAAAAAAAAAAAAA+AgAAAAAAAD8CAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA2AgAAAAAAADYCAAAAAAAAAAAAAAAAAAA"
				],
				[
					78,
					1,
					"insert",
					{
						"characters": " main"
					},
					"BQAAAD8CAAAAAAAAQAIAAAAAAAAAAAAAQAIAAAAAAABBAgAAAAAAAAAAAABBAgAAAAAAAEICAAAAAAAAAAAAAEICAAAAAAAAQwIAAAAAAAAAAAAAQwIAAAAAAABEAgAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA/AgAAAAAAAD8CAAAAAAAAAAAAAAAA8L8"
				],
				[
					79,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAEQCAAAAAAAARgIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABEAgAAAAAAAEQCAAAAAAAAAAAAAAAA8L8"
				],
				[
					81,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAEYCAAAAAAAARwIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABGAgAAAAAAAEYCAAAAAAAAAAAAAAAA8L8"
				],
				[
					82,
					1,
					"insert_snippet",
					{
						"contents": "{$0}"
					},
					"AQAAAEcCAAAAAAAASQIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABHAgAAAAAAAEcCAAAAAAAAAAAAAAAA8L8"
				],
				[
					84,
					1,
					"insert",
					{
						"characters": "...args"
					},
					"BwAAAEUCAAAAAAAARgIAAAAAAAAAAAAARgIAAAAAAABHAgAAAAAAAAAAAABHAgAAAAAAAEgCAAAAAAAAAAAAAEgCAAAAAAAASQIAAAAAAAAAAAAASQIAAAAAAABKAgAAAAAAAAAAAABKAgAAAAAAAEsCAAAAAAAAAAAAAEsCAAAAAAAATAIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABFAgAAAAAAAEUCAAAAAAAAAAAAAAAA8L8"
				],
				[
					86,
					1,
					"left_delete",
					null,
					"AQAAAE8CAAAAAAAATwIAAAAAAAABAAAAfQ",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABQAgAAAAAAAFACAAAAAAAA////////738"
				],
				[
					88,
					1,
					"insert",
					{
						"characters": "\n}"
					},
					"AgAAAOECAAAAAAAA4gIAAAAAAAAAAAAA4gIAAAAAAADjAgAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADhAgAAAAAAAOECAAAAAAAAAAAAAAAAaEA"
				],
				[
					89,
					1,
					"insert",
					{
						"characters": "\n\nmain"
					},
					"BgAAAOMCAAAAAAAA5AIAAAAAAAAAAAAA5AIAAAAAAADlAgAAAAAAAAAAAADlAgAAAAAAAOYCAAAAAAAAAAAAAOYCAAAAAAAA5wIAAAAAAAAAAAAA5wIAAAAAAADoAgAAAAAAAAAAAADoAgAAAAAAAOkCAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADjAgAAAAAAAOMCAAAAAAAAAAAAAAAA8L8"
				],
				[
					90,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAOkCAAAAAAAA6wIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADpAgAAAAAAAOkCAAAAAAAAAAAAAAAA8L8"
				],
				[
					91,
					1,
					"insert",
					{
						"characters": "...scriptArgs"
					},
					"DQAAAOoCAAAAAAAA6wIAAAAAAAAAAAAA6wIAAAAAAADsAgAAAAAAAAAAAADsAgAAAAAAAO0CAAAAAAAAAAAAAO0CAAAAAAAA7gIAAAAAAAAAAAAA7gIAAAAAAADvAgAAAAAAAAAAAADvAgAAAAAAAPACAAAAAAAAAAAAAPACAAAAAAAA8QIAAAAAAAAAAAAA8QIAAAAAAADyAgAAAAAAAAAAAADyAgAAAAAAAPMCAAAAAAAAAAAAAPMCAAAAAAAA9AIAAAAAAAAAAAAA9AIAAAAAAAD1AgAAAAAAAAAAAAD1AgAAAAAAAPYCAAAAAAAAAAAAAPYCAAAAAAAA9wIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADqAgAAAAAAAOoCAAAAAAAAAAAAAAAA8L8"
				],
				[
					92,
					1,
					"insert",
					{
						"characters": ".slice"
					},
					"BgAAAPcCAAAAAAAA+AIAAAAAAAAAAAAA+AIAAAAAAAD5AgAAAAAAAAAAAAD5AgAAAAAAAPoCAAAAAAAAAAAAAPoCAAAAAAAA+wIAAAAAAAAAAAAA+wIAAAAAAAD8AgAAAAAAAAAAAAD8AgAAAAAAAP0CAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAD3AgAAAAAAAPcCAAAAAAAAAAAAAAAA8L8"
				],
				[
					93,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAP0CAAAAAAAA/wIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAD9AgAAAAAAAP0CAAAAAAAAAAAAAAAA8L8"
				],
				[
					94,
					1,
					"insert",
					{
						"characters": "1"
					},
					"AQAAAP4CAAAAAAAA/wIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAD+AgAAAAAAAP4CAAAAAAAAAAAAAAAA8L8"
				],
				[
					96,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAAEDAAAAAAAAAgMAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAABAwAAAAAAAAEDAAAAAAAAAAAAAAAA8L8"
				],
				[
					97,
					1,
					"ensure_newline_at_eof",
					null,
					"AQAAAAIDAAAAAAAAAwMAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAACAwAAAAAAAAIDAAAAAAAAAAAAAAAA8L8"
				],
				[
					99,
					1,
					"revert",
					null,
					"AwAAAAAAAAAAAAAAAAAAAAAAAAADAwAAaW1wb3J0IHsgU1FMSVRFX09LLCBTUUxJVEVfRVJST1IsIFNRTElURV9JTlRFUk5BTCwgU1FMSVRFX1BFUk0sIFNRTElURV9BQk9SVCwgU1FMSVRFX0JVU1ksIFNRTElURV9MT0NLRUQsIFNRTElURV9OT01FTSwgU1FMSVRFX1JFQURPTkxZLCBTUUxJVEVfSU5URVJSVVBULCBTUUxJVEVfSU9FUlIsIFNRTElURV9DT1JSVVBULCBTUUxJVEVfTk9URk9VTkQsIFNRTElURV9GVUxMLCBTUUxJVEVfQ0FOVE9QRU4sIFNRTElURV9QUk9UT0NPTCwgU1FMSVRFX0VNUFRZLCBTUUxJVEVfU0NIRU1BLCBTUUxJVEVfVE9PQklHLCBTUUxJVEVfQ09OU1RSQUlOVCwgU1FMSVRFX01JU01BVENILCBTUUxJVEVfTUlTVVNFLCBTUUxJVEVfTk9MRlMsIFNRTElURV9BVVRILCBTUUxJVEVfRk9STUFULCBTUUxJVEVfUkFOR0UsIFNRTElURV9OT1RBREIsIFNRTElURV9OT1RJQ0UsIFNRTElURV9XQVJOSU5HLCBTUUxJVEVfUk9XLCBTUUxJVEVfRE9ORSwgc3FsaXRlM19jbG9zZSwgc3FsaXRlM19leGVjLCBzcWxpdGUzX2ZyZWUsIHNxbGl0ZTNfb3Blbiwgc3FsaXRlM19lcnJtc2cgfSBmcm9tICcuL3NxbGl0ZTMuanMnOwoKZnVuY3Rpb24gbWFpbiguLi5hcmdzKSB7CmxldCByZXQsCiAgYSA9IG5ldyBVaW50MzJBcnJheSgyKTsKCnJldCA9IHNxbGl0ZTNfb3BlbignL2hvbWUvcm9tYW4vLmNvbmZpZy9nb29nbGUtY2hyb21lL0RlZmF1bHQvSGlzdG9yeScsIGEuYnVmZmVyKTsKCmNvbnNvbGUubG9nKCdyZXQnLCByZXQpOwoKfQoKbWFpbiguLi5zY3JpcHRBcmdzLnNsaWNlKDEpKTsKAAAAAAAAAAAKAwAAAAAAAAAAAAAAAAAAAAAAAAoDAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAACAwAAAAAAAAIDAAAAAAAAAAAAAAAA8L8"
				]
			]
		},
		{
			"file": "quickjs/qjs-modules/src/qjsm.c",
			"settings":
			{
				"buffer_size": 45849,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					225,
					1,
					"toggle_comment",
					{
						"block": true
					},
					"AgAAAPckAAAAAAAA+SQAAAAAAAAAAAAAPSQAAAAAAAA/JAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA9JAAAAAAAAPckAAAAAAAAAAAAAAAA8L8"
				],
				[
					237,
					1,
					"insert",
					{
						"characters": "\n"
					},
					"AgAAAPskAAAAAAAA/CQAAAAAAAAAAAAA/CQAAAAAAAAAJQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAD7JAAAAAAAAPskAAAAAAAA////////738"
				],
				[
					239,
					2,
					"right_delete",
					null,
					"AwAAAD0kAAAAAAAAPSQAAAAAAAABAAAAL/skAAAAAAAA+yQAAAAAAAAEAAAAICAgID0kAAAAAAAAPSQAAAAAAAABAAAAKg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA9JAAAAAAAAD0kAAAAAAAAAAAAAAAAQEA"
				],
				[
					307,
					2,
					"left_delete",
					null,
					"AgAAAPgkAAAAAAAA+CQAAAAAAAABAAAAL/ckAAAAAAAA9yQAAAAAAAABAAAAKg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAD5JAAAAAAAAPkkAAAAAAAA////////738"
				],
				[
					308,
					1,
					"insert",
					{
						"characters": "s"
					},
					"AQAAAPckAAAAAAAA+CQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAD3JAAAAAAAAPckAAAAAAAAAAAAAAAA8L8"
				],
				[
					309,
					1,
					"left_delete",
					null,
					"AQAAAPckAAAAAAAA9yQAAAAAAAABAAAAcw",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAD4JAAAAAAAAPgkAAAAAAAAAAAAAAAA8L8"
				],
				[
					410,
					1,
					"insert",
					{
						"characters": "\nJS"
					},
					"BAAAAIkkAAAAAAAAiiQAAAAAAAAAAAAAiiQAAAAAAACOJAAAAAAAAAAAAACOJAAAAAAAAI8kAAAAAAAAAAAAAI8kAAAAAAAAkCQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACJJAAAAAAAAIkkAAAAAAAAAAAAAAAA8L8"
				],
				[
					411,
					2,
					"left_delete",
					null,
					"AgAAAI8kAAAAAAAAjyQAAAAAAAABAAAAU44kAAAAAAAAjiQAAAAAAAABAAAASg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACQJAAAAAAAAJAkAAAAAAAAAAAAAAAA8L8"
				],
				[
					412,
					1,
					"insert",
					{
						"characters": "const"
					},
					"BQAAAI4kAAAAAAAAjyQAAAAAAAAAAAAAjyQAAAAAAACQJAAAAAAAAAAAAACQJAAAAAAAAJEkAAAAAAAAAAAAAJEkAAAAAAAAkiQAAAAAAAAAAAAAkiQAAAAAAACTJAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACOJAAAAAAAAI4kAAAAAAAAAAAAAAAA8L8"
				],
				[
					413,
					1,
					"insert",
					{
						"characters": " char*"
					},
					"BgAAAJMkAAAAAAAAlCQAAAAAAAAAAAAAlCQAAAAAAACVJAAAAAAAAAAAAACVJAAAAAAAAJYkAAAAAAAAAAAAAJYkAAAAAAAAlyQAAAAAAAAAAAAAlyQAAAAAAACYJAAAAAAAAAAAAACYJAAAAAAAAJkkAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACTJAAAAAAAAJMkAAAAAAAAAAAAAAAA8L8"
				],
				[
					414,
					1,
					"insert",
					{
						"characters": " msg"
					},
					"BAAAAJkkAAAAAAAAmiQAAAAAAAAAAAAAmiQAAAAAAACbJAAAAAAAAAAAAACbJAAAAAAAAJwkAAAAAAAAAAAAAJwkAAAAAAAAnSQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACZJAAAAAAAAJkkAAAAAAAAAAAAAAAA8L8"
				],
				[
					415,
					1,
					"insert",
					{
						"characters": " =)"
					},
					"AwAAAJ0kAAAAAAAAniQAAAAAAAAAAAAAniQAAAAAAACfJAAAAAAAAAAAAACfJAAAAAAAAKAkAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACdJAAAAAAAAJ0kAAAAAAAAAAAAAAAA8L8"
				],
				[
					416,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAKAkAAAAAAAAoSQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACgJAAAAAAAAKAkAAAAAAAAAAAAAAAA8L8"
				],
				[
					417,
					2,
					"left_delete",
					null,
					"AgAAAKAkAAAAAAAAoCQAAAAAAAABAAAAIJ8kAAAAAAAAnyQAAAAAAAABAAAAKQ",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAChJAAAAAAAAKEkAAAAAAAAAAAAAAAA8L8"
				],
				[
					418,
					1,
					"insert",
					{
						"characters": " JS_ToCStriong"
					},
					"DgAAAJ8kAAAAAAAAoCQAAAAAAAAAAAAAoCQAAAAAAAChJAAAAAAAAAAAAAChJAAAAAAAAKIkAAAAAAAAAAAAAKIkAAAAAAAAoyQAAAAAAAAAAAAAoyQAAAAAAACkJAAAAAAAAAAAAACkJAAAAAAAAKUkAAAAAAAAAAAAAKUkAAAAAAAApiQAAAAAAAAAAAAApiQAAAAAAACnJAAAAAAAAAAAAACnJAAAAAAAAKgkAAAAAAAAAAAAAKgkAAAAAAAAqSQAAAAAAAAAAAAAqSQAAAAAAACqJAAAAAAAAAAAAACqJAAAAAAAAKskAAAAAAAAAAAAAKskAAAAAAAArCQAAAAAAAAAAAAArCQAAAAAAACtJAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACfJAAAAAAAAJ8kAAAAAAAAAAAAAAAA8L8"
				],
				[
					419,
					3,
					"left_delete",
					null,
					"AwAAAKwkAAAAAAAArCQAAAAAAAABAAAAZ6skAAAAAAAAqyQAAAAAAAABAAAAbqokAAAAAAAAqiQAAAAAAAABAAAAbw",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACtJAAAAAAAAK0kAAAAAAAAAAAAAAAA8L8"
				],
				[
					420,
					1,
					"insert",
					{
						"characters": "ng"
					},
					"AgAAAKokAAAAAAAAqyQAAAAAAAAAAAAAqyQAAAAAAACsJAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACqJAAAAAAAAKokAAAAAAAAAAAAAAAA8L8"
				],
				[
					421,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAKwkAAAAAAAAriQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACsJAAAAAAAAKwkAAAAAAAAAAAAAAAA8L8"
				],
				[
					422,
					1,
					"insert",
					{
						"characters": "/c"
					},
					"AgAAAK0kAAAAAAAAriQAAAAAAAAAAAAAriQAAAAAAACvJAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACtJAAAAAAAAK0kAAAAAAAAAAAAAAAA8L8"
				],
				[
					423,
					2,
					"left_delete",
					null,
					"AgAAAK4kAAAAAAAAriQAAAAAAAABAAAAY60kAAAAAAAArSQAAAAAAAABAAAALw",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACvJAAAAAAAAK8kAAAAAAAAAAAAAAAA8L8"
				],
				[
					424,
					1,
					"insert",
					{
						"characters": "ctx,"
					},
					"BAAAAK0kAAAAAAAAriQAAAAAAAAAAAAAriQAAAAAAACvJAAAAAAAAAAAAACvJAAAAAAAALAkAAAAAAAAAAAAALAkAAAAAAAAsSQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACtJAAAAAAAAK0kAAAAAAAAAAAAAAAA8L8"
				],
				[
					425,
					1,
					"insert",
					{
						"characters": "  "
					},
					"AgAAALEkAAAAAAAAsiQAAAAAAAAAAAAAsiQAAAAAAACzJAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACxJAAAAAAAALEkAAAAAAAAAAAAAAAA8L8"
				],
				[
					431,
					1,
					"paste",
					null,
					"AQAAALMkAAAAAAAAziQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACzJAAAAAAAALMkAAAAAAAAAAAAAAAA8L8"
				],
				[
					433,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAM8kAAAAAAAA0CQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADPJAAAAAAAAM8kAAAAAAAAAAAAAAAA8L8"
				],
				[
					453,
					1,
					"insert",
					{
						"characters": "msg"
					},
					"AwAAAA8lAAAAAAAAECUAAAAAAAAAAAAAECUAAAAAAAARJQAAAAAAAAAAAAARJQAAAAAAABIlAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAPJQAAAAAAAA8lAAAAAAAAAAAAAAAA8L8"
				],
				[
					455,
					1,
					"left_delete",
					null,
					"AQAAABIlAAAAAAAAEiUAAAAAAAAPAAAAc3RyZXJyb3IoZXJybm8p",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAASJQAAAAAAACElAAAAAAAAAAAAAAAA8L8"
				],
				[
					457,
					1,
					"insert",
					{
						"characters": "\nif"
					},
					"BAAAADIlAAAAAAAAMyUAAAAAAAAAAAAAMyUAAAAAAAA3JQAAAAAAAAAAAAA3JQAAAAAAADglAAAAAAAAAAAAADglAAAAAAAAOSUAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAyJQAAAAAAADIlAAAAAAAA////////738"
				],
				[
					458,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAADklAAAAAAAAOyUAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA5JQAAAAAAADklAAAAAAAAAAAAAAAA8L8"
				],
				[
					459,
					1,
					"insert",
					{
						"characters": "msg"
					},
					"AwAAADolAAAAAAAAOyUAAAAAAAAAAAAAOyUAAAAAAAA8JQAAAAAAAAAAAAA8JQAAAAAAAD0lAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA6JQAAAAAAADolAAAAAAAAAAAAAAAA8L8"
				],
				[
					461,
					1,
					"insert",
					{
						"characters": "\nJS_FreeV"
					},
					"DAAAAD4lAAAAAAAAPyUAAAAAAAAAAAAAPyUAAAAAAABDJQAAAAAAAAAAAAA/JQAAAAAAAD8lAAAAAAAABAAAACAgICA/JQAAAAAAAEUlAAAAAAAAAAAAAEUlAAAAAAAARiUAAAAAAAAAAAAARiUAAAAAAABHJQAAAAAAAAAAAABHJQAAAAAAAEglAAAAAAAAAAAAAEglAAAAAAAASSUAAAAAAAAAAAAASSUAAAAAAABKJQAAAAAAAAAAAABKJQAAAAAAAEslAAAAAAAAAAAAAEslAAAAAAAATCUAAAAAAAAAAAAATCUAAAAAAABNJQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA+JQAAAAAAAD4lAAAAAAAAAAAAAAAA8L8"
				],
				[
					462,
					1,
					"left_delete",
					null,
					"AQAAAEwlAAAAAAAATCUAAAAAAAABAAAAVg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABNJQAAAAAAAE0lAAAAAAAAAAAAAAAA8L8"
				],
				[
					463,
					1,
					"insert",
					{
						"characters": "CS"
					},
					"AgAAAEwlAAAAAAAATSUAAAAAAAAAAAAATSUAAAAAAABOJQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABMJQAAAAAAAEwlAAAAAAAAAAAAAAAA8L8"
				],
				[
					464,
					1,
					"insert_completion",
					{
						"completion": "JS_FreeCString",
						"format": "text",
						"keep_prefix": false,
						"must_insert": false,
						"trigger": "JS_FreeCString"
					},
					"AgAAAEUlAAAAAAAARSUAAAAAAAAJAAAASlNfRnJlZUNTRSUAAAAAAABTJQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABOJQAAAAAAAE4lAAAAAAAAAAAAAAAA8L8"
				],
				[
					465,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAFMlAAAAAAAAVSUAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABTJQAAAAAAAFMlAAAAAAAAAAAAAAAA8L8"
				],
				[
					466,
					1,
					"insert",
					{
						"characters": "ctx,"
					},
					"BAAAAFQlAAAAAAAAVSUAAAAAAAAAAAAAVSUAAAAAAABWJQAAAAAAAAAAAABWJQAAAAAAAFclAAAAAAAAAAAAAFclAAAAAAAAWCUAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABUJQAAAAAAAFQlAAAAAAAAAAAAAAAA8L8"
				],
				[
					467,
					1,
					"insert",
					{
						"characters": " msg"
					},
					"BAAAAFglAAAAAAAAWSUAAAAAAAAAAAAAWSUAAAAAAABaJQAAAAAAAAAAAABaJQAAAAAAAFslAAAAAAAAAAAAAFslAAAAAAAAXCUAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABYJQAAAAAAAFglAAAAAAAAAAAAAAAA8L8"
				],
				[
					469,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAF0lAAAAAAAAXiUAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABdJQAAAAAAAF0lAAAAAAAAAAAAAAAA8L8"
				],
				[
					475,
					1,
					"insert",
					{
						"characters": "\n"
					},
					"AgAAADclAAAAAAAAOCUAAAAAAAAAAAAAOCUAAAAAAAA8JQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA3JQAAAAAAADclAAAAAAAAAAAAAAAAQEA"
				],
				[
					479,
					1,
					"run_macro_file",
					{
						"file": "res://Packages/Default/Add Line.sublime-macro"
					},
					"AgAAADIlAAAAAAAAMyUAAAAAAAAAAAAAMyUAAAAAAAA3JQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADVJAAAAAAAANUkAAAAAAAAAAAAAAAAQEA"
				],
				[
					482,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAADrsgAAI2luY2x1ZGUgPHN0ZGxpYi5oPgojaW5jbHVkZSA8c3RkaW8uaD4KI2luY2x1ZGUgPHN0ZGFyZy5oPgojaW5jbHVkZSA8aW50dHlwZXMuaD4KI2luY2x1ZGUgPHN0cmluZy5oPgojaW5jbHVkZSA8YXNzZXJ0Lmg+CiNpbmNsdWRlIDx1bmlzdGQuaD4KI2luY2x1ZGUgPGVycm5vLmg+CiNpbmNsdWRlIDxmY250bC5oPgojaW5jbHVkZSA8dGltZS5oPgojaW5jbHVkZSA8c2lnbmFsLmg+CiNpZmRlZiBIQVZFX0FMTE9DQV9ICiNpbmNsdWRlIDxhbGxvY2EuaD4KI2VuZGlmCi8qI2luY2x1ZGUgPHN5cy9wb2xsLmg+Ki8KI2lmIGRlZmluZWQoX19BUFBMRV9fKQojaW5jbHVkZSA8bWFsbG9jL21hbGxvYy5oPgojZWxpZiBkZWZpbmVkKF9fbGludXhfXykKI2luY2x1ZGUgPG1hbGxvYy5oPgojZW5kaWYKI2lmICFkZWZpbmVkKF9fd2FzaV9fKSAmJiAhZGVmaW5lZChfV0lOMzIpCiNpbmNsdWRlIDxkbGZjbi5oPgojZW5kaWYKCiNpZmRlZiBIQVZFX1FVSUNLSlNfQ09ORklHX0gKI2luY2x1ZGUgPHF1aWNranMtY29uZmlnLmg+CiNlbmRpZgoKI2lmbmRlZiBDT05GSUdfU0hFWFQKI2lmZGVmIF9XSU4zMgojZGVmaW5lIENPTkZJR19TSEVYVCAiLmRsbCIKI2VsaWYgZGVmaW5lZChfX0FQUExFX18pCiNkZWZpbmUgQ09ORklHX1NIRVhUICIuZHlsaWIiCiNlbHNlCiNkZWZpbmUgQ09ORklHX1NIRVhUICIuc28iCiNlbmRpZgojZW5kaWYKCiNpZmRlZiBVU0VfV09SS0VSCiNpbmNsdWRlIDxwdGhyZWFkLmg+CiNpbmNsdWRlIDxzdGRhdG9taWMuaD4KCnN0YXRpYyBpbnQKYXRvbWljX2FkZF9pbnQoaW50KiBwdHIsIGludCB2KSB7CiAgcmV0dXJuIGF0b21pY19mZXRjaF9hZGQoKF9BdG9taWModWludDMyX3QpKilwdHIsIHYpICsgdjsKfQojZW5kaWYKCiNpbmNsdWRlIDxsaXN0Lmg+CiNpbmNsdWRlIDxjdXRpbHMuaD4KI2luY2x1ZGUgInBhdGguaCIKI2luY2x1ZGUgInV0aWxzLmgiCiNpbmNsdWRlICJ2ZWN0b3IuaCIKI2luY2x1ZGUgPHF1aWNranMtbGliYy5oPgojaW5jbHVkZSAicXVpY2tqcy1pbnRlcm5hbC5oIgojaW5jbHVkZSAiYnVmZmVyLXV0aWxzLmgiCiNpbmNsdWRlICJkZWJ1Zy5oIgoKdHlwZWRlZiBKU01vZHVsZURlZiogTW9kdWxlSW5pdEZ1bmN0aW9uKEpTQ29udGV4dCosIGNvbnN0IGNoYXIqKTsKdHlwZWRlZiBjaGFyKiBNb2R1bGVMb2FkZXIoSlNDb250ZXh0KiwgY29uc3QgY2hhciopOwoKc3RhdGljIGludCBkZWJ1Z19tb2R1bGVfbG9hZGVyID0gMDsKc3RhdGljIFZlY3RvciBtb2R1bGVfZGVidWcgPSBWRUNUT1JfSU5JVCgpOwpzdGF0aWMgdGhyZWFkX2xvY2FsIFZlY3RvciBtb2R1bGVfbGlzdCA9IFZFQ1RPUl9JTklUKCk7Ci8vIHN0YXRpYyBWZWN0b3IgYnVpbHRpbnMgPSBWRUNUT1JfSU5JVCgpOwoKI2lmbmRlZiBRVUlDS0pTX01PRFVMRV9QQVRICiNpZmRlZiBDT05GSUdfUFJFRklYCiNkZWZpbmUgUVVJQ0tKU19NT0RVTEVfUEFUSCBDT05GSUdfUFJFRklYICIvbGliL3F1aWNranMiCiNlbmRpZgojZW5kaWYKCnN0YXRpYyBjb25zdCBjaGFyIGpzbV9kZWZhdWx0X21vZHVsZV9wYXRoW10gPSBRVUlDS0pTX01PRFVMRV9QQVRIOwoKc3RhdGljIEpTTW9kdWxlTG9hZGVyRnVuYyogbW9kdWxlX2xvYWRlciA9IDA7CnN0YXRpYyBKU1ZhbHVlIHBhY2thZ2VfanNvbiwgcmVwbE9iajsKc3RhdGljIGNvbnN0IGNoYXIqIGV4ZW5hbWU7CnN0YXRpYyBKU1J1bnRpbWUqIHJ0OwpzdGF0aWMgSlNDb250ZXh0KiBjdHg7CnN0YXRpYyBjb25zdCBjaGFyKiBtb2R1bGVfZXh0ZW5zaW9uc1tdID0gewogICAgQ09ORklHX1NIRVhULAogICAgIi5qcyIsCiAgICAiL2luZGV4LmpzIiwKICAgICIvcGFja2FnZS5qc29uIiwKfTsKCnN0YXRpYyBCT09MCmlzX3NlYXJjaGFibGUoY29uc3QgY2hhciogcGF0aCkgewogIHJldHVybiAhcGF0aF9pc2V4cGxpY2l0KHBhdGgpOwp9CgpzdGF0aWMgY2hhcioKaXNfbW9kdWxlKEpTQ29udGV4dCogY3R4LCBjb25zdCBjaGFyKiBtb2R1bGVfbmFtZSkgewogIEJPT0wgeWVzID0gcGF0aF9pc2ZpbGUxKG1vZHVsZV9uYW1lKTsKCiAgaWYoZGVidWdfbW9kdWxlX2xvYWRlciA+PSAyKQogICAgcHJpbnRmKCIlLTE4cyhtb2R1bGVfbmFtZT1cIiVzXCIpPSVzXG4iLCBfX0ZVTkNUSU9OX18sIG1vZHVsZV9uYW1lLCAoKHllcykgPyAiVFJVRSIgOiAiRkFMU0UiKSk7CgogIHJldHVybiB5ZXMgPyBqc19zdHJkdXAoY3R4LCBtb2R1bGVfbmFtZSkgOiAwOwp9CgpzdGF0aWMgQk9PTAptb2R1bGVfaGFzX3N1ZmZpeChKU0NvbnRleHQqIGN0eCwgY29uc3QgY2hhciogbW9kdWxlX25hbWUpIHsKICBzaXplX3QgaSwgbjsKCiAgbiA9IGNvdW50b2YobW9kdWxlX2V4dGVuc2lvbnMpOwogIGZvcihpID0gMDsgaSA8IG47IGkrKykKICAgIGlmKGhhc19zdWZmaXgobW9kdWxlX25hbWUsIG1vZHVsZV9leHRlbnNpb25zW2ldKSkKICAgICAgcmV0dXJuIFRSVUU7CgogIHJldHVybiBGQUxTRTsKfQoKLyp0eXBlZGVmIHN0cnVjdCBwb2xsaGFuZGxlciB7CiAgc3RydWN0IHBvbGxmZCBwZjsKICB2b2lkICgqaGFuZGxlcikodm9pZCogb3BhcXVlLCBzdHJ1Y3QgcG9sbGZkKik7CiAgdm9pZCogb3BhcXVlOwogIHN0cnVjdCBsaXN0X2hlYWQgbGluazsKfSBwb2xsaGFuZGxlcl90OwoKdGhyZWFkX2xvY2FsIHVpbnQ2NF90IGpzbV9wZW5kaW5nX3NpZ25hbHMgPSAwOwpzdHJ1Y3QgbGlzdF9oZWFkIHBvbGxoYW5kbGVyczsqLwoKI2lmZGVmIEhBVkVfR0VUX01PRFVMRV9MT0FERVJfRlVOQwpKU01vZHVsZUxvYWRlckZ1bmMqIGpzX3N0ZF9nZXRfbW9kdWxlX2xvYWRlcl9mdW5jKCk7CnZvaWQganNfc3RkX3NldF9tb2R1bGVfbG9hZGVyX2Z1bmMoSlNNb2R1bGVMb2FkZXJGdW5jKiBmdW5jKTsKI2VuZGlmCgojaWYgIURPTlRfSEFWRV9NQUxMT0NfVVNBQkxFX1NJWkUgJiYgIWRlZmluZWQoQU5EUk9JRCkKI2lmIEhBVkVfTUFMTE9DX1VTQUJMRV9TSVpFCiNpZm5kZWYgSEFWRV9NQUxMT0NfVVNBQkxFX1NJWkVfREVGSU5JVElPTgpleHRlcm4gc2l6ZV90IG1hbGxvY191c2FibGVfc2l6ZSgpOwojZW5kaWYKI2VuZGlmCiNlbmRpZgoKI2RlZmluZSB0cmltX2RvdHNsYXNoKHN0cikgKCFzdHJuY21wKChzdHIpLCAiLi8iLCAyKSA/IChzdHIpICsgMiA6IChzdHIpKQoKdHlwZWRlZiBzdHJ1Y3QganNtX21vZHVsZV9yZWNvcmQgewogIGNvbnN0IGNoYXIqIG1vZHVsZV9uYW1lOwogIEpTTW9kdWxlRGVmKiAoKm1vZHVsZV9mdW5jKShKU0NvbnRleHQqLCBjb25zdCBjaGFyKik7CiAgdWludDhfdCogYnl0ZV9jb2RlOwogIHVpbnQzMl90IGJ5dGVfY29kZV9sZW47CiAgSlNNb2R1bGVEZWYqIGRlZjsKICBCT09MIGluaXRpYWxpemVkIDogMTsKfSBCdWlsdGluTW9kdWxlOwoKI2RlZmluZSBqc21fbW9kdWxlX2V4dGVybl9jb21waWxlZChuYW1lKSBcCiAgZXh0ZXJuIGNvbnN0IHVpbnQ4X3QgcWpzY18jI25hbWVbXTsgXAogIGV4dGVybiBjb25zdCB1aW50MzJfdCBxanNjXyMjbmFtZSMjX3NpemU7CgojZGVmaW5lIGpzbV9tb2R1bGVfZXh0ZXJuX25hdGl2ZShuYW1lKSBleHRlcm4gSlNNb2R1bGVEZWYqIGpzX2luaXRfbW9kdWxlXyMjbmFtZShKU0NvbnRleHQqLCBjb25zdCBjaGFyKikKCiNkZWZpbmUganNtX21vZHVsZV9yZWNvcmRfY29tcGlsZWQobmFtZSkgXAogIChCdWlsdGluTW9kdWxlKSB7ICNuYW1lLCAwLCBxanNjXyMjbmFtZSwgcWpzY18jI25hbWUjI19zaXplLCAwIH0KCiNkZWZpbmUganNtX21vZHVsZV9yZWNvcmRfbmF0aXZlKG5hbWUpIFwKICAoQnVpbHRpbk1vZHVsZSkgeyAjbmFtZSwganNfaW5pdF9tb2R1bGVfIyNuYW1lLCAwLCAwLCAwIH0KCmpzbV9tb2R1bGVfZXh0ZXJuX25hdGl2ZShzdGQpOwpqc21fbW9kdWxlX2V4dGVybl9uYXRpdmUob3MpOwpqc21fbW9kdWxlX2V4dGVybl9uYXRpdmUoY2hpbGRfcHJvY2Vzcyk7CmpzbV9tb2R1bGVfZXh0ZXJuX25hdGl2ZShkZWVwKTsKanNtX21vZHVsZV9leHRlcm5fbmF0aXZlKGluc3BlY3QpOwpqc21fbW9kdWxlX2V4dGVybl9uYXRpdmUobGV4ZXIpOwpqc21fbW9kdWxlX2V4dGVybl9uYXRpdmUobWlzYyk7Ci8vIGpzbV9tb2R1bGVfZXh0ZXJuX25hdGl2ZShtbWFwKTsKanNtX21vZHVsZV9leHRlcm5fbmF0aXZlKHBhdGgpOwpqc21fbW9kdWxlX2V4dGVybl9uYXRpdmUocG9pbnRlcik7CmpzbV9tb2R1bGVfZXh0ZXJuX25hdGl2ZShwcmVkaWNhdGUpOwpqc21fbW9kdWxlX2V4dGVybl9uYXRpdmUocmVwZWF0ZXIpOwpqc21fbW9kdWxlX2V4dGVybl9uYXRpdmUodHJlZV93YWxrZXIpOwpqc21fbW9kdWxlX2V4dGVybl9uYXRpdmUoeG1sKTsKCmpzbV9tb2R1bGVfZXh0ZXJuX2NvbXBpbGVkKGNvbnNvbGUpOwpqc21fbW9kdWxlX2V4dGVybl9jb21waWxlZChldmVudHMpOwpqc21fbW9kdWxlX2V4dGVybl9jb21waWxlZChmcyk7CmpzbV9tb2R1bGVfZXh0ZXJuX2NvbXBpbGVkKHBlcmZfaG9va3MpOwpqc21fbW9kdWxlX2V4dGVybl9jb21waWxlZChwcm9jZXNzKTsKanNtX21vZHVsZV9leHRlcm5fY29tcGlsZWQocmVwbCk7CmpzbV9tb2R1bGVfZXh0ZXJuX2NvbXBpbGVkKHJlcXVpcmUpOwpqc21fbW9kdWxlX2V4dGVybl9jb21waWxlZCh0dHkpOwpqc21fbW9kdWxlX2V4dGVybl9jb21waWxlZCh1dGlsKTsKCnN0YXRpYyB0aHJlYWRfbG9jYWwgVmVjdG9yIGpzbV9zdGFjayA9IFZFQ1RPUl9JTklUKCk7CnN0YXRpYyB0aHJlYWRfbG9jYWwgVmVjdG9yIGpzbV9idWlsdGluX21vZHVsZXMgPSBWRUNUT1JfSU5JVCgpOwpzdGF0aWMgdGhyZWFkX2xvY2FsIEJPT0wganNtX21vZHVsZXNfaW5pdGlhbGl6ZWQ7CgojaWZkZWYgQ09ORklHX0JJR05VTQpqc21fbW9kdWxlX2V4dGVybl9jb21waWxlZChxanNjYWxjKTsKc3RhdGljIGludCBiaWdudW1fZXh0ID0gMTsKI2VuZGlmCgp2b2lkIGpzX3N0ZF9zZXRfd29ya2VyX25ld19jb250ZXh0X2Z1bmMoSlNDb250ZXh0KiAoKmZ1bmMpKEpTUnVudGltZSogcnQpKTsKCnN0YXRpYyB2b2lkCmpzbV9kdW1wX2Vycm9yKEpTQ29udGV4dCogY3R4KSB7CiAgLypKU1J1bnRpbWUqIHJ0ID0gSlNfR2V0UnVudGltZShjdHgpOwogIEpTVmFsdWUgZXJyb3IgPSBydC0+Y3VycmVudF9leGNlcHRpb247Ki8KICAvKnByaW50ZigicWpzbTogY3VycmVudF9leGNlcHRpb24gMHglMDh4XG4iLCBvZmZzZXRvZihKU1J1bnRpbWUsIGN1cnJlbnRfZXhjZXB0aW9uKSk7CiAgcHJpbnRmKCJxanNtOiBzaXplb2Yoc3RydWN0IGxpc3RfaGVhZCkgMHglMDh4XG4iLCBzaXplb2Yoc3RydWN0IGxpc3RfaGVhZCkpOyovCgogIGpzX2Vycm9yX3ByaW50KGN0eCwgSlNfR2V0RXhjZXB0aW9uKGN0eCkpOwp9CgpzdGF0aWMgaW50CmpzbV9ldmFsX2J1ZihKU0NvbnRleHQqIGN0eCwgY29uc3Qgdm9pZCogYnVmLCBpbnQgYnVmX2xlbiwgY29uc3QgY2hhciogZmlsZW5hbWUsIGludCBldmFsX2ZsYWdzKSB7CiAgSlNWYWx1ZSB2YWw7CiAgaW50IHJldDsKCiAgaWYoKGV2YWxfZmxhZ3MgJiBKU19FVkFMX1RZUEVfTUFTSykgPT0gSlNfRVZBTF9UWVBFX01PRFVMRSkgewogICAgLyogZm9yIHRoZSBtb2R1bGVzLCB3ZSBjb21waWxlIHRoZW4gcnVuIHRvIGJlIGFibGUgdG8gc2V0IGltcG9ydC5tZXRhICovCiAgICB2YWwgPSBKU19FdmFsKGN0eCwgYnVmLCBidWZfbGVuLCBmaWxlbmFtZSwgZXZhbF9mbGFncyB8IEpTX0VWQUxfRkxBR19DT01QSUxFX09OTFkpOwogICAgaWYoIUpTX0lzRXhjZXB0aW9uKHZhbCkpIHsKICAgICAganNfbW9kdWxlX3NldF9pbXBvcnRfbWV0YShjdHgsIHZhbCwgVFJVRSwgVFJVRSk7CiAgICAgIHZhbCA9IEpTX0V2YWxGdW5jdGlvbihjdHgsIHZhbCk7CiAgICB9CiAgfSBlbHNlIHsKICAgIHZhbCA9IEpTX0V2YWwoY3R4LCBidWYsIGJ1Zl9sZW4sIGZpbGVuYW1lLCBldmFsX2ZsYWdzKTsKICB9CiAgaWYoSlNfSXNFeGNlcHRpb24odmFsKSkgewogICAganNfc3RkX2R1bXBfZXJyb3IoY3R4KTsKICAgIHJldCA9IC0xOwogIH0gZWxzZSB7CiAgICByZXQgPSAwOwogIH0KICBKU19GcmVlVmFsdWUoY3R4LCB2YWwpOwogIHJldHVybiByZXQ7Cn0KCnN0YXRpYyBpbnQKanNtX2V2YWxfZmlsZShKU0NvbnRleHQqIGN0eCwgY29uc3QgY2hhciogZmlsZW5hbWUsIGludCBtb2R1bGUpIHsKICB1aW50OF90KiBidWY7CiAgc2l6ZV90IGJ1Zl9sZW47CiAgaW50IHJldCwgZXZhbF9mbGFnczsKCiAgaWYoIShidWYgPSBqc19sb2FkX2ZpbGUoY3R4LCAmYnVmX2xlbiwgZmlsZW5hbWUpKSkgewogICAgcGVycm9yKGZpbGVuYW1lKTsKICAgIGV4aXQoMSk7CiAgfQogIGlmKG1vZHVsZSA8IDApCiAgICBtb2R1bGUgPSAoaGFzX3N1ZmZpeChmaWxlbmFtZSwgIi5tanMiKSB8fCBKU19EZXRlY3RNb2R1bGUoKGNvbnN0IGNoYXIqKWJ1ZiwgYnVmX2xlbikpOwogIGV2YWxfZmxhZ3MgPSBtb2R1bGUgPyBKU19FVkFMX1RZUEVfTU9EVUxFIDogSlNfRVZBTF9UWVBFX0dMT0JBTDsKICByZXQgPSBqc21fZXZhbF9idWYoY3R4LCBidWYsIGJ1Zl9sZW4sIGZpbGVuYW1lLCBldmFsX2ZsYWdzKTsKICBqc19mcmVlKGN0eCwgYnVmKTsKICByZXR1cm4gcmV0Owp9CgplbnVtIHsKICBTQ1JJUFRfTElTVCwKICBTQ1JJUFRfRklMRSwKICBTQ1JJUFRfRklMRU5BTUUsCiAgU0NSSVBUX0RJUk5BTUUsCn07CgpzdGF0aWMgY2hhcioqCmpzbV9zdGFja19wdHIoaW50IGkpIHsKICBpbnQgc2l6ZTsKICBpZigoc2l6ZSA9IHZlY3Rvcl9zaXplKCZqc21fc3RhY2ssIHNpemVvZihjaGFyKikpKSA+IDApIHsKICAgIGlmKGkgPCAwKQogICAgICBpICs9IHNpemU7CiAgICByZXR1cm4gdmVjdG9yX2F0KCZqc21fc3RhY2ssIHNpemVvZihjaGFyKiksIGkpOwogIH0KICByZXR1cm4gMDsKfQoKc3RhdGljIGNoYXIqKgpqc21fc3RhY2tfZmluZChjb25zdCBjaGFyKiBtb2R1bGUpIHsKICBjaGFyKiogcHRyOwoKICBpZihqc21fc3RhY2suc2l6ZSA9PSAwKQogICAgcmV0dXJuIDA7CgogIHZlY3Rvcl9mb3JlYWNoX3QoJmpzbV9zdGFjaywgcHRyKSBpZighcGF0aF9jb21wYXJlMigqcHRyLCBtb2R1bGUpKSByZXR1cm4gcHRyOwogIHJldHVybiAwOwp9CgpzdGF0aWMgY2hhcioKanNtX3N0YWNrX2F0KGludCBpKSB7CiAgY2hhcioqIHB0cjsKICBpZigocHRyID0ganNtX3N0YWNrX3B0cihpKSkpCiAgICByZXR1cm4gKnB0cjsKICByZXR1cm4gMDsKfQoKc3RhdGljIGNoYXIqCmpzbV9zdGFja190b3AoKSB7CiAgcmV0dXJuIGpzbV9zdGFja19hdCgtMSk7Cn0KCnN0YXRpYyBzaXplX3QKanNtX3N0YWNrX2NvdW50KCkgewogIHJldHVybiB2ZWN0b3Jfc2l6ZSgmanNtX3N0YWNrLCBzaXplb2YoY2hhciopKTsKfQoKc3RhdGljIGNoYXIqCmpzbV9zdGFja19zdHJpbmcoKSB7CiAgc3RhdGljIER5bkJ1ZiBidWY7CiAgY2hhcioqIHB0cjsKICBpbnQgaSA9IGpzbV9zdGFja19jb3VudCgpOwogIGlmKGJ1Zi5idWYgPT0gMCkKICAgIGRidWZfaW5pdDIoJmJ1ZiwgMCwgdmVjdG9yX3JlYWxsb2MpOwogIGJ1Zi5zaXplID0gMDsKICB3aGlsZSgtLWkgPj0gMCkgZGJ1Zl9wcmludGYoJmJ1ZiwgIiVpOiAlc1xuIiwgaSwganNtX3N0YWNrX2F0KGkpKTsKICBkYnVmXzAoJmJ1Zik7CiAgcmV0dXJuIChjaGFyKilidWYuYnVmOwp9CgpzdGF0aWMgdm9pZApqc21fc3RhY2tfcHJpbnQoKSB7CiAgZnB1dHMoanNtX3N0YWNrX3N0cmluZygpLCBzdGRlcnIpOwogIGZmbHVzaChzdGRlcnIpOwp9CgpzdGF0aWMgY29uc3QgY2hhcioqCmpzbV9zdGFja192ZWN0b3IoKSB7CiAgcmV0dXJuIHZlY3Rvcl9iZWdpbigmanNtX3N0YWNrKTsKfQoKc3RhdGljIEpTVmFsdWUKanNtX3N0YWNrX2dldChKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsLCBpbnQgbWFnaWMpIHsKICBKU1ZhbHVlIHJldCA9IEpTX1VOREVGSU5FRDsKCiAgc3dpdGNoKG1hZ2ljKSB7CiAgICBjYXNlIFNDUklQVF9MSVNUOiB7CiAgICAgIGNoYXIqKiBwdHI7CiAgICAgIHNpemVfdCBpID0gMDsKICAgICAgcmV0ID0gSlNfTmV3QXJyYXkoY3R4KTsKICAgICAgdmVjdG9yX2ZvcmVhY2hfdCgmanNtX3N0YWNrLCBwdHIpIHsKICAgICAgICBKU1ZhbHVlIHN0ciA9IEpTX05ld1N0cmluZyhjdHgsICpwdHIpOwogICAgICAgIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgcmV0LCBpKyssIHN0cik7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICB9CiAgICBjYXNlIFNDUklQVF9GSUxFOgogICAgY2FzZSBTQ1JJUFRfRklMRU5BTUU6IHsKICAgICAgY2hhciogZmlsZTsKICAgICAgaWYoKGZpbGUgPSBqc21fc3RhY2tfdG9wKCkpKSB7CiAgICAgICAgY2hhciogYWJzID0gcGF0aF9hYnNvbHV0ZTEoZmlsZSk7CiAgICAgICAgcmV0ID0gSlNfTmV3U3RyaW5nKGN0eCwgYWJzKTsKICAgICAgICBmcmVlKGFicyk7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICB9CiAgICBjYXNlIFNDUklQVF9ESVJOQU1FOiB7CiAgICAgIGNoYXIqIGZpbGU7CiAgICAgIGlmKChmaWxlID0ganNtX3N0YWNrX3RvcCgpKSkgewogICAgICAgIGNoYXIqIGFicyA9IHBhdGhfYWJzb2x1dGUxKGZpbGUpOwogICAgICAgIGNoYXIqIGRpcjsKICAgICAgICBpZigoZGlyID0gcGF0aF9kaXJuYW1lMShhYnMpKSkgewogICAgICAgICAgcmV0ID0gSlNfTmV3U3RyaW5nKGN0eCwgZGlyKTsKICAgICAgICAgIGZyZWUoZGlyKTsKICAgICAgICB9CiAgICAgICAgZnJlZShhYnMpOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgfQogIH0KICByZXR1cm4gcmV0Owp9CgpzdGF0aWMgdm9pZApqc21fc3RhY2tfcHVzaChKU0NvbnRleHQqIGN0eCwgY29uc3QgY2hhciogZmlsZSkgewogIHZlY3Rvcl9wdXRwdHIoJmpzbV9zdGFjaywganNfc3RyZHVwKGN0eCwgZmlsZSkpOwp9CgpzdGF0aWMgdm9pZApqc21fc3RhY2tfcG9wKEpTQ29udGV4dCogY3R4KSB7CiAgY2hhcioqIHB0cjsKCiAgcHRyID0gdmVjdG9yX2JhY2soJmpzbV9zdGFjaywgc2l6ZW9mKGNoYXIqKSk7CiAganNfZnJlZShjdHgsICpwdHIpOwogIHZlY3Rvcl9wb3AoJmpzbV9zdGFjaywgc2l6ZW9mKGNoYXIqKSk7Cn0KCnN0YXRpYyBpbnQKanNtX3N0YWNrX2xvYWQoSlNDb250ZXh0KiBjdHgsIGNvbnN0IGNoYXIqIGZpbGUsIEJPT0wgbW9kdWxlKSB7CiAgSlNWYWx1ZSB2YWw7CiAgaW50MzJfdCByZXQ7CiAgSlNWYWx1ZSBnbG9iYWxfb2JqID0gSlNfR2V0R2xvYmFsT2JqZWN0KGN0eCk7CgogIEpTX1NldFByb3BlcnR5U3RyKGN0eCwgZ2xvYmFsX29iaiwgIm1vZHVsZSIsIEpTX05ld09iamVjdChjdHgpKTsKICBqc21fc3RhY2tfcHVzaChjdHgsIGZpbGUpOwoKICBlcnJubyA9IDA7CgogIHZhbCA9IGpzX2V2YWxfZmlsZShjdHgsIGZpbGUsIG1vZHVsZSk7CiAganNtX3N0YWNrX3BvcChjdHgpOwogIGlmKEpTX0lzRXhjZXB0aW9uKHZhbCkpIHsKICAgIEpTVmFsdWUgc3RhY2sgPSBKU19HZXRQcm9wZXJ0eVN0cihjdHgsIGN0eC0+cnQtPmN1cnJlbnRfZXhjZXB0aW9uLCAic3RhY2siKTsKICAgIGNvbnN0IGNoYXIqIG1zZyA9IEpTX1RvQ1N0cmluZyhjdHgsICAgY3R4LT5ydC0+Y3VycmVudF9leGNlcHRpb24pOwogICAgZnByaW50ZihzdGRlcnIsICJFcnJvciBldmFsdWF0aW5nICclcyc6ICVzICglcylcbiIsIGZpbGUsIG1zZywganNfdmFsdWVfdHlwZXN0cihjdHgsIHN0YWNrKSk7CiAgICAKICAgIAogICAgaWYobXNnKQogICAgICBKU19GcmVlQ1N0cmluZyhjdHgsIG1zZyk7CgogICAganNfZXJyb3JfcHJpbnQoY3R4LCBjdHgtPnJ0LT5jdXJyZW50X2V4Y2VwdGlvbik7CiAgICBqc192YWx1ZV9md3JpdGUoY3R4LCBjdHgtPnJ0LT5jdXJyZW50X2V4Y2VwdGlvbiwgc3RkZXJyKTsKICAgIGpzX3N0ZF9kdW1wX2Vycm9yKGN0eCk7CiAgICByZXR1cm4gLTE7CiAgfSBlbHNlIGlmKEpTX0lzTW9kdWxlKHZhbCkgfHwgbW9kdWxlKSB7CiAgICBpZighSlNfSXNNb2R1bGUodmFsKSkgewogICAgICBKU01vZHVsZURlZiogbSA9IGpzX21vZHVsZV9hdChjdHgsIC0xKTsKICAgICAgdmFsID0gSlNfTUtQVFIoSlNfVEFHX01PRFVMRSwgbSk7CiAgICB9CiAgICBtb2R1bGVfZXhwb3J0c19nZXQoY3R4LCBKU19WQUxVRV9HRVRfUFRSKHZhbCksIFRSVUUsIGdsb2JhbF9vYmopOwogIH0gZWxzZSB7CiAgICBKU19Ub0ludDMyKGN0eCwgJnJldCwgdmFsKTsKICB9CgogIC8qICBmcHJpbnRmKHN0ZGVyciwgIkluY2x1ZGVkICclcyc6ICIsIGZpbGUpOwogICAganNfdmFsdWVfZndyaXRlKGN0eCwgdmFsLCBzdGRlcnIpOwogICAgZnB1dGMoJ1xuJywgc3RkZXJyKTsqLwogIGlmKCFKU19Jc01vZHVsZSh2YWwpKQogICAgSlNfRnJlZVZhbHVlKGN0eCwgdmFsKTsKCiAgSlNfRnJlZVZhbHVlKGN0eCwgZ2xvYmFsX29iaik7CiAgcmV0dXJuIDA7Cn0KCkpTTW9kdWxlRGVmKiBqc19pbml0X21vZHVsZV9kZWVwKEpTQ29udGV4dCosIGNvbnN0IGNoYXIqKTsKSlNNb2R1bGVEZWYqIGpzX2luaXRfbW9kdWxlX2luc3BlY3QoSlNDb250ZXh0KiwgY29uc3QgY2hhciopOwpKU01vZHVsZURlZioganNfaW5pdF9tb2R1bGVfbGV4ZXIoSlNDb250ZXh0KiwgY29uc3QgY2hhciopOwpKU01vZHVsZURlZioganNfaW5pdF9tb2R1bGVfbWlzYyhKU0NvbnRleHQqLCBjb25zdCBjaGFyKik7CkpTTW9kdWxlRGVmKiBqc19pbml0X21vZHVsZV9wYXRoKEpTQ29udGV4dCosIGNvbnN0IGNoYXIqKTsKSlNNb2R1bGVEZWYqIGpzX2luaXRfbW9kdWxlX3BvaW50ZXIoSlNDb250ZXh0KiwgY29uc3QgY2hhciopOwpKU01vZHVsZURlZioganNfaW5pdF9tb2R1bGVfcHJlZGljYXRlKEpTQ29udGV4dCosIGNvbnN0IGNoYXIqKTsKSlNNb2R1bGVEZWYqIGpzX2luaXRfbW9kdWxlX3JlcGVhdGVyKEpTQ29udGV4dCosIGNvbnN0IGNoYXIqKTsKSlNNb2R1bGVEZWYqIGpzX2luaXRfbW9kdWxlX3RyZWVfd2Fsa2VyKEpTQ29udGV4dCosIGNvbnN0IGNoYXIqKTsKSlNNb2R1bGVEZWYqIGpzX2luaXRfbW9kdWxlX3htbChKU0NvbnRleHQqLCBjb25zdCBjaGFyKik7Cgp2b2lkCmpzbV9pbml0X21vZHVsZXMoSlNDb250ZXh0KiBjdHgpIHsKCiAgaWYoanNtX21vZHVsZXNfaW5pdGlhbGl6ZWQpCiAgICByZXR1cm47CgogIGpzbV9tb2R1bGVzX2luaXRpYWxpemVkID0gVFJVRTsKCiAgZGJ1Zl9pbml0MigmanNtX2J1aWx0aW5fbW9kdWxlcy5kYnVmLCAwLCAmdmVjdG9yX3JlYWxsb2MpOwoKI2RlZmluZSBqc21fYnVpbHRpbl9uYXRpdmUobmFtZSkgdmVjdG9yX3B1c2goJmpzbV9idWlsdGluX21vZHVsZXMsIGpzbV9tb2R1bGVfcmVjb3JkX25hdGl2ZShuYW1lKSk7CgogIGpzbV9idWlsdGluX25hdGl2ZShzdGQpOwogIGpzbV9idWlsdGluX25hdGl2ZShvcyk7CiAganNtX2J1aWx0aW5fbmF0aXZlKGNoaWxkX3Byb2Nlc3MpOwogIGpzbV9idWlsdGluX25hdGl2ZShkZWVwKTsKICBqc21fYnVpbHRpbl9uYXRpdmUoaW5zcGVjdCk7CiAganNtX2J1aWx0aW5fbmF0aXZlKGxleGVyKTsKICBqc21fYnVpbHRpbl9uYXRpdmUobWlzYyk7CiAgLy8ganNtX2J1aWx0aW5fbmF0aXZlKG1tYXApOwogIGpzbV9idWlsdGluX25hdGl2ZShwYXRoKTsKICBqc21fYnVpbHRpbl9uYXRpdmUocG9pbnRlcik7CiAganNtX2J1aWx0aW5fbmF0aXZlKHByZWRpY2F0ZSk7CiAganNtX2J1aWx0aW5fbmF0aXZlKHJlcGVhdGVyKTsKICBqc21fYnVpbHRpbl9uYXRpdmUodHJlZV93YWxrZXIpOwogIGpzbV9idWlsdGluX25hdGl2ZSh4bWwpOwoKICAvLyBwcmludGYoIm5hdGl2ZSBidWlsdGluczogIik7IGR1bXBfdmVjdG9yKCZidWlsdGlucywgMCk7CgojZGVmaW5lIGpzbV9idWlsdGluX2NvbXBpbGVkKG5hbWUpIHZlY3Rvcl9wdXNoKCZqc21fYnVpbHRpbl9tb2R1bGVzLCBqc21fbW9kdWxlX3JlY29yZF9jb21waWxlZChuYW1lKSk7CgogIGpzbV9idWlsdGluX2NvbXBpbGVkKGNvbnNvbGUpOwogIGpzbV9idWlsdGluX2NvbXBpbGVkKGV2ZW50cyk7CiAganNtX2J1aWx0aW5fY29tcGlsZWQoZnMpOwogIGpzbV9idWlsdGluX2NvbXBpbGVkKHBlcmZfaG9va3MpOwogIGpzbV9idWlsdGluX2NvbXBpbGVkKHByb2Nlc3MpOwogIGpzbV9idWlsdGluX2NvbXBpbGVkKHJlcGwpOwogIGpzbV9idWlsdGluX2NvbXBpbGVkKHJlcXVpcmUpOwogIGpzbV9idWlsdGluX2NvbXBpbGVkKHR0eSk7CiAganNtX2J1aWx0aW5fY29tcGlsZWQodXRpbCk7Cn0KCnN0YXRpYyBCdWlsdGluTW9kdWxlKgpqc21fYnVpbHRpbl9maW5kKGNvbnN0IGNoYXIqIG5hbWUpIHsKICBCdWlsdGluTW9kdWxlKiByZWM7CiAgdmVjdG9yX2ZvcmVhY2hfdCgmanNtX2J1aWx0aW5fbW9kdWxlcywgcmVjKSB7CiAgICBpZighc3RyY21wKHJlYy0+bW9kdWxlX25hbWUsIG5hbWUpKQogICAgICByZXR1cm4gcmVjOwogIH0KICByZXR1cm4gMDsKfQoKc3RhdGljIEpTTW9kdWxlRGVmKgpqc21fYnVpbHRpbl9pbml0KEpTQ29udGV4dCogY3R4LCBCdWlsdGluTW9kdWxlKiByZWMpIHsKICBKU01vZHVsZURlZiogbTsKICBKU1ZhbHVlIHJldCA9IEpTX1VOSU5JVElBTElaRUQsIG9iaiA9IEpTX1VOREVGSU5FRDsKCiAganNtX3N0YWNrX3B1c2goY3R4LCByZWMtPm1vZHVsZV9uYW1lKTsKCiAgaWYocmVjLT5kZWYgPT0gMCkgewogICAgaWYoZGVidWdfbW9kdWxlX2xvYWRlciA+PSAyKQogICAgICBwcmludGYoIigzKSAlLTMwcyBpbnRlcm5hbFxuIiwgcmVjLT5tb2R1bGVfbmFtZSk7CiAgICBpZihyZWMtPm1vZHVsZV9mdW5jKSB7CiAgICAgIG0gPSByZWMtPm1vZHVsZV9mdW5jKGN0eCwgcmVjLT5tb2R1bGVfbmFtZSk7CiAgICAgIG9iaiA9IGpzX3ZhbHVlX21rcHRyKEpTX1RBR19NT0RVTEUsIG0pOwogICAgICBpZighcmVjLT5pbml0aWFsaXplZCAmJiAhSlNfSXNVbmRlZmluZWQob2JqKSkgewogICAgICAgIEpTVmFsdWUgZnVuY19vYmogPSBKU19EdXBWYWx1ZShjdHgsIG9iaik7CiAgICAgICAgSlNfRXZhbEZ1bmN0aW9uKGN0eCwgZnVuY19vYmopOwogICAgICAgIHJlYy0+aW5pdGlhbGl6ZWQgPSBUUlVFOwogICAgICB9CgogICAgfSBlbHNlIHsKICAgICAgb2JqID0gSlNfUmVhZE9iamVjdChjdHgsIHJlYy0+Ynl0ZV9jb2RlLCByZWMtPmJ5dGVfY29kZV9sZW4sIEpTX1JFQURfT0JKX0JZVEVDT0RFKTsKCiAgICAgIG0gPSBqc192YWx1ZV9wdHIob2JqKTsKCiAgICAgIEpTX1Jlc29sdmVNb2R1bGUoY3R4LCBvYmopOwogICAgICByZXQgPSBKU19FdmFsRnVuY3Rpb24oY3R4LCBvYmopOwoKICAgICAgLyogIG9iaiA9IGpzX2V2YWxfYmluYXJ5KGN0eCwgcmVjLT5ieXRlX2NvZGUsIHJlYy0+Ynl0ZV9jb2RlX2xlbiwgRkFMU0UpOwogICAgICAgICAgICBtID0ganNfdmFsdWVfcHRyKG9iaik7CiAgICAgICAgICAgIHJlYy0+aW5pdGlhbGl6ZWQgPSBUUlVFOyovCiAgICB9CiAgICByZWMtPmRlZiA9IG07CiAgfQogIGpzbV9zdGFja19wb3AoY3R4KTsKCiAgcmV0dXJuIHJlYy0+ZGVmOwp9CgpzdGF0aWMgSlNWYWx1ZQpqc21fbG9hZF9qc29uKEpTQ29udGV4dCogY3R4LCBjb25zdCBjaGFyKiBmaWxlKSB7CiAgdWludDhfdCogYnVmOwogIHNpemVfdCBsZW47CiAgaWYoIShidWYgPSBqc19sb2FkX2ZpbGUoY3R4LCAmbGVuLCBmaWxlKSkpCiAgICByZXR1cm4gSlNfVGhyb3dJbnRlcm5hbEVycm9yKGN0eCwgIkxvYWRpbmcgJyVzJyBmYWlsZWQiLCBmaWxlKTsKICByZXR1cm4gSlNfUGFyc2VKU09OKGN0eCwgYnVmLCBsZW4sIGZpbGUpOwp9CgpzdGF0aWMgSlNWYWx1ZQpqc21fbG9hZF9wYWNrYWdlKEpTQ29udGV4dCogY3R4LCBjb25zdCBjaGFyKiBmaWxlKSB7CiAgaWYoSlNfSXNVbmRlZmluZWQocGFja2FnZV9qc29uKSB8fCBKU19WQUxVRV9HRVRfVEFHKHBhY2thZ2VfanNvbikgPT0gMCkgewogICAgcGFja2FnZV9qc29uID0ganNtX2xvYWRfanNvbihjdHgsIGZpbGUgPyBmaWxlIDogInBhY2thZ2UuanNvbiIpOwoKICAgIGlmKEpTX0lzRXhjZXB0aW9uKHBhY2thZ2VfanNvbikpIHsKICAgICAgSlNfR2V0RXhjZXB0aW9uKGN0eCk7CiAgICAgIHBhY2thZ2VfanNvbiA9IEpTX05VTEw7CiAgICB9CiAgfQogIHJldHVybiBwYWNrYWdlX2pzb247Cn0KCnN0YXRpYyBjaGFyKgpqc21fc2VhcmNoX2xpc3QoSlNDb250ZXh0KiBjdHgsIGNvbnN0IGNoYXIqIG1vZHVsZV9uYW1lLCBjb25zdCBjaGFyKiBsaXN0KSB7CiAgY29uc3QgY2hhciogczsKICBjaGFyKiB0ID0gMDsKICBzaXplX3QgaSwgaiA9IHN0cmxlbihtb2R1bGVfbmFtZSk7CgogIGlmKGRlYnVnX21vZHVsZV9sb2FkZXIgPj0gMikKICAgIHByaW50ZigiJS0xOHMobW9kdWxlX25hbWU9XCIlc1wiIGxpc3QgPVwiJXNcIilcbiIsIF9fRlVOQ1RJT05fXywgbW9kdWxlX25hbWUsIGxpc3QpOwoKICBpZighKHQgPSBqc19tYWxsb2MoY3R4LCBzdHJsZW4obGlzdCkgKyAxICsgc3RybGVuKG1vZHVsZV9uYW1lKSArIDEpKSkKICAgIHJldHVybiAwOwoKICBmb3IocyA9IGxpc3Q7ICpzOyBzICs9IGkpIHsKICAgIGlmKChpID0gc3RyX2NocnMocywgIjs6XG4iLCAzKSkgPT0gMCkKICAgICAgYnJlYWs7CiAgICBzdHJuY3B5KHQsIHMsIGkpOwogICAgdFtpXSA9ICcvJzsKICAgIHN0cmNweSgmdFtpICsgMV0sIG1vZHVsZV9uYW1lKTsKICAgIGlmKHBhdGhfaXNmaWxlMSh0KSkKICAgICAgcmV0dXJuIHQ7CiAgICBpZihzW2ldKQogICAgICArK2k7CiAgfQogIHJldHVybiAwOwp9CgpzdGF0aWMgY2hhcioKanNtX3NlYXJjaF9wYXRoKEpTQ29udGV4dCogY3R4LCBjb25zdCBjaGFyKiBtb2R1bGVfbmFtZSkgewogIGNvbnN0IGNoYXIqIGxpc3Q7CgogIGlmKGRlYnVnX21vZHVsZV9sb2FkZXIgPj0gMikKICAgIHByaW50ZigiJS0xOHMobW9kdWxlX25hbWU9XCIlc1wiKVxuIiwgX19GVU5DVElPTl9fLCBtb2R1bGVfbmFtZSk7CgogIGFzc2VydChpc19zZWFyY2hhYmxlKG1vZHVsZV9uYW1lKSk7CgogIGlmKCEobGlzdCA9IGdldGVudigiUVVJQ0tKU19NT0RVTEVfUEFUSCIpKSkKICAgIGxpc3QgPSBqc21fZGVmYXVsdF9tb2R1bGVfcGF0aDsKCiAgcmV0dXJuIGpzbV9zZWFyY2hfbGlzdChjdHgsIG1vZHVsZV9uYW1lLCBsaXN0KTsKfQoKc3RhdGljIGNoYXIqCmpzbV9zZWFyY2hfc3VmZml4KEpTQ29udGV4dCogY3R4LCBjb25zdCBjaGFyKiBtb2R1bGVfbmFtZSwgTW9kdWxlTG9hZGVyKiBmbikgewogIHNpemVfdCBpLCBuLCBsZW4gPSBzdHJsZW4obW9kdWxlX25hbWUpOwogIGNoYXIgKnMsICp0ID0gMDsKCiAgaWYoZGVidWdfbW9kdWxlX2xvYWRlciA+PSAyKQogICAgcHJpbnRmKCIlLTE4cyhtb2R1bGVfbmFtZT1cIiVzXCIsIGZuPSVzKVxuIiwKICAgICAgICAgICBfX0ZVTkNUSU9OX18sCiAgICAgICAgICAgbW9kdWxlX25hbWUsCiAgICAgICAgICAgZm4gPT0gJmlzX21vZHVsZSAgICAgICAgID8gImlzX21vZHVsZSIKICAgICAgICAgICA6IGZuID09ICZqc21fc2VhcmNoX3BhdGggPyAianNtX3NlYXJjaF9wYXRoIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6ICI8dW5rbm93bj4iKTsKCiAgaWYoIShzID0ganNfbWFsbG9jeihjdHgsIChsZW4gKyAzMSkgJiAofjB4ZikpKSkKICAgIHJldHVybiAwOwoKICBzdHJjcHkocywgbW9kdWxlX25hbWUpOwogIG4gPSBjb3VudG9mKG1vZHVsZV9leHRlbnNpb25zKTsKICBmb3IoaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgIHNbbGVuXSA9ICdcMCc7CiAgICBpZihoYXNfc3VmZml4KHMsIG1vZHVsZV9leHRlbnNpb25zW2ldKSkKICAgICAgY29udGludWU7CiAgICBzdHJjYXQocywgbW9kdWxlX2V4dGVuc2lvbnNbaV0pOwoKICAgIGlmKCh0ID0gZm4oY3R4LCBzKSkpCiAgICAgIGJyZWFrOwogIH0KICBqc19mcmVlKGN0eCwgcyk7CiAgcmV0dXJuIHQ7Cn0KCnN0YXRpYyBjaGFyKgpqc21fc2VhcmNoX21vZHVsZShKU0NvbnRleHQqIGN0eCwgY29uc3QgY2hhciogbW9kdWxlX25hbWUpIHsKICBjaGFyKiBzID0gMDsKICBCT09MIHNlYXJjaCA9IGlzX3NlYXJjaGFibGUobW9kdWxlX25hbWUpOwogIEJPT0wgc3VmZml4ID0gbW9kdWxlX2hhc19zdWZmaXgoY3R4LCBtb2R1bGVfbmFtZSk7CiAgTW9kdWxlTG9hZGVyKiBmbiA9IHNlYXJjaCA/ICZqc21fc2VhcmNoX3BhdGggOiAmaXNfbW9kdWxlOwoKICBzID0gc3VmZml4ID8gZm4oY3R4LCBtb2R1bGVfbmFtZSkgOiBqc21fc2VhcmNoX3N1ZmZpeChjdHgsIG1vZHVsZV9uYW1lLCBmbik7CgogIGlmKGRlYnVnX21vZHVsZV9sb2FkZXIgPj0gMikKICAgIHByaW50ZigiJS0xOHMobW9kdWxlX25hbWU9XCIlc1wiKSBzZWFyY2g9JXMgc3VmZml4PSVzIGZuPSVzIHJlc3VsdD0lc1xuIiwKICAgICAgICAgICBfX0ZVTkNUSU9OX18sCiAgICAgICAgICAgbW9kdWxlX25hbWUsCiAgICAgICAgICAgKChzZWFyY2gpID8gIlRSVUUiIDogIkZBTFNFIiksCiAgICAgICAgICAgKChzdWZmaXgpID8gIlRSVUUiIDogIkZBTFNFIiksCiAgICAgICAgICAgc2VhcmNoID8gInNlYXJjaF9tb2R1bGUiIDogImlzX21vZHVsZSIsCiAgICAgICAgICAgcyk7CgogIHJldHVybiBzOwp9CgovKiBlbmQgb2YgIm5ldyBicmVlZCIgbW9kdWxlIGxvYWRlciBmdW5jdGlvbnMgKi8KCmNoYXIqCmpzbV9tb2R1bGVfcGFja2FnZShKU0NvbnRleHQqIGN0eCwgY29uc3QgY2hhciogbW9kdWxlKSB7CiAgSlNWYWx1ZSBwYWNrYWdlOwogIGNoYXIqIGZpbGUgPSAwOwoKICBpZighaGFzX3N1ZmZpeChtb2R1bGUsIENPTkZJR19TSEVYVCkpIHsKICAgIHBhY2thZ2UgPSBqc21fbG9hZF9wYWNrYWdlKGN0eCwgInBhY2thZ2UuanNvbiIpOwoKICAgIGlmKEpTX0lzT2JqZWN0KHBhY2thZ2UpKSB7CiAgICAgIEpTVmFsdWUgYWxpYXNlcywgdGFyZ2V0ID0gSlNfVU5ERUZJTkVEOwoKICAgICAgYWxpYXNlcyA9IEpTX0dldFByb3BlcnR5U3RyKGN0eCwgcGFja2FnZSwgIl9tb2R1bGVBbGlhc2VzIik7CiAgICAgIGlmKCFKU19Jc0V4Y2VwdGlvbihhbGlhc2VzKSAmJiBKU19Jc09iamVjdChhbGlhc2VzKSkgewogICAgICAgIHRhcmdldCA9IEpTX0dldFByb3BlcnR5U3RyKGN0eCwgYWxpYXNlcywgcGF0aF90cmltZG90c2xhc2gxKG1vZHVsZSkpOwoKICAgICAgICBpZighSlNfSXNVbmRlZmluZWQodGFyZ2V0KSkgewogICAgICAgICAgZmlsZSA9IGpzX3Rvc3RyaW5nKGN0eCwgdGFyZ2V0KTsKCiAgICAgICAgICBpZihkZWJ1Z19tb2R1bGVfbG9hZGVyID49IDEpCiAgICAgICAgICAgIHByaW50ZigiKDIpICUtMzBzID0+ICVzIChwYWNrYWdlLmpzb24pXG4iLCBtb2R1bGUsIGZpbGUpOwogICAgICAgIH0KICAgICAgfQogICAgICBKU19GcmVlVmFsdWUoY3R4LCBhbGlhc2VzKTsKICAgICAgSlNfRnJlZVZhbHVlKGN0eCwgdGFyZ2V0KTsKICAgIH0KICB9CgogIHJldHVybiBmaWxlOwp9CgpKU01vZHVsZURlZioKanNtX21vZHVsZV9sb2FkKEpTQ29udGV4dCogY3R4LCBjb25zdCBjaGFyKiBuYW1lKSB7CgogIEJPT0wgYWxsID0gRkFMU0U7CgogIGlmKCpuYW1lID09ICcqJykgewogICAgKytuYW1lOwogICAgYWxsID0gVFJVRTsKICB9CgogIGlmKCFqc19ldmFsX2ZtdChjdHgsCiAgICAgICAgICAgICAgICAgIEpTX0VWQUxfVFlQRV9NT0RVTEUsCiAgICAgICAgICAgICAgICAgIGFsbCA/ICJpbXBvcnQgdG1wIGZyb20gJyVzJztcbk9iamVjdC5hc3NpZ24oZ2xvYmFsVGhpcywgdG1wKTtcbiIgOiAiaW1wb3J0IHRtcCBmcm9tICclcyc7XG5nbG9iYWxUaGlzWyclcyddID0gdG1wO1xuIiwKICAgICAgICAgICAgICAgICAgbmFtZSwKICAgICAgICAgICAgICAgICAgbmFtZSkpIHsKCiAgfSBlbHNlIHsKICAgIEpTX0dldEV4Y2VwdGlvbihjdHgpOwoKICAgIGlmKGpzX2V2YWxfZm10KGN0eCwKICAgICAgICAgICAgICAgICAgIEpTX0VWQUxfVFlQRV9NT0RVTEUsCiAgICAgICAgICAgICAgICAgICBhbGwgPyAiaW1wb3J0ICogYXMgdG1wIGZyb20gJyVzJztcbk9iamVjdC5hc3NpZ24oZ2xvYmFsVGhpcywgdG1wKTtcbiIgOiAiaW1wb3J0ICogYXMgdG1wIGZyb20gJyVzJztcbmdsb2JhbFRoaXNbJyVzJ10gPSB0bXA7XG4iLAogICAgICAgICAgICAgICAgICAgbmFtZSwKICAgICAgICAgICAgICAgICAgIG5hbWUpKQogICAgICByZXR1cm4gMDsKICB9CgogIHJldHVybiBqc19tb2R1bGVfZmluZF9yZXYoY3R4LCBuYW1lKTsKfQoKSlNNb2R1bGVEZWYqCmpzbV9tb2R1bGVfanNvbihKU0NvbnRleHQqIGN0eCwgY29uc3QgY2hhciogbmFtZSkgewogIER5bkJ1ZiBkYjsKICBKU01vZHVsZURlZiogbSA9IDA7CiAgdWludDhfdCogcHRyOwogIHNpemVfdCBsZW47CiAgaWYoIShwdHIgPSBqc19sb2FkX2ZpbGUoY3R4LCAmbGVuLCBuYW1lKSkpCiAgICByZXR1cm4gMDsKICBqc19kYnVmX2luaXQoY3R4LCAmZGIpOwogIGRidWZfcHV0c3RyKCZkYiwgImV4cG9ydCBkZWZhdWx0ICIpOwogIHdoaWxlKGxlbiA+IDAgJiYgaXNfd2hpdGVzcGFjZV9jaGFyKHB0clswXSkpIHsKICAgICsrcHRyOwogICAgLS1sZW47CiAgfQogIGRidWZfcHV0KCZkYiwgcHRyLCBsZW4pOwogIGpzX2ZyZWUoY3R4LCBwdHIpOwogIGRidWZfMCgmZGIpOwogIHsKICAgIEpTVmFsdWUgcmV0OwogICAgcmV0ID0gSlNfRXZhbChjdHgsIGRiLmJ1ZiwgZGIuc2l6ZSwgbmFtZSwgSlNfRVZBTF9UWVBFX01PRFVMRSB8IEpTX0VWQUxfRkxBR19DT01QSUxFX09OTFkpOwogICAgaWYoSlNfVkFMVUVfR0VUX1RBRyhyZXQpID09IEpTX1RBR19NT0RVTEUpCiAgICAgIG0gPSBKU19WQUxVRV9HRVRfUFRSKHJldCk7CiAgICBKU19GcmVlVmFsdWUoY3R4LCByZXQpOwogIH0KICBkYnVmX2ZyZWUoJmRiKTsKICByZXR1cm4gbTsKfQoKY2hhcioKanNtX21vZHVsZV9sb2NhdGUoSlNDb250ZXh0KiBjdHgsIGNvbnN0IGNoYXIqIG1vZHVsZV9uYW1lLCB2b2lkKiBvcGFxdWUpIHsKICBjaGFyICpmaWxlID0gMCwgKnMgPSAwOwogIEpTTW9kdWxlRGVmKiBtID0gMDsKCiAgcyA9IGpzX3N0cmR1cChjdHgsIG1vZHVsZV9uYW1lKTsKCiAgZm9yKDs7KSB7CiAgICBpZihkZWJ1Z19tb2R1bGVfbG9hZGVyIC0gIXN0cmNtcChtb2R1bGVfbmFtZSwgcykgPj0gMykKICAgICAgcHJpbnRmKCIlLTE4c1sxXShtb2R1bGVfbmFtZT1cIiVzXCIsIG9wYXF1ZT0lcCkgcz0lc1xuIiwgX19GVU5DVElPTl9fLCBtb2R1bGVfbmFtZSwgb3BhcXVlLCBzKTsKCiAgICBpZihwYXRoX2lzZmlsZTEocykpCiAgICAgIGJyZWFrOwoKICAgIGlmKGlzX3NlYXJjaGFibGUocykpIHsKICAgICAgc2l6ZV90IGxlbjsKICAgICAgaWYoKGZpbGUgPSBqc21fc2VhcmNoX21vZHVsZShjdHgsIHMpKSkgewogICAgICAgIGpzX2ZyZWUoY3R4LCBzKTsKICAgICAgICBzID0ganNfc3RyZHVwKGN0eCwgZmlsZSk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgaWYocGF0aF9jb21wb25lbnQxKHMpID09IDMgJiYgIXN0cm5jbXAocywgImxpYiIsIDMpKSB7CiAgICAgICAgc3RyY3B5KHMsICZzWzMgKyBwYXRoX3NlcGFyYXRvcjEoJnNbM10pXSk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGlmKChmaWxlID0ganNtX3NlYXJjaF9zdWZmaXgoY3R4LCBzLCBpc19tb2R1bGUpKSkgewogICAgICAgIGpzX2ZyZWUoY3R4LCBzKTsKICAgICAgICBzID0ganNfc3RyZHVwKGN0eCwgZmlsZSk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KICAgIGJyZWFrOwogIH0KCiAgcmV0dXJuIHM7Cn0KCkpTTW9kdWxlRGVmKgpqc21fbW9kdWxlX2xvYWRlcihKU0NvbnRleHQqIGN0eCwgY29uc3QgY2hhciogbW9kdWxlX25hbWUsIHZvaWQqIG9wYXF1ZSkgewogIGNvbnN0IGNoYXIqIG5hbWUgPSBtb2R1bGVfbmFtZTsKICBjaGFyKiBzID0gMDsKICBKU01vZHVsZURlZiogbSA9IDA7CgpyZXN0YXJ0OgogIGlmKGpzbV9zdGFja19maW5kKG1vZHVsZV9uYW1lKSAhPSAwKSB7CiAgICBwcmludGYoIlx4MWJbMTszMW1XQVJOSU5HOiBjaXJjdWxhciBtb2R1bGUgZGVwZW5kZW5jeSAnJXMnIGZyb206XG4lc1x4MWJbMG1cbiIsIG1vZHVsZV9uYW1lLCBqc21fc3RhY2tfc3RyaW5nKCkpOwogICAgZXhpdCgxKTsKICB9CgogIGlmKCFtb2R1bGVfbmFtZVtzdHJfY2hycyhtb2R1bGVfbmFtZSwgUEFUSFNFUF9TICIvIiwgMildKSB7CiAgICBCdWlsdGluTW9kdWxlKiByZWM7CiAgICBpZigocmVjID0ganNtX2J1aWx0aW5fZmluZChtb2R1bGVfbmFtZSkpKSB7CiAgICAgIGlmKHMpCiAgICAgICAganNfZnJlZShjdHgsIHMpOwogICAgICByZXR1cm4ganNtX2J1aWx0aW5faW5pdChjdHgsIHJlYyk7CiAgICB9CiAgfQoKICBpZihzID09IDApIHsKICAgIGlmKHBhdGhfaXNhYnNvbHV0ZTEobW9kdWxlX25hbWUpKSB7CiAgICAgIHMgPSBqc19zdHJkdXAoY3R4LCBtb2R1bGVfbmFtZSk7CiAgICB9IGVsc2UgewogICAgICBzID0ganNtX21vZHVsZV9wYWNrYWdlKGN0eCwgbW9kdWxlX25hbWUpOwoKICAgICAgaWYocyAmJiBpc19zZWFyY2hhYmxlKHMpKSB7CiAgICAgICAgY2hhciogdG1wOwogICAgICAgIGlmKCh0bXAgPSBqc21fbW9kdWxlX2xvY2F0ZShjdHgsIHMsIG9wYXF1ZSkpKSB7CiAgICAgICAgICBqc19mcmVlKGN0eCwgcyk7CiAgICAgICAgICBzID0gdG1wOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYoIXMpCiAgICAgICAgcyA9IGpzbV9tb2R1bGVfbG9jYXRlKGN0eCwgbW9kdWxlX25hbWUsIG9wYXF1ZSk7CgogICAgICBpZihzKSB7CiAgICAgICAgbW9kdWxlX25hbWUgPSBzOwogICAgICAgIGdvdG8gcmVzdGFydDsKICAgICAgfQogICAgfQogIH0KCiAgaWYocykgewogICAgaWYoZGVidWdfbW9kdWxlX2xvYWRlciA+IDMpCiAgICAgIHByaW50ZigiXCIlc1wiIC0+IFwiJXNcIlxuIiwgbmFtZSwgcyk7CgogICAganNtX3N0YWNrX3B1c2goY3R4LCBzKTsKICAgIGlmKHN0cl9lbmRzKHMsICIuanNvbiIpKQogICAgICBtID0ganNtX21vZHVsZV9qc29uKGN0eCwgcyk7CiAgICBlbHNlCiAgICAgIG0gPSBqc19tb2R1bGVfbG9hZGVyKGN0eCwgcywgb3BhcXVlKTsKICAgIGpzX2ZyZWUoY3R4LCBzKTsKICAgIGpzbV9zdGFja19wb3AoY3R4KTsKCiAgfSBlbHNlIHsKICAgIGlmKGRlYnVnX21vZHVsZV9sb2FkZXIpCiAgICAgIHByaW50ZigiXCIlc1wiIC0+IG51bGxcbiIsIG1vZHVsZV9uYW1lKTsKICB9CiAgcmV0dXJuIG07Cn0KCmNoYXIqCmpzbV9tb2R1bGVfbm9ybWFsaXplKEpTQ29udGV4dCogY3R4LCBjb25zdCBjaGFyKiBwYXRoLCBjb25zdCBjaGFyKiBuYW1lLCB2b2lkKiBvcGFxdWUpIHsKICBjaGFyKiBmaWxlID0gMDsKICBCT09MIGhhc19kb3Rfb3Jfc2xhc2ggPSAhIW5hbWVbc3RyX2NocnMobmFtZSwgIi4iIFBBVEhTRVBfUywgMildOwoKICBpZihzdHJjbXAocGF0aCwgIjxpbnB1dD4iKSAmJiAocGF0aF9pc2RvdHNsYXNoKG5hbWUpIHx8IHBhdGhfaXNkb3Rkb3QobmFtZSkpICYmICFqc21fYnVpbHRpbl9maW5kKG5hbWUpICYmIGhhc19kb3Rfb3Jfc2xhc2gpIHsKICAgIER5bkJ1ZiBkaXI7CiAgICBzaXplX3QgZHNsOwogICAganNfZGJ1Zl9hbGxvY2F0b3IoY3R4LCAmZGlyKTsKCiAgICBpZihwYXRoX2lzaW1wbGljaXQocGF0aCkpCiAgICAgIGRidWZfcHV0c3RyKCZkaXIsICIuIiBQQVRIU0VQX1MpOwoKICAgIHBhdGhfY29uY2F0NShwYXRoLCBwYXRoX2RpcmxlbjEocGF0aCksIG5hbWUsIHN0cmxlbihuYW1lKSwgJmRpcik7CiAgICBkc2wgPSBwYXRoX3NraXBkb3RzbGFzaDIoZGlyLmJ1ZiwgZGlyLnNpemUpOwoKICAgIC8qIFhYWCBCVUc6IHNob3VsZCB1c2UgcGF0aF9ub3JtYWxpemUqIHRvIHJlc29sdmUgc3ltbGlua3MgKi8KICAgIHBhdGhfY29sbGFwc2UyKGRpci5idWYgKyBkc2wsIGRpci5zaXplIC0gZHNsKTsKICAgIGZpbGUgPSBkaXIuYnVmOwogIH0gZWxzZSBpZihoYXNfc3VmZml4KG5hbWUsIENPTkZJR19TSEVYVCkgJiYgIXBhdGhfaXNhYnNvbHV0ZTEobmFtZSkpIHsKICAgIER5bkJ1ZiBkYjsKICAgIGpzX2RidWZfaW5pdChjdHgsICZkYik7CgogICAgcGF0aF9jb25jYXQzKFFVSUNLSlNfQ19NT0RVTEVfRElSLCBuYW1lLCAmZGIpOwogICAgZmlsZSA9IChjaGFyKilkYi5idWY7CiAgfQoKICBpZihmaWxlID09IDApCiAgICBmaWxlID0ganNfc3RyZHVwKGN0eCwgbmFtZSk7CgogIGlmKGRlYnVnX21vZHVsZV9sb2FkZXIgLSAhc3RyY21wKG5hbWUsIGZpbGUpID49IDMpCiAgICBwcmludGYoIiVzOiBcIiVzXCIgPT4gXCIlc1wiXG4iLCBwYXRoLCBuYW1lLCBmaWxlKTsKICByZXR1cm4gZmlsZTsKfQoKLyogYWxzbyB1c2VkIHRvIGluaXRpYWxpemUgdGhlIHdvcmtlciBjb250ZXh0ICovCnN0YXRpYyBKU0NvbnRleHQqCmpzbV9jb250ZXh0X25ldyhKU1J1bnRpbWUqIHJ0KSB7CiAgSlNDb250ZXh0KiBjdHg7CgogIGN0eCA9IEpTX05ld0NvbnRleHQocnQpOwogIGlmKCFjdHgpCiAgICByZXR1cm4gMDsKI2lmZGVmIENPTkZJR19CSUdOVU0KICBpZihiaWdudW1fZXh0KSB7CiAgICBKU19BZGRJbnRyaW5zaWNCaWdGbG9hdChjdHgpOwogICAgSlNfQWRkSW50cmluc2ljQmlnRGVjaW1hbChjdHgpOwogICAgSlNfQWRkSW50cmluc2ljT3BlcmF0b3JzKGN0eCk7CiAgICBKU19FbmFibGVCaWdudW1FeHQoY3R4LCBUUlVFKTsKICB9CiNlbmRpZgoKICBqc21faW5pdF9tb2R1bGVzKGN0eCk7CgojZGVmaW5lIGpzbV9tb2R1bGVfbmF0aXZlKG5hbWUpIGpzX2luaXRfbW9kdWxlXyMjbmFtZShjdHgsICNuYW1lKTsKCiAgLyoganNtX21vZHVsZV9uYXRpdmUoc3RkKTsKICAganNtX21vZHVsZV9uYXRpdmUob3MpOwogI2lmbmRlZiBfX3dhc2lfXwogICAvL2pzbV9tb2R1bGVfbmF0aXZlKGNoaWxkX3Byb2Nlc3MpOwogI2VuZGlmCiAgIGpzbV9tb2R1bGVfbmF0aXZlKGRlZXApOwogICBqc21fbW9kdWxlX25hdGl2ZShpbnNwZWN0KTsKICAganNtX21vZHVsZV9uYXRpdmUobGV4ZXIpOwogICBqc21fbW9kdWxlX25hdGl2ZShtaXNjKTsKICNpZm5kZWYgX193YXNpX18KICAgLy9qc21fbW9kdWxlX25hdGl2ZShtbWFwKTsKICNlbmRpZgogICBqc21fbW9kdWxlX25hdGl2ZShwYXRoKTsKICAganNtX21vZHVsZV9uYXRpdmUocG9pbnRlcik7CiAgIGpzbV9tb2R1bGVfbmF0aXZlKHByZWRpY2F0ZSk7CiAgIGpzbV9tb2R1bGVfbmF0aXZlKHJlcGVhdGVyKTsKICAganNtX21vZHVsZV9uYXRpdmUodHJlZV93YWxrZXIpOwogICBqc21fbW9kdWxlX25hdGl2ZSh4bWwpOyovCgogIC8vIHByaW50ZigiU2V0IG1vZHVsZSBsb2FkZXIgKHJ0PSVwKTogJXBcbiIsIHJ0KTsKICBKU19TZXRNb2R1bGVMb2FkZXJGdW5jKHJ0LCBqc21fbW9kdWxlX25vcm1hbGl6ZSwganNtX21vZHVsZV9sb2FkZXIsIDApOwoKICByZXR1cm4gY3R4Owp9CgojaWYgZGVmaW5lZChfX0FQUExFX18pCiNkZWZpbmUgTUFMTE9DX09WRVJIRUFEIDAKI2Vsc2UKI2RlZmluZSBNQUxMT0NfT1ZFUkhFQUQgOAojZW5kaWYKCnN0cnVjdCB0cmFjZV9tYWxsb2NfZGF0YSB7CiAgdWludDhfdCogYmFzZTsKfTsKCnN0YXRpYyB2b2lkCmR1bXBfdmVjdG9yKGNvbnN0IFZlY3RvciogdmVjLCBzaXplX3Qgc3RhcnQpIHsKICBzaXplX3QgaSwgbGVuID0gdmVjdG9yX3NpemUodmVjLCBzaXplb2YoY2hhciopKTsKICBmb3IoaSA9IHN0YXJ0OyBpIDwgbGVuOyBpKyspIHsKICAgIGNvbnN0IGNoYXIqIHN0ciA9ICooY2hhcioqKXZlY3Rvcl9hdCh2ZWMsIHNpemVvZihjaGFyKiksIGkpOwogICAgZnB1dHMoaSA+IHN0YXJ0ID8gIicsXG4gICciIDogIltcbiAgJyIsIHN0ZG91dCk7CiAgICBmcHV0cyhzdHIsIHN0ZG91dCk7CiAgICBpZihpICsgMSA9PSBsZW4pCiAgICAgIHB1dHMoIidcbl0iKTsKICB9Cn0KCnN0YXRpYyBpbmxpbmUgdW5zaWduZWQgbG9uZyBsb25nCmpzbV90cmFjZV9tYWxsb2NfcHRyX29mZnNldCh1aW50OF90KiBwdHIsIHN0cnVjdCB0cmFjZV9tYWxsb2NfZGF0YSogZHApIHsKICByZXR1cm4gcHRyIC0gZHAtPmJhc2U7Cn0KCi8qIGRlZmF1bHQgbWVtb3J5IGFsbG9jYXRpb24gZnVuY3Rpb25zIHdpdGggbWVtb3J5IGxpbWl0YXRpb24gKi8Kc3RhdGljIGlubGluZSBzaXplX3QKanNtX3RyYWNlX21hbGxvY191c2FibGVfc2l6ZSh2b2lkKiBwdHIpIHsKI2lmIGRlZmluZWQoX19BUFBMRV9fKQogIHJldHVybiBtYWxsb2Nfc2l6ZShwdHIpOwojZWxpZiBkZWZpbmVkKF9XSU4zMikKICByZXR1cm4gX21zaXplKHB0cik7CiNlbGlmIGRlZmluZWQoRU1TQ1JJUFRFTikgfHwgZGVmaW5lZChfX2RpZXRsaWJjX18pIHx8IGRlZmluZWQoX19NU1lTX18pIHx8IGRlZmluZWQoQU5EUk9JRCkgfHwgZGVmaW5lZChET05UX0hBVkVfTUFMTE9DX1VTQUJMRV9TSVpFKQogIHJldHVybiAwOwojZWxpZiBkZWZpbmVkKF9fbGludXhfXykgfHwgZGVmaW5lZChIQVZFX01BTExPQ19VU0FCTEVfU0laRSkKICByZXR1cm4gbWFsbG9jX3VzYWJsZV9zaXplKHB0cik7CiNlbHNlCiN3YXJuaW5nIGNoYW5nZSB0aGlzIHRvIGByZXR1cm4gMDtgIGlmIGNvbXBpbGF0aW9uIGZhaWxzCiAgLyogY2hhbmdlIHRoaXMgdG8gYHJldHVybiAwO2AgaWYgY29tcGlsYXRpb24gZmFpbHMgKi8KICByZXR1cm4gbWFsbG9jX3VzYWJsZV9zaXplKHB0cik7CiNlbmRpZgp9CgpzdGF0aWMgdm9pZAojaWZkZWYgX1dJTjMyCiAgICAvKiBtaW5ndyBwcmludGYgaXMgdXNlZCAqLwogICAgX19hdHRyaWJ1dGVfXygoZm9ybWF0KGdudV9wcmludGYsIDIsIDMpKSkKI2Vsc2UKICAgIF9fYXR0cmlidXRlX18oKGZvcm1hdChwcmludGYsIDIsIDMpKSkKI2VuZGlmCiAgICBqc21fdHJhY2VfbWFsbG9jX3ByaW50ZihKU01hbGxvY1N0YXRlKiBzLCBjb25zdCBjaGFyKiBmbXQsIC4uLikgewogIHZhX2xpc3QgYXA7CiAgaW50IGM7CgogIHZhX3N0YXJ0KGFwLCBmbXQpOwogIHdoaWxlKChjID0gKmZtdCsrKSAhPSAnXDAnKSB7CiAgICBpZihjID09ICclJykgewogICAgICAvKiBvbmx5IGhhbmRsZSAlcCBhbmQgJXpkICovCiAgICAgIGlmKCpmbXQgPT0gJ3AnKSB7CiAgICAgICAgdWludDhfdCogcHRyID0gdmFfYXJnKGFwLCB2b2lkKik7CiAgICAgICAgaWYocHRyID09IDApIHsKICAgICAgICAgIHByaW50ZigiMCIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBwcmludGYoIkglKzA2bGxkLiV6ZCIsIGpzbV90cmFjZV9tYWxsb2NfcHRyX29mZnNldChwdHIsIHMtPm9wYXF1ZSksIGpzbV90cmFjZV9tYWxsb2NfdXNhYmxlX3NpemUocHRyKSk7CiAgICAgICAgfQogICAgICAgIGZtdCsrOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICAgIGlmKGZtdFswXSA9PSAneicgJiYgZm10WzFdID09ICdkJykgewogICAgICAgIHNpemVfdCBzeiA9IHZhX2FyZyhhcCwgc2l6ZV90KTsKICAgICAgICBwcmludGYoIiV6ZCIsIHN6KTsKICAgICAgICBmbXQgKz0gMjsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgfQogICAgcHV0YyhjLCBzdGRvdXQpOwogIH0KICB2YV9lbmQoYXApOwp9CgpzdGF0aWMgdm9pZApqc21fdHJhY2VfbWFsbG9jX2luaXQoc3RydWN0IHRyYWNlX21hbGxvY19kYXRhKiBzKSB7CiAgZnJlZShzLT5iYXNlID0gbWFsbG9jKDgpKTsKfQoKc3RhdGljIHZvaWQqCmpzbV90cmFjZV9tYWxsb2MoSlNNYWxsb2NTdGF0ZSogcywgc2l6ZV90IHNpemUpIHsKICB2b2lkKiBwdHI7CgogIC8qIERvIG5vdCBhbGxvY2F0ZSB6ZXJvIGJ5dGVzOiBiZWhhdmlvciBpcyBwbGF0Zm9ybSBkZXBlbmRlbnQgKi8KICBhc3NlcnQoc2l6ZSAhPSAwKTsKCiAgaWYodW5saWtlbHkocy0+bWFsbG9jX3NpemUgKyBzaXplID4gcy0+bWFsbG9jX2xpbWl0KSkKICAgIHJldHVybiAwOwogIHB0ciA9IG1hbGxvYyhzaXplKTsKICBqc21fdHJhY2VfbWFsbG9jX3ByaW50ZihzLCAiQSAlemQgLT4gJXBcbiIsIHNpemUsIHB0cik7CiAgaWYocHRyKSB7CiAgICBzLT5tYWxsb2NfY291bnQrKzsKICAgIHMtPm1hbGxvY19zaXplICs9IGpzbV90cmFjZV9tYWxsb2NfdXNhYmxlX3NpemUocHRyKSArIE1BTExPQ19PVkVSSEVBRDsKICB9CiAgcmV0dXJuIHB0cjsKfQoKc3RhdGljIHZvaWQKanNtX3RyYWNlX2ZyZWUoSlNNYWxsb2NTdGF0ZSogcywgdm9pZCogcHRyKSB7CiAgaWYoIXB0cikKICAgIHJldHVybjsKCiAganNtX3RyYWNlX21hbGxvY19wcmludGYocywgIkYgJXBcbiIsIHB0cik7CiAgcy0+bWFsbG9jX2NvdW50LS07CiAgcy0+bWFsbG9jX3NpemUgLT0ganNtX3RyYWNlX21hbGxvY191c2FibGVfc2l6ZShwdHIpICsgTUFMTE9DX09WRVJIRUFEOwogIGZyZWUocHRyKTsKfQoKc3RhdGljIHZvaWQqCmpzbV90cmFjZV9yZWFsbG9jKEpTTWFsbG9jU3RhdGUqIHMsIHZvaWQqIHB0ciwgc2l6ZV90IHNpemUpIHsKICBzaXplX3Qgb2xkX3NpemU7CgogIGlmKCFwdHIpIHsKICAgIGlmKHNpemUgPT0gMCkKICAgICAgcmV0dXJuIDA7CiAgICByZXR1cm4ganNtX3RyYWNlX21hbGxvYyhzLCBzaXplKTsKICB9CiAgb2xkX3NpemUgPSBqc21fdHJhY2VfbWFsbG9jX3VzYWJsZV9zaXplKHB0cik7CiAgaWYoc2l6ZSA9PSAwKSB7CiAgICBqc21fdHJhY2VfbWFsbG9jX3ByaW50ZihzLCAiUiAlemQgJXBcbiIsIHNpemUsIHB0cik7CiAgICBzLT5tYWxsb2NfY291bnQtLTsKICAgIHMtPm1hbGxvY19zaXplIC09IG9sZF9zaXplICsgTUFMTE9DX09WRVJIRUFEOwogICAgZnJlZShwdHIpOwogICAgcmV0dXJuIDA7CiAgfQogIGlmKHMtPm1hbGxvY19zaXplICsgc2l6ZSAtIG9sZF9zaXplID4gcy0+bWFsbG9jX2xpbWl0KQogICAgcmV0dXJuIDA7CgogIGpzbV90cmFjZV9tYWxsb2NfcHJpbnRmKHMsICJSICV6ZCAlcCIsIHNpemUsIHB0cik7CgogIHB0ciA9IHJlYWxsb2MocHRyLCBzaXplKTsKICBqc21fdHJhY2VfbWFsbG9jX3ByaW50ZihzLCAiIC0+ICVwXG4iLCBwdHIpOwogIGlmKHB0cikgewogICAgcy0+bWFsbG9jX3NpemUgKz0ganNtX3RyYWNlX21hbGxvY191c2FibGVfc2l6ZShwdHIpIC0gb2xkX3NpemU7CiAgfQogIHJldHVybiBwdHI7Cn0KCnN0YXRpYyBjb25zdCBKU01hbGxvY0Z1bmN0aW9ucyB0cmFjZV9tZiA9IHsKICAgIGpzbV90cmFjZV9tYWxsb2MsCiAgICBqc21fdHJhY2VfZnJlZSwKICAgIGpzbV90cmFjZV9yZWFsbG9jLAojaWYgZGVmaW5lZChfX0FQUExFX18pCiAgICBtYWxsb2Nfc2l6ZSwKI2VsaWYgZGVmaW5lZChfV0lOMzIpCiAgICAoc2l6ZV90KCopKGNvbnN0IHZvaWQqKSlfbXNpemUsCiNlbGlmIGRlZmluZWQoRU1TQ1JJUFRFTikgfHwgZGVmaW5lZChfX2RpZXRsaWJjX18pIHx8IGRlZmluZWQoX19NU1lTX18pIHx8IGRlZmluZWQoQU5EUk9JRCkgfHwgZGVmaW5lZChET05UX0hBVkVfTUFMTE9DX1VTQUJMRV9TSVpFX0RFRklOSVRJT04pCiAgICAwLAojZWxpZiBkZWZpbmVkKF9fbGludXhfXykgfHwgZGVmaW5lZChIQVZFX01BTExPQ19VU0FCTEVfU0laRSkKICAgIChzaXplX3QoKikoY29uc3Qgdm9pZCopKW1hbGxvY191c2FibGVfc2l6ZSwKI2Vsc2UKI3dhcm5pbmcgY2hhbmdlIHRoaXMgdG8gYDAsYCBpZiBjb21waWxhdGlvbiBmYWlscwogICAgLyogY2hhbmdlIHRoaXMgdG8gYDAsYCBpZiBjb21waWxhdGlvbiBmYWlscyAqLwogICAgbWFsbG9jX3VzYWJsZV9zaXplLAojZW5kaWYKfTsKCnZvaWQKanNtX2hlbHAodm9pZCkgewogIHByaW50ZigiUXVpY2tKUyB2ZXJzaW9uICIgQ09ORklHX1ZFUlNJT04gIlxuIgogICAgICAgICAidXNhZ2U6ICVzIFtvcHRpb25zXSBbZmlsZSBbYXJnc11dXG4iCiAgICAgICAgICItaCAgLS1oZWxwICAgICAgICAgbGlzdCBvcHRpb25zXG4iCiAgICAgICAgICItZSAgLS1ldmFsIEVYUFIgICAgZXZhbHVhdGUgRVhQUlxuIgogICAgICAgICAiLWkgIC0taW50ZXJhY3RpdmUgIGdvIHRvIGludGVyYWN0aXZlIG1vZGVcbiIKICAgICAgICAgIi1tICAtLW1vZHVsZSBOQU1FICBsb2FkIGFuIEVTNiBtb2R1bGVcbiIKICAgICAgICAgIi1JICAtLWluY2x1ZGUgZmlsZSBpbmNsdWRlIGFuIGFkZGl0aW9uYWwgZmlsZVxuIgogICAgICAgICAiICAgIC0tc3RkICAgICAgICAgIG1ha2UgJ3N0ZCcgYW5kICdvcycgYXZhaWxhYmxlIHRvIHRoZSBsb2FkZWQgc2NyaXB0XG4iCiNpZmRlZiBDT05GSUdfQklHTlVNCiAgICAgICAgICIgICAgLS1uby1iaWdudW0gICAgZGlzYWJsZSB0aGUgYmlnbnVtIGV4dGVuc2lvbnMgKEJpZ0Zsb2F0LCAiCiAgICAgICAgICJCaWdEZWNpbWFsKVxuIgogICAgICAgICAiICAgIC0tcWpzY2FsYyAgICAgIGxvYWQgdGhlIFFKU0NhbGMgcnVudGltZSAoZGVmYXVsdCBpZiBpbnZva2VkIGFzICIKICAgICAgICAgInFqc2NhbGMpXG4iCiNlbmRpZgogICAgICAgICAiLVQgIC0tdHJhY2UgICAgICAgIHRyYWNlIG1lbW9yeSBhbGxvY2F0aW9uXG4iCiAgICAgICAgICItZCAgLS1kdW1wICAgICAgICAgZHVtcCB0aGUgbWVtb3J5IHVzYWdlIHN0YXRzXG4iCiAgICAgICAgICIgICAgLS1tZW1vcnktbGltaXQgbiAgICAgICBsaW1pdCB0aGUgbWVtb3J5IHVzYWdlIHRvICduJyBieXRlc1xuIgogICAgICAgICAiICAgIC0tc3RhY2stc2l6ZSBuICAgICAgICAgbGltaXQgdGhlIHN0YWNrIHNpemUgdG8gJ24nIGJ5dGVzXG4iCiAgICAgICAgICIgICAgLS11bmhhbmRsZWQtcmVqZWN0aW9uICBkdW1wIHVuaGFuZGxlZCBwcm9taXNlIHJlamVjdGlvbnNcbiIKICAgICAgICAgIi1xICAtLXF1aXQgICAgICAgICBqdXN0IGluc3RhbnRpYXRlIHRoZSBpbnRlcnByZXRlciBhbmQgcXVpdFxuIgojaWZkZWYgU0lHVVNSMQogICAgICAgICAiXG4iCiAgICAgICAgICIgIFVTUjEgc2lnbmFsIHN0YXJ0cyBpbnRlcmFjdGl2ZSBtb2RlXG4iCiNlbmRpZgogICAgICAgICAsCiAgICAgICAgIGV4ZW5hbWUpOwogIGV4aXQoMSk7Cn0KCnN0YXRpYyBKU1ZhbHVlCmpzbV9ldmFsX3NjcmlwdChKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsLCBpbnQgYXJnYywgSlNWYWx1ZUNvbnN0IGFyZ3ZbXSwgaW50IG1hZ2ljKSB7CiAgY29uc3QgY2hhciogc3RyOwogIHNpemVfdCBsZW47CiAgSlNWYWx1ZSByZXQ7CiAgaW50MzJfdCBtb2R1bGU7CiAgc3RyID0gSlNfVG9DU3RyaW5nTGVuKGN0eCwgJmxlbiwgYXJndlswXSk7CiAgaWYoYXJnYyA+IDEpCiAgICBKU19Ub0ludDMyKGN0eCwgJm1vZHVsZSwgYXJndlsxXSk7CiAgZWxzZQogICAgbW9kdWxlID0gc3RyX2VuZHMoc3RyLCAiLm1qcyIpOwogIHN3aXRjaChtYWdpYykgewogICAgY2FzZSAwOiB7CiAgICAgIHJldCA9IGpzX2V2YWxfZmlsZShjdHgsIHN0ciwgbW9kdWxlKTsKICAgICAgYnJlYWs7CiAgICB9CiAgICBjYXNlIDE6IHsKICAgICAgcmV0ID0ganNfZXZhbF9idWYoY3R4LCBzdHIsIGxlbiwgMCwgbW9kdWxlKTsKICAgICAgYnJlYWs7CiAgICB9CiAgfQogIGlmKEpTX0lzRXhjZXB0aW9uKHJldCkpIHsKICAgIGlmKEpTX0lzTnVsbChKU19HZXRSdW50aW1lKGN0eCktPmN1cnJlbnRfZXhjZXB0aW9uKSkgewogICAgICByZXQgPSBKU19HZXRFeGNlcHRpb24oY3R4KTsKICAgICAgLy8gcmV0ID0gSlNfVU5ERUZJTkVEOwogICAgfQogIH0KICBpZihKU19WQUxVRV9HRVRfVEFHKHJldCkgPT0gSlNfVEFHX01PRFVMRSkgewogICAgSlNNb2R1bGVEZWYqIG0gPSBKU19WQUxVRV9HRVRfUFRSKHJldCk7CiAgICBKU1ZhbHVlIG9iaiA9IEpTX05ld09iamVjdChjdHgpOwogICAgSlNfU2V0UHJvcGVydHlTdHIoY3R4LCBvYmosICJuYW1lIiwgbW9kdWxlX25hbWUoY3R4LCBtKSk7CiAgICBKU19TZXRQcm9wZXJ0eVN0cihjdHgsIG9iaiwgImV4cG9ydHMiLCBtb2R1bGVfZXhwb3J0cyhjdHgsIG0pKTsKICAgIHJldCA9IG9iajsKICB9CiAgSlNfRnJlZUNTdHJpbmcoY3R4LCBzdHIpOwogIHJldHVybiByZXQ7Cn0KCmVudW0gewogIEZJTkRfTU9EVUxFLAogIExPQURfTU9EVUxFLAogIFJFUVVJUkVfTU9EVUxFLAogIExPQ0FURV9NT0RVTEUsCiAgTk9STUFMSVpFX01PRFVMRSwKICBSRVNPTFZFX01PRFVMRSwKICBHRVRfTU9EVUxFX05BTUUsCiAgR0VUX01PRFVMRV9PQkpFQ1QsCiAgR0VUX01PRFVMRV9FWFBPUlRTLAogIEdFVF9NT0RVTEVfTkFNRVNQQUNFLAogIEdFVF9NT0RVTEVfRlVOQ1RJT04sCiAgR0VUX01PRFVMRV9FWENFUFRJT04sCiAgR0VUX01PRFVMRV9NRVRBX09CSiwKfTsKCnN0YXRpYyBKU1ZhbHVlCmpzbV9tb2R1bGVfZnVuYyhKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsLCBpbnQgYXJnYywgSlNWYWx1ZUNvbnN0IGFyZ3ZbXSwgaW50IG1hZ2ljKSB7CiAgSlNWYWx1ZSB2YWwgPSBKU19FWENFUFRJT047CiAgSlNNb2R1bGVEZWYqIG0gPSAwOwogIGNvbnN0IGNoYXIqIG5hbWUgPSAwOwoKICBpZihtYWdpYyA+PSBSRVNPTFZFX01PRFVMRSB8fCAobWFnaWMgPT0gTk9STUFMSVpFX01PRFVMRSAmJiBKU19Jc01vZHVsZShhcmd2WzBdKSkpIHsKICAgIGlmKCEobSA9IGpzX21vZHVsZV9kZWYoY3R4LCBhcmd2WzBdKSkpCiAgICAgIHJldHVybiBKU19UaHJvd1R5cGVFcnJvcihjdHgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiJXM6IGFyZ3VtZW50IDEgZXhwZWN0aW5nIG1vZHVsZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoKGNvbnN0IGNoYXIqIGNvbnN0W10pewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJub3JtYWxpemVNb2R1bGUiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJyZXNvbHZlTW9kdWxlIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiZ2V0TW9kdWxlTmFtZSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImdldE1vZHVsZU9iamVjdCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImdldE1vZHVsZUV4cG9ydHMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJnZXRNb2R1bGVOYW1lc3BhY2UiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJnZXRNb2R1bGVGdW5jdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImdldE1vZHVsZUV4Y2VwdGlvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImdldE1vZHVsZU1ldGFPYmplY3QiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlbbWFnaWMgLSBOT1JNQUxJWkVfTU9EVUxFXSk7CiAgfSBlbHNlIHsKICAgIG5hbWUgPSBKU19Ub0NTdHJpbmcoY3R4LCBhcmd2WzBdKTsKICB9CgogIHN3aXRjaChtYWdpYykgewogICAgY2FzZSBGSU5EX01PRFVMRTogewogICAgICBpZigobSA9IGpzX21vZHVsZV9maW5kKGN0eCwgbmFtZSkpKQogICAgICAgIHZhbCA9IEpTX0R1cFZhbHVlKGN0eCwgSlNfTUtQVFIoSlNfVEFHX01PRFVMRSwgbSkpOwogICAgICBlbHNlCiAgICAgICAgdmFsID0gSlNfTlVMTDsKICAgICAgYnJlYWs7CiAgICB9CiAgICBjYXNlIExPQURfTU9EVUxFOiB7CiAgICAgIC8qICBKU1J1bnRpbWUqIHJ0ID0gSlNfR2V0UnVudGltZShjdHgpOwoKICAgICAgICBJbXBvcnREaXJlY3RpdmUgaW1wOwogICAgICAgIG1lbXNldCgmaW1wLCAwLCBzaXplb2YoaW1wKSk7CiAgICAgICAgaW50IHIsIG4gPSBjb3VudG9mKGltcC5hcmdzKTsKICAgICAgICByID0ganNfc3Rydl9jb3B5cyhjdHgsIGFyZ2MsIGFyZ3YsIG4sIGltcC5hcmdzKTsKICAgICAgICAvLyBwcmludGYoIkxPQURfTU9EVUxFIHI9JWkgYXJnYz0laVxuIiwgciwgYXJnYyk7CgogICAgICAgIG0gPSBydC0+bW9kdWxlX2xvYWRlcl9mdW5jKGN0eCwgaW1wLmFyZ3NbMF0sIDApOwoKICAgICAgICBpZihtKQogICAgICAgICAgdmFsID0gSlNfTUtQVFIoSlNfVEFHX01PRFVMRSwgbSk7CgogICAgICAgIGpzX3N0cnZfZnJlZV9uKGN0eCwgbiwgaW1wLmFyZ3MpOyovCiAgICAgIGlmKChtID0ganNtX21vZHVsZV9sb2FkKGN0eCwgbmFtZSkpKQogICAgICAgIHZhbCA9IEpTX01LUFRSKEpTX1RBR19NT0RVTEUsIG0pOwoKICAgICAgYnJlYWs7CiAgICB9CiAgICBjYXNlIFJFUVVJUkVfTU9EVUxFOiB7CiAgICAgIGlmKChtID0ganNtX21vZHVsZV9sb2FkKGN0eCwgbmFtZSkpKSB7CiAgICAgICAgdmFsID0gbW9kdWxlX2V4cG9ydHMoY3R4LCBtKTsKICAgICAgfQogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIExPQ0FURV9NT0RVTEU6IHsKICAgICAgY2hhciogczsKICAgICAgaWYoKHMgPSBqc21fbW9kdWxlX2xvY2F0ZShjdHgsIG5hbWUsIDApKSkgewogICAgICAgIHZhbCA9IEpTX05ld1N0cmluZyhjdHgsIHMpOwogICAgICAgIGpzX2ZyZWUoY3R4LCBzKTsKICAgICAgfQogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgTk9STUFMSVpFX01PRFVMRTogewogICAgICBjaGFyICpwYXRoLCAqZmlsZSwgKm5hbWU7CiAgICAgIHBhdGggPSBtID8gbW9kdWxlX25hbWVjc3RyKGN0eCwgbSkgOiBKU19Ub0NTdHJpbmcoY3R4LCBhcmd2WzBdKTsKICAgICAgbmFtZSA9IEpTX1RvQ1N0cmluZyhjdHgsIGFyZ3ZbMV0pOwoKICAgICAgaWYoKGZpbGUgPSBqc21fbW9kdWxlX25vcm1hbGl6ZShjdHgsIHBhdGgsIG5hbWUsIDApKSkgewogICAgICAgIHZhbCA9IEpTX05ld1N0cmluZyhjdHgsIGZpbGUpOwogICAgICAgIGpzX2ZyZWUoY3R4LCBmaWxlKTsKICAgICAgfQogICAgICBKU19GcmVlQ1N0cmluZyhjdHgsIHBhdGgpOwogICAgICBKU19GcmVlQ1N0cmluZyhjdHgsIG5hbWUpOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgUkVTT0xWRV9NT0RVTEU6IHsKICAgICAgdmFsID0gSlNfTmV3SW50MzIoY3R4LCBKU19SZXNvbHZlTW9kdWxlKGN0eCwgSlNfTUtQVFIoSlNfVEFHX01PRFVMRSwgbSkpKTsKICAgICAgYnJlYWs7CiAgICB9CiAgICBjYXNlIEdFVF9NT0RVTEVfTkFNRTogewogICAgICB2YWwgPSBtb2R1bGVfbmFtZShjdHgsIG0pOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgR0VUX01PRFVMRV9PQkpFQ1Q6IHsKICAgICAgdmFsID0gbW9kdWxlX29iamVjdChjdHgsIG0pOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgR0VUX01PRFVMRV9FWFBPUlRTOiB7CiAgICAgIHZhbCA9IG1vZHVsZV9leHBvcnRzKGN0eCwgbSk7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBHRVRfTU9EVUxFX05BTUVTUEFDRTogewogICAgICB2YWwgPSBKU19EdXBWYWx1ZShjdHgsIG0tPm1vZHVsZV9ucyk7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBHRVRfTU9EVUxFX0ZVTkNUSU9OOiB7CgogICAgICB2YWwgPSBtb2R1bGVfZnVuYyhjdHgsIG0pOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgR0VUX01PRFVMRV9FWENFUFRJT046IHsKICAgICAgaWYobS0+ZXZhbF9oYXNfZXhjZXB0aW9uKQogICAgICAgIHZhbCA9IEpTX0R1cFZhbHVlKGN0eCwgbS0+ZXZhbF9leGNlcHRpb24pOwogICAgICBlbHNlCiAgICAgICAgdmFsID0gSlNfTlVMTDsKICAgICAgYnJlYWs7CiAgICB9CiAgICBjYXNlIEdFVF9NT0RVTEVfTUVUQV9PQko6IHsKICAgICAgdmFsID0gSlNfRHVwVmFsdWUoY3R4LCBtLT5tZXRhX29iaik7CiAgICAgIGJyZWFrOwogICAgfQogIH0KICBpZihuYW1lKQogICAgSlNfRnJlZUNTdHJpbmcoY3R4LCBuYW1lKTsKCiAgcmV0dXJuIHZhbDsKfQoKc3RhdGljIGNvbnN0IEpTQ0Z1bmN0aW9uTGlzdEVudHJ5IGpzbV9nbG9iYWxfZnVuY3NbXSA9IHsKICAgIEpTX0NGVU5DX01BR0lDX0RFRigiZXZhbEZpbGUiLCAxLCBqc21fZXZhbF9zY3JpcHQsIDApLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJldmFsU2NyaXB0IiwgMSwganNtX2V2YWxfc2NyaXB0LCAxKSwKICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJtb2R1bGVMaXN0IiwganNfbW9kdWxlc19hcnJheSwgMCwgMCksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigibW9kdWxlT2JqZWN0IiwganNfbW9kdWxlc19vYmplY3QsIDAsIDApLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoIm1vZHVsZU1hcCIsIGpzX21vZHVsZXNfbWFwLCAwLCAwKSwKICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJzY3JpcHRMaXN0IiwganNtX3N0YWNrX2dldCwgMCwgU0NSSVBUX0xJU1QpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoInNjcmlwdEZpbGUiLCBqc21fc3RhY2tfZ2V0LCAwLCBTQ1JJUFRfRklMRSksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigic2NyaXB0RGlyIiwganNtX3N0YWNrX2dldCwgMCwgU0NSSVBUX0RJUk5BTUUpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoIl9fZmlsZW5hbWUiLCBqc21fc3RhY2tfZ2V0LCAwLCBTQ1JJUFRfRklMRU5BTUUpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoIl9fZGlybmFtZSIsIGpzbV9zdGFja19nZXQsIDAsIFNDUklQVF9ESVJOQU1FKSwKICAgIEpTX0NGVU5DX01BR0lDX0RFRigiZmluZE1vZHVsZSIsIDEsIGpzbV9tb2R1bGVfZnVuYywgRklORF9NT0RVTEUpLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJsb2FkTW9kdWxlIiwgMSwganNtX21vZHVsZV9mdW5jLCBMT0FEX01PRFVMRSksCiAgICBKU19DRlVOQ19NQUdJQ19ERUYoInJlc29sdmVNb2R1bGUiLCAxLCBqc21fbW9kdWxlX2Z1bmMsIFJFU09MVkVfTU9EVUxFKSwKICAgIEpTX0NGVU5DX01BR0lDX0RFRigicmVxdWlyZU1vZHVsZSIsIDEsIGpzbV9tb2R1bGVfZnVuYywgUkVRVUlSRV9NT0RVTEUpLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJub3JtYWxpemVNb2R1bGUiLCAyLCBqc21fbW9kdWxlX2Z1bmMsIE5PUk1BTElaRV9NT0RVTEUpLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJsb2NhdGVNb2R1bGUiLCAxLCBqc21fbW9kdWxlX2Z1bmMsIExPQ0FURV9NT0RVTEUpLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJnZXRNb2R1bGVOYW1lIiwgMSwganNtX21vZHVsZV9mdW5jLCBHRVRfTU9EVUxFX05BTUUpLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJnZXRNb2R1bGVPYmplY3QiLCAxLCBqc21fbW9kdWxlX2Z1bmMsIEdFVF9NT0RVTEVfT0JKRUNUKSwKICAgIEpTX0NGVU5DX01BR0lDX0RFRigiZ2V0TW9kdWxlRXhwb3J0cyIsIDEsIGpzbV9tb2R1bGVfZnVuYywgR0VUX01PRFVMRV9FWFBPUlRTKSwKICAgIEpTX0NGVU5DX01BR0lDX0RFRigiZ2V0TW9kdWxlTmFtZXNwYWNlIiwgMSwganNtX21vZHVsZV9mdW5jLCBHRVRfTU9EVUxFX05BTUVTUEFDRSksCiAgICBKU19DRlVOQ19NQUdJQ19ERUYoImdldE1vZHVsZUZ1bmN0aW9uIiwgMSwganNtX21vZHVsZV9mdW5jLCBHRVRfTU9EVUxFX0ZVTkNUSU9OKSwKICAgIEpTX0NGVU5DX01BR0lDX0RFRigiZ2V0TW9kdWxlRXhjZXB0aW9uIiwgMSwganNtX21vZHVsZV9mdW5jLCBHRVRfTU9EVUxFX0VYQ0VQVElPTiksCiAgICBKU19DRlVOQ19NQUdJQ19ERUYoImdldE1vZHVsZU1ldGFPYmplY3QiLCAxLCBqc21fbW9kdWxlX2Z1bmMsIEdFVF9NT0RVTEVfTUVUQV9PQkopLAp9OwoKdm9pZApqc21faW1wb3J0X3BhcnNlKEltcG9ydERpcmVjdGl2ZSogaW1wLCBjb25zdCBjaGFyKiBzcGVjKSB7CiAgQk9PTCBuczsKICBzaXplX3QgbGVuLCBlcXBvcywgZG90cG9zOwogIG1lbXNldChpbXAsIDAsIHNpemVvZihJbXBvcnREaXJlY3RpdmUpKTsKCiAgbGVuID0gc3RybGVuKHNwZWMpOwogIGVxcG9zID0gc3RyX2NocihzcGVjLCAnPScpOwoKICBpZihlcXBvcyA8IGxlbikgewogICAgaW1wLT52YXIgPSBzdHJfbmR1cChzcGVjLCBlcXBvcyk7CiAgICBzcGVjICs9IGVxcG9zICsgMTsKICAgIGxlbiAtPSBlcXBvcyArIDE7CiAgfQogIGRvdHBvcyA9IHN0cl9yY2hyKHNwZWMsICcuJyk7CiAgbnMgPSBkb3Rwb3MgKyAxIDwgbGVuICYmIHNwZWNbZG90cG9zICsgMV0gPT0gJyonOwogIGltcC0+cGF0aCA9IHN0cl9uZHVwKHNwZWMsIGRvdHBvcyk7CiAgaW1wLT5ucyA9IGJhc2VuYW1lKGltcC0+cGF0aCk7CgogIGlmKGRvdHBvcyA8IGxlbiAmJiAhbnMpIHsKICAgIGltcC0+c3BlYyA9IHN0cmR1cCgmc3BlY1tkb3Rwb3MgKyAxXSk7CiAgICBpbXAtPnByb3AgPSBzdHJkdXAoJnNwZWNbZG90cG9zICsgMV0pOwogICAgaW1wLT5ucyA9IDA7CiAgfSBlbHNlIHsKICAgIGltcC0+c3BlYyA9IGRvdHBvcyA8IGxlbiA/IChucyA/ICIqIiA6IDApIDogImRlZmF1bHQiOwogIH0KfQoKc3RhdGljIHZvaWQKanNtX3N0YXJ0X2ludGVyYWN0aXZlKHZvaWQpIHsKICBjaGFyIHN0cls1MTJdOwogIGNvbnN0IGNoYXIqIGhvbWU7CgogIGlmKCFKU19Jc1VuZGVmaW5lZChyZXBsT2JqKSkKICAgIHJldHVybjsKCiAgLyppZighaW50ZXJhY3RpdmUpCiAgICBmcHV0cygiRW50ZXJpbmcgaW50ZXJhY3RpdmUgbW9kZS4uLlxuIiwgc3RkZXJyKTsqLwoKICBob21lID0gZ2V0ZW52KCJIT01FIik7CgogIC8qIGNsYW5nLWZvcm1hdCBvZmYgKi8KICBzbnByaW50ZihzdHIsCiAgICBzaXplb2Yoc3RyKSwKICAgICJpbXBvcnQgUkVQTCBmcm9tICdyZXBsJztcbiIKICAgICJpbXBvcnQgZnMgZnJvbSAnZnMnO1xuIgogICAgImNvbnN0IGhpc3RvcnkgPSAnJXMvLiVzX2hpc3RvcnknO1xuIgogICAgImdsb2JhbFRoaXMucmVwbCA9IG5ldyBSRVBMKCclcycpO1xuIgogICAgInJlcGwubG9hZFNhdmVPcHRpb25zKCk7XG4iCiAgICAicmVwbC5oaXN0b3J5TG9hZChudWxsLCBmcyk7XG4iCiAgICAicmVwbC5kaXJlY3RpdmVzID0geyBpOiBbIG5hbWUgPT4gaW1wb3J0KG5hbWUpLnRoZW4obSA9PiBnbG9iYWxUaGlzW25hbWUucmVwbGFjZSgvKC4qXFwvfFxcLlteXFwvLl0rJCkvZywgJycpXSA9IG0pLmNhdGNoKCgpID0+IHJlcGwucHJpbnRTdGF0dXMoYEVSUk9SOiBtb2R1bGUgJyR7bmFtZX0nIG5vdCBmb3VuZGApKSwgJ2ltcG9ydCBhIG1vZHVsZScgXSB9O1xuIgogICAgInJlcGwuc2hvdyA9IGNvbnNvbGUubG9nO1xuIgogICAgInJlcGwucnVuU3luYygpO1xuIiwKICAgIGhvbWUsIGV4ZW5hbWUsIGV4ZW5hbWUpOwogIC8qIGNsYW5nLWZvcm1hdCBvbiAqLwoKICBqc19ldmFsX2JpbmFyeShjdHgsIHFqc2NfcmVwbCwgcWpzY19yZXBsX3NpemUsIDApOwogIHJlcGxPYmogPSBqc19ldmFsX2J1ZihjdHgsIHN0ciwgc3RybGVuKHN0ciksICI8aW5pdD4iLCBKU19FVkFMX1RZUEVfTU9EVUxFKTsKfQoKaW50Cm1haW4oaW50IGFyZ2MsIGNoYXIqKiBhcmd2KSB7CiAgc3RydWN0IHRyYWNlX21hbGxvY19kYXRhIHRyYWNlX2RhdGEgPSB7MH07CiAgaW50IG9wdGluZDsKICBjaGFyKiBleHByID0gMDsKICBpbnQgaW50ZXJhY3RpdmUgPSAwOwogIGludCBkdW1wX21lbW9yeSA9IDA7CiAgaW50IHRyYWNlX21lbW9yeSA9IDA7CiAgaW50IGVtcHR5X3J1biA9IDA7CiAgaW50IG1vZHVsZSA9IDE7CiAgaW50IGxvYWRfc3RkID0gMTsKICBpbnQgZHVtcF91bmhhbmRsZWRfcHJvbWlzZV9yZWplY3Rpb24gPSAwOwogIHNpemVfdCBtZW1vcnlfbGltaXQgPSAwOwogIGNoYXIqIGluY2x1ZGVfbGlzdFszMl07CiAgaW50IGksIGluY2x1ZGVfY291bnQgPSAwOwojaWZkZWYgQ09ORklHX0JJR05VTQogIGludCBsb2FkX2pzY2FsYzsKI2VuZGlmCiAgc2l6ZV90IHN0YWNrX3NpemUgPSAwOwoKICBwYWNrYWdlX2pzb24gPSBKU19VTkRFRklORUQ7CiAgcmVwbE9iaiA9IEpTX1VOREVGSU5FRDsKCiAgewogICAgY29uc3QgY2hhciogcDsKICAgIGV4ZW5hbWUgPSBhcmd2WzBdOwogICAgcCA9IHN0cnJjaHIoZXhlbmFtZSwgJy8nKTsKICAgIGlmKHApCiAgICAgIGV4ZW5hbWUgPSBwICsgMTsKICAgIC8qIGxvYWQganNjYWxjIHJ1bnRpbWUgaWYgaW52b2tlZCBhcyAncWpzY2FsYycgKi8KICAgIGxvYWRfanNjYWxjID0gIXN0cmNtcChleGVuYW1lLCAicWpzY2FsYyIpOwogIH0KCiAgLyogY2Fubm90IHVzZSBnZXRvcHQgYmVjYXVzZSB3ZSB3YW50IHRvIHBhc3MgdGhlIGNvbW1hbmQgbGluZSB0bwogICAgIHRoZSBzY3JpcHQgKi8KICBvcHRpbmQgPSAxOwogIHdoaWxlKG9wdGluZCA8IGFyZ2MgJiYgKmFyZ3Zbb3B0aW5kXSA9PSAnLScpIHsKICAgIGNoYXIqIGFyZyA9IGFyZ3Zbb3B0aW5kXSArIDE7CiAgICBjb25zdCBjaGFyKiBsb25nb3B0ID0gIiI7CiAgICBjb25zdCBjaGFyKiBvcHRhcmc7CgogICAgLyogYSBzaW5nbGUgLSBpcyBub3QgYW4gb3B0aW9uLCBpdCBhbHNvIHN0b3BzIGFyZ3VtZW50IHNjYW5uaW5nICovCiAgICBpZighKmFyZykKICAgICAgYnJlYWs7CgogICAgaWYoYXJnWzFdKSB7CiAgICAgIG9wdGFyZyA9ICZhcmdbMV07CiAgICB9IGVsc2UgewogICAgICBvcHRhcmcgPSBhcmd2Wysrb3B0aW5kXTsKICAgIH0KCiAgICBpZigqYXJnID09ICctJykgewogICAgICBsb25nb3B0ID0gYXJnICsgMTsKICAgICAgYXJnICs9IHN0cmxlbihhcmcpOwogICAgICAvKiAtLSBzdG9wcyBhcmd1bWVudCBzY2FubmluZyAqLwogICAgICBpZighKmxvbmdvcHQpCiAgICAgICAgYnJlYWs7CiAgICB9CiAgICBmb3IoOyAqYXJnIHx8ICpsb25nb3B0OyBsb25nb3B0ID0gIiIpIHsKICAgICAgY2hhciBvcHQgPSAqYXJnOwogICAgICBpZihvcHQpCiAgICAgICAgYXJnKys7CiAgICAgIGlmKG9wdCA9PSAnaCcgfHwgb3B0ID09ICc/JyB8fCAhc3RyY21wKGxvbmdvcHQsICJoZWxwIikpIHsKICAgICAgICBqc21faGVscCgpOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICAgIGlmKG9wdCA9PSAnZScgfHwgIXN0cmNtcChsb25nb3B0LCAiZXZhbCIpKSB7CiAgICAgICAgaWYoKmFyZykgewogICAgICAgICAgZXhwciA9IGFyZzsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBpZihvcHRpbmQgPCBhcmdjKSB7CiAgICAgICAgICBleHByID0gYXJndltvcHRpbmQrK107CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgZnByaW50ZihzdGRlcnIsICIlczogbWlzc2luZyBleHByZXNzaW9uIGZvciAtZVxuIiwgZXhlbmFtZSk7CiAgICAgICAgZXhpdCgyKTsKICAgICAgfQogICAgICBpZihvcHQgPT0gJ0knIHx8ICFzdHJjbXAobG9uZ29wdCwgImluY2x1ZGUiKSkgewogICAgICAgIGlmKG9wdGluZCA+PSBhcmdjKSB7CiAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgImV4cGVjdGluZyBmaWxlbmFtZSIpOwogICAgICAgICAgZXhpdCgxKTsKICAgICAgICB9CiAgICAgICAgaWYoaW5jbHVkZV9jb3VudCA+PSBjb3VudG9mKGluY2x1ZGVfbGlzdCkpIHsKICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAidG9vIG1hbnkgaW5jbHVkZWQgZmlsZXMiKTsKICAgICAgICAgIGV4aXQoMSk7CiAgICAgICAgfQogICAgICAgIGluY2x1ZGVfbGlzdFtpbmNsdWRlX2NvdW50KytdID0gb3B0YXJnOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGlmKG9wdCA9PSAnaScgfHwgIXN0cmNtcChsb25nb3B0LCAiaW50ZXJhY3RpdmUiKSkgewogICAgICAgIGludGVyYWN0aXZlKys7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgaWYob3B0ID09ICdtJyB8fCAhc3RyY21wKGxvbmdvcHQsICJtb2R1bGUiKSkgewogICAgICAgIGNvbnN0IGNoYXIqIG1vZHVsZXMgPSBhcmd2W29wdGluZF07CiAgICAgICAgc2l6ZV90IGksIGxlbjsKCiAgICAgICAgZm9yKGkgPSAwOyBtb2R1bGVzW2ldOyBpICs9IGxlbikgewogICAgICAgICAgbGVuID0gc3RyX2NocigmbW9kdWxlc1tpXSwgJywnKTsKICAgICAgICAgIHZlY3Rvcl9wdXNoc3RyaW5nbGVuKCZtb2R1bGVfbGlzdCwgJm1vZHVsZXNbaV0sIGxlbik7CgogICAgICAgICAgaWYobW9kdWxlc1tpICsgbGVuXSA9PSAnLCcpCiAgICAgICAgICAgIGxlbisrOwogICAgICAgIH0KCiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgaWYob3B0ID09ICdkJyB8fCAhc3RyY21wKGxvbmdvcHQsICJkdW1wIikpIHsKICAgICAgICBkdW1wX21lbW9yeSsrOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGlmKG9wdCA9PSAnVCcgfHwgIXN0cmNtcChsb25nb3B0LCAidHJhY2UiKSkgewogICAgICAgIHRyYWNlX21lbW9yeSsrOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGlmKCFzdHJjbXAobG9uZ29wdCwgInN0ZCIpKSB7CiAgICAgICAgbG9hZF9zdGQgPSAxOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGlmKCFzdHJjbXAobG9uZ29wdCwgInVuaGFuZGxlZC1yZWplY3Rpb24iKSkgewogICAgICAgIGR1bXBfdW5oYW5kbGVkX3Byb21pc2VfcmVqZWN0aW9uID0gMTsKICAgICAgICBicmVhazsKICAgICAgfQojaWZkZWYgQ09ORklHX0JJR05VTQogICAgICBpZighc3RyY21wKGxvbmdvcHQsICJuby1iaWdudW0iKSkgewogICAgICAgIGJpZ251bV9leHQgPSAwOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGlmKCFzdHJjbXAobG9uZ29wdCwgImJpZ251bSIpKSB7CiAgICAgICAgYmlnbnVtX2V4dCA9IDE7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgaWYoIXN0cmNtcChsb25nb3B0LCAicWpzY2FsYyIpKSB7CiAgICAgICAgbG9hZF9qc2NhbGMgPSAxOwogICAgICAgIGJyZWFrOwogICAgICB9CiNlbmRpZgogICAgICBpZihvcHQgPT0gJ3EnIHx8ICFzdHJjbXAobG9uZ29wdCwgInF1aXQiKSkgewogICAgICAgIGVtcHR5X3J1bisrOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGlmKCFzdHJjbXAobG9uZ29wdCwgIm1lbW9yeS1saW1pdCIpKSB7CiAgICAgICAgaWYob3B0aW5kID49IGFyZ2MpIHsKICAgICAgICAgIGZwcmludGYoc3RkZXJyLCAiZXhwZWN0aW5nIG1lbW9yeSBsaW1pdCIpOwogICAgICAgICAgZXhpdCgxKTsKICAgICAgICB9CiAgICAgICAgbWVtb3J5X2xpbWl0ID0gKHNpemVfdClzdHJ0b2QoYXJndltvcHRpbmQrK10sIDApOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGlmKCFzdHJjbXAobG9uZ29wdCwgInN0YWNrLXNpemUiKSkgewogICAgICAgIGlmKG9wdGluZCA+PSBhcmdjKSB7CiAgICAgICAgICBmcHJpbnRmKHN0ZGVyciwgImV4cGVjdGluZyBzdGFjayBzaXplIik7CiAgICAgICAgICBleGl0KDEpOwogICAgICAgIH0KICAgICAgICBzdGFja19zaXplID0gKHNpemVfdClzdHJ0b2QoYXJndltvcHRpbmQrK10sIDApOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIGlmKG9wdCkgewogICAgICAgIGZwcmludGYoc3RkZXJyLCAiJXM6IHVua25vd24gb3B0aW9uICctJWMnXG4iLCBleGVuYW1lLCBvcHQpOwogICAgICB9IGVsc2UgewogICAgICAgIGZwcmludGYoc3RkZXJyLCAiJXM6IHVua25vd24gb3B0aW9uICctLSVzJ1xuIiwgZXhlbmFtZSwgbG9uZ29wdCk7CiAgICAgIH0KICAgICAganNtX2hlbHAoKTsKICAgIH0KICAgIG9wdGluZCsrOwogIH0KCiAganNtX2luaXRfbW9kdWxlcyhjdHgpOwoKI2lmZGVmIEhBVkVfR0VUX01PRFVMRV9MT0FERVJfRlVOQwogIG1vZHVsZV9sb2FkZXIgPSBqc19zdGRfZ2V0X21vZHVsZV9sb2FkZXJfZnVuYygpOwojZW5kaWYKCiAgewogICAgY29uc3QgY2hhciogbW9kdWxlczsKCiAgICBpZigobW9kdWxlcyA9IGdldGVudigiREVCVUciKSkpIHsKICAgICAgc2l6ZV90IGksIGxlbjsKICAgICAgZm9yKGkgPSAwOyBtb2R1bGVzW2ldOyBpICs9IGxlbikgewogICAgICAgIGxlbiA9IHN0cl9jaHIoJm1vZHVsZXNbaV0sICcsJyk7CiAgICAgICAgdmVjdG9yX3B1dHB0cigmbW9kdWxlX2RlYnVnLCBzdHJfbmR1cCgmbW9kdWxlc1tpXSwgbGVuKSk7CgogICAgICAgIGlmKG1vZHVsZXNbaSArIGxlbl0gPT0gJywnKQogICAgICAgICAgbGVuKys7CiAgICAgIH0KCiAgICAgIGRlYnVnX21vZHVsZV9sb2FkZXIgPSB2ZWN0b3JfY291bnRzKCZtb2R1bGVfZGVidWcsICJtb2R1bGVzIik7CiAgICB9CiAgfQoKICBpZihsb2FkX2pzY2FsYykKICAgIGJpZ251bV9leHQgPSAxOwoKICBpZih0cmFjZV9tZW1vcnkpIHsKICAgIGpzbV90cmFjZV9tYWxsb2NfaW5pdCgmdHJhY2VfZGF0YSk7CiAgICBydCA9IEpTX05ld1J1bnRpbWUyKCZ0cmFjZV9tZiwgJnRyYWNlX2RhdGEpOwogIH0gZWxzZSB7CiAgICBydCA9IEpTX05ld1J1bnRpbWUoKTsKICB9CiAgaWYoIXJ0KSB7CiAgICBmcHJpbnRmKHN0ZGVyciwgIiVzOiBjYW5ub3QgYWxsb2NhdGUgSlMgcnVudGltZVxuIiwgZXhlbmFtZSk7CiAgICBleGl0KDIpOwogIH0KCiAgaWYobWVtb3J5X2xpbWl0ICE9IDApCiAgICBKU19TZXRNZW1vcnlMaW1pdChydCwgbWVtb3J5X2xpbWl0KTsKICAvLyBpZiAoc3RhY2tfc2l6ZSAhPSAwKQogIEpTX1NldE1heFN0YWNrU2l6ZShydCwgc3RhY2tfc2l6ZSAhPSAwID8gc3RhY2tfc2l6ZSA6IDI1NiAqIDEwNDg1NzYpOwoKICBqc19zdGRfc2V0X3dvcmtlcl9uZXdfY29udGV4dF9mdW5jKGpzbV9jb250ZXh0X25ldyk7CgogIGpzX3N0ZF9pbml0X2hhbmRsZXJzKHJ0KTsKICBKU19TZXRNb2R1bGVMb2FkZXJGdW5jKHJ0LCBqc21fbW9kdWxlX25vcm1hbGl6ZSwganNtX21vZHVsZV9sb2FkZXIsIDApOwoKICBjdHggPSBqc21fY29udGV4dF9uZXcocnQpOwogIGlmKCFjdHgpIHsKICAgIGZwcmludGYoc3RkZXJyLCAiJXM6IGNhbm5vdCBhbGxvY2F0ZSBKUyBjb250ZXh0XG4iLCBleGVuYW1lKTsKICAgIGV4aXQoMik7CiAgfQoKICB2ZWN0b3JfaW5pdCgmanNtX3N0YWNrLCBjdHgpOwoKICAvKiBsb2FkZXIgZm9yIEVTNiBtb2R1bGVzICovCiAgSlNfU2V0TW9kdWxlTG9hZGVyRnVuYyhydCwganNtX21vZHVsZV9ub3JtYWxpemUsIGpzbV9tb2R1bGVfbG9hZGVyLCAwKTsKICAvLyBqc19zdGRfc2V0X21vZHVsZV9sb2FkZXJfZnVuYyhqc21fbW9kdWxlX2xvYWRlcik7CgogIGlmKGR1bXBfdW5oYW5kbGVkX3Byb21pc2VfcmVqZWN0aW9uKSB7CiAgICBKU19TZXRIb3N0UHJvbWlzZVJlamVjdGlvblRyYWNrZXIocnQsIGpzX3N0ZF9wcm9taXNlX3JlamVjdGlvbl90cmFja2VyLCAwKTsKICB9CgogIGlmKCFlbXB0eV9ydW4pIHsKICAgIER5bkJ1ZiBkYjsKICAgIGpzX2RidWZfaW5pdChjdHgsICZkYik7CgojaWZkZWYgQ09ORklHX0JJR05VTQogICAgaWYobG9hZF9qc2NhbGMpIHsKICAgICAganNfZXZhbF9iaW5hcnkoY3R4LCBxanNjX3Fqc2NhbGMsIHFqc2NfcWpzY2FsY19zaXplLCAwKTsKICAgIH0KI2VuZGlmCiAgICBqc19zdGRfYWRkX2hlbHBlcnMoY3R4LCBhcmdjIC0gb3B0aW5kLCBhcmd2ICsgb3B0aW5kKTsKCiAgICB7CiAgICAgIGNvbnN0IGNoYXIqIHN0ciA9ICJpbXBvcnQgcHJvY2VzcyBmcm9tICdwcm9jZXNzJztcbmdsb2JhbFRoaXMucHJvY2VzcyA9IHByb2Nlc3M7XG4iOwogICAgICAvLyBqc19ldmFsX3N0cihjdHgsIHN0ciwgMCwgSlNfRVZBTF9UWVBFX01PRFVMRSk7CiAgICAgIGRidWZfcHV0c3RyKCZkYiwgc3RyKTsKICAgIH0KICAgIHsKICAgICAgY29uc3QgY2hhciogc3RyID0gImltcG9ydCByZXF1aXJlIGZyb20gJ3JlcXVpcmUnO1xuZ2xvYmFsVGhpcy5yZXF1aXJlID0gcmVxdWlyZTtcbiI7CiAgICAgIC8vIGRidWZfcHV0c3RyKCZkYiwgc3RyKTsKICAgICAgLy8ganNfZXZhbF9zdHIoY3R4LCBzdHIsIDAsIEpTX0VWQUxfVFlQRV9NT0RVTEUpOwogICAgfQoKICAgIEpTX1NldFByb3BlcnR5RnVuY3Rpb25MaXN0KGN0eCwgSlNfR2V0R2xvYmFsT2JqZWN0KGN0eCksIGpzbV9nbG9iYWxfZnVuY3MsIGNvdW50b2YoanNtX2dsb2JhbF9mdW5jcykpOwogICAgaWYobG9hZF9zdGQpIHsKICAgICAgY29uc3QgY2hhciogc3RyID0gImltcG9ydCAqIGFzIHN0ZCBmcm9tICdzdGQnO1xuaW1wb3J0ICogYXMgb3MgZnJvbSAnb3MnO1xuZ2xvYmFsVGhpcy5zdGQgPSBzdGQ7XG5nbG9iYWxUaGlzLm9zID0gb3M7XG5nbG9iYWxUaGlzLnNldFRpbWVvdXQgPSAiCiAgICAgICAgICAgICAgICAgICAgICAgICJvcy5zZXRUaW1lb3V0O1xuZ2xvYmFsVGhpcy5jbGVhclRpbWVvdXQgPSBvcy5jbGVhclRpbWVvdXQ7XG4iOwogICAgICBkYnVmX3B1dHN0cigmZGIsIHN0cik7CiAgICAgIC8vIGpzX2V2YWxfc3RyKGN0eCwgc3RyLCAwLCBKU19FVkFMX1RZUEVfTU9EVUxFKTsKICAgIH0KCiAgICBpZihkYi5zaXplKSB7CiAgICAgIGRidWZfMCgmZGIpOwogICAgICBqc19ldmFsX3N0cihjdHgsIGRiLmJ1ZiwgMCwgSlNfRVZBTF9UWVBFX01PRFVMRSk7CiAgICAgIC8vIGpzbV9saXN0X21vZHVsZXMoY3R4KQogICAgfQogICAgZGJ1Zl9mcmVlKCZkYik7CgogICAgewogICAgICBjaGFyKiogcHRyOwogICAgICBKU01vZHVsZURlZiogbTsKICAgICAgdmVjdG9yX2ZvcmVhY2hfdCgmbW9kdWxlX2xpc3QsIHB0cikgewogICAgICAgIGNoYXIqIG5hbWUgPSAqcHRyOwogICAgICAgIGludCBhbGwgPSAwOwoKICAgICAgICBpZihuYW1lWzBdID09ICcqJykKICAgICAgICAgIGFsbCA9IDE7CgogICAgICAgIGlmKCFqc21fbW9kdWxlX2xvYWQoY3R4LCBuYW1lKSkgewogICAgICAgICAganNtX2R1bXBfZXJyb3IoY3R4KTsKICAgICAgICAgIHJldHVybiAxOwogICAgICAgIH0KICAgICAgfQogICAgICB2ZWN0b3JfZnJlZXN0cmluZ3MoJm1vZHVsZV9saXN0KTsKICAgIH0KCiAgICBmb3IoaSA9IDA7IGkgPCBpbmNsdWRlX2NvdW50OyBpKyspIHsKICAgICAgaWYoanNtX3N0YWNrX2xvYWQoY3R4LCBpbmNsdWRlX2xpc3RbaV0sIG1vZHVsZSkgPT0gLTEpCiAgICAgICAgZ290byBmYWlsOwogICAgfQoKICAgIGpzX2V2YWxfc3RyKGN0eCwKICAgICAgICAgICAgICAgICJpbXBvcnQgeyBDb25zb2xlIH0gZnJvbSAnY29uc29sZSc7XG4iCiAgICAgICAgICAgICAgICAiaW1wb3J0IHsgb3V0IH0gZnJvbSAnc3RkJztcbiIKICAgICAgICAgICAgICAgICJnbG9iYWxUaGlzLmNvbnNvbGUgPSBuZXcgQ29uc29sZShvdXQsIHsgaW5zcGVjdE9wdGlvbnM6IHsgY3VzdG9tSW5zcGVjdDogdHJ1ZSB9IH0pO1xuIiwKICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICBKU19FVkFMX1RZUEVfTU9EVUxFKTsKCiAgICBpZighaW50ZXJhY3RpdmUpIHsKI2lmZGVmIFNJR1VTUjEKICAgICAgc2lnbmFsKFNJR1VTUjEsIGpzbV9zdGFydF9pbnRlcmFjdGl2ZSk7CiNlbmRpZgogICAgfQoKICAgIGlmKGV4cHIpIHsKICAgICAgaWYoanNfZXZhbF9zdHIoY3R4LCBleHByLCAiPGNtZGxpbmU+IiwgMCkgPT0gLTEpCiAgICAgICAgZ290byBmYWlsOwogICAgfSBlbHNlIGlmKG9wdGluZCA+PSBhcmdjKSB7CiAgICAgIC8qIGludGVyYWN0aXZlIG1vZGUgKi8KICAgICAgaW50ZXJhY3RpdmUgPSAxOwogICAgfSBlbHNlIHsKICAgICAgY29uc3QgY2hhciogZmlsZW5hbWU7CiAgICAgIGZpbGVuYW1lID0gYXJndltvcHRpbmRdOwogICAgICBpZihqc21fc3RhY2tfbG9hZChjdHgsIGZpbGVuYW1lLCBtb2R1bGUpID09IC0xKSB7CiAgICAgICAganNfdmFsdWVfZndyaXRlKGN0eCwgSlNfR2V0RXhjZXB0aW9uKGN0eCksIHN0ZGVycik7CiAgICAgICAgZ290byBmYWlsOwogICAgICB9CiAgICB9CgogICAgaWYoaW50ZXJhY3RpdmUpCiAgICAgIGpzbV9zdGFydF9pbnRlcmFjdGl2ZSgpOwoKICAgIGpzX3N0ZF9sb29wKGN0eCk7CiAgfQoKICBpZighSlNfSXNOdWxsKGN0eC0+cnQtPmN1cnJlbnRfZXhjZXB0aW9uKSkKICAgIGpzbV9kdW1wX2Vycm9yKGN0eCk7CgogIGlmKGR1bXBfbWVtb3J5KSB7CiAgICBKU01lbW9yeVVzYWdlIHN0YXRzOwogICAgSlNfQ29tcHV0ZU1lbW9yeVVzYWdlKHJ0LCAmc3RhdHMpOwogICAgSlNfRHVtcE1lbW9yeVVzYWdlKHN0ZG91dCwgJnN0YXRzLCBydCk7CiAgfQogIGpzX3N0ZF9mcmVlX2hhbmRsZXJzKHJ0KTsKICBKU19GcmVlQ29udGV4dChjdHgpOwogIEpTX0ZyZWVSdW50aW1lKHJ0KTsKCiAgaWYoZW1wdHlfcnVuICYmIGR1bXBfbWVtb3J5KSB7CiAgICBjbG9ja190IHRbNV07CiAgICBkb3VibGUgYmVzdFs1XTsKICAgIGludCBpLCBqOwogICAgZm9yKGkgPSAwOyBpIDwgMTAwOyBpKyspIHsKICAgICAgdFswXSA9IGNsb2NrKCk7CiAgICAgIHJ0ID0gSlNfTmV3UnVudGltZSgpOwogICAgICB0WzFdID0gY2xvY2soKTsKICAgICAgY3R4ID0gSlNfTmV3Q29udGV4dChydCk7CiAgICAgIHRbMl0gPSBjbG9jaygpOwogICAgICBKU19GcmVlQ29udGV4dChjdHgpOwogICAgICB0WzNdID0gY2xvY2soKTsKICAgICAgSlNfRnJlZVJ1bnRpbWUocnQpOwogICAgICB0WzRdID0gY2xvY2soKTsKICAgICAgZm9yKGogPSA0OyBqID4gMDsgai0tKSB7CiAgICAgICAgZG91YmxlIG1zID0gMTAwMC4wICogKHRbal0gLSB0W2ogLSAxXSkgLyBDTE9DS1NfUEVSX1NFQzsKICAgICAgICBpZihpID09IDAgfHwgYmVzdFtqXSA+IG1zKQogICAgICAgICAgYmVzdFtqXSA9IG1zOwogICAgICB9CiAgICB9CiAgICBwcmludGYoIlxuSW5zdGFudGlhdGlvbiB0aW1lcyAobXMpOiAlLjNmID0gJS4zZislLjNmKyUuM2YrJS4zZlxuIiwgYmVzdFsxXSArIGJlc3RbMl0gKyBiZXN0WzNdICsgYmVzdFs0XSwgYmVzdFsxXSwgYmVzdFsyXSwgYmVzdFszXSwgYmVzdFs0XSk7CiAgfQogIHJldHVybiAwOwpmYWlsOgogIGpzX3N0ZF9mcmVlX2hhbmRsZXJzKHJ0KTsKICBKU19GcmVlQ29udGV4dChjdHgpOwogIEpTX0ZyZWVSdW50aW1lKHJ0KTsKICByZXR1cm4gMTsKfQoAAAAAAAAAAOCyAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAA3JQAAAAAAADclAAAAAAAAAAAAAAAA8L8"
				],
				[
					583,
					1,
					"insert",
					{
						"characters": "JS_IdsO"
					},
					"BwAAAE0kAAAAAAAATiQAAAAAAAAAAAAATiQAAAAAAABPJAAAAAAAAAAAAABPJAAAAAAAAFAkAAAAAAAAAAAAAFAkAAAAAAAAUSQAAAAAAAAAAAAAUSQAAAAAAABSJAAAAAAAAAAAAABSJAAAAAAAAFMkAAAAAAAAAAAAAFMkAAAAAAAAVCQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABNJAAAAAAAAE0kAAAAAAAAAAAAAAAA8L8"
				],
				[
					584,
					2,
					"left_delete",
					null,
					"AgAAAFMkAAAAAAAAUyQAAAAAAAABAAAAT1IkAAAAAAAAUiQAAAAAAAABAAAAcw",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABUJAAAAAAAAFQkAAAAAAAAAAAAAAAA8L8"
				],
				[
					585,
					1,
					"insert",
					{
						"characters": "s"
					},
					"AQAAAFIkAAAAAAAAUyQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABSJAAAAAAAAFIkAAAAAAAAAAAAAAAA8L8"
				],
				[
					586,
					2,
					"left_delete",
					null,
					"AgAAAFIkAAAAAAAAUiQAAAAAAAABAAAAc1EkAAAAAAAAUSQAAAAAAAABAAAAZA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABTJAAAAAAAAFMkAAAAAAAAAAAAAAAA8L8"
				],
				[
					587,
					1,
					"insert",
					{
						"characters": "sObject(ctx-"
					},
					"DAAAAFEkAAAAAAAAUiQAAAAAAAAAAAAAUiQAAAAAAABTJAAAAAAAAAAAAABTJAAAAAAAAFQkAAAAAAAAAAAAAFQkAAAAAAAAVSQAAAAAAAAAAAAAVSQAAAAAAABWJAAAAAAAAAAAAABWJAAAAAAAAFckAAAAAAAAAAAAAFckAAAAAAAAWCQAAAAAAAAAAAAAWCQAAAAAAABZJAAAAAAAAAAAAABZJAAAAAAAAFokAAAAAAAAAAAAAFokAAAAAAAAWyQAAAAAAAAAAAAAWyQAAAAAAABcJAAAAAAAAAAAAABcJAAAAAAAAF0kAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABRJAAAAAAAAFEkAAAAAAAAAAAAAAAA8L8"
				],
				[
					588,
					1,
					"insert",
					{
						"characters": ">rt->current_exce"
					},
					"EQAAAF0kAAAAAAAAXiQAAAAAAAAAAAAAXiQAAAAAAABfJAAAAAAAAAAAAABfJAAAAAAAAGAkAAAAAAAAAAAAAGAkAAAAAAAAYSQAAAAAAAAAAAAAYSQAAAAAAABiJAAAAAAAAAAAAABiJAAAAAAAAGMkAAAAAAAAAAAAAGMkAAAAAAAAZCQAAAAAAAAAAAAAZCQAAAAAAABlJAAAAAAAAAAAAABlJAAAAAAAAGYkAAAAAAAAAAAAAGYkAAAAAAAAZyQAAAAAAAAAAAAAZyQAAAAAAABoJAAAAAAAAAAAAABoJAAAAAAAAGkkAAAAAAAAAAAAAGkkAAAAAAAAaiQAAAAAAAAAAAAAaiQAAAAAAABrJAAAAAAAAAAAAABrJAAAAAAAAGwkAAAAAAAAAAAAAGwkAAAAAAAAbSQAAAAAAAAAAAAAbSQAAAAAAABuJAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABdJAAAAAAAAF0kAAAAAAAAAAAAAAAA8L8"
				],
				[
					589,
					1,
					"insert",
					{
						"characters": "ption)"
					},
					"BgAAAG4kAAAAAAAAbyQAAAAAAAAAAAAAbyQAAAAAAABwJAAAAAAAAAAAAABwJAAAAAAAAHEkAAAAAAAAAAAAAHEkAAAAAAAAciQAAAAAAAAAAAAAciQAAAAAAABzJAAAAAAAAAAAAABzJAAAAAAAAHQkAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABuJAAAAAAAAG4kAAAAAAAAAAAAAAAA8L8"
				],
				[
					590,
					1,
					"insert",
					{
						"characters": " ?"
					},
					"AgAAAHQkAAAAAAAAdSQAAAAAAAAAAAAAdSQAAAAAAAB2JAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAB0JAAAAAAAAHQkAAAAAAAAAAAAAAAA8L8"
				],
				[
					591,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAHYkAAAAAAAAdyQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAB2JAAAAAAAAHYkAAAAAAAAAAAAAAAA8L8"
				],
				[
					594,
					1,
					"insert",
					{
						"characters": " :"
					},
					"AgAAALIkAAAAAAAAsyQAAAAAAAAAAAAAsyQAAAAAAAC0JAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACyJAAAAAAAALIkAAAAAAAAAAAAAAAA8L8"
				],
				[
					595,
					1,
					"insert",
					{
						"characters": " JKS"
					},
					"BAAAALQkAAAAAAAAtSQAAAAAAAAAAAAAtSQAAAAAAAC2JAAAAAAAAAAAAAC2JAAAAAAAALckAAAAAAAAAAAAALckAAAAAAAAuCQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAC0JAAAAAAAALQkAAAAAAAAAAAAAAAA8L8"
				],
				[
					596,
					2,
					"left_delete",
					null,
					"AgAAALckAAAAAAAAtyQAAAAAAAABAAAAU7YkAAAAAAAAtiQAAAAAAAABAAAASw",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAC4JAAAAAAAALgkAAAAAAAAAAAAAAAA8L8"
				],
				[
					597,
					1,
					"insert",
					{
						"characters": "S_UNDEFINED"
					},
					"CwAAALYkAAAAAAAAtyQAAAAAAAAAAAAAtyQAAAAAAAC4JAAAAAAAAAAAAAC4JAAAAAAAALkkAAAAAAAAAAAAALkkAAAAAAAAuiQAAAAAAAAAAAAAuiQAAAAAAAC7JAAAAAAAAAAAAAC7JAAAAAAAALwkAAAAAAAAAAAAALwkAAAAAAAAvSQAAAAAAAAAAAAAvSQAAAAAAAC+JAAAAAAAAAAAAAC+JAAAAAAAAL8kAAAAAAAAAAAAAL8kAAAAAAAAwCQAAAAAAAAAAAAAwCQAAAAAAADBJAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAC2JAAAAAAAALYkAAAAAAAAAAAAAAAA8L8"
				]
			]
		},
		{
			"file": "quickjs/quickjs.c",
			"settings":
			{
				"buffer_size": 1522746,
				"line_ending": "Unix"
			},
			"undo_stack":
			[
			]
		},
		{
			"file": "quickjs/qjs-modules/quickjs-internal.h",
			"settings":
			{
				"buffer_size": 37512,
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					1,
					1,
					"revert",
					null,
					"AwAAAAAAAAAAAAAAAAAAAAAAAACBkgAAI2lmbmRlZiBRSlNfTU9EVUxFU19JTlRFUk5BTF9ICiNkZWZpbmUgUUpTX01PRFVMRVNfSU5URVJOQUxfSAoKI2luY2x1ZGUgPGxpc3QuaD4KI2luY2x1ZGUgPGN1dGlscy5oPgojaW5jbHVkZSA8cXVpY2tqcy5oPgojaW5jbHVkZSA8c3RkZGVmLmg+CiNpbmNsdWRlIDxzeXMvdHlwZXMuaD4KCiNpbmNsdWRlIDxxdWlja2pzLWNvbmZpZy5oPgoKI2lmZGVmIENPTkZJR19CSUdOVU0KI2luY2x1ZGUgPGxpYmJmLmg+CiNlbmRpZgojaWZkZWYgQ09ORklHX0RFQlVHR0VSCiNpbmNsdWRlIDxxdWlja2pzLWRlYnVnZ2VyLmg+CiNlbmRpZgojaWZkZWYgVVNFX1dPUktFUgojaW5jbHVkZSA8cHRocmVhZC5oPgojZW5kaWYKCmVudW0gSlNDbGFzc0lkcyB7CiAgLyogY2xhc3NpZCB0YWcgICAgICAgICovIC8qIHVuaW9uIHVzYWdlICAgfCBwcm9wZXJ0aWVzICovCiAgSlNfQ0xBU1NfT0JKRUNUID0gMSwgICAgIC8qIG11c3QgYmUgZmlyc3QgKi8KICBKU19DTEFTU19BUlJBWSwgICAgICAgICAgLyogdS5hcnJheSAgICAgICB8IGxlbmd0aCAqLwogIEpTX0NMQVNTX0VSUk9SLAogIEpTX0NMQVNTX05VTUJFUiwgICAgICAgICAgIC8qIHUub2JqZWN0X2RhdGEgKi8KICBKU19DTEFTU19TVFJJTkcsICAgICAgICAgICAvKiB1Lm9iamVjdF9kYXRhICovCiAgSlNfQ0xBU1NfQk9PTEVBTiwgICAgICAgICAgLyogdS5vYmplY3RfZGF0YSAqLwogIEpTX0NMQVNTX1NZTUJPTCwgICAgICAgICAgIC8qIHUub2JqZWN0X2RhdGEgKi8KICBKU19DTEFTU19BUkdVTUVOVFMsICAgICAgICAvKiB1LmFycmF5ICAgICAgIHwgbGVuZ3RoICovCiAgSlNfQ0xBU1NfTUFQUEVEX0FSR1VNRU5UUywgLyogICAgICAgICAgICAgICB8IGxlbmd0aCAqLwogIEpTX0NMQVNTX0RBVEUsICAgICAgICAgICAgIC8qIHUub2JqZWN0X2RhdGEgKi8KICBKU19DTEFTU19NT0RVTEVfTlMsCiAgSlNfQ0xBU1NfQ19GVU5DVElPTiwgICAgICAgICAgLyogdS5jZnVuYyAqLwogIEpTX0NMQVNTX0JZVEVDT0RFX0ZVTkNUSU9OLCAgIC8qIHUuZnVuYyAqLwogIEpTX0NMQVNTX0JPVU5EX0ZVTkNUSU9OLCAgICAgIC8qIHUuYm91bmRfZnVuY3Rpb24gKi8KICBKU19DTEFTU19DX0ZVTkNUSU9OX0RBVEEsICAgICAvKiB1LmNfZnVuY3Rpb25fZGF0YV9yZWNvcmQgKi8KICBKU19DTEFTU19DX0NMT1NVUkUsICAgICAgICAgICAvKiB1LmNfY2xvc3VyZV9yZWNvcmQgKi8KICBKU19DTEFTU19HRU5FUkFUT1JfRlVOQ1RJT04sICAvKiB1LmZ1bmMgKi8KICBKU19DTEFTU19GT1JfSU5fSVRFUkFUT1IsICAgICAvKiB1LmZvcl9pbl9pdGVyYXRvciAqLwogIEpTX0NMQVNTX1JFR0VYUCwgICAgICAgICAgICAgIC8qIHUucmVnZXhwICovCiAgSlNfQ0xBU1NfQVJSQVlfQlVGRkVSLCAgICAgICAgLyogdS5hcnJheV9idWZmZXIgKi8KICBKU19DTEFTU19TSEFSRURfQVJSQVlfQlVGRkVSLCAvKiB1LmFycmF5X2J1ZmZlciAqLwogIEpTX0NMQVNTX1VJTlQ4Q19BUlJBWSwgICAgICAgIC8qIHUuYXJyYXkgKHR5cGVkX2FycmF5KSAqLwogIEpTX0NMQVNTX0lOVDhfQVJSQVksICAgICAgICAgIC8qIHUuYXJyYXkgKHR5cGVkX2FycmF5KSAqLwogIEpTX0NMQVNTX1VJTlQ4X0FSUkFZLCAgICAgICAgIC8qIHUuYXJyYXkgKHR5cGVkX2FycmF5KSAqLwogIEpTX0NMQVNTX0lOVDE2X0FSUkFZLCAgICAgICAgIC8qIHUuYXJyYXkgKHR5cGVkX2FycmF5KSAqLwogIEpTX0NMQVNTX1VJTlQxNl9BUlJBWSwgICAgICAgIC8qIHUuYXJyYXkgKHR5cGVkX2FycmF5KSAqLwogIEpTX0NMQVNTX0lOVDMyX0FSUkFZLCAgICAgICAgIC8qIHUuYXJyYXkgKHR5cGVkX2FycmF5KSAqLwogIEpTX0NMQVNTX1VJTlQzMl9BUlJBWSwgICAgICAgIC8qIHUuYXJyYXkgKHR5cGVkX2FycmF5KSAqLwojaWZkZWYgQ09ORklHX0JJR05VTQogIEpTX0NMQVNTX0JJR19JTlQ2NF9BUlJBWSwgIC8qIHUuYXJyYXkgKHR5cGVkX2FycmF5KSAqLwogIEpTX0NMQVNTX0JJR19VSU5UNjRfQVJSQVksIC8qIHUuYXJyYXkgKHR5cGVkX2FycmF5KSAqLwojZW5kaWYKICBKU19DTEFTU19GTE9BVDMyX0FSUkFZLCAvKiB1LmFycmF5ICh0eXBlZF9hcnJheSkgKi8KICBKU19DTEFTU19GTE9BVDY0X0FSUkFZLCAvKiB1LmFycmF5ICh0eXBlZF9hcnJheSkgKi8KICBKU19DTEFTU19EQVRBVklFVywgICAgICAvKiB1LnR5cGVkX2FycmF5ICovCiNpZmRlZiBDT05GSUdfQklHTlVNCiAgSlNfQ0xBU1NfQklHX0lOVCwgICAgICAvKiB1Lm9iamVjdF9kYXRhICovCiAgSlNfQ0xBU1NfQklHX0ZMT0FULCAgICAvKiB1Lm9iamVjdF9kYXRhICovCiAgSlNfQ0xBU1NfRkxPQVRfRU5WLCAgICAvKiB1LmZsb2F0X2VudiAqLwogIEpTX0NMQVNTX0JJR19ERUNJTUFMLCAgLyogdS5vYmplY3RfZGF0YSAqLwogIEpTX0NMQVNTX09QRVJBVE9SX1NFVCwgLyogdS5vcGVyYXRvcl9zZXQgKi8KI2VuZGlmCiAgSlNfQ0xBU1NfTUFQLCAgICAgICAgICAgICAgICAgICAgICAvKiB1Lm1hcF9zdGF0ZSAqLwogIEpTX0NMQVNTX1NFVCwgICAgICAgICAgICAgICAgICAgICAgLyogdS5tYXBfc3RhdGUgKi8KICBKU19DTEFTU19XRUFLTUFQLCAgICAgICAgICAgICAgICAgIC8qIHUubWFwX3N0YXRlICovCiAgSlNfQ0xBU1NfV0VBS1NFVCwgICAgICAgICAgICAgICAgICAvKiB1Lm1hcF9zdGF0ZSAqLwogIEpTX0NMQVNTX01BUF9JVEVSQVRPUiwgICAgICAgICAgICAgLyogdS5tYXBfaXRlcmF0b3JfZGF0YSAqLwogIEpTX0NMQVNTX1NFVF9JVEVSQVRPUiwgICAgICAgICAgICAgLyogdS5tYXBfaXRlcmF0b3JfZGF0YSAqLwogIEpTX0NMQVNTX0FSUkFZX0lURVJBVE9SLCAgICAgICAgICAgLyogdS5hcnJheV9pdGVyYXRvcl9kYXRhICovCiAgSlNfQ0xBU1NfU1RSSU5HX0lURVJBVE9SLCAgICAgICAgICAvKiB1LmFycmF5X2l0ZXJhdG9yX2RhdGEgKi8KICBKU19DTEFTU19SRUdFWFBfU1RSSU5HX0lURVJBVE9SLCAgIC8qIHUucmVnZXhwX3N0cmluZ19pdGVyYXRvcl9kYXRhICovCiAgSlNfQ0xBU1NfR0VORVJBVE9SLCAgICAgICAgICAgICAgICAvKiB1LmdlbmVyYXRvcl9kYXRhICovCiAgSlNfQ0xBU1NfUFJPWFksICAgICAgICAgICAgICAgICAgICAvKiB1LnByb3h5X2RhdGEgKi8KICBKU19DTEFTU19QUk9NSVNFLCAgICAgICAgICAgICAgICAgIC8qIHUucHJvbWlzZV9kYXRhICovCiAgSlNfQ0xBU1NfUFJPTUlTRV9SRVNPTFZFX0ZVTkNUSU9OLCAvKiB1LnByb21pc2VfZnVuY3Rpb25fZGF0YSAqLwogIEpTX0NMQVNTX1BST01JU0VfUkVKRUNUX0ZVTkNUSU9OLCAgLyogdS5wcm9taXNlX2Z1bmN0aW9uX2RhdGEgKi8KICBKU19DTEFTU19BU1lOQ19GVU5DVElPTiwgICAgICAgICAgIC8qIHUuZnVuYyAqLwogIEpTX0NMQVNTX0FTWU5DX0ZVTkNUSU9OX1JFU09MVkUsICAgLyogdS5hc3luY19mdW5jdGlvbl9kYXRhICovCiAgSlNfQ0xBU1NfQVNZTkNfRlVOQ1RJT05fUkVKRUNULCAgICAvKiB1LmFzeW5jX2Z1bmN0aW9uX2RhdGEgKi8KICBKU19DTEFTU19BU1lOQ19GUk9NX1NZTkNfSVRFUkFUT1IsIC8qIHUuYXN5bmNfZnJvbV9zeW5jX2l0ZXJhdG9yX2RhdGEgKi8KICBKU19DTEFTU19BU1lOQ19HRU5FUkFUT1JfRlVOQ1RJT04sIC8qIHUuZnVuYyAqLwogIEpTX0NMQVNTX0FTWU5DX0dFTkVSQVRPUiwgICAgICAgICAgLyogdS5hc3luY19nZW5lcmF0b3JfZGF0YSAqLwoKICBKU19DTEFTU19JTklUX0NPVU5ULCAvKiBsYXN0IGVudHJ5IGZvciBwcmVkZWZpbmVkIGNsYXNzZXMgKi8KfTsKCnR5cGVkZWYgZW51bSBKU0Vycm9yRW51bSB7CiAgSlNfRVZBTF9FUlJPUiwKICBKU19SQU5HRV9FUlJPUiwKICBKU19SRUZFUkVOQ0VfRVJST1IsCiAgSlNfU1lOVEFYX0VSUk9SLAogIEpTX1RZUEVfRVJST1IsCiAgSlNfVVJJX0VSUk9SLAogIEpTX0lOVEVSTkFMX0VSUk9SLAogIEpTX0FHR1JFR0FURV9FUlJPUiwKICBKU19OQVRJVkVfRVJST1JfQ09VTlQKfSBKU0Vycm9yRW51bTsKCnR5cGVkZWYgZW51bSBPUENvZGVFbnVtIE9QQ29kZUVudW07Cgp0eXBlZGVmIHN0cnVjdCBKU1N0cmluZyBKU1N0cmluZzsKdHlwZWRlZiBzdHJ1Y3QgSlNTdHJpbmcgSlNBdG9tU3RydWN0Owp0eXBlZGVmIHN0cnVjdCBKU1NoYXBlIEpTU2hhcGU7Cgp0eXBlZGVmIGVudW0gewogIEpTX0dDX1BIQVNFX05PTkUsCiAgSlNfR0NfUEhBU0VfREVDUkVGLAogIEpTX0dDX1BIQVNFX1JFTU9WRV9DWUNMRVMsCn0gSlNHQ1BoYXNlRW51bTsKCiNpZmRlZiBDT05GSUdfQklHTlVNCi8qIGZ1bmN0aW9uIHBvaW50ZXJzIGFyZSB1c2VkIGZvciBudW1lcmljIG9wZXJhdGlvbnMgc28gdGhhdCBpdCBpcwogICBwb3NzaWJsZSB0byByZW1vdmUgc29tZSBudW1lcmljIHR5cGVzICovCnR5cGVkZWYgc3RydWN0IHsKICBKU1ZhbHVlICgqdG9fc3RyaW5nKShKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHZhbCk7CiAgSlNWYWx1ZSAoKmZyb21fc3RyaW5nKShKU0NvbnRleHQqIGN0eCwgY29uc3QgY2hhciogYnVmLCBpbnQgcmFkaXgsIGludCBmbGFncywgc2xpbWJfdCogcGV4cG9uZW50KTsKICBpbnQgKCp1bmFyeV9hcml0aCkoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWUqIHByZXMsIE9QQ29kZUVudW0gb3AsIEpTVmFsdWUgb3AxKTsKICBpbnQgKCpiaW5hcnlfYXJpdGgpKEpTQ29udGV4dCogY3R4LCBPUENvZGVFbnVtIG9wLCBKU1ZhbHVlKiBwcmVzLCBKU1ZhbHVlIG9wMSwgSlNWYWx1ZSBvcDIpOwogIGludCAoKmNvbXBhcmUpKEpTQ29udGV4dCogY3R4LCBPUENvZGVFbnVtIG9wLCBKU1ZhbHVlIG9wMSwgSlNWYWx1ZSBvcDIpOwogIC8qIG9ubHkgZm9yIGJpZ2Zsb2F0OiAqLwogIEpTVmFsdWUgKCptdWxfcG93MTBfdG9fZmxvYXQ2NCkoSlNDb250ZXh0KiBjdHgsIGNvbnN0IGJmX3QqIGEsIGludDY0X3QgZXhwb25lbnQpOwogIGludCAoKm11bF9wb3cxMCkoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWUqIHNwKTsKfSBKU051bWVyaWNPcGVyYXRpb25zOwojZW5kaWYKCnR5cGVkZWYgc3RydWN0IEpTUnVudGltZSB7CiAgSlNNYWxsb2NGdW5jdGlvbnMgbWY7CiAgSlNNYWxsb2NTdGF0ZSBtYWxsb2Nfc3RhdGU7CiAgY29uc3QgY2hhciogcnRfaW5mbzsKICBpbnQgYXRvbV9oYXNoX3NpemU7CiAgaW50IGF0b21fY291bnQ7CiAgaW50IGF0b21fc2l6ZTsKICBpbnQgYXRvbV9jb3VudF9yZXNpemU7CiAgdWludDMyX3QqIGF0b21faGFzaDsKICBKU0F0b21TdHJ1Y3QqKiBhdG9tX2FycmF5OwogIGludCBhdG9tX2ZyZWVfaW5kZXg7CiAgaW50IGNsYXNzX2NvdW50OwogIEpTQ2xhc3MqIGNsYXNzX2FycmF5OwogIHN0cnVjdCBsaXN0X2hlYWQgY29udGV4dF9saXN0OwogIHN0cnVjdCBsaXN0X2hlYWQgZ2Nfb2JqX2xpc3Q7CiAgc3RydWN0IGxpc3RfaGVhZCBnY196ZXJvX3JlZl9jb3VudF9saXN0OwogIHN0cnVjdCBsaXN0X2hlYWQgdG1wX29ial9saXN0OwogIEpTR0NQaGFzZUVudW0gZ2NfcGhhc2UgOiA4OwogIHNpemVfdCBtYWxsb2NfZ2NfdGhyZXNob2xkOwojaWZkZWYgRFVNUF9MRUFLUwogIHN0cnVjdCBsaXN0X2hlYWQgc3RyaW5nX2xpc3Q7CiNlbmRpZgogIHVpbnRwdHJfdCBzdGFja19zaXplOwogIHVpbnRwdHJfdCBzdGFja190b3A7CiAgdWludHB0cl90IHN0YWNrX2xpbWl0OwogIEpTVmFsdWUgY3VycmVudF9leGNlcHRpb247CiAgQk9PTCBpbl9vdXRfb2ZfbWVtb3J5IDogODsKICBzdHJ1Y3QgSlNTdGFja0ZyYW1lKiBjdXJyZW50X3N0YWNrX2ZyYW1lOwogIEpTSW50ZXJydXB0SGFuZGxlciogaW50ZXJydXB0X2hhbmRsZXI7CiAgdm9pZCogaW50ZXJydXB0X29wYXF1ZTsKICBKU0hvc3RQcm9taXNlUmVqZWN0aW9uVHJhY2tlciogaG9zdF9wcm9taXNlX3JlamVjdGlvbl90cmFja2VyOwogIHZvaWQqIGhvc3RfcHJvbWlzZV9yZWplY3Rpb25fdHJhY2tlcl9vcGFxdWU7CiAgc3RydWN0IGxpc3RfaGVhZCBqb2JfbGlzdDsKICBKU01vZHVsZU5vcm1hbGl6ZUZ1bmMqIG1vZHVsZV9ub3JtYWxpemVfZnVuYzsKICBKU01vZHVsZUxvYWRlckZ1bmMqIG1vZHVsZV9sb2FkZXJfZnVuYzsKICB2b2lkKiBtb2R1bGVfbG9hZGVyX29wYXF1ZTsKICBCT09MIGNhbl9ibG9jayA6IDg7CiAgSlNTaGFyZWRBcnJheUJ1ZmZlckZ1bmN0aW9ucyBzYWJfZnVuY3M7CiAgaW50IHNoYXBlX2hhc2hfYml0czsKICBpbnQgc2hhcGVfaGFzaF9zaXplOwogIGludCBzaGFwZV9oYXNoX2NvdW50OwogIEpTU2hhcGUqKiBzaGFwZV9oYXNoOwojaWZkZWYgQ09ORklHX0JJR05VTQogIGJmX2NvbnRleHRfdCBiZl9jdHg7CiAgSlNOdW1lcmljT3BlcmF0aW9ucyBiaWdpbnRfb3BzOwogIEpTTnVtZXJpY09wZXJhdGlvbnMgYmlnZmxvYXRfb3BzOwogIEpTTnVtZXJpY09wZXJhdGlvbnMgYmlnZGVjaW1hbF9vcHM7CiAgdWludDMyX3Qgb3BlcmF0b3JfY291bnQ7CiNlbmRpZgogIHZvaWQqIHVzZXJfb3BhcXVlOwp9IEpTUnVudGltZTsKCnN0cnVjdCBKU0NsYXNzIHsKICB1aW50MzJfdCBjbGFzc19pZDsgLyogMCBtZWFucyBmcmVlIGVudHJ5ICovCiAgSlNBdG9tIGNsYXNzX25hbWU7CiAgSlNDbGFzc0ZpbmFsaXplciogZmluYWxpemVyOwogIEpTQ2xhc3NHQ01hcmsqIGdjX21hcms7CiAgSlNDbGFzc0NhbGwqIGNhbGw7CiAgLyogcG9pbnRlcnMgZm9yIGV4b3RpYyBiZWhhdmlvciwgY2FuIGJlIE5VTEwgaWYgbm9uZSBhcmUgcHJlc2VudCAqLwogIGNvbnN0IEpTQ2xhc3NFeG90aWNNZXRob2RzKiBleG90aWM7Cn07CgojZGVmaW5lIEpTX01PREVfU1RSSUNUICgxIDw8IDApCiNkZWZpbmUgSlNfTU9ERV9TVFJJUCAoMSA8PCAxKQojZGVmaW5lIEpTX01PREVfTUFUSCAoMSA8PCAyKQoKdHlwZWRlZiBzdHJ1Y3QgSlNTdGFja0ZyYW1lIHsKICBzdHJ1Y3QgSlNTdGFja0ZyYW1lKiBwcmV2X2ZyYW1lOwogIEpTVmFsdWUgY3VyX2Z1bmM7CiAgSlNWYWx1ZSogYXJnX2J1ZjsgICAgICAgICAgICAgIC8qIGFyZ3VtZW50cyAqLwogIEpTVmFsdWUqIHZhcl9idWY7ICAgICAgICAgICAgICAvKiB2YXJpYWJsZXMgKi8KICBzdHJ1Y3QgbGlzdF9oZWFkIHZhcl9yZWZfbGlzdDsgLyogbGlzdCBvZiBKU1ZhclJlZi5saW5rICovCiAgY29uc3QgdWludDhfdCogY3VyX3BjOyAgICAgICAgIC8qIGJ5dGVjb2RlIGZ1bmN0aW9ucyA6IFBDIG9mIHRoZSBpbnN0cnVjdGlvbiBhZnRlciB0aGUgY2FsbCAqLwogIGludCBhcmdfY291bnQ7CiAgaW50IGpzX21vZGU7IC8qIDAgb3IgSlNfTU9ERV9NQVRIIGZvciBDIGZ1bmN0aW9ucyAqLwogIC8qIG9ubHkgdXNlZCBpbiBnZW5lcmF0b3JzLiBDdXJyZW50IHN0YWNrIHBvaW50ZXIgdmFsdWUgb3IgTlVMTCBpZiB0aGUKICAgKiBmdW5jdGlvbiBpcyBydW5uaW5nLiAqLwogIEpTVmFsdWUqIGN1cl9zcDsKfSBKU1N0YWNrRnJhbWU7Cgp0eXBlZGVmIGVudW0gewogIEpTX0dDX09CSl9UWVBFX0pTX09CSkVDVCwKICBKU19HQ19PQkpfVFlQRV9GVU5DVElPTl9CWVRFQ09ERSwKICBKU19HQ19PQkpfVFlQRV9TSEFQRSwKICBKU19HQ19PQkpfVFlQRV9WQVJfUkVGLAogIEpTX0dDX09CSl9UWVBFX0FTWU5DX0ZVTkNUSU9OLAogIEpTX0dDX09CSl9UWVBFX0pTX0NPTlRFWFQsCn0gSlNHQ09iamVjdFR5cGVFbnVtOwoKc3RydWN0IEpTR0NPYmplY3RIZWFkZXIgewogIGludCByZWZfY291bnQ7CiAgSlNHQ09iamVjdFR5cGVFbnVtIGdjX29ial90eXBlIDogNDsKICB1aW50OF90IG1hcmsgOiA0OwogIHVpbnQ4X3QgZHVtbXkxOwogIHVpbnQxNl90IGR1bW15MjsKICBzdHJ1Y3QgbGlzdF9oZWFkIGxpbms7Cn07Cgp0eXBlZGVmIHN0cnVjdCBKU1ZhclJlZiB7CiAgdW5pb24gewogICAgSlNHQ09iamVjdEhlYWRlciBoZWFkZXI7CiAgICBzdHJ1Y3QgewogICAgICBpbnQgX19nY19yZWZfY291bnQ7CiAgICAgIHVpbnQ4X3QgX19nY19tYXJrOwogICAgICAvKiAwIDogdGhlIEpTVmFyUmVmIGlzIG9uIHRoZSBzdGFjay4gaGVhZGVyLmxpbmsgaXMgYW4gZWxlbWVudAogICAgICAgICBvZiBKU1N0YWNrRnJhbWUudmFyX3JlZl9saXN0LgogICAgICAgICAxIDogdGhlIEpTVmFyUmVmIGlzIGRldGFjaGVkLiBoZWFkZXIubGluayBoYXMgdGhlIG5vcm1hbCBtZWFubmluZwogICAgICAqLwogICAgICB1aW50OF90IGlzX2RldGFjaGVkIDogMTsKICAgICAgdWludDhfdCBpc19hcmcgOiAxOwogICAgICB1aW50MTZfdCB2YXJfaWR4OyAvKiBpbmRleCBvZiB0aGUgY29ycmVzcG9uZGluZyBmdW5jdGlvbiB2YXJpYWJsZSBvbiB0aGUKICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhY2sgKi8KICAgIH07CiAgfTsKICBKU1ZhbHVlKiBwdmFsdWU7IC8qIHBvaW50ZXIgdG8gdGhlIHZhbHVlLCBlaXRoZXIgb24gdGhlIHN0YWNrIG9yIHRvICd2YWx1ZScgKi8KICBKU1ZhbHVlIHZhbHVlOyAgIC8qIHVzZWQgd2hlbiB0aGUgdmFyaWFibGUgaXMgbm8gbG9uZ2VyIG9uIHRoZSBzdGFjayAqLwp9IEpTVmFyUmVmOwoKdHlwZWRlZiBzdHJ1Y3QgSlNGbG9hdEVudiB7CiAgdWludHB0cl90IHByZWM7CiAgdWludDMyX3QgZmxhZ3M7CiAgdW5zaWduZWQgaW50IHN0YXR1czsKfSBKU0Zsb2F0RW52OwoKI2lmZGVmIENPTkZJR19CSUdOVU0KLyogdGhlIHNhbWUgc3RydWN0dXJlIGlzIHVzZWQgZm9yIGJpZyBpbnRlZ2VycyBhbmQgYmlnIGZsb2F0cy4gQmlnCiAgIGludGVnZXJzIGFyZSBuZXZlciBpbmZpbml0ZSBvciBOYU5zICovCnR5cGVkZWYgc3RydWN0IEpTQmlnRmxvYXQgewogIEpTUmVmQ291bnRIZWFkZXIgaGVhZGVyOyAvKiBtdXN0IGNvbWUgZmlyc3QsIDMyLWJpdCAqLwogIGJmX3QgbnVtOwp9IEpTQmlnRmxvYXQ7Cgp0eXBlZGVmIHN0cnVjdCBKU0JpZ0RlY2ltYWwgewogIEpTUmVmQ291bnRIZWFkZXIgaGVhZGVyOyAvKiBtdXN0IGNvbWUgZmlyc3QsIDMyLWJpdCAqLwogIGJmZGVjX3QgbnVtOwp9IEpTQmlnRGVjaW1hbDsKI2VuZGlmCgp0eXBlZGVmIGVudW0gewogIEpTX0FVVE9JTklUX0lEX1BST1RPVFlQRSwKICBKU19BVVRPSU5JVF9JRF9NT0RVTEVfTlMsCiAgSlNfQVVUT0lOSVRfSURfUFJPUCwKfSBKU0F1dG9Jbml0SURFbnVtOwoKLyogbXVzdCBiZSBsYXJnZSBlbm91Z2ggdG8gaGF2ZSBhIG5lZ2xpZ2libGUgcnVudGltZSBjb3N0IGFuZCBzbWFsbCBlbm91Z2ggdG8KICogY2FsbCB0aGUgaW50ZXJydXB0IGNhbGxiYWNrIG9mdGVuLiAqLwojZGVmaW5lIEpTX0lOVEVSUlVQVF9DT1VOVEVSX0lOSVQgMTAwMDAKCnN0cnVjdCBKU0NvbnRleHQgewogIEpTR0NPYmplY3RIZWFkZXIgaGVhZGVyOyAvKiBtdXN0IGNvbWUgZmlyc3QgKi8KICBKU1J1bnRpbWUqIHJ0OwogIHN0cnVjdCBsaXN0X2hlYWQgbGluazsKCiAgdWludDE2X3QgYmluYXJ5X29iamVjdF9jb3VudDsKICBpbnQgYmluYXJ5X29iamVjdF9zaXplOwoKICBKU1NoYXBlKiBhcnJheV9zaGFwZTsgLyogaW5pdGlhbCBzaGFwZSBmb3IgQXJyYXkgb2JqZWN0cyAqLwoKICBKU1ZhbHVlKiBjbGFzc19wcm90bzsKICBKU1ZhbHVlIGZ1bmN0aW9uX3Byb3RvOwogIEpTVmFsdWUgZnVuY3Rpb25fY3RvcjsKICBKU1ZhbHVlIGFycmF5X2N0b3I7CiAgSlNWYWx1ZSByZWdleHBfY3RvcjsKICBKU1ZhbHVlIHByb21pc2VfY3RvcjsKICBKU1ZhbHVlIG5hdGl2ZV9lcnJvcl9wcm90b1tKU19OQVRJVkVfRVJST1JfQ09VTlRdOwogIEpTVmFsdWUgaXRlcmF0b3JfcHJvdG87CiAgSlNWYWx1ZSBhc3luY19pdGVyYXRvcl9wcm90bzsKICBKU1ZhbHVlIGFycmF5X3Byb3RvX3ZhbHVlczsKICBKU1ZhbHVlIHRocm93X3R5cGVfZXJyb3I7CiAgSlNWYWx1ZSBldmFsX29iajsKCiAgSlNWYWx1ZSBnbG9iYWxfb2JqOyAgICAgLyogZ2xvYmFsIG9iamVjdCAqLwogIEpTVmFsdWUgZ2xvYmFsX3Zhcl9vYmo7IC8qIGNvbnRhaW5zIHRoZSBnbG9iYWwgbGV0L2NvbnN0IGRlZmluaXRpb25zICovCgogIHVpbnQ2NF90IHJhbmRvbV9zdGF0ZTsKI2lmZGVmIENPTkZJR19CSUdOVU0KICAvKmJmX2NvbnRleHRfdCovIHZvaWQqIGJmX2N0eDsgLyogcG9pbnRzIHRvIHJ0LT5iZl9jdHgsIHNoYXJlZCBieSBhbGwgY29udGV4dHMgKi8KICBKU0Zsb2F0RW52IGZwX2VudjsgICAgICAgICAgICAgLyogZ2xvYmFsIEZQIGVudmlyb25tZW50ICovCiAgQk9PTCBiaWdudW1fZXh0IDogODsgICAgICAgICAgIC8qIGVuYWJsZSBtYXRoIG1vZGUgKi8KICBCT09MIGFsbG93X29wZXJhdG9yX292ZXJsb2FkaW5nIDogODsKI2VuZGlmCiAgLyogd2hlbiB0aGUgY291bnRlciByZWFjaGVzIHplcm8sIEpTUnV0aW1lLmludGVycnVwdF9oYW5kbGVyIGlzIGNhbGxlZCAqLwogIGludCBpbnRlcnJ1cHRfY291bnRlcjsKICBCT09MIGlzX2Vycm9yX3Byb3BlcnR5X2VuYWJsZWQ7CgogIHN0cnVjdCBsaXN0X2hlYWQgbG9hZGVkX21vZHVsZXM7IC8qIGxpc3Qgb2YgSlNNb2R1bGVEZWYubGluayAqLwoKICAvKiBpZiBOVUxMLCBSZWdFeHAgY29tcGlsYXRpb24gaXMgbm90IHN1cHBvcnRlZCAqLwogIEpTVmFsdWUgKCpjb21waWxlX3JlZ2V4cCkoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBwYXR0ZXJuLCBKU1ZhbHVlQ29uc3QgZmxhZ3MpOwogIC8qIGlmIE5VTEwsIGV2YWwgaXMgbm90IHN1cHBvcnRlZCAqLwogIEpTVmFsdWUgKCpldmFsX2ludGVybmFsKShKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfb2JqLCBjb25zdCBjaGFyKiBpbnB1dCwgc2l6ZV90IGlucHV0X2xlbiwgY29uc3QgY2hhciogZmlsZW5hbWUsIGludCBmbGFncywgaW50IHNjb3BlX2lkeCk7CiAgdm9pZCogdXNlcl9vcGFxdWU7Cn07CgpzdHJ1Y3QgSlNTdHJpbmcgewogIEpTUmVmQ291bnRIZWFkZXIgaGVhZGVyOwogIHVpbnQzMl90IGxlbiA6IDMxOwogIHVpbnQ4X3QgaXNfd2lkZV9jaGFyIDogMTsKICB1aW50MzJfdCBoYXNoIDogMzA7CiAgdWludDhfdCBhdG9tX3R5cGUgOiAyOwogIHVpbnQzMl90IGhhc2hfbmV4dDsKI2lmZGVmIERVTVBfTEVBS1MKICBzdHJ1Y3QgbGlzdF9oZWFkIGxpbms7CiNlbmRpZgogIHVuaW9uIHsKICAgIHVpbnQ4X3Qgc3RyOFswXTsKICAgIHVpbnQxNl90IHN0cjE2WzBdOwogIH0gdTsKfTsKCnR5cGVkZWYgc3RydWN0IEpTQ2xvc3VyZVZhciB7CiAgdWludDhfdCBpc19sb2NhbCA6IDE7CiAgdWludDhfdCBpc19hcmcgOiAxOwogIHVpbnQ4X3QgaXNfY29uc3QgOiAxOwogIHVpbnQ4X3QgaXNfbGV4aWNhbCA6IDE7CiAgdWludDhfdCB2YXJfa2luZCA6IDQ7IC8qIHNlZSBKU1ZhcktpbmRFbnVtICovCiAgLyogOCBiaXRzIGF2YWlsYWJsZSAqLwogIHVpbnQxNl90IHZhcl9pZHg7IC8qIGlzX2xvY2FsID0gVFJVRTogaW5kZXggdG8gYSBub3JtYWwgdmFyaWFibGUgb2YgdGhlCiAgICAgICAgICAgICAgICAgIHBhcmVudCBmdW5jdGlvbi4gb3RoZXJ3aXNlOiBpbmRleCB0byBhIGNsb3N1cmUKICAgICAgICAgICAgICAgICAgdmFyaWFibGUgb2YgdGhlIHBhcmVudCBmdW5jdGlvbiAqLwogIEpTQXRvbSB2YXJfbmFtZTsKfSBKU0Nsb3N1cmVWYXI7Cgp0eXBlZGVmIHN0cnVjdCBKU1ZhclNjb3BlIHsKICBpbnQgcGFyZW50OyAvKiBpbmRleCBpbnRvIGZkLT5zY29wZXMgb2YgdGhlIGVuY2xvc2luZyBzY29wZSAqLwogIGludCBmaXJzdDsgIC8qIGluZGV4IGludG8gZmQtPnZhcnMgb2YgdGhlIGxhc3QgdmFyaWFibGUgaW4gdGhpcyBzY29wZSAqLwp9IEpTVmFyU2NvcGU7Cgp0eXBlZGVmIGVudW0gewogIC8qIFhYWDogYWRkIG1vcmUgdmFyaWFibGUga2luZHMgaGVyZSBpbnN0ZWFkIG9mIHVzaW5nIGJpdCBmaWVsZHMgKi8KICBKU19WQVJfTk9STUFMLAogIEpTX1ZBUl9GVU5DVElPTl9ERUNMLCAgICAgLyogbGV4aWNhbCB2YXIgd2l0aCBmdW5jdGlvbiBkZWNsYXJhdGlvbiAqLwogIEpTX1ZBUl9ORVdfRlVOQ1RJT05fREVDTCwgLyogbGV4aWNhbCB2YXIgd2l0aCBhc3luYy9nZW5lcmF0b3IKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGRlY2xhcmF0aW9uICovCiAgSlNfVkFSX0NBVENILAogIEpTX1ZBUl9GVU5DVElPTl9OQU1FLCAvKiBmdW5jdGlvbiBleHByZXNzaW9uIG5hbWUgKi8KICBKU19WQVJfUFJJVkFURV9GSUVMRCwKICBKU19WQVJfUFJJVkFURV9NRVRIT0QsCiAgSlNfVkFSX1BSSVZBVEVfR0VUVEVSLAogIEpTX1ZBUl9QUklWQVRFX1NFVFRFUiwgICAgICAgIC8qIG11c3QgY29tZSBhZnRlciBKU19WQVJfUFJJVkFURV9HRVRURVIgKi8KICBKU19WQVJfUFJJVkFURV9HRVRURVJfU0VUVEVSLCAvKiBtdXN0IGNvbWUgYWZ0ZXIgSlNfVkFSX1BSSVZBVEVfU0VUVEVSICovCn0gSlNWYXJLaW5kRW51bTsKCi8qIFhYWDogY291bGQgdXNlIGEgZGlmZmVyZW50IHN0cnVjdHVyZSBpbiBieXRlY29kZSBmdW5jdGlvbnMgdG8gc2F2ZQogICBtZW1vcnkgKi8KdHlwZWRlZiBzdHJ1Y3QgSlNWYXJEZWYgewogIEpTQXRvbSB2YXJfbmFtZTsKICAvKiBpbmRleCBpbnRvIGZkLT5zY29wZXMgb2YgdGhpcyB2YXJpYWJsZSBsZXhpY2FsIHNjb3BlICovCiAgaW50IHNjb3BlX2xldmVsOwogIC8qIGR1cmluZyBjb21waWxhdGlvbjoKICAgICAgLSBpZiBzY29wZV9sZXZlbCA9IDA6IHNjb3BlIGluIHdoaWNoIHRoZSB2YXJpYWJsZSBpcyBkZWZpbmVkCiAgICAgIC0gaWYgc2NvcGVfbGV2ZWwgIT0gMDogaW5kZXggaW50byBmZC0+dmFycyBvZiB0aGUgbmV4dAogICAgICAgIHZhcmlhYmxlIGluIHRoZSBzYW1lIG9yIGVuY2xvc2luZyBsZXhpY2FsIHNjb3BlCiAgICAgaW4gYSBieXRlY29kZSBmdW5jdGlvbjoKICAgICBpbmRleCBpbnRvIGZkLT52YXJzIG9mIHRoZSBuZXh0CiAgICAgdmFyaWFibGUgaW4gdGhlIHNhbWUgb3IgZW5jbG9zaW5nIGxleGljYWwgc2NvcGUKICAqLwogIGludCBzY29wZV9uZXh0OwogIHVpbnQ4X3QgaXNfY29uc3QgOiAxOwogIHVpbnQ4X3QgaXNfbGV4aWNhbCA6IDE7CiAgdWludDhfdCBpc19jYXB0dXJlZCA6IDE7CiAgdWludDhfdCB2YXJfa2luZCA6IDQ7IC8qIHNlZSBKU1ZhcktpbmRFbnVtICovCiAgLyogb25seSB1c2VkIGR1cmluZyBjb21waWxhdGlvbjogZnVuY3Rpb24gcG9vbCBpbmRleCBmb3IgbGV4aWNhbAogICAgIHZhcmlhYmxlcyB3aXRoIHZhcl9raW5kID0KICAgICBKU19WQVJfRlVOQ1RJT05fREVDTC9KU19WQVJfTkVXX0ZVTkNUSU9OX0RFQ0wgb3Igc2NvcGUgbGV2ZWwgb2YKICAgICB0aGUgZGVmaW5pdGlvbiBvZiB0aGUgJ3ZhcicgdmFyaWFibGVzICh0aGV5IGhhdmUgc2NvcGVfbGV2ZWwgPQogICAgIDApICovCiAgaW50IGZ1bmNfcG9vbF9pZHggOiAyNDsgLyogb25seSB1c2VkIGR1cmluZyBjb21waWxhdGlvbiA6IGluZGV4IGluCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhlIGNvbnN0YW50IHBvb2wgZm9yIGhvaXN0ZWQgZnVuY3Rpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZpbml0aW9uICovCn0gSlNWYXJEZWY7Cgp0eXBlZGVmIGVudW0gSlNGdW5jdGlvbktpbmRFbnVtIHsKICBKU19GVU5DX05PUk1BTCA9IDAsCiAgSlNfRlVOQ19HRU5FUkFUT1IgPSAoMSA8PCAwKSwKICBKU19GVU5DX0FTWU5DID0gKDEgPDwgMSksCiAgSlNfRlVOQ19BU1lOQ19HRU5FUkFUT1IgPSAoSlNfRlVOQ19HRU5FUkFUT1IgfCBKU19GVU5DX0FTWU5DKSwKfSBKU0Z1bmN0aW9uS2luZEVudW07Cgp0eXBlZGVmIHN0cnVjdCBKU0Z1bmN0aW9uQnl0ZWNvZGUgewogIEpTR0NPYmplY3RIZWFkZXIgaGVhZGVyOyAvKiBtdXN0IGNvbWUgZmlyc3QgKi8KICB1aW50OF90IGpzX21vZGU7CiAgdWludDhfdCBoYXNfcHJvdG90eXBlIDogMTsgLyogdHJ1ZSBpZiBhIHByb3RvdHlwZSBmaWVsZCBpcyBuZWNlc3NhcnkgKi8KICB1aW50OF90IGhhc19zaW1wbGVfcGFyYW1ldGVyX2xpc3QgOiAxOwogIHVpbnQ4X3QgaXNfZGVyaXZlZF9jbGFzc19jb25zdHJ1Y3RvciA6IDE7CiAgLyogdHJ1ZSBpZiBob21lX29iamVjdCBuZWVkcyB0byBiZSBpbml0aWFsaXplZCAqLwogIHVpbnQ4X3QgbmVlZF9ob21lX29iamVjdCA6IDE7CiAgdWludDhfdCBmdW5jX2tpbmQgOiAyOwogIHVpbnQ4X3QgbmV3X3RhcmdldF9hbGxvd2VkIDogMTsKICB1aW50OF90IHN1cGVyX2NhbGxfYWxsb3dlZCA6IDE7CiAgdWludDhfdCBzdXBlcl9hbGxvd2VkIDogMTsKICB1aW50OF90IGFyZ3VtZW50c19hbGxvd2VkIDogMTsKICB1aW50OF90IGhhc19kZWJ1ZyA6IDE7CiAgdWludDhfdCBiYWNrdHJhY2VfYmFycmllciA6IDE7IC8qIHN0b3AgYmFja3RyYWNlIG9uIHRoaXMgZnVuY3Rpb24gKi8KICB1aW50OF90IHJlYWRfb25seV9ieXRlY29kZSA6IDE7CiAgLyogWFhYOiA0IGJpdHMgYXZhaWxhYmxlICovCiAgdWludDhfdCogYnl0ZV9jb2RlX2J1ZjsgLyogKHNlbGYgcG9pbnRlcikgKi8KICBpbnQgYnl0ZV9jb2RlX2xlbjsKICBKU0F0b20gZnVuY19uYW1lOwogIEpTVmFyRGVmKiB2YXJkZWZzOyAgICAgICAgIC8qIGFyZ3VtZW50cyArIGxvY2FsIHZhcmlhYmxlcyAoYXJnX2NvdW50ICsgdmFyX2NvdW50KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChzZWxmIHBvaW50ZXIpICovCiAgSlNDbG9zdXJlVmFyKiBjbG9zdXJlX3ZhcjsgLyogbGlzdCBvZiB2YXJpYWJsZXMgaW4gdGhlIGNsb3N1cmUgKHNlbGYgcG9pbnRlcikgKi8KICB1aW50MTZfdCBhcmdfY291bnQ7CiAgdWludDE2X3QgdmFyX2NvdW50OwogIHVpbnQxNl90IGRlZmluZWRfYXJnX2NvdW50OyAvKiBmb3IgbGVuZ3RoIGZ1bmN0aW9uIHByb3BlcnR5ICovCiAgdWludDE2X3Qgc3RhY2tfc2l6ZTsgICAgICAgIC8qIG1heGltdW0gc3RhY2sgc2l6ZSAqLwogIEpTQ29udGV4dCogcmVhbG07ICAgICAgICAgICAvKiBmdW5jdGlvbiByZWFsbSAqLwogIEpTVmFsdWUqIGNwb29sOyAgICAgICAgICAgICAvKiBjb25zdGFudCBwb29sIChzZWxmIHBvaW50ZXIpICovCiAgaW50IGNwb29sX2NvdW50OwogIGludCBjbG9zdXJlX3Zhcl9jb3VudDsKICBzdHJ1Y3QgewogICAgLyogZGVidWcgaW5mbywgbW92ZSB0byBzZXBhcmF0ZSBzdHJ1Y3R1cmUgdG8gc2F2ZSBtZW1vcnk/ICovCiAgICBKU0F0b20gZmlsZW5hbWU7CiAgICBpbnQgbGluZV9udW07CiAgICBpbnQgc291cmNlX2xlbjsKICAgIGludCBwYzJsaW5lX2xlbjsKICAgIHVpbnQ4X3QqIHBjMmxpbmVfYnVmOwogICAgY2hhciogc291cmNlOwogIH0gZGVidWc7CiNpZmRlZiBDT05GSUdfREVCVUdHRVIKICBzdHJ1Y3QgSlNEZWJ1Z2dlckZ1bmN0aW9uSW5mbyBkZWJ1Z2dlcjsKI2VuZGlmCn0gSlNGdW5jdGlvbkJ5dGVjb2RlOwoKdHlwZWRlZiBzdHJ1Y3QgSlNQcm9wZXJ0eSB7CiAgdW5pb24gewogICAgSlNWYWx1ZSB2YWx1ZTsgICAgICAvKiBKU19QUk9QX05PUk1BTCAqLwogICAgc3RydWN0IHsgICAgICAgICAgICAvKiBKU19QUk9QX0dFVFNFVCAqLwogICAgICBKU09iamVjdCogZ2V0dGVyOyAvKiBOVUxMIGlmIHVuZGVmaW5lZCAqLwogICAgICBKU09iamVjdCogc2V0dGVyOyAvKiBOVUxMIGlmIHVuZGVmaW5lZCAqLwogICAgfSBnZXRzZXQ7CiAgICBKU1ZhclJlZiogdmFyX3JlZjsgLyogSlNfUFJPUF9WQVJSRUYgKi8KICAgIHN0cnVjdCB7ICAgICAgICAgICAvKiBKU19QUk9QX0FVVE9JTklUICovCiAgICAgIC8qIGluIG9yZGVyIHRvIHVzZSBvbmx5IDIgcG9pbnRlcnMsIHdlIGNvbXByZXNzIHRoZSByZWFsbQogICAgICAgICBhbmQgdGhlIGluaXQgZnVuY3Rpb24gcG9pbnRlciAqLwogICAgICB1aW50cHRyX3QgcmVhbG1fYW5kX2lkOyAvKiByZWFsbSBhbmQgaW5pdF9pZCAoSlNfQVVUT0lOSVRfSURfeCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW4gdGhlIDIgbG93IGJpdHMgKi8KICAgICAgdm9pZCogb3BhcXVlOwogICAgfSBpbml0OwogIH0gdTsKfSBKU1Byb3BlcnR5OwoKI2RlZmluZSBKU19QUk9QX0lOSVRJQUxfU0laRSAyCiNkZWZpbmUgSlNfUFJPUF9JTklUSUFMX0hBU0hfU0laRSA0IC8qIG11c3QgYmUgYSBwb3dlciBvZiB0d28gKi8KI2RlZmluZSBKU19BUlJBWV9JTklUSUFMX1NJWkUgMgoKdHlwZWRlZiBzdHJ1Y3QgSlNTaGFwZVByb3BlcnR5IHsKICB1aW50MzJfdCBoYXNoX25leHQgOiAyNjsgLyogMCBpZiBsYXN0IGluIGxpc3QgKi8KICB1aW50MzJfdCBmbGFncyA6IDY7ICAgICAgLyogSlNfUFJPUF9YWFggKi8KICBKU0F0b20gYXRvbTsgICAgICAgICAgICAgLyogSlNfQVRPTV9OVUxMID0gZnJlZSBwcm9wZXJ0eSBlbnRyeSAqLwp9IEpTU2hhcGVQcm9wZXJ0eTsKCnN0cnVjdCBKU1NoYXBlIHsKICAvKiBoYXNoIHRhYmxlIG9mIHNpemUgaGFzaF9tYXNrICsgMSBiZWZvcmUgdGhlIHN0YXJ0IG9mIHRoZQogICAgIHN0cnVjdHVyZSAoc2VlIHByb3BfaGFzaF9lbmQoKSkuICovCiAgSlNHQ09iamVjdEhlYWRlciBoZWFkZXI7CiAgLyogdHJ1ZSBpZiB0aGUgc2hhcGUgaXMgaW5zZXJ0ZWQgaW4gdGhlIHNoYXBlIGhhc2ggdGFibGUuIElmIG5vdCwKICAgICBKU1NoYXBlLmhhc2ggaXMgbm90IHZhbGlkICovCiAgdWludDhfdCBpc19oYXNoZWQ7CiAgLyogSWYgdHJ1ZSwgdGhlIHNoYXBlIG1heSBoYXZlIHNtYWxsIGFycmF5IGluZGV4IHByb3BlcnRpZXMgJ24nIHdpdGggMAogICAgIDw9IG4gPD0gMl4zMS0xLiBJZiBmYWxzZSwgdGhlIHNoYXBlIGlzIGd1YXJhbnRlZWQgbm90IHRvIGhhdmUKICAgICBzbWFsbCBhcnJheSBpbmRleCBwcm9wZXJ0aWVzICovCiAgdWludDhfdCBoYXNfc21hbGxfYXJyYXlfaW5kZXg7CiAgdWludDMyX3QgaGFzaDsgLyogY3VycmVudCBoYXNoIHZhbHVlICovCiAgdWludDMyX3QgcHJvcF9oYXNoX21hc2s7CiAgaW50IHByb3Bfc2l6ZTsgIC8qIGFsbG9jYXRlZCBwcm9wZXJ0aWVzICovCiAgaW50IHByb3BfY291bnQ7IC8qIGluY2x1ZGUgZGVsZXRlZCBwcm9wZXJ0aWVzICovCiAgaW50IGRlbGV0ZWRfcHJvcF9jb3VudDsKICBKU1NoYXBlKiBzaGFwZV9oYXNoX25leHQ7IC8qIGluIEpTUnVudGltZS5zaGFwZV9oYXNoW2hdIGxpc3QgKi8KICBKU09iamVjdCogcHJvdG87CiAgSlNTaGFwZVByb3BlcnR5IHByb3BbMF07IC8qIHByb3Bfc2l6ZSBlbGVtZW50cyAqLwp9OwoKdHlwZWRlZiBzdHJ1Y3QgSlNSZWdFeHAgewogIEpTU3RyaW5nKiBwYXR0ZXJuOwogIEpTU3RyaW5nKiBieXRlY29kZTsgLyogYWxzbyBjb250YWlucyB0aGUgZmxhZ3MgKi8KfSBKU1JlZ0V4cDsKCnR5cGVkZWYgc3RydWN0IEpTUHJveHlEYXRhIHsKICBKU1ZhbHVlIHRhcmdldDsKICBKU1ZhbHVlIGhhbmRsZXI7CiAgdWludDhfdCBpc19mdW5jOwogIHVpbnQ4X3QgaXNfcmV2b2tlZDsKfSBKU1Byb3h5RGF0YTsKCnR5cGVkZWYgc3RydWN0IEpTQXJyYXlCdWZmZXIgewogIGludCBieXRlX2xlbmd0aDsgLyogMCBpZiBkZXRhY2hlZCAqLwogIHVpbnQ4X3QgZGV0YWNoZWQ7CiAgdWludDhfdCBzaGFyZWQ7IC8qIGlmIHNoYXJlZCwgdGhlIGFycmF5IGJ1ZmZlciBjYW5ub3QgYmUgZGV0YWNoZWQgKi8KICB1aW50OF90KiBkYXRhOyAgLyogTlVMTCBpZiBkZXRhY2hlZCAqLwogIHN0cnVjdCBsaXN0X2hlYWQgYXJyYXlfbGlzdDsKICB2b2lkKiBvcGFxdWU7CiAgSlNGcmVlQXJyYXlCdWZmZXJEYXRhRnVuYyogZnJlZV9mdW5jOwp9IEpTQXJyYXlCdWZmZXI7Cgp0eXBlZGVmIHN0cnVjdCBKU1R5cGVkQXJyYXkgewogIHN0cnVjdCBsaXN0X2hlYWQgbGluazsgLyogbGluayB0byBhcnJheWJ1ZmZlciAqLwogIEpTT2JqZWN0KiBvYmo7ICAgICAgICAgLyogYmFjayBwb2ludGVyIHRvIHRoZSBUeXBlZEFycmF5L0RhdGFWaWV3IG9iamVjdCAqLwogIEpTT2JqZWN0KiBidWZmZXI7ICAgICAgLyogYmFzZWQgYXJyYXkgYnVmZmVyICovCiAgdWludDMyX3Qgb2Zmc2V0OyAgICAgICAvKiBvZmZzZXQgaW4gdGhlIGFycmF5IGJ1ZmZlciAqLwogIHVpbnQzMl90IGxlbmd0aDsgICAgICAgLyogbGVuZ3RoIGluIHRoZSBhcnJheSBidWZmZXIgKi8KfSBKU1R5cGVkQXJyYXk7Cgp0eXBlZGVmIHN0cnVjdCBKU0FzeW5jRnVuY3Rpb25TdGF0ZSB7CiAgSlNWYWx1ZSB0aGlzX3ZhbDsgLyogJ3RoaXMnIGdlbmVyYXRvciBhcmd1bWVudCAqLwogIGludCBhcmdjOyAgICAgICAgIC8qIG51bWJlciBvZiBmdW5jdGlvbiBhcmd1bWVudHMgKi8KICBCT09MIHRocm93X2ZsYWc7ICAvKiB1c2VkIHRvIHRocm93IGFuIGV4Y2VwdGlvbiBpbiBKU19DYWxsSW50ZXJuYWwoKSAqLwogIEpTU3RhY2tGcmFtZSBmcmFtZTsKfSBKU0FzeW5jRnVuY3Rpb25TdGF0ZTsKCi8qIFhYWDogY291bGQgdXNlIGFuIG9iamVjdCBpbnN0ZWFkIHRvIGF2b2lkIHRoZQogICBKU19UQUdfQVNZTkNfRlVOQ1RJT04gdGFnIGZvciB0aGUgR0MgKi8KdHlwZWRlZiBzdHJ1Y3QgSlNBc3luY0Z1bmN0aW9uRGF0YSB7CiAgSlNHQ09iamVjdEhlYWRlciBoZWFkZXI7IC8qIG11c3QgY29tZSBmaXJzdCAqLwogIEpTVmFsdWUgcmVzb2x2aW5nX2Z1bmNzWzJdOwogIEJPT0wgaXNfYWN0aXZlOyAvKiB0cnVlIGlmIHRoZSBhc3luYyBmdW5jdGlvbiBzdGF0ZSBpcyB2YWxpZCAqLwogIEpTQXN5bmNGdW5jdGlvblN0YXRlIGZ1bmNfc3RhdGU7Cn0gSlNBc3luY0Z1bmN0aW9uRGF0YTsKCnN0cnVjdCBKU09iamVjdCB7CiAgdW5pb24gewogICAgSlNHQ09iamVjdEhlYWRlciBoZWFkZXI7CiAgICBzdHJ1Y3QgewogICAgICBpbnQgX19nY19yZWZfY291bnQ7IC8qIGNvcnJlc3BvbmRzIHRvIGhlYWRlci5yZWZfY291bnQgKi8KICAgICAgdWludDhfdCBfX2djX21hcms7ICAvKiBjb3JyZXNwb25kcyB0byBoZWFkZXIubWFyay9nY19vYmpfdHlwZSAqLwoKICAgICAgdWludDhfdCBleHRlbnNpYmxlIDogMTsKICAgICAgdWludDhfdCBmcmVlX21hcmsgOiAxOyAgICAgICAgICAgIC8qIG9ubHkgdXNlZCB3aGVuIGZyZWVpbmcgb2JqZWN0cyB3aXRoIGN5Y2xlcyAqLwogICAgICB1aW50OF90IGlzX2V4b3RpYyA6IDE7ICAgICAgICAgICAgLyogVFJVRSBpZiBvYmplY3QgaGFzIGV4b3RpYyBwcm9wZXJ0eSBoYW5kbGVycyAqLwogICAgICB1aW50OF90IGZhc3RfYXJyYXkgOiAxOyAgICAgICAgICAgLyogVFJVRSBpZiB1LmFycmF5IGlzIHVzZWQgZm9yIGdldC9wdXQgKGZvcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSlNfQ0xBU1NfQVJSQVksIEpTX0NMQVNTX0FSR1VNRU5UUyBhbmQgdHlwZWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFycmF5cykgKi8KICAgICAgdWludDhfdCBpc19jb25zdHJ1Y3RvciA6IDE7ICAgICAgIC8qIFRSVUUgaWYgb2JqZWN0IGlzIGEgY29uc3RydWN0b3IgZnVuY3Rpb24gKi8KICAgICAgdWludDhfdCBpc191bmNhdGNoYWJsZV9lcnJvciA6IDE7IC8qIGlmIFRSVUUsIGVycm9yIGlzIG5vdCBjYXRjaGFibGUgKi8KICAgICAgdWludDhfdCB0bXBfbWFyayA6IDE7ICAgICAgICAgICAgIC8qIHVzZWQgaW4gSlNfV3JpdGVPYmplY3RSZWMoKSAqLwogICAgICB1aW50OF90IGlzX0hUTUxEREEgOiAxOyAgICAgICAgICAgLyogc3BlY2lmaWMgYW5uZXggQiBJc0h0bWxEREEgYmVoYXZpb3IgKi8KICAgICAgdWludDE2X3QgY2xhc3NfaWQ7ICAgICAgICAgICAgICAgIC8qIHNlZSBKU19DTEFTU194ICovCiAgICB9OwogIH07CiAgLyogYnl0ZSBvZmZzZXRzOiAxNi8yNCAqLwogIEpTU2hhcGUqIHNoYXBlOyAgIC8qIHByb3RvdHlwZSBhbmQgcHJvcGVydHkgbmFtZXMgKyBmbGFnICovCiAgSlNQcm9wZXJ0eSogcHJvcDsgLyogYXJyYXkgb2YgcHJvcGVydGllcyAqLwogIC8qIGJ5dGUgb2Zmc2V0czogMjQvNDAgKi8KICBzdHJ1Y3QgSlNNYXBSZWNvcmQqIGZpcnN0X3dlYWtfcmVmOyAvKiBYWFg6IHVzZSBhIGJpdCBhbmQgYW4gZXh0ZXJuYWwgaGFzaCB0YWJsZT8gKi8KICAvKiBieXRlIG9mZnNldHM6IDI4LzQ4ICovCiAgdW5pb24gewogICAgdm9pZCogb3BhcXVlOwogICAgc3RydWN0IEpTQm91bmRGdW5jdGlvbiogYm91bmRfZnVuY3Rpb247ICAgICAgICAgICAgICAgLyogSlNfQ0xBU1NfQk9VTkRfRlVOQ1RJT04gKi8KICAgIHN0cnVjdCBKU0NGdW5jdGlvbkRhdGFSZWNvcmQqIGNfZnVuY3Rpb25fZGF0YV9yZWNvcmQ7IC8qIEpTX0NMQVNTX0NfRlVOQ1RJT05fREFUQSAqLwogICAgc3RydWN0IEpTRm9ySW5JdGVyYXRvciogZm9yX2luX2l0ZXJhdG9yOyAgICAgICAgICAgICAgLyogSlNfQ0xBU1NfRk9SX0lOX0lURVJBVE9SICovCiAgICBzdHJ1Y3QgSlNBcnJheUJ1ZmZlciogYXJyYXlfYnVmZmVyOyAgICAgICAgICAgICAgICAgICAvKiBKU19DTEFTU19BUlJBWV9CVUZGRVIsIEpTX0NMQVNTX1NIQVJFRF9BUlJBWV9CVUZGRVIgKi8KICAgIHN0cnVjdCBKU1R5cGVkQXJyYXkqIHR5cGVkX2FycmF5OyAgICAgICAgICAgICAgICAgICAgIC8qIEpTX0NMQVNTX1VJTlQ4Q19BUlJBWS4uSlNfQ0xBU1NfREFUQVZJRVcgKi8KI2lmZGVmIENPTkZJR19CSUdOVU0KICAgIHN0cnVjdCBKU0Zsb2F0RW52KiBmbG9hdF9lbnY7ICAgICAgICAgICAvKiBKU19DTEFTU19GTE9BVF9FTlYgKi8KICAgIHN0cnVjdCBKU09wZXJhdG9yU2V0RGF0YSogb3BlcmF0b3Jfc2V0OyAvKiBKU19DTEFTU19PUEVSQVRPUl9TRVQgKi8KI2VuZGlmCiAgICBzdHJ1Y3QgSlNNYXBTdGF0ZSogbWFwX3N0YXRlOyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogSlNfQ0xBU1NfTUFQLi5KU19DTEFTU19XRUFLU0VUICovCiAgICBzdHJ1Y3QgSlNNYXBJdGVyYXRvckRhdGEqIG1hcF9pdGVyYXRvcl9kYXRhOyAgICAgICAgICAgICAgICAgICAgICAgLyogSlNfQ0xBU1NfTUFQX0lURVJBVE9SLCBKU19DTEFTU19TRVRfSVRFUkFUT1IgKi8KICAgIHN0cnVjdCBKU0FycmF5SXRlcmF0b3JEYXRhKiBhcnJheV9pdGVyYXRvcl9kYXRhOyAgICAgICAgICAgICAgICAgICAvKiBKU19DTEFTU19BUlJBWV9JVEVSQVRPUiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKU19DTEFTU19TVFJJTkdfSVRFUkFUT1IgKi8KICAgIHN0cnVjdCBKU1JlZ0V4cFN0cmluZ0l0ZXJhdG9yRGF0YSogcmVnZXhwX3N0cmluZ19pdGVyYXRvcl9kYXRhOyAgICAvKiBKU19DTEFTU19SRUdFWFBfU1RSSU5HX0lURVJBVE9SICovCiAgICBzdHJ1Y3QgSlNHZW5lcmF0b3JEYXRhKiBnZW5lcmF0b3JfZGF0YTsgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogSlNfQ0xBU1NfR0VORVJBVE9SICovCiAgICBzdHJ1Y3QgSlNQcm94eURhdGEqIHByb3h5X2RhdGE7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogSlNfQ0xBU1NfUFJPWFkgKi8KICAgIHN0cnVjdCBKU1Byb21pc2VEYXRhKiBwcm9taXNlX2RhdGE7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBKU19DTEFTU19QUk9NSVNFICovCiAgICBzdHJ1Y3QgSlNQcm9taXNlRnVuY3Rpb25EYXRhKiBwcm9taXNlX2Z1bmN0aW9uX2RhdGE7ICAgICAgICAgICAgICAgLyogSlNfQ0xBU1NfUFJPTUlTRV9SRVNPTFZFX0ZVTkNUSU9OLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpTX0NMQVNTX1BST01JU0VfUkVKRUNUX0ZVTkNUSU9OICovCiAgICBzdHJ1Y3QgSlNBc3luY0Z1bmN0aW9uRGF0YSogYXN5bmNfZnVuY3Rpb25fZGF0YTsgICAgICAgICAgICAgICAgICAgLyogSlNfQ0xBU1NfQVNZTkNfRlVOQ1RJT05fUkVTT0xWRSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBKU19DTEFTU19BU1lOQ19GVU5DVElPTl9SRUpFQ1QgKi8KICAgIHN0cnVjdCBKU0FzeW5jRnJvbVN5bmNJdGVyYXRvckRhdGEqIGFzeW5jX2Zyb21fc3luY19pdGVyYXRvcl9kYXRhOyAvKiBKU19DTEFTU19BU1lOQ19GUk9NX1NZTkNfSVRFUkFUT1IgKi8KICAgIHN0cnVjdCBKU0FzeW5jR2VuZXJhdG9yRGF0YSogYXN5bmNfZ2VuZXJhdG9yX2RhdGE7ICAgICAgICAgICAgICAgICAvKiBKU19DTEFTU19BU1lOQ19HRU5FUkFUT1IgKi8KICAgIHN0cnVjdCB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBKU19DTEFTU19CWVRFQ09ERV9GVU5DVElPTjogMTIvMjQgYnl0ZXMgKi8KICAgICAgLyogYWxzbyB1c2VkIGJ5IEpTX0NMQVNTX0dFTkVSQVRPUl9GVU5DVElPTiwgSlNfQ0xBU1NfQVNZTkNfRlVOQ1RJT04gYW5kCiAgICAgICAqIEpTX0NMQVNTX0FTWU5DX0dFTkVSQVRPUl9GVU5DVElPTiAqLwogICAgICBzdHJ1Y3QgSlNGdW5jdGlvbkJ5dGVjb2RlKiBmdW5jdGlvbl9ieXRlY29kZTsKICAgICAgSlNWYXJSZWYqKiB2YXJfcmVmczsKICAgICAgSlNPYmplY3QqIGhvbWVfb2JqZWN0OyAvKiBmb3IgJ3N1cGVyJyBhY2Nlc3MgKi8KICAgIH0gZnVuYzsKICAgIHN0cnVjdCB7IC8qIEpTX0NMQVNTX0NfRlVOQ1RJT046IDEyLzIwIGJ5dGVzICovCiAgICAgIEpTQ29udGV4dCogcmVhbG07CiAgICAgIEpTQ0Z1bmN0aW9uVHlwZSBjX2Z1bmN0aW9uOwogICAgICB1aW50OF90IGxlbmd0aDsKICAgICAgdWludDhfdCBjcHJvdG87CiAgICAgIGludDE2X3QgbWFnaWM7CiAgICB9IGNmdW5jOwogICAgLyogYXJyYXkgcGFydCBmb3IgZmFzdCBhcnJheXMgYW5kIHR5cGVkIGFycmF5cyAqLwogICAgc3RydWN0IHsgLyogSlNfQ0xBU1NfQVJSQVksIEpTX0NMQVNTX0FSR1VNRU5UUywKICAgICAgICAgICAgICAgIEpTX0NMQVNTX1VJTlQ4Q19BUlJBWS4uSlNfQ0xBU1NfRkxPQVQ2NF9BUlJBWSAqLwogICAgICB1bmlvbiB7CiAgICAgICAgdWludDMyX3Qgc2l6ZTsgICAgICAgICAgICAgICAgICAgIC8qIEpTX0NMQVNTX0FSUkFZLCBKU19DTEFTU19BUkdVTUVOVFMgKi8KICAgICAgICBzdHJ1Y3QgSlNUeXBlZEFycmF5KiB0eXBlZF9hcnJheTsgLyogSlNfQ0xBU1NfVUlOVDhDX0FSUkFZLi5KU19DTEFTU19GTE9BVDY0X0FSUkFZICovCiAgICAgIH0gdTE7CiAgICAgIHVuaW9uIHsKICAgICAgICBKU1ZhbHVlKiB2YWx1ZXM7ICAgICAgLyogSlNfQ0xBU1NfQVJSQVksIEpTX0NMQVNTX0FSR1VNRU5UUyAqLwogICAgICAgIHZvaWQqIHB0cjsgICAgICAgICAgICAvKiBKU19DTEFTU19VSU5UOENfQVJSQVkuLkpTX0NMQVNTX0ZMT0FUNjRfQVJSQVkgKi8KICAgICAgICBpbnQ4X3QqIGludDhfcHRyOyAgICAgLyogSlNfQ0xBU1NfSU5UOF9BUlJBWSAqLwogICAgICAgIHVpbnQ4X3QqIHVpbnQ4X3B0cjsgICAvKiBKU19DTEFTU19VSU5UOF9BUlJBWSwgSlNfQ0xBU1NfVUlOVDhDX0FSUkFZICovCiAgICAgICAgaW50MTZfdCogaW50MTZfcHRyOyAgIC8qIEpTX0NMQVNTX0lOVDE2X0FSUkFZICovCiAgICAgICAgdWludDE2X3QqIHVpbnQxNl9wdHI7IC8qIEpTX0NMQVNTX1VJTlQxNl9BUlJBWSAqLwogICAgICAgIGludDMyX3QqIGludDMyX3B0cjsgICAvKiBKU19DTEFTU19JTlQzMl9BUlJBWSAqLwogICAgICAgIHVpbnQzMl90KiB1aW50MzJfcHRyOyAvKiBKU19DTEFTU19VSU5UMzJfQVJSQVkgKi8KICAgICAgICBpbnQ2NF90KiBpbnQ2NF9wdHI7ICAgLyogSlNfQ0xBU1NfSU5UNjRfQVJSQVkgKi8KICAgICAgICB1aW50NjRfdCogdWludDY0X3B0cjsgLyogSlNfQ0xBU1NfVUlOVDY0X0FSUkFZICovCiAgICAgICAgZmxvYXQqIGZsb2F0X3B0cjsgICAgIC8qIEpTX0NMQVNTX0ZMT0FUMzJfQVJSQVkgKi8KICAgICAgICBkb3VibGUqIGRvdWJsZV9wdHI7ICAgLyogSlNfQ0xBU1NfRkxPQVQ2NF9BUlJBWSAqLwogICAgICB9IHU7CiAgICAgIHVpbnQzMl90IGNvdW50OyAgICAvKiA8PSAyXjMxLTEuIDAgZm9yIGEgZGV0YWNoZWQgdHlwZWQgYXJyYXkgKi8KICAgIH0gYXJyYXk7ICAgICAgICAgICAgIC8qIDEyLzIwIGJ5dGVzICovCiAgICBKU1JlZ0V4cCByZWdleHA7ICAgICAvKiBKU19DTEFTU19SRUdFWFA6IDgvMTYgYnl0ZXMgKi8KICAgIEpTVmFsdWUgb2JqZWN0X2RhdGE7IC8qIGZvciBKU19TZXRPYmplY3REYXRhKCk6IDgvMTYvMTYgYnl0ZXMgKi8KICB9IHU7CiAgLyogYnl0ZSBzaXplczogNDAvNDgvNzIgKi8KfTsKCiNpZm5kZWYgU0hPUlRfT1BDT0RFUwojZGVmaW5lIFNIT1JUX09QQ09ERVMgMQojZW5kaWYKCnR5cGVkZWYgZW51bSBPUENvZGVGb3JtYXQgewojZGVmaW5lIEZNVChmKSBPUF9GTVRfIyNmLAojZGVmaW5lIERFRihpZCwgc2l6ZSwgbl9wb3AsIG5fcHVzaCwgZikKI2luY2x1ZGUgPHF1aWNranMtb3Bjb2RlLmg+CiN1bmRlZiBERUYKI3VuZGVmIEZNVAp9IE9QQ29kZUZvcm1hdDsKCmVudW0gT1BDb2RlRW51bSB7CiNkZWZpbmUgRk1UKGYpCiNkZWZpbmUgREVGKGlkLCBzaXplLCBuX3BvcCwgbl9wdXNoLCBmKSBPUF8jI2lkLAojZGVmaW5lIGRlZihpZCwgc2l6ZSwgbl9wb3AsIG5fcHVzaCwgZikKI2luY2x1ZGUgPHF1aWNranMtb3Bjb2RlLmg+CiN1bmRlZiBkZWYKI3VuZGVmIERFRgojdW5kZWYgRk1UCiAgT1BfQ09VTlQsIC8qIGV4Y2x1ZGluZyB0ZW1wb3Jhcnkgb3Bjb2RlcyAqLwogIC8qIHRlbXBvcmFyeSBvcGNvZGVzIDogb3ZlcmxhcCB3aXRoIHRoZSBzaG9ydCBvcGNvZGVzICovCiAgT1BfVEVNUF9TVEFSVCA9IE9QX25vcCArIDEsCiAgT1BfX19kdW1teSA9IE9QX1RFTVBfU1RBUlQgLSAxLAojZGVmaW5lIEZNVChmKQojZGVmaW5lIERFRihpZCwgc2l6ZSwgbl9wb3AsIG5fcHVzaCwgZikKI2RlZmluZSBkZWYoaWQsIHNpemUsIG5fcG9wLCBuX3B1c2gsIGYpIE9QXyMjaWQsCiNpbmNsdWRlIDxxdWlja2pzLW9wY29kZS5oPgojdW5kZWYgZGVmCiN1bmRlZiBERUYKI3VuZGVmIEZNVAogIE9QX1RFTVBfRU5ELAp9OwovKiBKU0F0b20gc3VwcG9ydCAqLwoKI2RlZmluZSBKU19BVE9NX1RBR19JTlQgKDFVIDw8IDMxKQojZGVmaW5lIEpTX0FUT01fTUFYX0lOVCAoSlNfQVRPTV9UQUdfSU5UIC0gMSkKI2RlZmluZSBKU19BVE9NX01BWCAoKDFVIDw8IDMwKSAtIDEpCgp0eXBlZGVmIHN0cnVjdCBTdHJpbmdCdWZmZXIgewogIEpTQ29udGV4dCogY3R4OwogIEpTU3RyaW5nKiBzdHI7CiAgaW50IGxlbjsKICBpbnQgc2l6ZTsKICBpbnQgaXNfd2lkZV9jaGFyOwogIGludCBlcnJvcl9zdGF0dXM7Cn0gU3RyaW5nQnVmZmVyOwoKdHlwZWRlZiBzdHJ1Y3QgSlNDRnVuY3Rpb25EYXRhUmVjb3JkIHsKICBKU0NGdW5jdGlvbkRhdGEqIGZ1bmM7CiAgdWludDhfdCBsZW5ndGg7CiAgdWludDhfdCBkYXRhX2xlbjsKICB1aW50MTZfdCBtYWdpYzsKICBKU1ZhbHVlIGRhdGFbMF07Cn0gSlNDRnVuY3Rpb25EYXRhUmVjb3JkOwoKLyp0eXBlZGVmIHN0cnVjdCBKU0NDbG9zdXJlUmVjb3JkIHsKICBKU0NDbG9zdXJlKiBmdW5jOwogIHVpbnQxNl90IGxlbmd0aDsKICB1aW50MTZfdCBtYWdpYzsKICB2b2lkKiBvcGFxdWU7CiAgdm9pZCAoKm9wYXF1ZV9maW5hbGl6ZSkodm9pZCopOwp9IEpTQ0Nsb3N1cmVSZWNvcmQ7Ki8KCnR5cGVkZWYgc3RydWN0IEpTTWVtb3J5VXNhZ2VfaGVscGVyIHsKICBkb3VibGUgbWVtb3J5X3VzZWRfY291bnQ7CiAgZG91YmxlIHN0cl9jb3VudDsKICBkb3VibGUgc3RyX3NpemU7CiAgaW50NjRfdCBqc19mdW5jX2NvdW50OwogIGRvdWJsZSBqc19mdW5jX3NpemU7CiAgaW50NjRfdCBqc19mdW5jX2NvZGVfc2l6ZTsKICBpbnQ2NF90IGpzX2Z1bmNfcGMybGluZV9jb3VudDsKICBpbnQ2NF90IGpzX2Z1bmNfcGMybGluZV9zaXplOwp9IEpTTWVtb3J5VXNhZ2VfaGVscGVyOwoKdHlwZWRlZiBlbnVtIEpTR2VuZXJhdG9yU3RhdGVFbnVtIHsKICBKU19HRU5FUkFUT1JfU1RBVEVfU1VTUEVOREVEX1NUQVJULAogIEpTX0dFTkVSQVRPUl9TVEFURV9TVVNQRU5ERURfWUlFTEQsCiAgSlNfR0VORVJBVE9SX1NUQVRFX1NVU1BFTkRFRF9ZSUVMRF9TVEFSLAogIEpTX0dFTkVSQVRPUl9TVEFURV9FWEVDVVRJTkcsCiAgSlNfR0VORVJBVE9SX1NUQVRFX0NPTVBMRVRFRCwKfSBKU0dlbmVyYXRvclN0YXRlRW51bTsKCnR5cGVkZWYgc3RydWN0IEpTR2VuZXJhdG9yRGF0YSB7CiAgSlNHZW5lcmF0b3JTdGF0ZUVudW0gc3RhdGU7CiAgSlNBc3luY0Z1bmN0aW9uU3RhdGUgZnVuY19zdGF0ZTsKfSBKU0dlbmVyYXRvckRhdGE7Cgp0eXBlZGVmIGVudW0gSlNBc3luY0dlbmVyYXRvclN0YXRlRW51bSB7CiAgSlNfQVNZTkNfR0VORVJBVE9SX1NUQVRFX1NVU1BFTkRFRF9TVEFSVCwKICBKU19BU1lOQ19HRU5FUkFUT1JfU1RBVEVfU1VTUEVOREVEX1lJRUxELAogIEpTX0FTWU5DX0dFTkVSQVRPUl9TVEFURV9TVVNQRU5ERURfWUlFTERfU1RBUiwKICBKU19BU1lOQ19HRU5FUkFUT1JfU1RBVEVfRVhFQ1VUSU5HLAogIEpTX0FTWU5DX0dFTkVSQVRPUl9TVEFURV9BV0FJVElOR19SRVRVUk4sCiAgSlNfQVNZTkNfR0VORVJBVE9SX1NUQVRFX0NPTVBMRVRFRCwKfSBKU0FzeW5jR2VuZXJhdG9yU3RhdGVFbnVtOwoKdHlwZWRlZiBzdHJ1Y3QgSlNBc3luY0dlbmVyYXRvclJlcXVlc3QgewogIHN0cnVjdCBsaXN0X2hlYWQgbGluazsKICAvKiBjb21wbGV0aW9uICovCiAgaW50IGNvbXBsZXRpb25fdHlwZTsgLyogR0VOX01BR0lDX3ggKi8KICBKU1ZhbHVlIHJlc3VsdDsKICAvKiBwcm9taXNlIGNhcGFiaWxpdHkgKi8KICBKU1ZhbHVlIHByb21pc2U7CiAgSlNWYWx1ZSByZXNvbHZpbmdfZnVuY3NbMl07Cn0gSlNBc3luY0dlbmVyYXRvclJlcXVlc3Q7Cgp0eXBlZGVmIHN0cnVjdCBKU0FzeW5jR2VuZXJhdG9yRGF0YSB7CiAgSlNPYmplY3QqIGdlbmVyYXRvcjsgLyogYmFjayBwb2ludGVyIHRvIHRoZSBvYmplY3QgKGNvbnN0KSAqLwogIEpTQXN5bmNHZW5lcmF0b3JTdGF0ZUVudW0gc3RhdGU7CiAgSlNBc3luY0Z1bmN0aW9uU3RhdGUgZnVuY19zdGF0ZTsKICBzdHJ1Y3QgbGlzdF9oZWFkIHF1ZXVlOyAvKiBsaXN0IG9mIEpTQXN5bmNHZW5lcmF0b3JSZXF1ZXN0LmxpbmsgKi8KfSBKU0FzeW5jR2VuZXJhdG9yRGF0YTsKCnR5cGVkZWYgc3RydWN0IEpTUHJvbWlzZURhdGEgewogIEpTUHJvbWlzZVN0YXRlRW51bSBwcm9taXNlX3N0YXRlOwogIC8qIDA9ZnVsZmlsbCwgMT1yZWplY3QsIGxpc3Qgb2YgSlNQcm9taXNlUmVhY3Rpb25EYXRhLmxpbmsgKi8KICBzdHJ1Y3QgbGlzdF9oZWFkIHByb21pc2VfcmVhY3Rpb25zWzJdOwogIEJPT0wgaXNfaGFuZGxlZDsgLyogTm90ZTogb25seSB1c2VmdWwgdG8gZGVidWcgKi8KICBKU1ZhbHVlIHByb21pc2VfcmVzdWx0Owp9IEpTUHJvbWlzZURhdGE7Cgp0eXBlZGVmIHN0cnVjdCBKU1Byb21pc2VGdW5jdGlvbkRhdGFSZXNvbHZlZCB7CiAgaW50IHJlZl9jb3VudDsKICBCT09MIGFscmVhZHlfcmVzb2x2ZWQ7Cn0gSlNQcm9taXNlRnVuY3Rpb25EYXRhUmVzb2x2ZWQ7Cgp0eXBlZGVmIHN0cnVjdCBKU1Byb21pc2VGdW5jdGlvbkRhdGEgewogIEpTVmFsdWUgcHJvbWlzZTsKICBKU1Byb21pc2VGdW5jdGlvbkRhdGFSZXNvbHZlZCogcHJlc29sdmVkOwp9IEpTUHJvbWlzZUZ1bmN0aW9uRGF0YTsKCnR5cGVkZWYgc3RydWN0IEpTUHJvbWlzZVJlYWN0aW9uRGF0YSB7CiAgc3RydWN0IGxpc3RfaGVhZCBsaW5rOyAvKiBub3QgdXNlZCBpbiBwcm9taXNlX3JlYWN0aW9uX2pvYiAqLwogIEpTVmFsdWUgcmVzb2x2aW5nX2Z1bmNzWzJdOwogIEpTVmFsdWUgaGFuZGxlcjsKfSBKU1Byb21pc2VSZWFjdGlvbkRhdGE7Cgp0eXBlZGVmIHN0cnVjdCBKU0JvdW5kRnVuY3Rpb24gewogIEpTVmFsdWUgZnVuY19vYmo7CiAgSlNWYWx1ZSB0aGlzX3ZhbDsKICBpbnQgYXJnYzsKICBKU1ZhbHVlIGFyZ3ZbMF07Cn0gSlNCb3VuZEZ1bmN0aW9uOwoKdHlwZWRlZiBlbnVtIEpTSXRlcmF0b3JLaW5kRW51bSB7CiAgSlNfSVRFUkFUT1JfS0lORF9LRVksCiAgSlNfSVRFUkFUT1JfS0lORF9WQUxVRSwKICBKU19JVEVSQVRPUl9LSU5EX0tFWV9BTkRfVkFMVUUsCn0gSlNJdGVyYXRvcktpbmRFbnVtOwoKdHlwZWRlZiBzdHJ1Y3QgSlNGb3JJbkl0ZXJhdG9yIHsKICBKU1ZhbHVlIG9iajsKICBCT09MIGlzX2FycmF5OwogIHVpbnQzMl90IGFycmF5X2xlbmd0aDsKICB1aW50MzJfdCBpZHg7Cn0gSlNGb3JJbkl0ZXJhdG9yOwoKdHlwZWRlZiBlbnVtIHsKICAvKiBiaW5hcnkgb3BlcmF0b3JzICovCiAgSlNfT1ZPUF9BREQsCiAgSlNfT1ZPUF9TVUIsCiAgSlNfT1ZPUF9NVUwsCiAgSlNfT1ZPUF9ESVYsCiAgSlNfT1ZPUF9NT0QsCiAgSlNfT1ZPUF9QT1csCiAgSlNfT1ZPUF9PUiwKICBKU19PVk9QX0FORCwKICBKU19PVk9QX1hPUiwKICBKU19PVk9QX1NITCwKICBKU19PVk9QX1NBUiwKICBKU19PVk9QX1NIUiwKICBKU19PVk9QX0VRLAogIEpTX09WT1BfTEVTUywKCiAgSlNfT1ZPUF9CSU5BUllfQ09VTlQsCiAgLyogdW5hcnkgb3BlcmF0b3JzICovCiAgSlNfT1ZPUF9QT1MgPSBKU19PVk9QX0JJTkFSWV9DT1VOVCwKICBKU19PVk9QX05FRywKICBKU19PVk9QX0lOQywKICBKU19PVk9QX0RFQywKICBKU19PVk9QX05PVCwKCiAgSlNfT1ZPUF9DT1VOVCwKfSBKU092ZXJsb2FkYWJsZU9wZXJhdG9yRW51bTsKCnR5cGVkZWYgc3RydWN0IHsKICB1aW50MzJfdCBvcGVyYXRvcl9pbmRleDsKICBKU09iamVjdCogb3BzW0pTX09WT1BfQklOQVJZX0NPVU5UXTsgLyogc2VsZiBvcGVyYXRvcnMgKi8KfSBKU0JpbmFyeU9wZXJhdG9yRGVmRW50cnk7Cgp0eXBlZGVmIHN0cnVjdCB7CiAgaW50IGNvdW50OwogIEpTQmluYXJ5T3BlcmF0b3JEZWZFbnRyeSogdGFiOwp9IEpTQmluYXJ5T3BlcmF0b3JEZWY7Cgp0eXBlZGVmIHN0cnVjdCB7CiAgdWludDMyX3Qgb3BlcmF0b3JfY291bnRlcjsKICBCT09MIGlzX3ByaW1pdGl2ZTsgLyogT3BlcmF0b3JTZXQgZm9yIGEgcHJpbWl0aXZlIHR5cGUgKi8KICAvKiBOVUxMIGlmIG5vIG9wZXJhdG9yIGlzIGRlZmluZWQgKi8KICBKU09iamVjdCogc2VsZl9vcHNbSlNfT1ZPUF9DT1VOVF07IC8qIHNlbGYgb3BlcmF0b3JzICovCiAgSlNCaW5hcnlPcGVyYXRvckRlZiBsZWZ0OwogIEpTQmluYXJ5T3BlcmF0b3JEZWYgcmlnaHQ7Cn0gSlNPcGVyYXRvclNldERhdGE7Cgp0eXBlZGVmIHN0cnVjdCBKU1JlcU1vZHVsZUVudHJ5IHsKICBKU0F0b20gbW9kdWxlX25hbWU7CiAgSlNNb2R1bGVEZWYqIG1vZHVsZTsgLyogdXNlZCB1c2luZyByZXNvbHV0aW9uICovCn0gSlNSZXFNb2R1bGVFbnRyeTsKCnR5cGVkZWYgZW51bSBKU0V4cG9ydFR5cGVFbnVtIHsKICBKU19FWFBPUlRfVFlQRV9MT0NBTCwKICBKU19FWFBPUlRfVFlQRV9JTkRJUkVDVCwKfSBKU0V4cG9ydFR5cGVFbnVtOwoKdHlwZWRlZiBzdHJ1Y3QgSlNFeHBvcnRFbnRyeSB7CiAgdW5pb24gewogICAgc3RydWN0IHsKICAgICAgaW50IHZhcl9pZHg7ICAgICAgIC8qIGNsb3N1cmUgdmFyaWFibGUgaW5kZXggKi8KICAgICAgSlNWYXJSZWYqIHZhcl9yZWY7IC8qIGlmICE9IE5VTEwsIHJlZmVyZW5jZSB0byB0aGUgdmFyaWFibGUgKi8KICAgIH0gbG9jYWw7ICAgICAgICAgICAgIC8qIGZvciBsb2NhbCBleHBvcnQgKi8KICAgIGludCByZXFfbW9kdWxlX2lkeDsgIC8qIG1vZHVsZSBmb3IgaW5kaXJlY3QgZXhwb3J0ICovCiAgfSB1OwogIEpTRXhwb3J0VHlwZUVudW0gZXhwb3J0X3R5cGU7CiAgSlNBdG9tIGxvY2FsX25hbWU7ICAvKiAnKicgaWYgZXhwb3J0IG5zIGZyb20uIG5vdCB1c2VkIGZvciBsb2NhbAogICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3J0IGFmdGVyIGNvbXBpbGF0aW9uICovCiAgSlNBdG9tIGV4cG9ydF9uYW1lOyAvKiBleHBvcnRlZCB2YXJpYWJsZSBuYW1lICovCn0gSlNFeHBvcnRFbnRyeTsKCnR5cGVkZWYgc3RydWN0IEpTU3RhckV4cG9ydEVudHJ5IHsKICBpbnQgcmVxX21vZHVsZV9pZHg7IC8qIGluIHJlcV9tb2R1bGVfZW50cmllcyAqLwp9IEpTU3RhckV4cG9ydEVudHJ5OwoKdHlwZWRlZiBzdHJ1Y3QgSlNJbXBvcnRFbnRyeSB7CiAgaW50IHZhcl9pZHg7IC8qIGNsb3N1cmUgdmFyaWFibGUgaW5kZXggKi8KICBKU0F0b20gaW1wb3J0X25hbWU7CiAgaW50IHJlcV9tb2R1bGVfaWR4OyAvKiBpbiByZXFfbW9kdWxlX2VudHJpZXMgKi8KfSBKU0ltcG9ydEVudHJ5OwoKc3RydWN0IEpTTW9kdWxlRGVmIHsKICBKU1JlZkNvdW50SGVhZGVyIGhlYWRlcjsgLyogbXVzdCBjb21lIGZpcnN0LCAzMi1iaXQgKi8KICBKU0F0b20gbW9kdWxlX25hbWU7CiAgc3RydWN0IGxpc3RfaGVhZCBsaW5rOwoKICBKU1JlcU1vZHVsZUVudHJ5KiByZXFfbW9kdWxlX2VudHJpZXM7CiAgaW50IHJlcV9tb2R1bGVfZW50cmllc19jb3VudDsKICBpbnQgcmVxX21vZHVsZV9lbnRyaWVzX3NpemU7CgogIEpTRXhwb3J0RW50cnkqIGV4cG9ydF9lbnRyaWVzOwogIGludCBleHBvcnRfZW50cmllc19jb3VudDsKICBpbnQgZXhwb3J0X2VudHJpZXNfc2l6ZTsKCiAgSlNTdGFyRXhwb3J0RW50cnkqIHN0YXJfZXhwb3J0X2VudHJpZXM7CiAgaW50IHN0YXJfZXhwb3J0X2VudHJpZXNfY291bnQ7CiAgaW50IHN0YXJfZXhwb3J0X2VudHJpZXNfc2l6ZTsKCiAgSlNJbXBvcnRFbnRyeSogaW1wb3J0X2VudHJpZXM7CiAgaW50IGltcG9ydF9lbnRyaWVzX2NvdW50OwogIGludCBpbXBvcnRfZW50cmllc19zaXplOwoKICBKU1ZhbHVlIG1vZHVsZV9uczsKICBKU1ZhbHVlIGZ1bmNfb2JqOyAgICAgICAgICAgIC8qIG9ubHkgdXNlZCBmb3IgSlMgbW9kdWxlcyAqLwogIEpTTW9kdWxlSW5pdEZ1bmMqIGluaXRfZnVuYzsgLyogb25seSB1c2VkIGZvciBDIG1vZHVsZXMgKi8KICBCT09MIHJlc29sdmVkIDogODsKICBCT09MIGZ1bmNfY3JlYXRlZCA6IDg7CiAgQk9PTCBpbnN0YW50aWF0ZWQgOiA4OwogIEJPT0wgZXZhbHVhdGVkIDogODsKICBCT09MIGV2YWxfbWFyayA6IDg7IC8qIHRlbXBvcmFyeSB1c2UgZHVyaW5nIGpzX2V2YWx1YXRlX21vZHVsZSgpICovCiAgLyogdHJ1ZSBpZiBldmFsdWF0aW9uIHlpZWxkZWQgYW4gZXhjZXB0aW9uLiBJdCBpcyBzYXZlZCBpbgogICAgIGV2YWxfZXhjZXB0aW9uICovCiAgQk9PTCBldmFsX2hhc19leGNlcHRpb24gOiA4OwogIEpTVmFsdWUgZXZhbF9leGNlcHRpb247CiAgSlNWYWx1ZSBtZXRhX29iajsgLyogZm9yIGltcG9ydC5tZXRhICovCn07Cgp0eXBlZGVmIHN0cnVjdCBKU0pvYkVudHJ5IHsKICBzdHJ1Y3QgbGlzdF9oZWFkIGxpbms7CiAgSlNDb250ZXh0KiBjdHg7CiAgSlNKb2JGdW5jKiBqb2JfZnVuYzsKICBpbnQgYXJnYzsKICBKU1ZhbHVlIGFyZ3ZbMF07Cn0gSlNKb2JFbnRyeTsKCi8qIFNldC9NYXAvV2Vha1NldC9XZWFrTWFwICovCgp0eXBlZGVmIHN0cnVjdCBKU01hcFJlY29yZCB7CiAgaW50IHJlZl9jb3VudDsgLyogdXNlZCBkdXJpbmcgZW51bWVyYXRpb24gdG8gYXZvaWQgZnJlZWluZyB0aGUgcmVjb3JkICovCiAgQk9PTCBlbXB0eTsgICAgLyogVFJVRSBpZiB0aGUgcmVjb3JkIGlzIGRlbGV0ZWQgKi8KICBzdHJ1Y3QgSlNNYXBTdGF0ZSogbWFwOwogIHN0cnVjdCBKU01hcFJlY29yZCogbmV4dF93ZWFrX3JlZjsKICBzdHJ1Y3QgbGlzdF9oZWFkIGxpbms7CiAgc3RydWN0IGxpc3RfaGVhZCBoYXNoX2xpbms7CiAgSlNWYWx1ZSBrZXk7CiAgSlNWYWx1ZSB2YWx1ZTsKfSBKU01hcFJlY29yZDsKCnR5cGVkZWYgc3RydWN0IEpTTWFwU3RhdGUgewogIEJPT0wgaXNfd2VhazsgICAgICAgICAgICAgLyogVFJVRSBpZiBXZWFrU2V0L1dlYWtNYXAgKi8KICBzdHJ1Y3QgbGlzdF9oZWFkIHJlY29yZHM7IC8qIGxpc3Qgb2YgSlNNYXBSZWNvcmQubGluayAqLwogIHVpbnQzMl90IHJlY29yZF9jb3VudDsKICBzdHJ1Y3QgbGlzdF9oZWFkKiBoYXNoX3RhYmxlOwogIHVpbnQzMl90IGhhc2hfc2l6ZTsgICAgICAgICAgICAgIC8qIG11c3QgYmUgYSBwb3dlciBvZiB0d28gKi8KICB1aW50MzJfdCByZWNvcmRfY291bnRfdGhyZXNob2xkOyAvKiBjb3VudCBhdCB3aGljaCBhIGhhc2ggdGFibGUgcmVzaXplIGlzIG5lZWRlZCAqLwp9IEpTTWFwU3RhdGU7CgojZGVmaW5lIE1BR0lDX1NFVCAoMSA8PCAwKQojZGVmaW5lIE1BR0lDX1dFQUsgKDEgPDwgMSkKCnR5cGVkZWYgc3RydWN0IEpTTWFwSXRlcmF0b3JEYXRhIHsKICBKU1ZhbHVlIG9iajsKICBKU0l0ZXJhdG9yS2luZEVudW0ga2luZDsKICBKU01hcFJlY29yZCogY3VyX3JlY29yZDsKfSBKU01hcEl0ZXJhdG9yRGF0YTsKCnR5cGVkZWYgc3RydWN0IEpTT3BDb2RlIHsKICB1aW50OF90IHNpemU7IC8qIGluIGJ5dGVzICovCiAgLyogdGhlIG9wY29kZXMgcmVtb3ZlIG5fcG9wIGl0ZW1zIGZyb20gdGhlIHRvcCBvZiB0aGUgc3RhY2ssIHRoZW4KICAgICBwdXNoZXMgbl9wdXNoIGl0ZW1zICovCiAgdWludDhfdCBuX3BvcDsKICB1aW50OF90IG5fcHVzaDsKICB1aW50OF90IGZtdDsKICBjb25zdCBjaGFyKiBuYW1lOwp9IEpTT3BDb2RlOwoKI2lmIFNIT1JUX09QQ09ERVMKLyogQWZ0ZXIgdGhlIGZpbmFsIGNvbXBpbGF0aW9uIHBhc3MsIHNob3J0IG9wY29kZXMgYXJlIHVzZWQuIFRoZWlyCiAgIG9wY29kZXMgb3ZlcmxhcCB3aXRoIHRoZSB0ZW1wb3Jhcnkgb3Bjb2RlcyB3aGljaCBjYW5ub3QgYXBwZWFyIGluCiAgIHRoZSBmaW5hbCBieXRlY29kZS4gVGhlaXIgZGVzY3JpcHRpb24gaXMgYWZ0ZXIgdGhlIHRlbXBvcmFyeQogICBvcGNvZGVzIGluIG9wY29kZV9pbmZvW10uICovCiNkZWZpbmUgc2hvcnRfb3Bjb2RlX2luZm8ob3ApIG9wY29kZV9pbmZvWyhvcCkgPj0gT1BfVEVNUF9TVEFSVCA/IChvcCkgKyAoT1BfVEVNUF9FTkQgLSBPUF9URU1QX1NUQVJUKSA6IChvcCldCiNlbHNlCiNkZWZpbmUgc2hvcnRfb3Bjb2RlX2luZm8ob3ApIG9wY29kZV9pbmZvW29wXQojZW5kaWYKCmV4dGVybiBjb25zdCBKU09wQ29kZSBqc19vcGNvZGVzW09QX0NPVU5UICsgKE9QX1RFTVBfRU5EIC0gT1BfVEVNUF9TVEFSVCldOwoKdHlwZWRlZiBzdHJ1Y3QgSlNQYXJzZVBvcyB7CiAgaW50IGxhc3RfbGluZV9udW07CiAgaW50IGxpbmVfbnVtOwogIEJPT0wgZ290X2xmOwogIGNvbnN0IHVpbnQ4X3QqIHB0cjsKfSBKU1BhcnNlUG9zOwoKdHlwZWRlZiBzdHJ1Y3QgSlNSZXNvbHZlRW50cnkgewogIEpTTW9kdWxlRGVmKiBtb2R1bGU7CiAgSlNBdG9tIG5hbWU7Cn0gSlNSZXNvbHZlRW50cnk7Cgp0eXBlZGVmIHN0cnVjdCBKU1Jlc29sdmVTdGF0ZSB7CiAgSlNSZXNvbHZlRW50cnkqIGFycmF5OwogIGludCBzaXplOwogIGludCBjb3VudDsKfSBKU1Jlc29sdmVTdGF0ZTsKCnR5cGVkZWYgZW51bSB7CiAgRVhQT1JURURfTkFNRV9BTUJJR1VPVVMsCiAgRVhQT1JURURfTkFNRV9OT1JNQUwsCiAgRVhQT1JURURfTkFNRV9OUywKfSBFeHBvcnRlZE5hbWVFbnRyeUVudW07Cgp0eXBlZGVmIHN0cnVjdCBFeHBvcnRlZE5hbWVFbnRyeSB7CiAgSlNBdG9tIGV4cG9ydF9uYW1lOwogIEV4cG9ydGVkTmFtZUVudHJ5RW51bSBleHBvcnRfdHlwZTsKICB1bmlvbiB7CiAgICBKU0V4cG9ydEVudHJ5KiBtZTsgICAvKiB1c2luZyB3aGVuIHRoZSBsaXN0IGlzIGJ1aWx0ICovCiAgICBKU1ZhclJlZiogdmFyX3JlZjsgICAvKiBFWFBPUlRFRF9OQU1FX05PUk1BTCAqLwogICAgSlNNb2R1bGVEZWYqIG1vZHVsZTsgLyogZm9yIEVYUE9SVEVEX05BTUVfTlMgKi8KICB9IHU7Cn0gRXhwb3J0ZWROYW1lRW50cnk7Cgp0eXBlZGVmIHN0cnVjdCBHZXRFeHBvcnROYW1lc1N0YXRlIHsKICBKU01vZHVsZURlZioqIG1vZHVsZXM7CiAgaW50IG1vZHVsZXNfc2l6ZTsKICBpbnQgbW9kdWxlc19jb3VudDsKCiAgRXhwb3J0ZWROYW1lRW50cnkqIGV4cG9ydGVkX25hbWVzOwogIGludCBleHBvcnRlZF9uYW1lc19zaXplOwogIGludCBleHBvcnRlZF9uYW1lc19jb3VudDsKfSBHZXRFeHBvcnROYW1lc1N0YXRlOwoKdHlwZWRlZiBzdHJ1Y3QgQ29kZUNvbnRleHQgewogIGNvbnN0IHVpbnQ4X3QqIGJjX2J1ZjsgLyogY29kZSBidWZmZXIgKi8KICBpbnQgYmNfbGVuOyAgICAgICAgICAgIC8qIGxlbmd0aCBvZiB0aGUgY29kZSBidWZmZXIgKi8KICBpbnQgcG9zOyAgICAgICAgICAgICAgIC8qIHBvc2l0aW9uIHBhc3QgdGhlIG1hdGNoZWQgY29kZSBwYXR0ZXJuICovCiAgaW50IGxpbmVfbnVtOyAgICAgICAgICAvKiBsYXN0IHZpc2l0ZWQgT1BfbGluZV9udW0gcGFyYW1ldGVyIG9yIC0xICovCiAgaW50IG9wOwogIGludCBpZHg7CiAgaW50IGxhYmVsOwogIGludCB2YWw7CiAgSlNBdG9tIGF0b207Cn0gQ29kZUNvbnRleHQ7Cgp0eXBlZGVmIHN0cnVjdCBTdGFja1NpemVTdGF0ZSB7CiAgaW50IGJjX2xlbjsKICBpbnQgc3RhY2tfbGVuX21heDsKICB1aW50MTZfdCogc3RhY2tfbGV2ZWxfdGFiOwogIGludCogcGNfc3RhY2s7CiAgaW50IHBjX3N0YWNrX2xlbjsKICBpbnQgcGNfc3RhY2tfc2l6ZTsKfSBTdGFja1NpemVTdGF0ZTsKCnR5cGVkZWYgc3RydWN0IHsKICBKU09iamVjdCogb2JqOwogIHVpbnQzMl90IGhhc2hfbmV4dDsgLyogLTEgaWYgbm8gbmV4dCBlbnRyeSAqLwp9IEpTT2JqZWN0TGlzdEVudHJ5OwoKLyogWFhYOiByZXVzZSBpdCB0byBvcHRpbWl6ZSB3ZWFrIHJlZmVyZW5jZXMgKi8KdHlwZWRlZiBzdHJ1Y3QgewogIEpTT2JqZWN0TGlzdEVudHJ5KiBvYmplY3RfdGFiOwogIGludCBvYmplY3RfY291bnQ7CiAgaW50IG9iamVjdF9zaXplOwogIHVpbnQzMl90KiBoYXNoX3RhYmxlOwogIHVpbnQzMl90IGhhc2hfc2l6ZTsKfSBKU09iamVjdExpc3Q7Cgp0eXBlZGVmIGVudW0gQkNUYWdFbnVtIHsKICBCQ19UQUdfTlVMTCA9IDEsCiAgQkNfVEFHX1VOREVGSU5FRCwKICBCQ19UQUdfQk9PTF9GQUxTRSwKICBCQ19UQUdfQk9PTF9UUlVFLAogIEJDX1RBR19JTlQzMiwKICBCQ19UQUdfRkxPQVQ2NCwKICBCQ19UQUdfU1RSSU5HLAogIEJDX1RBR19PQkpFQ1QsCiAgQkNfVEFHX0FSUkFZLAogIEJDX1RBR19CSUdfSU5ULAogIEJDX1RBR19CSUdfRkxPQVQsCiAgQkNfVEFHX0JJR19ERUNJTUFMLAogIEJDX1RBR19URU1QTEFURV9PQkpFQ1QsCiAgQkNfVEFHX0ZVTkNUSU9OX0JZVEVDT0RFLAogIEJDX1RBR19NT0RVTEUsCiAgQkNfVEFHX1RZUEVEX0FSUkFZLAogIEJDX1RBR19BUlJBWV9CVUZGRVIsCiAgQkNfVEFHX1NIQVJFRF9BUlJBWV9CVUZGRVIsCiAgQkNfVEFHX0RBVEUsCiAgQkNfVEFHX09CSkVDVF9WQUxVRSwKICBCQ19UQUdfT0JKRUNUX1JFRkVSRU5DRSwKfSBCQ1RhZ0VudW07CgojaWZkZWYgQ09ORklHX0JJR05VTQojZGVmaW5lIEJDX0JBU0VfVkVSU0lPTiAyCiNlbHNlCiNkZWZpbmUgQkNfQkFTRV9WRVJTSU9OIDEKI2VuZGlmCiNkZWZpbmUgQkNfQkVfVkVSU0lPTiAweDQwCiNpZmRlZiBXT1JEU19CSUdFTkRJQU4KI2RlZmluZSBCQ19WRVJTSU9OIChCQ19CQVNFX1ZFUlNJT04gfCBCQ19CRV9WRVJTSU9OKQojZWxzZQojZGVmaW5lIEJDX1ZFUlNJT04gQkNfQkFTRV9WRVJTSU9OCiNlbmRpZgoKdHlwZWRlZiBzdHJ1Y3QgQkNXcml0ZXJTdGF0ZSB7CiAgSlNDb250ZXh0KiBjdHg7CiAgRHluQnVmIGRidWY7CiAgQk9PTCBieXRlX3N3YXAgOiA4OwogIEJPT0wgYWxsb3dfYnl0ZWNvZGUgOiA4OwogIEJPT0wgYWxsb3dfc2FiIDogODsKICBCT09MIGFsbG93X3JlZmVyZW5jZSA6IDg7CiAgdWludDMyX3QgZmlyc3RfYXRvbTsKICB1aW50MzJfdCogYXRvbV90b19pZHg7CiAgaW50IGF0b21fdG9faWR4X3NpemU7CiAgSlNBdG9tKiBpZHhfdG9fYXRvbTsKICBpbnQgaWR4X3RvX2F0b21fY291bnQ7CiAgaW50IGlkeF90b19hdG9tX3NpemU7CiAgdWludDhfdCoqIHNhYl90YWI7CiAgaW50IHNhYl90YWJfbGVuOwogIGludCBzYWJfdGFiX3NpemU7CiAgLyogbGlzdCBvZiByZWZlcmVuY2VkIG9iamVjdHMgKHVzZWQgaWYgYWxsb3dfcmVmZXJlbmNlID0gVFJVRSkgKi8KICBKU09iamVjdExpc3Qgb2JqZWN0X2xpc3Q7Cn0gQkNXcml0ZXJTdGF0ZTsKCnR5cGVkZWYgc3RydWN0IEJDUmVhZGVyU3RhdGUgewogIEpTQ29udGV4dCogY3R4OwogIGNvbnN0IHVpbnQ4X3QgKmJ1Zl9zdGFydCwgKnB0ciwgKmJ1Zl9lbmQ7CiAgdWludDMyX3QgZmlyc3RfYXRvbTsKICB1aW50MzJfdCBpZHhfdG9fYXRvbV9jb3VudDsKICBKU0F0b20qIGlkeF90b19hdG9tOwogIGludCBlcnJvcl9zdGF0ZTsKICBCT09MIGFsbG93X3NhYiA6IDg7CiAgQk9PTCBhbGxvd19ieXRlY29kZSA6IDg7CiAgQk9PTCBpc19yb21fZGF0YSA6IDg7CiAgQk9PTCBhbGxvd19yZWZlcmVuY2UgOiA4OwogIC8qIG9iamVjdCByZWZlcmVuY2VzICovCiAgSlNPYmplY3QqKiBvYmplY3RzOwogIGludCBvYmplY3RzX2NvdW50OwogIGludCBvYmplY3RzX3NpemU7CgojaWZkZWYgRFVNUF9SRUFEX09CSkVDVAogIGNvbnN0IHVpbnQ4X3QqIHB0cl9sYXN0OwogIGludCBsZXZlbDsKI2VuZGlmCn0gQkNSZWFkZXJTdGF0ZTsKCnR5cGVkZWYgc3RydWN0IHsKICBzdHJ1Y3QgbGlzdF9oZWFkIGxpbms7CiAgaW50IGZkOwogIEpTVmFsdWUgcndfZnVuY1syXTsKICBzc2l6ZV90IGlwZmQ7Cn0gSlNPU1JXSGFuZGxlcjsKCnR5cGVkZWYgc3RydWN0IHsKICBzdHJ1Y3QgbGlzdF9oZWFkIGxpbms7CiAgaW50IHNpZ19udW07CiAgSlNWYWx1ZSBmdW5jOwp9IEpTT1NTaWduYWxIYW5kbGVyOwoKdHlwZWRlZiBzdHJ1Y3QgewogIHN0cnVjdCBsaXN0X2hlYWQgbGluazsKICBCT09MIGhhc19vYmplY3Q7CiAgaW50NjRfdCB0aW1lb3V0OwogIEpTVmFsdWUgZnVuYzsKfSBKU09TVGltZXI7Cgp0eXBlZGVmIHN0cnVjdCB7CiAgc3RydWN0IGxpc3RfaGVhZCBsaW5rOwogIHVpbnQ4X3QqIGRhdGE7CiAgc2l6ZV90IGRhdGFfbGVuOwogIC8qIGxpc3Qgb2YgU2hhcmVkQXJyYXlCdWZmZXJzLCBuZWNlc3NhcnkgdG8gZnJlZSB0aGUgbWVzc2FnZSAqLwogIHVpbnQ4X3QqKiBzYWJfdGFiOwogIHNpemVfdCBzYWJfdGFiX2xlbjsKfSBKU1dvcmtlck1lc3NhZ2U7Cgp0eXBlZGVmIHN0cnVjdCB7CiAgaW50IHJlZl9jb3VudDsKI2lmZGVmIFVTRV9XT1JLRVIKICBwdGhyZWFkX211dGV4X3QgbXV0ZXg7CiNlbmRpZgogIHN0cnVjdCBsaXN0X2hlYWQgbXNnX3F1ZXVlOyAvKiBsaXN0IG9mIEpTV29ya2VyTWVzc2FnZS5saW5rICovCiAgaW50IHJlYWRfZmQ7CiAgaW50IHdyaXRlX2ZkOwogIHNzaXplX3QgaXBmZDsKfSBKU1dvcmtlck1lc3NhZ2VQaXBlOwoKdHlwZWRlZiBzdHJ1Y3QgewogIHN0cnVjdCBsaXN0X2hlYWQgbGluazsKICBKU1dvcmtlck1lc3NhZ2VQaXBlKiByZWN2X3BpcGU7CiAgSlNWYWx1ZSBvbl9tZXNzYWdlX2Z1bmM7Cn0gSlNXb3JrZXJNZXNzYWdlSGFuZGxlcjsKCnR5cGVkZWYgc3RydWN0IEpTVGhyZWFkU3RhdGUgewogIHN0cnVjdCBsaXN0X2hlYWQgb3NfcndfaGFuZGxlcnM7ICAgICAvKiBsaXN0IG9mIEpTT1NSV0hhbmRsZXIubGluayAqLwogIHN0cnVjdCBsaXN0X2hlYWQgb3Nfc2lnbmFsX2hhbmRsZXJzOyAvKiBsaXN0IEpTT1NTaWduYWxIYW5kbGVyLmxpbmsgKi8KICBzdHJ1Y3QgbGlzdF9oZWFkIG9zX3RpbWVyczsgICAgICAgICAgLyogbGlzdCBvZiBKU09TVGltZXIubGluayAqLwogIHN0cnVjdCBsaXN0X2hlYWQgcG9ydF9saXN0OyAgICAgICAgICAvKiBsaXN0IG9mIEpTV29ya2VyTWVzc2FnZUhhbmRsZXIubGluayAqLwogIGludCBldmFsX3NjcmlwdF9yZWN1cnNlOyAgICAgICAgICAgICAvKiBvbmx5IHVzZWQgaW4gdGhlIG1haW4gdGhyZWFkICovCiAgLyogbm90IHVzZWQgaW4gdGhlIG1haW4gdGhyZWFkICovCiAgSlNXb3JrZXJNZXNzYWdlUGlwZSAqcmVjdl9waXBlLCAqc2VuZF9waXBlOwp9IEpTVGhyZWFkU3RhdGU7Cgp0eXBlZGVmIHN0cnVjdCB7CiAgaW50IHJlZl9jb3VudDsKICB1aW50NjRfdCBidWZbMF07Cn0gSlNTQUJIZWFkZXI7Cgp0eXBlZGVmIHN0cnVjdCB7CiAgRklMRSogZjsKICBCT09MIGNsb3NlX2luX2ZpbmFsaXplcjsKICBCT09MIGlzX3BvcGVuOwp9IEpTU1RERmlsZTsKCkJPT0wgSlNfSXNVbmNhdGNoYWJsZUVycm9yKEpTQ29udGV4dCosIEpTVmFsdWVDb25zdCk7CgojZW5kaWYgLyogZGVmaW5lZChRSlNfTU9EVUxFU19JTlRFUk5BTF9IKSAqLwoAAAAAAAAAAIiSAAAAAAAAAAAAAAAAAAAAAAAAiJIAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8L8"
				]
			]
		},
		{
			"file": "quickjs/qjs-modules/src/js-utils.c",
			"settings":
			{
				"buffer_size": 3373,
				"line_ending": "Unix"
			}
		},
		{
			"file": "quickjs/qjs-modules/src/utils.c",
			"settings":
			{
				"buffer_size": 88554,
				"line_ending": "Unix"
			}
		},
		{
			"file": "/usr/include/sqlite3.h",
			"settings":
			{
				"buffer_size": 576161,
				"line_ending": "Unix"
			}
		}
	],
	"build_system": "",
	"build_system_choices":
	[
	],
	"build_varint": "",
	"command_palette":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
			[
				"outline",
				"Browse Mode: Outline (Right)"
			],
			[
				"prettier",
				"JsPrettier: Format Code"
			],
			[
				"pre",
				"Project: Edit Project"
			],
			[
				"prett",
				"JsPrettier: Format Code"
			],
			[
				"",
				"Auto indent"
			],
			[
				"out",
				"Browse Mode: Outline (Right)"
			],
			[
				"list pack",
				"Package Control: List Packages"
			],
			[
				"install",
				"Package Control: Install Package"
			],
			[
				"edit ",
				"Color Scheme Editor: Edit current color scheme"
			],
			[
				"edit",
				"Color Scheme Editor: Edit current color scheme"
			],
			[
				"remove",
				"Package Control: Remove Package"
			],
			[
				"outli",
				"Browse Mode: Outline (Right)"
			],
			[
				"debugger",
				"Preferences: Debugger Settings"
			],
			[
				"add re",
				"Package Control: Add Repository"
			],
			[
				"scheme",
				"Color Scheme Editor: Edit current color scheme"
			],
			[
				"outlin",
				"Browse Mode: Outline (Right)"
			],
			[
				"INSTALL",
				"Package Control: Install Package"
			],
			[
				"disable",
				"Package Control: Disable Package"
			],
			[
				"Package Control: disable",
				"Package Control: Disable Package"
			],
			[
				"Package Control: ",
				"Package Control: Disable Package"
			],
			[
				"adap",
				"Debugger: Install Adapters"
			],
			[
				"install ada",
				"Debugger: Install Adapters"
			],
			[
				"adapter",
				"Debugger: Install Adapters"
			],
			[
				"debug",
				"Debugger: Install Adapters"
			],
			[
				"Package Control: remove",
				"Package Control: Remove Package"
			],
			[
				"debu",
				"Debugger: Install Adapters"
			],
			[
				"instal",
				"Package Control: Install Package"
			]
		],
		"width": 0.0
	},
	"console":
	{
		"height": 289.0,
		"history":
		[
		]
	},
	"distraction_free":
	{
		"menu_visible": true,
		"show_minimap": false,
		"show_open_files": false,
		"show_tabs": false,
		"side_bar_visible": false,
		"status_bar_visible": false
	},
	"expanded_folders":
	[
		"/home/roman/Projects/plot-cv"
	],
	"file_history":
	[
		"/home/roman/Projects/plot-cv/quickjs/run-test262.c",
		"/home/roman/Projects/plot-cv/quickjs/quickjs.c",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/quickjs-internal.h",
		"/home/roman/Projects/plot-cv/quickjs/quickjs.h",
		"/home/roman/Projects/plot-cv/quickjs/qjs-net/build-libwebsockets.sh",
		"/home/roman/Projects/plot-cv/quickjs/qjs-net/build/build.ninja",
		"/home/roman/Projects/plot-cv/lib/misc.js",
		"/home/roman/Projects/plot-cv/lib/util.js",
		"/home/roman/Projects/plot-cv/lib/fd-graph.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/textElement.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/symbol.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/pin.js",
		"/home/roman/Projects/plot-cv/555-PWM-Motor-Speed-Controller-alt-schematic.svg",
		"/home/roman/Projects/plot-cv/555-PWM-Motor-Speed-Controller-alt-board.svg",
		"/home/roman/Projects/an-tronics/eagle/555-PWM-Motor-Speed-Controller-alt.brd",
		"/home/roman/Projects/an-tronics/eagle/555-PWM-Motor-Speed-Controller-alt.sch",
		"/home/roman/Projects/plot-cv/lib/geom/matrix.js",
		"/home/roman/Projects/plot-cv/ast-shell.js",
		"/home/roman/Projects/plot-cv/draw.js",
		"/home/roman/Projects/plot-cv/lib/eagle/renderUtils.js",
		"/home/roman/Projects/plot-cv/lib/geom/transformation.js",
		"/home/roman/Projects/plot-cv/lib/dsp/util.js",
		"/home/roman/Projects/plot-cv/Zeichnung.svg",
		"/home/roman/Projects/plot-cv/lib/eagle/svg/ZoomRedraw.svg",
		"/home/roman/Projects/plot-cv/eagle-shell.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/text.js",
		"/home/roman/Projects/plot-cv/lib/eagle/schematicRenderer.js",
		"/home/roman/Projects/plot-cv/lib/eagle/svgRenderer.js",
		"/home/roman/Projects/plot-cv/lib/geom/size.js",
		"/home/roman/Projects/plot-cv/lib/eagle/document.js",
		"/home/roman/Projects/plot-cv/lib/geom/point.js",
		"/home/roman/Projects/plot-cv/lib/geom/line.js",
		"/home/roman/Projects/plot-cv/qjs-opencv/line.js",
		"/home/roman/Projects/plot-cv/lib/geom/rect.js",
		"/home/roman/Projects/plot-cv/lib/eagle/boardRenderer.js",
		"/home/roman/Projects/plot-cv/eagle2svg.js",
		"/home/roman/Projects/plot-cv/lib/eagle/project.js",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/lib/util.js",
		"/home/roman/Projects/plot-cv/lib/eagle/nodeList.js",
		"/home/roman/Projects/plot-cv/lib/eagle/element.js",
		"/home/roman/Projects/plot-cv/lib/eagle/common.js",
		"/home/roman/Projects/plot-cv/lib/dom/preactComponent.js",
		"/home/roman/Projects/plot-cv/lib/eagle/node.js",
		"/home/roman/Projects/plot-cv/lib/eagle/ref.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/grid.js",
		"/home/roman/Projects/plot-cv/lib/eagle/elementProxy.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/smd.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/wirePath.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/wire.js",
		"/home/roman/Projects/plot-cv/lib/eagle/nodeMap.js",
		"/home/roman/Projects/plot-cv/lib/eagle/renderer.js",
		"/home/roman/Projects/plot-cv/resolve-imports.js",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/resolve-imports.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/circle.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/pad.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/via.js",
		"/home/roman/Projects/plot-cv/lib/eagle/libraryRenderer.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components.js",
		"/home/roman/Projects/plot-cv/quickjs/cmake/functions.cmake",
		"/home/roman/Projects/plot-cv/qjs-opencv/cmake/functions.cmake",
		"/home/roman/Projects/plot-cv/cmake/functions.cmake",
		"/home/roman/Projects/plot-cv/lib/container/spatial-hash.js",
		"/home/roman/Projects/plot-cv/lib/container/Hash-Multimap.js",
		"/home/roman/Projects/plot-cv/lib/container/componentMap.js",
		"/home/roman/Projects/plot-cv/lib/container/multikeymap.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/drawing.js",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/quickjs-misc.c",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/util-w-2.diff",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/new.diff",
		"/home/roman/Projects/plot-cv/lib/eda/colorCoding.js",
		"/home/roman/Projects/plot-cv/eagle-commands.js",
		"/home/roman/Projects/plot-cv/upload.js",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/xml-shell.js",
		"/home/roman/Projects/plot-cv/upload-server.js",
		"/home/roman/Projects/plot-cv/lib/color/rgba.js",
		"/home/roman/Projects/plot-cv/lib/delegate.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/package.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/element.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/origin.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/board.js",
		"/home/roman/Projects/plot-cv/lib/json/pathMapper.js",
		"/home/roman/Projects/plot-cv/eagle-query.js",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/lib/xpath.js",
		"/home/roman/Dokumente/Electronics/example.circuit",
		"/home/roman/Projects/plot-cv/circuit.js",
		"/home/roman/Projects/pictest/eagle/OpenProg-18F2550.brd",
		"/home/roman/Projects/plot-cv/OpenProg-18F2550.circuit",
		"/home/roman/Projects/plot-cv/read.hex",
		"/home/roman/Projects/plot-cv/test-bitset.js",
		"/home/roman/Projects/plot-cv/example.circuit",
		"/home/roman/Projects/plot-cv/test-circuit.js",
		"/home/roman/Projects/plot-cv/OProg-18F2550.hex",
		"/home/roman/Projects/plot-cv/lib/async/events.js",
		"/home/roman/Projects/plot-cv/lib/async/websocket.js",
		"/home/roman/Projects/plot-cv/lib/repeater/repeater.js",
		"/home/roman/Projects/plot-cv/eagle2gerber.js",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/tests/test_treewalker.js",
		"/home/roman/Projects/plot-cv/lib/geom/bbox.js",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/lib/fs.js",
		"/home/roman/Projects/plot-cv/svg-crop-pad.js",
		"/home/roman/Projects/plot-cv/fire.js",
		"/home/roman/Projects/plot-cv/quickjs/qjs-net/src/plugins/mirror.c",
		"/home/roman/Projects/plot-cv/fire.html",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/list-exports.js",
		"/home/roman/Projects/plot-cv/lib/stream/utils.js",
		"/home/roman/Projects/plot-cv/string-helpers.js",
		"/home/roman/Projects/plot-cv/test-bjson.js",
		"/home/roman/Projects/plot-cv/bjson.js",
		"/home/roman/Projects/plot-cv/clang-ast.js",
		"/home/roman/Projects/plot-cv/openlayers/examples/wms-tiled-wrap-180.html",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/quickjs-pointer.c",
		"/home/roman/Projects/plot-cv/plot-cv.sublime-project",
		"/home/roman/Projects/plot-cv/test-debuggerprotocol.js",
		"/home/roman/Projects/plot-cv/lib/iterator/helpers.js",
		"/home/roman/Projects/plot-cv/lib/stream.js",
		"/home/roman/Projects/plot-cv/filelist.js",
		"/home/roman/Projects/plot-cv/quickjs/qjs-net/minnet-server-ws.c",
		"/home/roman/Projects/plot-cv/quickjs/qjs-net/minnet-server-http.c",
		"/home/roman/Projects/plot-cv/lib/hooks/useAsyncIterator.js",
		"/home/roman/Projects/plot-cv/lib/hooks/useAsyncGenerator.js",
		"/home/roman/Projects/plot-cv/filelist.html",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/lib/extendGenerator.js",
		"/home/roman/Projects/plot-cv/main.js",
		"/home/roman/Projects/plot-cv/index.html",
		"/home/roman/Projects/plot-cv/test-gpio.js",
		"/home/roman/Projects/plot-cv/upload.html",
		"/home/roman/Projects/pic-programmer/a-p-prog/fw/pp/pp.ino",
		"/home/roman/Projects/plot-cv/fontsample.js"
	],
	"find":
	{
		"height": 38.0
	},
	"find_in_files":
	{
		"height": 142.0,
		"where_history":
		[
			"/home/roman/Projects/plot-cv/lib/eagle,*.js,-*/build/*,-*/inst/*",
			"<open files>,/home/roman/Projects/plot-cv,*.js,-*/build/*,-*/inst/*",
			"/home/roman/Projects/plot-cv,*.js,-*/build/*,-*/inst/*",
			"/home/roman/Projects/plot-cv,*.js,-*/build/*",
			"/home/roman/Projects/plot-cv,*.js",
			""
		]
	},
	"find_state":
	{
		"case_sensitive": true,
		"find_history":
		[
			"pr\\[",
			"'pr",
			"isNative",
			"is[A-Za-z]*Function",
			"is.*Function",
			"returnType",
			"FunctionDecl",
			", js_value_typestr(ctx, stack)",
			"stack",
			"error_prin",
			"str",
			"error_prin",
			"jsm_dump",
			"print_err",
			"js_load_file",
			"js_eval_file",
			"generateDoc",
			"exp",
			"MakeFFI",
			"function.*FFI",
			"PROMISE_REJE",
			"JS_GetBigInt",
			"cur_func = fd",
			"goto except",
			"JS_FreeValue.*m->module",
			"js_dynamic_import_reject\\(",
			"JS_MarkValue.*module_ns",
			"_call2\\(",
			"call2",
			"js_evaluate_module",
			"js_evaluate_moduel",
			"NewClass1",
			"emit_op\\(s, OP_ret",
			"has_ex",
			"clean:",
			"eval_has",
			"eval_has_ex",
			"\\(JS_IsEx",
			"JS_IsEx",
			"JSPromiseFunctionDataResolved",
			"emit_op.*OP_return_undef",
			"OP_return_undef",
			"eval_has_ex",
			"module_ns",
			"module_nas",
			"struct JSModuleDef",
			"JSModuleDef",
			"3\\.1\\.0",
			"\\.\\.\\/",
			"range",
			"range =",
			"Tracked",
			"'kind'",
			"kind",
			"'kind'",
			"map\\(",
			"roundTo",
			"R",
			"R2",
			"parentRot",
			"log",
			"const",
			"TransformationList",
			"rot=\"M",
			"transformation",
			"vec",
			"transform",
			"R2<",
			"R2",
			"children.push(\n      h('circle', {\n        class: 'pin-x',\n        stroke: '#ff00ff',\n        fill: 'none',\n        cx: tp.x,\n        cy: tp.y,\n        r: 0.5,\n        'stroke-width': 0.1\n      })\n    );\n    children.push(\n      h('circle', {\n        class: 'pin-y',\n        stroke: '#4219ff',\n        opacity: 0.8,\n        fill: 'none',\n        cx: x,\n        cy: y,\n        r: 0.75,\n        'stroke-width': 0.1\n      })\n    );",
			"IC1<",
			"font-size:",
			"console\\.",
			");\n",
			"<pin",
			"transform",
			"tp =",
			"IC1\"",
			"IC1",
			"name",
			"555_ALT",
			"IC1\"",
			"IC1",
			"Fragment",
			")]));",
			"'SVGRenderer",
			"Renderer\\.render",
			"\\.render",
			"svg\\(",
			"elem",
			"555_ALT3",
			"IC1\"",
			"isNumeric.*parseFloat",
			"indexOf",
			"'value'",
			"'element'",
			"'element'w",
			"'element'",
			"'value'",
			"get value",
			"D1\"",
			"renderItem",
			"renderItem'",
			"round =",
			"roundTo =",
			"round =",
			"inspect",
			"toStringTag",
			"getBounds",
			"getOther",
			"getOther =",
			"getOther",
			"getOther =",
			"getOther",
			"quot =",
			"console\\.log",
			"console.log",
			"renderItem",
			"^(\\s*)console\\.",
			"lazyOpen",
			"replaceProperty",
			"addLib",
			"Util",
			"Util\\.",
			"})();\n",
			"ifThenElse",
			"Util\\.",
			"isIterable"
		],
		"highlight": true,
		"in_selection": false,
		"preserve_case": false,
		"regex": true,
		"replace_history":
		[
			"3.0.2",
			"$srcdir/",
			"",
			"'EagleSVGRenderer",
			"this.debug",
			"\\1//console.",
			"isFunction(\\1)",
			"",
			"\\1",
			"is",
			"define",
			"!isString(\\1)",
			"!isFunction(\\1)",
			"isObject(\\1)",
			"isFunction(\\1)",
			"diff --git a/lib/util.js b/lib/util.js\nindex ab76720..001e53e 100644\n--- a/lib/util.js\n+++ b/lib/util.js\n@@",
			"function \\1(\\2) {",
			"function \\1(\\2)",
			"!isString(\\1)",
			"types.isBigInt(\\1)",
			"!isObject(\\1)",
			"isSymbol(\\1)",
			"isString(\\1)",
			"isObject(\\1)",
			"isNumber(\\1)",
			"!isFunction(\\1)",
			"!isString(\\1)",
			"isNumber(\\1)",
			"isString(\\1)",
			"isObject(\\1)",
			"isFunction(\\1)",
			"",
			"^\\1//this.debug",
			"'./components",
			"}\\n\\n\\1",
			"this.circuit",
			"",
			"\\1//console",
			"packageToPosMap",
			"(this.parse",
			"line",
			"maxDepthOrPred",
			"define",
			"isObject",
			"\\1//\\2",
			""
		],
		"reverse": false,
		"scrollbar_highlights": true,
		"show_context": true,
		"use_buffer2": true,
		"use_gitignore": true,
		"whole_word": false,
		"wrap": true
	},
	"groups":
	[
		{
			"sheets":
			[
				{
					"buffer": 0,
					"selected": true,
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 1945,
						"regions":
						{
							"col_0000FFFF":
							{
								"flags": 16,
								"regions":
								[
									[
										1945,
										1945
									]
								],
								"scope": "col_0000FFFF"
							},
							"col_0000FFFF_icon":
							{
								"flags": 16,
								"icon": "Packages/User/Color Highlight.cache/col_0000FFFF_circle.png",
								"regions":
								[
									[
										1945,
										1945
									]
								],
								"scope": "col_gutter"
							},
							"col_008000FF":
							{
								"flags": 16,
								"regions":
								[
									[
										1945,
										1945
									]
								],
								"scope": "col_008000FF"
							},
							"col_008000FF_icon":
							{
								"flags": 16,
								"icon": "Packages/User/Color Highlight.cache/col_008000FF_circle.png",
								"regions":
								[
									[
										1945,
										1945
									]
								],
								"scope": "col_gutter"
							},
							"col_FF0000FF":
							{
								"flags": 16,
								"regions":
								[
									[
										1945,
										1945
									]
								],
								"scope": "col_FF0000FF"
							},
							"col_FF0000FF_icon":
							{
								"flags": 16,
								"icon": "Packages/User/Color Highlight.cache/col_FF0000FF_circle.png",
								"regions":
								[
									[
										1945,
										1945
									]
								],
								"scope": "col_gutter"
							}
						},
						"selection":
						[
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"current_file": "/home/roman/Projects/plot-cv/upload-server.js",
							"function_name_status_row": 22,
							"outline_rename_mode": false,
							"symkeys":
							[
								[
									2010,
									2018
								],
								[
									2034,
									2054
								],
								[
									2625,
									2658
								],
								[
									2748,
									2779
								],
								[
									3105,
									3127
								],
								[
									3341,
									3382
								],
								[
									3393,
									3406
								],
								[
									3484,
									3519
								],
								[
									3564,
									3582
								],
								[
									3618,
									3660
								],
								[
									3726,
									3759
								],
								[
									3781,
									3785
								],
								[
									4174,
									4179
								],
								[
									4229,
									4233
								],
								[
									4260,
									4264
								],
								[
									4292,
									4296
								],
								[
									4319,
									4339
								],
								[
									4393,
									4397
								],
								[
									4467,
									4489
								],
								[
									4579,
									4584
								],
								[
									4616,
									4638
								],
								[
									4832,
									4854
								],
								[
									5277,
									5343
								],
								[
									5689,
									5698
								],
								[
									5803,
									5833
								],
								[
									6194,
									6229
								],
								[
									6261,
									6302
								],
								[
									6334,
									6400
								],
								[
									6433,
									6467
								],
								[
									6538,
									6585
								],
								[
									7121,
									7157
								],
								[
									7270,
									7279
								],
								[
									7515,
									7523
								],
								[
									7629,
									7636
								],
								[
									7686,
									7710
								],
								[
									8091,
									8102
								],
								[
									8192,
									8203
								],
								[
									8267,
									8278
								],
								[
									8332,
									8341
								],
								[
									8379,
									8390
								],
								[
									8478,
									8505
								],
								[
									8643,
									8647
								],
								[
									8671,
									8678
								],
								[
									8711,
									8727
								],
								[
									8856,
									8901
								],
								[
									9117,
									9175
								],
								[
									9487,
									9509
								],
								[
									9858,
									9868
								],
								[
									10112,
									10126
								],
								[
									11079,
									11103
								],
								[
									11229,
									11233
								],
								[
									11325,
									11339
								],
								[
									11439,
									11455
								],
								[
									11809,
									11822
								],
								[
									11840,
									11845
								],
								[
									11927,
									11934
								],
								[
									11962,
									11967
								],
								[
									12089,
									12114
								],
								[
									12289,
									12328
								],
								[
									12405,
									12416
								],
								[
									13983,
									14014
								],
								[
									14677,
									14710
								],
								[
									14982,
									15017
								],
								[
									15102,
									15135
								],
								[
									16074,
									16080
								],
								[
									16850,
									16854
								],
								[
									17297,
									17304
								],
								[
									17697,
									17733
								],
								[
									17947,
									17951
								],
								[
									18449,
									18481
								],
								[
									19084,
									19088
								],
								[
									19609,
									19626
								],
								[
									19928,
									19963
								],
								[
									20811,
									20816
								],
								[
									21543,
									21547
								],
								[
									21641,
									21645
								],
								[
									21765,
									21774
								],
								[
									21904,
									21911
								],
								[
									22192,
									22199
								],
								[
									22280,
									22287
								],
								[
									22351,
									22367
								],
								[
									22432,
									22452
								],
								[
									23151,
									23163
								],
								[
									23262,
									23274
								],
								[
									23476,
									23492
								],
								[
									23586,
									23599
								],
								[
									23875,
									23893
								],
								[
									24083,
									24112
								],
								[
									24520,
									24539
								],
								[
									24972,
									24993
								],
								[
									26014,
									26036
								],
								[
									26509,
									26530
								],
								[
									27081,
									27100
								],
								[
									27534,
									27542
								],
								[
									30245,
									30257
								],
								[
									32104,
									32139
								],
								[
									32812,
									32831
								],
								[
									32939,
									32955
								],
								[
									33090,
									33107
								],
								[
									33152,
									33165
								],
								[
									33201,
									33211
								],
								[
									34065,
									34081
								],
								[
									34170,
									34189
								],
								[
									34200,
									34219
								],
								[
									34245,
									34265
								]
							],
							"symlist":
							[
								"  value =>",
								"\t(level, message) =>",
								"AsyncCollect(iter)",
								"ExecTool(cmd, ...args)",
								"GetMime(file)",
								"Matcher(pattern, t = arg => arg)",
								"\t(...args) =>",
								"KeyOrValueMatcher(pattern)",
								"\t([key, value]) =>",
								"GetRootDirectories(pattern = '*')",
								"MakeUUID = (rng = Math.random) =>",
								"  n =>",
								"  dd =>",
								"  d =>",
								"  d =>",
								"  d =>",
								"GetDir(dir)",
								"  n =>",
								"DirName(name)",
								"  it =>",
								"DateStr(date)",
								"ModeStr(mode)",
								"HTMLPage = ({ title, style, scripts = [], children, ...props }) =>",
								"  script =>",
								"FilterForm = ({ ...props }) =>",
								"HTMLTable = ({ rows, ...props }) =>",
								"HTMLTableRow = ({ columns, ...props }) =>",
								"HTMLTableColumn = ({ columns, children, tag = 'td', ...props }) =>",
								"FileLink = ({ file, ...props }) =>",
								"FileObject = ({ file, stat = {}, ...props }) =>",
								"FileTable = ({ files, ...props }) =>",
								"(a, b) =>",
								"  field =>",
								"  file =>",
								"ReadExiv2(file)",
								"([k, v]) =>",
								"([k, v]) =>",
								"([k, v]) =>",
								"(a, b) =>",
								"([k, v]) =>",
								"ReadExiftool(file)",
								"  l =>",
								"  line =>",
								"([line, idx]) =>",
								"HeifConvert(src, dst, quality = 100)",
								"MagickResize(src, dst, rotate = 0, width, height)",
								"  main(...args)",
								"\t(a, v) =>",
								"\t(v, pv, o) =>",
								"\t(module, ...args) =>",
								"  m =>",
								"  .show = arg =>",
								"  .cleanup = () =>",
								"\t(...args) =>",
								"() =>",
								"  puts(s)",
								"() =>",
								"ParseBody(gen)",
								"  .createWS = (url, callbacks, listen) =>",
								"  .out = s =>",
								"  test(req, resp)",
								"  proxy(req, resp)",
								"  config(req, resp)",
								"  file(req, resp)",
								"  dir =>",
								"  f =>",
								"  file =>",
								"  uploads(req, resp)",
								"  s =>",
								"  files(req, resp)",
								"  n =>",
								"([name, type]) =>",
								"  files2(req, resp)",
								"\tn =>",
								"  n =>",
								"  n =>",
								"(a, b) =>",
								"  name =>",
								"  file =>",
								"  file =>",
								"([file, rel]) =>",
								"(acc, [file, st]) =>",
								"  string(a, b)",
								"  number(a, b)",
								"([name, obj]) =>",
								"({ name }) =>",
								"  onConnect(ws, req)",
								"  .sendCommand = function(data)",
								"  onClose(ws, reason)",
								"  onHttp(ws, req, resp)",
								"  onOpen(name, filename)",
								"  onContent(name, data)",
								"  onClose(name, file)",
								"  f = x =>",
								"  onFinalize()",
								"\t(match, p1, p0, p2, p3, offset) =>",
								"  onMessage(ws, data)",
								"  onFd(fd, rd, wr)",
								"  get connections()",
								"  get by_uuid()",
								"  uuid(data)",
								"  onFd(fd, rd, wr)",
								"  onClose(ws, reason)",
								"  onMessage(ws, data)",
								"  quit(why)"
							],
							"syntax": "Packages/Outline/outline.hidden-tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1679204948.35,
							"tabs_extra_last_activated_sheet_index": 0,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 0,
					"stack_multiselect": false,
					"type": "text"
				}
			]
		},
		{
			"sheets":
			[
				{
					"buffer": 1,
					"file": "upload-server.js",
					"selected": true,
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 34600,
						"regions":
						{
						},
						"selection":
						[
							[
								14830,
								14833
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 484,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1679267246.9,
							"tabs_extra_last_activated_sheet_index": 0,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 5884.0,
						"zoom_level": 1.0
					},
					"stack_index": 0,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 2,
					"file": "clang-ast.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 79597,
						"regions":
						{
						},
						"selection":
						[
							[
								24473,
								24473
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 809,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1679232847.27,
							"tabs_extra_last_activated_sheet_index": 1,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 51.0,
						"translation.y": 12045.0,
						"zoom_level": 1.0
					},
					"stack_index": 7,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 3,
					"file": "io-helpers.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 11744,
						"regions":
						{
						},
						"selection":
						[
							[
								3277,
								3277
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 126,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1679233457.57,
							"tabs_extra_last_activated_sheet_index": 2,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 1275.0,
						"zoom_level": 1.0
					},
					"stack_index": 6,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 4,
					"file": "quickjs/qjs-modules/lib/util.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 60278,
						"regions":
						{
						},
						"selection":
						[
							[
								2086,
								2094
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 42,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1679204156.67,
							"tabs_extra_last_activated_sheet_index": 3,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 255.0,
						"zoom_level": 1.0
					},
					"stack_index": 5,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 5,
					"file": "ast-shell.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 39942,
						"regions":
						{
						},
						"selection":
						[
							[
								30539,
								30550
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 1051,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1679226506.59,
							"tabs_extra_last_activated_sheet_index": 1,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 15339.0,
						"zoom_level": 1.0
					},
					"stack_index": 12,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 6,
					"file": "sqlite3.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 3858,
						"regions":
						{
						},
						"selection":
						[
							[
								143,
								143
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 3,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1679211668.53,
							"tabs_extra_last_activated_sheet_index": 5,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 4,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 7,
					"file": "test-sqlite3.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 778,
						"regions":
						{
						},
						"selection":
						[
							[
								770,
								770
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 11,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1679211668.94,
							"tabs_extra_last_activated_sheet_index": 6,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 3,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 8,
					"file": "quickjs/qjs-modules/src/qjsm.c",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 45849,
						"regions":
						{
						},
						"selection":
						[
							[
								9479,
								9479
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 390,
							"syntax": "Packages/C++/C.sublime-syntax",
							"tab_size": 2,
							"tabs_extra_last_activated": 1679211669.42,
							"tabs_extra_last_activated_sheet_index": 7,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 5490.0,
						"zoom_level": 1.0
					},
					"stack_index": 2,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 9,
					"file": "quickjs/quickjs.c",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 1522746,
						"regions":
						{
						},
						"selection":
						[
							[
								786543,
								786543
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 26781,
							"syntax": "Packages/C++/C.sublime-syntax",
							"tab_size": 2,
							"tabs_extra_last_activated": 1679211669.94,
							"tabs_extra_last_activated_sheet_index": 8,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 401715.0,
						"zoom_level": 1.0
					},
					"stack_index": 1,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 10,
					"file": "quickjs/qjs-modules/quickjs-internal.h",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 37512,
						"regions":
						{
						},
						"selection":
						[
							[
								0,
								0
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 0,
							"syntax": "Packages/C++11/C++11.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1679229944.24,
							"tabs_extra_last_activated_sheet_index": 6,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 8,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 11,
					"file": "quickjs/qjs-modules/src/js-utils.c",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 3373,
						"regions":
						{
						},
						"selection":
						[
							[
								42,
								45
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 3,
							"syntax": "Packages/C++/C.sublime-syntax",
							"tab_size": 2,
							"tabs_extra_last_activated": 1679229129.15,
							"tabs_extra_last_activated_sheet_index": 5,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 10,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 12,
					"file": "quickjs/qjs-modules/src/utils.c",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 88554,
						"regions":
						{
						},
						"selection":
						[
							[
								62349,
								62349
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 2399,
							"syntax": "Packages/C++/C.sublime-syntax",
							"tab_size": 2,
							"tabs_extra_last_activated": 1679229128.29,
							"tabs_extra_last_activated_sheet_index": 6,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 35595.0,
						"zoom_level": 1.0
					},
					"stack_index": 9,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 13,
					"file": "/usr/include/sqlite3.h",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 576161,
						"regions":
						{
						},
						"selection":
						[
							[
								162502,
								162502
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 3222,
							"syntax": "Packages/C++11/C++11.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1679228952.88,
							"tabs_extra_last_activated_sheet_index": 7,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 47955.0,
						"zoom_level": 1.0
					},
					"stack_index": 11,
					"stack_multiselect": false,
					"type": "text"
				}
			]
		}
	],
	"incremental_find":
	{
		"height": 24.0
	},
	"input":
	{
		"height": 42.0
	},
	"layout":
	{
		"cells":
		[
			[
				2,
				0,
				3,
				2
			],
			[
				0,
				0,
				2,
				2
			]
		],
		"cols":
		[
			0.0,
			0.2,
			0.8,
			1.0
		],
		"rows":
		[
			0.0,
			0.5,
			1.0
		]
	},
	"menu_visible": true,
	"output.Debugger":
	{
		"height": 0.0
	},
	"output.Debugger Console":
	{
		"height": 0.0
	},
	"output.find_results":
	{
		"height": 0.0
	},
	"pinned_build_system": "",
	"project": "plot-cv.sublime-project",
	"replace":
	{
		"height": 44.0
	},
	"save_all_on_build": false,
	"select_file":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
			[
				"upload-ser",
				"upload-server.js"
			],
			[
				"util.js",
				"quickjs/qjs-modules/lib/util.js"
			],
			[
				"io-help",
				"io-helpers.js"
			],
			[
				"clang-as",
				"clang-ast.js"
			],
			[
				"upload-server",
				"upload-server.js"
			],
			[
				"quickjs.c",
				"quickjs/quickjs.c"
			],
			[
				"utils.c",
				"quickjs/qjs-modules/src/utils.c"
			],
			[
				"jsut",
				"quickjs/qjs-modules/src/js-utils.c"
			],
			[
				"qjsm.c",
				"quickjs/qjs-modules/src/qjsm.c"
			],
			[
				"ast-shell",
				"ast-shell.js"
			],
			[
				"quickjs-in",
				"quickjs/qjs-modules/quickjs-internal.h"
			],
			[
				"run-test",
				"quickjs/run-test262.c"
			],
			[
				"quickjs.h",
				"quickjs/quickjs.h"
			],
			[
				"build-libwe",
				"quickjs/qjs-net/build-libwebsockets.sh"
			],
			[
				"misc.js",
				"lib/misc.js"
			],
			[
				"ast-she",
				"ast-shell.js"
			],
			[
				"draw.js",
				"draw.js"
			],
			[
				"eagle-she",
				"eagle-shell.js"
			],
			[
				"matrix.js",
				"lib/geom/matrix.js"
			],
			[
				"transform",
				"lib/geom/transformation.js"
			],
			[
				"pin.js",
				"lib/eagle/components/pin.js"
			],
			[
				"",
				"~/Projects/an-tronics/eagle/555-PWM-Motor-Speed-Controller-alt.sch"
			],
			[
				"preactCom",
				"lib/dom/preactComponent.js"
			],
			[
				"symb",
				"lib/eagle/components/symbol.js"
			],
			[
				"schematicren",
				"lib/eagle/schematicRenderer.js"
			],
			[
				"svgre",
				"lib/eagle/svgRenderer.js"
			],
			[
				"boardren",
				"lib/eagle/boardRenderer.js"
			],
			[
				"element",
				"lib/eagle/element.js"
			],
			[
				"svgRend",
				"lib/eagle/svgRenderer.js"
			],
			[
				"boardRen",
				"lib/eagle/boardRenderer.js"
			],
			[
				"rect.js",
				"lib/geom/rect.js"
			],
			[
				"line.js",
				"lib/geom/line.js"
			],
			[
				"point.js",
				"lib/geom/point.js"
			],
			[
				"document",
				"lib/eagle/document.js"
			],
			[
				"boardRe",
				"lib/eagle/boardRenderer.js"
			],
			[
				"renderUtil",
				"lib/eagle/renderUtils.js"
			],
			[
				"eagle2sv",
				"eagle2svg.js"
			],
			[
				"project.js",
				"lib/eagle/project.js"
			],
			[
				"text.js",
				"lib/eagle/components/text.js"
			],
			[
				"project",
				"lib/eagle/project.js"
			],
			[
				"nodeList",
				"lib/eagle/nodeList.js"
			],
			[
				"lib/util.js",
				"lib/util.js"
			],
			[
				"elemen",
				"lib/eagle/element.js"
			],
			[
				"svgRe",
				"lib/eagle/svgRenderer.js"
			],
			[
				"common",
				"lib/eagle/common.js"
			],
			[
				"ref.js",
				"lib/eagle/ref.js"
			],
			[
				"node.js",
				"lib/eagle/node.js"
			],
			[
				"element.js",
				"lib/eagle/element.js"
			],
			[
				"common.j",
				"lib/eagle/common.js"
			],
			[
				"nodeLi",
				"lib/eagle/nodeList.js"
			],
			[
				"common.js",
				"lib/eagle/common.js"
			],
			[
				"elementP",
				"lib/eagle/elementProxy.js"
			],
			[
				"smd.js",
				"lib/eagle/components/smd.js"
			],
			[
				"wirePa",
				"lib/eagle/components/wirePath.js"
			],
			[
				"wire.js",
				"lib/eagle/components/wire.js"
			],
			[
				"nodeMap",
				"lib/eagle/nodeMap.js"
			],
			[
				"renderer.js",
				"lib/eagle/renderer.js"
			],
			[
				"functions.cmake",
				"qjs-opencv/cmake/functions.cmake"
			],
			[
				"resolve-im",
				"resolve-imports.js"
			],
			[
				"textEle",
				"lib/eagle/components/textElement.js"
			],
			[
				"quickjs-misc",
				"quickjs/qjs-modules/quickjs-misc.c"
			],
			[
				"drawing",
				"lib/eagle/components/drawing.js"
			],
			[
				"pathMapper",
				"lib/json/pathMapper.js"
			],
			[
				"xml-shell",
				"quickjs/qjs-modules/xml-shell.js"
			],
			[
				"upload.js",
				"upload.js"
			],
			[
				"server.js",
				"upload-server.js"
			],
			[
				"delega",
				"lib/delegate.js"
			],
			[
				"rgba",
				"lib/color/rgba.js"
			],
			[
				"eagle-com",
				"eagle-commands.js"
			],
			[
				"colorCod",
				"lib/eda/colorCoding.js"
			],
			[
				"eagle-qu",
				"eagle-query.js"
			],
			[
				"eagle-q",
				"eagle-query.js"
			],
			[
				"read.hex",
				"read.hex"
			],
			[
				"exam",
				"example.circuit"
			],
			[
				"xpath.js",
				"quickjs/qjs-modules/lib/xpath.js"
			],
			[
				"Document",
				"lib/eagle/document.js"
			],
			[
				"test-",
				"test-bitset.js"
			],
			[
				"circuit",
				"circuit.js"
			],
			[
				"fs.js",
				"quickjs/qjs-modules/lib/fs.js"
			],
			[
				"eagle2ger",
				"eagle2gerber.js"
			],
			[
				"repeater.js",
				"lib/repeater/repeater.js"
			],
			[
				"websock",
				"lib/async/websocket.js"
			],
			[
				"fire.js",
				"fire.js"
			],
			[
				"websocket.js",
				"lib/async/websocket.js"
			],
			[
				"test-bj",
				"test-bjson.js"
			],
			[
				"bjson",
				"bjson.js"
			],
			[
				"string-he",
				"string-helpers.js"
			],
			[
				"quickjs-po",
				"quickjs/qjs-modules/quickjs-pointer.c"
			],
			[
				"list-exp",
				"quickjs/qjs-modules/list-exports.js"
			],
			[
				"clang-ast",
				"clang-ast.js"
			],
			[
				"utils.js",
				"lib/stream/utils.js"
			],
			[
				"mirror",
				"quickjs/qjs-net/src/plugins/mirror.c"
			],
			[
				"list-ex",
				"quickjs/qjs-modules/list-exports.js"
			],
			[
				"fire.html",
				"fire.html"
			],
			[
				"server-htt",
				"quickjs/qjs-net/minnet-server-http.c"
			],
			[
				"-ws.c",
				"quickjs/qjs-net/minnet-server-ws.c"
			],
			[
				"filelist",
				"filelist.js"
			],
			[
				"filelist.js",
				"filelist.js"
			],
			[
				"extendGe",
				"quickjs/qjs-modules/lib/extendGenerator.js"
			],
			[
				"test-debugger",
				"test-debuggerprotocol.js"
			],
			[
				"fire.htm",
				"fire.html"
			],
			[
				"fire",
				"fire.js"
			],
			[
				"test-opencv",
				"test-opencv.js"
			],
			[
				"fontsample",
				"fontsample.js"
			],
			[
				"upload.htm",
				"upload.html"
			],
			[
				"main.js",
				"main.js"
			],
			[
				"test-gpio",
				"test-gpio.js"
			],
			[
				"index.html",
				"index.html"
			],
			[
				"repl.js",
				"quickjs/qjs-modules/lib/repl.js"
			],
			[
				"eagle-shell",
				"eagle-shell.js"
			],
			[
				"repl",
				"repl.js"
			],
			[
				"test-minnet",
				"test-minnet.js"
			],
			[
				"list-dir",
				"list-directory.js"
			],
			[
				"list.ht",
				"list.html"
			],
			[
				"transformation",
				"lib/geom/transformation.js"
			],
			[
				"element.",
				"lib/dom/element.js"
			],
			[
				"crosskit",
				"lib/crosskit.js"
			],
			[
				"fire-es",
				"fire-es.html"
			],
			[
				"resolve",
				"resolve-imports.js"
			],
			[
				"fire-es.h",
				"fire-es.html"
			],
			[
				"fire-es.js",
				"fire-es.js"
			],
			[
				"fire.es",
				"fire.es"
			],
			[
				"quickjs",
				"qjs-opencv/cmake/QuickJSModule.cmake"
			],
			[
				"test-strea",
				"test-stream.js"
			],
			[
				"worker.js",
				"worker.js"
			],
			[
				"vector.h",
				"quickjs/qjs-modules/include/vector.h"
			],
			[
				"console.js",
				"quickjs/qjs-modules/lib/console.js"
			],
			[
				"test-work",
				"test-worker.js"
			]
		],
		"width": 0.0
	},
	"select_project":
	{
		"height": 500.0,
		"last_filter": "",
		"selected_items":
		[
			[
				"",
				"~/Projects/plot-cv/plot-cv.sublime-project"
			]
		],
		"width": 380.0
	},
	"select_symbol":
	{
		"height": 309.0,
		"last_filter": "",
		"selected_items":
		[
			[
				"",
				"WS"
			]
		],
		"width": 784.0
	},
	"selected_group": 1,
	"settings":
	{
	},
	"show_minimap": true,
	"show_open_files": false,
	"show_tabs": true,
	"side_bar_visible": true,
	"side_bar_width": 248.0,
	"status_bar_visible": true,
	"template_settings":
	{
	}
}
