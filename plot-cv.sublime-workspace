{
	"auto_complete":
	{
		"selected_items":
		[
			[
				"ex",
				"expansion"
			],
			[
				"isArra",
				"isArrayBuffer"
			],
			[
				"Extra",
				"ExtractRotation"
			],
			[
				"tra",
				"transformation"
			],
			[
				"define",
				"defineProperties"
			],
			[
				"getters",
				"gettersSetters"
			],
			[
				"circui",
				"circuitFilePath"
			],
			[
				"Conn",
				"ConnectionPoint"
			],
			[
				"parseCom",
				"parseCommentOrEmpty"
			],
			[
				"circ",
				"circuitFilePath"
			],
			[
				"built",
				"builtin_attr"
			],
			[
				"dep",
				"depthOrPred"
			],
			[
				"exte",
				"extendAsyncGenerator"
			],
			[
				"extend",
				"extendArray"
			],
			[
				"allo",
				"allowedDirs"
			],
			[
				"getOwnPr",
				"getOwnPropertyNames(...)"
			],
			[
				"Prom",
				"PromiseWorker"
			],
			[
				"trans",
				"transformation"
			],
			[
				"allow",
				"allowedDirs"
			],
			[
				"Get",
				"GetElementsBySignal"
			],
			[
				"GetEle",
				"GetElementsBySignal"
			],
			[
				"getOwn",
				"getOwnPropertyNames(...)"
			],
			[
				"ColorSi",
				"ColorSignals"
			],
			[
				"HTML",
				"HTMLTableRow"
			],
			[
				"HTMLTable",
				"HTMLTableColumn"
			],
			[
				"rend",
				"renderToString"
			],
			[
				"Pack",
				"Package2Circuit"
			],
			[
				"lazyP",
				"lazyProperties"
			],
			[
				"JS_Get",
				"JS_GetProperty"
			],
			[
				"Ret",
				"ReturnValuePathFunction"
			],
			[
				"cFunc",
				"cFuncListObjects"
			],
			[
				"isC",
				"isCFuncCall"
			],
			[
				"En",
				"EntityNames"
			],
			[
				"parseFrom",
				"parseFromString"
			],
			[
				"pseu",
				"pseudoClassArg"
			],
			[
				"pseudoC",
				"pseudoClassName"
			],
			[
				"Key",
				"KeyboardEvent"
			],
			[
				"getOp",
				"getOptionEntries"
			],
			[
				"setProp",
				"setPropertyValue"
			],
			[
				"parse",
				"parseSelectors"
			],
			[
				"JS_SetPr",
				"JS_SetPropertyStr"
			],
			[
				"jsm_buil",
				"jsm_builtin_init"
			],
			[
				"JS_Free",
				"JS_FreeCString"
			],
			[
				"JS_Set",
				"JS_SetProperty"
			],
			[
				"JS_New",
				"JS_NewObject"
			],
			[
				"ide",
				"importIdentifiers"
			],
			[
				"iden",
				"importIdentifiers"
			],
			[
				"import",
				"importIdentifiers"
			],
			[
				"ident",
				"identifierSets"
			],
			[
				"path_is",
				"path_is_absolute"
			],
			[
				"js_is_",
				"js_is_null_or_undefined"
			],
			[
				"path_skip_se",
				"path_skip_separator_s"
			],
			[
				"WRITABLE_METHO",
				"WRITABLE_METHOD_CLOSE"
			],
			[
				"list_fo",
				"list_for_each_prev"
			],
			[
				"JS_Th",
				"JS_ThrowOutOfMemory"
			],
			[
				"JS_",
				"JS_ThrowOutOfMemory"
			],
			[
				"underly",
				"underlying_source"
			],
			[
				"Tok",
				"TokenSequence"
			],
			[
				"JS_GetPr",
				"JS_GetPropertyStr"
			],
			[
				"JS_Thro",
				"JS_ThrowOutOfMemory"
			],
			[
				"getAt",
				"getAttributeNames"
			],
			[
				"self",
				"self_closing_tags"
			],
			[
				"self_",
				"self_closing_tags"
			],
			[
				"JS_PROP",
				"JS_PROP_ENUMERABLE"
			],
			[
				"depe",
				"dependencyMap"
			],
			[
				"de",
				"dependencyMap"
			],
			[
				"js_is_null",
				"js_is_null_or_undefined"
			],
			[
				"JS_P",
				"JS_PROP_ENUMERABLE"
			],
			[
				"JS_SetP",
				"JS_SetPropertyUint32"
			],
			[
				"spec",
				"specifiers"
			],
			[
				"Num",
				"NumericRange"
			],
			[
				"token_r",
				"token_release_rt"
			],
			[
				"JS_Thr",
				"JS_ThrowTypeError"
			],
			[
				"js_",
				"js_location_data"
			],
			[
				"debug_js_mall",
				"debug_js_malloc_usable_size"
			],
			[
				"repl",
				"replaceRange"
			],
			[
				"js_malloc_u",
				"js_malloc_usable_size_rt"
			],
			[
				"malloc",
				"malloc_usable_size"
			],
			[
				"all",
				"alloc_block_list"
			],
			[
				"alloc",
				"alloc_block_list"
			],
			[
				"path_skip",
				"path_skip_component"
			],
			[
				"jsm_mo",
				"jsm_module_loader"
			],
			[
				"JS_Throw",
				"JS_ThrowInternalError"
			],
			[
				"JS_AtomTo",
				"JS_AtomToValue"
			],
			[
				"inspect",
				"inspectSymbol"
			],
			[
				"at",
				"attributes"
			],
			[
				"parent",
				"parentElement"
			],
			[
				"owner",
				"ownerElement"
			],
			[
				"get",
				"getPrototypeOf"
			],
			[
				"child",
				"childElementCount"
			],
			[
				"getO",
				"getOwnPropertyNames"
			],
			[
				"js_misc_im",
				"js_misc_immutable_constructor"
			],
			[
				"obj",
				"object_tostring"
			],
			[
				"js_misc_immu",
				"js_misc_immutable_free"
			],
			[
				"js_misc_imm",
				"js_misc_immutable_constructor"
			],
			[
				"CMAKE_IMPORT",
				"CMAKE_IMPORT_LIBRARY_SUFFIX"
			],
			[
				"CMAKE_CUR",
				"CMAKE_CURRENT_BINARY_DIR"
			],
			[
				"js_is",
				"js_is_null_or_undefined"
			],
			[
				"js_asy",
				"js_async_socket_class_id"
			],
			[
				"JS_NewObj",
				"JS_NewObjectProtoClass"
			],
			[
				"async_",
				"async_socket_proto"
			],
			[
				"js_socket_class",
				"js_socket_class_id"
			],
			[
				"g",
				"getOwnPropertyNames(...)"
			],
			[
				"js_sockaddr_cl",
				"js_sockaddr_class_id"
			],
			[
				"js_so",
				"js_sockaddr_constructor"
			],
			[
				"js_sys",
				"js_syscallerror_class_id"
			],
			[
				"js_string",
				"js_stringdecoder_class_id"
			],
			[
				"js_pred",
				"js_predicate_class_id"
			],
			[
				"js_syn",
				"js_syntaxerror_class"
			],
			[
				"js_child",
				"js_child_process_class_id"
			],
			[
				"js_b",
				"js_blob_class_id"
			],
			[
				"js_loca",
				"js_location_class_id"
			],
			[
				"js_token_in",
				"js_token_inspect_funcs"
			],
			[
				"set",
				"setReadHandler"
			],
			[
				"js_get_",
				"js_get_propertystr_bool"
			],
			[
				"js_misc_ate",
				"js_misc_atexit_functions"
			],
			[
				"isF",
				"isFunction"
			],
			[
				"tab",
				"tab_atom_len"
			],
			[
				"isARr",
				"isArrayBuffer"
			],
			[
				"BIT",
				"BITFIELD_FROMARRAY"
			],
			[
				"to",
				"toStringTag"
			],
			[
				"inotify",
				"inotify_add_watch"
			],
			[
				"JS_SetProp",
				"JS_SetPropertyUint32"
			],
			[
				"JS_GEt",
				"JS_GetGlobalObject"
			],
			[
				"dbuf_put",
				"dbuf_put_colorstr"
			],
			[
				"REPEATER_",
				"REPEATER_REJECTED"
			],
			[
				"REP",
				"REPEATER_DONE"
			],
			[
				"resol",
				"resolving_funcs"
			]
		]
	},
	"buffers":
	[
		{
			"contents": "—Ⓕ– IS ( ) { … } — function\n—Ⓕ– count ( ) { … } — function\n—Ⓕ– check_type ( ) { … } — function",
			"settings":
			{
				"buffer_size": 94,
				"line_ending": "Unix",
				"name": "𝌆 Outline",
				"scratch": true
			},
			"undo_stack":
			[
				[
					477,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/lib/dom/elementRect.js",
						"symkeys":
						[
							[
								164,
								199
							],
							[
								371,
								387
							],
							[
								421,
								446
							],
							[
								554,
								580
							],
							[
								718,
								726
							],
							[
								785,
								792
							],
							[
								873,
								882
							],
							[
								941,
								948
							],
							[
								1060,
								1077
							],
							[
								1217,
								1229
							],
							[
								1533,
								1571
							],
							[
								1751,
								1787
							],
							[
								1788,
								1805
							],
							[
								1909,
								1919
							],
							[
								1957,
								1984
							],
							[
								2036,
								2050
							],
							[
								2098,
								2115
							],
							[
								2214,
								2228
							],
							[
								2276,
								2293
							],
							[
								2359,
								2386
							],
							[
								2438,
								2452
							],
							[
								2504,
								2521
							],
							[
								2621,
								2635
							],
							[
								2688,
								2705
							],
							[
								2774,
								2811
							],
							[
								2948,
								2957
							],
							[
								2976,
								2988
							],
							[
								3009,
								3016
							],
							[
								3171,
								3180
							],
							[
								3195,
								3202
							],
							[
								3225,
								3237
							],
							[
								3258,
								3265
							],
							[
								3432,
								3441
							],
							[
								3460,
								3472
							],
							[
								3493,
								3500
							],
							[
								3646,
								3655
							],
							[
								3670,
								3677
							],
							[
								3701,
								3713
							],
							[
								3734,
								3741
							],
							[
								3870,
								3908
							],
							[
								4010,
								4019
							],
							[
								4043,
								4055
							],
							[
								4139,
								4148
							],
							[
								4172,
								4184
							],
							[
								4264,
								4273
							],
							[
								4298,
								4311
							],
							[
								4397,
								4406
							],
							[
								4431,
								4444
							],
							[
								4493,
								4531
							]
						],
						"symlist":
						[
							" function ElementRectProxy(element)",
							"ElementRectProxy",
							"getPos(fn = rect => rect)",
							"getRect(fn = rect => rect)",
							"setPos()",
							"rect =>",
							"setSize()",
							"rect =>",
							"fn = (rect, e) =>",
							"setRect(arg)",
							"propSetter = (prop, proxy) => value =>",
							"computedSetter = (proxy, compute) =>",
							" function(value)",
							"oldrect =>",
							"ElementXYProps = element =>",
							" function()",
							" function(val)",
							" function()",
							" function(val)",
							"ElementWHProps = element =>",
							" function()",
							" function(val)",
							" function()",
							" function(val)",
							"ElementPosProps = (element, proxy) =>",
							" () =>",
							" value =>",
							"rect =>",
							" () =>",
							"rect =>",
							" value =>",
							"rect =>",
							" () =>",
							" value =>",
							"rect =>",
							" () =>",
							"rect =>",
							" value =>",
							"rect =>",
							"ElementSizeProps = (element, proxy) =>",
							" () =>",
							" width =>",
							" () =>",
							" width =>",
							" () =>",
							" height =>",
							" () =>",
							" height =>",
							"ElementRectProps = (element, proxy) =>"
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAADWAgAATEVYRVJfSAogIGxleGljYWxfcnVsZQogIGxleGljYWxfc2Nhbm5lcgogIGxleGVyX3N0YXRlX2ZpbmRiCiAgbGV4ZXJfc3RhdGVfbmV3CiAgbGV4ZXJfc3RhdGVfcHVzaAogIGxleGVyX3N0YXRlX3BvcAogIGxleGVyX3N0YXRlX3RvcAogIGxleGVyX3N0YXRlc19za2lwCiAgbGV4ZXJfc3RhdGVzX2R1bXAKICBsZXhlcl9ydWxlX3JlZ2V4CiAgbGV4ZXJfcnVsZV9leHBhbmQKICBsZXhlcl9ydWxlX2FkZAogIGxleGVyX3J1bGVfZmluZAogIGxleGVyX3J1bGVfZnJlZQogIGxleGVyX3J1bGVfZnJlZV9ydAogIGxleGVyX3J1bGVfZHVtcAogIGxleGVyX2luaXQKICBsZXhlcl9kZWZpbmUKICBsZXhlcl9maW5kX2RlZmluaXRpb24KICBsZXhlcl9jb21waWxlX3J1bGVzCiAgbGV4ZXJfcGVlawogIGxleGVyX3NraXBfbgogIGxleGVyX3NraXAKICBsZXhlcl9jaGFybGVuCiAgbGV4ZXJfY2xlYXJfdG9rZW4KICBsZXhlcl9sZXhlbWUKICBsZXhlcl9uZXh0CiAgbGV4ZXJfc2V0X2lucHV0CiAgbGV4ZXJfc2V0X2xvY2F0aW9uCiAgbGV4ZXJfcmVsZWFzZQogIGxleGVyX2ZyZWUKICBsZXhlcl9yZWxlYXNlX3J0CiAgbGV4ZXJfZnJlZV9ydAogIGxleGVyX2R1bXAKICBsZXhlcl9kdXAKICBsZXhlcl9ydWxlX2F0CiAgbGV4ZXJfc3RhdGVfZmluZAogIGxleGVyX3N0YXRlX2RlcHRoCiAgbGV4ZXJfc3RhdGVfbmFtZQogIGxleGVyX251bV9zdGF0ZXMKICBsZXhlcl9zdGF0ZV90b3BuYW1lAAAAAAAAAAAWAwAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					478,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAAAWAwAARWxlbWVudFJlY3RQcm94eShlbGVtZW50KQpFbGVtZW50UmVjdFByb3h5CiAgZ2V0UG9zKGZuID0gcmVjdCA9PiByZWN0KQogIGdldFJlY3QoZm4gPSByZWN0ID0+IHJlY3QpCiAgc2V0UG9zKCkKICByZWN0ID0+CiAgc2V0U2l6ZSgpCiAgcmVjdCA9PgogIGZuID0gKHJlY3QsIGUpID0+CiAgc2V0UmVjdChhcmcpCiAgcHJvcFNldHRlciA9IChwcm9wLCBwcm94eSkgPT4gdmFsdWUgPT4KICBjb21wdXRlZFNldHRlciA9IChwcm94eSwgY29tcHV0ZSkgPT4KICBmdW5jdGlvbih2YWx1ZSkKICBvbGRyZWN0ID0+CkVsZW1lbnRYWVByb3BzID0gZWxlbWVudCA9PgogIGZ1bmN0aW9uKCkKICBmdW5jdGlvbih2YWwpCiAgZnVuY3Rpb24oKQogIGZ1bmN0aW9uKHZhbCkKRWxlbWVudFdIUHJvcHMgPSBlbGVtZW50ID0+CiAgZnVuY3Rpb24oKQogIGZ1bmN0aW9uKHZhbCkKICBmdW5jdGlvbigpCiAgZnVuY3Rpb24odmFsKQpFbGVtZW50UG9zUHJvcHMgPSAoZWxlbWVudCwgcHJveHkpID0+CiAgKCkgPT4KICB2YWx1ZSA9PgogIHJlY3QgPT4KICAoKSA9PgogIHJlY3QgPT4KICB2YWx1ZSA9PgogIHJlY3QgPT4KICAoKSA9PgogIHZhbHVlID0+CiAgcmVjdCA9PgogICgpID0+CiAgcmVjdCA9PgogIHZhbHVlID0+CiAgcmVjdCA9PgpFbGVtZW50U2l6ZVByb3BzID0gKGVsZW1lbnQsIHByb3h5KSA9PgogICgpID0+CiAgd2lkdGggPT4KICAoKSA9PgogIHdpZHRoID0+CiAgKCkgPT4KICBoZWlnaHQgPT4KICAoKSA9PgogIGhlaWdodCA9PgpFbGVtZW50UmVjdFByb3BzID0gKGVsZW1lbnQsIHByb3h5KSA9PgAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					479,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/quickjs/qjs-modules/quickjs-lexer.c",
						"symkeys":
						[
							[
								359,
								370
							],
							[
								650,
								664
							],
							[
								934,
								951
							],
							[
								2023,
								2036
							],
							[
								2065,
								2078
							],
							[
								2369,
								2381
							],
							[
								2738,
								2751
							],
							[
								2933,
								2953
							],
							[
								4222,
								4239
							],
							[
								4482,
								4502
							],
							[
								5121,
								5137
							],
							[
								6488,
								6500
							],
							[
								8413,
								8431
							],
							[
								10301,
								10315
							],
							[
								10583,
								10597
							],
							[
								10923,
								10935
							],
							[
								11568,
								11577
							],
							[
								12960,
								12977
							],
							[
								13292,
								13311
							],
							[
								13567,
								13585
							],
							[
								13972,
								13986
							],
							[
								14248,
								14259
							],
							[
								14587,
								14599
							],
							[
								15184,
								15197
							],
							[
								15364,
								15381
							],
							[
								16580,
								16600
							],
							[
								17913,
								17928
							],
							[
								25644,
								25656
							],
							[
								28954,
								28966
							],
							[
								30360,
								30375
							],
							[
								30763,
								30778
							],
							[
								31128,
								31147
							],
							[
								31896,
								31911
							],
							[
								32349,
								32366
							],
							[
								32838,
								32850
							],
							[
								34642,
								34657
							],
							[
								35481,
								35494
							],
							[
								35717,
								35730
							],
							[
								36335,
								36352
							],
							[
								36749,
								36765
							],
							[
								37815,
								37833
							],
							[
								41895,
								41908
							],
							[
								43376,
								43390
							],
							[
								43420,
								43434
							]
						],
						"symlist":
						[
							" Ⓣ  JSLexerRule ; — typedef",
							"—Ⓕ– offset_toarray ( ) { … } — function",
							"—Ⓕ– js_lexer_rule_new ( ) { … } — function",
							"—Ⓒ– token_methods { … } ; — type",
							"—Ⓒ– token_getters { … } ; — type",
							"—Ⓕ– js_token_new ( ) { … } — function",
							"—Ⓕ– js_token_wrap ( ) { … } — function",
							"—Ⓕ– js_token_constructor ( ) { … } — function",
							"—Ⓕ– js_token_tostring ( ) { … } — function",
							"—Ⓕ– js_token_toprimitive ( ) { … } — function",
							"—Ⓕ– js_token_inspect ( ) { … } — function",
							"—Ⓕ– js_token_get ( ) { … } — function",
							"—Ⓕ– js_token_finalizer ( ) { … } — function",
							"—Ⓕ– lexer_continue ( ) { … } — function",
							"—Ⓕ– lexer_to_state ( ) { … } — function",
							"—Ⓕ– lexer_handle ( ) { … } — function",
							"—Ⓕ– lexer_lex ( ) { … } — function",
							"—Ⓕ– lexer_escape_pred ( ) { … } — function",
							"—Ⓕ– lexer_unescape_pred ( ) { … } — function",
							"—Ⓕ– lexer_current_line ( ) { … } — function",
							"—Ⓕ– lexer_lexeme_s ( ) { … } — function",
							"—Ⓕ– lexer_token ( ) { … } — function",
							"—Ⓕ– js_lexer_new ( ) { … } — function",
							"—Ⓕ– js_lexer_wrap ( ) { … } — function",
							"—Ⓕ– js_lexer_add_rule ( ) { … } — function",
							"—Ⓕ– js_lexer_constructor ( ) { … } — function",
							"—Ⓕ– js_lexer_method ( ) { … } — function",
							"—Ⓕ– js_lexer_get ( ) { … } — function",
							"—Ⓕ– js_lexer_set ( ) { … } — function",
							"—Ⓕ– js_lexer_tokens ( ) { … } — function",
							"—Ⓕ– js_lexer_states ( ) { … } — function",
							"—Ⓕ– js_lexer_statestack ( ) { … } — function",
							"—Ⓕ– js_lexer_escape ( ) { … } — function",
							"—Ⓕ– js_lexer_tostring ( ) { … } — function",
							"—Ⓕ– js_lexer_lex ( ) { … } — function",
							"—Ⓕ– js_lexer_nextfn ( ) { … } — function",
							"—Ⓕ– js_lexer_next ( ) { … } — function",
							"—Ⓕ– js_lexer_call ( ) { … } — function",
							"—Ⓕ– js_lexer_iterator ( ) { … } — function",
							"—Ⓕ– js_lexer_inspect ( ) { … } — function",
							"—Ⓕ– js_lexer_finalizer ( ) { … } — function",
							"—Ⓕ– js_lexer_init ( ) { … } — function",
							" Ⓜ  JS_INIT_MODULE … — macro object",
							" Ⓜ  JS_INIT_MODULE … — macro object"
						]
					},
					"AQAAAAAAAAAAAAAA6AYAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					480,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAACSCAAAICDik4kgIEpTTGV4ZXJSdWxlIDsg4oCUIHR5cGVkZWYK4oCU4pK74oCTIG9mZnNldF90b2FycmF5ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfcnVsZV9uZXcgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSuOKAkyB0b2tlbl9tZXRob2RzIHsg4oCmIH0gOyDigJQgdHlwZQrigJTikrjigJMgdG9rZW5fZ2V0dGVycyB7IOKApiB9IDsg4oCUIHR5cGUK4oCU4pK74oCTIGpzX3Rva2VuX25ldyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX3Rva2VuX3dyYXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc190b2tlbl9jb25zdHJ1Y3RvciAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX3Rva2VuX3Rvc3RyaW5nICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfdG9rZW5fdG9wcmltaXRpdmUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc190b2tlbl9pbnNwZWN0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfdG9rZW5fZ2V0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfdG9rZW5fZmluYWxpemVyICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY29udGludWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl90b19zdGF0ZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2hhbmRsZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2xleCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2VzY2FwZV9wcmVkICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfdW5lc2NhcGVfcHJlZCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2N1cnJlbnRfbGluZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2xleGVtZV9zICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfdG9rZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9uZXcgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl93cmFwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfYWRkX3J1bGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9jb25zdHJ1Y3RvciAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX21ldGhvZCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX2dldCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3NldCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3Rva2VucyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3N0YXRlcyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3N0YXRlc3RhY2sgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9lc2NhcGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl90b3N0cmluZyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX2xleCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX25leHRmbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX25leHQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9jYWxsICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfaXRlcmF0b3IgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9pbnNwZWN0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfZmluYWxpemVyICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfaW5pdCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24KICDik4IgIEpTX0lOSVRfTU9EVUxFIOKApiDigJQgbWFjcm8gb2JqZWN0CiAg4pOCICBKU19JTklUX01PRFVMRSDigKYg4oCUIG1hY3JvIG9iamVjdAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					481,
					2,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					482,
					2,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					483,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					484,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					485,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/quickjs/qjs-modules/quickjs-lexer.c",
						"symkeys":
						[
							[
								359,
								370
							],
							[
								650,
								664
							],
							[
								934,
								951
							],
							[
								2023,
								2036
							],
							[
								2065,
								2078
							],
							[
								2369,
								2381
							],
							[
								2738,
								2751
							],
							[
								2933,
								2953
							],
							[
								4222,
								4239
							],
							[
								4482,
								4502
							],
							[
								5121,
								5137
							],
							[
								6488,
								6500
							],
							[
								8413,
								8431
							],
							[
								10301,
								10315
							],
							[
								10583,
								10597
							],
							[
								10923,
								10935
							],
							[
								11568,
								11577
							],
							[
								12960,
								12977
							],
							[
								13292,
								13311
							],
							[
								13567,
								13585
							],
							[
								13972,
								13986
							],
							[
								14248,
								14259
							],
							[
								14587,
								14599
							],
							[
								15184,
								15197
							],
							[
								15364,
								15381
							],
							[
								16580,
								16600
							],
							[
								17913,
								17928
							],
							[
								25644,
								25656
							],
							[
								28954,
								28966
							],
							[
								30360,
								30375
							],
							[
								30763,
								30778
							],
							[
								31128,
								31147
							],
							[
								31896,
								31911
							],
							[
								32349,
								32366
							],
							[
								32838,
								32850
							],
							[
								34642,
								34657
							],
							[
								35481,
								35494
							],
							[
								35717,
								35730
							],
							[
								36335,
								36352
							],
							[
								36749,
								36765
							],
							[
								37815,
								37833
							],
							[
								41895,
								41908
							],
							[
								43376,
								43390
							],
							[
								43420,
								43434
							]
						],
						"symlist":
						[
							" Ⓣ  JSLexerRule ; — typedef",
							"—Ⓕ– offset_toarray ( ) { … } — function",
							"—Ⓕ– js_lexer_rule_new ( ) { … } — function",
							"—Ⓒ– token_methods { … } ; — type",
							"—Ⓒ– token_getters { … } ; — type",
							"—Ⓕ– js_token_new ( ) { … } — function",
							"—Ⓕ– js_token_wrap ( ) { … } — function",
							"—Ⓕ– js_token_constructor ( ) { … } — function",
							"—Ⓕ– js_token_tostring ( ) { … } — function",
							"—Ⓕ– js_token_toprimitive ( ) { … } — function",
							"—Ⓕ– js_token_inspect ( ) { … } — function",
							"—Ⓕ– js_token_get ( ) { … } — function",
							"—Ⓕ– js_token_finalizer ( ) { … } — function",
							"—Ⓕ– lexer_continue ( ) { … } — function",
							"—Ⓕ– lexer_to_state ( ) { … } — function",
							"—Ⓕ– lexer_handle ( ) { … } — function",
							"—Ⓕ– lexer_lex ( ) { … } — function",
							"—Ⓕ– lexer_escape_pred ( ) { … } — function",
							"—Ⓕ– lexer_unescape_pred ( ) { … } — function",
							"—Ⓕ– lexer_current_line ( ) { … } — function",
							"—Ⓕ– lexer_lexeme_s ( ) { … } — function",
							"—Ⓕ– lexer_token ( ) { … } — function",
							"—Ⓕ– js_lexer_new ( ) { … } — function",
							"—Ⓕ– js_lexer_wrap ( ) { … } — function",
							"—Ⓕ– js_lexer_add_rule ( ) { … } — function",
							"—Ⓕ– js_lexer_constructor ( ) { … } — function",
							"—Ⓕ– js_lexer_method ( ) { … } — function",
							"—Ⓕ– js_lexer_get ( ) { … } — function",
							"—Ⓕ– js_lexer_set ( ) { … } — function",
							"—Ⓕ– js_lexer_tokens ( ) { … } — function",
							"—Ⓕ– js_lexer_states ( ) { … } — function",
							"—Ⓕ– js_lexer_statestack ( ) { … } — function",
							"—Ⓕ– js_lexer_escape ( ) { … } — function",
							"—Ⓕ– js_lexer_tostring ( ) { … } — function",
							"—Ⓕ– js_lexer_lex ( ) { … } — function",
							"—Ⓕ– js_lexer_nextfn ( ) { … } — function",
							"—Ⓕ– js_lexer_next ( ) { … } — function",
							"—Ⓕ– js_lexer_call ( ) { … } — function",
							"—Ⓕ– js_lexer_iterator ( ) { … } — function",
							"—Ⓕ– js_lexer_inspect ( ) { … } — function",
							"—Ⓕ– js_lexer_finalizer ( ) { … } — function",
							"—Ⓕ– js_lexer_init ( ) { … } — function",
							" Ⓜ  JS_INIT_MODULE … — macro object",
							" Ⓜ  JS_INIT_MODULE … — macro object"
						]
					},
					"AQAAAAAAAAAAAAAA6AYAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					486,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAACSCAAAICDik4kgIEpTTGV4ZXJSdWxlIDsg4oCUIHR5cGVkZWYK4oCU4pK74oCTIG9mZnNldF90b2FycmF5ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfcnVsZV9uZXcgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSuOKAkyB0b2tlbl9tZXRob2RzIHsg4oCmIH0gOyDigJQgdHlwZQrigJTikrjigJMgdG9rZW5fZ2V0dGVycyB7IOKApiB9IDsg4oCUIHR5cGUK4oCU4pK74oCTIGpzX3Rva2VuX25ldyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX3Rva2VuX3dyYXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc190b2tlbl9jb25zdHJ1Y3RvciAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX3Rva2VuX3Rvc3RyaW5nICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfdG9rZW5fdG9wcmltaXRpdmUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc190b2tlbl9pbnNwZWN0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfdG9rZW5fZ2V0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfdG9rZW5fZmluYWxpemVyICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY29udGludWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl90b19zdGF0ZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2hhbmRsZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2xleCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2VzY2FwZV9wcmVkICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfdW5lc2NhcGVfcHJlZCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2N1cnJlbnRfbGluZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2xleGVtZV9zICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfdG9rZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9uZXcgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl93cmFwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfYWRkX3J1bGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9jb25zdHJ1Y3RvciAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX21ldGhvZCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX2dldCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3NldCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3Rva2VucyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3N0YXRlcyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3N0YXRlc3RhY2sgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9lc2NhcGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl90b3N0cmluZyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX2xleCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX25leHRmbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX25leHQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9jYWxsICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfaXRlcmF0b3IgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9pbnNwZWN0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfZmluYWxpemVyICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfaW5pdCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24KICDik4IgIEpTX0lOSVRfTU9EVUxFIOKApiDigJQgbWFjcm8gb2JqZWN0CiAg4pOCICBKU19JTklUX01PRFVMRSDigKYg4oCUIG1hY3JvIG9iamVjdAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					487,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/quickjs/qjs-modules/src/lexer.c",
						"symkeys":
						[
							[
								168,
								185
							],
							[
								434,
								449
							],
							[
								730,
								746
							],
							[
								1096,
								1111
							],
							[
								1549,
								1564
							],
							[
								1825,
								1842
							],
							[
								2003,
								2020
							],
							[
								2321,
								2337
							],
							[
								2405,
								2422
							],
							[
								2938,
								2956
							],
							[
								3544,
								3560
							],
							[
								3935,
								3949
							],
							[
								4793,
								4808
							],
							[
								5017,
								5032
							],
							[
								5207,
								5225
							],
							[
								5410,
								5425
							],
							[
								5663,
								5673
							],
							[
								6099,
								6111
							],
							[
								6313,
								6334
							],
							[
								6592,
								6611
							],
							[
								6792,
								6802
							],
							[
								9534,
								9546
							],
							[
								9824,
								9834
							],
							[
								9974,
								9991
							],
							[
								10122,
								10135
							],
							[
								10319,
								10331
							],
							[
								10463,
								10473
							],
							[
								10603,
								10618
							],
							[
								10730,
								10748
							],
							[
								10973,
								10986
							],
							[
								11522,
								11532
							],
							[
								11647,
								11663
							],
							[
								12125,
								12138
							],
							[
								12256,
								12266
							]
						],
						"symlist":
						[
							"—Ⓕ– lexer_state_findb ( ) { … } — function",
							"—Ⓕ– lexer_state_new ( ) { … } — function",
							"—Ⓕ– lexer_state_push ( ) { … } — function",
							"—Ⓕ– lexer_state_pop ( ) { … } — function",
							"—Ⓕ– lexer_state_top ( ) { … } — function",
							"—Ⓕ– lexer_states_skip ( ) { … } — function",
							"—Ⓕ– lexer_states_dump ( ) { … } — function",
							"—Ⓕ– lexer_rule_regex ( ) { … } — function",
							"—Ⓕ– lexer_rule_expand ( ) { … } — function",
							"—Ⓕ– lexer_rule_compile ( ) { … } — function",
							"—Ⓕ– lexer_rule_match ( ) { … } — function",
							"—Ⓕ– lexer_rule_add ( ) { … } — function",
							"—Ⓕ– lexer_rule_find ( ) { … } — function",
							"—Ⓕ– lexer_rule_free ( ) { … } — function",
							"—Ⓕ– lexer_rule_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_rule_dump ( ) { … } — function",
							"—Ⓕ– lexer_init ( ) { … } — function",
							"—Ⓕ– lexer_define ( ) { … } — function",
							"—Ⓕ– lexer_find_definition ( ) { … } — function",
							"—Ⓕ– lexer_compile_rules ( ) { … } — function",
							"—Ⓕ– lexer_peek ( ) { … } — function",
							"—Ⓕ– lexer_skip_n ( ) { … } — function",
							"—Ⓕ– lexer_skip ( ) { … } — function",
							"—Ⓕ– lexer_clear_token ( ) { … } — function",
							"—Ⓕ– lexer_charlen ( ) { … } — function",
							"—Ⓕ– lexer_lexeme ( ) { … } — function",
							"—Ⓕ– lexer_next ( ) { … } — function",
							"—Ⓕ– lexer_set_input ( ) { … } — function",
							"—Ⓕ– lexer_set_location ( ) { … } — function",
							"—Ⓕ– lexer_release ( ) { … } — function",
							"—Ⓕ– lexer_free ( ) { … } — function",
							"—Ⓕ– lexer_release_rt ( ) { … } — function",
							"—Ⓕ– lexer_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_dump ( ) { … } — function"
						]
					},
					"AQAAAAAAAAAAAAAAZAUAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					488,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/quickjs/qjs-modules/src/lexer.c",
						"symkeys":
						[
							[
								168,
								185
							],
							[
								434,
								449
							],
							[
								730,
								746
							],
							[
								1096,
								1111
							],
							[
								1549,
								1564
							],
							[
								1825,
								1842
							],
							[
								2003,
								2020
							],
							[
								2321,
								2337
							],
							[
								2405,
								2422
							],
							[
								2938,
								2956
							],
							[
								3544,
								3560
							],
							[
								3935,
								3949
							],
							[
								4793,
								4808
							],
							[
								5017,
								5032
							],
							[
								5207,
								5225
							],
							[
								5410,
								5425
							],
							[
								5663,
								5673
							],
							[
								6099,
								6111
							],
							[
								6313,
								6334
							],
							[
								6592,
								6611
							],
							[
								6792,
								6802
							],
							[
								9534,
								9546
							],
							[
								9824,
								9834
							],
							[
								9974,
								9991
							],
							[
								10122,
								10135
							],
							[
								10319,
								10331
							],
							[
								10463,
								10473
							],
							[
								10603,
								10618
							],
							[
								10730,
								10748
							],
							[
								10973,
								10986
							],
							[
								11522,
								11532
							],
							[
								11647,
								11663
							],
							[
								12125,
								12138
							],
							[
								12256,
								12266
							]
						],
						"symlist":
						[
							"—Ⓕ– lexer_state_findb ( ) { … } — function",
							"—Ⓕ– lexer_state_new ( ) { … } — function",
							"—Ⓕ– lexer_state_push ( ) { … } — function",
							"—Ⓕ– lexer_state_pop ( ) { … } — function",
							"—Ⓕ– lexer_state_top ( ) { … } — function",
							"—Ⓕ– lexer_states_skip ( ) { … } — function",
							"—Ⓕ– lexer_states_dump ( ) { … } — function",
							"—Ⓕ– lexer_rule_regex ( ) { … } — function",
							"—Ⓕ– lexer_rule_expand ( ) { … } — function",
							"—Ⓕ– lexer_rule_compile ( ) { … } — function",
							"—Ⓕ– lexer_rule_match ( ) { … } — function",
							"—Ⓕ– lexer_rule_add ( ) { … } — function",
							"—Ⓕ– lexer_rule_find ( ) { … } — function",
							"—Ⓕ– lexer_rule_free ( ) { … } — function",
							"—Ⓕ– lexer_rule_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_rule_dump ( ) { … } — function",
							"—Ⓕ– lexer_init ( ) { … } — function",
							"—Ⓕ– lexer_define ( ) { … } — function",
							"—Ⓕ– lexer_find_definition ( ) { … } — function",
							"—Ⓕ– lexer_compile_rules ( ) { … } — function",
							"—Ⓕ– lexer_peek ( ) { … } — function",
							"—Ⓕ– lexer_skip_n ( ) { … } — function",
							"—Ⓕ– lexer_skip ( ) { … } — function",
							"—Ⓕ– lexer_clear_token ( ) { … } — function",
							"—Ⓕ– lexer_charlen ( ) { … } — function",
							"—Ⓕ– lexer_lexeme ( ) { … } — function",
							"—Ⓕ– lexer_next ( ) { … } — function",
							"—Ⓕ– lexer_set_input ( ) { … } — function",
							"—Ⓕ– lexer_set_location ( ) { … } — function",
							"—Ⓕ– lexer_release ( ) { … } — function",
							"—Ⓕ– lexer_free ( ) { … } — function",
							"—Ⓕ– lexer_release_rt ( ) { … } — function",
							"—Ⓕ– lexer_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_dump ( ) { … } — function"
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAAC4BgAA4oCU4pK74oCTIGxleGVyX3N0YXRlX2ZpbmRiICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfbmV3ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfcHVzaCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3BvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3RvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlc19za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVzX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX3JlZ2V4ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9leHBhbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2NvbXBpbGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX21hdGNoICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9hZGQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZpbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9pbml0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZGVmaW5lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZmluZF9kZWZpbml0aW9uICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY29tcGlsZV9ydWxlcyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3BlZWsgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwX24gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY2xlYXJfdG9rZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9jaGFybGVuICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbGV4ZW1lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbmV4dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9pbnB1dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9sb2NhdGlvbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3JlbGVhc2UgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9mcmVlICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcmVsZWFzZV9ydCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9kdW1wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgAAAAAAAAAAZAUAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					489,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAAC4BgAA4oCU4pK74oCTIGxleGVyX3N0YXRlX2ZpbmRiICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfbmV3ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfcHVzaCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3BvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3RvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlc19za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVzX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX3JlZ2V4ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9leHBhbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2NvbXBpbGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX21hdGNoICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9hZGQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZpbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9pbml0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZGVmaW5lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZmluZF9kZWZpbml0aW9uICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY29tcGlsZV9ydWxlcyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3BlZWsgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwX24gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY2xlYXJfdG9rZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9jaGFybGVuICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbGV4ZW1lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbmV4dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9pbnB1dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9sb2NhdGlvbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3JlbGVhc2UgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9mcmVlICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcmVsZWFzZV9ydCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9kdW1wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					490,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/quickjs/qjs-modules/src/lexer.c",
						"symkeys":
						[
							[
								168,
								185
							],
							[
								434,
								449
							],
							[
								730,
								746
							],
							[
								1096,
								1111
							],
							[
								1549,
								1564
							],
							[
								1825,
								1842
							],
							[
								2003,
								2020
							],
							[
								2321,
								2337
							],
							[
								2405,
								2422
							],
							[
								2938,
								2956
							],
							[
								3544,
								3560
							],
							[
								3935,
								3949
							],
							[
								4793,
								4808
							],
							[
								5017,
								5032
							],
							[
								5207,
								5225
							],
							[
								5410,
								5425
							],
							[
								5663,
								5673
							],
							[
								6099,
								6111
							],
							[
								6313,
								6334
							],
							[
								6592,
								6611
							],
							[
								6792,
								6802
							],
							[
								9534,
								9546
							],
							[
								9824,
								9834
							],
							[
								9974,
								9991
							],
							[
								10122,
								10135
							],
							[
								10319,
								10331
							],
							[
								10463,
								10473
							],
							[
								10603,
								10618
							],
							[
								10730,
								10748
							],
							[
								10973,
								10986
							],
							[
								11522,
								11532
							],
							[
								11647,
								11663
							],
							[
								12125,
								12138
							],
							[
								12256,
								12266
							]
						],
						"symlist":
						[
							"—Ⓕ– lexer_state_findb ( ) { … } — function",
							"—Ⓕ– lexer_state_new ( ) { … } — function",
							"—Ⓕ– lexer_state_push ( ) { … } — function",
							"—Ⓕ– lexer_state_pop ( ) { … } — function",
							"—Ⓕ– lexer_state_top ( ) { … } — function",
							"—Ⓕ– lexer_states_skip ( ) { … } — function",
							"—Ⓕ– lexer_states_dump ( ) { … } — function",
							"—Ⓕ– lexer_rule_regex ( ) { … } — function",
							"—Ⓕ– lexer_rule_expand ( ) { … } — function",
							"—Ⓕ– lexer_rule_compile ( ) { … } — function",
							"—Ⓕ– lexer_rule_match ( ) { … } — function",
							"—Ⓕ– lexer_rule_add ( ) { … } — function",
							"—Ⓕ– lexer_rule_find ( ) { … } — function",
							"—Ⓕ– lexer_rule_free ( ) { … } — function",
							"—Ⓕ– lexer_rule_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_rule_dump ( ) { … } — function",
							"—Ⓕ– lexer_init ( ) { … } — function",
							"—Ⓕ– lexer_define ( ) { … } — function",
							"—Ⓕ– lexer_find_definition ( ) { … } — function",
							"—Ⓕ– lexer_compile_rules ( ) { … } — function",
							"—Ⓕ– lexer_peek ( ) { … } — function",
							"—Ⓕ– lexer_skip_n ( ) { … } — function",
							"—Ⓕ– lexer_skip ( ) { … } — function",
							"—Ⓕ– lexer_clear_token ( ) { … } — function",
							"—Ⓕ– lexer_charlen ( ) { … } — function",
							"—Ⓕ– lexer_lexeme ( ) { … } — function",
							"—Ⓕ– lexer_next ( ) { … } — function",
							"—Ⓕ– lexer_set_input ( ) { … } — function",
							"—Ⓕ– lexer_set_location ( ) { … } — function",
							"—Ⓕ– lexer_release ( ) { … } — function",
							"—Ⓕ– lexer_free ( ) { … } — function",
							"—Ⓕ– lexer_release_rt ( ) { … } — function",
							"—Ⓕ– lexer_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_dump ( ) { … } — function"
						]
					},
					"AQAAAAAAAAAAAAAAZAUAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					491,
					2,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/quickjs/qjs-modules/src/lexer.c",
						"symkeys":
						[
							[
								168,
								185
							],
							[
								434,
								449
							],
							[
								730,
								746
							],
							[
								1096,
								1111
							],
							[
								1549,
								1564
							],
							[
								1825,
								1842
							],
							[
								2003,
								2020
							],
							[
								2321,
								2337
							],
							[
								2405,
								2422
							],
							[
								2938,
								2956
							],
							[
								3544,
								3560
							],
							[
								3935,
								3949
							],
							[
								4793,
								4808
							],
							[
								5017,
								5032
							],
							[
								5207,
								5225
							],
							[
								5410,
								5425
							],
							[
								5663,
								5673
							],
							[
								6099,
								6111
							],
							[
								6313,
								6334
							],
							[
								6592,
								6611
							],
							[
								6792,
								6802
							],
							[
								9535,
								9547
							],
							[
								9825,
								9835
							],
							[
								9975,
								9992
							],
							[
								10123,
								10136
							],
							[
								10320,
								10332
							],
							[
								10464,
								10474
							],
							[
								10604,
								10619
							],
							[
								10731,
								10749
							],
							[
								10974,
								10987
							],
							[
								11523,
								11533
							],
							[
								11648,
								11664
							],
							[
								12126,
								12139
							],
							[
								12257,
								12267
							]
						],
						"symlist":
						[
							"—Ⓕ– lexer_state_findb ( ) { … } — function",
							"—Ⓕ– lexer_state_new ( ) { … } — function",
							"—Ⓕ– lexer_state_push ( ) { … } — function",
							"—Ⓕ– lexer_state_pop ( ) { … } — function",
							"—Ⓕ– lexer_state_top ( ) { … } — function",
							"—Ⓕ– lexer_states_skip ( ) { … } — function",
							"—Ⓕ– lexer_states_dump ( ) { … } — function",
							"—Ⓕ– lexer_rule_regex ( ) { … } — function",
							"—Ⓕ– lexer_rule_expand ( ) { … } — function",
							"—Ⓕ– lexer_rule_compile ( ) { … } — function",
							"—Ⓕ– lexer_rule_match ( ) { … } — function",
							"—Ⓕ– lexer_rule_add ( ) { … } — function",
							"—Ⓕ– lexer_rule_find ( ) { … } — function",
							"—Ⓕ– lexer_rule_free ( ) { … } — function",
							"—Ⓕ– lexer_rule_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_rule_dump ( ) { … } — function",
							"—Ⓕ– lexer_init ( ) { … } — function",
							"—Ⓕ– lexer_define ( ) { … } — function",
							"—Ⓕ– lexer_find_definition ( ) { … } — function",
							"—Ⓕ– lexer_compile_rules ( ) { … } — function",
							"—Ⓕ– lexer_peek ( ) { … } — function",
							"—Ⓕ– lexer_skip_n ( ) { … } — function",
							"—Ⓕ– lexer_skip ( ) { … } — function",
							"—Ⓕ– lexer_clear_token ( ) { … } — function",
							"—Ⓕ– lexer_charlen ( ) { … } — function",
							"—Ⓕ– lexer_lexeme ( ) { … } — function",
							"—Ⓕ– lexer_next ( ) { … } — function",
							"—Ⓕ– lexer_set_input ( ) { … } — function",
							"—Ⓕ– lexer_set_location ( ) { … } — function",
							"—Ⓕ– lexer_release ( ) { … } — function",
							"—Ⓕ– lexer_free ( ) { … } — function",
							"—Ⓕ– lexer_release_rt ( ) { … } — function",
							"—Ⓕ– lexer_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_dump ( ) { … } — function"
						]
					},
					"BAAAAAAAAAAAAAAAAAAAAAAAAAC4BgAA4oCU4pK74oCTIGxleGVyX3N0YXRlX2ZpbmRiICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfbmV3ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfcHVzaCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3BvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3RvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlc19za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVzX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX3JlZ2V4ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9leHBhbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2NvbXBpbGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX21hdGNoICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9hZGQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZpbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9pbml0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZGVmaW5lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZmluZF9kZWZpbml0aW9uICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY29tcGlsZV9ydWxlcyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3BlZWsgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwX24gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY2xlYXJfdG9rZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9jaGFybGVuICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbGV4ZW1lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbmV4dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9pbnB1dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9sb2NhdGlvbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3JlbGVhc2UgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9mcmVlICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcmVsZWFzZV9ydCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9kdW1wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgAAAAAAAAAAZAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALgGAADigJTikrvigJMgbGV4ZXJfc3RhdGVfZmluZGIgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9zdGF0ZV9uZXcgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9zdGF0ZV9wdXNoICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfcG9wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfdG9wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVzX3NraXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9zdGF0ZXNfZHVtcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3J1bGVfcmVnZXggKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2V4cGFuZCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3J1bGVfY29tcGlsZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3J1bGVfbWF0Y2ggKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2FkZCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3J1bGVfZmluZCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3J1bGVfZnJlZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3J1bGVfZnJlZV9ydCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3J1bGVfZHVtcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2luaXQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9kZWZpbmUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9maW5kX2RlZmluaXRpb24gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9jb21waWxlX3J1bGVzICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcGVlayAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NraXBfbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NraXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9jbGVhcl90b2tlbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2NoYXJsZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9sZXhlbWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9uZXh0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc2V0X2lucHV0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc2V0X2xvY2F0aW9uICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcmVsZWFzZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2ZyZWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9yZWxlYXNlX3J0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZnJlZV9ydCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uAAAAAAAAAABkBQAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					492,
					4,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/quickjs/qjs-modules/src/lexer.c",
						"symkeys":
						[
							[
								168,
								185
							],
							[
								434,
								449
							],
							[
								730,
								746
							],
							[
								1096,
								1111
							],
							[
								1549,
								1564
							],
							[
								1825,
								1842
							],
							[
								2003,
								2020
							],
							[
								2321,
								2337
							],
							[
								2405,
								2422
							],
							[
								2938,
								2956
							],
							[
								3544,
								3560
							],
							[
								3935,
								3949
							],
							[
								4793,
								4808
							],
							[
								5017,
								5032
							],
							[
								5207,
								5225
							],
							[
								5410,
								5425
							],
							[
								5663,
								5673
							],
							[
								6099,
								6111
							],
							[
								6313,
								6334
							],
							[
								6592,
								6611
							],
							[
								6792,
								6802
							],
							[
								9556,
								9568
							],
							[
								9846,
								9856
							],
							[
								9996,
								10013
							],
							[
								10144,
								10157
							],
							[
								10341,
								10353
							],
							[
								10485,
								10495
							],
							[
								10625,
								10640
							],
							[
								10752,
								10770
							],
							[
								10995,
								11008
							],
							[
								11544,
								11554
							],
							[
								11669,
								11685
							],
							[
								12147,
								12160
							],
							[
								12278,
								12288
							]
						],
						"symlist":
						[
							"—Ⓕ– lexer_state_findb ( ) { … } — function",
							"—Ⓕ– lexer_state_new ( ) { … } — function",
							"—Ⓕ– lexer_state_push ( ) { … } — function",
							"—Ⓕ– lexer_state_pop ( ) { … } — function",
							"—Ⓕ– lexer_state_top ( ) { … } — function",
							"—Ⓕ– lexer_states_skip ( ) { … } — function",
							"—Ⓕ– lexer_states_dump ( ) { … } — function",
							"—Ⓕ– lexer_rule_regex ( ) { … } — function",
							"—Ⓕ– lexer_rule_expand ( ) { … } — function",
							"—Ⓕ– lexer_rule_compile ( ) { … } — function",
							"—Ⓕ– lexer_rule_match ( ) { … } — function",
							"—Ⓕ– lexer_rule_add ( ) { … } — function",
							"—Ⓕ– lexer_rule_find ( ) { … } — function",
							"—Ⓕ– lexer_rule_free ( ) { … } — function",
							"—Ⓕ– lexer_rule_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_rule_dump ( ) { … } — function",
							"—Ⓕ– lexer_init ( ) { … } — function",
							"—Ⓕ– lexer_define ( ) { … } — function",
							"—Ⓕ– lexer_find_definition ( ) { … } — function",
							"—Ⓕ– lexer_compile_rules ( ) { … } — function",
							"—Ⓕ– lexer_peek ( ) { … } — function",
							"—Ⓕ– lexer_skip_n ( ) { … } — function",
							"—Ⓕ– lexer_skip ( ) { … } — function",
							"—Ⓕ– lexer_clear_token ( ) { … } — function",
							"—Ⓕ– lexer_charlen ( ) { … } — function",
							"—Ⓕ– lexer_lexeme ( ) { … } — function",
							"—Ⓕ– lexer_next ( ) { … } — function",
							"—Ⓕ– lexer_set_input ( ) { … } — function",
							"—Ⓕ– lexer_set_location ( ) { … } — function",
							"—Ⓕ– lexer_release ( ) { … } — function",
							"—Ⓕ– lexer_free ( ) { … } — function",
							"—Ⓕ– lexer_release_rt ( ) { … } — function",
							"—Ⓕ– lexer_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_dump ( ) { … } — function"
						]
					},
					"CAAAAAAAAAAAAAAAAAAAAAAAAAC4BgAA4oCU4pK74oCTIGxleGVyX3N0YXRlX2ZpbmRiICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfbmV3ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfcHVzaCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3BvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3RvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlc19za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVzX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX3JlZ2V4ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9leHBhbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2NvbXBpbGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX21hdGNoICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9hZGQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZpbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9pbml0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZGVmaW5lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZmluZF9kZWZpbml0aW9uICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY29tcGlsZV9ydWxlcyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3BlZWsgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwX24gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY2xlYXJfdG9rZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9jaGFybGVuICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbGV4ZW1lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbmV4dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9pbnB1dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9sb2NhdGlvbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3JlbGVhc2UgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9mcmVlICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcmVsZWFzZV9ydCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9kdW1wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgAAAAAAAAAAZAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALgGAADigJTikrvigJMgbGV4ZXJfc3RhdGVfZmluZGIgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9zdGF0ZV9uZXcgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9zdGF0ZV9wdXNoICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfcG9wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfdG9wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVzX3NraXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9zdGF0ZXNfZHVtcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3J1bGVfcmVnZXggKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2V4cGFuZCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3J1bGVfY29tcGlsZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3J1bGVfbWF0Y2ggKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2FkZCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3J1bGVfZmluZCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3J1bGVfZnJlZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3J1bGVfZnJlZV9ydCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3J1bGVfZHVtcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2luaXQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9kZWZpbmUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9maW5kX2RlZmluaXRpb24gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9jb21waWxlX3J1bGVzICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcGVlayAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NraXBfbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NraXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9jbGVhcl90b2tlbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2NoYXJsZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9sZXhlbWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9uZXh0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc2V0X2lucHV0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc2V0X2xvY2F0aW9uICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcmVsZWFzZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2ZyZWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9yZWxlYXNlX3J0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZnJlZV9ydCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uAAAAAAAAAABkBQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAuAYAAOKAlOKSu+KAkyBsZXhlcl9zdGF0ZV9maW5kYiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX25ldyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3B1c2ggKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9zdGF0ZV9wb3AgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9zdGF0ZV90b3AgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9zdGF0ZXNfc2tpcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlc19kdW1wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9yZWdleCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3J1bGVfZXhwYW5kICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9jb21waWxlICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9tYXRjaCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3J1bGVfYWRkICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9maW5kICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9mcmVlICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9mcmVlX3J0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9kdW1wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfaW5pdCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2RlZmluZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2ZpbmRfZGVmaW5pdGlvbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2NvbXBpbGVfcnVsZXMgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9wZWVrICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc2tpcF9uICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc2tpcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2NsZWFyX3Rva2VuICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY2hhcmxlbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2xleGVtZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX25leHQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9zZXRfaW5wdXQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9zZXRfbG9jYXRpb24gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9yZWxlYXNlICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZnJlZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3JlbGVhc2VfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9mcmVlX3J0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZHVtcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24AAAAAAAAAAGQFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC4BgAA4oCU4pK74oCTIGxleGVyX3N0YXRlX2ZpbmRiICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfbmV3ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfcHVzaCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3BvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3RvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlc19za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVzX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX3JlZ2V4ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9leHBhbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2NvbXBpbGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX21hdGNoICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9hZGQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZpbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9pbml0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZGVmaW5lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZmluZF9kZWZpbml0aW9uICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY29tcGlsZV9ydWxlcyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3BlZWsgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwX24gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY2xlYXJfdG9rZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9jaGFybGVuICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbGV4ZW1lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbmV4dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9pbnB1dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9sb2NhdGlvbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3JlbGVhc2UgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9mcmVlICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcmVsZWFzZV9ydCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9kdW1wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgAAAAAAAAAAZAUAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					493,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/quickjs/qjs-modules/src/lexer.c",
						"symkeys":
						[
							[
								168,
								185
							],
							[
								434,
								449
							],
							[
								730,
								746
							],
							[
								1096,
								1111
							],
							[
								1549,
								1564
							],
							[
								1825,
								1842
							],
							[
								2003,
								2020
							],
							[
								2321,
								2337
							],
							[
								2405,
								2422
							],
							[
								2938,
								2956
							],
							[
								3544,
								3560
							],
							[
								3935,
								3949
							],
							[
								4793,
								4808
							],
							[
								5017,
								5032
							],
							[
								5207,
								5225
							],
							[
								5410,
								5425
							],
							[
								5663,
								5673
							],
							[
								6099,
								6111
							],
							[
								6313,
								6334
							],
							[
								6592,
								6611
							],
							[
								6792,
								6802
							],
							[
								9573,
								9585
							],
							[
								9863,
								9873
							],
							[
								10013,
								10030
							],
							[
								10161,
								10174
							],
							[
								10358,
								10370
							],
							[
								10502,
								10512
							],
							[
								10642,
								10657
							],
							[
								10769,
								10787
							],
							[
								11012,
								11025
							],
							[
								11561,
								11571
							],
							[
								11686,
								11702
							],
							[
								12164,
								12177
							],
							[
								12295,
								12305
							]
						],
						"symlist":
						[
							"—Ⓕ– lexer_state_findb ( ) { … } — function",
							"—Ⓕ– lexer_state_new ( ) { … } — function",
							"—Ⓕ– lexer_state_push ( ) { … } — function",
							"—Ⓕ– lexer_state_pop ( ) { … } — function",
							"—Ⓕ– lexer_state_top ( ) { … } — function",
							"—Ⓕ– lexer_states_skip ( ) { … } — function",
							"—Ⓕ– lexer_states_dump ( ) { … } — function",
							"—Ⓕ– lexer_rule_regex ( ) { … } — function",
							"—Ⓕ– lexer_rule_expand ( ) { … } — function",
							"—Ⓕ– lexer_rule_compile ( ) { … } — function",
							"—Ⓕ– lexer_rule_match ( ) { … } — function",
							"—Ⓕ– lexer_rule_add ( ) { … } — function",
							"—Ⓕ– lexer_rule_find ( ) { … } — function",
							"—Ⓕ– lexer_rule_free ( ) { … } — function",
							"—Ⓕ– lexer_rule_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_rule_dump ( ) { … } — function",
							"—Ⓕ– lexer_init ( ) { … } — function",
							"—Ⓕ– lexer_define ( ) { … } — function",
							"—Ⓕ– lexer_find_definition ( ) { … } — function",
							"—Ⓕ– lexer_compile_rules ( ) { … } — function",
							"—Ⓕ– lexer_peek ( ) { … } — function",
							"—Ⓕ– lexer_skip_n ( ) { … } — function",
							"—Ⓕ– lexer_skip ( ) { … } — function",
							"—Ⓕ– lexer_clear_token ( ) { … } — function",
							"—Ⓕ– lexer_charlen ( ) { … } — function",
							"—Ⓕ– lexer_lexeme ( ) { … } — function",
							"—Ⓕ– lexer_next ( ) { … } — function",
							"—Ⓕ– lexer_set_input ( ) { … } — function",
							"—Ⓕ– lexer_set_location ( ) { … } — function",
							"—Ⓕ– lexer_release ( ) { … } — function",
							"—Ⓕ– lexer_free ( ) { … } — function",
							"—Ⓕ– lexer_release_rt ( ) { … } — function",
							"—Ⓕ– lexer_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_dump ( ) { … } — function"
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAAC4BgAA4oCU4pK74oCTIGxleGVyX3N0YXRlX2ZpbmRiICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfbmV3ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfcHVzaCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3BvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3RvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlc19za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVzX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX3JlZ2V4ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9leHBhbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2NvbXBpbGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX21hdGNoICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9hZGQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZpbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9pbml0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZGVmaW5lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZmluZF9kZWZpbml0aW9uICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY29tcGlsZV9ydWxlcyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3BlZWsgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwX24gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY2xlYXJfdG9rZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9jaGFybGVuICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbGV4ZW1lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbmV4dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9pbnB1dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9sb2NhdGlvbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3JlbGVhc2UgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9mcmVlICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcmVsZWFzZV9ydCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9kdW1wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgAAAAAAAAAAZAUAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					494,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/quickjs/qjs-modules/src/lexer.c",
						"symkeys":
						[
							[
								168,
								185
							],
							[
								434,
								449
							],
							[
								730,
								746
							],
							[
								1096,
								1111
							],
							[
								1549,
								1564
							],
							[
								1825,
								1842
							],
							[
								2003,
								2020
							],
							[
								2321,
								2337
							],
							[
								2405,
								2422
							],
							[
								2938,
								2956
							],
							[
								3544,
								3560
							],
							[
								3935,
								3949
							],
							[
								4793,
								4808
							],
							[
								5017,
								5032
							],
							[
								5207,
								5225
							],
							[
								5410,
								5425
							],
							[
								5663,
								5673
							],
							[
								6099,
								6111
							],
							[
								6313,
								6334
							],
							[
								6592,
								6611
							],
							[
								6792,
								6802
							],
							[
								9572,
								9584
							],
							[
								9862,
								9872
							],
							[
								10012,
								10029
							],
							[
								10160,
								10173
							],
							[
								10357,
								10369
							],
							[
								10501,
								10511
							],
							[
								10641,
								10656
							],
							[
								10768,
								10786
							],
							[
								11011,
								11024
							],
							[
								11560,
								11570
							],
							[
								11685,
								11701
							],
							[
								12163,
								12176
							],
							[
								12294,
								12304
							]
						],
						"symlist":
						[
							"—Ⓕ– lexer_state_findb ( ) { … } — function",
							"—Ⓕ– lexer_state_new ( ) { … } — function",
							"—Ⓕ– lexer_state_push ( ) { … } — function",
							"—Ⓕ– lexer_state_pop ( ) { … } — function",
							"—Ⓕ– lexer_state_top ( ) { … } — function",
							"—Ⓕ– lexer_states_skip ( ) { … } — function",
							"—Ⓕ– lexer_states_dump ( ) { … } — function",
							"—Ⓕ– lexer_rule_regex ( ) { … } — function",
							"—Ⓕ– lexer_rule_expand ( ) { … } — function",
							"—Ⓕ– lexer_rule_compile ( ) { … } — function",
							"—Ⓕ– lexer_rule_match ( ) { … } — function",
							"—Ⓕ– lexer_rule_add ( ) { … } — function",
							"—Ⓕ– lexer_rule_find ( ) { … } — function",
							"—Ⓕ– lexer_rule_free ( ) { … } — function",
							"—Ⓕ– lexer_rule_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_rule_dump ( ) { … } — function",
							"—Ⓕ– lexer_init ( ) { … } — function",
							"—Ⓕ– lexer_define ( ) { … } — function",
							"—Ⓕ– lexer_find_definition ( ) { … } — function",
							"—Ⓕ– lexer_compile_rules ( ) { … } — function",
							"—Ⓕ– lexer_peek ( ) { … } — function",
							"—Ⓕ– lexer_skip_n ( ) { … } — function",
							"—Ⓕ– lexer_skip ( ) { … } — function",
							"—Ⓕ– lexer_clear_token ( ) { … } — function",
							"—Ⓕ– lexer_charlen ( ) { … } — function",
							"—Ⓕ– lexer_lexeme ( ) { … } — function",
							"—Ⓕ– lexer_next ( ) { … } — function",
							"—Ⓕ– lexer_set_input ( ) { … } — function",
							"—Ⓕ– lexer_set_location ( ) { … } — function",
							"—Ⓕ– lexer_release ( ) { … } — function",
							"—Ⓕ– lexer_free ( ) { … } — function",
							"—Ⓕ– lexer_release_rt ( ) { … } — function",
							"—Ⓕ– lexer_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_dump ( ) { … } — function"
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAAC4BgAA4oCU4pK74oCTIGxleGVyX3N0YXRlX2ZpbmRiICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfbmV3ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfcHVzaCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3BvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3RvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlc19za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVzX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX3JlZ2V4ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9leHBhbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2NvbXBpbGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX21hdGNoICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9hZGQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZpbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9pbml0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZGVmaW5lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZmluZF9kZWZpbml0aW9uICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY29tcGlsZV9ydWxlcyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3BlZWsgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwX24gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY2xlYXJfdG9rZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9jaGFybGVuICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbGV4ZW1lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbmV4dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9pbnB1dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9sb2NhdGlvbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3JlbGVhc2UgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9mcmVlICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcmVsZWFzZV9ydCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9kdW1wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgAAAAAAAAAAZAUAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					495,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/quickjs/qjs-modules/quickjs-lexer.c",
						"symkeys":
						[
							[
								359,
								370
							],
							[
								650,
								664
							],
							[
								934,
								951
							],
							[
								2023,
								2036
							],
							[
								2065,
								2078
							],
							[
								2369,
								2381
							],
							[
								2738,
								2751
							],
							[
								2933,
								2953
							],
							[
								4222,
								4239
							],
							[
								4482,
								4502
							],
							[
								5121,
								5137
							],
							[
								6488,
								6500
							],
							[
								8413,
								8431
							],
							[
								10301,
								10315
							],
							[
								10583,
								10597
							],
							[
								10923,
								10935
							],
							[
								11568,
								11577
							],
							[
								12960,
								12977
							],
							[
								13292,
								13311
							],
							[
								13567,
								13585
							],
							[
								13972,
								13986
							],
							[
								14248,
								14259
							],
							[
								14587,
								14599
							],
							[
								15184,
								15197
							],
							[
								15364,
								15381
							],
							[
								16580,
								16600
							],
							[
								17913,
								17928
							],
							[
								25644,
								25656
							],
							[
								28954,
								28966
							],
							[
								30360,
								30375
							],
							[
								30763,
								30778
							],
							[
								31128,
								31147
							],
							[
								31896,
								31911
							],
							[
								32349,
								32366
							],
							[
								32838,
								32850
							],
							[
								34642,
								34657
							],
							[
								35481,
								35494
							],
							[
								35717,
								35730
							],
							[
								36335,
								36352
							],
							[
								36749,
								36765
							],
							[
								37815,
								37833
							],
							[
								41895,
								41908
							],
							[
								43376,
								43390
							],
							[
								43420,
								43434
							]
						],
						"symlist":
						[
							" Ⓣ  JSLexerRule ; — typedef",
							"—Ⓕ– offset_toarray ( ) { … } — function",
							"—Ⓕ– js_lexer_rule_new ( ) { … } — function",
							"—Ⓒ– token_methods { … } ; — type",
							"—Ⓒ– token_getters { … } ; — type",
							"—Ⓕ– js_token_new ( ) { … } — function",
							"—Ⓕ– js_token_wrap ( ) { … } — function",
							"—Ⓕ– js_token_constructor ( ) { … } — function",
							"—Ⓕ– js_token_tostring ( ) { … } — function",
							"—Ⓕ– js_token_toprimitive ( ) { … } — function",
							"—Ⓕ– js_token_inspect ( ) { … } — function",
							"—Ⓕ– js_token_get ( ) { … } — function",
							"—Ⓕ– js_token_finalizer ( ) { … } — function",
							"—Ⓕ– lexer_continue ( ) { … } — function",
							"—Ⓕ– lexer_to_state ( ) { … } — function",
							"—Ⓕ– lexer_handle ( ) { … } — function",
							"—Ⓕ– lexer_lex ( ) { … } — function",
							"—Ⓕ– lexer_escape_pred ( ) { … } — function",
							"—Ⓕ– lexer_unescape_pred ( ) { … } — function",
							"—Ⓕ– lexer_current_line ( ) { … } — function",
							"—Ⓕ– lexer_lexeme_s ( ) { … } — function",
							"—Ⓕ– lexer_token ( ) { … } — function",
							"—Ⓕ– js_lexer_new ( ) { … } — function",
							"—Ⓕ– js_lexer_wrap ( ) { … } — function",
							"—Ⓕ– js_lexer_add_rule ( ) { … } — function",
							"—Ⓕ– js_lexer_constructor ( ) { … } — function",
							"—Ⓕ– js_lexer_method ( ) { … } — function",
							"—Ⓕ– js_lexer_get ( ) { … } — function",
							"—Ⓕ– js_lexer_set ( ) { … } — function",
							"—Ⓕ– js_lexer_tokens ( ) { … } — function",
							"—Ⓕ– js_lexer_states ( ) { … } — function",
							"—Ⓕ– js_lexer_statestack ( ) { … } — function",
							"—Ⓕ– js_lexer_escape ( ) { … } — function",
							"—Ⓕ– js_lexer_tostring ( ) { … } — function",
							"—Ⓕ– js_lexer_lex ( ) { … } — function",
							"—Ⓕ– js_lexer_nextfn ( ) { … } — function",
							"—Ⓕ– js_lexer_next ( ) { … } — function",
							"—Ⓕ– js_lexer_call ( ) { … } — function",
							"—Ⓕ– js_lexer_iterator ( ) { … } — function",
							"—Ⓕ– js_lexer_inspect ( ) { … } — function",
							"—Ⓕ– js_lexer_finalizer ( ) { … } — function",
							"—Ⓕ– js_lexer_init ( ) { … } — function",
							" Ⓜ  JS_INIT_MODULE … — macro object",
							" Ⓜ  JS_INIT_MODULE … — macro object"
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAAC4BgAA4oCU4pK74oCTIGxleGVyX3N0YXRlX2ZpbmRiICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfbmV3ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfcHVzaCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3BvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3RvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlc19za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVzX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX3JlZ2V4ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9leHBhbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2NvbXBpbGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX21hdGNoICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9hZGQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZpbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9pbml0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZGVmaW5lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZmluZF9kZWZpbml0aW9uICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY29tcGlsZV9ydWxlcyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3BlZWsgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwX24gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY2xlYXJfdG9rZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9jaGFybGVuICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbGV4ZW1lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbmV4dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9pbnB1dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9sb2NhdGlvbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3JlbGVhc2UgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9mcmVlICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcmVsZWFzZV9ydCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9kdW1wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgAAAAAAAAAA6AYAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					496,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAACSCAAAICDik4kgIEpTTGV4ZXJSdWxlIDsg4oCUIHR5cGVkZWYK4oCU4pK74oCTIG9mZnNldF90b2FycmF5ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfcnVsZV9uZXcgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSuOKAkyB0b2tlbl9tZXRob2RzIHsg4oCmIH0gOyDigJQgdHlwZQrigJTikrjigJMgdG9rZW5fZ2V0dGVycyB7IOKApiB9IDsg4oCUIHR5cGUK4oCU4pK74oCTIGpzX3Rva2VuX25ldyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX3Rva2VuX3dyYXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc190b2tlbl9jb25zdHJ1Y3RvciAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX3Rva2VuX3Rvc3RyaW5nICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfdG9rZW5fdG9wcmltaXRpdmUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc190b2tlbl9pbnNwZWN0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfdG9rZW5fZ2V0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfdG9rZW5fZmluYWxpemVyICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY29udGludWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl90b19zdGF0ZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2hhbmRsZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2xleCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2VzY2FwZV9wcmVkICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfdW5lc2NhcGVfcHJlZCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2N1cnJlbnRfbGluZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2xleGVtZV9zICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfdG9rZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9uZXcgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl93cmFwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfYWRkX3J1bGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9jb25zdHJ1Y3RvciAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX21ldGhvZCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX2dldCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3NldCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3Rva2VucyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3N0YXRlcyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3N0YXRlc3RhY2sgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9lc2NhcGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl90b3N0cmluZyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX2xleCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX25leHRmbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX25leHQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9jYWxsICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfaXRlcmF0b3IgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9pbnNwZWN0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfZmluYWxpemVyICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfaW5pdCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24KICDik4IgIEpTX0lOSVRfTU9EVUxFIOKApiDigJQgbWFjcm8gb2JqZWN0CiAg4pOCICBKU19JTklUX01PRFVMRSDigKYg4oCUIG1hY3JvIG9iamVjdAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					497,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/quickjs/qjs-modules/quickjs-lexer.c",
						"symkeys":
						[
							[
								359,
								370
							],
							[
								650,
								664
							],
							[
								934,
								951
							],
							[
								2023,
								2036
							],
							[
								2065,
								2078
							],
							[
								2369,
								2381
							],
							[
								2738,
								2751
							],
							[
								2933,
								2953
							],
							[
								4222,
								4239
							],
							[
								4482,
								4502
							],
							[
								5121,
								5137
							],
							[
								6488,
								6500
							],
							[
								8413,
								8431
							],
							[
								10301,
								10315
							],
							[
								10583,
								10597
							],
							[
								10923,
								10935
							],
							[
								11568,
								11577
							],
							[
								12960,
								12977
							],
							[
								13292,
								13311
							],
							[
								13567,
								13585
							],
							[
								13972,
								13986
							],
							[
								14248,
								14259
							],
							[
								14587,
								14599
							],
							[
								15184,
								15197
							],
							[
								15364,
								15381
							],
							[
								16580,
								16600
							],
							[
								17913,
								17928
							],
							[
								25644,
								25656
							],
							[
								28954,
								28966
							],
							[
								30360,
								30375
							],
							[
								30763,
								30778
							],
							[
								31128,
								31147
							],
							[
								31896,
								31911
							],
							[
								32349,
								32366
							],
							[
								32838,
								32850
							],
							[
								34642,
								34657
							],
							[
								35481,
								35494
							],
							[
								35717,
								35730
							],
							[
								36335,
								36352
							],
							[
								36749,
								36765
							],
							[
								37815,
								37833
							],
							[
								41895,
								41908
							],
							[
								43376,
								43390
							],
							[
								43420,
								43434
							]
						],
						"symlist":
						[
							" Ⓣ  JSLexerRule ; — typedef",
							"—Ⓕ– offset_toarray ( ) { … } — function",
							"—Ⓕ– js_lexer_rule_new ( ) { … } — function",
							"—Ⓒ– token_methods { … } ; — type",
							"—Ⓒ– token_getters { … } ; — type",
							"—Ⓕ– js_token_new ( ) { … } — function",
							"—Ⓕ– js_token_wrap ( ) { … } — function",
							"—Ⓕ– js_token_constructor ( ) { … } — function",
							"—Ⓕ– js_token_tostring ( ) { … } — function",
							"—Ⓕ– js_token_toprimitive ( ) { … } — function",
							"—Ⓕ– js_token_inspect ( ) { … } — function",
							"—Ⓕ– js_token_get ( ) { … } — function",
							"—Ⓕ– js_token_finalizer ( ) { … } — function",
							"—Ⓕ– lexer_continue ( ) { … } — function",
							"—Ⓕ– lexer_to_state ( ) { … } — function",
							"—Ⓕ– lexer_handle ( ) { … } — function",
							"—Ⓕ– lexer_lex ( ) { … } — function",
							"—Ⓕ– lexer_escape_pred ( ) { … } — function",
							"—Ⓕ– lexer_unescape_pred ( ) { … } — function",
							"—Ⓕ– lexer_current_line ( ) { … } — function",
							"—Ⓕ– lexer_lexeme_s ( ) { … } — function",
							"—Ⓕ– lexer_token ( ) { … } — function",
							"—Ⓕ– js_lexer_new ( ) { … } — function",
							"—Ⓕ– js_lexer_wrap ( ) { … } — function",
							"—Ⓕ– js_lexer_add_rule ( ) { … } — function",
							"—Ⓕ– js_lexer_constructor ( ) { … } — function",
							"—Ⓕ– js_lexer_method ( ) { … } — function",
							"—Ⓕ– js_lexer_get ( ) { … } — function",
							"—Ⓕ– js_lexer_set ( ) { … } — function",
							"—Ⓕ– js_lexer_tokens ( ) { … } — function",
							"—Ⓕ– js_lexer_states ( ) { … } — function",
							"—Ⓕ– js_lexer_statestack ( ) { … } — function",
							"—Ⓕ– js_lexer_escape ( ) { … } — function",
							"—Ⓕ– js_lexer_tostring ( ) { … } — function",
							"—Ⓕ– js_lexer_lex ( ) { … } — function",
							"—Ⓕ– js_lexer_nextfn ( ) { … } — function",
							"—Ⓕ– js_lexer_next ( ) { … } — function",
							"—Ⓕ– js_lexer_call ( ) { … } — function",
							"—Ⓕ– js_lexer_iterator ( ) { … } — function",
							"—Ⓕ– js_lexer_inspect ( ) { … } — function",
							"—Ⓕ– js_lexer_finalizer ( ) { … } — function",
							"—Ⓕ– js_lexer_init ( ) { … } — function",
							" Ⓜ  JS_INIT_MODULE … — macro object",
							" Ⓜ  JS_INIT_MODULE … — macro object"
						]
					},
					"AQAAAAAAAAAAAAAA6AYAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					498,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAACSCAAAICDik4kgIEpTTGV4ZXJSdWxlIDsg4oCUIHR5cGVkZWYK4oCU4pK74oCTIG9mZnNldF90b2FycmF5ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfcnVsZV9uZXcgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSuOKAkyB0b2tlbl9tZXRob2RzIHsg4oCmIH0gOyDigJQgdHlwZQrigJTikrjigJMgdG9rZW5fZ2V0dGVycyB7IOKApiB9IDsg4oCUIHR5cGUK4oCU4pK74oCTIGpzX3Rva2VuX25ldyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX3Rva2VuX3dyYXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc190b2tlbl9jb25zdHJ1Y3RvciAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX3Rva2VuX3Rvc3RyaW5nICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfdG9rZW5fdG9wcmltaXRpdmUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc190b2tlbl9pbnNwZWN0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfdG9rZW5fZ2V0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfdG9rZW5fZmluYWxpemVyICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY29udGludWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl90b19zdGF0ZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2hhbmRsZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2xleCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2VzY2FwZV9wcmVkICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfdW5lc2NhcGVfcHJlZCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2N1cnJlbnRfbGluZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2xleGVtZV9zICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfdG9rZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9uZXcgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl93cmFwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfYWRkX3J1bGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9jb25zdHJ1Y3RvciAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX21ldGhvZCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX2dldCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3NldCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3Rva2VucyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3N0YXRlcyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3N0YXRlc3RhY2sgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9lc2NhcGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl90b3N0cmluZyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX2xleCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX25leHRmbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX25leHQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9jYWxsICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfaXRlcmF0b3IgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9pbnNwZWN0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfZmluYWxpemVyICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfaW5pdCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24KICDik4IgIEpTX0lOSVRfTU9EVUxFIOKApiDigJQgbWFjcm8gb2JqZWN0CiAg4pOCICBKU19JTklUX01PRFVMRSDigKYg4oCUIG1hY3JvIG9iamVjdAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					499,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					500,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/quickjs/qjs-modules/quickjs-lexer.c",
						"symkeys":
						[
							[
								359,
								370
							],
							[
								650,
								664
							],
							[
								934,
								951
							],
							[
								2023,
								2036
							],
							[
								2065,
								2078
							],
							[
								2369,
								2381
							],
							[
								2738,
								2751
							],
							[
								2933,
								2953
							],
							[
								4222,
								4239
							],
							[
								4482,
								4502
							],
							[
								5121,
								5137
							],
							[
								6488,
								6500
							],
							[
								8413,
								8431
							],
							[
								10301,
								10315
							],
							[
								10583,
								10597
							],
							[
								10923,
								10935
							],
							[
								11568,
								11577
							],
							[
								12960,
								12977
							],
							[
								13292,
								13311
							],
							[
								13567,
								13585
							],
							[
								13972,
								13986
							],
							[
								14248,
								14259
							],
							[
								14587,
								14599
							],
							[
								15184,
								15197
							],
							[
								15364,
								15381
							],
							[
								16580,
								16600
							],
							[
								17913,
								17928
							],
							[
								25644,
								25656
							],
							[
								28954,
								28966
							],
							[
								30360,
								30375
							],
							[
								30763,
								30778
							],
							[
								31128,
								31147
							],
							[
								31896,
								31911
							],
							[
								32349,
								32366
							],
							[
								32838,
								32850
							],
							[
								34642,
								34657
							],
							[
								35481,
								35494
							],
							[
								35717,
								35730
							],
							[
								36335,
								36352
							],
							[
								36749,
								36765
							],
							[
								37815,
								37833
							],
							[
								41895,
								41908
							],
							[
								43376,
								43390
							],
							[
								43420,
								43434
							]
						],
						"symlist":
						[
							" Ⓣ  JSLexerRule ; — typedef",
							"—Ⓕ– offset_toarray ( ) { … } — function",
							"—Ⓕ– js_lexer_rule_new ( ) { … } — function",
							"—Ⓒ– token_methods { … } ; — type",
							"—Ⓒ– token_getters { … } ; — type",
							"—Ⓕ– js_token_new ( ) { … } — function",
							"—Ⓕ– js_token_wrap ( ) { … } — function",
							"—Ⓕ– js_token_constructor ( ) { … } — function",
							"—Ⓕ– js_token_tostring ( ) { … } — function",
							"—Ⓕ– js_token_toprimitive ( ) { … } — function",
							"—Ⓕ– js_token_inspect ( ) { … } — function",
							"—Ⓕ– js_token_get ( ) { … } — function",
							"—Ⓕ– js_token_finalizer ( ) { … } — function",
							"—Ⓕ– lexer_continue ( ) { … } — function",
							"—Ⓕ– lexer_to_state ( ) { … } — function",
							"—Ⓕ– lexer_handle ( ) { … } — function",
							"—Ⓕ– lexer_lex ( ) { … } — function",
							"—Ⓕ– lexer_escape_pred ( ) { … } — function",
							"—Ⓕ– lexer_unescape_pred ( ) { … } — function",
							"—Ⓕ– lexer_current_line ( ) { … } — function",
							"—Ⓕ– lexer_lexeme_s ( ) { … } — function",
							"—Ⓕ– lexer_token ( ) { … } — function",
							"—Ⓕ– js_lexer_new ( ) { … } — function",
							"—Ⓕ– js_lexer_wrap ( ) { … } — function",
							"—Ⓕ– js_lexer_add_rule ( ) { … } — function",
							"—Ⓕ– js_lexer_constructor ( ) { … } — function",
							"—Ⓕ– js_lexer_method ( ) { … } — function",
							"—Ⓕ– js_lexer_get ( ) { … } — function",
							"—Ⓕ– js_lexer_set ( ) { … } — function",
							"—Ⓕ– js_lexer_tokens ( ) { … } — function",
							"—Ⓕ– js_lexer_states ( ) { … } — function",
							"—Ⓕ– js_lexer_statestack ( ) { … } — function",
							"—Ⓕ– js_lexer_escape ( ) { … } — function",
							"—Ⓕ– js_lexer_tostring ( ) { … } — function",
							"—Ⓕ– js_lexer_lex ( ) { … } — function",
							"—Ⓕ– js_lexer_nextfn ( ) { … } — function",
							"—Ⓕ– js_lexer_next ( ) { … } — function",
							"—Ⓕ– js_lexer_call ( ) { … } — function",
							"—Ⓕ– js_lexer_iterator ( ) { … } — function",
							"—Ⓕ– js_lexer_inspect ( ) { … } — function",
							"—Ⓕ– js_lexer_finalizer ( ) { … } — function",
							"—Ⓕ– js_lexer_init ( ) { … } — function",
							" Ⓜ  JS_INIT_MODULE … — macro object",
							" Ⓜ  JS_INIT_MODULE … — macro object"
						]
					},
					"AQAAAAAAAAAAAAAA6AYAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					501,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/quickjs/qjs-modules/src/lexer.c",
						"symkeys":
						[
							[
								168,
								185
							],
							[
								434,
								449
							],
							[
								730,
								746
							],
							[
								1096,
								1111
							],
							[
								1549,
								1564
							],
							[
								1825,
								1842
							],
							[
								2003,
								2020
							],
							[
								2321,
								2337
							],
							[
								2405,
								2422
							],
							[
								2938,
								2956
							],
							[
								3544,
								3560
							],
							[
								3935,
								3949
							],
							[
								4793,
								4808
							],
							[
								5017,
								5032
							],
							[
								5207,
								5225
							],
							[
								5410,
								5425
							],
							[
								5663,
								5673
							],
							[
								6099,
								6111
							],
							[
								6313,
								6334
							],
							[
								6592,
								6611
							],
							[
								6792,
								6802
							],
							[
								9586,
								9598
							],
							[
								9876,
								9886
							],
							[
								10026,
								10043
							],
							[
								10174,
								10187
							],
							[
								10371,
								10383
							],
							[
								10515,
								10525
							],
							[
								10655,
								10670
							],
							[
								10782,
								10800
							],
							[
								11025,
								11038
							],
							[
								11574,
								11584
							],
							[
								11699,
								11715
							],
							[
								12177,
								12190
							],
							[
								12308,
								12318
							]
						],
						"symlist":
						[
							"—Ⓕ– lexer_state_findb ( ) { … } — function",
							"—Ⓕ– lexer_state_new ( ) { … } — function",
							"—Ⓕ– lexer_state_push ( ) { … } — function",
							"—Ⓕ– lexer_state_pop ( ) { … } — function",
							"—Ⓕ– lexer_state_top ( ) { … } — function",
							"—Ⓕ– lexer_states_skip ( ) { … } — function",
							"—Ⓕ– lexer_states_dump ( ) { … } — function",
							"—Ⓕ– lexer_rule_regex ( ) { … } — function",
							"—Ⓕ– lexer_rule_expand ( ) { … } — function",
							"—Ⓕ– lexer_rule_compile ( ) { … } — function",
							"—Ⓕ– lexer_rule_match ( ) { … } — function",
							"—Ⓕ– lexer_rule_add ( ) { … } — function",
							"—Ⓕ– lexer_rule_find ( ) { … } — function",
							"—Ⓕ– lexer_rule_free ( ) { … } — function",
							"—Ⓕ– lexer_rule_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_rule_dump ( ) { … } — function",
							"—Ⓕ– lexer_init ( ) { … } — function",
							"—Ⓕ– lexer_define ( ) { … } — function",
							"—Ⓕ– lexer_find_definition ( ) { … } — function",
							"—Ⓕ– lexer_compile_rules ( ) { … } — function",
							"—Ⓕ– lexer_peek ( ) { … } — function",
							"—Ⓕ– lexer_skip_n ( ) { … } — function",
							"—Ⓕ– lexer_skip ( ) { … } — function",
							"—Ⓕ– lexer_clear_token ( ) { … } — function",
							"—Ⓕ– lexer_charlen ( ) { … } — function",
							"—Ⓕ– lexer_lexeme ( ) { … } — function",
							"—Ⓕ– lexer_next ( ) { … } — function",
							"—Ⓕ– lexer_set_input ( ) { … } — function",
							"—Ⓕ– lexer_set_location ( ) { … } — function",
							"—Ⓕ– lexer_release ( ) { … } — function",
							"—Ⓕ– lexer_free ( ) { … } — function",
							"—Ⓕ– lexer_release_rt ( ) { … } — function",
							"—Ⓕ– lexer_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_dump ( ) { … } — function"
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAACSCAAAICDik4kgIEpTTGV4ZXJSdWxlIDsg4oCUIHR5cGVkZWYK4oCU4pK74oCTIG9mZnNldF90b2FycmF5ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfcnVsZV9uZXcgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSuOKAkyB0b2tlbl9tZXRob2RzIHsg4oCmIH0gOyDigJQgdHlwZQrigJTikrjigJMgdG9rZW5fZ2V0dGVycyB7IOKApiB9IDsg4oCUIHR5cGUK4oCU4pK74oCTIGpzX3Rva2VuX25ldyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX3Rva2VuX3dyYXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc190b2tlbl9jb25zdHJ1Y3RvciAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX3Rva2VuX3Rvc3RyaW5nICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfdG9rZW5fdG9wcmltaXRpdmUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc190b2tlbl9pbnNwZWN0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfdG9rZW5fZ2V0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfdG9rZW5fZmluYWxpemVyICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY29udGludWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl90b19zdGF0ZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2hhbmRsZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2xleCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2VzY2FwZV9wcmVkICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfdW5lc2NhcGVfcHJlZCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2N1cnJlbnRfbGluZSAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2xleGVtZV9zICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfdG9rZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9uZXcgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl93cmFwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfYWRkX3J1bGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9jb25zdHJ1Y3RvciAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX21ldGhvZCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX2dldCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3NldCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3Rva2VucyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3N0YXRlcyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX3N0YXRlc3RhY2sgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9lc2NhcGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl90b3N0cmluZyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX2xleCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX25leHRmbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGpzX2xleGVyX25leHQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9jYWxsICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfaXRlcmF0b3IgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBqc19sZXhlcl9pbnNwZWN0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfZmluYWxpemVyICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMganNfbGV4ZXJfaW5pdCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24KICDik4IgIEpTX0lOSVRfTU9EVUxFIOKApiDigJQgbWFjcm8gb2JqZWN0CiAg4pOCICBKU19JTklUX01PRFVMRSDigKYg4oCUIG1hY3JvIG9iamVjdAAAAAAAAAAAZAUAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					502,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/quickjs/qjs-modules/src/lexer.c",
						"symkeys":
						[
							[
								168,
								185
							],
							[
								434,
								449
							],
							[
								730,
								746
							],
							[
								1096,
								1111
							],
							[
								1549,
								1564
							],
							[
								1825,
								1842
							],
							[
								2003,
								2020
							],
							[
								2321,
								2337
							],
							[
								2405,
								2422
							],
							[
								2938,
								2956
							],
							[
								3544,
								3560
							],
							[
								3935,
								3949
							],
							[
								4793,
								4808
							],
							[
								5017,
								5032
							],
							[
								5207,
								5225
							],
							[
								5410,
								5425
							],
							[
								5663,
								5673
							],
							[
								6099,
								6111
							],
							[
								6313,
								6334
							],
							[
								6592,
								6611
							],
							[
								6792,
								6802
							],
							[
								9586,
								9598
							],
							[
								9876,
								9886
							],
							[
								10026,
								10043
							],
							[
								10174,
								10187
							],
							[
								10371,
								10383
							],
							[
								10515,
								10525
							],
							[
								10655,
								10670
							],
							[
								10782,
								10800
							],
							[
								11025,
								11038
							],
							[
								11574,
								11584
							],
							[
								11699,
								11715
							],
							[
								12177,
								12190
							],
							[
								12308,
								12318
							]
						],
						"symlist":
						[
							"—Ⓕ– lexer_state_findb ( ) { … } — function",
							"—Ⓕ– lexer_state_new ( ) { … } — function",
							"—Ⓕ– lexer_state_push ( ) { … } — function",
							"—Ⓕ– lexer_state_pop ( ) { … } — function",
							"—Ⓕ– lexer_state_top ( ) { … } — function",
							"—Ⓕ– lexer_states_skip ( ) { … } — function",
							"—Ⓕ– lexer_states_dump ( ) { … } — function",
							"—Ⓕ– lexer_rule_regex ( ) { … } — function",
							"—Ⓕ– lexer_rule_expand ( ) { … } — function",
							"—Ⓕ– lexer_rule_compile ( ) { … } — function",
							"—Ⓕ– lexer_rule_match ( ) { … } — function",
							"—Ⓕ– lexer_rule_add ( ) { … } — function",
							"—Ⓕ– lexer_rule_find ( ) { … } — function",
							"—Ⓕ– lexer_rule_free ( ) { … } — function",
							"—Ⓕ– lexer_rule_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_rule_dump ( ) { … } — function",
							"—Ⓕ– lexer_init ( ) { … } — function",
							"—Ⓕ– lexer_define ( ) { … } — function",
							"—Ⓕ– lexer_find_definition ( ) { … } — function",
							"—Ⓕ– lexer_compile_rules ( ) { … } — function",
							"—Ⓕ– lexer_peek ( ) { … } — function",
							"—Ⓕ– lexer_skip_n ( ) { … } — function",
							"—Ⓕ– lexer_skip ( ) { … } — function",
							"—Ⓕ– lexer_clear_token ( ) { … } — function",
							"—Ⓕ– lexer_charlen ( ) { … } — function",
							"—Ⓕ– lexer_lexeme ( ) { … } — function",
							"—Ⓕ– lexer_next ( ) { … } — function",
							"—Ⓕ– lexer_set_input ( ) { … } — function",
							"—Ⓕ– lexer_set_location ( ) { … } — function",
							"—Ⓕ– lexer_release ( ) { … } — function",
							"—Ⓕ– lexer_free ( ) { … } — function",
							"—Ⓕ– lexer_release_rt ( ) { … } — function",
							"—Ⓕ– lexer_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_dump ( ) { … } — function"
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAAC4BgAA4oCU4pK74oCTIGxleGVyX3N0YXRlX2ZpbmRiICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfbmV3ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfcHVzaCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3BvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3RvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlc19za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVzX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX3JlZ2V4ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9leHBhbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2NvbXBpbGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX21hdGNoICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9hZGQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZpbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9pbml0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZGVmaW5lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZmluZF9kZWZpbml0aW9uICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY29tcGlsZV9ydWxlcyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3BlZWsgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwX24gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY2xlYXJfdG9rZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9jaGFybGVuICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbGV4ZW1lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbmV4dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9pbnB1dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9sb2NhdGlvbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3JlbGVhc2UgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9mcmVlICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcmVsZWFzZV9ydCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9kdW1wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgAAAAAAAAAAZAUAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					503,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/quickjs/qjs-modules/src/lexer.c",
						"symkeys":
						[
							[
								168,
								185
							],
							[
								434,
								449
							],
							[
								730,
								746
							],
							[
								1096,
								1111
							],
							[
								1549,
								1564
							],
							[
								1825,
								1842
							],
							[
								2003,
								2020
							],
							[
								2321,
								2337
							],
							[
								2405,
								2422
							],
							[
								2938,
								2956
							],
							[
								3544,
								3560
							],
							[
								3935,
								3949
							],
							[
								4793,
								4808
							],
							[
								5017,
								5032
							],
							[
								5207,
								5225
							],
							[
								5410,
								5425
							],
							[
								5663,
								5673
							],
							[
								6099,
								6111
							],
							[
								6313,
								6334
							],
							[
								6592,
								6611
							],
							[
								6792,
								6802
							],
							[
								9593,
								9605
							],
							[
								9883,
								9893
							],
							[
								10033,
								10050
							],
							[
								10181,
								10194
							],
							[
								10378,
								10390
							],
							[
								10522,
								10532
							],
							[
								10662,
								10677
							],
							[
								10789,
								10807
							],
							[
								11032,
								11045
							],
							[
								11581,
								11591
							],
							[
								11706,
								11722
							],
							[
								12184,
								12197
							],
							[
								12315,
								12325
							]
						],
						"symlist":
						[
							"—Ⓕ– lexer_state_findb ( ) { … } — function",
							"—Ⓕ– lexer_state_new ( ) { … } — function",
							"—Ⓕ– lexer_state_push ( ) { … } — function",
							"—Ⓕ– lexer_state_pop ( ) { … } — function",
							"—Ⓕ– lexer_state_top ( ) { … } — function",
							"—Ⓕ– lexer_states_skip ( ) { … } — function",
							"—Ⓕ– lexer_states_dump ( ) { … } — function",
							"—Ⓕ– lexer_rule_regex ( ) { … } — function",
							"—Ⓕ– lexer_rule_expand ( ) { … } — function",
							"—Ⓕ– lexer_rule_compile ( ) { … } — function",
							"—Ⓕ– lexer_rule_match ( ) { … } — function",
							"—Ⓕ– lexer_rule_add ( ) { … } — function",
							"—Ⓕ– lexer_rule_find ( ) { … } — function",
							"—Ⓕ– lexer_rule_free ( ) { … } — function",
							"—Ⓕ– lexer_rule_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_rule_dump ( ) { … } — function",
							"—Ⓕ– lexer_init ( ) { … } — function",
							"—Ⓕ– lexer_define ( ) { … } — function",
							"—Ⓕ– lexer_find_definition ( ) { … } — function",
							"—Ⓕ– lexer_compile_rules ( ) { … } — function",
							"—Ⓕ– lexer_peek ( ) { … } — function",
							"—Ⓕ– lexer_skip_n ( ) { … } — function",
							"—Ⓕ– lexer_skip ( ) { … } — function",
							"—Ⓕ– lexer_clear_token ( ) { … } — function",
							"—Ⓕ– lexer_charlen ( ) { … } — function",
							"—Ⓕ– lexer_lexeme ( ) { … } — function",
							"—Ⓕ– lexer_next ( ) { … } — function",
							"—Ⓕ– lexer_set_input ( ) { … } — function",
							"—Ⓕ– lexer_set_location ( ) { … } — function",
							"—Ⓕ– lexer_release ( ) { … } — function",
							"—Ⓕ– lexer_free ( ) { … } — function",
							"—Ⓕ– lexer_release_rt ( ) { … } — function",
							"—Ⓕ– lexer_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_dump ( ) { … } — function"
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAAC4BgAA4oCU4pK74oCTIGxleGVyX3N0YXRlX2ZpbmRiICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfbmV3ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfcHVzaCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3BvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3RvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlc19za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVzX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX3JlZ2V4ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9leHBhbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2NvbXBpbGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX21hdGNoICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9hZGQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZpbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9pbml0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZGVmaW5lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZmluZF9kZWZpbml0aW9uICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY29tcGlsZV9ydWxlcyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3BlZWsgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwX24gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY2xlYXJfdG9rZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9jaGFybGVuICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbGV4ZW1lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbmV4dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9pbnB1dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9sb2NhdGlvbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3JlbGVhc2UgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9mcmVlICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcmVsZWFzZV9ydCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9kdW1wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgAAAAAAAAAAZAUAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					504,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/quickjs/qjs-modules/src/lexer.c",
						"symkeys":
						[
							[
								168,
								185
							],
							[
								434,
								449
							],
							[
								730,
								746
							],
							[
								1096,
								1111
							],
							[
								1549,
								1564
							],
							[
								1825,
								1842
							],
							[
								2003,
								2020
							],
							[
								2321,
								2337
							],
							[
								2405,
								2422
							],
							[
								2938,
								2956
							],
							[
								3544,
								3560
							],
							[
								3935,
								3949
							],
							[
								4793,
								4808
							],
							[
								5017,
								5032
							],
							[
								5207,
								5225
							],
							[
								5410,
								5425
							],
							[
								5663,
								5673
							],
							[
								6099,
								6111
							],
							[
								6313,
								6334
							],
							[
								6592,
								6611
							],
							[
								6792,
								6802
							],
							[
								9593,
								9605
							],
							[
								9883,
								9893
							],
							[
								10033,
								10050
							],
							[
								10181,
								10194
							],
							[
								10378,
								10390
							],
							[
								10522,
								10532
							],
							[
								10662,
								10677
							],
							[
								10789,
								10807
							],
							[
								11032,
								11045
							],
							[
								11581,
								11591
							],
							[
								11706,
								11722
							],
							[
								12184,
								12197
							],
							[
								12315,
								12325
							]
						],
						"symlist":
						[
							"—Ⓕ– lexer_state_findb ( ) { … } — function",
							"—Ⓕ– lexer_state_new ( ) { … } — function",
							"—Ⓕ– lexer_state_push ( ) { … } — function",
							"—Ⓕ– lexer_state_pop ( ) { … } — function",
							"—Ⓕ– lexer_state_top ( ) { … } — function",
							"—Ⓕ– lexer_states_skip ( ) { … } — function",
							"—Ⓕ– lexer_states_dump ( ) { … } — function",
							"—Ⓕ– lexer_rule_regex ( ) { … } — function",
							"—Ⓕ– lexer_rule_expand ( ) { … } — function",
							"—Ⓕ– lexer_rule_compile ( ) { … } — function",
							"—Ⓕ– lexer_rule_match ( ) { … } — function",
							"—Ⓕ– lexer_rule_add ( ) { … } — function",
							"—Ⓕ– lexer_rule_find ( ) { … } — function",
							"—Ⓕ– lexer_rule_free ( ) { … } — function",
							"—Ⓕ– lexer_rule_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_rule_dump ( ) { … } — function",
							"—Ⓕ– lexer_init ( ) { … } — function",
							"—Ⓕ– lexer_define ( ) { … } — function",
							"—Ⓕ– lexer_find_definition ( ) { … } — function",
							"—Ⓕ– lexer_compile_rules ( ) { … } — function",
							"—Ⓕ– lexer_peek ( ) { … } — function",
							"—Ⓕ– lexer_skip_n ( ) { … } — function",
							"—Ⓕ– lexer_skip ( ) { … } — function",
							"—Ⓕ– lexer_clear_token ( ) { … } — function",
							"—Ⓕ– lexer_charlen ( ) { … } — function",
							"—Ⓕ– lexer_lexeme ( ) { … } — function",
							"—Ⓕ– lexer_next ( ) { … } — function",
							"—Ⓕ– lexer_set_input ( ) { … } — function",
							"—Ⓕ– lexer_set_location ( ) { … } — function",
							"—Ⓕ– lexer_release ( ) { … } — function",
							"—Ⓕ– lexer_free ( ) { … } — function",
							"—Ⓕ– lexer_release_rt ( ) { … } — function",
							"—Ⓕ– lexer_free_rt ( ) { … } — function",
							"—Ⓕ– lexer_dump ( ) { … } — function"
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAAC4BgAA4oCU4pK74oCTIGxleGVyX3N0YXRlX2ZpbmRiICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfbmV3ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfcHVzaCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3BvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3RvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlc19za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVzX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX3JlZ2V4ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9leHBhbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2NvbXBpbGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX21hdGNoICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9hZGQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZpbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9pbml0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZGVmaW5lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZmluZF9kZWZpbml0aW9uICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY29tcGlsZV9ydWxlcyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3BlZWsgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwX24gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY2xlYXJfdG9rZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9jaGFybGVuICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbGV4ZW1lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbmV4dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9pbnB1dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9sb2NhdGlvbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3JlbGVhc2UgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9mcmVlICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcmVsZWFzZV9ydCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9kdW1wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgAAAAAAAAAAZAUAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					505,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAAC4BgAA4oCU4pK74oCTIGxleGVyX3N0YXRlX2ZpbmRiICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfbmV3ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVfcHVzaCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3BvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlX3RvcCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3N0YXRlc19za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfc3RhdGVzX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX3JlZ2V4ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9leHBhbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2NvbXBpbGUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX21hdGNoICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcnVsZV9hZGQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZpbmQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWUgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9ydWxlX2R1bXAgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9pbml0ICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZGVmaW5lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfZmluZF9kZWZpbml0aW9uICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY29tcGlsZV9ydWxlcyAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3BlZWsgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwX24gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9za2lwICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfY2xlYXJfdG9rZW4gKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9jaGFybGVuICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbGV4ZW1lICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfbmV4dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9pbnB1dCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3NldF9sb2NhdGlvbiAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX3JlbGVhc2UgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9mcmVlICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgbGV4ZXJfcmVsZWFzZV9ydCAoICkgeyDigKYgfSDigJQgZnVuY3Rpb24K4oCU4pK74oCTIGxleGVyX2ZyZWVfcnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBsZXhlcl9kdW1wICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					506,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/CMakeLists.txt",
						"symkeys":
						[
							[
								95,
								107
							],
							[
								120,
								134
							],
							[
								186,
								202
							],
							[
								446,
								463
							],
							[
								467,
								491
							],
							[
								545,
								564
							],
							[
								568,
								588
							],
							[
								649,
								669
							],
							[
								672,
								696
							],
							[
								771,
								787
							],
							[
								874,
								883
							],
							[
								1154,
								1178
							],
							[
								1213,
								1237
							],
							[
								1327,
								1351
							],
							[
								1550,
								1563
							],
							[
								1619,
								1643
							],
							[
								1823,
								1847
							],
							[
								1915,
								1925
							],
							[
								1957,
								1961
							],
							[
								1972,
								1975
							],
							[
								1985,
								1991
							],
							[
								1993,
								1996
							],
							[
								2030,
								2033
							],
							[
								2037,
								2043
							],
							[
								2045,
								2048
							],
							[
								2062,
								2068
							],
							[
								2070,
								2073
							],
							[
								2105,
								2109
							],
							[
								2113,
								2119
							],
							[
								2121,
								2124
							],
							[
								2308,
								2333
							],
							[
								2458,
								2480
							],
							[
								2517,
								2527
							],
							[
								2530,
								2552
							],
							[
								2655,
								2659
							],
							[
								2797,
								2802
							],
							[
								2875,
								2894
							],
							[
								2902,
								2921
							],
							[
								2925,
								2945
							],
							[
								2953,
								2973
							],
							[
								2994,
								3011
							],
							[
								3015,
								3039
							],
							[
								3043,
								3067
							],
							[
								3180,
								3210
							],
							[
								3294,
								3327
							],
							[
								3437,
								3456
							],
							[
								3460,
								3484
							],
							[
								3490,
								3514
							],
							[
								3525,
								3549
							],
							[
								3559,
								3583
							],
							[
								3595,
								3619
							],
							[
								3754,
								3766
							],
							[
								3777,
								3797
							],
							[
								3839,
								3851
							],
							[
								3875,
								3891
							],
							[
								3901,
								3921
							],
							[
								3950,
								3966
							],
							[
								4026,
								4044
							],
							[
								4071,
								4088
							],
							[
								4169,
								4186
							],
							[
								4262,
								4279
							],
							[
								4402,
								4420
							],
							[
								4424,
								4436
							],
							[
								4483,
								4500
							],
							[
								4509,
								4521
							],
							[
								4579,
								4594
							],
							[
								4598,
								4613
							],
							[
								4617,
								4634
							],
							[
								4675,
								4691
							],
							[
								4785,
								4802
							],
							[
								4861,
								4879
							],
							[
								4890,
								4901
							],
							[
								4934,
								4938
							],
							[
								4969,
								4973
							],
							[
								4979,
								4986
							],
							[
								5018,
								5025
							],
							[
								5036,
								5049
							],
							[
								5053,
								5066
							],
							[
								5070,
								5074
							],
							[
								5086,
								5101
							],
							[
								5105,
								5120
							],
							[
								5124,
								5128
							],
							[
								5143,
								5150
							],
							[
								5231,
								5244
							],
							[
								5300,
								5315
							],
							[
								5390,
								5426
							],
							[
								5430,
								5447
							],
							[
								5550,
								5571
							],
							[
								5799,
								5820
							],
							[
								6481,
								6500
							],
							[
								6504,
								6523
							],
							[
								6539,
								6560
							],
							[
								6564,
								6585
							],
							[
								7006,
								7025
							],
							[
								7051,
								7070
							],
							[
								7074,
								7093
							],
							[
								7164,
								7183
							],
							[
								7256,
								7277
							],
							[
								7303,
								7324
							],
							[
								7328,
								7349
							],
							[
								7422,
								7443
							],
							[
								7604,
								7623
							],
							[
								7651,
								7670
							],
							[
								7674,
								7693
							],
							[
								7766,
								7785
							],
							[
								7854,
								7875
							],
							[
								7903,
								7924
							],
							[
								7928,
								7949
							],
							[
								8024,
								8045
							],
							[
								8454,
								8467
							],
							[
								8471,
								8484
							],
							[
								8500,
								8522
							],
							[
								8526,
								8548
							],
							[
								8603,
								8621
							],
							[
								8807,
								8831
							],
							[
								8845,
								8864
							],
							[
								8878,
								8889
							],
							[
								8920,
								8927
							],
							[
								8947,
								8951
							],
							[
								8964,
								8967
							],
							[
								8995,
								8999
							],
							[
								9000,
								9008
							],
							[
								9070,
								9074
							],
							[
								9135,
								9142
							],
							[
								9155,
								9159
							],
							[
								9172,
								9176
							],
							[
								9242,
								9246
							],
							[
								9254,
								9258
							],
							[
								9268,
								9272
							],
							[
								9273,
								9281
							],
							[
								9310,
								9314
							],
							[
								9318,
								9322
							],
							[
								9356,
								9360
							],
							[
								9372,
								9383
							],
							[
								9406,
								9410
							],
							[
								9581,
								9605
							],
							[
								9687,
								9711
							],
							[
								9764,
								9784
							],
							[
								10023,
								10042
							],
							[
								10070,
								10073
							],
							[
								10086,
								10090
							],
							[
								10103,
								10123
							],
							[
								10178,
								10193
							],
							[
								10222,
								10246
							],
							[
								11284,
								11307
							],
							[
								11311,
								11330
							],
							[
								11484,
								11507
							],
							[
								11562,
								11585
							],
							[
								11648,
								11659
							],
							[
								11668,
								11679
							],
							[
								11687,
								11702
							],
							[
								11710,
								11721
							],
							[
								11763,
								11772
							],
							[
								11867,
								11882
							],
							[
								11914,
								11934
							],
							[
								11986,
								11997
							],
							[
								12030,
								12046
							],
							[
								12079,
								12092
							],
							[
								12096,
								12119
							],
							[
								12713,
								12737
							],
							[
								12925,
								12949
							],
							[
								13078,
								13102
							],
							[
								13185,
								13209
							],
							[
								13299,
								13315
							],
							[
								13407,
								13424
							],
							[
								13439,
								13457
							],
							[
								13478,
								13495
							],
							[
								13518,
								13535
							],
							[
								13558,
								13576
							],
							[
								13580,
								13589
							],
							[
								13710,
								13726
							],
							[
								13745,
								13762
							]
						],
						"symlist":
						[
							"PROJECT_NAME",
							"DISABLE_WERROR",
							"CMAKE_BUILD_TYPE",
							"CMAKE_BUILD_RPATH",
							"CMAKE_CURRENT_BINARY_DIR",
							"CMAKE_INSTALL_RPATH",
							"CMAKE_INSTALL_PREFIX",
							"QUICKJS_SOURCES_ROOT",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_BUILD_TYPE",
							"LIBWS2_32",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_SOURCE_DIR",
							"PNG_LIBRARIES",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_SOURCE_DIR",
							"check_size",
							"TYPE",
							"VAR",
							"CMAKE_",
							"VAR",
							"VAR",
							"CMAKE_",
							"VAR",
							"CMAKE_",
							"VAR",
							"TYPE",
							"CMAKE_",
							"VAR",
							"POSITION_INDEPENDENT_CODE",
							"CMAKE_THREAD_LIBS_INIT",
							"LIBPTHREAD",
							"CMAKE_THREAD_LIBS_INIT",
							"LIBM",
							"LIBDL",
							"CMAKE_INSTALL_RPATH",
							"CMAKE_INSTALL_RPATH",
							"CMAKE_INSTALL_PREFIX",
							"CMAKE_INSTALL_PREFIX",
							"CMAKE_BUILD_RPATH",
							"CMAKE_CURRENT_BINARY_DIR",
							"CMAKE_CURRENT_BINARY_DIR",
							"CMAKE_BUILD_WITH_INSTALL_RPATH",
							"CMAKE_INSTALL_RPATH_USE_LINK_PATH",
							"OPENCV_INCLUDE_DIRS",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CXX_STANDARD",
							"CMAKE_REQUIRED_QUIET",
							"CXX_STANDARD",
							"CXX_STANDARD_NUM",
							"CMAKE_REQUIRED_QUIET",
							"CXX_STANDARD_NUM",
							"CXX_STANDARD_VALUE",
							"CXX_STANDARD_NAME",
							"CXX_STANDARD_NAME",
							"CXX_STANDARD_NAME",
							"CXX_STANDARD_VALUE",
							"CXX_STANDARD",
							"CXX_STANDARD_FLAG",
							"CXX_STANDARD",
							"CMAKE_CXX_FLAGS",
							"CMAKE_CXX_FLAGS",
							"CXX_STANDARD_FLAG",
							"CXX_STANDARD_NUM",
							"CXX_STANDARD_FLAG",
							"CXX_STANDARD_VALUE",
							"NOWARN_FLAG",
							"FLAG",
							"FLAG",
							"VARNAME",
							"VARNAME",
							"CMAKE_C_FLAGS",
							"CMAKE_C_FLAGS",
							"FLAG",
							"CMAKE_CXX_FLAGS",
							"CMAKE_CXX_FLAGS",
							"FLAG",
							"VARNAME",
							"CMAKE_C_FLAGS",
							"CMAKE_CXX_FLAGS",
							"CMAKE_CXX11_EXTENSION_COMPILE_OPTION",
							"CXX_STANDARD_FLAG",
							"CMAKE_CXX_COMPILER_ID",
							"CMAKE_CXX_COMPILER_ID",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_C_FLAGS",
							"CMAKE_C_FLAGS",
							"CMAKE_EXE_LINKER_FLAGS",
							"CMAKE_EXE_LINKER_FLAGS",
							"quickjs_BINARY_DIR",
							"CMAKE_CURRENT_BINARY_DIR",
							"QUICKJS_LIBRARY_DIR",
							"src_program",
							"SOURCES",
							"NAME",
							"SRC",
							"NAME",
							"_SOURCES",
							"SRCS",
							"SOURCES",
							"NAME",
							"SRCS",
							"NAME",
							"NAME",
							"NAME",
							"_SOURCES",
							"NAME",
							"ARGN",
							"NAME",
							"PLOTCV_DEFS",
							"NAME",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_SOURCE_DIR",
							"QUICKJS_SOURCES_LIST",
							"find_static_library",
							"VAR",
							"NAME",
							"CMAKE_INSTALL_PREFIX",
							"QUICKJS_LIBRARY",
							"CMAKE_CURRENT_BINARY_DIR",
							"CMAKE_REQUIRED_INCLUDES",
							"OPENCV_INCLUDE_DIRS",
							"OPENCV_FREETYPE_LIBRARY",
							"OPENCV_FREETYPE_LIBRARY",
							"CLI_SOURCES",
							"OpenCV_LIBS",
							"QUICKJS_LIBRARY",
							"PNG_LIBRARY",
							"LIBWS2_32",
							"QUICKJS_VERSION",
							"CMAKE_INSTALL_PREFIX",
							"PLOTCV_DEFS",
							"QUICKJS_OPENCV_A",
							"PNG_LIBRARIES",
							"OPENCV_FREETYPE_LIBRARY",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_BINARY_DIR",
							"CMAKE_CURRENT_BINARY_DIR",
							"CMAKE_CURRENT_BINARY_DIR",
							"CMAKE_BINARY_DIR",
							"CMAKE_INSTALL_DIR",
							"CMAKE_MAKE_PROGRAM",
							"CMAKE_INSTALL_DIR",
							"CMAKE_INSTALL_DIR",
							"CMAKE_PROJECT_NAME",
							"DATE_TIME",
							"CMAKE_BINARY_DIR",
							"CMAKE_INSTALL_DIR"
						]
					},
					"AQAAAAAAAAAAAAAABAsAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					507,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAAAECwAAUFJPSkVDVF9OQU1FCkRJU0FCTEVfV0VSUk9SCkNNQUtFX0JVSUxEX1RZUEUKQ01BS0VfQlVJTERfUlBBVEgKQ01BS0VfQ1VSUkVOVF9CSU5BUllfRElSCkNNQUtFX0lOU1RBTExfUlBBVEgKQ01BS0VfSU5TVEFMTF9QUkVGSVgKUVVJQ0tKU19TT1VSQ0VTX1JPT1QKQ01BS0VfQ1VSUkVOVF9TT1VSQ0VfRElSCkNNQUtFX0JVSUxEX1RZUEUKTElCV1MyXzMyCkNNQUtFX0NVUlJFTlRfU09VUkNFX0RJUgpDTUFLRV9DVVJSRU5UX1NPVVJDRV9ESVIKQ01BS0VfQ1VSUkVOVF9TT1VSQ0VfRElSClBOR19MSUJSQVJJRVMKQ01BS0VfQ1VSUkVOVF9TT1VSQ0VfRElSCkNNQUtFX0NVUlJFTlRfU09VUkNFX0RJUgogIGNoZWNrX3NpemUKVFlQRQpWQVIKQ01BS0VfClZBUgpWQVIKQ01BS0VfClZBUgpDTUFLRV8KVkFSClRZUEUKQ01BS0VfClZBUgpQT1NJVElPTl9JTkRFUEVOREVOVF9DT0RFCkNNQUtFX1RIUkVBRF9MSUJTX0lOSVQKTElCUFRIUkVBRApDTUFLRV9USFJFQURfTElCU19JTklUCkxJQk0KTElCREwKQ01BS0VfSU5TVEFMTF9SUEFUSApDTUFLRV9JTlNUQUxMX1JQQVRICkNNQUtFX0lOU1RBTExfUFJFRklYCkNNQUtFX0lOU1RBTExfUFJFRklYCkNNQUtFX0JVSUxEX1JQQVRICkNNQUtFX0NVUlJFTlRfQklOQVJZX0RJUgpDTUFLRV9DVVJSRU5UX0JJTkFSWV9ESVIKQ01BS0VfQlVJTERfV0lUSF9JTlNUQUxMX1JQQVRICkNNQUtFX0lOU1RBTExfUlBBVEhfVVNFX0xJTktfUEFUSApPUEVOQ1ZfSU5DTFVERV9ESVJTCkNNQUtFX0NVUlJFTlRfU09VUkNFX0RJUgpDTUFLRV9DVVJSRU5UX1NPVVJDRV9ESVIKQ01BS0VfQ1VSUkVOVF9TT1VSQ0VfRElSCkNNQUtFX0NVUlJFTlRfU09VUkNFX0RJUgpDTUFLRV9DVVJSRU5UX1NPVVJDRV9ESVIKQ1hYX1NUQU5EQVJECkNNQUtFX1JFUVVJUkVEX1FVSUVUCkNYWF9TVEFOREFSRApDWFhfU1RBTkRBUkRfTlVNCkNNQUtFX1JFUVVJUkVEX1FVSUVUCkNYWF9TVEFOREFSRF9OVU0KQ1hYX1NUQU5EQVJEX1ZBTFVFCkNYWF9TVEFOREFSRF9OQU1FCkNYWF9TVEFOREFSRF9OQU1FCkNYWF9TVEFOREFSRF9OQU1FCkNYWF9TVEFOREFSRF9WQUxVRQpDWFhfU1RBTkRBUkQKQ1hYX1NUQU5EQVJEX0ZMQUcKQ1hYX1NUQU5EQVJECkNNQUtFX0NYWF9GTEFHUwpDTUFLRV9DWFhfRkxBR1MKQ1hYX1NUQU5EQVJEX0ZMQUcKQ1hYX1NUQU5EQVJEX05VTQpDWFhfU1RBTkRBUkRfRkxBRwpDWFhfU1RBTkRBUkRfVkFMVUUKTk9XQVJOX0ZMQUcKRkxBRwpGTEFHClZBUk5BTUUKVkFSTkFNRQpDTUFLRV9DX0ZMQUdTCkNNQUtFX0NfRkxBR1MKRkxBRwpDTUFLRV9DWFhfRkxBR1MKQ01BS0VfQ1hYX0ZMQUdTCkZMQUcKVkFSTkFNRQpDTUFLRV9DX0ZMQUdTCkNNQUtFX0NYWF9GTEFHUwpDTUFLRV9DWFgxMV9FWFRFTlNJT05fQ09NUElMRV9PUFRJT04KQ1hYX1NUQU5EQVJEX0ZMQUcKQ01BS0VfQ1hYX0NPTVBJTEVSX0lECkNNQUtFX0NYWF9DT01QSUxFUl9JRApDTUFLRV9DX0ZMQUdTX0RFQlVHCkNNQUtFX0NfRkxBR1NfREVCVUcKQ01BS0VfQ1hYX0ZMQUdTX0RFQlVHCkNNQUtFX0NYWF9GTEFHU19ERUJVRwpDTUFLRV9DX0ZMQUdTX0RFQlVHCkNNQUtFX0NfRkxBR1NfREVCVUcKQ01BS0VfQ19GTEFHU19ERUJVRwpDTUFLRV9DX0ZMQUdTX0RFQlVHCkNNQUtFX0NYWF9GTEFHU19ERUJVRwpDTUFLRV9DWFhfRkxBR1NfREVCVUcKQ01BS0VfQ1hYX0ZMQUdTX0RFQlVHCkNNQUtFX0NYWF9GTEFHU19ERUJVRwpDTUFLRV9DX0ZMQUdTX0RFQlVHCkNNQUtFX0NfRkxBR1NfREVCVUcKQ01BS0VfQ19GTEFHU19ERUJVRwpDTUFLRV9DX0ZMQUdTX0RFQlVHCkNNQUtFX0NYWF9GTEFHU19ERUJVRwpDTUFLRV9DWFhfRkxBR1NfREVCVUcKQ01BS0VfQ1hYX0ZMQUdTX0RFQlVHCkNNQUtFX0NYWF9GTEFHU19ERUJVRwpDTUFLRV9DX0ZMQUdTCkNNQUtFX0NfRkxBR1MKQ01BS0VfRVhFX0xJTktFUl9GTEFHUwpDTUFLRV9FWEVfTElOS0VSX0ZMQUdTCiAgcXVpY2tqc19CSU5BUllfRElSCkNNQUtFX0NVUlJFTlRfQklOQVJZX0RJUgpRVUlDS0pTX0xJQlJBUllfRElSCiAgc3JjX3Byb2dyYW0KU09VUkNFUwpOQU1FClNSQwpOQU1FCiAgX1NPVVJDRVMKU1JDUwpTT1VSQ0VTCk5BTUUKU1JDUwpOQU1FCk5BTUUKTkFNRQogIF9TT1VSQ0VTCk5BTUUKQVJHTgpOQU1FClBMT1RDVl9ERUZTCk5BTUUKQ01BS0VfQ1VSUkVOVF9TT1VSQ0VfRElSCkNNQUtFX0NVUlJFTlRfU09VUkNFX0RJUgpRVUlDS0pTX1NPVVJDRVNfTElTVAogIGZpbmRfc3RhdGljX2xpYnJhcnkKVkFSCk5BTUUKQ01BS0VfSU5TVEFMTF9QUkVGSVgKUVVJQ0tKU19MSUJSQVJZCkNNQUtFX0NVUlJFTlRfQklOQVJZX0RJUgpDTUFLRV9SRVFVSVJFRF9JTkNMVURFUwpPUEVOQ1ZfSU5DTFVERV9ESVJTCk9QRU5DVl9GUkVFVFlQRV9MSUJSQVJZCk9QRU5DVl9GUkVFVFlQRV9MSUJSQVJZCkNMSV9TT1VSQ0VTCk9wZW5DVl9MSUJTClFVSUNLSlNfTElCUkFSWQpQTkdfTElCUkFSWQpMSUJXUzJfMzIKUVVJQ0tKU19WRVJTSU9OCkNNQUtFX0lOU1RBTExfUFJFRklYClBMT1RDVl9ERUZTClFVSUNLSlNfT1BFTkNWX0EKUE5HX0xJQlJBUklFUwpPUEVOQ1ZfRlJFRVRZUEVfTElCUkFSWQpDTUFLRV9DVVJSRU5UX1NPVVJDRV9ESVIKQ01BS0VfQ1VSUkVOVF9CSU5BUllfRElSCkNNQUtFX0NVUlJFTlRfQklOQVJZX0RJUgpDTUFLRV9DVVJSRU5UX0JJTkFSWV9ESVIKQ01BS0VfQklOQVJZX0RJUgpDTUFLRV9JTlNUQUxMX0RJUgpDTUFLRV9NQUtFX1BST0dSQU0KQ01BS0VfSU5TVEFMTF9ESVIKQ01BS0VfSU5TVEFMTF9ESVIKQ01BS0VfUFJPSkVDVF9OQU1FCkRBVEVfVElNRQpDTUFLRV9CSU5BUllfRElSCkNNQUtFX0lOU1RBTExfRElSAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					508,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					509,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					510,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					511,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					512,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					513,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					514,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					515,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					516,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					517,
					1,
					"outline_refresh",
					{
						"path": null,
						"symkeys":
						[
						],
						"symlist":
						[
						]
					},
					"AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					518,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/CMakeLists.txt",
						"symkeys":
						[
							[
								95,
								107
							],
							[
								120,
								134
							],
							[
								186,
								202
							],
							[
								446,
								463
							],
							[
								467,
								491
							],
							[
								545,
								564
							],
							[
								568,
								588
							],
							[
								649,
								669
							],
							[
								672,
								696
							],
							[
								771,
								787
							],
							[
								874,
								883
							],
							[
								1154,
								1178
							],
							[
								1213,
								1237
							],
							[
								1327,
								1351
							],
							[
								1550,
								1563
							],
							[
								1619,
								1643
							],
							[
								1823,
								1847
							],
							[
								1915,
								1925
							],
							[
								1957,
								1961
							],
							[
								1972,
								1975
							],
							[
								1985,
								1991
							],
							[
								1993,
								1996
							],
							[
								2030,
								2033
							],
							[
								2037,
								2043
							],
							[
								2045,
								2048
							],
							[
								2062,
								2068
							],
							[
								2070,
								2073
							],
							[
								2105,
								2109
							],
							[
								2113,
								2119
							],
							[
								2121,
								2124
							],
							[
								2308,
								2333
							],
							[
								2458,
								2480
							],
							[
								2517,
								2527
							],
							[
								2530,
								2552
							],
							[
								2655,
								2659
							],
							[
								2797,
								2802
							],
							[
								2875,
								2894
							],
							[
								2902,
								2921
							],
							[
								2925,
								2945
							],
							[
								2953,
								2973
							],
							[
								2994,
								3011
							],
							[
								3015,
								3039
							],
							[
								3043,
								3067
							],
							[
								3180,
								3210
							],
							[
								3294,
								3327
							],
							[
								3437,
								3456
							],
							[
								3460,
								3484
							],
							[
								3490,
								3514
							],
							[
								3525,
								3549
							],
							[
								3559,
								3583
							],
							[
								3595,
								3619
							],
							[
								3754,
								3766
							],
							[
								3777,
								3797
							],
							[
								3839,
								3851
							],
							[
								3875,
								3891
							],
							[
								3901,
								3921
							],
							[
								3950,
								3966
							],
							[
								4026,
								4044
							],
							[
								4071,
								4088
							],
							[
								4169,
								4186
							],
							[
								4262,
								4279
							],
							[
								4402,
								4420
							],
							[
								4424,
								4436
							],
							[
								4483,
								4500
							],
							[
								4509,
								4521
							],
							[
								4579,
								4594
							],
							[
								4598,
								4613
							],
							[
								4617,
								4634
							],
							[
								4675,
								4691
							],
							[
								4785,
								4802
							],
							[
								4861,
								4879
							],
							[
								4890,
								4901
							],
							[
								4934,
								4938
							],
							[
								4969,
								4973
							],
							[
								4979,
								4986
							],
							[
								5018,
								5025
							],
							[
								5036,
								5049
							],
							[
								5053,
								5066
							],
							[
								5070,
								5074
							],
							[
								5086,
								5101
							],
							[
								5105,
								5120
							],
							[
								5124,
								5128
							],
							[
								5143,
								5150
							],
							[
								5231,
								5244
							],
							[
								5300,
								5315
							],
							[
								5390,
								5426
							],
							[
								5430,
								5447
							],
							[
								5550,
								5571
							],
							[
								5799,
								5820
							],
							[
								6481,
								6500
							],
							[
								6504,
								6523
							],
							[
								6539,
								6560
							],
							[
								6564,
								6585
							],
							[
								7006,
								7025
							],
							[
								7051,
								7070
							],
							[
								7074,
								7093
							],
							[
								7164,
								7183
							],
							[
								7256,
								7277
							],
							[
								7303,
								7324
							],
							[
								7328,
								7349
							],
							[
								7422,
								7443
							],
							[
								7604,
								7623
							],
							[
								7651,
								7670
							],
							[
								7674,
								7693
							],
							[
								7766,
								7785
							],
							[
								7854,
								7875
							],
							[
								7903,
								7924
							],
							[
								7928,
								7949
							],
							[
								8024,
								8045
							],
							[
								8454,
								8467
							],
							[
								8471,
								8484
							],
							[
								8500,
								8522
							],
							[
								8526,
								8548
							],
							[
								8603,
								8621
							],
							[
								8807,
								8831
							],
							[
								8845,
								8864
							],
							[
								8878,
								8889
							],
							[
								8920,
								8927
							],
							[
								8947,
								8951
							],
							[
								8964,
								8967
							],
							[
								8995,
								8999
							],
							[
								9000,
								9008
							],
							[
								9070,
								9074
							],
							[
								9135,
								9142
							],
							[
								9155,
								9159
							],
							[
								9172,
								9176
							],
							[
								9242,
								9246
							],
							[
								9254,
								9258
							],
							[
								9268,
								9272
							],
							[
								9273,
								9281
							],
							[
								9310,
								9314
							],
							[
								9318,
								9322
							],
							[
								9356,
								9360
							],
							[
								9372,
								9383
							],
							[
								9406,
								9410
							],
							[
								9581,
								9605
							],
							[
								9687,
								9711
							],
							[
								9764,
								9784
							],
							[
								10023,
								10042
							],
							[
								10070,
								10073
							],
							[
								10086,
								10090
							],
							[
								10103,
								10123
							],
							[
								10178,
								10193
							],
							[
								10222,
								10246
							],
							[
								11284,
								11307
							],
							[
								11311,
								11330
							],
							[
								11484,
								11507
							],
							[
								11562,
								11585
							],
							[
								11648,
								11659
							],
							[
								11668,
								11679
							],
							[
								11687,
								11702
							],
							[
								11710,
								11721
							],
							[
								11763,
								11772
							],
							[
								11867,
								11882
							],
							[
								11914,
								11934
							],
							[
								11986,
								11997
							],
							[
								12030,
								12046
							],
							[
								12079,
								12092
							],
							[
								12096,
								12119
							],
							[
								12713,
								12737
							],
							[
								12925,
								12949
							],
							[
								13078,
								13102
							],
							[
								13185,
								13209
							],
							[
								13299,
								13315
							],
							[
								13407,
								13424
							],
							[
								13439,
								13457
							],
							[
								13478,
								13495
							],
							[
								13518,
								13535
							],
							[
								13558,
								13576
							],
							[
								13580,
								13589
							],
							[
								13710,
								13726
							],
							[
								13745,
								13762
							]
						],
						"symlist":
						[
							"PROJECT_NAME",
							"DISABLE_WERROR",
							"CMAKE_BUILD_TYPE",
							"CMAKE_BUILD_RPATH",
							"CMAKE_CURRENT_BINARY_DIR",
							"CMAKE_INSTALL_RPATH",
							"CMAKE_INSTALL_PREFIX",
							"QUICKJS_SOURCES_ROOT",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_BUILD_TYPE",
							"LIBWS2_32",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_SOURCE_DIR",
							"PNG_LIBRARIES",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_SOURCE_DIR",
							"check_size",
							"TYPE",
							"VAR",
							"CMAKE_",
							"VAR",
							"VAR",
							"CMAKE_",
							"VAR",
							"CMAKE_",
							"VAR",
							"TYPE",
							"CMAKE_",
							"VAR",
							"POSITION_INDEPENDENT_CODE",
							"CMAKE_THREAD_LIBS_INIT",
							"LIBPTHREAD",
							"CMAKE_THREAD_LIBS_INIT",
							"LIBM",
							"LIBDL",
							"CMAKE_INSTALL_RPATH",
							"CMAKE_INSTALL_RPATH",
							"CMAKE_INSTALL_PREFIX",
							"CMAKE_INSTALL_PREFIX",
							"CMAKE_BUILD_RPATH",
							"CMAKE_CURRENT_BINARY_DIR",
							"CMAKE_CURRENT_BINARY_DIR",
							"CMAKE_BUILD_WITH_INSTALL_RPATH",
							"CMAKE_INSTALL_RPATH_USE_LINK_PATH",
							"OPENCV_INCLUDE_DIRS",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CXX_STANDARD",
							"CMAKE_REQUIRED_QUIET",
							"CXX_STANDARD",
							"CXX_STANDARD_NUM",
							"CMAKE_REQUIRED_QUIET",
							"CXX_STANDARD_NUM",
							"CXX_STANDARD_VALUE",
							"CXX_STANDARD_NAME",
							"CXX_STANDARD_NAME",
							"CXX_STANDARD_NAME",
							"CXX_STANDARD_VALUE",
							"CXX_STANDARD",
							"CXX_STANDARD_FLAG",
							"CXX_STANDARD",
							"CMAKE_CXX_FLAGS",
							"CMAKE_CXX_FLAGS",
							"CXX_STANDARD_FLAG",
							"CXX_STANDARD_NUM",
							"CXX_STANDARD_FLAG",
							"CXX_STANDARD_VALUE",
							"NOWARN_FLAG",
							"FLAG",
							"FLAG",
							"VARNAME",
							"VARNAME",
							"CMAKE_C_FLAGS",
							"CMAKE_C_FLAGS",
							"FLAG",
							"CMAKE_CXX_FLAGS",
							"CMAKE_CXX_FLAGS",
							"FLAG",
							"VARNAME",
							"CMAKE_C_FLAGS",
							"CMAKE_CXX_FLAGS",
							"CMAKE_CXX11_EXTENSION_COMPILE_OPTION",
							"CXX_STANDARD_FLAG",
							"CMAKE_CXX_COMPILER_ID",
							"CMAKE_CXX_COMPILER_ID",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_C_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_CXX_FLAGS_DEBUG",
							"CMAKE_C_FLAGS",
							"CMAKE_C_FLAGS",
							"CMAKE_EXE_LINKER_FLAGS",
							"CMAKE_EXE_LINKER_FLAGS",
							"quickjs_BINARY_DIR",
							"CMAKE_CURRENT_BINARY_DIR",
							"QUICKJS_LIBRARY_DIR",
							"src_program",
							"SOURCES",
							"NAME",
							"SRC",
							"NAME",
							"_SOURCES",
							"SRCS",
							"SOURCES",
							"NAME",
							"SRCS",
							"NAME",
							"NAME",
							"NAME",
							"_SOURCES",
							"NAME",
							"ARGN",
							"NAME",
							"PLOTCV_DEFS",
							"NAME",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_SOURCE_DIR",
							"QUICKJS_SOURCES_LIST",
							"find_static_library",
							"VAR",
							"NAME",
							"CMAKE_INSTALL_PREFIX",
							"QUICKJS_LIBRARY",
							"CMAKE_CURRENT_BINARY_DIR",
							"CMAKE_REQUIRED_INCLUDES",
							"OPENCV_INCLUDE_DIRS",
							"OPENCV_FREETYPE_LIBRARY",
							"OPENCV_FREETYPE_LIBRARY",
							"CLI_SOURCES",
							"OpenCV_LIBS",
							"QUICKJS_LIBRARY",
							"PNG_LIBRARY",
							"LIBWS2_32",
							"QUICKJS_VERSION",
							"CMAKE_INSTALL_PREFIX",
							"PLOTCV_DEFS",
							"QUICKJS_OPENCV_A",
							"PNG_LIBRARIES",
							"OPENCV_FREETYPE_LIBRARY",
							"CMAKE_CURRENT_SOURCE_DIR",
							"CMAKE_CURRENT_BINARY_DIR",
							"CMAKE_CURRENT_BINARY_DIR",
							"CMAKE_CURRENT_BINARY_DIR",
							"CMAKE_BINARY_DIR",
							"CMAKE_INSTALL_DIR",
							"CMAKE_MAKE_PROGRAM",
							"CMAKE_INSTALL_DIR",
							"CMAKE_INSTALL_DIR",
							"CMAKE_PROJECT_NAME",
							"DATE_TIME",
							"CMAKE_BINARY_DIR",
							"CMAKE_INSTALL_DIR"
						]
					},
					"AQAAAAAAAAAAAAAABAsAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					519,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/lib/grammars/c11-parser.y",
						"symkeys":
						[
							[
								11998,
								12005
							]
						],
						"symlist":
						[
							"—Ⓕ– yyerror ( ) { … } — function"
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAAAECwAAUFJPSkVDVF9OQU1FCkRJU0FCTEVfV0VSUk9SCkNNQUtFX0JVSUxEX1RZUEUKQ01BS0VfQlVJTERfUlBBVEgKQ01BS0VfQ1VSUkVOVF9CSU5BUllfRElSCkNNQUtFX0lOU1RBTExfUlBBVEgKQ01BS0VfSU5TVEFMTF9QUkVGSVgKUVVJQ0tKU19TT1VSQ0VTX1JPT1QKQ01BS0VfQ1VSUkVOVF9TT1VSQ0VfRElSCkNNQUtFX0JVSUxEX1RZUEUKTElCV1MyXzMyCkNNQUtFX0NVUlJFTlRfU09VUkNFX0RJUgpDTUFLRV9DVVJSRU5UX1NPVVJDRV9ESVIKQ01BS0VfQ1VSUkVOVF9TT1VSQ0VfRElSClBOR19MSUJSQVJJRVMKQ01BS0VfQ1VSUkVOVF9TT1VSQ0VfRElSCkNNQUtFX0NVUlJFTlRfU09VUkNFX0RJUgogIGNoZWNrX3NpemUKVFlQRQpWQVIKQ01BS0VfClZBUgpWQVIKQ01BS0VfClZBUgpDTUFLRV8KVkFSClRZUEUKQ01BS0VfClZBUgpQT1NJVElPTl9JTkRFUEVOREVOVF9DT0RFCkNNQUtFX1RIUkVBRF9MSUJTX0lOSVQKTElCUFRIUkVBRApDTUFLRV9USFJFQURfTElCU19JTklUCkxJQk0KTElCREwKQ01BS0VfSU5TVEFMTF9SUEFUSApDTUFLRV9JTlNUQUxMX1JQQVRICkNNQUtFX0lOU1RBTExfUFJFRklYCkNNQUtFX0lOU1RBTExfUFJFRklYCkNNQUtFX0JVSUxEX1JQQVRICkNNQUtFX0NVUlJFTlRfQklOQVJZX0RJUgpDTUFLRV9DVVJSRU5UX0JJTkFSWV9ESVIKQ01BS0VfQlVJTERfV0lUSF9JTlNUQUxMX1JQQVRICkNNQUtFX0lOU1RBTExfUlBBVEhfVVNFX0xJTktfUEFUSApPUEVOQ1ZfSU5DTFVERV9ESVJTCkNNQUtFX0NVUlJFTlRfU09VUkNFX0RJUgpDTUFLRV9DVVJSRU5UX1NPVVJDRV9ESVIKQ01BS0VfQ1VSUkVOVF9TT1VSQ0VfRElSCkNNQUtFX0NVUlJFTlRfU09VUkNFX0RJUgpDTUFLRV9DVVJSRU5UX1NPVVJDRV9ESVIKQ1hYX1NUQU5EQVJECkNNQUtFX1JFUVVJUkVEX1FVSUVUCkNYWF9TVEFOREFSRApDWFhfU1RBTkRBUkRfTlVNCkNNQUtFX1JFUVVJUkVEX1FVSUVUCkNYWF9TVEFOREFSRF9OVU0KQ1hYX1NUQU5EQVJEX1ZBTFVFCkNYWF9TVEFOREFSRF9OQU1FCkNYWF9TVEFOREFSRF9OQU1FCkNYWF9TVEFOREFSRF9OQU1FCkNYWF9TVEFOREFSRF9WQUxVRQpDWFhfU1RBTkRBUkQKQ1hYX1NUQU5EQVJEX0ZMQUcKQ1hYX1NUQU5EQVJECkNNQUtFX0NYWF9GTEFHUwpDTUFLRV9DWFhfRkxBR1MKQ1hYX1NUQU5EQVJEX0ZMQUcKQ1hYX1NUQU5EQVJEX05VTQpDWFhfU1RBTkRBUkRfRkxBRwpDWFhfU1RBTkRBUkRfVkFMVUUKTk9XQVJOX0ZMQUcKRkxBRwpGTEFHClZBUk5BTUUKVkFSTkFNRQpDTUFLRV9DX0ZMQUdTCkNNQUtFX0NfRkxBR1MKRkxBRwpDTUFLRV9DWFhfRkxBR1MKQ01BS0VfQ1hYX0ZMQUdTCkZMQUcKVkFSTkFNRQpDTUFLRV9DX0ZMQUdTCkNNQUtFX0NYWF9GTEFHUwpDTUFLRV9DWFgxMV9FWFRFTlNJT05fQ09NUElMRV9PUFRJT04KQ1hYX1NUQU5EQVJEX0ZMQUcKQ01BS0VfQ1hYX0NPTVBJTEVSX0lECkNNQUtFX0NYWF9DT01QSUxFUl9JRApDTUFLRV9DX0ZMQUdTX0RFQlVHCkNNQUtFX0NfRkxBR1NfREVCVUcKQ01BS0VfQ1hYX0ZMQUdTX0RFQlVHCkNNQUtFX0NYWF9GTEFHU19ERUJVRwpDTUFLRV9DX0ZMQUdTX0RFQlVHCkNNQUtFX0NfRkxBR1NfREVCVUcKQ01BS0VfQ19GTEFHU19ERUJVRwpDTUFLRV9DX0ZMQUdTX0RFQlVHCkNNQUtFX0NYWF9GTEFHU19ERUJVRwpDTUFLRV9DWFhfRkxBR1NfREVCVUcKQ01BS0VfQ1hYX0ZMQUdTX0RFQlVHCkNNQUtFX0NYWF9GTEFHU19ERUJVRwpDTUFLRV9DX0ZMQUdTX0RFQlVHCkNNQUtFX0NfRkxBR1NfREVCVUcKQ01BS0VfQ19GTEFHU19ERUJVRwpDTUFLRV9DX0ZMQUdTX0RFQlVHCkNNQUtFX0NYWF9GTEFHU19ERUJVRwpDTUFLRV9DWFhfRkxBR1NfREVCVUcKQ01BS0VfQ1hYX0ZMQUdTX0RFQlVHCkNNQUtFX0NYWF9GTEFHU19ERUJVRwpDTUFLRV9DX0ZMQUdTCkNNQUtFX0NfRkxBR1MKQ01BS0VfRVhFX0xJTktFUl9GTEFHUwpDTUFLRV9FWEVfTElOS0VSX0ZMQUdTCiAgcXVpY2tqc19CSU5BUllfRElSCkNNQUtFX0NVUlJFTlRfQklOQVJZX0RJUgpRVUlDS0pTX0xJQlJBUllfRElSCiAgc3JjX3Byb2dyYW0KU09VUkNFUwpOQU1FClNSQwpOQU1FCiAgX1NPVVJDRVMKU1JDUwpTT1VSQ0VTCk5BTUUKU1JDUwpOQU1FCk5BTUUKTkFNRQogIF9TT1VSQ0VTCk5BTUUKQVJHTgpOQU1FClBMT1RDVl9ERUZTCk5BTUUKQ01BS0VfQ1VSUkVOVF9TT1VSQ0VfRElSCkNNQUtFX0NVUlJFTlRfU09VUkNFX0RJUgpRVUlDS0pTX1NPVVJDRVNfTElTVAogIGZpbmRfc3RhdGljX2xpYnJhcnkKVkFSCk5BTUUKQ01BS0VfSU5TVEFMTF9QUkVGSVgKUVVJQ0tKU19MSUJSQVJZCkNNQUtFX0NVUlJFTlRfQklOQVJZX0RJUgpDTUFLRV9SRVFVSVJFRF9JTkNMVURFUwpPUEVOQ1ZfSU5DTFVERV9ESVJTCk9QRU5DVl9GUkVFVFlQRV9MSUJSQVJZCk9QRU5DVl9GUkVFVFlQRV9MSUJSQVJZCkNMSV9TT1VSQ0VTCk9wZW5DVl9MSUJTClFVSUNLSlNfTElCUkFSWQpQTkdfTElCUkFSWQpMSUJXUzJfMzIKUVVJQ0tKU19WRVJTSU9OCkNNQUtFX0lOU1RBTExfUFJFRklYClBMT1RDVl9ERUZTClFVSUNLSlNfT1BFTkNWX0EKUE5HX0xJQlJBUklFUwpPUEVOQ1ZfRlJFRVRZUEVfTElCUkFSWQpDTUFLRV9DVVJSRU5UX1NPVVJDRV9ESVIKQ01BS0VfQ1VSUkVOVF9CSU5BUllfRElSCkNNQUtFX0NVUlJFTlRfQklOQVJZX0RJUgpDTUFLRV9DVVJSRU5UX0JJTkFSWV9ESVIKQ01BS0VfQklOQVJZX0RJUgpDTUFLRV9JTlNUQUxMX0RJUgpDTUFLRV9NQUtFX1BST0dSQU0KQ01BS0VfSU5TVEFMTF9ESVIKQ01BS0VfSU5TVEFMTF9ESVIKQ01BS0VfUFJPSkVDVF9OQU1FCkRBVEVfVElNRQpDTUFLRV9CSU5BUllfRElSCkNNQUtFX0lOU1RBTExfRElSAAAAAAAAAAAgAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					520,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/lib/grammars/c11-scanner.l",
						"symkeys":
						[
							[
								74,
								76
							],
							[
								3789,
								3794
							],
							[
								3982,
								3992
							]
						],
						"symlist":
						[
							"—Ⓕ– IS ( ) { … } — function",
							"—Ⓕ– count ( ) { … } — function",
							"—Ⓕ– check_type ( ) { … } — function"
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAAAqAAAA4oCU4pK74oCTIHl5ZXJyb3IgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uAAAAAAAAAABeAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					521,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/lib/grammars/c11-parser.y",
						"symkeys":
						[
							[
								11998,
								12005
							]
						],
						"symlist":
						[
							"—Ⓕ– yyerror ( ) { … } — function"
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAAB8AAAA4oCU4pK74oCTIElTICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgrigJTikrvigJMgY291bnQgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uCuKAlOKSu+KAkyBjaGVja190eXBlICggKSB7IOKApiB9IOKAlCBmdW5jdGlvbgAAAAAAAAAAIAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				],
				[
					522,
					1,
					"outline_refresh",
					{
						"path": "/home/roman/Projects/plot-cv/lib/grammars/c11-scanner.l",
						"symkeys":
						[
							[
								74,
								76
							],
							[
								3789,
								3794
							],
							[
								3982,
								3992
							]
						],
						"symlist":
						[
							"—Ⓕ– IS ( ) { … } — function",
							"—Ⓕ– count ( ) { … } — function",
							"—Ⓕ– check_type ( ) { … } — function"
						]
					},
					"AgAAAAAAAAAAAAAAAAAAAAAAAAAqAAAA4oCU4pK74oCTIHl5ZXJyb3IgKCApIHsg4oCmIH0g4oCUIGZ1bmN0aW9uAAAAAAAAAABeAAAAAAAAAAAAAAA",
					"AQAAAAAAAAAAAAAA"
				]
			]
		},
		{
			"file": "upload-server.js",
			"settings":
			{
				"buffer_size": 34102,
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					12,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAACqhQAAaW1wb3J0ICogYXMgc3RkIGZyb20gJ3N0ZCc7CmltcG9ydCAqIGFzIG9zIGZyb20gJ29zJzsKaW1wb3J0ICogYXMgZGVlcCBmcm9tICcuL2xpYi9kZWVwLmpzJzsKaW1wb3J0ICogYXMgeG1sIGZyb20gJ3htbCc7CmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7CmltcG9ydCB7IENvbnNvbGUgfSBmcm9tICdjb25zb2xlJzsKaW1wb3J0IHsgRGlyZWN0b3J5LCBCT1RILCBUWVBFX0RJUiwgVFlQRV9MTkssIFRZUEVfUkVHLCBUWVBFX01BU0sgfSBmcm9tICdkaXJlY3RvcnknOwppbXBvcnQgUkVQTCBmcm9tICcuL3F1aWNranMvcWpzLW1vZHVsZXMvbGliL3JlcGwuanMnOwppbXBvcnQgaW5zcGVjdCBmcm9tICcuL2xpYi9vYmplY3RJbnNwZWN0LmpzJzsKaW1wb3J0ICogYXMgVGVybWluYWwgZnJvbSAnLi90ZXJtaW5hbC5qcyc7CmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJzsKaW1wb3J0IHsgbGluaywgdW5saW5rLCBlcnJvciwgZm5tYXRjaCwgRk5NX0VYVE1BVENIIH0gZnJvbSAnbWlzYyc7CmltcG9ydCB7IHRvU3RyaW5nLCBkZWZpbmUsIHRvVW5peFRpbWUsIGdldE9wdCwgcmFuZFN0ciwgaXNPYmplY3QsIGlzTnVtZXJpYywgaXNBcnJheUJ1ZmZlciwgZ2xvYiwgR0xPQl9CUkFDRSwgd2FpdEZvciB9IGZyb20gJ3V0aWwnOwppbXBvcnQgeyBzZXRMb2csIExMTF9VU0VSLCBMTExfTk9USUNFLCBMTExfV0FSTiwgTExMX0lORk8sIGNsaWVudCwgc2VydmVyLCBGb3JtUGFyc2VyLCBIYXNoLCBSZXNwb25zZSwgU29ja2V0IH0gZnJvbSAnbmV0JzsKaW1wb3J0IHsgcGFyc2VEYXRlLCBkYXRlVG9PYmplY3QgfSBmcm9tICcuL2RhdGUtaGVscGVycy5qcyc7CmltcG9ydCB7IElmRGVidWcsIExvZ0lmRGVidWcsIFJlYWRGaWxlLCBMb2FkSGlzdG9yeSwgUmVhZEpTT04sIFJlYWRYTUwsIE1hcEZpbGUsIFdyaXRlRmlsZSwgV3JpdGVKU09OLCBXcml0ZVhNTCwgUmVhZEJKU09OLCBXcml0ZUJKU09OLCBEaXJJdGVyYXRvciwgUmVjdXJzaXZlRGlySXRlcmF0b3IsIFJlYWREaXJSZWN1cnNpdmUsIEZpbHRlciwgRmlsdGVySW1hZ2VzLCBTb3J0RmlsZXMsIFN0YXRGaWxlcywgUmVhZEZkLCBGZFJlYWRlciwgQ29weVRvQ2xpcGJvYXJkLCBSZWFkQ2FsbGJhY2ssIExvZ0NhbGwsIFNwYXduLCBGZXRjaFVSTCB9IGZyb20gJy4vaW8taGVscGVycy5qcyc7CmltcG9ydCB7IHBhcnNlRGVnTWluU2VjLCBwYXJzZUdQU0xvY2F0aW9uIH0gZnJvbSAnLi9zdHJpbmctaGVscGVycy5qcyc7CmltcG9ydCB7IGgsIGh0bWwsIHJlbmRlciwgQ29tcG9uZW50LCB1c2VTdGF0ZSwgdXNlTGF5b3V0RWZmZWN0LCB1c2VSZWYgfSBmcm9tICcuL2xpYi9wcmVhY3QubWpzJzsKaW1wb3J0IHJlbmRlclRvU3RyaW5nIGZyb20gJy4vbGliL3ByZWFjdC1yZW5kZXItdG8tc3RyaW5nLmpzJzsKaW1wb3J0IHsgZXhlYywgc3Bhd24gfSBmcm9tICdjaGlsZF9wcm9jZXNzJzsKaW1wb3J0IHsgRXhlY3V0ZSB9IGZyb20gJy4vb3MtaGVscGVycy5qcyc7CmltcG9ydCB0cmtsIGZyb20gJy4vbGliL3Rya2wuanMnOwppbXBvcnQgeyB0YWtlIH0gZnJvbSAnLi9saWIvaXRlcmF0b3IvaGVscGVycy5qcyc7CmltcG9ydCB7IGV4dGVuZEFycmF5LCBleHRlbmRHZW5lcmF0b3IsIGV4dGVuZEFzeW5jR2VuZXJhdG9yIH0gZnJvbSAndXRpbCc7CgpleHRlbmRBcnJheSgpOwpleHRlbmRHZW5lcmF0b3IoKTsKZXh0ZW5kR2VuZXJhdG9yKE9iamVjdC5nZXRQcm90b3R5cGVPZihuZXcgTWFwKCkua2V5cygpKSk7CmV4dGVuZEdlbmVyYXRvcihPYmplY3QuZ2V0UHJvdG90eXBlT2YobmV3IERpcmVjdG9yeSgnLicpKSk7CmV4dGVuZEFzeW5jR2VuZXJhdG9yKCk7CgpnbG9iYWxUaGlzLmZzID0gZnM7Cmdsb2JhbFRoaXMubG9nRmlsdGVyID0gLyh3c19zZXRfdGltZW91dDogb24gaW1tb3J0YWwgc3RyZWFtfFVuaGFuZGxlZHxQUk9YWS18VkhPU1RfQ0VSVF9BR0lOR3xCSU5EfEVWRU5UX1dBSVR8V1JJVEFCTEUpLzsKCnRya2wucHJvcGVydHkoZ2xvYmFsVGhpcywgJ2xvZ0xldmVsJykuc3Vic2NyaWJlKHZhbHVlID0+CiAgc2V0TG9nKHZhbHVlLCAobGV2ZWwsIG1lc3NhZ2UpID0+IHsKICAgIGlmKC9fX2x3c3xzZXJ2ZV8ocmVzb2x2ZWR8Z2VuZXJhdG9yfHByb21pc2V8cmVzcG9uc2UpfFhYYmwoXChbMTIzXVwpLip3cml0YWJsZXx4XChbL11cKS4qV1JJVEVBQkxFKXxsd3NfLy50ZXN0KG1lc3NhZ2UpKSByZXR1cm47CiAgICBpZihsZXZlbCA9PSBMTExfSU5GTyAmJiAhL3Byb3h5Ly50ZXN0KG1lc3NhZ2UpKSByZXR1cm47CiAgICBpZihsb2dGaWx0ZXIudGVzdChtZXNzYWdlKSkgcmV0dXJuOwoKICAgIC8vaWYocGFyYW1zLmRlYnVnIHx8IGxldmVsIDw9IExMTF9XQVJOKQogICAgb3V0KAogICAgICAoWydFUlInLCAnV0FSTicsICdOT1RJQ0UnLCAnSU5GTycsICdERUJVRycsICdQQVJTRVInLCAnSEVBREVSJywgJ0VYVCcsICdDTElFTlQnLCAnTEFURU5DWScsICdNSU5ORVQnLCAnVEhSRUFEJ11bTWF0aC5sb2cyKGxldmVsKV0gPz8gbGV2ZWwgKyAnJykucGFkRW5kKDgpICsKICAgICAgICBtZXNzYWdlLnJlcGxhY2UoL1xuL2csICdcXG4nKS5yZXBsYWNlKC9cci9nLCAnXFxyJykKICAgICk7CiAgfSkKKTsKCmFzeW5jIGZ1bmN0aW9uIEFzeW5jQ29sbGVjdChpdGVyKSB7CiAgbGV0IHJldCA9IFtdOwogIGZvciBhd2FpdChsZXQgY2h1bmsgb2YgYXdhaXQgaXRlcikgcmV0LnB1c2goY2h1bmspOwogIHJldHVybiByZXQ7Cn0KCmZ1bmN0aW9uIEV4ZWNUb29sKGNtZCwgLi4uYXJncykgewogIGxldCBjaGlsZCA9IHNwYXduKGNtZCwgYXJncywgeyBzdGRpbzogWzAsICdwaXBlJywgMl0gfSk7CiAgbGV0IFtzdGRpbiwgc3Rkb3V0LCBzdGRlcnJdID0gY2hpbGQuc3RkaW87CiAgbGV0IHI7CiAgbGV0IGIgPSBuZXcgQXJyYXlCdWZmZXIoMTAyNCk7CiAgciA9IGNoaWxkLndhaXQoKTsKICAvLyBjb25zb2xlLmxvZygnRXhlY1Rvb2wnLCB7IGFyZ3MsIGNoaWxkIH0pOwoKICByID0gb3MucmVhZChzdGRvdXQsIGIsIDAsIDEwMjQpOwogIGxldCBkYXRhID0gYi5zbGljZSgwLCByKTsKICBsZXQgc3RyID0gdG9TdHJpbmcoZGF0YSk7CgogIHJldHVybiBzdHI7Cn0KCmZ1bmN0aW9uIEdldE1pbWUoZmlsZSkgewogIGxldCBvdXRwdXQgPSBFeGVjVG9vbCgnZmlsZScsICctaScsIGZpbGUpOwogIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC9bXHJcbl0qJC9nLCAnJyk7CiAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UobmV3IFJlZ0V4cChmaWxlICsgJzpcXHMrJyksICcnKTsKICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZSgvXDtccyouKi9nLCAnJyk7CiAgcmV0dXJuIG91dHB1dDsKfQoKZnVuY3Rpb24gTWF0Y2hlcihwYXR0ZXJuLCB0ID0gYXJnID0+IGFyZykgewogIHJldHVybiAoLi4uYXJncykgPT4gcGF0dGVybiA9PSB0KC4uLmFyZ3MpIHx8IDAgPT0gZm5tYXRjaChwYXR0ZXJuLCB0KC4uLmFyZ3MpLCBGTk1fRVhUTUFUQ0gpOwp9CgpmdW5jdGlvbiBLZXlPclZhbHVlTWF0Y2hlcihwYXR0ZXJuKSB7CiAgbGV0IG1hdGNoZXIgPSBNYXRjaGVyKHBhdHRlcm4pOwogIHJldHVybiAoW2tleSwgdmFsdWVdKSA9PiBtYXRjaGVyKGtleSkgfHwgbWF0Y2hlcih2YWx1ZSk7Cn0KCmZ1bmN0aW9uIEdldFJvb3REaXJlY3RvcmllcyhwYXR0ZXJuID0gJyonKSB7CiAgcmV0dXJuIGFsbG93ZWREaXJzLmtleXMoKS5maWx0ZXIoTWF0Y2hlcihwYXR0ZXJuKSk7Cn0KCmNvbnN0IE1ha2VVVUlEID0gKHJuZyA9IE1hdGgucmFuZG9tKSA9PiBbOCwgNCwgNCwgNCwgMTJdLm1hcChuID0+IHJhbmRTdHIobiwgJzAxMjM0NTY3ODlhYmNkZWYnKSwgcm5nKS5qb2luKCctJyk7Cgpjb25zdCBkZWZhdWx0RGlycyA9IChnbG9iYWxUaGlzLmRlZmF1bHREaXJzID0gWwogICcuJywKICAuLi5nbG9iKCcuLi8qL2VhZ2xlJyksCiAgJy4vdXBsb2Fkcy8qLntzY2gsYnJkLGxicn0nLAogICcvbW50L2V4dGV4dC9QaG90b3MvKkFQUExFLyoue0pQRyxQTkcsR0lGLEFBRSxNT1YsSEVJQyxNUDQsV0VCUH0nLAogIFsnL2hvbWUvcm9tYW4vQmlsZGVyJywgbmV3IFJlZ0V4cCgnLihqcGd8anBlZ3xwbmd8aGVpY3x0aWZ8dGlmZikkJywgJ2knKV0KXSk7Cgpjb25zdCBhbGxvd2VkRGlycyA9IChnbG9iYWxUaGlzLmFsbG93ZWREaXJzID0gbmV3IE1hcCgKICBkZWZhdWx0RGlycwogICAgLm1hcChkZCA9PiBHZXREaXIoQXJyYXkuaXNBcnJheShkZCkgPyBkZFswXSA6IGRkKSkKICAgIC5tYXAoZCA9PiBwYXRoLnJlc29sdmUoZCkpCiAgICAubWFwKGQgPT4gcGF0aC5yZWxhdGl2ZShkKSkKICAgIC5tYXAoZCA9PiBbRGlyTmFtZShkKSwgZF0pCikpOwoKZnVuY3Rpb24gR2V0RGlyKGRpcikgewogIGxldCBhID0gcGF0aC50b0FycmF5KGRpcik7CiAgbGV0IGkgPSBhLmZpbmRJbmRleChuID0+IC9bKnt9XS8udGVzdChuKSk7CiAgcmV0dXJuIGkgIT0gLTEgPyBwYXRoLnNsaWNlKGRpciwgMCwgaSkgOiBkaXI7Cn0KCmZ1bmN0aW9uIERpck5hbWUobmFtZSkgewogIGxldCBwID0gcGF0aC5yZWxhdGl2ZShuYW1lKTsKCiAgcCA9IHBhdGguc2xpY2UoCiAgICBwLAogICAgcGF0aC50b0FycmF5KHApLmZpbmRJbmRleChpdCA9PiBpdCAhPSAnLi4nKQogICk7CiAgcmV0dXJuIHA7Cn0KZnVuY3Rpb24gRGF0ZVN0cihkYXRlKSB7CiAgbGV0IHN0ciA9IGRhdGUudG9JU09TdHJpbmcoKTsKICBsZXQgdGkgPSBzdHIuaW5kZXhPZignVCcpOwogIHJldHVybiAoCiAgICBzdHIuc3Vic3RyaW5nKDAsIHRpKSAvKi5yZXBsYWNlKC8tL2csICcnKSovICsgJyAnICsgc3RyLnN1YnN0cmluZyh0aSArIDEsIHRpICsgMSArIDgpIC8vLnJlcGxhY2UoLzovZywgJycpCiAgKTsKfQoKZnVuY3Rpb24gTW9kZVN0cihtb2RlKSB7CiAgcmV0dXJuICgKICAgIChtb2RlICYgKDBvMTIwMDAwID09IDBvMTIwMDAwKSA/ICdsJyA6IG1vZGUgJiAwbzQwMDAwID8gJ2QnIDogJy0nKSArCiAgICAobW9kZSAmIDBiMTAwMDAwMDAwID8gJ3InIDogJy0nKSArCiAgICAobW9kZSAmIDBiMDEwMDAwMDAwID8gJ3cnIDogJy0nKSArCiAgICAobW9kZSAmIDBiMDAxMDAwMDAwID8gJ3gnIDogJy0nKSArCiAgICAobW9kZSAmIDBiMTAwMDAwID8gJ3InIDogJy0nKSArCiAgICAobW9kZSAmIDBiMDEwMDAwID8gJ3cnIDogJy0nKSArCiAgICAobW9kZSAmIDBiMDAxMDAwID8gJ3gnIDogJy0nKSArCiAgICAobW9kZSAmIDBiMTAwID8gJ3InIDogJy0nKSArCiAgICAobW9kZSAmIDBiMDEwID8gJ3cnIDogJy0nKSArCiAgICAobW9kZSAmIDBiMDAxID8gJ3gnIDogJy0nKQogICk7Cn0KCmNvbnN0IEhUTUxQYWdlID0gKHsgdGl0bGUsIHN0eWxlLCBzY3JpcHRzID0gW10sIGNoaWxkcmVuLCAuLi5wcm9wcyB9KSA9PiB7CiAgcmV0dXJuIGgoJ2h0bWwnLCB7fSwgWwogICAgaCgKICAgICAgJ2hlYWQnLAogICAgICB7fSwKICAgICAgWwogICAgICAgIGgoJ3RpdGxlJywge30sIFt0aXRsZV0pLAogICAgICAgIC4uLihzdHlsZSA/IFtoKCdzdHlsZScsIHsgdHlwZTogJ3RleHQvY3NzJyB9LCBbc3R5bGVdKV0gOiBbXSksCiAgICAgICAgaCgKICAgICAgICAgICdsaW5rJywKICAgICAgICAgIHsKICAgICAgICAgICAgcmVsOiAnc3R5bGVzaGVldCcsCiAgICAgICAgICAgIGhyZWY6ICdzdGF0aWMvY3NzL2xpc3QuY3NzJwogICAgICAgICAgfSwKICAgICAgICAgIFtdCiAgICAgICAgKQogICAgICBdLmNvbmNhdChzY3JpcHRzLm1hcChzY3JpcHQgPT4gaCgnc2NyaXB0JywgeyB0eXBlOiAnbW9kdWxlJywgc3JjOiBzY3JpcHQgfSkpKQogICAgKSwKICAgIGgoJ2JvZHknLCB7fSwgY2hpbGRyZW4gPz8gW10pCiAgXSk7Cn07Cgpjb25zdCBGaWx0ZXJGb3JtID0gKHsgLi4ucHJvcHMgfSkgPT4KICBoKCdmb3JtJywgeyBhY3Rpb246ICdmaWxlJywgbWV0aG9kOiAnUE9TVCcgfSwgWwogICAgaCgKICAgICAgJ2lucHV0JywKICAgICAgewogICAgICAgIHR5cGU6ICd0ZXh0JywKICAgICAgICBzaXplOiAyMCwKICAgICAgICBuYW1lOiAnZmlsdGVyJywKICAgICAgICB2YWx1ZTogJy4qJyAvKiwKICAgICAgICAgIG9uY2hhbmdlOiBlID0+IHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ29uY2hhbmdlJywgZSk7CiAgICAgICAgICB9Ki8KICAgICAgfSwKICAgICAgW10KICAgICksCiAgICBoKCdpbnB1dCcsIHsgdHlwZTogJ3N1Ym1pdCcsIHZhbHVlOiAnU3VibWl0JywgY2xhc3M6ICdoaWRkZW4nIH0sIFtdKQogIF0pOwoKY29uc3QgSFRNTFRhYmxlID0gKHsgcm93cywgLi4ucHJvcHMgfSkgPT4gaCgndGFibGUnLCBwcm9wcywgcm93cyk7CmNvbnN0IEhUTUxUYWJsZVJvdyA9ICh7IGNvbHVtbnMsIC4uLnByb3BzIH0pID0+IGgoJ3RyJywgcHJvcHMsIGNvbHVtbnMpOwpjb25zdCBIVE1MVGFibGVDb2x1bW4gPSAoeyBjb2x1bW5zLCBjaGlsZHJlbiwgdGFnID0gJ3RkJywgLi4ucHJvcHMgfSkgPT4gaCh0YWcsIHByb3BzLCBjaGlsZHJlbik7Cgpjb25zdCBGaWxlTGluayA9ICh7IGZpbGUsIC4uLnByb3BzIH0pID0+IHsKICByZXR1cm4gaCgnYScsIHsgaHJlZjogJ2ZpbGUvdXBsb2Fkcy8nICsgZmlsZSB9LCBbZmlsZV0pOwp9Owpjb25zdCBGaWxlT2JqZWN0ID0gKHsgZmlsZSwgc3RhdCA9IHt9LCAuLi5wcm9wcyB9KSA9PiB7CiAgc3RhdCA/Pz0gZnMubHN0YXRTeW5jKCd1cGxvYWRzLycgKyBmaWxlKTsKICAvLyBjb25zb2xlLmxvZygnRmlsZU9iamVjdCcsIHsgZmlsZSwgc3RhdCB9KTsKICBsZXQgaXNEaXIgPSBzdGF0LmlzRGlyZWN0b3J5KCk7CgogIHJldHVybiBoKEhUTUxUYWJsZVJvdywge30sIFsKICAgIGgoSFRNTFRhYmxlQ29sdW1uLCB7IGNsYXNzOiAnbW9kZScgfSwgWwogICAgICAvLyhzdGF0Lm1vZGUgJiAwYjExMTExMTExMSkudG9TdHJpbmcoOCksCiAgICAgIE1vZGVTdHIoc3RhdC5tb2RlKQogICAgXSksCiAgICBoKEhUTUxUYWJsZUNvbHVtbiwgeyBjbGFzczogJ2ZpbGUnIH0sIFtoKEZpbGVMaW5rLCB7IGZpbGU6IGZpbGUgKyAoaXNEaXIgPyAnLycgOiAnJykgfSwgW10pXSksCiAgICBoKEhUTUxUYWJsZUNvbHVtbiwgeyBjbGFzczogJ3NpemUnIH0sIFtzdGF0LnNpemUgKyAnJ10pLAogICAgaChIVE1MVGFibGVDb2x1bW4sIHsgY2xhc3M6ICdkYXRlJyB9LCBbRGF0ZVN0cihuZXcgRGF0ZShzdGF0LmF0aW1lKSldKQogIF0pOwp9OwoKY29uc3QgRmlsZVRhYmxlID0gKHsgZmlsZXMsIC4uLnByb3BzIH0pID0+IHsKICAvL2NvbnNvbGUubG9nKCdGaWxlVGFibGUnLCBmaWxlcyk7CgogIGxldCBmaWVsZHMgPSBbJ21vZGUnLCAnZmlsZScsICdzaXplJywgJ2F0aW1lJ107CgogIGZpbGVzID0gZmlsZXMuc29ydCgoYSwgYikgPT4gYS5maWxlLmxvY2FsZUNvbXBhcmUoYi5maWxlKSk7CgogIHJldHVybiBoKAogICAgSFRNTFRhYmxlLAogICAgewogICAgICAuLi5wcm9wcywKICAgICAgY2VsbHNwYWNpbmc6IDAsCiAgICAgIGNlbGxwYWRkaW5nOiAwLAogICAgICBib3JkZXI6IDAsCiAgICAgIHJvd3M6IFsKICAgICAgICBoKAogICAgICAgICAgSFRNTFRhYmxlUm93LAogICAgICAgICAgewogICAgICAgICAgICBjb2x1bW5zOiBmaWVsZHMubWFwKGZpZWxkID0+IGgoSFRNTFRhYmxlQ29sdW1uLCB7IHRhZzogJ3RoJyB9LCBbZmllbGRdKSkKICAgICAgICAgIH0sCiAgICAgICAgICBbXQogICAgICAgICkKICAgICAgXS5jb25jYXQoZmlsZXMubWFwKGZpbGUgPT4gaChGaWxlT2JqZWN0LCBmaWxlLCBbXSkpKQogICAgfSwKICAgIFtdCiAgKTsKfTsKCmZ1bmN0aW9uIFJlYWRFeGl2MihmaWxlKSB7CiAgY29uc29sZS5sb2coJ1JlYWRFeGl2MicsIGZpbGUpOwogIGxldCBbcmRmLCBzdGRvdXRdID0gb3MucGlwZSgpOwogIG9zLmV4ZWMoWydleGl2MicsICctZScsICdYLScsICdleCcsIGZpbGVdLCB7IHN0ZG91dCB9KTsKICBvcy5jbG9zZShzdGRvdXQpOwogIGxldCB4bXBkYXQgPSBmcy5yZWFkQWxsU3luYyhyZGYpOwogIGZzLmNsb3NlU3luYyhyZGYpOwogIC8vIGNvbnNvbGUubG9nKCd4bXBkYXQnLCB4bXBkYXQpOwogIGxldCB4bXAgPSB4bWwucmVhZCh4bXBkYXQpOwogIC8vIGNvbnNvbGUubG9nKCd4bXAnLCB4bXApOwogIGxldCBmbGF0ID0gT2JqZWN0LmZyb21FbnRyaWVzKAogICAgZGVlcAogICAgICAuZmxhdHRlbih4bXAsIFtdKQogICAgICAuZmlsdGVyKChbaywgdl0pID0+IHYgIT09ICcnICYmIC9hdHRyaWJ1dGVzLio6Ly50ZXN0KGspICYmICEvXC54bWxucy8udGVzdChrKSAmJiAhaXNPYmplY3QodikpCiAgICAgIC5maWx0ZXIoKFtrLCB2XSkgPT4gLyhHUFN8W1hZXURpbXxbWFldUmVzfERhdGUkfE1ha2UkfE1vZGVsJCkvLnRlc3QoaykpCiAgICAgIC5tYXAoKFtrLCB2XSkgPT4gW2sucmVwbGFjZSgvLipcLmF0dHJpYnV0ZXNcLi9nLCAnJyksIHZdKQogICAgICAuc29ydCgoYSwgYikgPT4gYVswXS5sb2NhbGVDb21wYXJlKGJbMF0pKQogICAgICAubWFwKChbaywgdl0pID0+IFtrLCBpc05hTigrdikgPyAoaXNOYU4oRGF0ZS5wYXJzZSh2KSkgPyB2IDogbmV3IERhdGUodikpIDogK3ZdKQogICk7CiAgcmV0dXJuIGZsYXQ7Cn0KCmZ1bmN0aW9uIFJlYWRFeGlmdG9vbChmaWxlKSB7CiAgY29uc29sZS5sb2coJ1JlYWRFeGlmdG9vbCcsIGZpbGUpOwoKICBsZXQgW3JldCwgb3V0XSA9IEV4ZWN1dGUoJ2V4aWZ0b29sJywgJy1TJywgJy1lZScsIGZpbGUpOwoKICBsZXQgYSA9IG91dC5zcGxpdCgvXHI/XG4vZykuZmlsdGVyKGwgPT4gbCAhPSAnJyk7CgogIGEgPSBhLm1hcChsaW5lID0+IFtsaW5lLCBsaW5lLmluZGV4T2YoJzogJyldKS5tYXAoKFtsaW5lLCBpZHhdKSA9PiBbbGluZS5zbGljZSgwLCBpZHgpLCBsaW5lLnNsaWNlKGlkeCArIDIpXSk7CiAgbGV0IG8gPSBPYmplY3QuZnJvbUVudHJpZXMoYSk7CgogIC8vY29uc29sZS5sb2coJ1JlYWRFeGlmdG9vbCcsbyk7CiAgcmV0dXJuIG87Cn0KCmZ1bmN0aW9uIEhlaWZDb252ZXJ0KHNyYywgZHN0LCBxdWFsaXR5ID0gMTAwKSB7CiAgY29uc29sZS5sb2coJ0hlaWZDb252ZXJ0Jywgc3JjLCBkc3QpOwogIGxldCBhcmdzID0gWydoZWlmLWNvbnZlcnQnLCAnLXEnLCBxdWFsaXR5ICsgJycsIHNyYywgZHN0XTsKICBsZXQgW3JldCwgb3V0XSA9IEV4ZWN1dGUoLi4uYXJncyk7CgogIGNvbnNvbGUubG9nKCdIZWlmQ29udmVydCcsIHsgYXJncywgcmV0LCBvdXQgfSk7CiAgcmV0dXJuIFtyZXQsIG91dF07Cn0KCmZ1bmN0aW9uIE1hZ2lja1Jlc2l6ZShzcmMsIGRzdCwgcm90YXRlID0gMCwgd2lkdGgsIGhlaWdodCkgewogIGNvbnNvbGUubG9nKCdNYWdpY2tSZXNpemUnLCB7CiAgICB3aWR0aCwKICAgIGhlaWdodCwKICAgIGRzdCwKICAgIHJvdGF0ZQogIH0pOwogIGxldCBhcmdzID0gWydjb252ZXJ0Jywgc3JjLCAnLXJlc2l6ZScsIHdpZHRoICsgJ3gnICsgaGVpZ2h0LCAuLi4ocm90YXRlID8gWyctcm90YXRlJywgJy0nICsgcm90YXRlXSA6IFtdKSwgZHN0XTsKICBsZXQgW3JldCwgb3V0XSA9IEV4ZWN1dGUoLi4uYXJncyk7CgogIGNvbnNvbGUubG9nKCdNYWdpY2tSZXNpemUnLCB7IGFyZ3MsIHJldCwgb3V0IH0pOwogIHJldHVybiBbcmV0LCBvdXRdOwp9CgpmdW5jdGlvbiBtYWluKC4uLmFyZ3MpIHsKICBjb25zdCBiYXNlID0gcGF0aC5iYXNlbmFtZShzY3JpcHRBcmdzWzBdLCAnLmpzJykucmVwbGFjZSgvXC5bYS16XSokLywgJycpOwogIGNvbnN0IGNvbmZpZyA9IFJlYWRKU09OKGAuJHtiYXNlfS1jb25maWdgKSA/PyB7fTsKCiAgZ2xvYmFsVGhpcy5jb25zb2xlID0gbmV3IENvbnNvbGUoewogICAgaW5zcGVjdE9wdGlvbnM6IHsKICAgICAgY29tcGFjdDogMiwKICAgICAgZGVwdGg6IEluZmluaXR5LAogICAgICBjdXN0b21JbnNwZWN0OiB0cnVlLAogICAgICBtYXhBcnJheUxlbmd0aDogMjAwCiAgICB9CiAgfSk7CiAgbGV0IHBhcmFtcyA9IGdldE9wdCgKICAgIHsKICAgICAgdmVyYm9zZTogW2ZhbHNlLCAoYSwgdikgPT4gKHYgfCAwKSArIDEsICd2J10sCiAgICAgIGxpc3RlbjogW2ZhbHNlLCBudWxsLCAnbCddLAogICAgICBjb25uZWN0OiBbZmFsc2UsIG51bGwsICdjJ10sCiAgICAgIGNsaWVudDogW2ZhbHNlLCBudWxsLCAnQyddLAogICAgICBzZXJ2ZXI6IFtmYWxzZSwgbnVsbCwgJ1MnXSwKICAgICAgZGVidWc6IFtmYWxzZSwgbnVsbCwgJ3gnXSwKICAgICAgdGxzOiBbZmFsc2UsIG51bGwsICd0J10sCiAgICAgICduby10bHMnOiBbZmFsc2UsICh2LCBwdiwgbykgPT4gKChvLnRscyA9IGZhbHNlKSwgdHJ1ZSksICdUJ10sCiAgICAgIGFkZHJlc3M6IFt0cnVlLCBudWxsLCAnYSddLAogICAgICBwb3J0OiBbdHJ1ZSwgbnVsbCwgJ3AnXSwKICAgICAgJ3NzbC1jZXJ0JzogW3RydWUsIG51bGxdLAogICAgICAnc3NsLXByaXZhdGUta2V5JzogW3RydWUsIG51bGxdLAogICAgICAnQCc6ICdhZGRyZXNzLHBvcnQnCiAgICB9LAogICAgYXJncwogICk7CiAgaWYocGFyYW1zWyduby10bHMnXSA9PT0gdHJ1ZSkgcGFyYW1zLnRscyA9IGZhbHNlOwoKICBjb25zdCB7IGFkZHJlc3MgPSAnMC4wLjAuMCcsIHBvcnQgPSA4OTk5LCAnc3NsLWNlcnQnOiBzc2xDZXJ0ID0gJ2xvY2FsaG9zdC5jcnQnLCAnc3NsLXByaXZhdGUta2V5Jzogc3NsUHJpdmF0ZUtleSA9ICdsb2NhbGhvc3Qua2V5JyB9ID0gcGFyYW1zOwogIGNvbnN0IGxpc3RlbiA9IHBhcmFtcy5jb25uZWN0ICYmICFwYXJhbXMubGlzdGVuID8gZmFsc2UgOiB0cnVlOwogIGNvbnN0IGlzX3NlcnZlciA9ICFwYXJhbXMuY2xpZW50IHx8IHBhcmFtcy5zZXJ2ZXI7CgogIGxldCBuYW1lID0gcHJvY2Vzcy5lbnZbJ05BTUUnXSA/PyBiYXNlOwoKICBuYW1lID0gbmFtZQogICAgLnJlcGxhY2UoLy4qXC8vLCAnJykKICAgIC5yZXBsYWNlKC8tL2csICcgJykKICAgIC5yZXBsYWNlKC9cLlteXC8uXSokLywgJycpOwoKICBsZXQgW3ByZWZpeCwgc3VmZml4XSA9IG5hbWUuc3BsaXQoJyAnKTsKCiAgbGV0IHJlcGwgPSBuZXcgUkVQTChgXHgxYlszODs1OzE2NW0ke3ByZWZpeH0gXHgxYlszODs1OzM5bSR7c3VmZml4fVx4MWJbMG1gLCBmYWxzZSk7CiAgY29uc3QgaGlzdGZpbGUgPSAnLnVwbG9hZC1zZXJ2ZXItaGlzdG9yeSc7CiAgcmVwbC5oaXN0b3J5TG9hZChoaXN0ZmlsZSwgZmFsc2UpOwogIHJlcGwubG9hZFNhdmVPcHRpb25zKCk7CiAgcmVwbC5kaXJlY3RpdmVzLmkgPSBbCiAgICAobW9kdWxlLCAuLi5hcmdzKSA9PiB7CiAgICAgIGNvbnNvbGUubG9nKCdhcmdzJywgYXJncyk7CiAgICAgIHRyeSB7CiAgICAgICAgcmV0dXJuIHJlcXVpcmUobW9kdWxlKTsKICAgICAgfSBjYXRjaChlKSB7fQogICAgICBpbXBvcnQobW9kdWxlKS50aGVuKG0gPT4gKGdsb2JhbFRoaXNbbW9kdWxlXSA9IG0pKTsKICAgIH0sCiAgICAnaW1wb3J0IG1vZHVsZScKICBdOwoKICBsZXQgeyBsb2cgfSA9IGNvbnNvbGU7CiAgcmVwbC5zaG93ID0gYXJnID0+IHN0ZC5wdXRzKCh0eXBlb2YgYXJnID09ICdzdHJpbmcnID8gYXJnIDogaW5zcGVjdChhcmcsIGdsb2JhbFRoaXMuY29uc29sZS5vcHRpb25zKSkgKyAnXG4nKTsKCiAgcmVwbC5jbGVhbnVwID0gKCkgPT4gewogICAgcmVwbC5yZWFkbGluZVJlbW92ZVByb21wdCgpOwogICAgVGVybWluYWwubW91c2V0cmFja2luZ0Rpc2FibGUoKTsKICAgIGxldCBudW1MaW5lcyA9IHJlcGwuaGlzdG9yeVNhdmUoaGlzdGZpbGUpOwoKICAgIHJlcGwucHJpbnRTdGF0dXMoYEVYSVQgKHdyb3RlICR7bnVtTGluZXN9IGhpc3RvcnkgZW50cmllcylgLCBmYWxzZSk7CgogICAgc3RkLmV4aXQoMCk7CiAgfTsKCiAgcmVwbC5pbnNwZWN0T3B0aW9ucyA9IHsKICAgIC4uLihyZXBsLmluc3BlY3RPcHRpb25zID8/IGNvbnNvbGUub3B0aW9ucyksCiAgICBkZXB0aDogSW5maW5pdHksCiAgICBjb21wYWN0OiBmYWxzZQogIH07CgogIGNvbnNvbGUubG9nID0gKC4uLmFyZ3MpID0+IHJlcGwucHJpbnRTdGF0dXMoKCkgPT4gbG9nKGNvbnNvbGUuY29uZmlnKHJlcGwuaW5zcGVjdE9wdGlvbnMpLCAuLi5hcmdzKSk7CgogIGxldCBsb2dGaWxlID0KICAgIHsKICAgICAgcHV0cyhzKSB7CiAgICAgICAgcmVwbC5wcmludFN0YXR1cygoKSA9PiBzdGQucHV0cyhzKSk7CiAgICAgIH0KICAgIH0gPz8gc3RkLm9wZW4oJ3VwbG9hZC1zZXJ2ZXIubG9nJywgJ3crJyk7CgogIGxldCBjb25uZWN0aW9ucyA9IG5ldyBTZXQoKTsKICBsZXQgYnlfdXVpZCA9IHt9OwoKICBmdW5jdGlvbiBQYXJzZUJvZHkoZ2VuKSB7CiAgICBsZXQgcHJvbSwKICAgICAgbyA9ICcnLAogICAgICB4OwoKICAgIHdoaWxlKCh4ID0gZ2VuLm5leHQoKSkpIHsKICAgICAgbGV0IHsgdmFsdWUsIGRvbmUgfSA9IHg7CiAgICAgIG8gKz0gdmFsdWU7CiAgICB9CiAgICByZXR1cm4gbzsKICB9CgogIGNvbnN0IGNyZWF0ZVdTID0gKGdsb2JhbFRoaXMuY3JlYXRlV1MgPSAodXJsLCBjYWxsYmFja3MsIGxpc3RlbikgPT4gewogICAgLy9jb25zb2xlLmxvZygnY3JlYXRlV1MnLCB7IHVybCwgY2FsbGJhY2tzLCBsaXN0ZW4gfSk7CgogICAgZ2xvYmFsVGhpcy5vdXQgPSBzID0+IGxvZ0ZpbGUucHV0cyhzICsgJ1xuJyk7CgogICAgbG9nTGV2ZWwgPSAocGFyYW1zLmRlYnVnID8gTExMX1VTRVIgOiAwKSB8ICgoKHBhcmFtcy5kZWJ1ZyA/IExMTF9JTkZPIDogTExMX1dBUk4pIDw8IDEpIC0gMSk7CiAgICBjb25zb2xlLmxvZygnY3JlYXRlV1MnLCB7IGxvZ0xldmVsIH0pOwoKICAgIHJldHVybiBbY2xpZW50LCBzZXJ2ZXJdWytsaXN0ZW5dKHsKICAgICAgYmxvY2s6IGZhbHNlLAogICAgICB0bHM6IHBhcmFtcy50bHMsCiAgICAgIHNzbENlcnQsCiAgICAgIHNzbFByaXZhdGVLZXksCiAgICAgIG1pbWV0eXBlczogWwogICAgICAgIFsnLnN2Z3onLCAnYXBwbGljYXRpb24vZ3ppcCddLAogICAgICAgIFsnLm1qcycsICdhcHBsaWNhdGlvbi9qYXZhc2NyaXB0J10sCiAgICAgICAgWycuanMnLCAnYXBwbGljYXRpb24vamF2YXNjcmlwdCddLAogICAgICAgIFsnLndhc20nLCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJ10sCiAgICAgICAgWycuZW90JywgJ2FwcGxpY2F0aW9uL3ZuZC5tcy1mb250b2JqZWN0J10sCiAgICAgICAgWycubGliJywgJ2FwcGxpY2F0aW9uL3gtYXJjaGl2ZSddLAogICAgICAgIFsnLmJ6MicsICdhcHBsaWNhdGlvbi94LWJ6aXAyJ10sCiAgICAgICAgWycuZ2l0aWdub3JlJywgJ3RleHQvcGxhaW4nXSwKICAgICAgICBbJy5jbWFrZScsICd0ZXh0L3BsYWluJ10sCiAgICAgICAgWycuaGV4JywgJ3RleHQvcGxhaW4nXSwKICAgICAgICBbJy5tZCcsICd0ZXh0L3BsYWluJ10sCiAgICAgICAgWycucGJ4cHJvaicsICd0ZXh0L3BsYWluJ10sCiAgICAgICAgWycud2F0JywgJ3RleHQvcGxhaW4nXSwKICAgICAgICBbJy5jJywgJ3RleHQveC1jJ10sCiAgICAgICAgWycuaCcsICd0ZXh0L3gtYyddLAogICAgICAgIFsnLmNwcCcsICd0ZXh0L3gtYysrJ10sCiAgICAgICAgWycuaHBwJywgJ3RleHQveC1jKysnXSwKICAgICAgICBbJy5maWx0ZXJzJywgJ3RleHQveG1sJ10sCiAgICAgICAgWycucGxpc3QnLCAndGV4dC94bWwnXSwKICAgICAgICBbJy5zdG9yeWJvYXJkJywgJ3RleHQveG1sJ10sCiAgICAgICAgWycudmN4cHJvaicsICd0ZXh0L3htbCddLAogICAgICAgIFsnLmJhdCcsICd0ZXh0L3gtbXNkb3MtYmF0Y2gnXSwKICAgICAgICBbJy5tbScsICd0ZXh0L3gtb2JqZWN0aXZlLWMnXSwKICAgICAgICBbJy5tJywgJ3RleHQveC1vYmplY3RpdmUtYyddLAogICAgICAgIFsnLnNoJywgJ3RleHQveC1zaGVsbHNjcmlwdCddCiAgICAgIF0sCiAgICAgIG1vdW50czogWwogICAgICAgIFsnLycsICcuJywgJ3VwbG9hZC5odG1sJ10sCiAgICAgICAgWycvZ2V0JywgJy4vdXBsb2FkcycsICcnXSwKICAgICAgICBbJy93YXJtY2F0JywgJ2h0dHBzOi8vd2FybWNhdC5jb20vJywgJ2luZGV4Lmh0bWwnXSwKICAgICAgICBbJy9kaXN0cmVsZWMnLCAnaHR0cHM6Ly93d3cuZGlzdHJlbGVjLmNoLycsICdsb2dpbiddLAogICAgICAgIFsnL2hhc3VyYScsICdodHRwOi8vd2lsZC1iZWF1dHkuaGVyb2t1YXBwLmNvbS92MS8nLCAnZ3JhcGhxbCddLAogICAgICAgIC8vIFsnL3VwbG9hZCcsICdsd3MtZGVhZGRyb3AnLCBudWxsLCAnbHdzLWRlYWRkcm9wJ10sCiAgICAgICAgYXN5bmMgZnVuY3Rpb24qIHRlc3QocmVxLCByZXNwKSB7CiAgICAgICAgICByZXNwLnR5cGUgPSAndGV4dC9wbGFpbic7CgogICAgICAgICAgY29uc29sZS5sb2coJyp0ZXN0JywgeyByZXEsIHJlc3AgfSk7CgogICAgICAgICAgbGV0IGJvZHlTdHIgPSAnJzsKICAgICAgICAgIGlmKHJlcS5tZXRob2QgPT0gJ1BPU1QnKSB7CiAgICAgICAgICAgIGZvciBhd2FpdChsZXQgY2h1bmsgb2YgYXdhaXQgcmVxLmJvZHkpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2h1bmsnLCBjaHVuayk7CiAgICAgICAgICAgICAgYm9keVN0ciArPSB0b1N0cmluZyhjaHVuayk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGNvbnNvbGUubG9nKCdib2R5U3RyJywgYm9keVN0cik7CgogICAgICAgICAgZm9yKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHsKICAgICAgICAgICAgeWllbGQgYGxpbmUgIyR7aX1cbmA7CiAgICAgICAgICAgIGF3YWl0IHdhaXRGb3IoKDEwIC0gaSArIDEpICogMTApOwogICAgICAgICAgfQoKICAgICAgICAgIHlpZWxkICdkb25lISc7CiAgICAgICAgfSwKICAgICAgICBmdW5jdGlvbiBwcm94eShyZXEsIHJlc3ApIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdwcm94eScsIHsgcmVxLCByZXNwIH0pOwogICAgICAgICAgY29uc3QgeyB1cmwsIG1ldGhvZCwgaGVhZGVycyB9ID0gcmVxOwogICAgICAgICAgY29uc29sZS5sb2coJ3Byb3h5JywgeyB1cmwsIG1ldGhvZCwgaGVhZGVycyB9KTsKICAgICAgICAgIGNvbnN0IHsgc3RhdHVzLCBvaywgdHlwZSB9ID0gcmVzcDsKCiAgICAgICAgICBjb25zb2xlLmxvZygncHJveHknLCB7IHN0YXR1cywgb2ssIHVybCwgdHlwZSB9KTsKICAgICAgICB9LAogICAgICAgIGZ1bmN0aW9uKiBjb25maWcocmVxLCByZXNwKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnKmNvbmZpZycsIHsgcmVxLCByZXNwIH0pOwogICAgICAgICAgeWllbGQgJ3t9JzsKICAgICAgICB9LAogICAgICAgIGZ1bmN0aW9uKiBmaWxlKHJlcSwgcmVzcCkgewogICAgICAgICAgbGV0IHsgYm9keSwgaGVhZGVycywganNvbiwgdXJsIH0gPSByZXE7CiAgICAgICAgICBsZXQgeyBxdWVyeSB9ID0gdXJsOwoKICAgICAgICAgIGlmKHR5cGVvZiBib2R5ID09ICdzdHJpbmcnKQogICAgICAgICAgICBxdWVyeSA9IHsKICAgICAgICAgICAgICAuLi5xdWVyeSwKICAgICAgICAgICAgICAuLi4oSlNPTi5wYXJzZShib2R5KSA/PyB7fSkKICAgICAgICAgICAgfTsKCiAgICAgICAgICBsZXQgeyBhY3Rpb24gPSAnbGlzdCcsIGNoYXJzZXQgPSAndXRmLTgnLCBiaW5hcnkgPSBmYWxzZSwgZmlsZSwgY29udGVudHMgfSA9IHF1ZXJ5ID8/IHt9OwoKICAgICAgICAgIGlmKC9eXC9maWxlXC8uLy50ZXN0KHVybC5wYXRoKSkgewogICAgICAgICAgICBmaWxlID0gdXJsLnBhdGgucmVwbGFjZSgvXlwvZmlsZVwvLywgJycpOwogICAgICAgICAgICBhY3Rpb24gPSAnbG9hZCc7CiAgICAgICAgICB9CiAgICAgICAgICBjb25zb2xlLmxvZygnKmZpbGUnLCB7IHF1ZXJ5LCBib2R5LCBmaWxlIH0pOwoKICAgICAgICAgIGNvbnNvbGUubG9nKGAqZmlsZWAsIHsgYWN0aW9uLCBmaWxlIH0pOwoKICAgICAgICAgIGlmKGZpbGUpIHsKICAgICAgICAgICAgZmlsZSA9IHBhdGguYWJzb2x1dGUoZmlsZSk7CiAgICAgICAgICAgIGZpbGUgPSBwYXRoLmNvbGxhcHNlKGZpbGUpOwogICAgICAgICAgICBjb25zb2xlLmxvZygKICAgICAgICAgICAgICBgYWxsb3dlZERpcnM6YCwKICAgICAgICAgICAgICBhbGxvd2VkRGlycyAvLy5tYXAoZGlyID0+IHBhdGgubm9ybWFsaXplKGRpcikpCiAgICAgICAgICAgICk7CgogICAgICAgICAgICAvL2NvbnNvbGUubG9nKGBhbGxvd2VkOmAsIGFsbG93ZWREaXJzLyoubWFwKGRpciA9PiBwYXRoLmlzaW4oZmlsZSwgZGlyKSkqLyk7CiAgICAgICAgICAgIGxldCBhbGxvd2VkID0gWy4uLmFsbG93ZWREaXJzXS5zb21lKChbZGlyXSkgPT4gcGF0aC5pc2luKGZpbGUsIHBhdGgubm9ybWFsaXplKGRpcikpKTsKCiAgICAgICAgICAgIGlmKCFhbGxvd2VkKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coYE5vdCBhbGxvd2VkOiAnJHtmaWxlfSdgKTsKICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vdCBhbGxvd2VkOiAnJHtmaWxlfSdgKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHN3aXRjaCAoYWN0aW9uKSB7CiAgICAgICAgICAgIGNhc2UgJ2xvYWQnOgogICAgICAgICAgICAgIGxldCBtaW1lID0gR2V0TWltZShmaWxlKTsKICAgICAgICAgICAgICByZXNwLnR5cGUgPSBtaW1lOwogICAgICAgICAgICAgIHJlc3AuaGVhZGVycyA9IHsgJ2NvbnRlbnQtdHlwZSc6IG1pbWUgfTsKICAgICAgICAgICAgICBsZXQgZGF0YSA9IGZzLnJlYWRGaWxlU3luYyhmaWxlLCAxIHwgYmluYXJ5ID8gbnVsbCA6IGNoYXJzZXQpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGAqZmlsZS5sb2FkYCwgeyBkYXRhLCBtaW1lIH0pOwogICAgICAgICAgICAgIHlpZWxkIGRhdGE7CiAgICAgICAgICAgICAgcmVzcC5ib2R5ID0gZGF0YTsKICAgICAgICAgICAgICAvL3lpZWxkCiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ3NhdmUnOgogICAgICAgICAgICAgIGZzLndyaXRlRmlsZVN5bmMoZmlsZSwgY29udGVudHMpOwogICAgICAgICAgICAgIHlpZWxkICdkb25lIVxyXG4nOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICdsaXN0JzoKICAgICAgICAgICAgICBsZXQgZmlsZXMgPSBmcy5yZWFkZGlyU3luYygndXBsb2FkcycpLmZpbHRlcihmID0+ICEvXlwuJC8udGVzdChmKSk7CiAgICAgICAgICAgICAgbGV0IGNvbXBvbmVudCA9IGgoCiAgICAgICAgICAgICAgICBIVE1MUGFnZSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgdGl0bGU6ICdGaWxlIGxpc3QnLAogICAgICAgICAgICAgICAgICBzdHlsZTogYGJvZHksICogewogIGZvbnQtZmFtaWx5OiBNaXNjRml4ZWRTQzYxMyxGaXhlZCwiQ291cmllciBOZXciOwp9YCwKICAgICAgICAgICAgICAgICAgc2NyaXB0czogWydmaWxlbGlzdC5qcyddCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgWwogICAgICAgICAgICAgICAgICBoKEZpbHRlckZvcm0sIHt9LCBbXSksCiAgICAgICAgICAgICAgICAgIGgoRmlsZVRhYmxlLCB7CiAgICAgICAgICAgICAgICAgICAgZmlsZXM6IGZpbGVzLm1hcChmaWxlID0+ICh7CiAgICAgICAgICAgICAgICAgICAgICBmaWxlLAogICAgICAgICAgICAgICAgICAgICAgc3RhdDogZnMuc3RhdFN5bmMoZmlsZSkKICAgICAgICAgICAgICAgICAgICB9KSkKICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIHlpZWxkIHJlbmRlclRvU3RyaW5nKGNvbXBvbmVudCk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgeWllbGQgZmlsZXMuam9pbignXG4nKTsKCiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBzdWNoIGNvbW1hbmQ6ICcke2FjdGlvbn0nYCk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBmdW5jdGlvbiogdXBsb2FkcyhyZXEsIHJlc3ApIHsKICAgICAgICAgIHJlc3AudHlwZSA9ICdhcHBsaWNhdGlvbi9qc29uJzsKICAgICAgICAgIGNvbnNvbGUubG9nKCd1cGxvYWRzJywgcmVxLCByZXNwKTsKICAgICAgICAgIGNvbnN0IHsgbGltaXQgPSAnMCwxMDAnLCBwcmV0dHkgPSAwIH0gPSByZXEudXJsLnF1ZXJ5ID8/IHt9OwogICAgICAgICAgbGV0IFtzdGFydCwgZW5kXSA9IGxpbWl0LnNwbGl0KC8sL2cpLm1hcChzID0+ICtzKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCd1cGxvYWRzJywgeyBzdGFydCwgZW5kIH0pOwogICAgICAgICAgbGV0IHJlc3VsdCA9IFtdLAogICAgICAgICAgICBlbnRyaWVzID0gZ2xvYigndXBsb2Fkcy8qLmpzb24nKTsKICAgICAgICAgIGZvcihsZXQgZW50cnkgb2YgKEFycmF5LmlzQXJyYXkoZW50cmllcykgPyBlbnRyaWVzIDogW10pLnNsaWNlKHN0YXJ0LCBlbmQpKSB7CiAgICAgICAgICAgIGxldCBqc29uID0gUmVhZEpTT04oZW50cnkpOwogICAgICAgICAgICBjb25zdCB7IHN0b3JhZ2UsIGZpbGVuYW1lLCB1cGxvYWRlZCwgYWRkcmVzcywgZXhpZiwgdGh1bWJuYWlsIH0gPSBqc29uOwogICAgICAgICAgICBqc29uLnNpemUgPSBmcy5zaXplU3luYyhzdG9yYWdlKTsKICAgICAgICAgICAgcmVzdWx0LnB1c2goanNvbik7CiAgICAgICAgICB9CgogICAgICAgICAgY29uc29sZS5sb2coJ3VwbG9hZHMnLCBjb25zb2xlLmNvbmZpZyh7IGRlcHRoOiAxLCBjb21wYWN0OiAyLCBtYXhBcnJheUxlbmd0aDogMTAgfSksIHJlc3VsdCk7CiAgICAgICAgICB5aWVsZCBKU09OLnN0cmluZ2lmeShyZXN1bHQsIC4uLigrcHJldHR5ID8gW251bGwsIDJdIDogW10pKTsKICAgICAgICB9LAogICAgICAgIGFzeW5jIGZ1bmN0aW9uKiBmaWxlcyhyZXEsIHJlc3ApIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCcqZmlsZXMgcXVlcnkgPScsIHJlcS51cmwucXVlcnkpOwogICAgICAgICAgY29uc3QgeyBmaWx0ZXIgPSAnKicsIHJvb3QsIHR5cGUgPSBUWVBFX0RJUiB8IFRZUEVfUkVHIHwgVFlQRV9MTkssIGxpbWl0ID0gJzAnIH0gPSByZXEudXJsLnF1ZXJ5OwogICAgICAgICAgY29uc29sZS5sb2coJypmaWxlcycsIHsgcm9vdCwgZmlsdGVyLCB0eXBlIH0pOwogICAgICAgICAgY29uc3QgW29mZnNldCA9IDAsIHNpemUgPSBJbmZpbml0eV0gPSBsaW1pdC5zcGxpdCgnLCcpLm1hcChuID0+ICtuKTsKICAgICAgICAgIGNvbnNvbGUubG9nKCcqZmlsZXMnLCB7IG9mZnNldCwgc2l6ZSB9KTsKICAgICAgICAgIGxldCBpID0gMDsKICAgICAgICAgIGxldCBmID0gTWF0Y2hlcihmaWx0ZXIpOwogICAgICAgICAgaWYoIXJvb3QpIHsKICAgICAgICAgICAgZm9yKGxldCBuYW1lIG9mIGFsbG93ZWREaXJzLmtleXMoKS5maWx0ZXIoZikpIHlpZWxkIG5hbWUgKyAnL1xyXG4nOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9yKGxldCBba2V5LCB2YWx1ZV0gb2YgYWxsb3dlZERpcnMuZW50cmllcygpLmZpbHRlcihLZXlPclZhbHVlTWF0Y2hlcihyb290KSkpIHsKICAgICAgICAgICAgICBsZXQgZGlyID0gbmV3IERpcmVjdG9yeSh2YWx1ZSwgQk9USCwgK3R5cGUpOwogICAgICAgICAgICAgIHlpZWxkIGtleSArICc6XHJcbic7CiAgICAgICAgICAgICAgZm9yKGxldCBbbmFtZSwgdHlwZV0gb2YgZGlyLmZpbHRlcigoW25hbWUsIHR5cGVdKSA9PiBmKG5hbWUpKSkgeWllbGQgbmFtZSArICgrdHlwZSA9PSBUWVBFX0RJUiA/ICcvJyA6ICcnKSArICdcclxuJzsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgY29uc29sZS5sb2coJypmaWxlcycsIHsgaSwgZiB9KTsKICAgICAgICB9LAogICAgICAgIGZ1bmN0aW9uKiBmaWxlczIocmVxLCByZXNwKSB7CiAgICAgICAgICBsZXQgeyBib2R5LCBoZWFkZXJzLCBqc29uLCB1cmwgfSA9IHJlcTsKICAgICAgICAgIGxldCB7IHF1ZXJ5IH0gPSB1cmw7CiAgICAgICAgICBkZWZpbmUoZ2xvYmFsVGhpcywgeyBmaWxlc1JlcXVlc3Q6IHsgcmVxLCByZXNwLCBib2R5LCBxdWVyeSB9IH0pOwogICAgICAgICAgY29uc29sZS5sb2coJypmaWxlcycsIHsgcmVxLCByZXNwLCBib2R5LCBxdWVyeSB9KTsKICAgICAgICAgIGNvbnN0IGRhdGEgPSBxdWVyeSA/PyB7fTsKICAgICAgICAgIHJlc3AudHlwZSA9ICdhcHBsaWNhdGlvbi9qc29uJzsKICAgICAgICAgIGxldCB7IGRpcnMgPSBkZWZhdWx0RGlycywgZmlsdGVyID0gJ1teLl0uKicgPz8gJy4oYnJkfHNjaHxHW0EtWl1bQS1aXSkkJywgdmVyYm9zZSA9IGZhbHNlLCBvYmplY3RzID0gdHJ1ZSwga2V5ID0gJ210aW1lJywgbGltaXQgPSBudWxsLCBmbGF0ID0gZmFsc2UgfSA9IGRhdGEgPz8ge307CiAgICAgICAgICBsZXQgcmVzdWx0cyA9IFtdOwogICAgICAgICAgZm9yKGxldCBkaXIgb2YgZGlycykgewogICAgICAgICAgICBsZXQgc3QsCiAgICAgICAgICAgICAgbmFtZXMgPSBbXTsKICAgICAgICAgICAgaWYoQXJyYXkuaXNBcnJheShkaXIpKSB7CiAgICAgICAgICAgICAgbGV0IFssIHJlXSA9IGRpcjsKICAgICAgICAgICAgICBsZXQgYWJzZGlyID0gcGF0aC5yZWFscGF0aChkaXJbMF0pOwogICAgICAgICAgICAgIG5hbWVzID0gWy4uLlJlY3Vyc2l2ZURpckl0ZXJhdG9yKGFic2RpciwgbiA9PiByZS50ZXN0KG4pKV07CiAgICAgICAgICAgICAgZGlyID0gcGF0aC5yZWxhdGl2ZShhYnNkaXIsIHBhdGguZ2V0Y3dkKCkpOwogICAgICAgICAgICB9IGVsc2UgaWYoKHN0ID0gZnMuc3RhdFN5bmMoZGlyKSkgJiYgc3QuaXNEaXJlY3RvcnkoKSkgewogICAgICAgICAgICAgIGxldCBhYnNkaXIgPSBwYXRoLnJlYWxwYXRoKGRpcik7CiAgICAgICAgICAgICAgbGV0IGNvbXBvbmVudHMgPSBhYnNkaXIuc3BsaXQocGF0aC5zZXApOwogICAgICAgICAgICAgIGlmKGNvbXBvbmVudHMubGVuZ3RoICYmIGNvbXBvbmVudHNbMF0gPT09ICcnKSBjb21wb25lbnRzLnNoaWZ0KCk7CiAgICAgICAgICAgICAgaWYoY29tcG9uZW50cy5sZW5ndGggPCAyIHx8IGNvbXBvbmVudHNbMF0gIT0gJ2hvbWUnKSB0aHJvdyBuZXcgRXJyb3IoYEFjY2VzcyBlcnJvcmApOwogICAgICAgICAgICAgIG5hbWVzID0gZnMucmVhZGRpclN5bmMoYWJzZGlyKSA/PyBbXTsKICAgICAgICAgICAgICBkaXIgPSBwYXRoLnJlbGF0aXZlKGFic2RpciwgcGF0aC5nZXRjd2QoKSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgbmFtZXMgPSBnbG9iKGRpciwgR0xPQl9CUkFDRSk7CiAgICAgICAgICAgICAgaWYoIUFycmF5LmlzQXJyYXkobmFtZXMpKSBuYW1lcyA9IFtdOwogICAgICAgICAgICAgIGxldCBhID0gcGF0aC50b0FycmF5KGRpcik7CiAgICAgICAgICAgICAgbGV0IGkgPSBhLmZpbmRJbmRleChuID0+IC9bKnt9XS8udGVzdChuKSk7CiAgICAgICAgICAgICAgZGlyID0gcGF0aC5zbGljZShkaXIsIDAsIGkpOwogICAgICAgICAgICAgIG5hbWVzID0gbmFtZXMubWFwKG4gPT4gbi5zbGljZShkaXIubGVuZ3RoICsgMSkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCFBcnJheS5pc0FycmF5KG5hbWVzKSkgY29udGludWU7CiAgICAgICAgICAgIG5hbWVzID0gbmFtZXMuc29ydCgoYSwgYikgPT4gJycgKyBiIDwgJycgKyBhKTsKICAgICAgICAgICAgaWYoZmlsdGVyKSB7CiAgICAgICAgICAgICAgY29uc3QgcmUgPSBuZXcgUmVnRXhwKGZpbHRlciwgJ2dpJyk7CiAgICAgICAgICAgICAgbmFtZXMgPSBuYW1lcy5maWx0ZXIobmFtZSA9PiByZS50ZXN0KG5hbWUpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZihsaW1pdCkgewogICAgICAgICAgICAgIGxldCBbb2Zmc2V0ID0gMF0gPSBsaW1pdDsKICAgICAgICAgICAgICBsZXQgWywgbGVuZ3RoID0gbmFtZXMubGVuZ3RoIC0gc3RhcnRdID0gbGltaXQ7CiAgICAgICAgICAgICAgbmFtZXMgPSBuYW1lcy5zbGljZShvZmZzZXQsIG9mZnNldCArIGxlbmd0aCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IGVudHJpZXMgPSBuYW1lcwogICAgICAgICAgICAgIC5tYXAoZmlsZSA9PiAoZnMuZXhpc3RzU3luYyhgJHtkaXJ9LyR7ZmlsZX1gKSA/IGAke2Rpcn0vJHtmaWxlfWAgOiBmaWxlKSkKICAgICAgICAgICAgICAubWFwKGZpbGUgPT4gW2ZpbGUsIHBhdGgucmVsYXRpdmUoZmlsZSwgcGF0aC5nZXRjd2QoKSldKQogICAgICAgICAgICAgIC5tYXAoKFtmaWxlLCByZWxdKSA9PiBbZmlsZSwgZnMuc3RhdFN5bmMocmVsKV0pOwogICAgICAgICAgICBlbnRyaWVzID0gZW50cmllcy5yZWR1Y2UoKGFjYywgW2ZpbGUsIHN0XSkgPT4gewogICAgICAgICAgICAgIGxldCBuYW1lID0gZmlsZSArIChzdCAmJiBzdC5pc0RpcmVjdG9yeSgpID8gJy8nIDogJycpOwogICAgICAgICAgICAgIGxldCBvYmogPSB7CiAgICAgICAgICAgICAgICBuYW1lCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBhY2MucHVzaChbCiAgICAgICAgICAgICAgICBuYW1lLAogICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbigKICAgICAgICAgICAgICAgICAgb2JqLAogICAgICAgICAgICAgICAgICBzdAogICAgICAgICAgICAgICAgICAgID8gewogICAgICAgICAgICAgICAgICAgICAgICBtdGltZTogdG9Vbml4VGltZShzdC5tdGltZSksCiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWU6IHRvVW5peFRpbWUoc3QuY3RpbWUpLAogICAgICAgICAgICAgICAgICAgICAgICBtb2RlOiBgMCR7KHN0Lm1vZGUgJiAweDA5ZmYpLnRvU3RyaW5nKDgpfWAsCiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IHN0LnNpemUKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICA6IHt9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgICAgcmV0dXJuIGFjYzsKICAgICAgICAgICAgfSwgW10pOwogICAgICAgICAgICBpZihlbnRyaWVzLmxlbmd0aCkgewogICAgICAgICAgICAgIGxldCBjbXAgPSB7CiAgICAgICAgICAgICAgICBzdHJpbmcoYSwgYikgewogICAgICAgICAgICAgICAgICByZXR1cm4gYVsxXVtrZXldLmxvY2FsZUNvbXBhcmUoYlsxXVtrZXldKTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBudW1iZXIoYSwgYikgewogICAgICAgICAgICAgICAgICByZXR1cm4gYVsxXVtrZXldIC0gYlsxXVtrZXldOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH1bdHlwZW9mIGVudHJpZXNbMF1bMV1ba2V5XV07CiAgICAgICAgICAgICAgZW50cmllcyA9IGVudHJpZXMuc29ydChjbXApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG5hbWVzID0gZW50cmllcy5tYXAoKFtuYW1lLCBvYmpdKSA9PiAob2JqZWN0cyA/IG9iaiA6IG5hbWUpKTsKICAgICAgICAgICAgaWYobmFtZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIGlmKGZsYXQpIG5hbWVzLm1hcCgoeyBuYW1lIH0pID0+IHJlc3VsdHMucHVzaCh7IG5hbWU6IHBhdGgubm9ybWFsaXplKHBhdGguam9pbihkaXIsIG5hbWUpKSB9KSk7CiAgICAgICAgICAgICAgZWxzZSByZXN1bHRzLnB1c2goeyBkaXIsIG5hbWVzIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICB5aWVsZCBKU09OLnN0cmluZ2lmeSguLi5bcmVzdWx0cywgLi4uKHZlcmJvc2UgPyBbbnVsbCwgMl0gOiBbXSldKTsKICAgICAgICB9CiAgICAgIF0sCiAgICAgIC4uLnVybCwKCiAgICAgIC4uLmNhbGxiYWNrcywKICAgICAgb25Db25uZWN0KHdzLCByZXEpIHsKICAgICAgICBjb25zb2xlLmxvZygnb25Db25uZWN0XHgxYicpOwogICAgICAgIGNvbnN0IHsgcGVlciwgYWRkcmVzcywgcG9ydCwgcHJvdG9jb2wgfSA9IHdzOwoKICAgICAgICBjb25zb2xlLmxvZygnXHgxYlszODs1OzMzbW9uQ29ubmVjdFx4MWJbMG0nLCB7IGFkZHJlc3MsIHBvcnQsIHByb3RvY29sIH0pOwoKICAgICAgICB3cy5zZW5kQ29tbWFuZCA9IGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgICAgIGlmKCFpc0FycmF5QnVmZmVyKGRhdGEpIC8qJiYgaXNPYmplY3QoZGF0YSkqLykgZGF0YSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpOwoKICAgICAgICAgIHJldHVybiB0aGlzLnNlbmQoZGF0YSk7CiAgICAgICAgfTsKICAgICAgICBpZighd3MudXVpZCkgewogICAgICAgICAgbGV0IGRhdGEgPSAod3MudXVpZCA9IE1ha2VVVUlEKCkpOwoKICAgICAgICAgIHdzLnNlbmRDb21tYW5kKHsgdHlwZTogJ3V1aWQnLCBkYXRhIH0pOwogICAgICAgICAgYnlfdXVpZFtkYXRhXSA9IHdzOwogICAgICAgIH0KICAgICAgICBjb25uZWN0aW9ucy5hZGQod3MpOwoKICAgICAgICBpZihjYWxsYmFja3Mub25Db25uZWN0KSByZXR1cm4gY2FsbGJhY2tzLm9uQ29ubmVjdCh3cywgcmVxKTsKICAgICAgfSwKICAgICAgb25DbG9zZSh3cywgcmVhc29uKSB7CiAgICAgICAgY29ubmVjdGlvbnMuZGVsZXRlKHdzKTsKCiAgICAgICAgcmV0dXJuIGNhbGxiYWNrcy5vbkNsb3NlKHdzLCByZWFzb24pOwogICAgICB9LAogICAgICAvKiAgICAgIG9uUmVhZChkYXRhKSB7CiAgICAgICAgICAgY29uc3QgcmVxID0gdGhpczsKICAgICAgICAgIGNvbnNvbGUubG9nKCdvblJlYWQnLCB7IHJlcSwgZGF0YSB9KTsKICAgICAgICB9LCovCiAgICAgIC8qIG9uUG9zdChkYXRhKSB7CiAgICAgICAgIGNvbnN0IHJlcSA9IHRoaXM7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICByZXEuanNvbiA9IEpTT04ucGFyc2UoZGF0YSk7CiAgICAgICAgICB9IGNhdGNoKGVycm9yKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvblBvc3QnLCB7IHJlcSwgZGF0YSwgZXJyb3IgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSwqLwogICAgICBvbkh0dHAod3MsIHJlcSwgcmVzcCkgewogICAgICAgIC8qIGlmKHJlcS5tZXRob2QgIT0gJ0dFVCcpKi8gLy9jb25zb2xlLmxvZygnb25IdHRwJywgY29uc29sZS5jb25maWcoeyBjb21wYWN0OiAwIH0pLCB3cyk7CiAgICAgICAgLy8gICBjb25zb2xlLmxvZygnXHgxYlszODs1OzIyMG1vbkh0dHAoMSlceDFiWzBtJywgY29uc29sZS5jb25maWcoeyBjb21wYWN0OiAwIH0pLCB7IHJlcSB9KTsKCiAgICAgICAgZGVmaW5lKGdsb2JhbFRoaXMsIHsgd3MsIHJlcSwgcmVzcCB9KTsKCiAgICAgICAgY29uc3QgeyBwZWVyLCBhZGRyZXNzLCBwb3J0IH0gPSB3czsKICAgICAgICBjb25zdCB7IG1ldGhvZCwgaGVhZGVycyB9ID0gcmVxOwoKICAgICAgICAvL3Jlc3AuaGVhZGVyc1snU2VydmVyJ10gPSAndXBsb2FkLXNlcnZlcic7CiAgICAgICAgcmVzcC5oZWFkZXJzID0geyBTZXJ2ZXI6ICd1cGxvYWQtc2VydmVyJyB9OwogICAgICAgIC8vY29uc29sZS5sb2coJ29uSHR0cCByZXNwLmhlYWRlcnMnLCByZXNwLmhlYWRlcnMsIHJlc3AuaGVhZGVyc1snU2VydmVyJ10pOwoKICAgICAgICBpZigocmVxLnVybC5wYXRoID8/ICcnKS5lbmRzV2l0aCgnZmlsZXMnKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgICAgLy9yZXNwLnR5cGUgPSAnYXBwbGljYXRpb24vanNvbic7CiAgICAgICAgfSBlbHNlIGlmKHJlcS5tZXRob2QgIT0gJ0dFVCcgJiYgKHJlcS5oZWFkZXJzWydjb250ZW50LXR5cGUnXSA9PSAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyB8fCAocmVxLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddID8/ICcnKS5zdGFydHNXaXRoKCdtdWx0aXBhcnQvZm9ybS1kYXRhJykpKSB7CiAgICAgICAgICBsZXQgZnAsCiAgICAgICAgICAgIGhhc2gsCiAgICAgICAgICAgIHRtcG5hbSwKICAgICAgICAgICAgZXh0LAogICAgICAgICAgICBwcm9ncmVzcyA9IDA7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXEubWV0aG9kLCBoZWFkZXJzKTsKICAgICAgICAgIGlmKHJlcS51cmwucGF0aC5lbmRzV2l0aCgndXBsb2FkJykpIHJlc3Auc3RhdHVzID0gMjAwOwogICAgICAgICAgcmVzcC50eXBlID0gJ3RleHQvcmF3JzsKCiAgICAgICAgICBmcCA9IG5ldyBGb3JtUGFyc2VyKHdzLCBbJ2ZpbGVzJywgJ3V1aWQnXSwgewogICAgICAgICAgICBjaHVua1NpemU6IDgxOTIgLyoqIDI1NiovLAogICAgICAgICAgICBvbk9wZW4obmFtZSwgZmlsZW5hbWUpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgb25PcGVuKCR7bmFtZX0sICR7ZmlsZW5hbWV9KWApOwogICAgICAgICAgICAgIGlmKHRoaXMuZmlsZSkgewogICAgICAgICAgICAgICAgdGhpcy5vbmNsb3NlLmNhbGwodGhpcywgbmFtZSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgICAgICAgICAgIHRoaXMuZmlsZW5hbWUgPSBmaWxlbmFtZTsKICAgICAgICAgICAgICBleHQgPSBwYXRoLmV4dG5hbWUoZmlsZW5hbWUpLnRvTG93ZXJDYXNlKCk7CgogICAgICAgICAgICAgIHRoaXMuZmlsZSA9IGZzLm9wZW5TeW5jKCh0aGlzLnRlbXAgPSAndXBsb2Fkcy8nICsgKHRtcG5hbSA9IHJhbmRTdHIoMjApICsgJy50bXAnKSksICd3KycsIDBvNjQ0KTsKICAgICAgICAgICAgICBoYXNoID0gbmV3IEhhc2goSGFzaC5UWVBFX1NIQTEpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBvbkNvbnRlbnQobmFtZSwgZGF0YSkgewogICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGBvbkNvbnRlbnQoJHt0aGlzLmZpbGVuYW1lfSlgLGRhdGEuYnl0ZUxlbmd0aCk7CiAgICAgICAgICAgICAgcHJvZ3Jlc3MgKz0gZGF0YS5ieXRlTGVuZ3RoOwoKICAgICAgICAgICAgICBsZXQgd3MyID0gYnlfdXVpZFt3cy51dWlkID8/IHRoaXMudXVpZF07CgogICAgICAgICAgICAgIGZzLndyaXRlU3luYyh0aGlzLmZpbGUsIGRhdGEpOwogICAgICAgICAgICAgIGhhc2gudXBkYXRlKGRhdGEpOwogICAgICAgICAgICAgIGlmKHdzMikKICAgICAgICAgICAgICAgIHdzMi5zZW5kQ29tbWFuZCh7CiAgICAgICAgICAgICAgICAgIHR5cGU6ICdwcm9ncmVzcycsCiAgICAgICAgICAgICAgICAgIGRvbmU6IHByb2dyZXNzLAogICAgICAgICAgICAgICAgICBuYW1lLAogICAgICAgICAgICAgICAgICBmaWxlbmFtZTogdGhpcy5maWxlbmFtZSwKICAgICAgICAgICAgICAgICAgdG90YWw6ICtoZWFkZXJzWydjb250ZW50LWxlbmd0aCddCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSwKCiAgICAgICAgICAgIG9uQ2xvc2UobmFtZSwgZmlsZSkgewogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgb25DbG9zZVsxXSgke25hbWV9LCAke2ZpbGV9KWAsIHRoaXMudXVpZCk7CiAgICAgICAgICAgICAgICBsZXQgZXhpZiwgY2FjaGUsIHNoYTE7CiAgICAgICAgICAgICAgICBpZihoYXNoKSB7CiAgICAgICAgICAgICAgICAgIGhhc2guZmluYWxpemUoKTsKICAgICAgICAgICAgICAgICAgc2hhMSA9IGhhc2gudG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKHRoaXMuZmlsZSkgewogICAgICAgICAgICAgICAgICBmcy5jbG9zZVN5bmModGhpcy5maWxlKTsKICAgICAgICAgICAgICAgICAgdGhpcy5maWxlID0gbnVsbDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKHNoYTEpIHsKICAgICAgICAgICAgICAgICAgbGV0IGYgPSB4ID0+ICd1cGxvYWRzLycgKyBzaGExICsgeDsKICAgICAgICAgICAgICAgICAgbGV0IHJldCA9IGxpbmsodGhpcy50ZW1wLCBmKGV4dCkpOwogICAgICAgICAgICAgICAgICBsZXQgeyBlcnJubyB9ID0gZXJyb3IoKTsKICAgICAgICAgICAgICAgICAgbGV0IGpzb24gPSBmKCcuanNvbicpOwogICAgICAgICAgICAgICAgICBpZihmcy5leGlzdHNTeW5jKGpzb24pICYmIChjYWNoZSA9IFJlYWRKU09OKGpzb24pKSkgewogICAgICAgICAgICAgICAgICAgIGV4aWYgPSBjYWNoZS5leGlmOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmKCEvKHBuZ3xzdmd8Z2lmfHRnYSkkL2kudGVzdChleHQpKSB7CiAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBleGlmID0gUmVhZEV4aWZ0b29sKGYoZXh0KSk7CiAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICBleGlmID0gUmVhZEV4aWZ0b29sKHRoaXMudGVtcCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2goZSkge30KICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgbGV0IG9iaiA9IHsKICAgICAgICAgICAgICAgICAgICAgIGZpbGVuYW1lOiB0aGlzLmZpbGVuYW1lLAogICAgICAgICAgICAgICAgICAgICAgc3RvcmFnZTogZihleHQpLAogICAgICAgICAgICAgICAgICAgICAgdXBsb2FkZWQ6IERhdGUubm93KCksCiAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgICAgICAgZXhpZgogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgaWYoIS9qcGU/ZyQvLnRlc3QoZXh0KSkgewogICAgICAgICAgICAgICAgICAgICAgSGVpZkNvbnZlcnQoZihleHQpLCBmKCcuanBnJykpOwogICAgICAgICAgICAgICAgICAgICAgaWYoZnMuZXhpc3RzU3luYyhmKCcuanBnJykpKSBvYmouanBnID0gZignLmpwZycpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBsZXQgd2lkdGggPSAnJywKICAgICAgICAgICAgICAgICAgICAgIGhlaWdodCA9ICcyNTYnOwoKICAgICAgICAgICAgICAgICAgICBpZihleGlmKSB7CiAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7IEltYWdlU2l6ZSwgSW1hZ2VIZWlnaHQsIEltYWdlV2lkdGggfSA9IGV4aWY7CiAgICAgICAgICAgICAgICAgICAgICBsZXQgYXNwZWN0ID0gSW1hZ2VXaWR0aCAvIEltYWdlSGVpZ2h0OwogICAgICAgICAgICAgICAgICAgICAgaWYoYXNwZWN0ID49IDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGggPSAyNTY7CiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IHdpZHRoIC8gYXNwZWN0OwogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgLyogaGVpZ2h0ID0gMjU2OwogICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoID0gaGVpZ2h0ICogYXNwZWN0OyovCiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBNYWdpY2tSZXNpemUob2JqLmpwZyA/PyBmKGV4dCksIGYoJy50aHVtYi5qcGcnKSwgb2JqLmV4aWY/LlJvdGF0aW9uID8/IDAsIHdpZHRoLCBoZWlnaHQpOwoKICAgICAgICAgICAgICAgICAgICBpZihmcy5leGlzdHNTeW5jKGYoJy50aHVtYi5qcGcnKSkpIG9iai50aHVtYm5haWwgPSBmKCcudGh1bWIuanBnJyk7CiAgICAgICAgICAgICAgICAgICAgV3JpdGVKU09OKGpzb24sIG9iaik7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYGJ5X3V1aWRgLCBieV91dWlkKTsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgdXVpZGAsIHdzLnV1aWQgPz8gdGhpcy51dWlkKTsKICAgICAgICAgICAgICAgICAgICBjYWNoZSA9IG9iajsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBpZihyZXQgPT0gMCB8fCBlcnJubyA9PSAxNykgewogICAgICAgICAgICAgICAgICAgIHVubGluayh0aGlzLnRlbXApOwogICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcCA9IG51bGw7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnN0IHsgZmlsZW5hbWUgfSA9IHRoaXM7CiAgICAgICAgICAgICAgICBsZXQgd3MyID0gYnlfdXVpZFt3cy51dWlkID8/IHRoaXMudXVpZF07CiAgICAgICAgICAgICAgICBpZih3czIpCiAgICAgICAgICAgICAgICAgIHdzMi5zZW5kQ29tbWFuZCh7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3VwbG9hZCcsCiAgICAgICAgICAgICAgICAgICAgLi4uKGNhY2hlID8/IHt9KSwKICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICBleGlmCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgLy8gIGNvbnNvbGUubG9nKGBvbkNsb3NlWzJdKCR7bmFtZX0sICR7ZmlsZX0pYCk7CiAgICAgICAgICAgICAgfSBjYXRjaChlKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgb25DbG9zZSBFUlJPUjpgLCBlLm1lc3NhZ2UpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25GaW5hbGl6ZSgpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgb25GaW5hbGl6ZSgpIGZvcm0gcGFyc2VyYCwgdGhpcy51dWlkKTsKICAgICAgICAgICAgICByZXNwLmJvZHkgPSBgZG9uZTogJHtwcm9ncmVzc30gYnl0ZXMgcmVhZFxyXG5gOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIC8vdGhyb3cgbmV3IEVycm9yKGBodHRwICR7bWV0aG9kfSByZXF1ZXN0YCk7CgogICAgICAgIGlmKCFyZXEuaGVhZGVycyB8fCB0eXBlb2YgcmVxLmhlYWRlcnMgIT0gJ29iamVjdCcpIGNvbnNvbGUubG9nKCdObyBoZWFkZXJzJywgcmVxKTsKCiAgICAgICAgY29uc3QgeyBib2R5LCB1cmwgfSA9IHJlc3A7CiAgICAgICAgY29uc3QgeyByZWZlcmVyIH0gPSByZXEuaGVhZGVyczsKCiAgICAgICAgbGV0IGZpbGUgPSB1cmwucGF0aC5zbGljZSgxKTsKICAgICAgICBjb25zdCBkaXIgPSBwYXRoLmRpcm5hbWUoZmlsZSk7IC8vZmlsZS5yZXBsYWNlKC9cL1teXC9dKiQvZywgJycpOwoKICAgICAgICBpZihmaWxlLmVuZHNXaXRoKCcudHh0JykgfHwgZmlsZS5lbmRzV2l0aCgnLmh0bWwnKSB8fCBmaWxlLmVuZHNXaXRoKCcuY3NzJykpIHsKICAgICAgICAgIHJlc3AuYm9keSA9IGZzLnJlYWRGaWxlU3luYyhmaWxlLCAndXRmLTgnKTsKICAgICAgICB9IGVsc2UgaWYoZmlsZS5lbmRzV2l0aCgnLmpzJykpIHsKICAgICAgICAgIGxldCBmaWxlMSA9IGZpbGU7CiAgICAgICAgICBpZigvcWpzLW1vZHVsZXNcL2xpYi8udGVzdChmaWxlKSAmJiAhLyhkb218dXRpbClcLmpzLy50ZXN0KGZpbGUpKSB7CiAgICAgICAgICAgIGxldCBmaWxlMiA9IGZpbGUucmVwbGFjZSgvLipxanMtbW9kdWxlc1wvL2csICcnKTsKICAgICAgICAgICAgaWYoZnMuZXhpc3RzU3luYyhmaWxlMikpIHsKICAgICAgICAgICAgICBmaWxlID0gZmlsZTI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZighZnMuZXhpc3RzU3luYyhmaWxlKSkgewogICAgICAgICAgICBmb3IobGV0IGRpciBvZiBbJ3F1aWNranMvcWpzLW1vZHVsZXMnLCAncXVpY2tqcy9xanMtbW9kdWxlcy9saWInLCAnLicsICdsaWInXSkgewogICAgICAgICAgICAgIGxldCBmaWxlMiA9IGRpciArICcvJyArIGZpbGU7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2luZXhpc3RlbnQgZmlsZScsIGZpbGUsIGZpbGUyLCBmcy5leGlzdHNTeW5jKGZpbGUyKSwgcmVmZXJlcik7CiAgICAgICAgICAgICAgaWYoZnMuZXhpc3RzU3luYyhmaWxlMikpIHsKICAgICAgICAgICAgICAgIGZpbGUgPSBmaWxlMjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmKGZpbGUxICE9IGZpbGUpIHsKICAgICAgICAgICAgLy8gIGNvbnNvbGUubG9nKCdceDFiWzM4OzU7MjE0bW9uSHR0cFx4MWJbMG0nLCBmaWxlMSwgJy0+JywgZmlsZSk7CiAgICAgICAgICAgIHJlc3Auc3RhdHVzID0gMzAyOwogICAgICAgICAgICByZXNwLmhlYWRlcnMgPSB7IFsnTG9jYXRpb24nXTogJy8nICsgZmlsZSB9OwogICAgICAgICAgICByZXR1cm4gcmVzcDsKICAgICAgICAgIH0KICAgICAgICAgIC8vY29uc29sZS5sb2coJ1x4MWJbMzg7NTszM21vbkh0dHBceDFiWzBtJywgZmlsZTEsIGZpbGUpOwoKICAgICAgICAgIC8vCiAgICAgICAgICBsZXQgYm9keSA9IGZzLnJlYWRGaWxlU3luYyhmaWxlLCAndXRmLTgnKTsKCiAgICAgICAgICBjb25zdCByZSA9IC9eKFxzKihpbXxleClwb3J0W15cbl0qZnJvbSBbJyJdKShbXi4vJyJdKikoWyciXVxzKjtbXHQgXSpcbj8pL2dtOwoKICAgICAgICAgIHJlc3AuYm9keSA9IGJvZHkucmVwbGFjZUFsbChyZSwgKG1hdGNoLCBwMSwgcDAsIHAyLCBwMywgb2Zmc2V0KSA9PiB7CiAgICAgICAgICAgIGlmKCEvW1wvXC5dLy50ZXN0KHAyKSkgewogICAgICAgICAgICAgIGxldCBmbmFtZSA9IGAke3AyfS5qc2A7CiAgICAgICAgICAgICAgbGV0IHJlbCA9IHBhdGgucmVsYXRpdmUoZm5hbWUsIGRpcik7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ29uSHR0cCcsIHsgbWF0Y2gsIGZuYW1lIH0sIHJlbCk7CgogICAgICAgICAgICAgIC8vIGlmKCFmcy5leGlzdHNTeW5jKCAgcmVsKSkgcmV0dXJuIGBgOwoKICAgICAgICAgICAgICBtYXRjaCA9IFtwMSwgcmVsLCBwM10uam9pbignJyk7CgogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhcmdzJywgewogICAgICAgICAgICAgICAgbWF0Y2gsCiAgICAgICAgICAgICAgICBwMSwKICAgICAgICAgICAgICAgIHAyLAogICAgICAgICAgICAgICAgcDMsCiAgICAgICAgICAgICAgICBvZmZzZXQKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbWF0Y2g7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgewogICAgICAgICAgbGV0IHsgYm9keSB9ID0gcmVzcDsKICAgICAgICAgIC8vY29uc29sZS5sb2coJ1x4MWJbMzg7NTsyMTJtb25IdHRwKDIpXHgxYlswbScsIHsgYm9keSB9KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXNwOwogICAgICB9LAogICAgICBvbk1lc3NhZ2Uod3MsIGRhdGEpIHsKICAgICAgICBjb25zb2xlLmxvZygnb25NZXNzYWdlJywgd3MsIGRhdGEpOwogICAgICAgIHJldHVybiBjYWxsYmFja3Mub25NZXNzYWdlKHdzLCBkYXRhKTsKICAgICAgfSwKICAgICAgb25GZChmZCwgcmQsIHdyKSB7CiAgICAgICAgY29uc29sZS5sb2coJ29uRmQnLCBmZCwgcmQsIHdyKTsKICAgICAgICByZXR1cm4gY2FsbGJhY2tzLm9uRmQoZmQsIHJkLCB3cik7CiAgICAgIH0sCiAgICAgIC4uLih1cmwgJiYgdXJsLmhvc3QgPyB1cmwgOiB7fSkKICAgIH0pOwogIH0pOwoKICBkZWZpbmUoZ2xvYmFsVGhpcywgewogICAgZ2V0IGNvbm5lY3Rpb25zKCkgewogICAgICByZXR1cm4gWy4uLmNvbm5lY3Rpb25zXTsKICAgIH0sCiAgICBnZXQgYnlfdXVpZCgpIHsKICAgICAgcmV0dXJuIGJ5X3V1aWQ7CiAgICB9LAogICAgdXVpZChkYXRhKSB7CiAgICAgIHJldHVybiBieV91dWlkW2RhdGFdOwogICAgfQogIH0pOwoKICBPYmplY3QuYXNzaWduKGdsb2JhbFRoaXMsIHsKICAgIHJlcGwsCiAgICBxdWl0LAogICAgZXhpdDogcXVpdCwKICAgIHN0ZCwKICAgIG9zLAogICAgZGVlcCwKICAgIGZzLAogICAgcGF0aCwKICAgIFJlYWRKU09OLAogICAgV3JpdGVKU09OLAogICAgUmVhZEZpbGUsCiAgICBXcml0ZUZpbGUsCiAgICBSZWFkQkpTT04sCiAgICBXcml0ZUJKU09OLAogICAgcGFyc2VEYXRlLAogICAgZGF0ZVRvT2JqZWN0LAogICAgSGFzaCwKICAgIEZvcm1QYXJzZXIsCiAgICBFeGVjVG9vbCwKICAgIEV4ZWN1dGUsCiAgICBleHRlbmRHZW5lcmF0b3IsCiAgICBleHRlbmRBcnJheSwKICAgIGV4dGVuZEFzeW5jR2VuZXJhdG9yLAogICAgTWF0Y2hlciwKICAgIEV4ZWNUb29sLAogICAgR2V0TWltZSwKICAgIE1hdGNoZXIsCiAgICBLZXlPclZhbHVlTWF0Y2hlciwKICAgIEdldFJvb3REaXJlY3RvcmllcywKICAgIEdldERpciwKICAgIERpck5hbWUsCiAgICBEYXRlU3RyLAogICAgTW9kZVN0ciwKICAgIFJlYWRFeGl2MiwKICAgIFJlYWRFeGlmdG9vbCwKICAgIEhlaWZDb252ZXJ0LAogICAgTWFnaWNrUmVzaXplLAogICAgRGlyZWN0b3J5LAogICAgbmV0OiB7IHNldExvZywgTExMX1VTRVIsIExMTF9OT1RJQ0UsIExMTF9XQVJOLCBMTExfSU5GTywgY2xpZW50LCBzZXJ2ZXIsIEZvcm1QYXJzZXIsIEhhc2gsIFJlc3BvbnNlLCBTb2NrZXQgfQogIH0pOwoKICBkZWxldGUgZ2xvYmFsVGhpcy5ERUJVRzsKCiAgY3JlYXRlV1MoCiAgICB7IHByb3RvY29sOiAnd3MnLCBob3N0OiAnMC4wLjAuMCcsIHBvcnQ6IDg5OTkgfSwKICAgIHsKICAgICAgb25GZChmZCwgcmQsIHdyKSB7CiAgICAgICAgY29uc29sZS5sb2coJ29uRmQnLCBmZCwgcmQsIHdyKTsKICAgICAgICBvcy5zZXRSZWFkSGFuZGxlcihmZCwgcmQpOwogICAgICAgIG9zLnNldFdyaXRlSGFuZGxlcihmZCwgd3IpOwogICAgICB9LAogICAgICBvbkNsb3NlKHdzLCByZWFzb24pIHt9LAogICAgICBvbk1lc3NhZ2Uod3MsIGRhdGEpIHt9CiAgICB9LAogICAgdHJ1ZQogICk7CgogIGZ1bmN0aW9uIHF1aXQod2h5KSB7CiAgICBjb25zb2xlLmxvZyhgcXVpdCgnJHt3aHl9JylgKTsKCiAgICBsZXQgY2ZnID0geyBpbnNwZWN0T3B0aW9uczogY29uc29sZS5vcHRpb25zIH07CiAgICBXcml0ZUpTT04oYC4ke2Jhc2V9LWNvbmZpZ2AsIGNmZyk7CiAgICByZXBsLmNsZWFudXAod2h5KTsKICB9CgogIHJlcGwucnVuU3luYygpOwp9Cgp0cnkgewogIG1haW4oLi4uc2NyaXB0QXJncy5zbGljZSgxKSk7Cn0gY2F0Y2goZXJyb3IpIHsKICBjb25zb2xlLmxvZyhgRkFJTDogJHtlcnJvcj8ubWVzc2FnZSA/PyBlcnJvcn1cbiR7ZXJyb3I/LnN0YWNrfWApOwogIDE7CiAgc3RkLmV4aXQoMSk7Cn0gZmluYWxseSB7Cn0KAAAAAAAAAACUhgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAALyoAAAAAAADfKwAAAAAAAAAAAAAAAPC/"
				],
				[
					21,
					1,
					"toggle_comment",
					{
						"block": true
					},
					"AgAAADSAAAAAAAAANoAAAAAAAAAAAAAAvX8AAAAAAAC/fwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAvX8AAAAAAAA0gAAAAAAAAAAAAAAAAPC/"
				],
				[
					27,
					1,
					"insert",
					{
						"characters": "(("
					},
					"AgAAAOJ/AAAAAAAA438AAAAAAAAAAAAA438AAAAAAADkfwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA4n8AAAAAAADifwAAAAAAAAAAAAAAAFJA"
				],
				[
					30,
					2,
					"left_delete",
					null,
					"AgAAAON/AAAAAAAA438AAAAAAAABAAAAKOJ/AAAAAAAA4n8AAAAAAAABAAAAKA",
					"AQAAAAAAAAABAAAA5H8AAAAAAADkfwAAAAAAAAAAAAAAAPC/"
				],
				[
					31,
					1,
					"insert",
					{
						"characters": "//"
					},
					"AgAAAOJ/AAAAAAAA438AAAAAAAAAAAAA438AAAAAAADkfwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA4n8AAAAAAADifwAAAAAAAAAAAAAAAPC/"
				],
				[
					49,
					1,
					"insert",
					{
						"characters": ","
					},
					"AQAAAL1/AAAAAAAAvn8AAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAvX8AAAAAAAC9fwAAAAAAAAAAAAAAAPC/"
				],
				[
					51,
					1,
					"right_delete",
					null,
					"AQAAAMB/AAAAAAAAwH8AAAAAAAABAAAALA",
					"AQAAAAAAAAABAAAAwH8AAAAAAADAfwAAAAAAAAAAAAAAAPC/"
				],
				[
					88,
					1,
					"toggle_comment",
					{
						"block": true
					},
					"AgAAAOWEAAAAAAAA54QAAAAAAAAAAAAAWoQAAAAAAABchAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAWoQAAAAAAADlhAAAAAAAAAAAAAAAAPC/"
				],
				[
					99,
					1,
					"left_delete",
					null,
					"AQAAAFqEAAAAAAAAWoQAAAAAAAABAAAALw",
					"AQAAAAAAAAABAAAAW4QAAAAAAABbhAAAAAAAAAAAAAAAgE9A"
				],
				[
					100,
					1,
					"right_delete",
					null,
					"AQAAAFqEAAAAAAAAWoQAAAAAAAABAAAAKg",
					"AQAAAAAAAAABAAAAWoQAAAAAAABahAAAAAAAAAAAAAAAAPC/"
				],
				[
					104,
					1,
					"insert",
					{
						"characters": "//"
					},
					"AgAAAHWEAAAAAAAAdoQAAAAAAAAAAAAAdoQAAAAAAAB3hAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAdYQAAAAAAAB1hAAAAAAAAAAAAAAAAPC/"
				],
				[
					106,
					2,
					"left_delete",
					null,
					"AgAAAOiEAAAAAAAA6IQAAAAAAAABAAAAL+eEAAAAAAAA54QAAAAAAAABAAAAKg",
					"AQAAAAAAAAABAAAA6YQAAAAAAADphAAAAAAAAAAAAAAAgFZA"
				],
				[
					117,
					1,
					"left_delete",
					null,
					"AQAAAL5/AAAAAAAAvn8AAAAAAACDAAAALyoKICAgICAgb25GZChmZCwgcmQsIHdyKSB7CiAgICAgICAgLy9jb25zb2xlLmxvZygnb25GZCcsIGZkLCByZCwgd3IpOwogICAgICAgIHJldHVybiBjYWxsYmFja3Mub25GZChmZCwgcmQsIHdyKTsKICAgICAgfSwqLwogICAgICA",
					"AQAAAAAAAAABAAAAvn8AAAAAAABBgAAAAAAAAAAAAAAAAPC/"
				],
				[
					124,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAAAZhgAAaW1wb3J0ICogYXMgc3RkIGZyb20gJ3N0ZCc7CmltcG9ydCAqIGFzIG9zIGZyb20gJ29zJzsKaW1wb3J0ICogYXMgZGVlcCBmcm9tICcuL2xpYi9kZWVwLmpzJzsKaW1wb3J0ICogYXMgeG1sIGZyb20gJ3htbCc7CmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7CmltcG9ydCB7IENvbnNvbGUgfSBmcm9tICdjb25zb2xlJzsKaW1wb3J0IHsgRGlyZWN0b3J5LCBCT1RILCBUWVBFX0RJUiwgVFlQRV9MTkssIFRZUEVfUkVHLCBUWVBFX01BU0sgfSBmcm9tICdkaXJlY3RvcnknOwppbXBvcnQgUkVQTCBmcm9tICcuL3F1aWNranMvcWpzLW1vZHVsZXMvbGliL3JlcGwuanMnOwppbXBvcnQgaW5zcGVjdCBmcm9tICcuL2xpYi9vYmplY3RJbnNwZWN0LmpzJzsKaW1wb3J0ICogYXMgVGVybWluYWwgZnJvbSAnLi90ZXJtaW5hbC5qcyc7CmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJzsKaW1wb3J0IHsgbGluaywgdW5saW5rLCBlcnJvciwgZm5tYXRjaCwgRk5NX0VYVE1BVENIIH0gZnJvbSAnbWlzYyc7CmltcG9ydCB7IHRvU3RyaW5nLCBkZWZpbmUsIHRvVW5peFRpbWUsIGdldE9wdCwgcmFuZFN0ciwgaXNPYmplY3QsIGlzTnVtZXJpYywgaXNBcnJheUJ1ZmZlciwgZ2xvYiwgR0xPQl9CUkFDRSwgd2FpdEZvciB9IGZyb20gJ3V0aWwnOwppbXBvcnQgeyBzZXRMb2csIExMTF9VU0VSLCBMTExfTk9USUNFLCBMTExfV0FSTiwgTExMX0lORk8sIGNsaWVudCwgc2VydmVyLCBGb3JtUGFyc2VyLCBIYXNoLCBSZXNwb25zZSwgU29ja2V0IH0gZnJvbSAnbmV0JzsKaW1wb3J0IHsgcGFyc2VEYXRlLCBkYXRlVG9PYmplY3QgfSBmcm9tICcuL2RhdGUtaGVscGVycy5qcyc7CmltcG9ydCB7IElmRGVidWcsIExvZ0lmRGVidWcsIFJlYWRGaWxlLCBMb2FkSGlzdG9yeSwgUmVhZEpTT04sIFJlYWRYTUwsIE1hcEZpbGUsIFdyaXRlRmlsZSwgV3JpdGVKU09OLCBXcml0ZVhNTCwgUmVhZEJKU09OLCBXcml0ZUJKU09OLCBEaXJJdGVyYXRvciwgUmVjdXJzaXZlRGlySXRlcmF0b3IsIFJlYWREaXJSZWN1cnNpdmUsIEZpbHRlciwgRmlsdGVySW1hZ2VzLCBTb3J0RmlsZXMsIFN0YXRGaWxlcywgUmVhZEZkLCBGZFJlYWRlciwgQ29weVRvQ2xpcGJvYXJkLCBSZWFkQ2FsbGJhY2ssIExvZ0NhbGwsIFNwYXduLCBGZXRjaFVSTCB9IGZyb20gJy4vaW8taGVscGVycy5qcyc7CmltcG9ydCB7IHBhcnNlRGVnTWluU2VjLCBwYXJzZUdQU0xvY2F0aW9uIH0gZnJvbSAnLi9zdHJpbmctaGVscGVycy5qcyc7CmltcG9ydCB7IGgsIGh0bWwsIHJlbmRlciwgQ29tcG9uZW50LCB1c2VTdGF0ZSwgdXNlTGF5b3V0RWZmZWN0LCB1c2VSZWYgfSBmcm9tICcuL2xpYi9wcmVhY3QubWpzJzsKaW1wb3J0IHJlbmRlclRvU3RyaW5nIGZyb20gJy4vbGliL3ByZWFjdC1yZW5kZXItdG8tc3RyaW5nLmpzJzsKaW1wb3J0IHsgZXhlYywgc3Bhd24gfSBmcm9tICdjaGlsZF9wcm9jZXNzJzsKaW1wb3J0IHsgRXhlY3V0ZSB9IGZyb20gJy4vb3MtaGVscGVycy5qcyc7CmltcG9ydCB0cmtsIGZyb20gJy4vbGliL3Rya2wuanMnOwppbXBvcnQgeyB0YWtlIH0gZnJvbSAnLi9saWIvaXRlcmF0b3IvaGVscGVycy5qcyc7CmltcG9ydCB7IGV4dGVuZEFycmF5LCBleHRlbmRHZW5lcmF0b3IsIGV4dGVuZEFzeW5jR2VuZXJhdG9yIH0gZnJvbSAndXRpbCc7CgpleHRlbmRBcnJheSgpOwpleHRlbmRHZW5lcmF0b3IoKTsKZXh0ZW5kR2VuZXJhdG9yKE9iamVjdC5nZXRQcm90b3R5cGVPZihuZXcgTWFwKCkua2V5cygpKSk7CmV4dGVuZEdlbmVyYXRvcihPYmplY3QuZ2V0UHJvdG90eXBlT2YobmV3IERpcmVjdG9yeSgnLicpKSk7CmV4dGVuZEFzeW5jR2VuZXJhdG9yKCk7CgpnbG9iYWxUaGlzLmZzID0gZnM7Cmdsb2JhbFRoaXMubG9nRmlsdGVyID0KICAvKHdzX3NldF90aW1lb3V0OiBvbiBpbW1vcnRhbCBzdHJlYW18VW5oYW5kbGVkfFBST1hZLXxWSE9TVF9DRVJUX0FHSU5HfEJJTkR8RVZFTlRfV0FJVHxXUklUQUJMRSkvOwoKdHJrbC5wcm9wZXJ0eShnbG9iYWxUaGlzLCAnbG9nTGV2ZWwnKS5zdWJzY3JpYmUodmFsdWUgPT4KICBzZXRMb2codmFsdWUsIChsZXZlbCwgbWVzc2FnZSkgPT4gewogICAgaWYoCiAgICAgIC9fX2x3c3xzZXJ2ZV8ocmVzb2x2ZWR8Z2VuZXJhdG9yfHByb21pc2V8cmVzcG9uc2UpfFhYYmwoXChbMTIzXVwpLip3cml0YWJsZXx4XChbL11cKS4qV1JJVEVBQkxFKXxsd3NfLy50ZXN0KAogICAgICAgIG1lc3NhZ2UKICAgICAgKQogICAgKQogICAgICByZXR1cm47CiAgICBpZihsZXZlbCA9PSBMTExfSU5GTyAmJiAhL3Byb3h5Ly50ZXN0KG1lc3NhZ2UpKSByZXR1cm47CiAgICBpZihsb2dGaWx0ZXIudGVzdChtZXNzYWdlKSkgcmV0dXJuOwoKICAgIC8vaWYocGFyYW1zLmRlYnVnIHx8IGxldmVsIDw9IExMTF9XQVJOKQogICAgb3V0KAogICAgICAoCiAgICAgICAgWydFUlInLCAnV0FSTicsICdOT1RJQ0UnLCAnSU5GTycsICdERUJVRycsICdQQVJTRVInLCAnSEVBREVSJywgJ0VYVCcsICdDTElFTlQnLCAnTEFURU5DWScsICdNSU5ORVQnLCAnVEhSRUFEJ11bCiAgICAgICAgICBNYXRoLmxvZzIobGV2ZWwpCiAgICAgICAgXSA/PyBsZXZlbCArICcnCiAgICAgICkucGFkRW5kKDgpICsgbWVzc2FnZS5yZXBsYWNlKC9cbi9nLCAnXFxuJykucmVwbGFjZSgvXHIvZywgJ1xccicpCiAgICApOwogIH0pCik7Cgphc3luYyBmdW5jdGlvbiBBc3luY0NvbGxlY3QoaXRlcikgewogIGxldCByZXQgPSBbXTsKICBmb3IgYXdhaXQobGV0IGNodW5rIG9mIGF3YWl0IGl0ZXIpIHJldC5wdXNoKGNodW5rKTsKICByZXR1cm4gcmV0Owp9CgpmdW5jdGlvbiBFeGVjVG9vbChjbWQsIC4uLmFyZ3MpIHsKICBsZXQgY2hpbGQgPSBzcGF3bihjbWQsIGFyZ3MsIHsgc3RkaW86IFswLCAncGlwZScsIDJdIH0pOwogIGxldCBbc3RkaW4sIHN0ZG91dCwgc3RkZXJyXSA9IGNoaWxkLnN0ZGlvOwogIGxldCByOwogIGxldCBiID0gbmV3IEFycmF5QnVmZmVyKDEwMjQpOwogIHIgPSBjaGlsZC53YWl0KCk7CiAgLy8gY29uc29sZS5sb2coJ0V4ZWNUb29sJywgeyBhcmdzLCBjaGlsZCB9KTsKCiAgciA9IG9zLnJlYWQoc3Rkb3V0LCBiLCAwLCAxMDI0KTsKICBsZXQgZGF0YSA9IGIuc2xpY2UoMCwgcik7CiAgbGV0IHN0ciA9IHRvU3RyaW5nKGRhdGEpOwoKICByZXR1cm4gc3RyOwp9CgpmdW5jdGlvbiBHZXRNaW1lKGZpbGUpIHsKICBsZXQgb3V0cHV0ID0gRXhlY1Rvb2woJ2ZpbGUnLCAnLWknLCBmaWxlKTsKICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZSgvW1xyXG5dKiQvZywgJycpOwogIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKG5ldyBSZWdFeHAoZmlsZSArICc6XFxzKycpLCAnJyk7CiAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UoL1w7XHMqLiovZywgJycpOwogIHJldHVybiBvdXRwdXQ7Cn0KCmZ1bmN0aW9uIE1hdGNoZXIocGF0dGVybiwgdCA9IGFyZyA9PiBhcmcpIHsKICByZXR1cm4gKC4uLmFyZ3MpID0+IHBhdHRlcm4gPT0gdCguLi5hcmdzKSB8fCAwID09IGZubWF0Y2gocGF0dGVybiwgdCguLi5hcmdzKSwgRk5NX0VYVE1BVENIKTsKfQoKZnVuY3Rpb24gS2V5T3JWYWx1ZU1hdGNoZXIocGF0dGVybikgewogIGxldCBtYXRjaGVyID0gTWF0Y2hlcihwYXR0ZXJuKTsKICByZXR1cm4gKFtrZXksIHZhbHVlXSkgPT4gbWF0Y2hlcihrZXkpIHx8IG1hdGNoZXIodmFsdWUpOwp9CgpmdW5jdGlvbiBHZXRSb290RGlyZWN0b3JpZXMocGF0dGVybiA9ICcqJykgewogIHJldHVybiBhbGxvd2VkRGlycy5rZXlzKCkuZmlsdGVyKE1hdGNoZXIocGF0dGVybikpOwp9Cgpjb25zdCBNYWtlVVVJRCA9IChybmcgPSBNYXRoLnJhbmRvbSkgPT4gWzgsIDQsIDQsIDQsIDEyXS5tYXAobiA9PiByYW5kU3RyKG4sICcwMTIzNDU2Nzg5YWJjZGVmJyksIHJuZykuam9pbignLScpOwoKY29uc3QgZGVmYXVsdERpcnMgPSAoZ2xvYmFsVGhpcy5kZWZhdWx0RGlycyA9IFsKICAnLicsCiAgLi4uZ2xvYignLi4vKi9lYWdsZScpLAogICcuL3VwbG9hZHMvKi57c2NoLGJyZCxsYnJ9JywKICAnL21udC9leHRleHQvUGhvdG9zLypBUFBMRS8qLntKUEcsUE5HLEdJRixBQUUsTU9WLEhFSUMsTVA0LFdFQlB9JywKICBbJy9ob21lL3JvbWFuL0JpbGRlcicsIG5ldyBSZWdFeHAoJy4oanBnfGpwZWd8cG5nfGhlaWN8dGlmfHRpZmYpJCcsICdpJyldCl0pOwoKY29uc3QgYWxsb3dlZERpcnMgPSAoZ2xvYmFsVGhpcy5hbGxvd2VkRGlycyA9IG5ldyBNYXAoCiAgZGVmYXVsdERpcnMKICAgIC5tYXAoZGQgPT4gR2V0RGlyKEFycmF5LmlzQXJyYXkoZGQpID8gZGRbMF0gOiBkZCkpCiAgICAubWFwKGQgPT4gcGF0aC5yZXNvbHZlKGQpKQogICAgLm1hcChkID0+IHBhdGgucmVsYXRpdmUoZCkpCiAgICAubWFwKGQgPT4gW0Rpck5hbWUoZCksIGRdKQopKTsKCmZ1bmN0aW9uIEdldERpcihkaXIpIHsKICBsZXQgYSA9IHBhdGgudG9BcnJheShkaXIpOwogIGxldCBpID0gYS5maW5kSW5kZXgobiA9PiAvWyp7fV0vLnRlc3QobikpOwogIHJldHVybiBpICE9IC0xID8gcGF0aC5zbGljZShkaXIsIDAsIGkpIDogZGlyOwp9CgpmdW5jdGlvbiBEaXJOYW1lKG5hbWUpIHsKICBsZXQgcCA9IHBhdGgucmVsYXRpdmUobmFtZSk7CgogIHAgPSBwYXRoLnNsaWNlKAogICAgcCwKICAgIHBhdGgudG9BcnJheShwKS5maW5kSW5kZXgoaXQgPT4gaXQgIT0gJy4uJykKICApOwogIHJldHVybiBwOwp9CmZ1bmN0aW9uIERhdGVTdHIoZGF0ZSkgewogIGxldCBzdHIgPSBkYXRlLnRvSVNPU3RyaW5nKCk7CiAgbGV0IHRpID0gc3RyLmluZGV4T2YoJ1QnKTsKICByZXR1cm4gKAogICAgc3RyLnN1YnN0cmluZygwLCB0aSkgLyoucmVwbGFjZSgvLS9nLCAnJykqLyArICcgJyArIHN0ci5zdWJzdHJpbmcodGkgKyAxLCB0aSArIDEgKyA4KSAvLy5yZXBsYWNlKC86L2csICcnKQogICk7Cn0KCmZ1bmN0aW9uIE1vZGVTdHIobW9kZSkgewogIHJldHVybiAoCiAgICAobW9kZSAmICgwbzEyMDAwMCA9PSAwbzEyMDAwMCkgPyAnbCcgOiBtb2RlICYgMG80MDAwMCA/ICdkJyA6ICctJykgKwogICAgKG1vZGUgJiAwYjEwMDAwMDAwMCA/ICdyJyA6ICctJykgKwogICAgKG1vZGUgJiAwYjAxMDAwMDAwMCA/ICd3JyA6ICctJykgKwogICAgKG1vZGUgJiAwYjAwMTAwMDAwMCA/ICd4JyA6ICctJykgKwogICAgKG1vZGUgJiAwYjEwMDAwMCA/ICdyJyA6ICctJykgKwogICAgKG1vZGUgJiAwYjAxMDAwMCA/ICd3JyA6ICctJykgKwogICAgKG1vZGUgJiAwYjAwMTAwMCA/ICd4JyA6ICctJykgKwogICAgKG1vZGUgJiAwYjEwMCA/ICdyJyA6ICctJykgKwogICAgKG1vZGUgJiAwYjAxMCA/ICd3JyA6ICctJykgKwogICAgKG1vZGUgJiAwYjAwMSA/ICd4JyA6ICctJykKICApOwp9Cgpjb25zdCBIVE1MUGFnZSA9ICh7IHRpdGxlLCBzdHlsZSwgc2NyaXB0cyA9IFtdLCBjaGlsZHJlbiwgLi4ucHJvcHMgfSkgPT4gewogIHJldHVybiBoKCdodG1sJywge30sIFsKICAgIGgoCiAgICAgICdoZWFkJywKICAgICAge30sCiAgICAgIFsKICAgICAgICBoKCd0aXRsZScsIHt9LCBbdGl0bGVdKSwKICAgICAgICAuLi4oc3R5bGUgPyBbaCgnc3R5bGUnLCB7IHR5cGU6ICd0ZXh0L2NzcycgfSwgW3N0eWxlXSldIDogW10pLAogICAgICAgIGgoCiAgICAgICAgICAnbGluaycsCiAgICAgICAgICB7CiAgICAgICAgICAgIHJlbDogJ3N0eWxlc2hlZXQnLAogICAgICAgICAgICBocmVmOiAnc3RhdGljL2Nzcy9saXN0LmNzcycKICAgICAgICAgIH0sCiAgICAgICAgICBbXQogICAgICAgICkKICAgICAgXS5jb25jYXQoc2NyaXB0cy5tYXAoc2NyaXB0ID0+IGgoJ3NjcmlwdCcsIHsgdHlwZTogJ21vZHVsZScsIHNyYzogc2NyaXB0IH0pKSkKICAgICksCiAgICBoKCdib2R5Jywge30sIGNoaWxkcmVuID8/IFtdKQogIF0pOwp9OwoKY29uc3QgRmlsdGVyRm9ybSA9ICh7IC4uLnByb3BzIH0pID0+CiAgaCgnZm9ybScsIHsgYWN0aW9uOiAnZmlsZScsIG1ldGhvZDogJ1BPU1QnIH0sIFsKICAgIGgoCiAgICAgICdpbnB1dCcsCiAgICAgIHsKICAgICAgICB0eXBlOiAndGV4dCcsCiAgICAgICAgc2l6ZTogMjAsCiAgICAgICAgbmFtZTogJ2ZpbHRlcicsCiAgICAgICAgdmFsdWU6ICcuKicgLyosCiAgICAgICAgICBvbmNoYW5nZTogZSA9PiB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvbmNoYW5nZScsIGUpOwogICAgICAgICAgfSovCiAgICAgIH0sCiAgICAgIFtdCiAgICApLAogICAgaCgnaW5wdXQnLCB7IHR5cGU6ICdzdWJtaXQnLCB2YWx1ZTogJ1N1Ym1pdCcsIGNsYXNzOiAnaGlkZGVuJyB9LCBbXSkKICBdKTsKCmNvbnN0IEhUTUxUYWJsZSA9ICh7IHJvd3MsIC4uLnByb3BzIH0pID0+IGgoJ3RhYmxlJywgcHJvcHMsIHJvd3MpOwpjb25zdCBIVE1MVGFibGVSb3cgPSAoeyBjb2x1bW5zLCAuLi5wcm9wcyB9KSA9PiBoKCd0cicsIHByb3BzLCBjb2x1bW5zKTsKY29uc3QgSFRNTFRhYmxlQ29sdW1uID0gKHsgY29sdW1ucywgY2hpbGRyZW4sIHRhZyA9ICd0ZCcsIC4uLnByb3BzIH0pID0+IGgodGFnLCBwcm9wcywgY2hpbGRyZW4pOwoKY29uc3QgRmlsZUxpbmsgPSAoeyBmaWxlLCAuLi5wcm9wcyB9KSA9PiB7CiAgcmV0dXJuIGgoJ2EnLCB7IGhyZWY6ICdmaWxlL3VwbG9hZHMvJyArIGZpbGUgfSwgW2ZpbGVdKTsKfTsKY29uc3QgRmlsZU9iamVjdCA9ICh7IGZpbGUsIHN0YXQgPSB7fSwgLi4ucHJvcHMgfSkgPT4gewogIHN0YXQgPz89IGZzLmxzdGF0U3luYygndXBsb2Fkcy8nICsgZmlsZSk7CiAgLy8gY29uc29sZS5sb2coJ0ZpbGVPYmplY3QnLCB7IGZpbGUsIHN0YXQgfSk7CiAgbGV0IGlzRGlyID0gc3RhdC5pc0RpcmVjdG9yeSgpOwoKICByZXR1cm4gaChIVE1MVGFibGVSb3csIHt9LCBbCiAgICBoKEhUTUxUYWJsZUNvbHVtbiwgeyBjbGFzczogJ21vZGUnIH0sIFsKICAgICAgLy8oc3RhdC5tb2RlICYgMGIxMTExMTExMTEpLnRvU3RyaW5nKDgpLAogICAgICBNb2RlU3RyKHN0YXQubW9kZSkKICAgIF0pLAogICAgaChIVE1MVGFibGVDb2x1bW4sIHsgY2xhc3M6ICdmaWxlJyB9LCBbaChGaWxlTGluaywgeyBmaWxlOiBmaWxlICsgKGlzRGlyID8gJy8nIDogJycpIH0sIFtdKV0pLAogICAgaChIVE1MVGFibGVDb2x1bW4sIHsgY2xhc3M6ICdzaXplJyB9LCBbc3RhdC5zaXplICsgJyddKSwKICAgIGgoSFRNTFRhYmxlQ29sdW1uLCB7IGNsYXNzOiAnZGF0ZScgfSwgW0RhdGVTdHIobmV3IERhdGUoc3RhdC5hdGltZSkpXSkKICBdKTsKfTsKCmNvbnN0IEZpbGVUYWJsZSA9ICh7IGZpbGVzLCAuLi5wcm9wcyB9KSA9PiB7CiAgLy9jb25zb2xlLmxvZygnRmlsZVRhYmxlJywgZmlsZXMpOwoKICBsZXQgZmllbGRzID0gWydtb2RlJywgJ2ZpbGUnLCAnc2l6ZScsICdhdGltZSddOwoKICBmaWxlcyA9IGZpbGVzLnNvcnQoKGEsIGIpID0+IGEuZmlsZS5sb2NhbGVDb21wYXJlKGIuZmlsZSkpOwoKICByZXR1cm4gaCgKICAgIEhUTUxUYWJsZSwKICAgIHsKICAgICAgLi4ucHJvcHMsCiAgICAgIGNlbGxzcGFjaW5nOiAwLAogICAgICBjZWxscGFkZGluZzogMCwKICAgICAgYm9yZGVyOiAwLAogICAgICByb3dzOiBbCiAgICAgICAgaCgKICAgICAgICAgIEhUTUxUYWJsZVJvdywKICAgICAgICAgIHsKICAgICAgICAgICAgY29sdW1uczogZmllbGRzLm1hcChmaWVsZCA9PiBoKEhUTUxUYWJsZUNvbHVtbiwgeyB0YWc6ICd0aCcgfSwgW2ZpZWxkXSkpCiAgICAgICAgICB9LAogICAgICAgICAgW10KICAgICAgICApCiAgICAgIF0uY29uY2F0KGZpbGVzLm1hcChmaWxlID0+IGgoRmlsZU9iamVjdCwgZmlsZSwgW10pKSkKICAgIH0sCiAgICBbXQogICk7Cn07CgpmdW5jdGlvbiBSZWFkRXhpdjIoZmlsZSkgewogIGNvbnNvbGUubG9nKCdSZWFkRXhpdjInLCBmaWxlKTsKICBsZXQgW3JkZiwgc3Rkb3V0XSA9IG9zLnBpcGUoKTsKICBvcy5leGVjKFsnZXhpdjInLCAnLWUnLCAnWC0nLCAnZXgnLCBmaWxlXSwgeyBzdGRvdXQgfSk7CiAgb3MuY2xvc2Uoc3Rkb3V0KTsKICBsZXQgeG1wZGF0ID0gZnMucmVhZEFsbFN5bmMocmRmKTsKICBmcy5jbG9zZVN5bmMocmRmKTsKICAvLyBjb25zb2xlLmxvZygneG1wZGF0JywgeG1wZGF0KTsKICBsZXQgeG1wID0geG1sLnJlYWQoeG1wZGF0KTsKICAvLyBjb25zb2xlLmxvZygneG1wJywgeG1wKTsKICBsZXQgZmxhdCA9IE9iamVjdC5mcm9tRW50cmllcygKICAgIGRlZXAKICAgICAgLmZsYXR0ZW4oeG1wLCBbXSkKICAgICAgLmZpbHRlcigoW2ssIHZdKSA9PiB2ICE9PSAnJyAmJiAvYXR0cmlidXRlcy4qOi8udGVzdChrKSAmJiAhL1wueG1sbnMvLnRlc3QoaykgJiYgIWlzT2JqZWN0KHYpKQogICAgICAuZmlsdGVyKChbaywgdl0pID0+IC8oR1BTfFtYWV1EaW18W1hZXVJlc3xEYXRlJHxNYWtlJHxNb2RlbCQpLy50ZXN0KGspKQogICAgICAubWFwKChbaywgdl0pID0+IFtrLnJlcGxhY2UoLy4qXC5hdHRyaWJ1dGVzXC4vZywgJycpLCB2XSkKICAgICAgLnNvcnQoKGEsIGIpID0+IGFbMF0ubG9jYWxlQ29tcGFyZShiWzBdKSkKICAgICAgLm1hcCgoW2ssIHZdKSA9PiBbaywgaXNOYU4oK3YpID8gKGlzTmFOKERhdGUucGFyc2UodikpID8gdiA6IG5ldyBEYXRlKHYpKSA6ICt2XSkKICApOwogIHJldHVybiBmbGF0Owp9CgpmdW5jdGlvbiBSZWFkRXhpZnRvb2woZmlsZSkgewogIGNvbnNvbGUubG9nKCdSZWFkRXhpZnRvb2wnLCBmaWxlKTsKCiAgbGV0IFtyZXQsIG91dF0gPSBFeGVjdXRlKCdleGlmdG9vbCcsICctUycsICctZWUnLCBmaWxlKTsKCiAgbGV0IGEgPSBvdXQuc3BsaXQoL1xyP1xuL2cpLmZpbHRlcihsID0+IGwgIT0gJycpOwoKICBhID0gYS5tYXAobGluZSA9PiBbbGluZSwgbGluZS5pbmRleE9mKCc6ICcpXSkubWFwKChbbGluZSwgaWR4XSkgPT4gW2xpbmUuc2xpY2UoMCwgaWR4KSwgbGluZS5zbGljZShpZHggKyAyKV0pOwogIGxldCBvID0gT2JqZWN0LmZyb21FbnRyaWVzKGEpOwoKICAvL2NvbnNvbGUubG9nKCdSZWFkRXhpZnRvb2wnLG8pOwogIHJldHVybiBvOwp9CgpmdW5jdGlvbiBIZWlmQ29udmVydChzcmMsIGRzdCwgcXVhbGl0eSA9IDEwMCkgewogIGNvbnNvbGUubG9nKCdIZWlmQ29udmVydCcsIHNyYywgZHN0KTsKICBsZXQgYXJncyA9IFsnaGVpZi1jb252ZXJ0JywgJy1xJywgcXVhbGl0eSArICcnLCBzcmMsIGRzdF07CiAgbGV0IFtyZXQsIG91dF0gPSBFeGVjdXRlKC4uLmFyZ3MpOwoKICBjb25zb2xlLmxvZygnSGVpZkNvbnZlcnQnLCB7IGFyZ3MsIHJldCwgb3V0IH0pOwogIHJldHVybiBbcmV0LCBvdXRdOwp9CgpmdW5jdGlvbiBNYWdpY2tSZXNpemUoc3JjLCBkc3QsIHJvdGF0ZSA9IDAsIHdpZHRoLCBoZWlnaHQpIHsKICBjb25zb2xlLmxvZygnTWFnaWNrUmVzaXplJywgewogICAgd2lkdGgsCiAgICBoZWlnaHQsCiAgICBkc3QsCiAgICByb3RhdGUKICB9KTsKICBsZXQgYXJncyA9IFsnY29udmVydCcsIHNyYywgJy1yZXNpemUnLCB3aWR0aCArICd4JyArIGhlaWdodCwgLi4uKHJvdGF0ZSA/IFsnLXJvdGF0ZScsICctJyArIHJvdGF0ZV0gOiBbXSksIGRzdF07CiAgbGV0IFtyZXQsIG91dF0gPSBFeGVjdXRlKC4uLmFyZ3MpOwoKICBjb25zb2xlLmxvZygnTWFnaWNrUmVzaXplJywgeyBhcmdzLCByZXQsIG91dCB9KTsKICByZXR1cm4gW3JldCwgb3V0XTsKfQoKZnVuY3Rpb24gbWFpbiguLi5hcmdzKSB7CiAgY29uc3QgYmFzZSA9IHBhdGguYmFzZW5hbWUoc2NyaXB0QXJnc1swXSwgJy5qcycpLnJlcGxhY2UoL1wuW2Etel0qJC8sICcnKTsKICBjb25zdCBjb25maWcgPSBSZWFkSlNPTihgLiR7YmFzZX0tY29uZmlnYCkgPz8ge307CgogIGdsb2JhbFRoaXMuY29uc29sZSA9IG5ldyBDb25zb2xlKHsKICAgIGluc3BlY3RPcHRpb25zOiB7CiAgICAgIGNvbXBhY3Q6IDIsCiAgICAgIGRlcHRoOiBJbmZpbml0eSwKICAgICAgY3VzdG9tSW5zcGVjdDogdHJ1ZSwKICAgICAgbWF4QXJyYXlMZW5ndGg6IDIwMAogICAgfQogIH0pOwogIGxldCBwYXJhbXMgPSBnZXRPcHQoCiAgICB7CiAgICAgIHZlcmJvc2U6IFtmYWxzZSwgKGEsIHYpID0+ICh2IHwgMCkgKyAxLCAndiddLAogICAgICBsaXN0ZW46IFtmYWxzZSwgbnVsbCwgJ2wnXSwKICAgICAgY29ubmVjdDogW2ZhbHNlLCBudWxsLCAnYyddLAogICAgICBjbGllbnQ6IFtmYWxzZSwgbnVsbCwgJ0MnXSwKICAgICAgc2VydmVyOiBbZmFsc2UsIG51bGwsICdTJ10sCiAgICAgIGRlYnVnOiBbZmFsc2UsIG51bGwsICd4J10sCiAgICAgIHRsczogW2ZhbHNlLCBudWxsLCAndCddLAogICAgICAnbm8tdGxzJzogW2ZhbHNlLCAodiwgcHYsIG8pID0+ICgoby50bHMgPSBmYWxzZSksIHRydWUpLCAnVCddLAogICAgICBhZGRyZXNzOiBbdHJ1ZSwgbnVsbCwgJ2EnXSwKICAgICAgcG9ydDogW3RydWUsIG51bGwsICdwJ10sCiAgICAgICdzc2wtY2VydCc6IFt0cnVlLCBudWxsXSwKICAgICAgJ3NzbC1wcml2YXRlLWtleSc6IFt0cnVlLCBudWxsXSwKICAgICAgJ0AnOiAnYWRkcmVzcyxwb3J0JwogICAgfSwKICAgIGFyZ3MKICApOwogIGlmKHBhcmFtc1snbm8tdGxzJ10gPT09IHRydWUpIHBhcmFtcy50bHMgPSBmYWxzZTsKCiAgY29uc3QgewogICAgYWRkcmVzcyA9ICcwLjAuMC4wJywKICAgIHBvcnQgPSA4OTk5LAogICAgJ3NzbC1jZXJ0Jzogc3NsQ2VydCA9ICdsb2NhbGhvc3QuY3J0JywKICAgICdzc2wtcHJpdmF0ZS1rZXknOiBzc2xQcml2YXRlS2V5ID0gJ2xvY2FsaG9zdC5rZXknCiAgfSA9IHBhcmFtczsKICBjb25zdCBsaXN0ZW4gPSBwYXJhbXMuY29ubmVjdCAmJiAhcGFyYW1zLmxpc3RlbiA/IGZhbHNlIDogdHJ1ZTsKICBjb25zdCBpc19zZXJ2ZXIgPSAhcGFyYW1zLmNsaWVudCB8fCBwYXJhbXMuc2VydmVyOwoKICBsZXQgbmFtZSA9IHByb2Nlc3MuZW52WydOQU1FJ10gPz8gYmFzZTsKCiAgbmFtZSA9IG5hbWUKICAgIC5yZXBsYWNlKC8uKlwvLywgJycpCiAgICAucmVwbGFjZSgvLS9nLCAnICcpCiAgICAucmVwbGFjZSgvXC5bXlwvLl0qJC8sICcnKTsKCiAgbGV0IFtwcmVmaXgsIHN1ZmZpeF0gPSBuYW1lLnNwbGl0KCcgJyk7CgogIGxldCByZXBsID0gbmV3IFJFUEwoYFx4MWJbMzg7NTsxNjVtJHtwcmVmaXh9IFx4MWJbMzg7NTszOW0ke3N1ZmZpeH1ceDFiWzBtYCwgZmFsc2UpOwogIGNvbnN0IGhpc3RmaWxlID0gJy51cGxvYWQtc2VydmVyLWhpc3RvcnknOwogIHJlcGwuaGlzdG9yeUxvYWQoaGlzdGZpbGUsIGZhbHNlKTsKICByZXBsLmxvYWRTYXZlT3B0aW9ucygpOwogIHJlcGwuZGlyZWN0aXZlcy5pID0gWwogICAgKG1vZHVsZSwgLi4uYXJncykgPT4gewogICAgICBjb25zb2xlLmxvZygnYXJncycsIGFyZ3MpOwogICAgICB0cnkgewogICAgICAgIHJldHVybiByZXF1aXJlKG1vZHVsZSk7CiAgICAgIH0gY2F0Y2goZSkge30KICAgICAgaW1wb3J0KG1vZHVsZSkudGhlbihtID0+IChnbG9iYWxUaGlzW21vZHVsZV0gPSBtKSk7CiAgICB9LAogICAgJ2ltcG9ydCBtb2R1bGUnCiAgXTsKCiAgbGV0IHsgbG9nIH0gPSBjb25zb2xlOwogIHJlcGwuc2hvdyA9IGFyZyA9PiBzdGQucHV0cygodHlwZW9mIGFyZyA9PSAnc3RyaW5nJyA/IGFyZyA6IGluc3BlY3QoYXJnLCBnbG9iYWxUaGlzLmNvbnNvbGUub3B0aW9ucykpICsgJ1xuJyk7CgogIHJlcGwuY2xlYW51cCA9ICgpID0+IHsKICAgIHJlcGwucmVhZGxpbmVSZW1vdmVQcm9tcHQoKTsKICAgIFRlcm1pbmFsLm1vdXNldHJhY2tpbmdEaXNhYmxlKCk7CiAgICBsZXQgbnVtTGluZXMgPSByZXBsLmhpc3RvcnlTYXZlKGhpc3RmaWxlKTsKCiAgICByZXBsLnByaW50U3RhdHVzKGBFWElUICh3cm90ZSAke251bUxpbmVzfSBoaXN0b3J5IGVudHJpZXMpYCwgZmFsc2UpOwoKICAgIHN0ZC5leGl0KDApOwogIH07CgogIHJlcGwuaW5zcGVjdE9wdGlvbnMgPSB7CiAgICAuLi4ocmVwbC5pbnNwZWN0T3B0aW9ucyA/PyBjb25zb2xlLm9wdGlvbnMpLAogICAgZGVwdGg6IEluZmluaXR5LAogICAgY29tcGFjdDogZmFsc2UKICB9OwoKICBjb25zb2xlLmxvZyA9ICguLi5hcmdzKSA9PiByZXBsLnByaW50U3RhdHVzKCgpID0+IGxvZyhjb25zb2xlLmNvbmZpZyhyZXBsLmluc3BlY3RPcHRpb25zKSwgLi4uYXJncykpOwoKICBsZXQgbG9nRmlsZSA9CiAgICB7CiAgICAgIHB1dHMocykgewogICAgICAgIHJlcGwucHJpbnRTdGF0dXMoKCkgPT4gc3RkLnB1dHMocykpOwogICAgICB9CiAgICB9ID8/IHN0ZC5vcGVuKCd1cGxvYWQtc2VydmVyLmxvZycsICd3KycpOwoKICBsZXQgY29ubmVjdGlvbnMgPSBuZXcgU2V0KCk7CiAgbGV0IGJ5X3V1aWQgPSB7fTsKCiAgZnVuY3Rpb24gUGFyc2VCb2R5KGdlbikgewogICAgbGV0IHByb20sCiAgICAgIG8gPSAnJywKICAgICAgeDsKCiAgICB3aGlsZSgoeCA9IGdlbi5uZXh0KCkpKSB7CiAgICAgIGxldCB7IHZhbHVlLCBkb25lIH0gPSB4OwogICAgICBvICs9IHZhbHVlOwogICAgfQogICAgcmV0dXJuIG87CiAgfQoKICBjb25zdCBjcmVhdGVXUyA9IChnbG9iYWxUaGlzLmNyZWF0ZVdTID0gKHVybCwgY2FsbGJhY2tzLCBsaXN0ZW4pID0+IHsKICAgIC8vY29uc29sZS5sb2coJ2NyZWF0ZVdTJywgeyB1cmwsIGNhbGxiYWNrcywgbGlzdGVuIH0pOwoKICAgIGdsb2JhbFRoaXMub3V0ID0gcyA9PiBsb2dGaWxlLnB1dHMocyArICdcbicpOwoKICAgIGxvZ0xldmVsID0gKHBhcmFtcy5kZWJ1ZyA/IExMTF9VU0VSIDogMCkgfCAoKChwYXJhbXMuZGVidWcgPyBMTExfSU5GTyA6IExMTF9XQVJOKSA8PCAxKSAtIDEpOwogICAgY29uc29sZS5sb2coJ2NyZWF0ZVdTJywgeyBsb2dMZXZlbCB9KTsKCiAgICByZXR1cm4gW2NsaWVudCwgc2VydmVyXVsrbGlzdGVuXSh7CiAgICAgIGJsb2NrOiBmYWxzZSwKICAgICAgdGxzOiBwYXJhbXMudGxzLAogICAgICBzc2xDZXJ0LAogICAgICBzc2xQcml2YXRlS2V5LAogICAgICBtaW1ldHlwZXM6IFsKICAgICAgICBbJy5zdmd6JywgJ2FwcGxpY2F0aW9uL2d6aXAnXSwKICAgICAgICBbJy5tanMnLCAnYXBwbGljYXRpb24vamF2YXNjcmlwdCddLAogICAgICAgIFsnLmpzJywgJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnXSwKICAgICAgICBbJy53YXNtJywgJ2FwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSddLAogICAgICAgIFsnLmVvdCcsICdhcHBsaWNhdGlvbi92bmQubXMtZm9udG9iamVjdCddLAogICAgICAgIFsnLmxpYicsICdhcHBsaWNhdGlvbi94LWFyY2hpdmUnXSwKICAgICAgICBbJy5iejInLCAnYXBwbGljYXRpb24veC1iemlwMiddLAogICAgICAgIFsnLmdpdGlnbm9yZScsICd0ZXh0L3BsYWluJ10sCiAgICAgICAgWycuY21ha2UnLCAndGV4dC9wbGFpbiddLAogICAgICAgIFsnLmhleCcsICd0ZXh0L3BsYWluJ10sCiAgICAgICAgWycubWQnLCAndGV4dC9wbGFpbiddLAogICAgICAgIFsnLnBieHByb2onLCAndGV4dC9wbGFpbiddLAogICAgICAgIFsnLndhdCcsICd0ZXh0L3BsYWluJ10sCiAgICAgICAgWycuYycsICd0ZXh0L3gtYyddLAogICAgICAgIFsnLmgnLCAndGV4dC94LWMnXSwKICAgICAgICBbJy5jcHAnLCAndGV4dC94LWMrKyddLAogICAgICAgIFsnLmhwcCcsICd0ZXh0L3gtYysrJ10sCiAgICAgICAgWycuZmlsdGVycycsICd0ZXh0L3htbCddLAogICAgICAgIFsnLnBsaXN0JywgJ3RleHQveG1sJ10sCiAgICAgICAgWycuc3Rvcnlib2FyZCcsICd0ZXh0L3htbCddLAogICAgICAgIFsnLnZjeHByb2onLCAndGV4dC94bWwnXSwKICAgICAgICBbJy5iYXQnLCAndGV4dC94LW1zZG9zLWJhdGNoJ10sCiAgICAgICAgWycubW0nLCAndGV4dC94LW9iamVjdGl2ZS1jJ10sCiAgICAgICAgWycubScsICd0ZXh0L3gtb2JqZWN0aXZlLWMnXSwKICAgICAgICBbJy5zaCcsICd0ZXh0L3gtc2hlbGxzY3JpcHQnXQogICAgICBdLAogICAgICBtb3VudHM6IFsKICAgICAgICBbJy8nLCAnLicsICd1cGxvYWQuaHRtbCddLAogICAgICAgIFsnL2dldCcsICcuL3VwbG9hZHMnLCAnJ10sCiAgICAgICAgWycvd2FybWNhdCcsICdodHRwczovL3dhcm1jYXQuY29tLycsICdpbmRleC5odG1sJ10sCiAgICAgICAgWycvZGlzdHJlbGVjJywgJ2h0dHBzOi8vd3d3LmRpc3RyZWxlYy5jaC8nLCAnbG9naW4nXSwKICAgICAgICBbJy9oYXN1cmEnLCAnaHR0cDovL3dpbGQtYmVhdXR5Lmhlcm9rdWFwcC5jb20vdjEvJywgJ2dyYXBocWwnXSwKICAgICAgICAvLyBbJy91cGxvYWQnLCAnbHdzLWRlYWRkcm9wJywgbnVsbCwgJ2x3cy1kZWFkZHJvcCddLAogICAgICAgIGFzeW5jIGZ1bmN0aW9uKiB0ZXN0KHJlcSwgcmVzcCkgewogICAgICAgICAgcmVzcC50eXBlID0gJ3RleHQvcGxhaW4nOwoKICAgICAgICAgIGNvbnNvbGUubG9nKCcqdGVzdCcsIHsgcmVxLCByZXNwIH0pOwoKICAgICAgICAgIGxldCBib2R5U3RyID0gJyc7CiAgICAgICAgICBpZihyZXEubWV0aG9kID09ICdQT1NUJykgewogICAgICAgICAgICBmb3IgYXdhaXQobGV0IGNodW5rIG9mIGF3YWl0IHJlcS5ib2R5KSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NodW5rJywgY2h1bmspOwogICAgICAgICAgICAgIGJvZHlTdHIgKz0gdG9TdHJpbmcoY2h1bmspOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBjb25zb2xlLmxvZygnYm9keVN0cicsIGJvZHlTdHIpOwoKICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7CiAgICAgICAgICAgIHlpZWxkIGBsaW5lICMke2l9XG5gOwogICAgICAgICAgICBhd2FpdCB3YWl0Rm9yKCgxMCAtIGkgKyAxKSAqIDEwKTsKICAgICAgICAgIH0KCiAgICAgICAgICB5aWVsZCAnZG9uZSEnOwogICAgICAgIH0sCiAgICAgICAgZnVuY3Rpb24gcHJveHkocmVxLCByZXNwKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygncHJveHknLCB7IHJlcSwgcmVzcCB9KTsKICAgICAgICAgIGNvbnN0IHsgdXJsLCBtZXRob2QsIGhlYWRlcnMgfSA9IHJlcTsKICAgICAgICAgIGNvbnNvbGUubG9nKCdwcm94eScsIHsgdXJsLCBtZXRob2QsIGhlYWRlcnMgfSk7CiAgICAgICAgICBjb25zdCB7IHN0YXR1cywgb2ssIHR5cGUgfSA9IHJlc3A7CgogICAgICAgICAgY29uc29sZS5sb2coJ3Byb3h5JywgeyBzdGF0dXMsIG9rLCB1cmwsIHR5cGUgfSk7CiAgICAgICAgfSwKICAgICAgICBmdW5jdGlvbiogY29uZmlnKHJlcSwgcmVzcCkgewogICAgICAgICAgY29uc29sZS5sb2coJypjb25maWcnLCB7IHJlcSwgcmVzcCB9KTsKICAgICAgICAgIHlpZWxkICd7fSc7CiAgICAgICAgfSwKICAgICAgICBmdW5jdGlvbiogZmlsZShyZXEsIHJlc3ApIHsKICAgICAgICAgIGxldCB7IGJvZHksIGhlYWRlcnMsIGpzb24sIHVybCB9ID0gcmVxOwogICAgICAgICAgbGV0IHsgcXVlcnkgfSA9IHVybDsKCiAgICAgICAgICBpZih0eXBlb2YgYm9keSA9PSAnc3RyaW5nJykKICAgICAgICAgICAgcXVlcnkgPSB7CiAgICAgICAgICAgICAgLi4ucXVlcnksCiAgICAgICAgICAgICAgLi4uKEpTT04ucGFyc2UoYm9keSkgPz8ge30pCiAgICAgICAgICAgIH07CgogICAgICAgICAgbGV0IHsgYWN0aW9uID0gJ2xpc3QnLCBjaGFyc2V0ID0gJ3V0Zi04JywgYmluYXJ5ID0gZmFsc2UsIGZpbGUsIGNvbnRlbnRzIH0gPSBxdWVyeSA/PyB7fTsKCiAgICAgICAgICBpZigvXlwvZmlsZVwvLi8udGVzdCh1cmwucGF0aCkpIHsKICAgICAgICAgICAgZmlsZSA9IHVybC5wYXRoLnJlcGxhY2UoL15cL2ZpbGVcLy8sICcnKTsKICAgICAgICAgICAgYWN0aW9uID0gJ2xvYWQnOwogICAgICAgICAgfQogICAgICAgICAgY29uc29sZS5sb2coJypmaWxlJywgeyBxdWVyeSwgYm9keSwgZmlsZSB9KTsKCiAgICAgICAgICBjb25zb2xlLmxvZyhgKmZpbGVgLCB7IGFjdGlvbiwgZmlsZSB9KTsKCiAgICAgICAgICBpZihmaWxlKSB7CiAgICAgICAgICAgIGZpbGUgPSBwYXRoLmFic29sdXRlKGZpbGUpOwogICAgICAgICAgICBmaWxlID0gcGF0aC5jb2xsYXBzZShmaWxlKTsKICAgICAgICAgICAgY29uc29sZS5sb2coCiAgICAgICAgICAgICAgYGFsbG93ZWREaXJzOmAsCiAgICAgICAgICAgICAgYWxsb3dlZERpcnMgLy8ubWFwKGRpciA9PiBwYXRoLm5vcm1hbGl6ZShkaXIpKQogICAgICAgICAgICApOwoKICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhgYWxsb3dlZDpgLCBhbGxvd2VkRGlycy8qLm1hcChkaXIgPT4gcGF0aC5pc2luKGZpbGUsIGRpcikpKi8pOwogICAgICAgICAgICBsZXQgYWxsb3dlZCA9IFsuLi5hbGxvd2VkRGlyc10uc29tZSgoW2Rpcl0pID0+IHBhdGguaXNpbihmaWxlLCBwYXRoLm5vcm1hbGl6ZShkaXIpKSk7CgogICAgICAgICAgICBpZighYWxsb3dlZCkgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBOb3QgYWxsb3dlZDogJyR7ZmlsZX0nYCk7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBOb3QgYWxsb3dlZDogJyR7ZmlsZX0nYCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBzd2l0Y2ggKGFjdGlvbikgewogICAgICAgICAgICBjYXNlICdsb2FkJzoKICAgICAgICAgICAgICBsZXQgbWltZSA9IEdldE1pbWUoZmlsZSk7CiAgICAgICAgICAgICAgcmVzcC50eXBlID0gbWltZTsKICAgICAgICAgICAgICByZXNwLmhlYWRlcnMgPSB7ICdjb250ZW50LXR5cGUnOiBtaW1lIH07CiAgICAgICAgICAgICAgbGV0IGRhdGEgPSBmcy5yZWFkRmlsZVN5bmMoZmlsZSwgMSB8IGJpbmFyeSA/IG51bGwgOiBjaGFyc2V0KTsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgKmZpbGUubG9hZGAsIHsgZGF0YSwgbWltZSB9KTsKICAgICAgICAgICAgICB5aWVsZCBkYXRhOwogICAgICAgICAgICAgIHJlc3AuYm9keSA9IGRhdGE7CiAgICAgICAgICAgICAgLy95aWVsZAogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICdzYXZlJzoKICAgICAgICAgICAgICBmcy53cml0ZUZpbGVTeW5jKGZpbGUsIGNvbnRlbnRzKTsKICAgICAgICAgICAgICB5aWVsZCAnZG9uZSFcclxuJzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnbGlzdCc6CiAgICAgICAgICAgICAgbGV0IGZpbGVzID0gZnMucmVhZGRpclN5bmMoJ3VwbG9hZHMnKS5maWx0ZXIoZiA9PiAhL15cLiQvLnRlc3QoZikpOwogICAgICAgICAgICAgIGxldCBjb21wb25lbnQgPSBoKAogICAgICAgICAgICAgICAgSFRNTFBhZ2UsCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiAnRmlsZSBsaXN0JywKICAgICAgICAgICAgICAgICAgc3R5bGU6IGBib2R5LCAqIHsKICBmb250LWZhbWlseTogTWlzY0ZpeGVkU0M2MTMsRml4ZWQsIkNvdXJpZXIgTmV3IjsKfWAsCiAgICAgICAgICAgICAgICAgIHNjcmlwdHM6IFsnZmlsZWxpc3QuanMnXQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIFsKICAgICAgICAgICAgICAgICAgaChGaWx0ZXJGb3JtLCB7fSwgW10pLAogICAgICAgICAgICAgICAgICBoKEZpbGVUYWJsZSwgewogICAgICAgICAgICAgICAgICAgIGZpbGVzOiBmaWxlcy5tYXAoZmlsZSA9PiAoewogICAgICAgICAgICAgICAgICAgICAgZmlsZSwKICAgICAgICAgICAgICAgICAgICAgIHN0YXQ6IGZzLnN0YXRTeW5jKGZpbGUpCiAgICAgICAgICAgICAgICAgICAgfSkpCiAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICBdCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB5aWVsZCByZW5kZXJUb1N0cmluZyhjb21wb25lbnQpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIHlpZWxkIGZpbGVzLmpvaW4oJ1xuJyk7CgogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gc3VjaCBjb21tYW5kOiAnJHthY3Rpb259J2ApOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgZnVuY3Rpb24qIHVwbG9hZHMocmVxLCByZXNwKSB7CiAgICAgICAgICByZXNwLnR5cGUgPSAnYXBwbGljYXRpb24vanNvbic7CiAgICAgICAgICBjb25zb2xlLmxvZygndXBsb2FkcycsIHJlcSwgcmVzcCk7CiAgICAgICAgICBjb25zdCB7IGxpbWl0ID0gJzAsMTAwJywgcHJldHR5ID0gMCB9ID0gcmVxLnVybC5xdWVyeSA/PyB7fTsKICAgICAgICAgIGxldCBbc3RhcnQsIGVuZF0gPSBsaW1pdC5zcGxpdCgvLC9nKS5tYXAocyA9PiArcyk7CiAgICAgICAgICBjb25zb2xlLmxvZygndXBsb2FkcycsIHsgc3RhcnQsIGVuZCB9KTsKICAgICAgICAgIGxldCByZXN1bHQgPSBbXSwKICAgICAgICAgICAgZW50cmllcyA9IGdsb2IoJ3VwbG9hZHMvKi5qc29uJyk7CiAgICAgICAgICBmb3IobGV0IGVudHJ5IG9mIChBcnJheS5pc0FycmF5KGVudHJpZXMpID8gZW50cmllcyA6IFtdKS5zbGljZShzdGFydCwgZW5kKSkgewogICAgICAgICAgICBsZXQganNvbiA9IFJlYWRKU09OKGVudHJ5KTsKICAgICAgICAgICAgY29uc3QgeyBzdG9yYWdlLCBmaWxlbmFtZSwgdXBsb2FkZWQsIGFkZHJlc3MsIGV4aWYsIHRodW1ibmFpbCB9ID0ganNvbjsKICAgICAgICAgICAganNvbi5zaXplID0gZnMuc2l6ZVN5bmMoc3RvcmFnZSk7CiAgICAgICAgICAgIHJlc3VsdC5wdXNoKGpzb24pOwogICAgICAgICAgfQoKICAgICAgICAgIGNvbnNvbGUubG9nKCd1cGxvYWRzJywgY29uc29sZS5jb25maWcoeyBkZXB0aDogMSwgY29tcGFjdDogMiwgbWF4QXJyYXlMZW5ndGg6IDEwIH0pLCByZXN1bHQpOwogICAgICAgICAgeWllbGQgSlNPTi5zdHJpbmdpZnkocmVzdWx0LCAuLi4oK3ByZXR0eSA/IFtudWxsLCAyXSA6IFtdKSk7CiAgICAgICAgfSwKICAgICAgICBhc3luYyBmdW5jdGlvbiogZmlsZXMocmVxLCByZXNwKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnKmZpbGVzIHF1ZXJ5ID0nLCByZXEudXJsLnF1ZXJ5KTsKICAgICAgICAgIGNvbnN0IHsgZmlsdGVyID0gJyonLCByb290LCB0eXBlID0gVFlQRV9ESVIgfCBUWVBFX1JFRyB8IFRZUEVfTE5LLCBsaW1pdCA9ICcwJyB9ID0gcmVxLnVybC5xdWVyeTsKICAgICAgICAgIGNvbnNvbGUubG9nKCcqZmlsZXMnLCB7IHJvb3QsIGZpbHRlciwgdHlwZSB9KTsKICAgICAgICAgIGNvbnN0IFtvZmZzZXQgPSAwLCBzaXplID0gSW5maW5pdHldID0gbGltaXQuc3BsaXQoJywnKS5tYXAobiA9PiArbik7CiAgICAgICAgICBjb25zb2xlLmxvZygnKmZpbGVzJywgeyBvZmZzZXQsIHNpemUgfSk7CiAgICAgICAgICBsZXQgaSA9IDA7CiAgICAgICAgICBsZXQgZiA9IE1hdGNoZXIoZmlsdGVyKTsKICAgICAgICAgIGlmKCFyb290KSB7CiAgICAgICAgICAgIGZvcihsZXQgbmFtZSBvZiBhbGxvd2VkRGlycy5rZXlzKCkuZmlsdGVyKGYpKSB5aWVsZCBuYW1lICsgJy9cclxuJzsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGZvcihsZXQgW2tleSwgdmFsdWVdIG9mIGFsbG93ZWREaXJzLmVudHJpZXMoKS5maWx0ZXIoS2V5T3JWYWx1ZU1hdGNoZXIocm9vdCkpKSB7CiAgICAgICAgICAgICAgbGV0IGRpciA9IG5ldyBEaXJlY3RvcnkodmFsdWUsIEJPVEgsICt0eXBlKTsKICAgICAgICAgICAgICB5aWVsZCBrZXkgKyAnOlxyXG4nOwogICAgICAgICAgICAgIGZvcihsZXQgW25hbWUsIHR5cGVdIG9mIGRpci5maWx0ZXIoKFtuYW1lLCB0eXBlXSkgPT4gZihuYW1lKSkpCiAgICAgICAgICAgICAgICB5aWVsZCBuYW1lICsgKCt0eXBlID09IFRZUEVfRElSID8gJy8nIDogJycpICsgJ1xyXG4nOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBjb25zb2xlLmxvZygnKmZpbGVzJywgeyBpLCBmIH0pOwogICAgICAgIH0sCiAgICAgICAgZnVuY3Rpb24qIGZpbGVzMihyZXEsIHJlc3ApIHsKICAgICAgICAgIGxldCB7IGJvZHksIGhlYWRlcnMsIGpzb24sIHVybCB9ID0gcmVxOwogICAgICAgICAgbGV0IHsgcXVlcnkgfSA9IHVybDsKICAgICAgICAgIGRlZmluZShnbG9iYWxUaGlzLCB7IGZpbGVzUmVxdWVzdDogeyByZXEsIHJlc3AsIGJvZHksIHF1ZXJ5IH0gfSk7CiAgICAgICAgICBjb25zb2xlLmxvZygnKmZpbGVzJywgeyByZXEsIHJlc3AsIGJvZHksIHF1ZXJ5IH0pOwogICAgICAgICAgY29uc3QgZGF0YSA9IHF1ZXJ5ID8/IHt9OwogICAgICAgICAgcmVzcC50eXBlID0gJ2FwcGxpY2F0aW9uL2pzb24nOwogICAgICAgICAgbGV0IHsKICAgICAgICAgICAgZGlycyA9IGRlZmF1bHREaXJzLAogICAgICAgICAgICBmaWx0ZXIgPSAnW14uXS4qJyA/PyAnLihicmR8c2NofEdbQS1aXVtBLVpdKSQnLAogICAgICAgICAgICB2ZXJib3NlID0gZmFsc2UsCiAgICAgICAgICAgIG9iamVjdHMgPSB0cnVlLAogICAgICAgICAgICBrZXkgPSAnbXRpbWUnLAogICAgICAgICAgICBsaW1pdCA9IG51bGwsCiAgICAgICAgICAgIGZsYXQgPSBmYWxzZQogICAgICAgICAgfSA9IGRhdGEgPz8ge307CiAgICAgICAgICBsZXQgcmVzdWx0cyA9IFtdOwogICAgICAgICAgZm9yKGxldCBkaXIgb2YgZGlycykgewogICAgICAgICAgICBsZXQgc3QsCiAgICAgICAgICAgICAgbmFtZXMgPSBbXTsKICAgICAgICAgICAgaWYoQXJyYXkuaXNBcnJheShkaXIpKSB7CiAgICAgICAgICAgICAgbGV0IFssIHJlXSA9IGRpcjsKICAgICAgICAgICAgICBsZXQgYWJzZGlyID0gcGF0aC5yZWFscGF0aChkaXJbMF0pOwogICAgICAgICAgICAgIG5hbWVzID0gWy4uLlJlY3Vyc2l2ZURpckl0ZXJhdG9yKGFic2RpciwgbiA9PiByZS50ZXN0KG4pKV07CiAgICAgICAgICAgICAgZGlyID0gcGF0aC5yZWxhdGl2ZShhYnNkaXIsIHBhdGguZ2V0Y3dkKCkpOwogICAgICAgICAgICB9IGVsc2UgaWYoKHN0ID0gZnMuc3RhdFN5bmMoZGlyKSkgJiYgc3QuaXNEaXJlY3RvcnkoKSkgewogICAgICAgICAgICAgIGxldCBhYnNkaXIgPSBwYXRoLnJlYWxwYXRoKGRpcik7CiAgICAgICAgICAgICAgbGV0IGNvbXBvbmVudHMgPSBhYnNkaXIuc3BsaXQocGF0aC5zZXApOwogICAgICAgICAgICAgIGlmKGNvbXBvbmVudHMubGVuZ3RoICYmIGNvbXBvbmVudHNbMF0gPT09ICcnKSBjb21wb25lbnRzLnNoaWZ0KCk7CiAgICAgICAgICAgICAgaWYoY29tcG9uZW50cy5sZW5ndGggPCAyIHx8IGNvbXBvbmVudHNbMF0gIT0gJ2hvbWUnKSB0aHJvdyBuZXcgRXJyb3IoYEFjY2VzcyBlcnJvcmApOwogICAgICAgICAgICAgIG5hbWVzID0gZnMucmVhZGRpclN5bmMoYWJzZGlyKSA/PyBbXTsKICAgICAgICAgICAgICBkaXIgPSBwYXRoLnJlbGF0aXZlKGFic2RpciwgcGF0aC5nZXRjd2QoKSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgbmFtZXMgPSBnbG9iKGRpciwgR0xPQl9CUkFDRSk7CiAgICAgICAgICAgICAgaWYoIUFycmF5LmlzQXJyYXkobmFtZXMpKSBuYW1lcyA9IFtdOwogICAgICAgICAgICAgIGxldCBhID0gcGF0aC50b0FycmF5KGRpcik7CiAgICAgICAgICAgICAgbGV0IGkgPSBhLmZpbmRJbmRleChuID0+IC9bKnt9XS8udGVzdChuKSk7CiAgICAgICAgICAgICAgZGlyID0gcGF0aC5zbGljZShkaXIsIDAsIGkpOwogICAgICAgICAgICAgIG5hbWVzID0gbmFtZXMubWFwKG4gPT4gbi5zbGljZShkaXIubGVuZ3RoICsgMSkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCFBcnJheS5pc0FycmF5KG5hbWVzKSkgY29udGludWU7CiAgICAgICAgICAgIG5hbWVzID0gbmFtZXMuc29ydCgoYSwgYikgPT4gJycgKyBiIDwgJycgKyBhKTsKICAgICAgICAgICAgaWYoZmlsdGVyKSB7CiAgICAgICAgICAgICAgY29uc3QgcmUgPSBuZXcgUmVnRXhwKGZpbHRlciwgJ2dpJyk7CiAgICAgICAgICAgICAgbmFtZXMgPSBuYW1lcy5maWx0ZXIobmFtZSA9PiByZS50ZXN0KG5hbWUpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZihsaW1pdCkgewogICAgICAgICAgICAgIGxldCBbb2Zmc2V0ID0gMF0gPSBsaW1pdDsKICAgICAgICAgICAgICBsZXQgWywgbGVuZ3RoID0gbmFtZXMubGVuZ3RoIC0gc3RhcnRdID0gbGltaXQ7CiAgICAgICAgICAgICAgbmFtZXMgPSBuYW1lcy5zbGljZShvZmZzZXQsIG9mZnNldCArIGxlbmd0aCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IGVudHJpZXMgPSBuYW1lcwogICAgICAgICAgICAgIC5tYXAoZmlsZSA9PiAoZnMuZXhpc3RzU3luYyhgJHtkaXJ9LyR7ZmlsZX1gKSA/IGAke2Rpcn0vJHtmaWxlfWAgOiBmaWxlKSkKICAgICAgICAgICAgICAubWFwKGZpbGUgPT4gW2ZpbGUsIHBhdGgucmVsYXRpdmUoZmlsZSwgcGF0aC5nZXRjd2QoKSldKQogICAgICAgICAgICAgIC5tYXAoKFtmaWxlLCByZWxdKSA9PiBbZmlsZSwgZnMuc3RhdFN5bmMocmVsKV0pOwogICAgICAgICAgICBlbnRyaWVzID0gZW50cmllcy5yZWR1Y2UoKGFjYywgW2ZpbGUsIHN0XSkgPT4gewogICAgICAgICAgICAgIGxldCBuYW1lID0gZmlsZSArIChzdCAmJiBzdC5pc0RpcmVjdG9yeSgpID8gJy8nIDogJycpOwogICAgICAgICAgICAgIGxldCBvYmogPSB7CiAgICAgICAgICAgICAgICBuYW1lCiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICBhY2MucHVzaChbCiAgICAgICAgICAgICAgICBuYW1lLAogICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbigKICAgICAgICAgICAgICAgICAgb2JqLAogICAgICAgICAgICAgICAgICBzdAogICAgICAgICAgICAgICAgICAgID8gewogICAgICAgICAgICAgICAgICAgICAgICBtdGltZTogdG9Vbml4VGltZShzdC5tdGltZSksCiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWU6IHRvVW5peFRpbWUoc3QuY3RpbWUpLAogICAgICAgICAgICAgICAgICAgICAgICBtb2RlOiBgMCR7KHN0Lm1vZGUgJiAweDA5ZmYpLnRvU3RyaW5nKDgpfWAsCiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IHN0LnNpemUKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICA6IHt9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgICAgcmV0dXJuIGFjYzsKICAgICAgICAgICAgfSwgW10pOwogICAgICAgICAgICBpZihlbnRyaWVzLmxlbmd0aCkgewogICAgICAgICAgICAgIGxldCBjbXAgPSB7CiAgICAgICAgICAgICAgICBzdHJpbmcoYSwgYikgewogICAgICAgICAgICAgICAgICByZXR1cm4gYVsxXVtrZXldLmxvY2FsZUNvbXBhcmUoYlsxXVtrZXldKTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBudW1iZXIoYSwgYikgewogICAgICAgICAgICAgICAgICByZXR1cm4gYVsxXVtrZXldIC0gYlsxXVtrZXldOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH1bdHlwZW9mIGVudHJpZXNbMF1bMV1ba2V5XV07CiAgICAgICAgICAgICAgZW50cmllcyA9IGVudHJpZXMuc29ydChjbXApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG5hbWVzID0gZW50cmllcy5tYXAoKFtuYW1lLCBvYmpdKSA9PiAob2JqZWN0cyA/IG9iaiA6IG5hbWUpKTsKICAgICAgICAgICAgaWYobmFtZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgIGlmKGZsYXQpIG5hbWVzLm1hcCgoeyBuYW1lIH0pID0+IHJlc3VsdHMucHVzaCh7IG5hbWU6IHBhdGgubm9ybWFsaXplKHBhdGguam9pbihkaXIsIG5hbWUpKSB9KSk7CiAgICAgICAgICAgICAgZWxzZSByZXN1bHRzLnB1c2goeyBkaXIsIG5hbWVzIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICB5aWVsZCBKU09OLnN0cmluZ2lmeSguLi5bcmVzdWx0cywgLi4uKHZlcmJvc2UgPyBbbnVsbCwgMl0gOiBbXSldKTsKICAgICAgICB9CiAgICAgIF0sCiAgICAgIC4uLnVybCwKCiAgICAgIC4uLmNhbGxiYWNrcywKICAgICAgb25Db25uZWN0KHdzLCByZXEpIHsKICAgICAgICBjb25zb2xlLmxvZygnb25Db25uZWN0XHgxYicpOwogICAgICAgIGNvbnN0IHsgcGVlciwgYWRkcmVzcywgcG9ydCwgcHJvdG9jb2wgfSA9IHdzOwoKICAgICAgICBjb25zb2xlLmxvZygnXHgxYlszODs1OzMzbW9uQ29ubmVjdFx4MWJbMG0nLCB7IGFkZHJlc3MsIHBvcnQsIHByb3RvY29sIH0pOwoKICAgICAgICB3cy5zZW5kQ29tbWFuZCA9IGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgICAgIGlmKCFpc0FycmF5QnVmZmVyKGRhdGEpIC8qJiYgaXNPYmplY3QoZGF0YSkqLykgZGF0YSA9IEpTT04uc3RyaW5naWZ5KGRhdGEpOwoKICAgICAgICAgIHJldHVybiB0aGlzLnNlbmQoZGF0YSk7CiAgICAgICAgfTsKICAgICAgICBpZighd3MudXVpZCkgewogICAgICAgICAgbGV0IGRhdGEgPSAod3MudXVpZCA9IE1ha2VVVUlEKCkpOwoKICAgICAgICAgIHdzLnNlbmRDb21tYW5kKHsgdHlwZTogJ3V1aWQnLCBkYXRhIH0pOwogICAgICAgICAgYnlfdXVpZFtkYXRhXSA9IHdzOwogICAgICAgIH0KICAgICAgICBjb25uZWN0aW9ucy5hZGQod3MpOwoKICAgICAgICBpZihjYWxsYmFja3Mub25Db25uZWN0KSByZXR1cm4gY2FsbGJhY2tzLm9uQ29ubmVjdCh3cywgcmVxKTsKICAgICAgfSwKICAgICAgb25DbG9zZSh3cywgcmVhc29uKSB7CiAgICAgICAgY29ubmVjdGlvbnMuZGVsZXRlKHdzKTsKCiAgICAgICAgcmV0dXJuIGNhbGxiYWNrcy5vbkNsb3NlKHdzLCByZWFzb24pOwogICAgICB9LAogICAgICAvKiAgICAgIG9uUmVhZChkYXRhKSB7CiAgICAgICAgICAgY29uc3QgcmVxID0gdGhpczsKICAgICAgICAgIGNvbnNvbGUubG9nKCdvblJlYWQnLCB7IHJlcSwgZGF0YSB9KTsKICAgICAgICB9LCovCiAgICAgIC8qIG9uUG9zdChkYXRhKSB7CiAgICAgICAgIGNvbnN0IHJlcSA9IHRoaXM7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICByZXEuanNvbiA9IEpTT04ucGFyc2UoZGF0YSk7CiAgICAgICAgICB9IGNhdGNoKGVycm9yKSB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvblBvc3QnLCB7IHJlcSwgZGF0YSwgZXJyb3IgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSwqLwogICAgICBvbkh0dHAod3MsIHJlcSwgcmVzcCkgewogICAgICAgIC8qIGlmKHJlcS5tZXRob2QgIT0gJ0dFVCcpKi8gLy9jb25zb2xlLmxvZygnb25IdHRwJywgY29uc29sZS5jb25maWcoeyBjb21wYWN0OiAwIH0pLCB3cyk7CiAgICAgICAgLy8gICBjb25zb2xlLmxvZygnXHgxYlszODs1OzIyMG1vbkh0dHAoMSlceDFiWzBtJywgY29uc29sZS5jb25maWcoeyBjb21wYWN0OiAwIH0pLCB7IHJlcSB9KTsKCiAgICAgICAgZGVmaW5lKGdsb2JhbFRoaXMsIHsgd3MsIHJlcSwgcmVzcCB9KTsKCiAgICAgICAgY29uc3QgeyBwZWVyLCBhZGRyZXNzLCBwb3J0IH0gPSB3czsKICAgICAgICBjb25zdCB7IG1ldGhvZCwgaGVhZGVycyB9ID0gcmVxOwoKICAgICAgICAvL3Jlc3AuaGVhZGVyc1snU2VydmVyJ10gPSAndXBsb2FkLXNlcnZlcic7CiAgICAgICAgcmVzcC5oZWFkZXJzID0geyBTZXJ2ZXI6ICd1cGxvYWQtc2VydmVyJyB9OwogICAgICAgIC8vY29uc29sZS5sb2coJ29uSHR0cCByZXNwLmhlYWRlcnMnLCByZXNwLmhlYWRlcnMsIHJlc3AuaGVhZGVyc1snU2VydmVyJ10pOwoKICAgICAgICBpZigocmVxLnVybC5wYXRoID8/ICcnKS5lbmRzV2l0aCgnZmlsZXMnKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgICAgLy9yZXNwLnR5cGUgPSAnYXBwbGljYXRpb24vanNvbic7CiAgICAgICAgfSBlbHNlIGlmKAogICAgICAgICAgcmVxLm1ldGhvZCAhPSAnR0VUJyAmJgogICAgICAgICAgKHJlcS5oZWFkZXJzWydjb250ZW50LXR5cGUnXSA9PSAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyB8fAogICAgICAgICAgICAocmVxLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddID8/ICcnKS5zdGFydHNXaXRoKCdtdWx0aXBhcnQvZm9ybS1kYXRhJykpCiAgICAgICAgKSB7CiAgICAgICAgICBsZXQgZnAsCiAgICAgICAgICAgIGhhc2gsCiAgICAgICAgICAgIHRtcG5hbSwKICAgICAgICAgICAgZXh0LAogICAgICAgICAgICBwcm9ncmVzcyA9IDA7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXEubWV0aG9kLCBoZWFkZXJzKTsKICAgICAgICAgIGlmKHJlcS51cmwucGF0aC5lbmRzV2l0aCgndXBsb2FkJykpIHJlc3Auc3RhdHVzID0gMjAwOwogICAgICAgICAgcmVzcC50eXBlID0gJ3RleHQvcmF3JzsKCiAgICAgICAgICBmcCA9IG5ldyBGb3JtUGFyc2VyKHdzLCBbJ2ZpbGVzJywgJ3V1aWQnXSwgewogICAgICAgICAgICBjaHVua1NpemU6IDgxOTIgLyoqIDI1NiovLAogICAgICAgICAgICBvbk9wZW4obmFtZSwgZmlsZW5hbWUpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgb25PcGVuKCR7bmFtZX0sICR7ZmlsZW5hbWV9KWApOwogICAgICAgICAgICAgIGlmKHRoaXMuZmlsZSkgewogICAgICAgICAgICAgICAgdGhpcy5vbmNsb3NlLmNhbGwodGhpcywgbmFtZSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgICAgICAgICAgIHRoaXMuZmlsZW5hbWUgPSBmaWxlbmFtZTsKICAgICAgICAgICAgICBleHQgPSBwYXRoLmV4dG5hbWUoZmlsZW5hbWUpLnRvTG93ZXJDYXNlKCk7CgogICAgICAgICAgICAgIHRoaXMuZmlsZSA9IGZzLm9wZW5TeW5jKCh0aGlzLnRlbXAgPSAndXBsb2Fkcy8nICsgKHRtcG5hbSA9IHJhbmRTdHIoMjApICsgJy50bXAnKSksICd3KycsIDBvNjQ0KTsKICAgICAgICAgICAgICBoYXNoID0gbmV3IEhhc2goSGFzaC5UWVBFX1NIQTEpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBvbkNvbnRlbnQobmFtZSwgZGF0YSkgewogICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGBvbkNvbnRlbnQoJHt0aGlzLmZpbGVuYW1lfSlgLGRhdGEuYnl0ZUxlbmd0aCk7CiAgICAgICAgICAgICAgcHJvZ3Jlc3MgKz0gZGF0YS5ieXRlTGVuZ3RoOwoKICAgICAgICAgICAgICBsZXQgd3MyID0gYnlfdXVpZFt3cy51dWlkID8/IHRoaXMudXVpZF07CgogICAgICAgICAgICAgIGZzLndyaXRlU3luYyh0aGlzLmZpbGUsIGRhdGEpOwogICAgICAgICAgICAgIGhhc2gudXBkYXRlKGRhdGEpOwogICAgICAgICAgICAgIGlmKHdzMikKICAgICAgICAgICAgICAgIHdzMi5zZW5kQ29tbWFuZCh7CiAgICAgICAgICAgICAgICAgIHR5cGU6ICdwcm9ncmVzcycsCiAgICAgICAgICAgICAgICAgIGRvbmU6IHByb2dyZXNzLAogICAgICAgICAgICAgICAgICBuYW1lLAogICAgICAgICAgICAgICAgICBmaWxlbmFtZTogdGhpcy5maWxlbmFtZSwKICAgICAgICAgICAgICAgICAgdG90YWw6ICtoZWFkZXJzWydjb250ZW50LWxlbmd0aCddCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSwKCiAgICAgICAgICAgIG9uQ2xvc2UobmFtZSwgZmlsZSkgewogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgb25DbG9zZVsxXSgke25hbWV9LCAke2ZpbGV9KWAsIHRoaXMudXVpZCk7CiAgICAgICAgICAgICAgICBsZXQgZXhpZiwgY2FjaGUsIHNoYTE7CiAgICAgICAgICAgICAgICBpZihoYXNoKSB7CiAgICAgICAgICAgICAgICAgIGhhc2guZmluYWxpemUoKTsKICAgICAgICAgICAgICAgICAgc2hhMSA9IGhhc2gudG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKHRoaXMuZmlsZSkgewogICAgICAgICAgICAgICAgICBmcy5jbG9zZVN5bmModGhpcy5maWxlKTsKICAgICAgICAgICAgICAgICAgdGhpcy5maWxlID0gbnVsbDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKHNoYTEpIHsKICAgICAgICAgICAgICAgICAgbGV0IGYgPSB4ID0+ICd1cGxvYWRzLycgKyBzaGExICsgeDsKICAgICAgICAgICAgICAgICAgbGV0IHJldCA9IGxpbmsodGhpcy50ZW1wLCBmKGV4dCkpOwogICAgICAgICAgICAgICAgICBsZXQgeyBlcnJubyB9ID0gZXJyb3IoKTsKICAgICAgICAgICAgICAgICAgbGV0IGpzb24gPSBmKCcuanNvbicpOwogICAgICAgICAgICAgICAgICBpZihmcy5leGlzdHNTeW5jKGpzb24pICYmIChjYWNoZSA9IFJlYWRKU09OKGpzb24pKSkgewogICAgICAgICAgICAgICAgICAgIGV4aWYgPSBjYWNoZS5leGlmOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmKCEvKHBuZ3xzdmd8Z2lmfHRnYSkkL2kudGVzdChleHQpKSB7CiAgICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBleGlmID0gUmVhZEV4aWZ0b29sKGYoZXh0KSk7CiAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICBleGlmID0gUmVhZEV4aWZ0b29sKHRoaXMudGVtcCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2goZSkge30KICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgbGV0IG9iaiA9IHsKICAgICAgICAgICAgICAgICAgICAgIGZpbGVuYW1lOiB0aGlzLmZpbGVuYW1lLAogICAgICAgICAgICAgICAgICAgICAgc3RvcmFnZTogZihleHQpLAogICAgICAgICAgICAgICAgICAgICAgdXBsb2FkZWQ6IERhdGUubm93KCksCiAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzLAogICAgICAgICAgICAgICAgICAgICAgZXhpZgogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgaWYoIS9qcGU/ZyQvLnRlc3QoZXh0KSkgewogICAgICAgICAgICAgICAgICAgICAgSGVpZkNvbnZlcnQoZihleHQpLCBmKCcuanBnJykpOwogICAgICAgICAgICAgICAgICAgICAgaWYoZnMuZXhpc3RzU3luYyhmKCcuanBnJykpKSBvYmouanBnID0gZignLmpwZycpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBsZXQgd2lkdGggPSAnJywKICAgICAgICAgICAgICAgICAgICAgIGhlaWdodCA9ICcyNTYnOwoKICAgICAgICAgICAgICAgICAgICBpZihleGlmKSB7CiAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7IEltYWdlU2l6ZSwgSW1hZ2VIZWlnaHQsIEltYWdlV2lkdGggfSA9IGV4aWY7CiAgICAgICAgICAgICAgICAgICAgICBsZXQgYXNwZWN0ID0gSW1hZ2VXaWR0aCAvIEltYWdlSGVpZ2h0OwogICAgICAgICAgICAgICAgICAgICAgaWYoYXNwZWN0ID49IDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGggPSAyNTY7CiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodCA9IHdpZHRoIC8gYXNwZWN0OwogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgLyogaGVpZ2h0ID0gMjU2OwogICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoID0gaGVpZ2h0ICogYXNwZWN0OyovCiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBNYWdpY2tSZXNpemUob2JqLmpwZyA/PyBmKGV4dCksIGYoJy50aHVtYi5qcGcnKSwgb2JqLmV4aWY/LlJvdGF0aW9uID8/IDAsIHdpZHRoLCBoZWlnaHQpOwoKICAgICAgICAgICAgICAgICAgICBpZihmcy5leGlzdHNTeW5jKGYoJy50aHVtYi5qcGcnKSkpIG9iai50aHVtYm5haWwgPSBmKCcudGh1bWIuanBnJyk7CiAgICAgICAgICAgICAgICAgICAgV3JpdGVKU09OKGpzb24sIG9iaik7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYGJ5X3V1aWRgLCBieV91dWlkKTsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgdXVpZGAsIHdzLnV1aWQgPz8gdGhpcy51dWlkKTsKICAgICAgICAgICAgICAgICAgICBjYWNoZSA9IG9iajsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBpZihyZXQgPT0gMCB8fCBlcnJubyA9PSAxNykgewogICAgICAgICAgICAgICAgICAgIHVubGluayh0aGlzLnRlbXApOwogICAgICAgICAgICAgICAgICAgIHRoaXMudGVtcCA9IG51bGw7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGNvbnN0IHsgZmlsZW5hbWUgfSA9IHRoaXM7CiAgICAgICAgICAgICAgICBsZXQgd3MyID0gYnlfdXVpZFt3cy51dWlkID8/IHRoaXMudXVpZF07CiAgICAgICAgICAgICAgICBpZih3czIpCiAgICAgICAgICAgICAgICAgIHdzMi5zZW5kQ29tbWFuZCh7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3VwbG9hZCcsCiAgICAgICAgICAgICAgICAgICAgLi4uKGNhY2hlID8/IHt9KSwKICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICBleGlmCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgLy8gIGNvbnNvbGUubG9nKGBvbkNsb3NlWzJdKCR7bmFtZX0sICR7ZmlsZX0pYCk7CiAgICAgICAgICAgICAgfSBjYXRjaChlKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgb25DbG9zZSBFUlJPUjpgLCBlLm1lc3NhZ2UpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgb25GaW5hbGl6ZSgpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgb25GaW5hbGl6ZSgpIGZvcm0gcGFyc2VyYCwgdGhpcy51dWlkKTsKICAgICAgICAgICAgICByZXNwLmJvZHkgPSBgZG9uZTogJHtwcm9ncmVzc30gYnl0ZXMgcmVhZFxyXG5gOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIC8vdGhyb3cgbmV3IEVycm9yKGBodHRwICR7bWV0aG9kfSByZXF1ZXN0YCk7CgogICAgICAgIGlmKCFyZXEuaGVhZGVycyB8fCB0eXBlb2YgcmVxLmhlYWRlcnMgIT0gJ29iamVjdCcpIGNvbnNvbGUubG9nKCdObyBoZWFkZXJzJywgcmVxKTsKCiAgICAgICAgY29uc3QgeyBib2R5LCB1cmwgfSA9IHJlc3A7CiAgICAgICAgY29uc3QgeyByZWZlcmVyIH0gPSByZXEuaGVhZGVyczsKCiAgICAgICAgbGV0IGZpbGUgPSB1cmwucGF0aC5zbGljZSgxKTsKICAgICAgICBjb25zdCBkaXIgPSBwYXRoLmRpcm5hbWUoZmlsZSk7IC8vZmlsZS5yZXBsYWNlKC9cL1teXC9dKiQvZywgJycpOwoKICAgICAgICBpZihmaWxlLmVuZHNXaXRoKCcudHh0JykgfHwgZmlsZS5lbmRzV2l0aCgnLmh0bWwnKSB8fCBmaWxlLmVuZHNXaXRoKCcuY3NzJykpIHsKICAgICAgICAgIHJlc3AuYm9keSA9IGZzLnJlYWRGaWxlU3luYyhmaWxlLCAndXRmLTgnKTsKICAgICAgICB9IGVsc2UgaWYoZmlsZS5lbmRzV2l0aCgnLmpzJykpIHsKICAgICAgICAgIGxldCBmaWxlMSA9IGZpbGU7CiAgICAgICAgICBpZigvcWpzLW1vZHVsZXNcL2xpYi8udGVzdChmaWxlKSAmJiAhLyhkb218dXRpbClcLmpzLy50ZXN0KGZpbGUpKSB7CiAgICAgICAgICAgIGxldCBmaWxlMiA9IGZpbGUucmVwbGFjZSgvLipxanMtbW9kdWxlc1wvL2csICcnKTsKICAgICAgICAgICAgaWYoZnMuZXhpc3RzU3luYyhmaWxlMikpIHsKICAgICAgICAgICAgICBmaWxlID0gZmlsZTI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZighZnMuZXhpc3RzU3luYyhmaWxlKSkgewogICAgICAgICAgICBmb3IobGV0IGRpciBvZiBbJ3F1aWNranMvcWpzLW1vZHVsZXMnLCAncXVpY2tqcy9xanMtbW9kdWxlcy9saWInLCAnLicsICdsaWInXSkgewogICAgICAgICAgICAgIGxldCBmaWxlMiA9IGRpciArICcvJyArIGZpbGU7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2luZXhpc3RlbnQgZmlsZScsIGZpbGUsIGZpbGUyLCBmcy5leGlzdHNTeW5jKGZpbGUyKSwgcmVmZXJlcik7CiAgICAgICAgICAgICAgaWYoZnMuZXhpc3RzU3luYyhmaWxlMikpIHsKICAgICAgICAgICAgICAgIGZpbGUgPSBmaWxlMjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmKGZpbGUxICE9IGZpbGUpIHsKICAgICAgICAgICAgLy8gIGNvbnNvbGUubG9nKCdceDFiWzM4OzU7MjE0bW9uSHR0cFx4MWJbMG0nLCBmaWxlMSwgJy0+JywgZmlsZSk7CiAgICAgICAgICAgIHJlc3Auc3RhdHVzID0gMzAyOwogICAgICAgICAgICByZXNwLmhlYWRlcnMgPSB7IFsnTG9jYXRpb24nXTogJy8nICsgZmlsZSB9OwogICAgICAgICAgICByZXR1cm4gcmVzcDsKICAgICAgICAgIH0KICAgICAgICAgIC8vY29uc29sZS5sb2coJ1x4MWJbMzg7NTszM21vbkh0dHBceDFiWzBtJywgZmlsZTEsIGZpbGUpOwoKICAgICAgICAgIC8vCiAgICAgICAgICBsZXQgYm9keSA9IGZzLnJlYWRGaWxlU3luYyhmaWxlLCAndXRmLTgnKTsKCiAgICAgICAgICBjb25zdCByZSA9IC9eKFxzKihpbXxleClwb3J0W15cbl0qZnJvbSBbJyJdKShbXi4vJyJdKikoWyciXVxzKjtbXHQgXSpcbj8pL2dtOwoKICAgICAgICAgIHJlc3AuYm9keSA9IGJvZHkucmVwbGFjZUFsbChyZSwgKG1hdGNoLCBwMSwgcDAsIHAyLCBwMywgb2Zmc2V0KSA9PiB7CiAgICAgICAgICAgIGlmKCEvW1wvXC5dLy50ZXN0KHAyKSkgewogICAgICAgICAgICAgIGxldCBmbmFtZSA9IGAke3AyfS5qc2A7CiAgICAgICAgICAgICAgbGV0IHJlbCA9IHBhdGgucmVsYXRpdmUoZm5hbWUsIGRpcik7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ29uSHR0cCcsIHsgbWF0Y2gsIGZuYW1lIH0sIHJlbCk7CgogICAgICAgICAgICAgIC8vIGlmKCFmcy5leGlzdHNTeW5jKCAgcmVsKSkgcmV0dXJuIGBgOwoKICAgICAgICAgICAgICBtYXRjaCA9IFtwMSwgcmVsLCBwM10uam9pbignJyk7CgogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdhcmdzJywgewogICAgICAgICAgICAgICAgbWF0Y2gsCiAgICAgICAgICAgICAgICBwMSwKICAgICAgICAgICAgICAgIHAyLAogICAgICAgICAgICAgICAgcDMsCiAgICAgICAgICAgICAgICBvZmZzZXQKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbWF0Y2g7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgewogICAgICAgICAgbGV0IHsgYm9keSB9ID0gcmVzcDsKICAgICAgICAgIC8vY29uc29sZS5sb2coJ1x4MWJbMzg7NTsyMTJtb25IdHRwKDIpXHgxYlswbScsIHsgYm9keSB9KTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXNwOwogICAgICB9LAogICAgICBvbk1lc3NhZ2Uod3MsIGRhdGEpIHsKICAgICAgICBjb25zb2xlLmxvZygnb25NZXNzYWdlJywgd3MsIGRhdGEpOwogICAgICAgIHJldHVybiBjYWxsYmFja3Mub25NZXNzYWdlKHdzLCBkYXRhKTsKICAgICAgfSwuLi4odXJsICYmIHVybC5ob3N0ID8gdXJsIDoge30pCiAgICB9KTsKICB9KTsKCiAgZGVmaW5lKGdsb2JhbFRoaXMsIHsKICAgIGdldCBjb25uZWN0aW9ucygpIHsKICAgICAgcmV0dXJuIFsuLi5jb25uZWN0aW9uc107CiAgICB9LAogICAgZ2V0IGJ5X3V1aWQoKSB7CiAgICAgIHJldHVybiBieV91dWlkOwogICAgfSwKICAgIHV1aWQoZGF0YSkgewogICAgICByZXR1cm4gYnlfdXVpZFtkYXRhXTsKICAgIH0KICB9KTsKCiAgT2JqZWN0LmFzc2lnbihnbG9iYWxUaGlzLCB7CiAgICByZXBsLAogICAgcXVpdCwKICAgIGV4aXQ6IHF1aXQsCiAgICBzdGQsCiAgICBvcywKICAgIGRlZXAsCiAgICBmcywKICAgIHBhdGgsCiAgICBSZWFkSlNPTiwKICAgIFdyaXRlSlNPTiwKICAgIFJlYWRGaWxlLAogICAgV3JpdGVGaWxlLAogICAgUmVhZEJKU09OLAogICAgV3JpdGVCSlNPTiwKICAgIHBhcnNlRGF0ZSwKICAgIGRhdGVUb09iamVjdCwKICAgIEhhc2gsCiAgICBGb3JtUGFyc2VyLAogICAgRXhlY1Rvb2wsCiAgICBFeGVjdXRlLAogICAgZXh0ZW5kR2VuZXJhdG9yLAogICAgZXh0ZW5kQXJyYXksCiAgICBleHRlbmRBc3luY0dlbmVyYXRvciwKICAgIE1hdGNoZXIsCiAgICBFeGVjVG9vbCwKICAgIEdldE1pbWUsCiAgICBNYXRjaGVyLAogICAgS2V5T3JWYWx1ZU1hdGNoZXIsCiAgICBHZXRSb290RGlyZWN0b3JpZXMsCiAgICBHZXREaXIsCiAgICBEaXJOYW1lLAogICAgRGF0ZVN0ciwKICAgIE1vZGVTdHIsCiAgICBSZWFkRXhpdjIsCiAgICBSZWFkRXhpZnRvb2wsCiAgICBIZWlmQ29udmVydCwKICAgIE1hZ2lja1Jlc2l6ZSwKICAgIERpcmVjdG9yeSwKICAgIG5ldDogeyBzZXRMb2csIExMTF9VU0VSLCBMTExfTk9USUNFLCBMTExfV0FSTiwgTExMX0lORk8sIGNsaWVudCwgc2VydmVyLCBGb3JtUGFyc2VyLCBIYXNoLCBSZXNwb25zZSwgU29ja2V0IH0KICB9KTsKCiAgZGVsZXRlIGdsb2JhbFRoaXMuREVCVUc7CgogIGNyZWF0ZVdTKAogICAgeyBwcm90b2NvbDogJ3dzJywgaG9zdDogJzAuMC4wLjAnLCBwb3J0OiA4OTk5IH0sCiAgICB7CiAgICAgIG9uRmQoZmQsIHJkLCB3cikgewogICAgICAgIC8vY29uc29sZS5sb2coJ29uRmQnLCBmZCwgcmQsIHdyKTsKICAgICAgICBvcy5zZXRSZWFkSGFuZGxlcihmZCwgcmQpOwogICAgICAgIG9zLnNldFdyaXRlSGFuZGxlcihmZCwgd3IpOwogICAgICB9LAogICAgICBvbkNsb3NlKHdzLCByZWFzb24pIHt9LAogICAgICBvbk1lc3NhZ2Uod3MsIGRhdGEpIHt9CiAgICB9LAogICAgdHJ1ZQogICk7CgogIGZ1bmN0aW9uIHF1aXQod2h5KSB7CiAgICBjb25zb2xlLmxvZyhgcXVpdCgnJHt3aHl9JylgKTsKCiAgICBsZXQgY2ZnID0geyBpbnNwZWN0T3B0aW9uczogY29uc29sZS5vcHRpb25zIH07CiAgICBXcml0ZUpTT04oYC4ke2Jhc2V9LWNvbmZpZ2AsIGNmZyk7CiAgICByZXBsLmNsZWFudXAod2h5KTsKICB9CgogIHJlcGwucnVuU3luYygpOwp9Cgp0cnkgewogIG1haW4oLi4uc2NyaXB0QXJncy5zbGljZSgxKSk7Cn0gY2F0Y2goZXJyb3IpIHsKICBjb25zb2xlLmxvZyhgRkFJTDogJHtlcnJvcj8ubWVzc2FnZSA/PyBlcnJvcn1cbiR7ZXJyb3I/LnN0YWNrfWApOwogIDE7CiAgc3RkLmV4aXQoMSk7Cn0gZmluYWxseSB7Cn0KAAAAAAAAAAA2hQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAvn8AAAAAAAC+fwAAAAAAAAAAAAAAAPC/"
				]
			]
		},
		{
			"file": "fire.js",
			"settings":
			{
				"buffer_size": 14472,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					764,
					1,
					"insert",
					{
						"characters": " "
					},
					"AgAAAH0qAAAAAAAAfioAAAAAAAAAAAAAfioAAAAAAAB+KgAAAAAAAAIAAAAqLw",
					"AQAAAAAAAAABAAAAfyoAAAAAAAB9KgAAAAAAAAAAAAAAAPC/"
				],
				[
					767,
					1,
					"insert",
					{
						"characters": " "
					},
					"AgAAALUoAAAAAAAAtigAAAAAAAAAAAAAtigAAAAAAAC2KAAAAAAAAAUAAAAgIC8qIA",
					"AQAAAAAAAAABAAAAuigAAAAAAAC1KAAAAAAAAAAAAAAAAPC/"
				],
				[
					782,
					1,
					"insert",
					{
						"characters": "\n\n"
					},
					"BQAAAHoqAAAAAAAAeyoAAAAAAAAAAAAAeyoAAAAAAAB9KgAAAAAAAAAAAAB9KgAAAAAAAH4qAAAAAAAAAAAAAH4qAAAAAAAAgCoAAAAAAAAAAAAAeyoAAAAAAAB7KgAAAAAAAAIAAAAgIA",
					"AQAAAAAAAAABAAAAeioAAAAAAAB6KgAAAAAAAAAAAAAAADJA"
				],
				[
					784,
					1,
					"insert",
					{
						"characters": "render"
					},
					"BwAAAHsqAAAAAAAAfCoAAAAAAAAAAAAAfSoAAAAAAAB9KgAAAAAAAAIAAAAgIHwqAAAAAAAAfSoAAAAAAAAAAAAAfSoAAAAAAAB+KgAAAAAAAAAAAAB+KgAAAAAAAH8qAAAAAAAAAAAAAH8qAAAAAAAAgCoAAAAAAAAAAAAAgCoAAAAAAACBKgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAeyoAAAAAAAB7KgAAAAAAAAAAAAAAADJA"
				],
				[
					785,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAIEqAAAAAAAAgyoAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAgSoAAAAAAACBKgAAAAAAAAAAAAAAAPC/"
				],
				[
					786,
					1,
					"insert",
					{
						"characters": "h"
					},
					"AQAAAIIqAAAAAAAAgyoAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAgioAAAAAAACCKgAAAAAAAAAAAAAAAPC/"
				],
				[
					787,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAIMqAAAAAAAAhSoAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAgyoAAAAAAACDKgAAAAAAAAAAAAAAAPC/"
				],
				[
					788,
					1,
					"insert",
					{
						"characters": "SVG"
					},
					"AwAAAIQqAAAAAAAAhSoAAAAAAAAAAAAAhSoAAAAAAACGKgAAAAAAAAAAAACGKgAAAAAAAIcqAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAhCoAAAAAAACEKgAAAAAAAAAAAAAAAPC/"
				],
				[
					789,
					1,
					"insert_completion",
					{
						"completion": "SVGComponent",
						"format": "snippet",
						"keep_prefix": false,
						"must_insert": false,
						"trigger": "SVGComponent"
					},
					"AgAAAIQqAAAAAAAAhCoAAAAAAAADAAAAU1ZHhCoAAAAAAACQKgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAhyoAAAAAAACHKgAAAAAAAAAAAAAAAPC/"
				],
				[
					791,
					1,
					"insert",
					{
						"characters": ","
					},
					"AQAAAJEqAAAAAAAAkioAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAkSoAAAAAAACRKgAAAAAAAAAAAAAAAPC/"
				],
				[
					792,
					1,
					"insert",
					{
						"characters": " svgConta"
					},
					"CQAAAJIqAAAAAAAAkyoAAAAAAAAAAAAAkyoAAAAAAACUKgAAAAAAAAAAAACUKgAAAAAAAJUqAAAAAAAAAAAAAJUqAAAAAAAAlioAAAAAAAAAAAAAlioAAAAAAACXKgAAAAAAAAAAAACXKgAAAAAAAJgqAAAAAAAAAAAAAJgqAAAAAAAAmSoAAAAAAAAAAAAAmSoAAAAAAACaKgAAAAAAAAAAAACaKgAAAAAAAJsqAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAkioAAAAAAACSKgAAAAAAAAAAAAAAAPC/"
				],
				[
					793,
					1,
					"insert_completion",
					{
						"completion": "svgContainer",
						"format": "snippet",
						"keep_prefix": false,
						"must_insert": false,
						"trigger": "svgContainer"
					},
					"AgAAAJMqAAAAAAAAkyoAAAAAAAAIAAAAc3ZnQ29udGGTKgAAAAAAAJ8qAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAmyoAAAAAAACbKgAAAAAAAAAAAAAAAPC/"
				],
				[
					797,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAKAqAAAAAAAAoSoAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAoCoAAAAAAACgKgAAAAAAAAAAAAAAAPC/"
				],
				[
					800,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAAA3NgAAaW1wb3J0IHsgY3Jvc3NraXQsIENBTlZBUyB9IGZyb20gJy4vbGliL2Nyb3Nza2l0LmpzJzsKaW1wb3J0IHsgUkdCQSwgSFNMQSB9IGZyb20gJy4vbGliL2NvbG9yLmpzJzsKaW1wb3J0IHsgdGltZXIgfSBmcm9tICcuL2xpYi9hc3luYy9oZWxwZXJzLmpzJzsKaW1wb3J0IHsgV2ViU29ja2V0SXRlcmF0b3IsIFdlYlNvY2tldFVSTCwgQ3JlYXRlV2ViU29ja2V0LCBSZWNvbm5lY3RpbmdXZWJTb2NrZXQsIFN0cmVhbVJlYWRJdGVyYXRvciB9IGZyb20gJy4vbGliL2FzeW5jL3dlYnNvY2tldC5qcyc7CmltcG9ydCB7IG9uY2UsIHN0cmVhbWlmeSwgdGhyb3R0bGUsIGRpc3RpbmN0LCBzdWJzY3JpYmUgfSBmcm9tICcuL2xpYi9hc3luYy9ldmVudHMuanMnOwppbXBvcnQgeyBtZW1vaXplLCBkZWZpbmUsIGlzVW5kZWZpbmVkLCBwcm9wZXJ0aWVzLCBrZXlzLCB1bmlxdWUsIHJhbmRTdHIsIHJhbmRJbnQgfSBmcm9tICcuL2xpYi9taXNjLmpzJzsKaW1wb3J0IHsgaXNTdHJlYW0sIEFjcXVpcmVSZWFkZXIsIEFjcXVpcmVXcml0ZXIsIEFycmF5V3JpdGVyLCByZWFkU3RyZWFtLCBQaXBlVG8sIFdyaXRhYmxlUmVwZWF0ZXIsIFdyaXRlSXRlcmF0b3IsIEFzeW5jV3JpdGUsIEFzeW5jUmVhZCwgUmVhZEZyb21JdGVyYXRvciwgV3JpdGVUb1JlcGVhdGVyLCBMb2dTaW5rLCBTdHJpbmdSZWFkZXIsIExpbmVSZWFkZXIsIERlYnVnVHJhbnNmb3JtU3RyZWFtLCBDcmVhdGVXcml0YWJsZVN0cmVhbSwgQ3JlYXRlVHJhbnNmb3JtU3RyZWFtLCBSZXBlYXRlclNvdXJjZSwgUmVwZWF0ZXJTaW5rLCBMaW5lQnVmZmVyU3RyZWFtLCBUZXh0VHJhbnNmb3JtU3RyZWFtLCBDaHVua1JlYWRlciwgQnl0ZVJlYWRlciwgUGlwZVRvUmVwZWF0ZXIsIFJlYWRlciwgUmVhZEFsbCwgZGVmYXVsdCBhcyB1dGlscyB9IGZyb20gJy4vbGliL3N0cmVhbS91dGlscy5qcyc7CmltcG9ydCB7IEludGVyc2VjdGlvbiwgTWF0cml4LCBpc1JlY3QsIFJlY3QsIFNpemUsIFBvaW50LCBMaW5lLCBUcmFuc2Zvcm1hdGlvbkxpc3QsIFZlY3RvciB9IGZyb20gJy4vbGliL2dlb20uanMnOwppbXBvcnQgeyBFbGVtZW50LCBpc0VsZW1lbnQsIFNWRyB9IGZyb20gJy4vbGliL2RvbS5qcyc7CmltcG9ydCBSZWFjdCwgeyBoLCBodG1sLCByZW5kZXIsIEZyYWdtZW50LCBDb21wb25lbnQsIGNyZWF0ZVJlZiwgdXNlU3RhdGUsIHVzZUxheW91dEVmZmVjdCwgdXNlUmVmLCB0b0NoaWxkQXJyYXkgfSBmcm9tICcuL2xpYi9kb20vcHJlYWN0Q29tcG9uZW50LmpzJzsKCmZ1bmN0aW9uIE5ld1dTKCkgewogIGxldCB1cmwgPSBXZWJTb2NrZXRVUkwoJy93cycsIHsgbWlycm9yOiBjdXJyZW50RmlsZSB9KTsKICBsZXQgd3MgPSBuZXcgUmVjb25uZWN0aW5nV2ViU29ja2V0KHVybCwgJ2x3cy1taXJyb3ItcHJvdG9jb2wnKTsKICAoYXN5bmMgZnVuY3Rpb24oKSB7CiAgICBmb3IgYXdhaXQobGV0IGNodW5rIG9mIHdzKSB7CiAgICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShjaHVuayk7CgogICAgICBpZihkYXRhLmNpZCAhPSBnbG9iYWxUaGlzLmNpZCkgY29uc29sZS5sb2coJ1dTIHJlY2VpdmU6JywgZGF0YSk7CiAgICB9CiAgfSkoKTsKICByZXR1cm4gKGdsb2JhbFRoaXMud3MgPSB3cyk7Cn0KCmNvbnN0IE1ha2VVVUlEID0gKHJuZyA9IE1hdGgucmFuZG9tKSA9PiBbOCwgNCwgNCwgNCwgMTJdLm1hcChuID0+IHJhbmRTdHIobiwgJzAxMjM0NTY3ODlhYmNkZWYnKSwgcm5nKS5qb2luKCctJyk7CmNvbnN0IE1ha2VDbGllbnRJRCA9IChybmcgPSBNYXRoLnJhbmRvbSkgPT4gWzQsIDQsIDQsIDRdLm1hcChuID0+IHJhbmRTdHIobiwgWydBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWicsICdhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicsICcuLSQnXVtyYW5kSW50KDAsIDMpXSksIHJuZykuam9pbignJyk7CgpmdW5jdGlvbiBtYWluKCkgewogIGRlZmluZSgKICAgIGdsb2JhbFRoaXMsCiAgICBwcm9wZXJ0aWVzKAogICAgICB7CiAgICAgICAgY3VycmVudFVSTDogKCkgPT4gbmV3IFVSTChpbXBvcnQubWV0YS51cmwpLAogICAgICAgIGN1cnJlbnRGaWxlOiAoKSA9PiBnbG9iYWxUaGlzLmN1cnJlbnRVUkwucGF0aG5hbWUucmVwbGFjZSgvXlwvLywgJycpCiAgICAgIH0sCiAgICAgIHsgbWVtb2l6ZTogdHJ1ZSB9CiAgICApCiAgKTsKCiAgY29uc3Qgd2lkdGggPSAzMjA7CiAgY29uc3QgaGVpZ2h0ID0gMjAwOwogIGNvbnN0IHBhcmVudCA9IGRvY3VtZW50LmJvZHk7CgogIGNyb3Nza2l0LmluaXQoewogICAgcmVuZGVyZXI6IENBTlZBUywKICAgIHBhcmVudCwKICAgIHc6IHdpZHRoLAogICAgaDogaGVpZ2h0LAogICAgYWxwaGE6IGZhbHNlCiAgfSk7CgogIGZ1bmN0aW9uIFJlcGFyZW50KGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdjYW52YXMnKVswXSkgewogICAgY2FudmFzLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoY2FudmFzKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKS5hcHBlbmRDaGlsZChjYW52YXMpOwogIH0KCiAgZnVuY3Rpb24gR2V0RWxlbWVudE1hdHJpeChlbGVtZW50KSB7CiAgICBsZXQgeyB0cmFuc2Zvcm0gfSA9IEVsZW1lbnQuZ2V0Q1NTKGRpdkVsZW1lbnQpOwoKICAgIHJldHVybiBNYXRyaXguZnJvbUNTUyh0cmFuc2Zvcm0pOwogIH0KCiAgZnVuY3Rpb24gU2V0Q3Jvc3NoYWlyKHBvcykgewogICAgbGV0IGNoID0gRWxlbWVudC5maW5kKCcjY3Jvc3NoYWlyJyk7CiAgICBsZXQgcmVjdCA9IEVsZW1lbnQuZ2V0UmVjdChjaCk7CgogICAgY29uc29sZS5sb2coJ1NldENyb3NzaGFpcicsIHsgY2gsIHJlY3QsIHBvcyB9KTsKICAgIHJlY3QueCA9IHBvcy54IC0gcmVjdC53aWR0aCAvIDI7CiAgICByZWN0LnkgPSBwb3MueSAtIHJlY3QuaGVpZ2h0IC8gMjsKCiAgICBFbGVtZW50LnNldFJlY3QoY2gsIHJlY3QpOwogIH0KCiAgZnVuY3Rpb24gRXZlbnRQb3NpdGlvbnMoZXZlbnRPclRvdWNoKSB7CiAgICBsZXQgcG9zaXRpb25zID0gdW5pcXVlKAogICAgICBrZXlzKGV2ZW50T3JUb3VjaCwgMikKICAgICAgICAuZmlsdGVyKG4gPT4gdHlwZW9mIG4gPT0gJ3N0cmluZycgJiYgL1tYWV0kLy50ZXN0KG4pKQogICAgICAgIC5tYXAobiA9PiBuLnNsaWNlKDAsIC0xKSkKICAgICk7CgogICAgcmV0dXJuIHBvc2l0aW9ucy5yZWR1Y2UoKGFjYywga2V5KSA9PiB7CiAgICAgIGFjY1trZXldID0gbmV3IFBvaW50KGV2ZW50T3JUb3VjaFtrZXkgKyAnWCddLCBldmVudE9yVG91Y2hba2V5ICsgJ1knXSk7CiAgICAgIHJldHVybiBhY2M7CiAgICB9LCB7fSk7CiAgfQoKICBmdW5jdGlvbiBQb3NpdGlvbk1hdHJpeChjYW52YXMgPSBjYW52YXNFbGVtZW50LCByZWN0ID0gY2FudmFzUmVjdCkgewogICAgbGV0IHZlcnRpY2FsID0gcmVjdC5hc3BlY3QoKSA8IDE7CiAgICBsZXQgdG9wTGVmdCA9IHJlY3QudG9Qb2ludHMoKVt2ZXJ0aWNhbCA/IDEgOiAwXTsKICAgIGxldCBtID0gTWF0cml4LmlkZW50aXR5KCkuc2NhbGUoY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTsKCiAgICBpZih2ZXJ0aWNhbCkgbSA9IG0ucm90YXRlKC1NYXRoLlBJIC8gMik7CgogICAgbSA9IG0uc2NhbGUoMSAvIHJlY3Qud2lkdGgsIDEgLyByZWN0LmhlaWdodCk7CiAgICBtID0gbS50cmFuc2xhdGUoLXRvcExlZnQueCwgLXRvcExlZnQueSk7CgogICAgcmV0dXJuIG07CiAgfQoKICBmdW5jdGlvbiBQb3NpdGlvblByb2Nlc3NvcihjYW52YXMgPSBjYW52YXNFbGVtZW50LCByZWN0ID0gY2FudmFzUmVjdCkgewogICAgbGV0IG0gPSBQb3NpdGlvbk1hdHJpeChjYW52YXMsIHJlY3QpOwogICAgcmV0dXJuIHBvcyA9PiBuZXcgUG9pbnQoLi4ubS50cmFuc2Zvcm1fcG9pbnQobmV3IFBvaW50KHBvcykpKS5yb3VuZCgxKTsKICB9CgogIGZ1bmN0aW9uIFByb2Nlc3NQb3NpdGlvbihwb3MpIHsKICAgIHJldHVybiBQb3NpdGlvblByb2Nlc3NvcigpKHBvcyk7CiAgfQoKICBhc3luYyBmdW5jdGlvbiogTW92ZW1lbnRJdGVyYXRvcihlbGVtZW50KSB7CiAgICBsZXQgZXYgPSBhd2FpdCBvbmNlKGVsZW1lbnQsICdtb3VzZWRvd24nLCAndG91Y2hzdGFydCcpOwogICAgbGV0IHR5cGUgPSBldi50eXBlLnNsaWNlKDAsIDUpOwogICAgeWllbGQgZXY7CiAgICBjb25zb2xlLmxvZyh0eXBlICsgJyBzdGFydCcpOwogICAgZm9yIGF3YWl0KGxldCBldmVudCBvZiBzdHJlYW1pZnkoWydtb3VzZXVwJywgJ21vdXNlbW92ZScsICd0b3VjaGVuZCcsICd0b3VjaG1vdmUnXSwgZWxlbWVudCkpIHsKICAgICAgLy9ldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBpZigndG91Y2hlcycgaW4gZXZlbnQpIHsKICAgICAgICBpZihldmVudC50b3VjaGVzLmxlbmd0aCkgewogICAgICAgICAgZ2xvYmFsVGhpcy5tb3VzZUV2ZW50ID0gZXZlbnQ7CgogICAgICAgICAgeWllbGQqIFsuLi5ldmVudC50b3VjaGVzXS5tYXAoRXZlbnRQb3NpdGlvbnMpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCB7IHR5cGUsIGNsaWVudFg6IHgsIGNsaWVudFk6IHkgfSA9IGV2ZW50OwogICAgICAgIGxldCBvYmogPSB7IHR5cGUsIHgsIHkgfTsKICAgICAgICB5aWVsZCBvYmo7CiAgICAgIH0KICAgICAgaWYoLyh1cHxlbmQpJC8udGVzdChldmVudC50eXBlKSkgewogICAgICAgIGNvbnNvbGUubG9nKHR5cGUgKyAnIGVuZCcpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQoKICBSZXBhcmVudCgpOwoKICBjcm9zc2tpdC5jbGVhcigpOwogIGNyb3Nza2l0LnJlY3QoewogICAgeDogMCwKICAgIHk6IDAsCiAgICB3aWR0aCwKICAgIGhlaWdodCwKICAgIGZpbGw6ICdibGFjaycsCiAgICBzdHJva2U6ICdibGFjaycsCiAgICBhbmdsZTogMAogIH0pOwoKICBjb25zdCBidWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIod2lkdGggKiAoaGVpZ2h0ICsgMikpOwogIGNvbnN0IHBhbGV0dGUgPSBDcmVhdGVQYWxldHRlKCk7CiAgY29uc3QgcGFsZXR0ZUhTTCA9IENyZWF0ZVBhbGV0dGVIU0woKTsKCiAgY29uc3QgcGl4ZWxzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogaGVpZ2h0ICsgMiB9KS5tYXAoKHYsIGkpID0+IG5ldyBVaW50OENsYW1wZWRBcnJheShidWZmZXIsIGkgKiB3aWR0aCwgd2lkdGgpKTsKICBjb25zdCB7IGNvbnRleHQgfSA9IGNyb3Nza2l0OwogIGNvbnN0IGltYWdlID0gY29udGV4dC5jcmVhdGVJbWFnZURhdGEod2lkdGgsIGhlaWdodCk7CgogIGNvbnN0IHsgbm93LCB3YWl0Rm9yLCBhbmltYXRpb25GcmFtZSB9ID0gVXRpbDsKICBjb25zdCBmcHMgPSA1MDsKICBjb25zdCBtYXRyaXggPSBuZXcgTWF0cml4KCkudHJhbnNsYXRlKDE2MCwgMTAwKS5zY2FsZSgwLjUpOwoKICBPYmplY3QuYXNzaWduKGdsb2JhbFRoaXMsIHsKICAgIGJ1ZmZlciwKICAgIHBhbGV0dGUsCiAgICBwYWxldHRlSFNMLAogICAgcGl4ZWxzLAogICAgY29udGV4dCwKICAgIGltYWdlLAogICAgZnBzLAogICAgbWF0cml4LAogICAgUmVwYXJlbnQsCiAgICBkb206IHsgRWxlbWVudCB9LAogICAgZ2VvbTogeyBSZWN0IH0sCiAgICBNb3ZlbWVudEl0ZXJhdG9yLAogICAgTW91c2VIYW5kbGVyLAogICAgR2V0RWxlbWVudE1hdHJpeCwKICAgIFNldENyb3NzaGFpciwKICAgIEV2ZW50UG9zaXRpb25zLAogICAgUG9zaXRpb25Qcm9jZXNzb3IsCiAgICBQb3NpdGlvbk1hdHJpeCwKICAgIFByb2Nlc3NQb3NpdGlvbgogIH0pOwoKICBhc3luYyBmdW5jdGlvbiBMb29wKCkgewogICAgY29uc3QgZGVsYXkgPSAxMDAwIC8gZnBzOwogICAgY29uc3QgbG9nID0gKHQsIG5hbWUpID0+IGdsb2JhbFRoaXMuZG9Mb2cgJiYgY29uc29sZS5sb2coYCR7bmFtZX0gdGltaW5nOiAke3QudG9GaXhlZCgzKX1tc2ApOwogICAgY29uc3QgZmlyZSA9ICguLi5hcmdzKSA9PiBGaXJlKC4uLmFyZ3MpOwogICAgY29uc3QgcmVkcmF3ID0gKC4uLmFyZ3MpID0+IFJlZHJhdyguLi5hcmdzKTsKCiAgICBhd2FpdCBvbmNlKHdpbmRvdywgJ2xvYWQnKTsKCiAgICBJbml0KCk7CgogICAgZm9yKDs7KSB7CiAgICAgIGZpcmUoKTsKICAgICAgcmVkcmF3KCk7CiAgICAgIGF3YWl0IGFuaW1hdGlvbkZyYW1lKGRlbGF5KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIEZpcmUoKSB7CiAgICBmb3IobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewogICAgICBwaXhlbHNbaGVpZ2h0XVt4XSA9IDI1NSAtIChSYW5kb21CeXRlKCkgJSAxMjgpOwogICAgICBwaXhlbHNbaGVpZ2h0ICsgMV1beF0gPSAyNTUgLSAoUmFuZG9tQnl0ZSgpICUgMTI4KTsKICAgIH0KCiAgICBmb3IobGV0IHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKICAgICAgZm9yKGxldCB4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHsKICAgICAgICBjb25zdCBzdW0gPSBbcGl4ZWxzW3kgKyAxXVtNb2R1bG8oeCAtIDEsIHdpZHRoKV0sIHBpeGVsc1t5ICsgMV1beF0sIHBpeGVsc1t5ICsgMV1bTW9kdWxvKHggKyAxLCB3aWR0aCldLCBwaXhlbHNbeSArIDJdW3hdXS5yZWR1Y2UoKGEsIHApID0+IGEgKyAocCB8IDApLCAwKTsKCiAgICAgICAgcGl4ZWxzW3ldW3hdID0gKHN1bSAqIDE1KSA+Pj4gNjsKICAgICAgfQogICAgfQogIH0KCiAgYXN5bmMgZnVuY3Rpb24gUmVkcmF3KCkgewogICAgY29uc3QgeyBkYXRhIH0gPSBpbWFnZTsKCiAgICBsZXQgaSA9IDA7CiAgICBsZXQgdCA9IFsuLi5tYXRyaXhdOwoKICAgIGZvcihsZXQgeSA9IDA7IHkgPCBoZWlnaHQ7IHkrKykgewogICAgICBmb3IobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewogICAgICAgIGNvbnN0IGMgPSBwYWxldHRlW3BpeGVsc1t5XVt4XV07CiAgICAgICAgZGF0YVtpKytdID0gYy5yOwogICAgICAgIGRhdGFbaSsrXSA9IGMuZzsKICAgICAgICBkYXRhW2krK10gPSBjLmI7CiAgICAgICAgZGF0YVtpKytdID0gYy5hOwogICAgICB9CiAgICB9CgogICAgY29udGV4dC5wdXRJbWFnZURhdGEoaW1hZ2UsIDAsIDApOwogIH0KCiAgZnVuY3Rpb24gQ3JlYXRlUGFsZXR0ZSgpIHsKICAgIGNvbnN0IGNvbG9ycyA9IG5ldyBBcnJheSgyNTYpOwoKICAgIGZvcihsZXQgaSA9IDA7IGkgPCA2NDsgaSsrKSB7CiAgICAgIGNvbnN0IHZhbHVlID0gaSAqIDQ7CgogICAgICBjb2xvcnNbaV0gPSBuZXcgUkdCQSh2YWx1ZSwgMCwgMCk7CiAgICAgIGNvbG9yc1tpICsgNjRdID0gbmV3IFJHQkEoMjU1LCB2YWx1ZSwgMCk7CiAgICAgIGNvbG9yc1tpICsgMTI4XSA9IG5ldyBSR0JBKDI1NSwgMjU1LCB2YWx1ZSk7CiAgICAgIGNvbG9yc1tpICsgMTkyXSA9IG5ldyBSR0JBKDI1NSwgMjU1LCAyNTUpOwogICAgfQogICAgcmV0dXJuIGNvbG9yczsKICB9CgogIGZ1bmN0aW9uIENyZWF0ZVBhbGV0dGVIU0woKSB7CiAgICBjb25zdCBjb2xvcnMgPSBuZXcgQXJyYXkoMjU2KTsKCiAgICBjb25zdCBodWVzID0gW25ldyBIU0xBKDAsIDEwMCwgMCksIG5ldyBIU0xBKDAsIDEwMCwgNTApLCBuZXcgSFNMQSgzMCwgMTAwLCA1MCksIG5ldyBIU0xBKDYwLCAxMDAsIDUwKSwgbmV3IEhTTEEoNjAsIDEwMCwgMTAwKSwgbmV3IEhTTEEoNjAsIDEwMCwgMTAwKV07CgogICAgY29uc3QgYnJlYWtwb2ludHMgPSBbMCwgNTEsIDgwLCAxNTQsIDIwNSwgMjU2XTsKICAgIGNvbnNvbGUubG9nKCdicmVha3BvaW50czonLCBicmVha3BvaW50cyk7CgogICAgZm9yKGxldCBpID0gMDsgaSA8IDI1NjsgaSsrKSB7CiAgICAgIGNvbnN0IGh1ZSA9ICh2ID0+ICh2ID09IC0xID8gKCkgPT4gaHVlcy5sZW5ndGggLSAyIDogdiA9PiB2KSkoYnJlYWtwb2ludHMuZmluZEluZGV4KGIgPT4gaSA8IGIpKTsKICAgICAgY29uc3QgcmFuZ2UgPSBicmVha3BvaW50c1todWVdIC0gMSAtIGJyZWFrcG9pbnRzW2h1ZSAtIDFdOwoKICAgICAgY29sb3JzW2ldID0gSFNMQS5ibGVuZChodWVzW2h1ZSAtIDFdLCBodWVzW2h1ZV0sIChpIC0gYnJlYWtwb2ludHNbaHVlIC0gMV0pIC8gcmFuZ2UpLnRvUkdCQSgpOwogICAgfQogICAgcmV0dXJuIGNvbG9yczsKICB9CgogIC8vIEZvciByYW5kb20gbnVtYmVycywgdXNlICJ4ID0gMTgxICogeCArIDM1OSIgZnJvbQogIC8vIFRvbSBEaWNrZW5zICJSYW5kb20gTnVtYmVyIEdlbmVyYXRvciBmb3IgTWljcm9jb250cm9sbGVycyIKICAvLyBodHRwczovL3dlYi5hcmNoaXZlLm9yZy93ZWIvMjAxNzAzMjMyMDQ5MTcvaHR0cDovL2hvbWUuZWFydGhsaW5rLm5ldC9+dGRpY2tlbnMvNjhoYzExL3JhbmRvbS82OGhjMTFyYW5kb20uaHRtbAogIGxldCBzY3JhdGNoID0gMDsKCiAgZnVuY3Rpb24gUmFuZG9tQnl0ZSgpIHsKICAgIGNvbnN0IHZhbHVlID0gMTgxICogc2NyYXRjaCArIDM1OTsKICAgIHNjcmF0Y2ggPSB2YWx1ZSA+Pj4gMDsKICAgIHJldHVybiAodmFsdWUgPj4+IDgpICYgMHhmZjsKICB9CgogIGZ1bmN0aW9uIE1vZHVsbyhuLCBtKSB7CiAgICByZXR1cm4gKChuICUgbSkgKyBtKSAlIG07CiAgfQoKICBsZXQgZWxlbWVudCwgcmVjdCwgcmMsIG1vdXNlVHJhbnNmb3JtOwoKICBmdW5jdGlvbiBCbGF6ZSh4LCB5KSB7CiAgICBmb3IobGV0IHR5ID0geSAtIDE7IHR5IDwgeSArIDE7IHR5KyspIHsKICAgICAgZm9yKGxldCB0eCA9IHggLSAxOyB0eCA8IHggKyAxOyB0eCsrKSB7CiAgICAgICAgcGl4ZWxzW3R5XVt0eF0gPSByYzsKICAgICAgfQogICAgfQoKICAgIHBpeGVsc1t5ICsgMV1beF0gPSByYzsKICB9CgogIGZ1bmN0aW9uIE1vdXNlSGFuZGxlcihlKSB7CiAgICBsZXQgeyB0YXJnZXQsIGJ1dHRvbnMsIHR5cGUgfSA9IGU7CgogICAgaWYoJ3RvdWNoZXMnIGluIGUpIHsKICAgICAgZm9yKGxldCB0b3VjaCBvZiBbLi4uZS50b3VjaGVzXSkgewogICAgICAgIGNvbnN0IHsgY2xpZW50WCwgY2xpZW50WSB9ID0gdG91Y2g7CiAgICAgICAgTW91c2VIYW5kbGVyKHsKICAgICAgICAgIHR5cGUsCiAgICAgICAgICB0YXJnZXQsCiAgICAgICAgICBidXR0b25zLAogICAgICAgICAgb2Zmc2V0WDogTWF0aC50cnVuYyhjbGllbnRYKSAtIHJlY3QueCwKICAgICAgICAgIG9mZnNldFk6IE1hdGgudHJ1bmMoY2xpZW50WSkgLSByZWN0LnkKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9CgogICAgZ2xvYmFsVGhpcy5wb2ludGVyRXZlbnQgPSBlOwoKICAgIGNvbnN0IHggPSBNYXRoLnJvdW5kKChlLm9mZnNldFggKiB3aWR0aCkgLyByZWN0LndpZHRoKTsKICAgIGNvbnN0IHkgPSBNYXRoLnJvdW5kKChlLm9mZnNldFkgKiBoZWlnaHQpIC8gcmVjdC5oZWlnaHQpOwoKICAgIHRyeSB7CiAgICAgIGlmKC8oZG93bnxzdGFydCkkLy50ZXN0KHR5cGUpKSByYyA9IHBpeGVsc1t5XVt4XSA+IDB4MzAgPyAwIDogUmFuZG9tQnl0ZSgpIHwgMHg4MDsKCiAgICAgIEJsYXplKHgsIHkpOwogICAgfSBjYXRjaChlKSB7fQogIH0KCiAgZnVuY3Rpb24gUmVzaXplSGFuZGxlcihlKSB7CiAgICByZWN0ID0gY2FudmFzUmVjdDsKICAgIG1vdXNlVHJhbnNmb3JtID0gUG9zaXRpb25Qcm9jZXNzb3IoKTsKICAgIGNvbnNvbGUubG9nKCdSZXNpemVIYW5kbGVyJywgeyBlLCByZWN0IH0pOwogIH0KCiAgZnVuY3Rpb24gT3JpZW50YXRpb25DaGFuZ2UoZSkgewogICAgcmVjdCA9IGNhbnZhc1JlY3Q7CiAgICBtb3VzZVRyYW5zZm9ybSA9IFBvc2l0aW9uUHJvY2Vzc29yKCk7CiAgICBjb25zb2xlLmxvZygnT3JpZW50YXRpb25DaGFuZ2UnLCB7IGUsIHJlY3QgfSk7CiAgfQoKICBPYmplY3QuYXNzaWduKGdsb2JhbFRoaXMsIHsgUmFuZG9tQnl0ZSB9KTsKCiAgZnVuY3Rpb24gSW5pdCgpIHsKICAgIHdpbmRvdy5jYW52YXMgPSBlbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignY2FudmFzJyk7CgogICAgZGVmaW5lKAogICAgICBnbG9iYWxUaGlzLAogICAgICBwcm9wZXJ0aWVzKHsKICAgICAgICBjYW52YXNFbGVtZW50OiAoKSA9PiBFbGVtZW50LmZpbmQoJ2NhbnZhcycpLAogICAgICAgIGRpdkVsZW1lbnQ6ICgpID0+IEVsZW1lbnQuZmluZCgnYm9keSA+IGRpdjpmaXJzdC1jaGlsZCcpCiAgICAgIH0pLAogICAgICBwcm9wZXJ0aWVzKHsKICAgICAgICB3aW5kb3dSZWN0OiAoKSA9PiBuZXcgUmVjdCh3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KSwKICAgICAgICBib2R5UmVjdDogKCkgPT4gRWxlbWVudC5yZWN0KCdib2R5Jykucm91bmQoMCksCiAgICAgICAgY2FudmFzUmVjdDogKCkgPT4gRWxlbWVudC5yZWN0KCdjYW52YXMnKS5yb3VuZCgwKSwKICAgICAgICBkaXZSZWN0OiAoKSA9PiBFbGVtZW50LnJlY3QoJ2JvZHkgPiBkaXY6Zmlyc3QtY2hpbGQnKS5yb3VuZCgwKQogICAgICB9KSwKICAgICAgewogICAgICAgIGdldFJlY3QKICAgICAgfSwKICAgICAgcHJvcGVydGllcyh7CiAgICAgICAgdHJhbnNmb3JtOiBbKCkgPT4gbmV3IFRyYW5zZm9ybWF0aW9uTGlzdChFbGVtZW50LmdldENTUygnYm9keSA+IGRpdjpmaXJzdC1jaGlsZCcpLnRyYW5zZm9ybSksIHZhbHVlID0+IEVsZW1lbnQuc2V0Q1NTKCdib2R5ID4gZGl2OmZpcnN0LWNoaWxkJywgeyB0cmFuc2Zvcm06IHZhbHVlICsgJycgfSldCiAgICAgIH0pCiAgICApOwoKICAgICBjb25zdCBTVkdDb21wb25lbnQgPSBwcm9wcyA9PiB7CiAgICAgIGNvbnN0IHJlY3QgPSBFbGVtZW50LnJlY3QoZG9jdW1lbnQuYm9keSkucm91bmQoMSk7CiAgICAgIGNvbnN0IHsgd2lkdGgsIGhlaWdodCB9ID0gcmVjdDsKCiAgICAgIHJldHVybiBoKCdzdmcnLCB7IHZlcnNpb246ICcxLjEnLCB4bWxuczogJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgdmlld0JveDogWy4uLnJlY3RdLmpvaW4oJyAnKSwgd2lkdGgsIGhlaWdodCB9LCBbXSk7CiAgICB9OwoKICAgIGxldCBzdmdDb250YWluZXIgPSBFbGVtZW50LmNyZWF0ZSgnZGl2Jywge30sIGRvY3VtZW50LmJvZHkpOwogICAgRWxlbWVudC5zZXRDU1Moc3ZnQ29udGFpbmVyLCB7IHBvc2l0aW9uOiAnYWJzb2x1dGUnLCB0b3A6IDAsIGxlZnQ6IDAsIHpJbmRleDogOTk5OTk5OTksIHBvaW50ZXJFdmVudHM6ICdub25lJyB9KTsKICAKcmVuZGVyKGgoU1ZHQ29tcG9uZW50KSwgc3ZnQ29udGFpbmVyKTsKCiAgICByZWN0ID0gY2FudmFzUmVjdDsKICAgIG1vdXNlVHJhbnNmb3JtID0gUG9zaXRpb25Qcm9jZXNzb3IoKTsKCiAgICAoYXN5bmMgZnVuY3Rpb24oKSB7CiAgICAgIGZvciBhd2FpdChsZXQgZXZlbnQgb2Ygc3RyZWFtaWZ5KFsnb3JpZW50YXRpb25jaGFuZ2UnLCAncmVzaXplJ10sIGRvY3VtZW50KSkgewogICAgICAgIGNvbnNvbGUubG9nKGV2ZW50LnR5cGUsIGV2ZW50KTsKICAgICAgICBnbG9iYWxUaGlzW2V2ZW50LnR5cGVdID0gZXZlbnQ7CiAgICAgIH0KICAgIH0pKCk7CgogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIFJlc2l6ZUhhbmRsZXIsIHRydWUpOwogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ29yaWVudGF0aW9uY2hhbmdlJywgT3JpZW50YXRpb25DaGFuZ2UsIHRydWUpOwoKICAgIC8qICAgY29uc3QgaGFuZGxlciA9IE1vdXNlSGFuZGxlcjsKCiAgICBzdWJzY3JpYmUoTW92ZW1lbnRJdGVyYXRvcihlbGVtZW50KSwgaGFuZGxlcik7Ki8KICB9CgogIGdsb2JhbFRoaXMud3MgPSAoZ2xvYmFsVGhpcy5yd3MgPz89IE5ld1dTKCkpLndzOwoKICAoYXN5bmMgZnVuY3Rpb24oKSB7CiAgICBsZXQgdHJhaWwgPSBbXSwKICAgICAgc3RhcnQsCiAgICAgIGxhc3Q7CiAgICBmb3IoOzspIHsKICAgICAgbGV0IHByZXYsIHB0OwoKICAgICAgZm9yIGF3YWl0KGxldCBldiBvZiBNb3ZlbWVudEl0ZXJhdG9yKHdpbmRvdykpIHsKICAgICAgICBpZighZ2xvYmFsVGhpcy5jaWQpIHsKICAgICAgICAgIGdsb2JhbFRoaXMuY2lkID8/PSBNYWtlQ2xpZW50SUQoKTsKCiAgICAgICAgICB3cy5zZW5kKEpTT04uc3RyaW5naWZ5KHsgdHlwZTogJ2hlbGxvJywgY2lkIH0pKTsKICAgICAgICB9CgogICAgICAgIGlmKHJlY3QuaW5zaWRlKGV2KSkgewogICAgICAgICAgbGV0IHB0ID0gKGdsb2JhbFRoaXMubW91c2VQb3MgPSBtb3VzZVRyYW5zZm9ybShldikpOwogICAgICAgICAgbGV0IGRpZmYgPSBwdCwKICAgICAgICAgICAgdDsKICAgICAgICAgIGlmKHByZXYpIGRpZmYgPSBwdC5kaWZmKHByZXYpOwoKICAgICAgICAgIHN0YXJ0ID8/PSB0ID0gRGF0ZS5ub3coKTsKCiAgICAgICAgICAvL3RyYWlsLnB1c2goeyAuLi5wdCwgdGltZTogRGF0ZS5ub3coKSAgLXN0YXJ0ICB9KTsKICAgICAgICAgIHRyYWlsLnB1c2godCAtIHN0YXJ0ICsgJy8nICsgKHByZXYgJiYgZGlmZi54ID4gMCA/ICcrJyA6ICcnKSArIGRpZmYueCArICcsJyArIChwcmV2ICYmIGRpZmYueSA+IDAgPyAnKycgOiAnJykgKyBkaWZmLnkpOwoKICAgICAgICAgIGxhc3QgPSB0OwogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnYmxhemUnLCAuLi5wdCk7CiAgICAgICAgICAgIHJjID0gcGl4ZWxzW3B0LnldW3B0LnhdID4gMHgzMCA/IDAgOiBSYW5kb21CeXRlKCkgfCAweDgwOwoKICAgICAgICAgICAgQmxhemUocHQueCwgcHQueSk7CiAgICAgICAgICB9IGNhdGNoKGUpIHt9CiAgICAgICAgICBwcmV2ID0gcHQ7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU2VuZFRyYWlsKCkgewogICAgICB3cy5zZW5kKEpTT04uc3RyaW5naWZ5KHsgdHlwZTogJ2JsYXplJywgc3RhcnQsIHRyYWlsOiB0cmFpbC5qb2luKCcgJykgfSkpOwoKICAgICAgdHJhaWwuc3BsaWNlKDAsIHRyYWlsLmxlbmd0aCk7CiAgICAgIHN0YXJ0ID0gdW5kZWZpbmVkOwogICAgICBwcmV2ID0gdW5kZWZpbmVkOwogICAgfQogIH0pKCk7CgogIExvb3AoKTsKfQoKZGVmaW5lKGdsb2JhbFRoaXMsIHsgY3Jvc3NraXQsIFJHQkEsIEhTTEEsIFV0aWwsIE1hdHJpeCwgVHJhbnNmb3JtYXRpb25MaXN0IH0pOwpkZWZpbmUoZ2xvYmFsVGhpcywgeyBXZWJTb2NrZXRJdGVyYXRvciwgV2ViU29ja2V0VVJMLCBDcmVhdGVXZWJTb2NrZXQsIE5ld1dTLCBSZWNvbm5lY3RpbmdXZWJTb2NrZXQgfSk7CmRlZmluZShnbG9iYWxUaGlzLCB7IGRlZmluZSwgaXNVbmRlZmluZWQsIHByb3BlcnRpZXMsIGtleXMgfSk7CmRlZmluZShnbG9iYWxUaGlzLCB7IG9uY2UsIHN0cmVhbWlmeSwgdGhyb3R0bGUsIGRpc3RpbmN0LCBzdWJzY3JpYmUgfSk7CmRlZmluZShnbG9iYWxUaGlzLCB7IEludGVyc2VjdGlvbiwgTWF0cml4LCBpc1JlY3QsIFJlY3QsIFNpemUsIFBvaW50LCBMaW5lLCBUcmFuc2Zvcm1hdGlvbkxpc3QsIFZlY3RvciB9KTsKZGVmaW5lKGdsb2JhbFRoaXMsIHsKICB0aW1lciwKICBNYWtlVVVJRCwKICBNYWtlQ2xpZW50SUQsCiAgaXNTdHJlYW0sCiAgQWNxdWlyZVJlYWRlciwKICBBY3F1aXJlV3JpdGVyLAogIEFycmF5V3JpdGVyLAogIHJlYWRTdHJlYW0sCiAgUGlwZVRvLAogIFdyaXRhYmxlUmVwZWF0ZXIsCiAgV3JpdGVJdGVyYXRvciwKICBBc3luY1dyaXRlLAogIEFzeW5jUmVhZCwKICBSZWFkRnJvbUl0ZXJhdG9yLAogIFdyaXRlVG9SZXBlYXRlciwKICBMb2dTaW5rLAogIFN0cmluZ1JlYWRlciwKICBMaW5lUmVhZGVyLAogIERlYnVnVHJhbnNmb3JtU3RyZWFtLAogIENyZWF0ZVdyaXRhYmxlU3RyZWFtLAogIENyZWF0ZVRyYW5zZm9ybVN0cmVhbSwKICBSZXBlYXRlclNvdXJjZSwKICBSZXBlYXRlclNpbmssCiAgTGluZUJ1ZmZlclN0cmVhbSwKICBUZXh0VHJhbnNmb3JtU3RyZWFtLAogIENodW5rUmVhZGVyLAogIEJ5dGVSZWFkZXIsCiAgUGlwZVRvUmVwZWF0ZXIsCiAgUmVhZGVyLAogIFJlYWRBbGwsCiAgU3RyZWFtUmVhZEl0ZXJhdG9yCn0pOwoKZGVmaW5lKGdsb2JhbFRoaXMsIHsgRWxlbWVudCwgaXNFbGVtZW50LCBTVkcsIFJlYWN0LCBoLCBodG1sLCByZW5kZXIsIEZyYWdtZW50LCBDb21wb25lbnQsIGNyZWF0ZVJlZiwgdXNlU3RhdGUsIHVzZUxheW91dEVmZmVjdCwgdXNlUmVmLCB0b0NoaWxkQXJyYXkgfSk7CgptYWluKCk7CgpmdW5jdGlvbiBnZXRSZWN0KGVsZW0pIHsKICByZXR1cm4gbmV3IFJlY3QoKGVsZW0gPz8gZGl2RWxlbWVudCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkpLnJvdW5kKDEpOwp9CgAAAAAAAAAAODYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAoSoAAAAAAAChKgAAAAAAAAAAAAAAAPC/"
				],
				[
					824,
					1,
					"insert",
					{
						"characters": "\n"
					},
					"AQAAADYpAAAAAAAANykAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAANikAAAAAAAA2KQAAAAAAAAAAAAAAAIJA"
				],
				[
					827,
					1,
					"insert",
					{
						"characters": "$"
					},
					"AQAAALUpAAAAAAAAtikAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAtSkAAAAAAAC1KQAAAAAAAAAAAAAAAPC/"
				],
				[
					828,
					1,
					"insert",
					{
						"characters": "\n\n"
					},
					"BwAAALYpAAAAAAAAtykAAAAAAAAAAAAAtykAAAAAAAC9KQAAAAAAAAAAAAC3KQAAAAAAALcpAAAAAAAABgAAACAgICAgILcpAAAAAAAAvykAAAAAAAAAAAAAvykAAAAAAADAKQAAAAAAAAAAAADAKQAAAAAAAMgpAAAAAAAAAAAAALcpAAAAAAAAtykAAAAAAAAIAAAAICAgICAgICA",
					"AQAAAAAAAAABAAAAtikAAAAAAAC2KQAAAAAAAAAAAAAAAPC/"
				],
				[
					831,
					1,
					"left_delete",
					null,
					"AQAAALUpAAAAAAAAtSkAAAAAAAABAAAAJA",
					"AQAAAAAAAAABAAAAtikAAAAAAAC2KQAAAAAAAAAAAAAAAPC/"
				],
				[
					834,
					1,
					"",
					null,
					"AQAAALYpAAAAAAAAMioAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAtikAAAAAAAC2KQAAAAAAAAAAAAAAAPC/"
				],
				[
					840,
					1,
					"insert",
					{
						"characters": "h"
					},
					"AgAAALYpAAAAAAAAtykAAAAAAAAAAAAAtykAAAAAAAC3KQAAAAAAAAoAAABTVkcuY3JlYXRl",
					"AQAAAAAAAAABAAAAtikAAAAAAADAKQAAAAAAAAAAAAAAAPC/"
				],
				[
					856,
					1,
					"paste",
					null,
					"AgAAAMgpAAAAAAAAzCkAAAAAAAAAAAAAzCkAAAAAAADMKQAAAAAAAAYAAAB3aW5kb3c",
					"AQAAAAAAAAABAAAAyCkAAAAAAADOKQAAAAAAAAAAAAAAAPC/"
				],
				[
					857,
					1,
					"insert",
					{
						"characters": ".r"
					},
					"AgAAAMwpAAAAAAAAzSkAAAAAAAAAAAAAzSkAAAAAAADOKQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAzCkAAAAAAADMKQAAAAAAAAAAAAAAAPC/"
				],
				[
					858,
					1,
					"left_delete",
					null,
					"AQAAAM0pAAAAAAAAzSkAAAAAAAABAAAAcg",
					"AQAAAAAAAAABAAAAzikAAAAAAADOKQAAAAAAAAAAAAAAAPC/"
				],
				[
					859,
					1,
					"insert",
					{
						"characters": "wdth"
					},
					"BAAAAM0pAAAAAAAAzikAAAAAAAAAAAAAzikAAAAAAADPKQAAAAAAAAAAAADPKQAAAAAAANApAAAAAAAAAAAAANApAAAAAAAA0SkAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAzSkAAAAAAADNKQAAAAAAAAAAAAAAAPC/"
				],
				[
					860,
					3,
					"left_delete",
					null,
					"AwAAANApAAAAAAAA0CkAAAAAAAABAAAAaM8pAAAAAAAAzykAAAAAAAABAAAAdM4pAAAAAAAAzikAAAAAAAABAAAAZA",
					"AQAAAAAAAAABAAAA0SkAAAAAAADRKQAAAAAAAAAAAAAAAPC/"
				],
				[
					861,
					1,
					"insert",
					{
						"characters": "dt"
					},
					"AgAAAM4pAAAAAAAAzykAAAAAAAAAAAAAzykAAAAAAADQKQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAzikAAAAAAADOKQAAAAAAAAAAAAAAAPC/"
				],
				[
					903,
					1,
					"insert",
					{
						"characters": "ce,."
					},
					"BAAAAM0pAAAAAAAAzikAAAAAAAAAAAAAzikAAAAAAADPKQAAAAAAAAAAAADPKQAAAAAAANApAAAAAAAAAAAAANApAAAAAAAA0SkAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAzSkAAAAAAADNKQAAAAAAAAAAAAAAAPC/"
				],
				[
					904,
					2,
					"left_delete",
					null,
					"AgAAANApAAAAAAAA0CkAAAAAAAABAAAALs8pAAAAAAAAzykAAAAAAAABAAAALA",
					"AQAAAAAAAAABAAAA0SkAAAAAAADRKQAAAAAAAAAAAAAAAPC/"
				],
				[
					905,
					1,
					"insert",
					{
						"characters": "nter.x"
					},
					"BgAAAM8pAAAAAAAA0CkAAAAAAAAAAAAA0CkAAAAAAADRKQAAAAAAAAAAAADRKQAAAAAAANIpAAAAAAAAAAAAANIpAAAAAAAA0ykAAAAAAAAAAAAA0ykAAAAAAADUKQAAAAAAAAAAAADUKQAAAAAAANUpAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAzykAAAAAAADPKQAAAAAAAAAAAAAAAPC/"
				],
				[
					907,
					1,
					"left_delete",
					null,
					"AQAAANUpAAAAAAAA1SkAAAAAAAAQAAAAd2R0LmlubmVyV2lkdGgvMg",
					"AQAAAAAAAAABAAAA1SkAAAAAAADlKQAAAAAAAAAAAAAAAPC/"
				],
				[
					911,
					1,
					"insert",
					{
						"characters": "cenmter"
					},
					"BwAAAB4pAAAAAAAAHykAAAAAAAAAAAAAHykAAAAAAAAgKQAAAAAAAAAAAAAgKQAAAAAAACEpAAAAAAAAAAAAACEpAAAAAAAAIikAAAAAAAAAAAAAIikAAAAAAAAjKQAAAAAAAAAAAAAjKQAAAAAAACQpAAAAAAAAAAAAACQpAAAAAAAAJSkAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAHikAAAAAAAAeKQAAAAAAAAAAAAAAAPC/"
				],
				[
					912,
					4,
					"left_delete",
					null,
					"BAAAACQpAAAAAAAAJCkAAAAAAAABAAAAciMpAAAAAAAAIykAAAAAAAABAAAAZSIpAAAAAAAAIikAAAAAAAABAAAAdCEpAAAAAAAAISkAAAAAAAABAAAAbQ",
					"AQAAAAAAAAABAAAAJSkAAAAAAAAlKQAAAAAAAAAAAAAAAPC/"
				],
				[
					913,
					1,
					"insert",
					{
						"characters": "ter,"
					},
					"BAAAACEpAAAAAAAAIikAAAAAAAAAAAAAIikAAAAAAAAjKQAAAAAAAAAAAAAjKQAAAAAAACQpAAAAAAAAAAAAACQpAAAAAAAAJSkAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAISkAAAAAAAAhKQAAAAAAAAAAAAAAAPC/"
				],
				[
					914,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAACUpAAAAAAAAJikAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAJSkAAAAAAAAlKQAAAAAAAAAAAAAAAPC/"
				],
				[
					916,
					4,
					"left_delete",
					null,
					"BAAAANMpAAAAAAAA0ykAAAAAAAABAAAAdNIpAAAAAAAA0ikAAAAAAAABAAAAY9EpAAAAAAAA0SkAAAAAAAABAAAAZdApAAAAAAAA0CkAAAAAAAABAAAAcg",
					"AQAAAAAAAAABAAAA1CkAAAAAAADUKQAAAAAAAAAAAAAAwGhA"
				],
				[
					917,
					1,
					"right_delete",
					null,
					"AQAAANApAAAAAAAA0CkAAAAAAAABAAAALg",
					"AQAAAAAAAAABAAAA0CkAAAAAAADQKQAAAAAAAAAAAAAAAPC/"
				],
				[
					921,
					2,
					"left_delete",
					null,
					"AgAAAN8pAAAAAAAA3ykAAAAAAAATAAAAaW5kb3cuaW5uZXJIZWlnaHQvMt4pAAAAAAAA3ikAAAAAAAABAAAAdw",
					"AQAAAAAAAAABAAAA3ykAAAAAAADyKQAAAAAAAAAAAAAAAPC/"
				],
				[
					922,
					1,
					"insert",
					{
						"characters": "center.y"
					},
					"CAAAAN4pAAAAAAAA3ykAAAAAAAAAAAAA3ykAAAAAAADgKQAAAAAAAAAAAADgKQAAAAAAAOEpAAAAAAAAAAAAAOEpAAAAAAAA4ikAAAAAAAAAAAAA4ikAAAAAAADjKQAAAAAAAAAAAADjKQAAAAAAAOQpAAAAAAAAAAAAAOQpAAAAAAAA5SkAAAAAAAAAAAAA5SkAAAAAAADmKQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA3ikAAAAAAADeKQAAAAAAAAAAAAAAAPC/"
				],
				[
					937,
					4,
					"left_delete",
					null,
					"BAAAABgqAAAAAAAAGCoAAAAAAAABAAAAZxcqAAAAAAAAFyoAAAAAAAABAAAAdhYqAAAAAAAAFioAAAAAAAABAAAAcxUqAAAAAAAAFSoAAAAAAAABAAAALA",
					"AQAAAAAAAAABAAAAGSoAAAAAAAAZKgAAAAAAAAAAAAAAAPC/"
				],
				[
					948,
					1,
					"right_delete",
					null,
					"AQAAAOwpAAAAAAAA7CkAAAAAAAABAAAAMA",
					"AQAAAAAAAAABAAAA7CkAAAAAAADsKQAAAAAAAAAAAAAAAPC/"
				],
				[
					949,
					1,
					"insert",
					{
						"characters": "5"
					},
					"AQAAAOwpAAAAAAAA7SkAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA7CkAAAAAAADsKQAAAAAAAAAAAAAAAPC/"
				],
				[
					955,
					1,
					"left_delete",
					null,
					"AQAAABIqAAAAAAAAEioAAAAAAAABAAAAMg",
					"AQAAAAAAAAABAAAAEyoAAAAAAAATKgAAAAAAAAAAAAAAAPC/"
				],
				[
					956,
					1,
					"insert",
					{
						"characters": "1"
					},
					"AQAAABIqAAAAAAAAEyoAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAEioAAAAAAAASKgAAAAAAAAAAAAAAAPC/"
				],
				[
					962,
					1,
					"insert",
					{
						"characters": ","
					},
					"AQAAABMqAAAAAAAAFCoAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAEyoAAAAAAAATKgAAAAAAAAAAAAAAAPC/"
				],
				[
					963,
					1,
					"insert",
					{
						"characters": " fiolo"
					},
					"BgAAABQqAAAAAAAAFSoAAAAAAAAAAAAAFSoAAAAAAAAWKgAAAAAAAAAAAAAWKgAAAAAAABcqAAAAAAAAAAAAABcqAAAAAAAAGCoAAAAAAAAAAAAAGCoAAAAAAAAZKgAAAAAAAAAAAAAZKgAAAAAAABoqAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAFCoAAAAAAAAUKgAAAAAAAAAAAAAAAPC/"
				],
				[
					964,
					3,
					"left_delete",
					null,
					"AwAAABkqAAAAAAAAGSoAAAAAAAABAAAAbxgqAAAAAAAAGCoAAAAAAAABAAAAbBcqAAAAAAAAFyoAAAAAAAABAAAAbw",
					"AQAAAAAAAAABAAAAGioAAAAAAAAaKgAAAAAAAAAAAAAAAPC/"
				],
				[
					965,
					1,
					"insert",
					{
						"characters": "lL"
					},
					"AgAAABcqAAAAAAAAGCoAAAAAAAAAAAAAGCoAAAAAAAAZKgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAFyoAAAAAAAAXKgAAAAAAAAAAAAAAAPC/"
				],
				[
					966,
					1,
					"left_delete",
					null,
					"AQAAABgqAAAAAAAAGCoAAAAAAAABAAAATA",
					"AQAAAAAAAAABAAAAGSoAAAAAAAAZKgAAAAAAAAAAAAAAAPC/"
				],
				[
					967,
					1,
					"insert",
					{
						"characters": "l:"
					},
					"AgAAABgqAAAAAAAAGSoAAAAAAAAAAAAAGSoAAAAAAAAaKgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAGCoAAAAAAAAYKgAAAAAAAAAAAAAAAPC/"
				],
				[
					968,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAABoqAAAAAAAAGyoAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAGioAAAAAAAAaKgAAAAAAAAAAAAAAAPC/"
				],
				[
					969,
					1,
					"insert_snippet",
					{
						"contents": "`$0`"
					},
					"AQAAABsqAAAAAAAAHSoAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAGyoAAAAAAAAbKgAAAAAAAAAAAAAAAPC/"
				],
				[
					970,
					1,
					"insert",
					{
						"characters": "rgba/("
					},
					"BgAAABwqAAAAAAAAHSoAAAAAAAAAAAAAHSoAAAAAAAAeKgAAAAAAAAAAAAAeKgAAAAAAAB8qAAAAAAAAAAAAAB8qAAAAAAAAICoAAAAAAAAAAAAAICoAAAAAAAAhKgAAAAAAAAAAAAAhKgAAAAAAACIqAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAHCoAAAAAAAAcKgAAAAAAAAAAAAAAAPC/"
				],
				[
					971,
					2,
					"left_delete",
					null,
					"AgAAACEqAAAAAAAAISoAAAAAAAABAAAAKCAqAAAAAAAAICoAAAAAAAABAAAALw",
					"AQAAAAAAAAABAAAAIioAAAAAAAAiKgAAAAAAAAAAAAAAAPC/"
				],
				[
					972,
					1,
					"insert",
					{
						"characters": "("
					},
					"AQAAACAqAAAAAAAAISoAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAICoAAAAAAAAgKgAAAAAAAAAAAAAAAPC/"
				],
				[
					975,
					1,
					"insert",
					{
						"characters": "80,80,80,"
					},
					"CQAAACEqAAAAAAAAIioAAAAAAAAAAAAAIioAAAAAAAAjKgAAAAAAAAAAAAAjKgAAAAAAACQqAAAAAAAAAAAAACQqAAAAAAAAJSoAAAAAAAAAAAAAJSoAAAAAAAAmKgAAAAAAAAAAAAAmKgAAAAAAACcqAAAAAAAAAAAAACcqAAAAAAAAKCoAAAAAAAAAAAAAKCoAAAAAAAApKgAAAAAAAAAAAAApKgAAAAAAACoqAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAISoAAAAAAAAhKgAAAAAAAAAAAAAAAPC/"
				],
				[
					976,
					1,
					"insert",
					{
						"characters": "0.3)"
					},
					"BAAAACoqAAAAAAAAKyoAAAAAAAAAAAAAKyoAAAAAAAAsKgAAAAAAAAAAAAAsKgAAAAAAAC0qAAAAAAAAAAAAAC0qAAAAAAAALioAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAKioAAAAAAAAqKgAAAAAAAAAAAAAAAPC/"
				],
				[
					985,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAAC/NgAAaW1wb3J0IHsgY3Jvc3NraXQsIENBTlZBUyB9IGZyb20gJy4vbGliL2Nyb3Nza2l0LmpzJzsKaW1wb3J0IHsgUkdCQSwgSFNMQSB9IGZyb20gJy4vbGliL2NvbG9yLmpzJzsKaW1wb3J0IHsgdGltZXIgfSBmcm9tICcuL2xpYi9hc3luYy9oZWxwZXJzLmpzJzsKaW1wb3J0IHsgV2ViU29ja2V0SXRlcmF0b3IsIFdlYlNvY2tldFVSTCwgQ3JlYXRlV2ViU29ja2V0LCBSZWNvbm5lY3RpbmdXZWJTb2NrZXQsIFN0cmVhbVJlYWRJdGVyYXRvciB9IGZyb20gJy4vbGliL2FzeW5jL3dlYnNvY2tldC5qcyc7CmltcG9ydCB7IG9uY2UsIHN0cmVhbWlmeSwgdGhyb3R0bGUsIGRpc3RpbmN0LCBzdWJzY3JpYmUgfSBmcm9tICcuL2xpYi9hc3luYy9ldmVudHMuanMnOwppbXBvcnQgeyBtZW1vaXplLCBkZWZpbmUsIGlzVW5kZWZpbmVkLCBwcm9wZXJ0aWVzLCBrZXlzLCB1bmlxdWUsIHJhbmRTdHIsIHJhbmRJbnQgfSBmcm9tICcuL2xpYi9taXNjLmpzJzsKaW1wb3J0IHsgaXNTdHJlYW0sIEFjcXVpcmVSZWFkZXIsIEFjcXVpcmVXcml0ZXIsIEFycmF5V3JpdGVyLCByZWFkU3RyZWFtLCBQaXBlVG8sIFdyaXRhYmxlUmVwZWF0ZXIsIFdyaXRlSXRlcmF0b3IsIEFzeW5jV3JpdGUsIEFzeW5jUmVhZCwgUmVhZEZyb21JdGVyYXRvciwgV3JpdGVUb1JlcGVhdGVyLCBMb2dTaW5rLCBTdHJpbmdSZWFkZXIsIExpbmVSZWFkZXIsIERlYnVnVHJhbnNmb3JtU3RyZWFtLCBDcmVhdGVXcml0YWJsZVN0cmVhbSwgQ3JlYXRlVHJhbnNmb3JtU3RyZWFtLCBSZXBlYXRlclNvdXJjZSwgUmVwZWF0ZXJTaW5rLCBMaW5lQnVmZmVyU3RyZWFtLCBUZXh0VHJhbnNmb3JtU3RyZWFtLCBDaHVua1JlYWRlciwgQnl0ZVJlYWRlciwgUGlwZVRvUmVwZWF0ZXIsIFJlYWRlciwgUmVhZEFsbCwgZGVmYXVsdCBhcyB1dGlscyB9IGZyb20gJy4vbGliL3N0cmVhbS91dGlscy5qcyc7CmltcG9ydCB7IEludGVyc2VjdGlvbiwgTWF0cml4LCBpc1JlY3QsIFJlY3QsIFNpemUsIFBvaW50LCBMaW5lLCBUcmFuc2Zvcm1hdGlvbkxpc3QsIFZlY3RvciB9IGZyb20gJy4vbGliL2dlb20uanMnOwppbXBvcnQgeyBFbGVtZW50LCBpc0VsZW1lbnQsIFNWRyB9IGZyb20gJy4vbGliL2RvbS5qcyc7CmltcG9ydCBSZWFjdCwgeyBoLCBodG1sLCByZW5kZXIsIEZyYWdtZW50LCBDb21wb25lbnQsIGNyZWF0ZVJlZiwgdXNlU3RhdGUsIHVzZUxheW91dEVmZmVjdCwgdXNlUmVmLCB0b0NoaWxkQXJyYXkgfSBmcm9tICcuL2xpYi9kb20vcHJlYWN0Q29tcG9uZW50LmpzJzsKCmZ1bmN0aW9uIE5ld1dTKCkgewogIGxldCB1cmwgPSBXZWJTb2NrZXRVUkwoJy93cycsIHsgbWlycm9yOiBjdXJyZW50RmlsZSB9KTsKICBsZXQgd3MgPSBuZXcgUmVjb25uZWN0aW5nV2ViU29ja2V0KHVybCwgJ2x3cy1taXJyb3ItcHJvdG9jb2wnKTsKICAoYXN5bmMgZnVuY3Rpb24oKSB7CiAgICBmb3IgYXdhaXQobGV0IGNodW5rIG9mIHdzKSB7CiAgICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShjaHVuayk7CgogICAgICBpZihkYXRhLmNpZCAhPSBnbG9iYWxUaGlzLmNpZCkgY29uc29sZS5sb2coJ1dTIHJlY2VpdmU6JywgZGF0YSk7CiAgICB9CiAgfSkoKTsKICByZXR1cm4gKGdsb2JhbFRoaXMud3MgPSB3cyk7Cn0KCmNvbnN0IE1ha2VVVUlEID0gKHJuZyA9IE1hdGgucmFuZG9tKSA9PiBbOCwgNCwgNCwgNCwgMTJdLm1hcChuID0+IHJhbmRTdHIobiwgJzAxMjM0NTY3ODlhYmNkZWYnKSwgcm5nKS5qb2luKCctJyk7CmNvbnN0IE1ha2VDbGllbnRJRCA9IChybmcgPSBNYXRoLnJhbmRvbSkgPT4gWzQsIDQsIDQsIDRdLm1hcChuID0+IHJhbmRTdHIobiwgWydBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWicsICdhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicsICcuLSQnXVtyYW5kSW50KDAsIDMpXSksIHJuZykuam9pbignJyk7CgpmdW5jdGlvbiBtYWluKCkgewogIGRlZmluZSgKICAgIGdsb2JhbFRoaXMsCiAgICBwcm9wZXJ0aWVzKAogICAgICB7CiAgICAgICAgY3VycmVudFVSTDogKCkgPT4gbmV3IFVSTChpbXBvcnQubWV0YS51cmwpLAogICAgICAgIGN1cnJlbnRGaWxlOiAoKSA9PiBnbG9iYWxUaGlzLmN1cnJlbnRVUkwucGF0aG5hbWUucmVwbGFjZSgvXlwvLywgJycpCiAgICAgIH0sCiAgICAgIHsgbWVtb2l6ZTogdHJ1ZSB9CiAgICApCiAgKTsKCiAgY29uc3Qgd2lkdGggPSAzMjA7CiAgY29uc3QgaGVpZ2h0ID0gMjAwOwogIGNvbnN0IHBhcmVudCA9IGRvY3VtZW50LmJvZHk7CgogIGNyb3Nza2l0LmluaXQoewogICAgcmVuZGVyZXI6IENBTlZBUywKICAgIHBhcmVudCwKICAgIHc6IHdpZHRoLAogICAgaDogaGVpZ2h0LAogICAgYWxwaGE6IGZhbHNlCiAgfSk7CgogIGZ1bmN0aW9uIFJlcGFyZW50KGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdjYW52YXMnKVswXSkgewogICAgY2FudmFzLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoY2FudmFzKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKS5hcHBlbmRDaGlsZChjYW52YXMpOwogIH0KCiAgZnVuY3Rpb24gR2V0RWxlbWVudE1hdHJpeChlbGVtZW50KSB7CiAgICBsZXQgeyB0cmFuc2Zvcm0gfSA9IEVsZW1lbnQuZ2V0Q1NTKGRpdkVsZW1lbnQpOwoKICAgIHJldHVybiBNYXRyaXguZnJvbUNTUyh0cmFuc2Zvcm0pOwogIH0KCiAgZnVuY3Rpb24gU2V0Q3Jvc3NoYWlyKHBvcykgewogICAgbGV0IGNoID0gRWxlbWVudC5maW5kKCcjY3Jvc3NoYWlyJyk7CiAgICBsZXQgcmVjdCA9IEVsZW1lbnQuZ2V0UmVjdChjaCk7CgogICAgY29uc29sZS5sb2coJ1NldENyb3NzaGFpcicsIHsgY2gsIHJlY3QsIHBvcyB9KTsKICAgIHJlY3QueCA9IHBvcy54IC0gcmVjdC53aWR0aCAvIDI7CiAgICByZWN0LnkgPSBwb3MueSAtIHJlY3QuaGVpZ2h0IC8gMjsKCiAgICBFbGVtZW50LnNldFJlY3QoY2gsIHJlY3QpOwogIH0KCiAgZnVuY3Rpb24gRXZlbnRQb3NpdGlvbnMoZXZlbnRPclRvdWNoKSB7CiAgICBsZXQgcG9zaXRpb25zID0gdW5pcXVlKAogICAgICBrZXlzKGV2ZW50T3JUb3VjaCwgMikKICAgICAgICAuZmlsdGVyKG4gPT4gdHlwZW9mIG4gPT0gJ3N0cmluZycgJiYgL1tYWV0kLy50ZXN0KG4pKQogICAgICAgIC5tYXAobiA9PiBuLnNsaWNlKDAsIC0xKSkKICAgICk7CgogICAgcmV0dXJuIHBvc2l0aW9ucy5yZWR1Y2UoKGFjYywga2V5KSA9PiB7CiAgICAgIGFjY1trZXldID0gbmV3IFBvaW50KGV2ZW50T3JUb3VjaFtrZXkgKyAnWCddLCBldmVudE9yVG91Y2hba2V5ICsgJ1knXSk7CiAgICAgIHJldHVybiBhY2M7CiAgICB9LCB7fSk7CiAgfQoKICBmdW5jdGlvbiBQb3NpdGlvbk1hdHJpeChjYW52YXMgPSBjYW52YXNFbGVtZW50LCByZWN0ID0gY2FudmFzUmVjdCkgewogICAgbGV0IHZlcnRpY2FsID0gcmVjdC5hc3BlY3QoKSA8IDE7CiAgICBsZXQgdG9wTGVmdCA9IHJlY3QudG9Qb2ludHMoKVt2ZXJ0aWNhbCA/IDEgOiAwXTsKICAgIGxldCBtID0gTWF0cml4LmlkZW50aXR5KCkuc2NhbGUoY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTsKCiAgICBpZih2ZXJ0aWNhbCkgbSA9IG0ucm90YXRlKC1NYXRoLlBJIC8gMik7CgogICAgbSA9IG0uc2NhbGUoMSAvIHJlY3Qud2lkdGgsIDEgLyByZWN0LmhlaWdodCk7CiAgICBtID0gbS50cmFuc2xhdGUoLXRvcExlZnQueCwgLXRvcExlZnQueSk7CgogICAgcmV0dXJuIG07CiAgfQoKICBmdW5jdGlvbiBQb3NpdGlvblByb2Nlc3NvcihjYW52YXMgPSBjYW52YXNFbGVtZW50LCByZWN0ID0gY2FudmFzUmVjdCkgewogICAgbGV0IG0gPSBQb3NpdGlvbk1hdHJpeChjYW52YXMsIHJlY3QpOwogICAgcmV0dXJuIHBvcyA9PiBuZXcgUG9pbnQoLi4ubS50cmFuc2Zvcm1fcG9pbnQobmV3IFBvaW50KHBvcykpKS5yb3VuZCgxKTsKICB9CgogIGZ1bmN0aW9uIFByb2Nlc3NQb3NpdGlvbihwb3MpIHsKICAgIHJldHVybiBQb3NpdGlvblByb2Nlc3NvcigpKHBvcyk7CiAgfQoKICBhc3luYyBmdW5jdGlvbiogTW92ZW1lbnRJdGVyYXRvcihlbGVtZW50KSB7CiAgICBsZXQgZXYgPSBhd2FpdCBvbmNlKGVsZW1lbnQsICdtb3VzZWRvd24nLCAndG91Y2hzdGFydCcpOwogICAgbGV0IHR5cGUgPSBldi50eXBlLnNsaWNlKDAsIDUpOwogICAgeWllbGQgZXY7CiAgICBjb25zb2xlLmxvZyh0eXBlICsgJyBzdGFydCcpOwogICAgZm9yIGF3YWl0KGxldCBldmVudCBvZiBzdHJlYW1pZnkoWydtb3VzZXVwJywgJ21vdXNlbW92ZScsICd0b3VjaGVuZCcsICd0b3VjaG1vdmUnXSwgZWxlbWVudCkpIHsKICAgICAgLy9ldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBpZigndG91Y2hlcycgaW4gZXZlbnQpIHsKICAgICAgICBpZihldmVudC50b3VjaGVzLmxlbmd0aCkgewogICAgICAgICAgZ2xvYmFsVGhpcy5tb3VzZUV2ZW50ID0gZXZlbnQ7CgogICAgICAgICAgeWllbGQqIFsuLi5ldmVudC50b3VjaGVzXS5tYXAoRXZlbnRQb3NpdGlvbnMpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCB7IHR5cGUsIGNsaWVudFg6IHgsIGNsaWVudFk6IHkgfSA9IGV2ZW50OwogICAgICAgIGxldCBvYmogPSB7IHR5cGUsIHgsIHkgfTsKICAgICAgICB5aWVsZCBvYmo7CiAgICAgIH0KICAgICAgaWYoLyh1cHxlbmQpJC8udGVzdChldmVudC50eXBlKSkgewogICAgICAgIGNvbnNvbGUubG9nKHR5cGUgKyAnIGVuZCcpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQoKICBSZXBhcmVudCgpOwoKICBjcm9zc2tpdC5jbGVhcigpOwogIGNyb3Nza2l0LnJlY3QoewogICAgeDogMCwKICAgIHk6IDAsCiAgICB3aWR0aCwKICAgIGhlaWdodCwKICAgIGZpbGw6ICdibGFjaycsCiAgICBzdHJva2U6ICdibGFjaycsCiAgICBhbmdsZTogMAogIH0pOwoKICBjb25zdCBidWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIod2lkdGggKiAoaGVpZ2h0ICsgMikpOwogIGNvbnN0IHBhbGV0dGUgPSBDcmVhdGVQYWxldHRlKCk7CiAgY29uc3QgcGFsZXR0ZUhTTCA9IENyZWF0ZVBhbGV0dGVIU0woKTsKCiAgY29uc3QgcGl4ZWxzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogaGVpZ2h0ICsgMiB9KS5tYXAoKHYsIGkpID0+IG5ldyBVaW50OENsYW1wZWRBcnJheShidWZmZXIsIGkgKiB3aWR0aCwgd2lkdGgpKTsKICBjb25zdCB7IGNvbnRleHQgfSA9IGNyb3Nza2l0OwogIGNvbnN0IGltYWdlID0gY29udGV4dC5jcmVhdGVJbWFnZURhdGEod2lkdGgsIGhlaWdodCk7CgogIGNvbnN0IHsgbm93LCB3YWl0Rm9yLCBhbmltYXRpb25GcmFtZSB9ID0gVXRpbDsKICBjb25zdCBmcHMgPSA1MDsKICBjb25zdCBtYXRyaXggPSBuZXcgTWF0cml4KCkudHJhbnNsYXRlKDE2MCwgMTAwKS5zY2FsZSgwLjUpOwoKICBPYmplY3QuYXNzaWduKGdsb2JhbFRoaXMsIHsKICAgIGJ1ZmZlciwKICAgIHBhbGV0dGUsCiAgICBwYWxldHRlSFNMLAogICAgcGl4ZWxzLAogICAgY29udGV4dCwKICAgIGltYWdlLAogICAgZnBzLAogICAgbWF0cml4LAogICAgUmVwYXJlbnQsCiAgICBkb206IHsgRWxlbWVudCB9LAogICAgZ2VvbTogeyBSZWN0IH0sCiAgICBNb3ZlbWVudEl0ZXJhdG9yLAogICAgTW91c2VIYW5kbGVyLAogICAgR2V0RWxlbWVudE1hdHJpeCwKICAgIFNldENyb3NzaGFpciwKICAgIEV2ZW50UG9zaXRpb25zLAogICAgUG9zaXRpb25Qcm9jZXNzb3IsCiAgICBQb3NpdGlvbk1hdHJpeCwKICAgIFByb2Nlc3NQb3NpdGlvbgogIH0pOwoKICBhc3luYyBmdW5jdGlvbiBMb29wKCkgewogICAgY29uc3QgZGVsYXkgPSAxMDAwIC8gZnBzOwogICAgY29uc3QgbG9nID0gKHQsIG5hbWUpID0+IGdsb2JhbFRoaXMuZG9Mb2cgJiYgY29uc29sZS5sb2coYCR7bmFtZX0gdGltaW5nOiAke3QudG9GaXhlZCgzKX1tc2ApOwogICAgY29uc3QgZmlyZSA9ICguLi5hcmdzKSA9PiBGaXJlKC4uLmFyZ3MpOwogICAgY29uc3QgcmVkcmF3ID0gKC4uLmFyZ3MpID0+IFJlZHJhdyguLi5hcmdzKTsKCiAgICBhd2FpdCBvbmNlKHdpbmRvdywgJ2xvYWQnKTsKCiAgICBJbml0KCk7CgogICAgZm9yKDs7KSB7CiAgICAgIGZpcmUoKTsKICAgICAgcmVkcmF3KCk7CiAgICAgIGF3YWl0IGFuaW1hdGlvbkZyYW1lKGRlbGF5KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIEZpcmUoKSB7CiAgICBmb3IobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewogICAgICBwaXhlbHNbaGVpZ2h0XVt4XSA9IDI1NSAtIChSYW5kb21CeXRlKCkgJSAxMjgpOwogICAgICBwaXhlbHNbaGVpZ2h0ICsgMV1beF0gPSAyNTUgLSAoUmFuZG9tQnl0ZSgpICUgMTI4KTsKICAgIH0KCiAgICBmb3IobGV0IHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKICAgICAgZm9yKGxldCB4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHsKICAgICAgICBjb25zdCBzdW0gPSBbcGl4ZWxzW3kgKyAxXVtNb2R1bG8oeCAtIDEsIHdpZHRoKV0sIHBpeGVsc1t5ICsgMV1beF0sIHBpeGVsc1t5ICsgMV1bTW9kdWxvKHggKyAxLCB3aWR0aCldLCBwaXhlbHNbeSArIDJdW3hdXS5yZWR1Y2UoKGEsIHApID0+IGEgKyAocCB8IDApLCAwKTsKCiAgICAgICAgcGl4ZWxzW3ldW3hdID0gKHN1bSAqIDE1KSA+Pj4gNjsKICAgICAgfQogICAgfQogIH0KCiAgYXN5bmMgZnVuY3Rpb24gUmVkcmF3KCkgewogICAgY29uc3QgeyBkYXRhIH0gPSBpbWFnZTsKCiAgICBsZXQgaSA9IDA7CiAgICBsZXQgdCA9IFsuLi5tYXRyaXhdOwoKICAgIGZvcihsZXQgeSA9IDA7IHkgPCBoZWlnaHQ7IHkrKykgewogICAgICBmb3IobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewogICAgICAgIGNvbnN0IGMgPSBwYWxldHRlW3BpeGVsc1t5XVt4XV07CiAgICAgICAgZGF0YVtpKytdID0gYy5yOwogICAgICAgIGRhdGFbaSsrXSA9IGMuZzsKICAgICAgICBkYXRhW2krK10gPSBjLmI7CiAgICAgICAgZGF0YVtpKytdID0gYy5hOwogICAgICB9CiAgICB9CgogICAgY29udGV4dC5wdXRJbWFnZURhdGEoaW1hZ2UsIDAsIDApOwogIH0KCiAgZnVuY3Rpb24gQ3JlYXRlUGFsZXR0ZSgpIHsKICAgIGNvbnN0IGNvbG9ycyA9IG5ldyBBcnJheSgyNTYpOwoKICAgIGZvcihsZXQgaSA9IDA7IGkgPCA2NDsgaSsrKSB7CiAgICAgIGNvbnN0IHZhbHVlID0gaSAqIDQ7CgogICAgICBjb2xvcnNbaV0gPSBuZXcgUkdCQSh2YWx1ZSwgMCwgMCk7CiAgICAgIGNvbG9yc1tpICsgNjRdID0gbmV3IFJHQkEoMjU1LCB2YWx1ZSwgMCk7CiAgICAgIGNvbG9yc1tpICsgMTI4XSA9IG5ldyBSR0JBKDI1NSwgMjU1LCB2YWx1ZSk7CiAgICAgIGNvbG9yc1tpICsgMTkyXSA9IG5ldyBSR0JBKDI1NSwgMjU1LCAyNTUpOwogICAgfQogICAgcmV0dXJuIGNvbG9yczsKICB9CgogIGZ1bmN0aW9uIENyZWF0ZVBhbGV0dGVIU0woKSB7CiAgICBjb25zdCBjb2xvcnMgPSBuZXcgQXJyYXkoMjU2KTsKCiAgICBjb25zdCBodWVzID0gW25ldyBIU0xBKDAsIDEwMCwgMCksIG5ldyBIU0xBKDAsIDEwMCwgNTApLCBuZXcgSFNMQSgzMCwgMTAwLCA1MCksIG5ldyBIU0xBKDYwLCAxMDAsIDUwKSwgbmV3IEhTTEEoNjAsIDEwMCwgMTAwKSwgbmV3IEhTTEEoNjAsIDEwMCwgMTAwKV07CgogICAgY29uc3QgYnJlYWtwb2ludHMgPSBbMCwgNTEsIDgwLCAxNTQsIDIwNSwgMjU2XTsKICAgIGNvbnNvbGUubG9nKCdicmVha3BvaW50czonLCBicmVha3BvaW50cyk7CgogICAgZm9yKGxldCBpID0gMDsgaSA8IDI1NjsgaSsrKSB7CiAgICAgIGNvbnN0IGh1ZSA9ICh2ID0+ICh2ID09IC0xID8gKCkgPT4gaHVlcy5sZW5ndGggLSAyIDogdiA9PiB2KSkoYnJlYWtwb2ludHMuZmluZEluZGV4KGIgPT4gaSA8IGIpKTsKICAgICAgY29uc3QgcmFuZ2UgPSBicmVha3BvaW50c1todWVdIC0gMSAtIGJyZWFrcG9pbnRzW2h1ZSAtIDFdOwoKICAgICAgY29sb3JzW2ldID0gSFNMQS5ibGVuZChodWVzW2h1ZSAtIDFdLCBodWVzW2h1ZV0sIChpIC0gYnJlYWtwb2ludHNbaHVlIC0gMV0pIC8gcmFuZ2UpLnRvUkdCQSgpOwogICAgfQogICAgcmV0dXJuIGNvbG9yczsKICB9CgogIC8vIEZvciByYW5kb20gbnVtYmVycywgdXNlICJ4ID0gMTgxICogeCArIDM1OSIgZnJvbQogIC8vIFRvbSBEaWNrZW5zICJSYW5kb20gTnVtYmVyIEdlbmVyYXRvciBmb3IgTWljcm9jb250cm9sbGVycyIKICAvLyBodHRwczovL3dlYi5hcmNoaXZlLm9yZy93ZWIvMjAxNzAzMjMyMDQ5MTcvaHR0cDovL2hvbWUuZWFydGhsaW5rLm5ldC9+dGRpY2tlbnMvNjhoYzExL3JhbmRvbS82OGhjMTFyYW5kb20uaHRtbAogIGxldCBzY3JhdGNoID0gMDsKCiAgZnVuY3Rpb24gUmFuZG9tQnl0ZSgpIHsKICAgIGNvbnN0IHZhbHVlID0gMTgxICogc2NyYXRjaCArIDM1OTsKICAgIHNjcmF0Y2ggPSB2YWx1ZSA+Pj4gMDsKICAgIHJldHVybiAodmFsdWUgPj4+IDgpICYgMHhmZjsKICB9CgogIGZ1bmN0aW9uIE1vZHVsbyhuLCBtKSB7CiAgICByZXR1cm4gKChuICUgbSkgKyBtKSAlIG07CiAgfQoKICBsZXQgZWxlbWVudCwgcmVjdCwgcmMsIG1vdXNlVHJhbnNmb3JtOwoKICBmdW5jdGlvbiBCbGF6ZSh4LCB5KSB7CiAgICBmb3IobGV0IHR5ID0geSAtIDE7IHR5IDwgeSArIDE7IHR5KyspIHsKICAgICAgZm9yKGxldCB0eCA9IHggLSAxOyB0eCA8IHggKyAxOyB0eCsrKSB7CiAgICAgICAgcGl4ZWxzW3R5XVt0eF0gPSByYzsKICAgICAgfQogICAgfQoKICAgIHBpeGVsc1t5ICsgMV1beF0gPSByYzsKICB9CgogIGZ1bmN0aW9uIE1vdXNlSGFuZGxlcihlKSB7CiAgICBsZXQgeyB0YXJnZXQsIGJ1dHRvbnMsIHR5cGUgfSA9IGU7CgogICAgaWYoJ3RvdWNoZXMnIGluIGUpIHsKICAgICAgZm9yKGxldCB0b3VjaCBvZiBbLi4uZS50b3VjaGVzXSkgewogICAgICAgIGNvbnN0IHsgY2xpZW50WCwgY2xpZW50WSB9ID0gdG91Y2g7CiAgICAgICAgTW91c2VIYW5kbGVyKHsKICAgICAgICAgIHR5cGUsCiAgICAgICAgICB0YXJnZXQsCiAgICAgICAgICBidXR0b25zLAogICAgICAgICAgb2Zmc2V0WDogTWF0aC50cnVuYyhjbGllbnRYKSAtIHJlY3QueCwKICAgICAgICAgIG9mZnNldFk6IE1hdGgudHJ1bmMoY2xpZW50WSkgLSByZWN0LnkKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9CgogICAgZ2xvYmFsVGhpcy5wb2ludGVyRXZlbnQgPSBlOwoKICAgIGNvbnN0IHggPSBNYXRoLnJvdW5kKChlLm9mZnNldFggKiB3aWR0aCkgLyByZWN0LndpZHRoKTsKICAgIGNvbnN0IHkgPSBNYXRoLnJvdW5kKChlLm9mZnNldFkgKiBoZWlnaHQpIC8gcmVjdC5oZWlnaHQpOwoKICAgIHRyeSB7CiAgICAgIGlmKC8oZG93bnxzdGFydCkkLy50ZXN0KHR5cGUpKSByYyA9IHBpeGVsc1t5XVt4XSA+IDB4MzAgPyAwIDogUmFuZG9tQnl0ZSgpIHwgMHg4MDsKCiAgICAgIEJsYXplKHgsIHkpOwogICAgfSBjYXRjaChlKSB7fQogIH0KCiAgZnVuY3Rpb24gUmVzaXplSGFuZGxlcihlKSB7CiAgICByZWN0ID0gY2FudmFzUmVjdDsKICAgIG1vdXNlVHJhbnNmb3JtID0gUG9zaXRpb25Qcm9jZXNzb3IoKTsKICAgIGNvbnNvbGUubG9nKCdSZXNpemVIYW5kbGVyJywgeyBlLCByZWN0IH0pOwogIH0KCiAgZnVuY3Rpb24gT3JpZW50YXRpb25DaGFuZ2UoZSkgewogICAgcmVjdCA9IGNhbnZhc1JlY3Q7CiAgICBtb3VzZVRyYW5zZm9ybSA9IFBvc2l0aW9uUHJvY2Vzc29yKCk7CiAgICBjb25zb2xlLmxvZygnT3JpZW50YXRpb25DaGFuZ2UnLCB7IGUsIHJlY3QgfSk7CiAgfQoKICBPYmplY3QuYXNzaWduKGdsb2JhbFRoaXMsIHsgUmFuZG9tQnl0ZSB9KTsKCiAgZnVuY3Rpb24gSW5pdCgpIHsKICAgIHdpbmRvdy5jYW52YXMgPSBlbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignY2FudmFzJyk7CgogICAgZGVmaW5lKAogICAgICBnbG9iYWxUaGlzLAogICAgICBwcm9wZXJ0aWVzKHsKICAgICAgICBjYW52YXNFbGVtZW50OiAoKSA9PiBFbGVtZW50LmZpbmQoJ2NhbnZhcycpLAogICAgICAgIGRpdkVsZW1lbnQ6ICgpID0+IEVsZW1lbnQuZmluZCgnYm9keSA+IGRpdjpmaXJzdC1jaGlsZCcpCiAgICAgIH0pLAogICAgICBwcm9wZXJ0aWVzKHsKICAgICAgICB3aW5kb3dSZWN0OiAoKSA9PiBuZXcgUmVjdCh3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KSwKICAgICAgICBib2R5UmVjdDogKCkgPT4gRWxlbWVudC5yZWN0KCdib2R5Jykucm91bmQoMCksCiAgICAgICAgY2FudmFzUmVjdDogKCkgPT4gRWxlbWVudC5yZWN0KCdjYW52YXMnKS5yb3VuZCgwKSwKICAgICAgICBkaXZSZWN0OiAoKSA9PiBFbGVtZW50LnJlY3QoJ2JvZHkgPiBkaXY6Zmlyc3QtY2hpbGQnKS5yb3VuZCgwKQogICAgICB9KSwKICAgICAgewogICAgICAgIGdldFJlY3QKICAgICAgfSwKICAgICAgcHJvcGVydGllcyh7CiAgICAgICAgdHJhbnNmb3JtOiBbKCkgPT4gbmV3IFRyYW5zZm9ybWF0aW9uTGlzdChFbGVtZW50LmdldENTUygnYm9keSA+IGRpdjpmaXJzdC1jaGlsZCcpLnRyYW5zZm9ybSksIHZhbHVlID0+IEVsZW1lbnQuc2V0Q1NTKCdib2R5ID4gZGl2OmZpcnN0LWNoaWxkJywgeyB0cmFuc2Zvcm06IHZhbHVlICsgJycgfSldCiAgICAgIH0pCiAgICApOwoKICAgIGNvbnN0IFNWR0NvbXBvbmVudCA9IHByb3BzID0+IHsKICAgICAgY29uc3QgcmVjdCA9IEVsZW1lbnQucmVjdChkb2N1bWVudC5ib2R5KS5yb3VuZCgxKTsKICAgICAgY29uc3QgeyBjZW50ZXIsIHdpZHRoLCBoZWlnaHQgfSA9IHJlY3Q7CgoKICAgICAgcmV0dXJuIGgoJ3N2ZycsIHsgdmVyc2lvbjogJzEuMScsIHhtbG5zOiAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCB2aWV3Qm94OiBbLi4ucmVjdF0uam9pbignICcpLCB3aWR0aCwgaGVpZ2h0IH0sIFsKaCgnY2lyY2xlJywgeyBjeDogY2VudGVyLngsIGN5OiBjZW50ZXIueSwgcjogMjUwLCAnc3Ryb2tlJzogJyMwZjAnLCAnc3Ryb2tlLXdpZHRoJzogMSwgZmlsbDogYHJnYmEoODAsODAsODAsMC4zKWAgfSkKICAgICAgICBdKTsKICAgIH07CgogICAgbGV0IHN2Z0NvbnRhaW5lciA9IEVsZW1lbnQuY3JlYXRlKCdkaXYnLCB7fSwgZG9jdW1lbnQuYm9keSk7CiAgICBFbGVtZW50LnNldENTUyhzdmdDb250YWluZXIsIHsgcG9zaXRpb246ICdhYnNvbHV0ZScsIHRvcDogMCwgbGVmdDogMCwgekluZGV4OiA5OTk5OTk5OSwgcG9pbnRlckV2ZW50czogJ25vbmUnIH0pOwoKICAgIHJlbmRlcihoKFNWR0NvbXBvbmVudCksIHN2Z0NvbnRhaW5lcik7CgogICAgcmVjdCA9IGNhbnZhc1JlY3Q7CiAgICBtb3VzZVRyYW5zZm9ybSA9IFBvc2l0aW9uUHJvY2Vzc29yKCk7CgogICAgKGFzeW5jIGZ1bmN0aW9uKCkgewogICAgICBmb3IgYXdhaXQobGV0IGV2ZW50IG9mIHN0cmVhbWlmeShbJ29yaWVudGF0aW9uY2hhbmdlJywgJ3Jlc2l6ZSddLCBkb2N1bWVudCkpIHsKICAgICAgICBjb25zb2xlLmxvZyhldmVudC50eXBlLCBldmVudCk7CiAgICAgICAgZ2xvYmFsVGhpc1tldmVudC50eXBlXSA9IGV2ZW50OwogICAgICB9CiAgICB9KSgpOwoKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBSZXNpemVIYW5kbGVyLCB0cnVlKTsKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvcmllbnRhdGlvbmNoYW5nZScsIE9yaWVudGF0aW9uQ2hhbmdlLCB0cnVlKTsKCiAgICAvKiAgIGNvbnN0IGhhbmRsZXIgPSBNb3VzZUhhbmRsZXI7CgogICAgc3Vic2NyaWJlKE1vdmVtZW50SXRlcmF0b3IoZWxlbWVudCksIGhhbmRsZXIpOyovCiAgfQoKICBnbG9iYWxUaGlzLndzID0gKGdsb2JhbFRoaXMucndzID8/PSBOZXdXUygpKS53czsKCiAgKGFzeW5jIGZ1bmN0aW9uKCkgewogICAgbGV0IHRyYWlsID0gW10sCiAgICAgIHN0YXJ0LAogICAgICBsYXN0OwogICAgZm9yKDs7KSB7CiAgICAgIGxldCBwcmV2LCBwdDsKCiAgICAgIGZvciBhd2FpdChsZXQgZXYgb2YgTW92ZW1lbnRJdGVyYXRvcih3aW5kb3cpKSB7CiAgICAgICAgaWYoIWdsb2JhbFRoaXMuY2lkKSB7CiAgICAgICAgICBnbG9iYWxUaGlzLmNpZCA/Pz0gTWFrZUNsaWVudElEKCk7CgogICAgICAgICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeSh7IHR5cGU6ICdoZWxsbycsIGNpZCB9KSk7CiAgICAgICAgfQoKICAgICAgICBpZihyZWN0Lmluc2lkZShldikpIHsKICAgICAgICAgIGxldCBwdCA9IChnbG9iYWxUaGlzLm1vdXNlUG9zID0gbW91c2VUcmFuc2Zvcm0oZXYpKTsKICAgICAgICAgIGxldCBkaWZmID0gcHQsCiAgICAgICAgICAgIHQ7CiAgICAgICAgICBpZihwcmV2KSBkaWZmID0gcHQuZGlmZihwcmV2KTsKCiAgICAgICAgICBzdGFydCA/Pz0gdCA9IERhdGUubm93KCk7CgogICAgICAgICAgLy90cmFpbC5wdXNoKHsgLi4ucHQsIHRpbWU6IERhdGUubm93KCkgIC1zdGFydCAgfSk7CiAgICAgICAgICB0cmFpbC5wdXNoKHQgLSBzdGFydCArICcvJyArIChwcmV2ICYmIGRpZmYueCA+IDAgPyAnKycgOiAnJykgKyBkaWZmLnggKyAnLCcgKyAocHJldiAmJiBkaWZmLnkgPiAwID8gJysnIDogJycpICsgZGlmZi55KTsKCiAgICAgICAgICBsYXN0ID0gdDsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2JsYXplJywgLi4ucHQpOwogICAgICAgICAgICByYyA9IHBpeGVsc1twdC55XVtwdC54XSA+IDB4MzAgPyAwIDogUmFuZG9tQnl0ZSgpIHwgMHg4MDsKCiAgICAgICAgICAgIEJsYXplKHB0LngsIHB0LnkpOwogICAgICAgICAgfSBjYXRjaChlKSB7fQogICAgICAgICAgcHJldiA9IHB0OwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIFNlbmRUcmFpbCgpIHsKICAgICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeSh7IHR5cGU6ICdibGF6ZScsIHN0YXJ0LCB0cmFpbDogdHJhaWwuam9pbignICcpIH0pKTsKCiAgICAgIHRyYWlsLnNwbGljZSgwLCB0cmFpbC5sZW5ndGgpOwogICAgICBzdGFydCA9IHVuZGVmaW5lZDsKICAgICAgcHJldiA9IHVuZGVmaW5lZDsKICAgIH0KICB9KSgpOwoKICBMb29wKCk7Cn0KCmRlZmluZShnbG9iYWxUaGlzLCB7IGNyb3Nza2l0LCBSR0JBLCBIU0xBLCBVdGlsLCBNYXRyaXgsIFRyYW5zZm9ybWF0aW9uTGlzdCB9KTsKZGVmaW5lKGdsb2JhbFRoaXMsIHsgV2ViU29ja2V0SXRlcmF0b3IsIFdlYlNvY2tldFVSTCwgQ3JlYXRlV2ViU29ja2V0LCBOZXdXUywgUmVjb25uZWN0aW5nV2ViU29ja2V0IH0pOwpkZWZpbmUoZ2xvYmFsVGhpcywgeyBkZWZpbmUsIGlzVW5kZWZpbmVkLCBwcm9wZXJ0aWVzLCBrZXlzIH0pOwpkZWZpbmUoZ2xvYmFsVGhpcywgeyBvbmNlLCBzdHJlYW1pZnksIHRocm90dGxlLCBkaXN0aW5jdCwgc3Vic2NyaWJlIH0pOwpkZWZpbmUoZ2xvYmFsVGhpcywgeyBJbnRlcnNlY3Rpb24sIE1hdHJpeCwgaXNSZWN0LCBSZWN0LCBTaXplLCBQb2ludCwgTGluZSwgVHJhbnNmb3JtYXRpb25MaXN0LCBWZWN0b3IgfSk7CmRlZmluZShnbG9iYWxUaGlzLCB7CiAgdGltZXIsCiAgTWFrZVVVSUQsCiAgTWFrZUNsaWVudElELAogIGlzU3RyZWFtLAogIEFjcXVpcmVSZWFkZXIsCiAgQWNxdWlyZVdyaXRlciwKICBBcnJheVdyaXRlciwKICByZWFkU3RyZWFtLAogIFBpcGVUbywKICBXcml0YWJsZVJlcGVhdGVyLAogIFdyaXRlSXRlcmF0b3IsCiAgQXN5bmNXcml0ZSwKICBBc3luY1JlYWQsCiAgUmVhZEZyb21JdGVyYXRvciwKICBXcml0ZVRvUmVwZWF0ZXIsCiAgTG9nU2luaywKICBTdHJpbmdSZWFkZXIsCiAgTGluZVJlYWRlciwKICBEZWJ1Z1RyYW5zZm9ybVN0cmVhbSwKICBDcmVhdGVXcml0YWJsZVN0cmVhbSwKICBDcmVhdGVUcmFuc2Zvcm1TdHJlYW0sCiAgUmVwZWF0ZXJTb3VyY2UsCiAgUmVwZWF0ZXJTaW5rLAogIExpbmVCdWZmZXJTdHJlYW0sCiAgVGV4dFRyYW5zZm9ybVN0cmVhbSwKICBDaHVua1JlYWRlciwKICBCeXRlUmVhZGVyLAogIFBpcGVUb1JlcGVhdGVyLAogIFJlYWRlciwKICBSZWFkQWxsLAogIFN0cmVhbVJlYWRJdGVyYXRvcgp9KTsKCmRlZmluZShnbG9iYWxUaGlzLCB7IEVsZW1lbnQsIGlzRWxlbWVudCwgU1ZHLCBSZWFjdCwgaCwgaHRtbCwgcmVuZGVyLCBGcmFnbWVudCwgQ29tcG9uZW50LCBjcmVhdGVSZWYsIHVzZVN0YXRlLCB1c2VMYXlvdXRFZmZlY3QsIHVzZVJlZiwgdG9DaGlsZEFycmF5IH0pOwoKbWFpbigpOwoKZnVuY3Rpb24gZ2V0UmVjdChlbGVtKSB7CiAgcmV0dXJuIG5ldyBSZWN0KChlbGVtID8/IGRpdkVsZW1lbnQpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKS5yb3VuZCgxKTsKfQoAAAAAAAAAAMI2AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAtyoAAAAAAAC3KgAAAAAAAAAAAAAAAPC/"
				],
				[
					987,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAADCNgAAaW1wb3J0IHsgY3Jvc3NraXQsIENBTlZBUyB9IGZyb20gJy4vbGliL2Nyb3Nza2l0LmpzJzsKaW1wb3J0IHsgUkdCQSwgSFNMQSB9IGZyb20gJy4vbGliL2NvbG9yLmpzJzsKaW1wb3J0IHsgdGltZXIgfSBmcm9tICcuL2xpYi9hc3luYy9oZWxwZXJzLmpzJzsKaW1wb3J0IHsgV2ViU29ja2V0SXRlcmF0b3IsIFdlYlNvY2tldFVSTCwgQ3JlYXRlV2ViU29ja2V0LCBSZWNvbm5lY3RpbmdXZWJTb2NrZXQsIFN0cmVhbVJlYWRJdGVyYXRvciB9IGZyb20gJy4vbGliL2FzeW5jL3dlYnNvY2tldC5qcyc7CmltcG9ydCB7IG9uY2UsIHN0cmVhbWlmeSwgdGhyb3R0bGUsIGRpc3RpbmN0LCBzdWJzY3JpYmUgfSBmcm9tICcuL2xpYi9hc3luYy9ldmVudHMuanMnOwppbXBvcnQgeyBtZW1vaXplLCBkZWZpbmUsIGlzVW5kZWZpbmVkLCBwcm9wZXJ0aWVzLCBrZXlzLCB1bmlxdWUsIHJhbmRTdHIsIHJhbmRJbnQgfSBmcm9tICcuL2xpYi9taXNjLmpzJzsKaW1wb3J0IHsgaXNTdHJlYW0sIEFjcXVpcmVSZWFkZXIsIEFjcXVpcmVXcml0ZXIsIEFycmF5V3JpdGVyLCByZWFkU3RyZWFtLCBQaXBlVG8sIFdyaXRhYmxlUmVwZWF0ZXIsIFdyaXRlSXRlcmF0b3IsIEFzeW5jV3JpdGUsIEFzeW5jUmVhZCwgUmVhZEZyb21JdGVyYXRvciwgV3JpdGVUb1JlcGVhdGVyLCBMb2dTaW5rLCBTdHJpbmdSZWFkZXIsIExpbmVSZWFkZXIsIERlYnVnVHJhbnNmb3JtU3RyZWFtLCBDcmVhdGVXcml0YWJsZVN0cmVhbSwgQ3JlYXRlVHJhbnNmb3JtU3RyZWFtLCBSZXBlYXRlclNvdXJjZSwgUmVwZWF0ZXJTaW5rLCBMaW5lQnVmZmVyU3RyZWFtLCBUZXh0VHJhbnNmb3JtU3RyZWFtLCBDaHVua1JlYWRlciwgQnl0ZVJlYWRlciwgUGlwZVRvUmVwZWF0ZXIsIFJlYWRlciwgUmVhZEFsbCwgZGVmYXVsdCBhcyB1dGlscyB9IGZyb20gJy4vbGliL3N0cmVhbS91dGlscy5qcyc7CmltcG9ydCB7IEludGVyc2VjdGlvbiwgTWF0cml4LCBpc1JlY3QsIFJlY3QsIFNpemUsIFBvaW50LCBMaW5lLCBUcmFuc2Zvcm1hdGlvbkxpc3QsIFZlY3RvciB9IGZyb20gJy4vbGliL2dlb20uanMnOwppbXBvcnQgeyBFbGVtZW50LCBpc0VsZW1lbnQsIFNWRyB9IGZyb20gJy4vbGliL2RvbS5qcyc7CmltcG9ydCBSZWFjdCwgeyBoLCBodG1sLCByZW5kZXIsIEZyYWdtZW50LCBDb21wb25lbnQsIGNyZWF0ZVJlZiwgdXNlU3RhdGUsIHVzZUxheW91dEVmZmVjdCwgdXNlUmVmLCB0b0NoaWxkQXJyYXkgfSBmcm9tICcuL2xpYi9kb20vcHJlYWN0Q29tcG9uZW50LmpzJzsKCmZ1bmN0aW9uIE5ld1dTKCkgewogIGxldCB1cmwgPSBXZWJTb2NrZXRVUkwoJy93cycsIHsgbWlycm9yOiBjdXJyZW50RmlsZSB9KTsKICBsZXQgd3MgPSBuZXcgUmVjb25uZWN0aW5nV2ViU29ja2V0KHVybCwgJ2x3cy1taXJyb3ItcHJvdG9jb2wnKTsKICAoYXN5bmMgZnVuY3Rpb24oKSB7CiAgICBmb3IgYXdhaXQobGV0IGNodW5rIG9mIHdzKSB7CiAgICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShjaHVuayk7CgogICAgICBpZihkYXRhLmNpZCAhPSBnbG9iYWxUaGlzLmNpZCkgY29uc29sZS5sb2coJ1dTIHJlY2VpdmU6JywgZGF0YSk7CiAgICB9CiAgfSkoKTsKICByZXR1cm4gKGdsb2JhbFRoaXMud3MgPSB3cyk7Cn0KCmNvbnN0IE1ha2VVVUlEID0gKHJuZyA9IE1hdGgucmFuZG9tKSA9PiBbOCwgNCwgNCwgNCwgMTJdLm1hcChuID0+IHJhbmRTdHIobiwgJzAxMjM0NTY3ODlhYmNkZWYnKSwgcm5nKS5qb2luKCctJyk7CmNvbnN0IE1ha2VDbGllbnRJRCA9IChybmcgPSBNYXRoLnJhbmRvbSkgPT4gWzQsIDQsIDQsIDRdLm1hcChuID0+IHJhbmRTdHIobiwgWydBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWicsICdhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicsICcuLSQnXVtyYW5kSW50KDAsIDMpXSksIHJuZykuam9pbignJyk7CgpmdW5jdGlvbiBtYWluKCkgewogIGRlZmluZSgKICAgIGdsb2JhbFRoaXMsCiAgICBwcm9wZXJ0aWVzKAogICAgICB7CiAgICAgICAgY3VycmVudFVSTDogKCkgPT4gbmV3IFVSTChpbXBvcnQubWV0YS51cmwpLAogICAgICAgIGN1cnJlbnRGaWxlOiAoKSA9PiBnbG9iYWxUaGlzLmN1cnJlbnRVUkwucGF0aG5hbWUucmVwbGFjZSgvXlwvLywgJycpCiAgICAgIH0sCiAgICAgIHsgbWVtb2l6ZTogdHJ1ZSB9CiAgICApCiAgKTsKCiAgY29uc3Qgd2lkdGggPSAzMjA7CiAgY29uc3QgaGVpZ2h0ID0gMjAwOwogIGNvbnN0IHBhcmVudCA9IGRvY3VtZW50LmJvZHk7CgogIGNyb3Nza2l0LmluaXQoewogICAgcmVuZGVyZXI6IENBTlZBUywKICAgIHBhcmVudCwKICAgIHc6IHdpZHRoLAogICAgaDogaGVpZ2h0LAogICAgYWxwaGE6IGZhbHNlCiAgfSk7CgogIGZ1bmN0aW9uIFJlcGFyZW50KGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdjYW52YXMnKVswXSkgewogICAgY2FudmFzLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoY2FudmFzKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKS5hcHBlbmRDaGlsZChjYW52YXMpOwogIH0KCiAgZnVuY3Rpb24gR2V0RWxlbWVudE1hdHJpeChlbGVtZW50KSB7CiAgICBsZXQgeyB0cmFuc2Zvcm0gfSA9IEVsZW1lbnQuZ2V0Q1NTKGRpdkVsZW1lbnQpOwoKICAgIHJldHVybiBNYXRyaXguZnJvbUNTUyh0cmFuc2Zvcm0pOwogIH0KCiAgZnVuY3Rpb24gU2V0Q3Jvc3NoYWlyKHBvcykgewogICAgbGV0IGNoID0gRWxlbWVudC5maW5kKCcjY3Jvc3NoYWlyJyk7CiAgICBsZXQgcmVjdCA9IEVsZW1lbnQuZ2V0UmVjdChjaCk7CgogICAgY29uc29sZS5sb2coJ1NldENyb3NzaGFpcicsIHsgY2gsIHJlY3QsIHBvcyB9KTsKICAgIHJlY3QueCA9IHBvcy54IC0gcmVjdC53aWR0aCAvIDI7CiAgICByZWN0LnkgPSBwb3MueSAtIHJlY3QuaGVpZ2h0IC8gMjsKCiAgICBFbGVtZW50LnNldFJlY3QoY2gsIHJlY3QpOwogIH0KCiAgZnVuY3Rpb24gRXZlbnRQb3NpdGlvbnMoZXZlbnRPclRvdWNoKSB7CiAgICBsZXQgcG9zaXRpb25zID0gdW5pcXVlKAogICAgICBrZXlzKGV2ZW50T3JUb3VjaCwgMikKICAgICAgICAuZmlsdGVyKG4gPT4gdHlwZW9mIG4gPT0gJ3N0cmluZycgJiYgL1tYWV0kLy50ZXN0KG4pKQogICAgICAgIC5tYXAobiA9PiBuLnNsaWNlKDAsIC0xKSkKICAgICk7CgogICAgcmV0dXJuIHBvc2l0aW9ucy5yZWR1Y2UoKGFjYywga2V5KSA9PiB7CiAgICAgIGFjY1trZXldID0gbmV3IFBvaW50KGV2ZW50T3JUb3VjaFtrZXkgKyAnWCddLCBldmVudE9yVG91Y2hba2V5ICsgJ1knXSk7CiAgICAgIHJldHVybiBhY2M7CiAgICB9LCB7fSk7CiAgfQoKICBmdW5jdGlvbiBQb3NpdGlvbk1hdHJpeChjYW52YXMgPSBjYW52YXNFbGVtZW50LCByZWN0ID0gY2FudmFzUmVjdCkgewogICAgbGV0IHZlcnRpY2FsID0gcmVjdC5hc3BlY3QoKSA8IDE7CiAgICBsZXQgdG9wTGVmdCA9IHJlY3QudG9Qb2ludHMoKVt2ZXJ0aWNhbCA/IDEgOiAwXTsKICAgIGxldCBtID0gTWF0cml4LmlkZW50aXR5KCkuc2NhbGUoY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTsKCiAgICBpZih2ZXJ0aWNhbCkgbSA9IG0ucm90YXRlKC1NYXRoLlBJIC8gMik7CgogICAgbSA9IG0uc2NhbGUoMSAvIHJlY3Qud2lkdGgsIDEgLyByZWN0LmhlaWdodCk7CiAgICBtID0gbS50cmFuc2xhdGUoLXRvcExlZnQueCwgLXRvcExlZnQueSk7CgogICAgcmV0dXJuIG07CiAgfQoKICBmdW5jdGlvbiBQb3NpdGlvblByb2Nlc3NvcihjYW52YXMgPSBjYW52YXNFbGVtZW50LCByZWN0ID0gY2FudmFzUmVjdCkgewogICAgbGV0IG0gPSBQb3NpdGlvbk1hdHJpeChjYW52YXMsIHJlY3QpOwogICAgcmV0dXJuIHBvcyA9PiBuZXcgUG9pbnQoLi4ubS50cmFuc2Zvcm1fcG9pbnQobmV3IFBvaW50KHBvcykpKS5yb3VuZCgxKTsKICB9CgogIGZ1bmN0aW9uIFByb2Nlc3NQb3NpdGlvbihwb3MpIHsKICAgIHJldHVybiBQb3NpdGlvblByb2Nlc3NvcigpKHBvcyk7CiAgfQoKICBhc3luYyBmdW5jdGlvbiogTW92ZW1lbnRJdGVyYXRvcihlbGVtZW50KSB7CiAgICBsZXQgZXYgPSBhd2FpdCBvbmNlKGVsZW1lbnQsICdtb3VzZWRvd24nLCAndG91Y2hzdGFydCcpOwogICAgbGV0IHR5cGUgPSBldi50eXBlLnNsaWNlKDAsIDUpOwogICAgeWllbGQgZXY7CiAgICBjb25zb2xlLmxvZyh0eXBlICsgJyBzdGFydCcpOwogICAgZm9yIGF3YWl0KGxldCBldmVudCBvZiBzdHJlYW1pZnkoWydtb3VzZXVwJywgJ21vdXNlbW92ZScsICd0b3VjaGVuZCcsICd0b3VjaG1vdmUnXSwgZWxlbWVudCkpIHsKICAgICAgLy9ldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBpZigndG91Y2hlcycgaW4gZXZlbnQpIHsKICAgICAgICBpZihldmVudC50b3VjaGVzLmxlbmd0aCkgewogICAgICAgICAgZ2xvYmFsVGhpcy5tb3VzZUV2ZW50ID0gZXZlbnQ7CgogICAgICAgICAgeWllbGQqIFsuLi5ldmVudC50b3VjaGVzXS5tYXAoRXZlbnRQb3NpdGlvbnMpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCB7IHR5cGUsIGNsaWVudFg6IHgsIGNsaWVudFk6IHkgfSA9IGV2ZW50OwogICAgICAgIGxldCBvYmogPSB7IHR5cGUsIHgsIHkgfTsKICAgICAgICB5aWVsZCBvYmo7CiAgICAgIH0KICAgICAgaWYoLyh1cHxlbmQpJC8udGVzdChldmVudC50eXBlKSkgewogICAgICAgIGNvbnNvbGUubG9nKHR5cGUgKyAnIGVuZCcpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQoKICBSZXBhcmVudCgpOwoKICBjcm9zc2tpdC5jbGVhcigpOwogIGNyb3Nza2l0LnJlY3QoewogICAgeDogMCwKICAgIHk6IDAsCiAgICB3aWR0aCwKICAgIGhlaWdodCwKICAgIGZpbGw6ICdibGFjaycsCiAgICBzdHJva2U6ICdibGFjaycsCiAgICBhbmdsZTogMAogIH0pOwoKICBjb25zdCBidWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIod2lkdGggKiAoaGVpZ2h0ICsgMikpOwogIGNvbnN0IHBhbGV0dGUgPSBDcmVhdGVQYWxldHRlKCk7CiAgY29uc3QgcGFsZXR0ZUhTTCA9IENyZWF0ZVBhbGV0dGVIU0woKTsKCiAgY29uc3QgcGl4ZWxzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogaGVpZ2h0ICsgMiB9KS5tYXAoKHYsIGkpID0+IG5ldyBVaW50OENsYW1wZWRBcnJheShidWZmZXIsIGkgKiB3aWR0aCwgd2lkdGgpKTsKICBjb25zdCB7IGNvbnRleHQgfSA9IGNyb3Nza2l0OwogIGNvbnN0IGltYWdlID0gY29udGV4dC5jcmVhdGVJbWFnZURhdGEod2lkdGgsIGhlaWdodCk7CgogIGNvbnN0IHsgbm93LCB3YWl0Rm9yLCBhbmltYXRpb25GcmFtZSB9ID0gVXRpbDsKICBjb25zdCBmcHMgPSA1MDsKICBjb25zdCBtYXRyaXggPSBuZXcgTWF0cml4KCkudHJhbnNsYXRlKDE2MCwgMTAwKS5zY2FsZSgwLjUpOwoKICBPYmplY3QuYXNzaWduKGdsb2JhbFRoaXMsIHsKICAgIGJ1ZmZlciwKICAgIHBhbGV0dGUsCiAgICBwYWxldHRlSFNMLAogICAgcGl4ZWxzLAogICAgY29udGV4dCwKICAgIGltYWdlLAogICAgZnBzLAogICAgbWF0cml4LAogICAgUmVwYXJlbnQsCiAgICBkb206IHsgRWxlbWVudCB9LAogICAgZ2VvbTogeyBSZWN0IH0sCiAgICBNb3ZlbWVudEl0ZXJhdG9yLAogICAgTW91c2VIYW5kbGVyLAogICAgR2V0RWxlbWVudE1hdHJpeCwKICAgIFNldENyb3NzaGFpciwKICAgIEV2ZW50UG9zaXRpb25zLAogICAgUG9zaXRpb25Qcm9jZXNzb3IsCiAgICBQb3NpdGlvbk1hdHJpeCwKICAgIFByb2Nlc3NQb3NpdGlvbgogIH0pOwoKICBhc3luYyBmdW5jdGlvbiBMb29wKCkgewogICAgY29uc3QgZGVsYXkgPSAxMDAwIC8gZnBzOwogICAgY29uc3QgbG9nID0gKHQsIG5hbWUpID0+IGdsb2JhbFRoaXMuZG9Mb2cgJiYgY29uc29sZS5sb2coYCR7bmFtZX0gdGltaW5nOiAke3QudG9GaXhlZCgzKX1tc2ApOwogICAgY29uc3QgZmlyZSA9ICguLi5hcmdzKSA9PiBGaXJlKC4uLmFyZ3MpOwogICAgY29uc3QgcmVkcmF3ID0gKC4uLmFyZ3MpID0+IFJlZHJhdyguLi5hcmdzKTsKCiAgICBhd2FpdCBvbmNlKHdpbmRvdywgJ2xvYWQnKTsKCiAgICBJbml0KCk7CgogICAgZm9yKDs7KSB7CiAgICAgIGZpcmUoKTsKICAgICAgcmVkcmF3KCk7CiAgICAgIGF3YWl0IGFuaW1hdGlvbkZyYW1lKGRlbGF5KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIEZpcmUoKSB7CiAgICBmb3IobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewogICAgICBwaXhlbHNbaGVpZ2h0XVt4XSA9IDI1NSAtIChSYW5kb21CeXRlKCkgJSAxMjgpOwogICAgICBwaXhlbHNbaGVpZ2h0ICsgMV1beF0gPSAyNTUgLSAoUmFuZG9tQnl0ZSgpICUgMTI4KTsKICAgIH0KCiAgICBmb3IobGV0IHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKICAgICAgZm9yKGxldCB4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHsKICAgICAgICBjb25zdCBzdW0gPSBbcGl4ZWxzW3kgKyAxXVtNb2R1bG8oeCAtIDEsIHdpZHRoKV0sIHBpeGVsc1t5ICsgMV1beF0sIHBpeGVsc1t5ICsgMV1bTW9kdWxvKHggKyAxLCB3aWR0aCldLCBwaXhlbHNbeSArIDJdW3hdXS5yZWR1Y2UoKGEsIHApID0+IGEgKyAocCB8IDApLCAwKTsKCiAgICAgICAgcGl4ZWxzW3ldW3hdID0gKHN1bSAqIDE1KSA+Pj4gNjsKICAgICAgfQogICAgfQogIH0KCiAgYXN5bmMgZnVuY3Rpb24gUmVkcmF3KCkgewogICAgY29uc3QgeyBkYXRhIH0gPSBpbWFnZTsKCiAgICBsZXQgaSA9IDA7CiAgICBsZXQgdCA9IFsuLi5tYXRyaXhdOwoKICAgIGZvcihsZXQgeSA9IDA7IHkgPCBoZWlnaHQ7IHkrKykgewogICAgICBmb3IobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewogICAgICAgIGNvbnN0IGMgPSBwYWxldHRlW3BpeGVsc1t5XVt4XV07CiAgICAgICAgZGF0YVtpKytdID0gYy5yOwogICAgICAgIGRhdGFbaSsrXSA9IGMuZzsKICAgICAgICBkYXRhW2krK10gPSBjLmI7CiAgICAgICAgZGF0YVtpKytdID0gYy5hOwogICAgICB9CiAgICB9CgogICAgY29udGV4dC5wdXRJbWFnZURhdGEoaW1hZ2UsIDAsIDApOwogIH0KCiAgZnVuY3Rpb24gQ3JlYXRlUGFsZXR0ZSgpIHsKICAgIGNvbnN0IGNvbG9ycyA9IG5ldyBBcnJheSgyNTYpOwoKICAgIGZvcihsZXQgaSA9IDA7IGkgPCA2NDsgaSsrKSB7CiAgICAgIGNvbnN0IHZhbHVlID0gaSAqIDQ7CgogICAgICBjb2xvcnNbaV0gPSBuZXcgUkdCQSh2YWx1ZSwgMCwgMCk7CiAgICAgIGNvbG9yc1tpICsgNjRdID0gbmV3IFJHQkEoMjU1LCB2YWx1ZSwgMCk7CiAgICAgIGNvbG9yc1tpICsgMTI4XSA9IG5ldyBSR0JBKDI1NSwgMjU1LCB2YWx1ZSk7CiAgICAgIGNvbG9yc1tpICsgMTkyXSA9IG5ldyBSR0JBKDI1NSwgMjU1LCAyNTUpOwogICAgfQogICAgcmV0dXJuIGNvbG9yczsKICB9CgogIGZ1bmN0aW9uIENyZWF0ZVBhbGV0dGVIU0woKSB7CiAgICBjb25zdCBjb2xvcnMgPSBuZXcgQXJyYXkoMjU2KTsKCiAgICBjb25zdCBodWVzID0gW25ldyBIU0xBKDAsIDEwMCwgMCksIG5ldyBIU0xBKDAsIDEwMCwgNTApLCBuZXcgSFNMQSgzMCwgMTAwLCA1MCksIG5ldyBIU0xBKDYwLCAxMDAsIDUwKSwgbmV3IEhTTEEoNjAsIDEwMCwgMTAwKSwgbmV3IEhTTEEoNjAsIDEwMCwgMTAwKV07CgogICAgY29uc3QgYnJlYWtwb2ludHMgPSBbMCwgNTEsIDgwLCAxNTQsIDIwNSwgMjU2XTsKICAgIGNvbnNvbGUubG9nKCdicmVha3BvaW50czonLCBicmVha3BvaW50cyk7CgogICAgZm9yKGxldCBpID0gMDsgaSA8IDI1NjsgaSsrKSB7CiAgICAgIGNvbnN0IGh1ZSA9ICh2ID0+ICh2ID09IC0xID8gKCkgPT4gaHVlcy5sZW5ndGggLSAyIDogdiA9PiB2KSkoYnJlYWtwb2ludHMuZmluZEluZGV4KGIgPT4gaSA8IGIpKTsKICAgICAgY29uc3QgcmFuZ2UgPSBicmVha3BvaW50c1todWVdIC0gMSAtIGJyZWFrcG9pbnRzW2h1ZSAtIDFdOwoKICAgICAgY29sb3JzW2ldID0gSFNMQS5ibGVuZChodWVzW2h1ZSAtIDFdLCBodWVzW2h1ZV0sIChpIC0gYnJlYWtwb2ludHNbaHVlIC0gMV0pIC8gcmFuZ2UpLnRvUkdCQSgpOwogICAgfQogICAgcmV0dXJuIGNvbG9yczsKICB9CgogIC8vIEZvciByYW5kb20gbnVtYmVycywgdXNlICJ4ID0gMTgxICogeCArIDM1OSIgZnJvbQogIC8vIFRvbSBEaWNrZW5zICJSYW5kb20gTnVtYmVyIEdlbmVyYXRvciBmb3IgTWljcm9jb250cm9sbGVycyIKICAvLyBodHRwczovL3dlYi5hcmNoaXZlLm9yZy93ZWIvMjAxNzAzMjMyMDQ5MTcvaHR0cDovL2hvbWUuZWFydGhsaW5rLm5ldC9+dGRpY2tlbnMvNjhoYzExL3JhbmRvbS82OGhjMTFyYW5kb20uaHRtbAogIGxldCBzY3JhdGNoID0gMDsKCiAgZnVuY3Rpb24gUmFuZG9tQnl0ZSgpIHsKICAgIGNvbnN0IHZhbHVlID0gMTgxICogc2NyYXRjaCArIDM1OTsKICAgIHNjcmF0Y2ggPSB2YWx1ZSA+Pj4gMDsKICAgIHJldHVybiAodmFsdWUgPj4+IDgpICYgMHhmZjsKICB9CgogIGZ1bmN0aW9uIE1vZHVsbyhuLCBtKSB7CiAgICByZXR1cm4gKChuICUgbSkgKyBtKSAlIG07CiAgfQoKICBsZXQgZWxlbWVudCwgcmVjdCwgcmMsIG1vdXNlVHJhbnNmb3JtOwoKICBmdW5jdGlvbiBCbGF6ZSh4LCB5KSB7CiAgICBmb3IobGV0IHR5ID0geSAtIDE7IHR5IDwgeSArIDE7IHR5KyspIHsKICAgICAgZm9yKGxldCB0eCA9IHggLSAxOyB0eCA8IHggKyAxOyB0eCsrKSB7CiAgICAgICAgcGl4ZWxzW3R5XVt0eF0gPSByYzsKICAgICAgfQogICAgfQoKICAgIHBpeGVsc1t5ICsgMV1beF0gPSByYzsKICB9CgogIGZ1bmN0aW9uIE1vdXNlSGFuZGxlcihlKSB7CiAgICBsZXQgeyB0YXJnZXQsIGJ1dHRvbnMsIHR5cGUgfSA9IGU7CgogICAgaWYoJ3RvdWNoZXMnIGluIGUpIHsKICAgICAgZm9yKGxldCB0b3VjaCBvZiBbLi4uZS50b3VjaGVzXSkgewogICAgICAgIGNvbnN0IHsgY2xpZW50WCwgY2xpZW50WSB9ID0gdG91Y2g7CiAgICAgICAgTW91c2VIYW5kbGVyKHsKICAgICAgICAgIHR5cGUsCiAgICAgICAgICB0YXJnZXQsCiAgICAgICAgICBidXR0b25zLAogICAgICAgICAgb2Zmc2V0WDogTWF0aC50cnVuYyhjbGllbnRYKSAtIHJlY3QueCwKICAgICAgICAgIG9mZnNldFk6IE1hdGgudHJ1bmMoY2xpZW50WSkgLSByZWN0LnkKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9CgogICAgZ2xvYmFsVGhpcy5wb2ludGVyRXZlbnQgPSBlOwoKICAgIGNvbnN0IHggPSBNYXRoLnJvdW5kKChlLm9mZnNldFggKiB3aWR0aCkgLyByZWN0LndpZHRoKTsKICAgIGNvbnN0IHkgPSBNYXRoLnJvdW5kKChlLm9mZnNldFkgKiBoZWlnaHQpIC8gcmVjdC5oZWlnaHQpOwoKICAgIHRyeSB7CiAgICAgIGlmKC8oZG93bnxzdGFydCkkLy50ZXN0KHR5cGUpKSByYyA9IHBpeGVsc1t5XVt4XSA+IDB4MzAgPyAwIDogUmFuZG9tQnl0ZSgpIHwgMHg4MDsKCiAgICAgIEJsYXplKHgsIHkpOwogICAgfSBjYXRjaChlKSB7fQogIH0KCiAgZnVuY3Rpb24gUmVzaXplSGFuZGxlcihlKSB7CiAgICByZWN0ID0gY2FudmFzUmVjdDsKICAgIG1vdXNlVHJhbnNmb3JtID0gUG9zaXRpb25Qcm9jZXNzb3IoKTsKICAgIGNvbnNvbGUubG9nKCdSZXNpemVIYW5kbGVyJywgeyBlLCByZWN0IH0pOwogIH0KCiAgZnVuY3Rpb24gT3JpZW50YXRpb25DaGFuZ2UoZSkgewogICAgcmVjdCA9IGNhbnZhc1JlY3Q7CiAgICBtb3VzZVRyYW5zZm9ybSA9IFBvc2l0aW9uUHJvY2Vzc29yKCk7CiAgICBjb25zb2xlLmxvZygnT3JpZW50YXRpb25DaGFuZ2UnLCB7IGUsIHJlY3QgfSk7CiAgfQoKICBPYmplY3QuYXNzaWduKGdsb2JhbFRoaXMsIHsgUmFuZG9tQnl0ZSB9KTsKCiAgZnVuY3Rpb24gSW5pdCgpIHsKICAgIHdpbmRvdy5jYW52YXMgPSBlbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignY2FudmFzJyk7CgogICAgZGVmaW5lKAogICAgICBnbG9iYWxUaGlzLAogICAgICBwcm9wZXJ0aWVzKHsKICAgICAgICBjYW52YXNFbGVtZW50OiAoKSA9PiBFbGVtZW50LmZpbmQoJ2NhbnZhcycpLAogICAgICAgIGRpdkVsZW1lbnQ6ICgpID0+IEVsZW1lbnQuZmluZCgnYm9keSA+IGRpdjpmaXJzdC1jaGlsZCcpCiAgICAgIH0pLAogICAgICBwcm9wZXJ0aWVzKHsKICAgICAgICB3aW5kb3dSZWN0OiAoKSA9PiBuZXcgUmVjdCh3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KSwKICAgICAgICBib2R5UmVjdDogKCkgPT4gRWxlbWVudC5yZWN0KCdib2R5Jykucm91bmQoMCksCiAgICAgICAgY2FudmFzUmVjdDogKCkgPT4gRWxlbWVudC5yZWN0KCdjYW52YXMnKS5yb3VuZCgwKSwKICAgICAgICBkaXZSZWN0OiAoKSA9PiBFbGVtZW50LnJlY3QoJ2JvZHkgPiBkaXY6Zmlyc3QtY2hpbGQnKS5yb3VuZCgwKQogICAgICB9KSwKICAgICAgewogICAgICAgIGdldFJlY3QKICAgICAgfSwKICAgICAgcHJvcGVydGllcyh7CiAgICAgICAgdHJhbnNmb3JtOiBbKCkgPT4gbmV3IFRyYW5zZm9ybWF0aW9uTGlzdChFbGVtZW50LmdldENTUygnYm9keSA+IGRpdjpmaXJzdC1jaGlsZCcpLnRyYW5zZm9ybSksIHZhbHVlID0+IEVsZW1lbnQuc2V0Q1NTKCdib2R5ID4gZGl2OmZpcnN0LWNoaWxkJywgeyB0cmFuc2Zvcm06IHZhbHVlICsgJycgfSldCiAgICAgIH0pCiAgICApOwoKICAgIGNvbnN0IFNWR0NvbXBvbmVudCA9IHByb3BzID0+IHsKICAgICAgY29uc3QgcmVjdCA9IEVsZW1lbnQucmVjdChkb2N1bWVudC5ib2R5KS5yb3VuZCgxKTsKICAgICAgY29uc3QgeyBjZW50ZXIsIHdpZHRoLCBoZWlnaHQgfSA9IHJlY3Q7CgogICAgICByZXR1cm4gaCgnc3ZnJywgeyB2ZXJzaW9uOiAnMS4xJywgeG1sbnM6ICdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsIHZpZXdCb3g6IFsuLi5yZWN0XS5qb2luKCcgJyksIHdpZHRoLCBoZWlnaHQgfSwgWwogICAgICAgIGgoJ2NpcmNsZScsIHsgY3g6IGNlbnRlci54LCBjeTogY2VudGVyLnksIHI6IDI1MCwgc3Ryb2tlOiAnIzBmMCcsICdzdHJva2Utd2lkdGgnOiAxLCBmaWxsOiBgcmdiYSg4MCw4MCw4MCwwLjMpYCB9KQogICAgICBdKTsKICAgIH07CgogICAgbGV0IHN2Z0NvbnRhaW5lciA9IEVsZW1lbnQuY3JlYXRlKCdkaXYnLCB7fSwgZG9jdW1lbnQuYm9keSk7CiAgICBFbGVtZW50LnNldENTUyhzdmdDb250YWluZXIsIHsgcG9zaXRpb246ICdhYnNvbHV0ZScsIHRvcDogMCwgbGVmdDogMCwgekluZGV4OiA5OTk5OTk5OSwgcG9pbnRlckV2ZW50czogJ25vbmUnIH0pOwoKICAgIHJlbmRlcihoKFNWR0NvbXBvbmVudCksIHN2Z0NvbnRhaW5lcik7CgogICAgcmVjdCA9IGNhbnZhc1JlY3Q7CiAgICBtb3VzZVRyYW5zZm9ybSA9IFBvc2l0aW9uUHJvY2Vzc29yKCk7CgogICAgKGFzeW5jIGZ1bmN0aW9uKCkgewogICAgICBmb3IgYXdhaXQobGV0IGV2ZW50IG9mIHN0cmVhbWlmeShbJ29yaWVudGF0aW9uY2hhbmdlJywgJ3Jlc2l6ZSddLCBkb2N1bWVudCkpIHsKICAgICAgICBjb25zb2xlLmxvZyhldmVudC50eXBlLCBldmVudCk7CiAgICAgICAgZ2xvYmFsVGhpc1tldmVudC50eXBlXSA9IGV2ZW50OwogICAgICB9CiAgICB9KSgpOwoKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBSZXNpemVIYW5kbGVyLCB0cnVlKTsKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvcmllbnRhdGlvbmNoYW5nZScsIE9yaWVudGF0aW9uQ2hhbmdlLCB0cnVlKTsKCiAgICAvKiAgIGNvbnN0IGhhbmRsZXIgPSBNb3VzZUhhbmRsZXI7CgogICAgc3Vic2NyaWJlKE1vdmVtZW50SXRlcmF0b3IoZWxlbWVudCksIGhhbmRsZXIpOyovCiAgfQoKICBnbG9iYWxUaGlzLndzID0gKGdsb2JhbFRoaXMucndzID8/PSBOZXdXUygpKS53czsKCiAgKGFzeW5jIGZ1bmN0aW9uKCkgewogICAgbGV0IHRyYWlsID0gW10sCiAgICAgIHN0YXJ0LAogICAgICBsYXN0OwogICAgZm9yKDs7KSB7CiAgICAgIGxldCBwcmV2LCBwdDsKCiAgICAgIGZvciBhd2FpdChsZXQgZXYgb2YgTW92ZW1lbnRJdGVyYXRvcih3aW5kb3cpKSB7CiAgICAgICAgaWYoIWdsb2JhbFRoaXMuY2lkKSB7CiAgICAgICAgICBnbG9iYWxUaGlzLmNpZCA/Pz0gTWFrZUNsaWVudElEKCk7CgogICAgICAgICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeSh7IHR5cGU6ICdoZWxsbycsIGNpZCB9KSk7CiAgICAgICAgfQoKICAgICAgICBpZihyZWN0Lmluc2lkZShldikpIHsKICAgICAgICAgIGxldCBwdCA9IChnbG9iYWxUaGlzLm1vdXNlUG9zID0gbW91c2VUcmFuc2Zvcm0oZXYpKTsKICAgICAgICAgIGxldCBkaWZmID0gcHQsCiAgICAgICAgICAgIHQ7CiAgICAgICAgICBpZihwcmV2KSBkaWZmID0gcHQuZGlmZihwcmV2KTsKCiAgICAgICAgICBzdGFydCA/Pz0gdCA9IERhdGUubm93KCk7CgogICAgICAgICAgLy90cmFpbC5wdXNoKHsgLi4ucHQsIHRpbWU6IERhdGUubm93KCkgIC1zdGFydCAgfSk7CiAgICAgICAgICB0cmFpbC5wdXNoKHQgLSBzdGFydCArICcvJyArIChwcmV2ICYmIGRpZmYueCA+IDAgPyAnKycgOiAnJykgKyBkaWZmLnggKyAnLCcgKyAocHJldiAmJiBkaWZmLnkgPiAwID8gJysnIDogJycpICsgZGlmZi55KTsKCiAgICAgICAgICBsYXN0ID0gdDsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ2JsYXplJywgLi4ucHQpOwogICAgICAgICAgICByYyA9IHBpeGVsc1twdC55XVtwdC54XSA+IDB4MzAgPyAwIDogUmFuZG9tQnl0ZSgpIHwgMHg4MDsKCiAgICAgICAgICAgIEJsYXplKHB0LngsIHB0LnkpOwogICAgICAgICAgfSBjYXRjaChlKSB7fQogICAgICAgICAgcHJldiA9IHB0OwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIFNlbmRUcmFpbCgpIHsKICAgICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeSh7IHR5cGU6ICdibGF6ZScsIHN0YXJ0LCB0cmFpbDogdHJhaWwuam9pbignICcpIH0pKTsKCiAgICAgIHRyYWlsLnNwbGljZSgwLCB0cmFpbC5sZW5ndGgpOwogICAgICBzdGFydCA9IHVuZGVmaW5lZDsKICAgICAgcHJldiA9IHVuZGVmaW5lZDsKICAgIH0KICB9KSgpOwoKICBMb29wKCk7Cn0KCmRlZmluZShnbG9iYWxUaGlzLCB7IGNyb3Nza2l0LCBSR0JBLCBIU0xBLCBVdGlsLCBNYXRyaXgsIFRyYW5zZm9ybWF0aW9uTGlzdCB9KTsKZGVmaW5lKGdsb2JhbFRoaXMsIHsgV2ViU29ja2V0SXRlcmF0b3IsIFdlYlNvY2tldFVSTCwgQ3JlYXRlV2ViU29ja2V0LCBOZXdXUywgUmVjb25uZWN0aW5nV2ViU29ja2V0IH0pOwpkZWZpbmUoZ2xvYmFsVGhpcywgeyBkZWZpbmUsIGlzVW5kZWZpbmVkLCBwcm9wZXJ0aWVzLCBrZXlzIH0pOwpkZWZpbmUoZ2xvYmFsVGhpcywgeyBvbmNlLCBzdHJlYW1pZnksIHRocm90dGxlLCBkaXN0aW5jdCwgc3Vic2NyaWJlIH0pOwpkZWZpbmUoZ2xvYmFsVGhpcywgeyBJbnRlcnNlY3Rpb24sIE1hdHJpeCwgaXNSZWN0LCBSZWN0LCBTaXplLCBQb2ludCwgTGluZSwgVHJhbnNmb3JtYXRpb25MaXN0LCBWZWN0b3IgfSk7CmRlZmluZShnbG9iYWxUaGlzLCB7CiAgdGltZXIsCiAgTWFrZVVVSUQsCiAgTWFrZUNsaWVudElELAogIGlzU3RyZWFtLAogIEFjcXVpcmVSZWFkZXIsCiAgQWNxdWlyZVdyaXRlciwKICBBcnJheVdyaXRlciwKICByZWFkU3RyZWFtLAogIFBpcGVUbywKICBXcml0YWJsZVJlcGVhdGVyLAogIFdyaXRlSXRlcmF0b3IsCiAgQXN5bmNXcml0ZSwKICBBc3luY1JlYWQsCiAgUmVhZEZyb21JdGVyYXRvciwKICBXcml0ZVRvUmVwZWF0ZXIsCiAgTG9nU2luaywKICBTdHJpbmdSZWFkZXIsCiAgTGluZVJlYWRlciwKICBEZWJ1Z1RyYW5zZm9ybVN0cmVhbSwKICBDcmVhdGVXcml0YWJsZVN0cmVhbSwKICBDcmVhdGVUcmFuc2Zvcm1TdHJlYW0sCiAgUmVwZWF0ZXJTb3VyY2UsCiAgUmVwZWF0ZXJTaW5rLAogIExpbmVCdWZmZXJTdHJlYW0sCiAgVGV4dFRyYW5zZm9ybVN0cmVhbSwKICBDaHVua1JlYWRlciwKICBCeXRlUmVhZGVyLAogIFBpcGVUb1JlcGVhdGVyLAogIFJlYWRlciwKICBSZWFkQWxsLAogIFN0cmVhbVJlYWRJdGVyYXRvcgp9KTsKCmRlZmluZShnbG9iYWxUaGlzLCB7IEVsZW1lbnQsIGlzRWxlbWVudCwgU1ZHLCBSZWFjdCwgaCwgaHRtbCwgcmVuZGVyLCBGcmFnbWVudCwgQ29tcG9uZW50LCBjcmVhdGVSZWYsIHVzZVN0YXRlLCB1c2VMYXlvdXRFZmZlY3QsIHVzZVJlZiwgdG9DaGlsZEFycmF5IH0pOwoKbWFpbigpOwoKZnVuY3Rpb24gZ2V0UmVjdChlbGVtKSB7CiAgcmV0dXJuIG5ldyBSZWN0KChlbGVtID8/IGRpdkVsZW1lbnQpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKS5yb3VuZCgxKTsKfQoAAAAAAAAAAPI3AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAASSoAAAAAAABJKgAAAAAAAAAAAAAAwHhA"
				],
				[
					1024,
					1,
					"toggle_comment",
					{
						"block": true
					},
					"AgAAACgsAAAAAAAAKiwAAAAAAAAAAAAAAiwAAAAAAAAELAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAAiwAAAAAAAAoLAAAAAAAAAAAAAAAAPC/"
				],
				[
					1041,
					1,
					"insert",
					{
						"characters": "\n"
					},
					"AQAAAFAyAAAAAAAAUTIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAUDIAAAAAAABQMgAAAAAAAAAAAAAAAAAA"
				],
				[
					1042,
					1,
					"left_delete",
					null,
					"AQAAAFAyAAAAAAAAUDIAAAAAAAABAAAACg",
					"AQAAAAAAAAABAAAAUTIAAAAAAABRMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1083,
					1,
					"insert",
					{
						"characters": "\nif"
					},
					"BQAAAE8yAAAAAAAAUDIAAAAAAAAAAAAAUDIAAAAAAABUMgAAAAAAAAAAAABUMgAAAAAAAFYyAAAAAAAAAAAAAFYyAAAAAAAAVzIAAAAAAAAAAAAAVzIAAAAAAABYMgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAATzIAAAAAAABPMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1084,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAFgyAAAAAAAAWjIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAWDIAAAAAAABYMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1085,
					1,
					"insert",
					{
						"characters": "tral"
					},
					"BAAAAFkyAAAAAAAAWjIAAAAAAAAAAAAAWjIAAAAAAABbMgAAAAAAAAAAAABbMgAAAAAAAFwyAAAAAAAAAAAAAFwyAAAAAAAAXTIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAWTIAAAAAAABZMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1086,
					1,
					"left_delete",
					null,
					"AQAAAFwyAAAAAAAAXDIAAAAAAAABAAAAbA",
					"AQAAAAAAAAABAAAAXTIAAAAAAABdMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1087,
					1,
					"insert",
					{
						"characters": "il.lkengt"
					},
					"CQAAAFwyAAAAAAAAXTIAAAAAAAAAAAAAXTIAAAAAAABeMgAAAAAAAAAAAABeMgAAAAAAAF8yAAAAAAAAAAAAAF8yAAAAAAAAYDIAAAAAAAAAAAAAYDIAAAAAAABhMgAAAAAAAAAAAABhMgAAAAAAAGIyAAAAAAAAAAAAAGIyAAAAAAAAYzIAAAAAAAAAAAAAYzIAAAAAAABkMgAAAAAAAAAAAABkMgAAAAAAAGUyAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAXDIAAAAAAABcMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1088,
					5,
					"left_delete",
					null,
					"BQAAAGQyAAAAAAAAZDIAAAAAAAABAAAAdGMyAAAAAAAAYzIAAAAAAAABAAAAZ2IyAAAAAAAAYjIAAAAAAAABAAAAbmEyAAAAAAAAYTIAAAAAAAABAAAAZWAyAAAAAAAAYDIAAAAAAAABAAAAaw",
					"AQAAAAAAAAABAAAAZTIAAAAAAABlMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1089,
					1,
					"insert",
					{
						"characters": "engt"
					},
					"BAAAAGAyAAAAAAAAYTIAAAAAAAAAAAAAYTIAAAAAAABiMgAAAAAAAAAAAABiMgAAAAAAAGMyAAAAAAAAAAAAAGMyAAAAAAAAZDIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAYDIAAAAAAABgMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1091,
					1,
					"left_delete",
					null,
					"AQAAAGQyAAAAAAAAZDIAAAAAAAABAAAAKQ",
					"AQAAAAAAAAABAAAAZTIAAAAAAABlMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1092,
					1,
					"insert",
					{
						"characters": "h)"
					},
					"AgAAAGQyAAAAAAAAZTIAAAAAAAAAAAAAZTIAAAAAAABmMgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAZDIAAAAAAABkMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1097,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAGYyAAAAAAAAZzIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAZjIAAAAAAABmMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1098,
					1,
					"insert_snippet",
					{
						"contents": "{$0}"
					},
					"AQAAAGcyAAAAAAAAaTIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAZzIAAAAAAABnMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1099,
					1,
					"right_delete",
					null,
					"AQAAAGgyAAAAAAAAaDIAAAAAAAABAAAAfQ",
					"AQAAAAAAAAABAAAAaDIAAAAAAABoMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1102,
					2,
					"left_delete",
					null,
					"AgAAAGcyAAAAAAAAZzIAAAAAAAABAAAAe2YyAAAAAAAAZjIAAAAAAAABAAAAIA",
					"AQAAAAAAAAABAAAAaDIAAAAAAABoMgAAAAAAAAAAAAAAAGtA"
				],
				[
					1108,
					1,
					"insert",
					{
						"characters": "\t"
					},
					"AQAAAGcyAAAAAAAAaTIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAZzIAAAAAAABnMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1112,
					1,
					"insert",
					{
						"characters": "\n\n"
					},
					"AgAAADQyAAAAAAAANTIAAAAAAAAAAAAANTIAAAAAAAA2MgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAANDIAAAAAAAA0MgAAAAAAAAAAAAAAADJA"
				],
				[
					1114,
					1,
					"insert",
					{
						"characters": "SendTrail"
					},
					"CQAAADUyAAAAAAAANjIAAAAAAAAAAAAANjIAAAAAAAA3MgAAAAAAAAAAAAA3MgAAAAAAADgyAAAAAAAAAAAAADgyAAAAAAAAOTIAAAAAAAAAAAAAOTIAAAAAAAA6MgAAAAAAAAAAAAA6MgAAAAAAADsyAAAAAAAAAAAAADsyAAAAAAAAPDIAAAAAAAAAAAAAPDIAAAAAAAA9MgAAAAAAAAAAAAA9MgAAAAAAAD4yAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAANTIAAAAAAAA1MgAAAAAAAAAAAAAAAAAA"
				],
				[
					1115,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAD4yAAAAAAAAQDIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAPjIAAAAAAAA+MgAAAAAAAAAAAAAAAPC/"
				],
				[
					1117,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAEAyAAAAAAAAQTIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAQDIAAAAAAABAMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1142,
					1,
					"paste",
					null,
					"AQAAAGIyAAAAAAAAjTIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAYjIAAAAAAABiMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1147,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAJ8yAAAAAAAAoDIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAnzIAAAAAAACfMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1148,
					1,
					"insert_snippet",
					{
						"contents": "{$0}"
					},
					"AQAAAKAyAAAAAAAAojIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAoDIAAAAAAACgMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1149,
					1,
					"right_delete",
					null,
					"AQAAAKEyAAAAAAAAoTIAAAAAAAABAAAAfQ",
					"AQAAAAAAAAABAAAAoTIAAAAAAAChMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1151,
					1,
					"insert",
					{
						"characters": "}"
					},
					"AQAAAPUyAAAAAAAA9jIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA9TIAAAAAAAD1MgAAAAAAAAAAAAAAgGZA"
				],
				[
					1158,
					1,
					"cut",
					null,
					"AQAAAG4yAAAAAAAAbjIAAAAAAAAeAAAALy9jb25zb2xlLmxvZygnYmxhemUnLCAuLi5wdCk7",
					"AQAAAAAAAAABAAAAbjIAAAAAAACMMgAAAAAAAP///////+9/"
				],
				[
					1161,
					1,
					"insert",
					{
						"characters": "\n"
					},
					"AwAAAIMyAAAAAAAAhDIAAAAAAAAAAAAAhDIAAAAAAACGMgAAAAAAAAAAAACGMgAAAAAAAIgyAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAgzIAAAAAAACDMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1162,
					1,
					"paste",
					null,
					"AQAAAIgyAAAAAAAApjIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAiDIAAAAAAACIMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1175,
					1,
					"cut",
					null,
					"AQAAAMYyAAAAAAAAxjIAAAAAAAAwAAAAeyB0eXBlOiAnYmxhemUnLCBzdGFydCwgdHJhaWw6IHRyYWlsLmpvaW4oJyAnKSB9",
					"AQAAAAAAAAABAAAAxjIAAAAAAAD2MgAAAAAAAAAAAAAAAPC/"
				],
				[
					1176,
					1,
					"insert",
					{
						"characters": "payload"
					},
					"BwAAAMYyAAAAAAAAxzIAAAAAAAAAAAAAxzIAAAAAAADIMgAAAAAAAAAAAADIMgAAAAAAAMkyAAAAAAAAAAAAAMkyAAAAAAAAyjIAAAAAAAAAAAAAyjIAAAAAAADLMgAAAAAAAAAAAADLMgAAAAAAAMwyAAAAAAAAAAAAAMwyAAAAAAAAzTIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAxjIAAAAAAADGMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1178,
					1,
					"insert",
					{
						"characters": "\nlet"
					},
					"BgAAAIMyAAAAAAAAhDIAAAAAAAAAAAAAhDIAAAAAAACGMgAAAAAAAAAAAACGMgAAAAAAAIgyAAAAAAAAAAAAAIgyAAAAAAAAiTIAAAAAAAAAAAAAiTIAAAAAAACKMgAAAAAAAAAAAACKMgAAAAAAAIsyAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAgzIAAAAAAACDMgAAAAAAAAAAAAAAYHVA"
				],
				[
					1179,
					1,
					"insert",
					{
						"characters": " l"
					},
					"AgAAAIsyAAAAAAAAjDIAAAAAAAAAAAAAjDIAAAAAAACNMgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAizIAAAAAAACLMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1180,
					5,
					"left_delete",
					null,
					"BQAAAIwyAAAAAAAAjDIAAAAAAAABAAAAbIsyAAAAAAAAizIAAAAAAAABAAAAIIoyAAAAAAAAijIAAAAAAAABAAAAdIkyAAAAAAAAiTIAAAAAAAABAAAAZYgyAAAAAAAAiDIAAAAAAAABAAAAbA",
					"AQAAAAAAAAABAAAAjTIAAAAAAACNMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1181,
					1,
					"insert",
					{
						"characters": "const"
					},
					"BQAAAIgyAAAAAAAAiTIAAAAAAAAAAAAAiTIAAAAAAACKMgAAAAAAAAAAAACKMgAAAAAAAIsyAAAAAAAAAAAAAIsyAAAAAAAAjDIAAAAAAAAAAAAAjDIAAAAAAACNMgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAiDIAAAAAAACIMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1182,
					1,
					"insert",
					{
						"characters": " paylod"
					},
					"BwAAAI0yAAAAAAAAjjIAAAAAAAAAAAAAjjIAAAAAAACPMgAAAAAAAAAAAACPMgAAAAAAAJAyAAAAAAAAAAAAAJAyAAAAAAAAkTIAAAAAAAAAAAAAkTIAAAAAAACSMgAAAAAAAAAAAACSMgAAAAAAAJMyAAAAAAAAAAAAAJMyAAAAAAAAlDIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAjTIAAAAAAACNMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1183,
					1,
					"left_delete",
					null,
					"AQAAAJMyAAAAAAAAkzIAAAAAAAABAAAAZA",
					"AQAAAAAAAAABAAAAlDIAAAAAAACUMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1184,
					1,
					"insert",
					{
						"characters": "ad=)"
					},
					"BAAAAJMyAAAAAAAAlDIAAAAAAAAAAAAAlDIAAAAAAACVMgAAAAAAAAAAAACVMgAAAAAAAJYyAAAAAAAAAAAAAJYyAAAAAAAAlzIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAkzIAAAAAAACTMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1185,
					1,
					"left_delete",
					null,
					"AQAAAJYyAAAAAAAAljIAAAAAAAABAAAAKQ",
					"AQAAAAAAAAABAAAAlzIAAAAAAACXMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1186,
					1,
					"paste",
					null,
					"AQAAAJYyAAAAAAAAxjIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAljIAAAAAAACWMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1187,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAMYyAAAAAAAAxzIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAxjIAAAAAAADGMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1191,
					2,
					"right_delete",
					null,
					"AgAAAMwyAAAAAAAAzDIAAAAAAAABAAAAL8wyAAAAAAAAzDIAAAAAAAABAAAALw",
					"AQAAAAAAAAABAAAAzDIAAAAAAADMMgAAAAAAAAAAAAAAAEJA"
				],
				[
					1194,
					5,
					"right_delete",
					null,
					"BQAAANkyAAAAAAAA2TIAAAAAAAABAAAAYtkyAAAAAAAA2TIAAAAAAAABAAAAbNkyAAAAAAAA2TIAAAAAAAABAAAAYdkyAAAAAAAA2TIAAAAAAAABAAAAetkyAAAAAAAA2TIAAAAAAAABAAAAZQ",
					"AQAAAAAAAAABAAAA2TIAAAAAAADZMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1195,
					1,
					"insert",
					{
						"characters": "SE"
					},
					"AgAAANkyAAAAAAAA2jIAAAAAAAAAAAAA2jIAAAAAAADbMgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA2TIAAAAAAADZMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1196,
					1,
					"left_delete",
					null,
					"AQAAANoyAAAAAAAA2jIAAAAAAAABAAAARQ",
					"AQAAAAAAAAABAAAA2zIAAAAAAADbMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1197,
					1,
					"insert",
					{
						"characters": "endTrail,"
					},
					"CQAAANoyAAAAAAAA2zIAAAAAAAAAAAAA2zIAAAAAAADcMgAAAAAAAAAAAADcMgAAAAAAAN0yAAAAAAAAAAAAAN0yAAAAAAAA3jIAAAAAAAAAAAAA3jIAAAAAAADfMgAAAAAAAAAAAADfMgAAAAAAAOAyAAAAAAAAAAAAAOAyAAAAAAAA4TIAAAAAAAAAAAAA4TIAAAAAAADiMgAAAAAAAAAAAADiMgAAAAAAAOMyAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA2jIAAAAAAADaMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1198,
					1,
					"left_delete",
					null,
					"AQAAAOIyAAAAAAAA4jIAAAAAAAABAAAALA",
					"AQAAAAAAAAABAAAA4zIAAAAAAADjMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1200,
					1,
					"insert",
					{
						"characters": ",payload);"
					},
					"CgAAAOMyAAAAAAAA5DIAAAAAAAAAAAAA5DIAAAAAAADlMgAAAAAAAAAAAADlMgAAAAAAAOYyAAAAAAAAAAAAAOYyAAAAAAAA5zIAAAAAAAAAAAAA5zIAAAAAAADoMgAAAAAAAAAAAADoMgAAAAAAAOkyAAAAAAAAAAAAAOkyAAAAAAAA6jIAAAAAAAAAAAAA6jIAAAAAAADrMgAAAAAAAAAAAADrMgAAAAAAAOwyAAAAAAAAAAAAAOwyAAAAAAAA7TIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA4zIAAAAAAADjMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1202,
					1,
					"cut",
					null,
					"AQAAAO0yAAAAAAAA7TIAAAAAAAAJAAAALCAuLi5wdCk7",
					"AQAAAAAAAAABAAAA7TIAAAAAAAD2MgAAAAAAAP///////+9/"
				],
				[
					1310,
					1,
					"cut",
					null,
					"AQAAAC4yAAAAAAAALjIAAAAAAAAGAAAAICAgIH0K",
					"AQAAAAAAAAABAAAALjIAAAAAAAA0MgAAAAAAAAAAAAAAAAAA"
				],
				[
					1314,
					1,
					"insert",
					{
						"characters": "\n"
					},
					"AQAAAHAzAAAAAAAAcTMAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAcDMAAAAAAABwMwAAAAAAAAAAAAAAAAAA"
				],
				[
					1316,
					1,
					"paste",
					null,
					"AQAAAHAzAAAAAAAAdjMAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAcDMAAAAAAABwMwAAAAAAAAAAAAAAAAAA"
				],
				[
					1319,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAABvOAAAaW1wb3J0IHsgY3Jvc3NraXQsIENBTlZBUyB9IGZyb20gJy4vbGliL2Nyb3Nza2l0LmpzJzsKaW1wb3J0IHsgUkdCQSwgSFNMQSB9IGZyb20gJy4vbGliL2NvbG9yLmpzJzsKaW1wb3J0IHsgdGltZXIgfSBmcm9tICcuL2xpYi9hc3luYy9oZWxwZXJzLmpzJzsKaW1wb3J0IHsgV2ViU29ja2V0SXRlcmF0b3IsIFdlYlNvY2tldFVSTCwgQ3JlYXRlV2ViU29ja2V0LCBSZWNvbm5lY3RpbmdXZWJTb2NrZXQsIFN0cmVhbVJlYWRJdGVyYXRvciB9IGZyb20gJy4vbGliL2FzeW5jL3dlYnNvY2tldC5qcyc7CmltcG9ydCB7IG9uY2UsIHN0cmVhbWlmeSwgdGhyb3R0bGUsIGRpc3RpbmN0LCBzdWJzY3JpYmUgfSBmcm9tICcuL2xpYi9hc3luYy9ldmVudHMuanMnOwppbXBvcnQgeyBtZW1vaXplLCBkZWZpbmUsIGlzVW5kZWZpbmVkLCBwcm9wZXJ0aWVzLCBrZXlzLCB1bmlxdWUsIHJhbmRTdHIsIHJhbmRJbnQgfSBmcm9tICcuL2xpYi9taXNjLmpzJzsKaW1wb3J0IHsgaXNTdHJlYW0sIEFjcXVpcmVSZWFkZXIsIEFjcXVpcmVXcml0ZXIsIEFycmF5V3JpdGVyLCByZWFkU3RyZWFtLCBQaXBlVG8sIFdyaXRhYmxlUmVwZWF0ZXIsIFdyaXRlSXRlcmF0b3IsIEFzeW5jV3JpdGUsIEFzeW5jUmVhZCwgUmVhZEZyb21JdGVyYXRvciwgV3JpdGVUb1JlcGVhdGVyLCBMb2dTaW5rLCBTdHJpbmdSZWFkZXIsIExpbmVSZWFkZXIsIERlYnVnVHJhbnNmb3JtU3RyZWFtLCBDcmVhdGVXcml0YWJsZVN0cmVhbSwgQ3JlYXRlVHJhbnNmb3JtU3RyZWFtLCBSZXBlYXRlclNvdXJjZSwgUmVwZWF0ZXJTaW5rLCBMaW5lQnVmZmVyU3RyZWFtLCBUZXh0VHJhbnNmb3JtU3RyZWFtLCBDaHVua1JlYWRlciwgQnl0ZVJlYWRlciwgUGlwZVRvUmVwZWF0ZXIsIFJlYWRlciwgUmVhZEFsbCwgZGVmYXVsdCBhcyB1dGlscyB9IGZyb20gJy4vbGliL3N0cmVhbS91dGlscy5qcyc7CmltcG9ydCB7IEludGVyc2VjdGlvbiwgTWF0cml4LCBpc1JlY3QsIFJlY3QsIFNpemUsIFBvaW50LCBMaW5lLCBUcmFuc2Zvcm1hdGlvbkxpc3QsIFZlY3RvciB9IGZyb20gJy4vbGliL2dlb20uanMnOwppbXBvcnQgeyBFbGVtZW50LCBpc0VsZW1lbnQsIFNWRyB9IGZyb20gJy4vbGliL2RvbS5qcyc7CmltcG9ydCBSZWFjdCwgeyBoLCBodG1sLCByZW5kZXIsIEZyYWdtZW50LCBDb21wb25lbnQsIGNyZWF0ZVJlZiwgdXNlU3RhdGUsIHVzZUxheW91dEVmZmVjdCwgdXNlUmVmLCB0b0NoaWxkQXJyYXkgfSBmcm9tICcuL2xpYi9kb20vcHJlYWN0Q29tcG9uZW50LmpzJzsKCmZ1bmN0aW9uIE5ld1dTKCkgewogIGxldCB1cmwgPSBXZWJTb2NrZXRVUkwoJy93cycsIHsgbWlycm9yOiBjdXJyZW50RmlsZSB9KTsKICBsZXQgd3MgPSBuZXcgUmVjb25uZWN0aW5nV2ViU29ja2V0KHVybCwgJ2x3cy1taXJyb3ItcHJvdG9jb2wnKTsKICAoYXN5bmMgZnVuY3Rpb24oKSB7CiAgICBmb3IgYXdhaXQobGV0IGNodW5rIG9mIHdzKSB7CiAgICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShjaHVuayk7CgogICAgICBpZihkYXRhLmNpZCAhPSBnbG9iYWxUaGlzLmNpZCkgY29uc29sZS5sb2coJ1dTIHJlY2VpdmU6JywgZGF0YSk7CiAgICB9CiAgfSkoKTsKICByZXR1cm4gKGdsb2JhbFRoaXMud3MgPSB3cyk7Cn0KCmNvbnN0IE1ha2VVVUlEID0gKHJuZyA9IE1hdGgucmFuZG9tKSA9PiBbOCwgNCwgNCwgNCwgMTJdLm1hcChuID0+IHJhbmRTdHIobiwgJzAxMjM0NTY3ODlhYmNkZWYnKSwgcm5nKS5qb2luKCctJyk7CmNvbnN0IE1ha2VDbGllbnRJRCA9IChybmcgPSBNYXRoLnJhbmRvbSkgPT4KICBbNCwgNCwgNCwgNF0KICAgIC5tYXAobiA9PiByYW5kU3RyKG4sIFsnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVonLCAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonLCAnLi0kJ11bcmFuZEludCgwLCAzKV0pLCBybmcpCiAgICAuam9pbignJyk7CgpmdW5jdGlvbiBtYWluKCkgewogIGRlZmluZSgKICAgIGdsb2JhbFRoaXMsCiAgICBwcm9wZXJ0aWVzKAogICAgICB7CiAgICAgICAgY3VycmVudFVSTDogKCkgPT4gbmV3IFVSTChpbXBvcnQubWV0YS51cmwpLAogICAgICAgIGN1cnJlbnRGaWxlOiAoKSA9PiBnbG9iYWxUaGlzLmN1cnJlbnRVUkwucGF0aG5hbWUucmVwbGFjZSgvXlwvLywgJycpCiAgICAgIH0sCiAgICAgIHsgbWVtb2l6ZTogdHJ1ZSB9CiAgICApCiAgKTsKCiAgY29uc3Qgd2lkdGggPSAzMjA7CiAgY29uc3QgaGVpZ2h0ID0gMjAwOwogIGNvbnN0IHBhcmVudCA9IGRvY3VtZW50LmJvZHk7CgogIGNyb3Nza2l0LmluaXQoewogICAgcmVuZGVyZXI6IENBTlZBUywKICAgIHBhcmVudCwKICAgIHc6IHdpZHRoLAogICAgaDogaGVpZ2h0LAogICAgYWxwaGE6IGZhbHNlCiAgfSk7CgogIGZ1bmN0aW9uIFJlcGFyZW50KGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdjYW52YXMnKVswXSkgewogICAgY2FudmFzLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoY2FudmFzKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKS5hcHBlbmRDaGlsZChjYW52YXMpOwogIH0KCiAgZnVuY3Rpb24gR2V0RWxlbWVudE1hdHJpeChlbGVtZW50KSB7CiAgICBsZXQgeyB0cmFuc2Zvcm0gfSA9IEVsZW1lbnQuZ2V0Q1NTKGRpdkVsZW1lbnQpOwoKICAgIHJldHVybiBNYXRyaXguZnJvbUNTUyh0cmFuc2Zvcm0pOwogIH0KCiAgZnVuY3Rpb24gU2V0Q3Jvc3NoYWlyKHBvcykgewogICAgbGV0IGNoID0gRWxlbWVudC5maW5kKCcjY3Jvc3NoYWlyJyk7CiAgICBsZXQgcmVjdCA9IEVsZW1lbnQuZ2V0UmVjdChjaCk7CgogICAgY29uc29sZS5sb2coJ1NldENyb3NzaGFpcicsIHsgY2gsIHJlY3QsIHBvcyB9KTsKICAgIHJlY3QueCA9IHBvcy54IC0gcmVjdC53aWR0aCAvIDI7CiAgICByZWN0LnkgPSBwb3MueSAtIHJlY3QuaGVpZ2h0IC8gMjsKCiAgICBFbGVtZW50LnNldFJlY3QoY2gsIHJlY3QpOwogIH0KCiAgZnVuY3Rpb24gRXZlbnRQb3NpdGlvbnMoZXZlbnRPclRvdWNoKSB7CiAgICBsZXQgcG9zaXRpb25zID0gdW5pcXVlKAogICAgICBrZXlzKGV2ZW50T3JUb3VjaCwgMikKICAgICAgICAuZmlsdGVyKG4gPT4gdHlwZW9mIG4gPT0gJ3N0cmluZycgJiYgL1tYWV0kLy50ZXN0KG4pKQogICAgICAgIC5tYXAobiA9PiBuLnNsaWNlKDAsIC0xKSkKICAgICk7CgogICAgcmV0dXJuIHBvc2l0aW9ucy5yZWR1Y2UoKGFjYywga2V5KSA9PiB7CiAgICAgIGFjY1trZXldID0gbmV3IFBvaW50KGV2ZW50T3JUb3VjaFtrZXkgKyAnWCddLCBldmVudE9yVG91Y2hba2V5ICsgJ1knXSk7CiAgICAgIHJldHVybiBhY2M7CiAgICB9LCB7fSk7CiAgfQoKICBmdW5jdGlvbiBQb3NpdGlvbk1hdHJpeChjYW52YXMgPSBjYW52YXNFbGVtZW50LCByZWN0ID0gY2FudmFzUmVjdCkgewogICAgbGV0IHZlcnRpY2FsID0gcmVjdC5hc3BlY3QoKSA8IDE7CiAgICBsZXQgdG9wTGVmdCA9IHJlY3QudG9Qb2ludHMoKVt2ZXJ0aWNhbCA/IDEgOiAwXTsKICAgIGxldCBtID0gTWF0cml4LmlkZW50aXR5KCkuc2NhbGUoY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTsKCiAgICBpZih2ZXJ0aWNhbCkgbSA9IG0ucm90YXRlKC1NYXRoLlBJIC8gMik7CgogICAgbSA9IG0uc2NhbGUoMSAvIHJlY3Qud2lkdGgsIDEgLyByZWN0LmhlaWdodCk7CiAgICBtID0gbS50cmFuc2xhdGUoLXRvcExlZnQueCwgLXRvcExlZnQueSk7CgogICAgcmV0dXJuIG07CiAgfQoKICBmdW5jdGlvbiBQb3NpdGlvblByb2Nlc3NvcihjYW52YXMgPSBjYW52YXNFbGVtZW50LCByZWN0ID0gY2FudmFzUmVjdCkgewogICAgbGV0IG0gPSBQb3NpdGlvbk1hdHJpeChjYW52YXMsIHJlY3QpOwogICAgcmV0dXJuIHBvcyA9PiBuZXcgUG9pbnQoLi4ubS50cmFuc2Zvcm1fcG9pbnQobmV3IFBvaW50KHBvcykpKS5yb3VuZCgxKTsKICB9CgogIGZ1bmN0aW9uIFByb2Nlc3NQb3NpdGlvbihwb3MpIHsKICAgIHJldHVybiBQb3NpdGlvblByb2Nlc3NvcigpKHBvcyk7CiAgfQoKICBhc3luYyBmdW5jdGlvbiogTW92ZW1lbnRJdGVyYXRvcihlbGVtZW50KSB7CiAgICBsZXQgZXYgPSBhd2FpdCBvbmNlKGVsZW1lbnQsICdtb3VzZWRvd24nLCAndG91Y2hzdGFydCcpOwogICAgbGV0IHR5cGUgPSBldi50eXBlLnNsaWNlKDAsIDUpOwogICAgeWllbGQgZXY7CiAgICBjb25zb2xlLmxvZyh0eXBlICsgJyBzdGFydCcpOwogICAgZm9yIGF3YWl0KGxldCBldmVudCBvZiBzdHJlYW1pZnkoWydtb3VzZXVwJywgJ21vdXNlbW92ZScsICd0b3VjaGVuZCcsICd0b3VjaG1vdmUnXSwgZWxlbWVudCkpIHsKICAgICAgLy9ldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBpZigndG91Y2hlcycgaW4gZXZlbnQpIHsKICAgICAgICBpZihldmVudC50b3VjaGVzLmxlbmd0aCkgewogICAgICAgICAgZ2xvYmFsVGhpcy5tb3VzZUV2ZW50ID0gZXZlbnQ7CgogICAgICAgICAgeWllbGQqIFsuLi5ldmVudC50b3VjaGVzXS5tYXAoRXZlbnRQb3NpdGlvbnMpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCB7IHR5cGUsIGNsaWVudFg6IHgsIGNsaWVudFk6IHkgfSA9IGV2ZW50OwogICAgICAgIGxldCBvYmogPSB7IHR5cGUsIHgsIHkgfTsKICAgICAgICB5aWVsZCBvYmo7CiAgICAgIH0KICAgICAgaWYoLyh1cHxlbmQpJC8udGVzdChldmVudC50eXBlKSkgewogICAgICAgIGNvbnNvbGUubG9nKHR5cGUgKyAnIGVuZCcpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQoKICBSZXBhcmVudCgpOwoKICBjcm9zc2tpdC5jbGVhcigpOwogIGNyb3Nza2l0LnJlY3QoewogICAgeDogMCwKICAgIHk6IDAsCiAgICB3aWR0aCwKICAgIGhlaWdodCwKICAgIGZpbGw6ICdibGFjaycsCiAgICBzdHJva2U6ICdibGFjaycsCiAgICBhbmdsZTogMAogIH0pOwoKICBjb25zdCBidWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIod2lkdGggKiAoaGVpZ2h0ICsgMikpOwogIGNvbnN0IHBhbGV0dGUgPSBDcmVhdGVQYWxldHRlKCk7CiAgY29uc3QgcGFsZXR0ZUhTTCA9IENyZWF0ZVBhbGV0dGVIU0woKTsKCiAgY29uc3QgcGl4ZWxzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogaGVpZ2h0ICsgMiB9KS5tYXAoKHYsIGkpID0+IG5ldyBVaW50OENsYW1wZWRBcnJheShidWZmZXIsIGkgKiB3aWR0aCwgd2lkdGgpKTsKICBjb25zdCB7IGNvbnRleHQgfSA9IGNyb3Nza2l0OwogIGNvbnN0IGltYWdlID0gY29udGV4dC5jcmVhdGVJbWFnZURhdGEod2lkdGgsIGhlaWdodCk7CgogIGNvbnN0IHsgbm93LCB3YWl0Rm9yLCBhbmltYXRpb25GcmFtZSB9ID0gVXRpbDsKICBjb25zdCBmcHMgPSA1MDsKICBjb25zdCBtYXRyaXggPSBuZXcgTWF0cml4KCkudHJhbnNsYXRlKDE2MCwgMTAwKS5zY2FsZSgwLjUpOwoKICBPYmplY3QuYXNzaWduKGdsb2JhbFRoaXMsIHsKICAgIGJ1ZmZlciwKICAgIHBhbGV0dGUsCiAgICBwYWxldHRlSFNMLAogICAgcGl4ZWxzLAogICAgY29udGV4dCwKICAgIGltYWdlLAogICAgZnBzLAogICAgbWF0cml4LAogICAgUmVwYXJlbnQsCiAgICBkb206IHsgRWxlbWVudCB9LAogICAgZ2VvbTogeyBSZWN0IH0sCiAgICBNb3ZlbWVudEl0ZXJhdG9yLAogICAgTW91c2VIYW5kbGVyLAogICAgR2V0RWxlbWVudE1hdHJpeCwKICAgIFNldENyb3NzaGFpciwKICAgIEV2ZW50UG9zaXRpb25zLAogICAgUG9zaXRpb25Qcm9jZXNzb3IsCiAgICBQb3NpdGlvbk1hdHJpeCwKICAgIFByb2Nlc3NQb3NpdGlvbgogIH0pOwoKICBhc3luYyBmdW5jdGlvbiBMb29wKCkgewogICAgY29uc3QgZGVsYXkgPSAxMDAwIC8gZnBzOwogICAgY29uc3QgbG9nID0gKHQsIG5hbWUpID0+IGdsb2JhbFRoaXMuZG9Mb2cgJiYgY29uc29sZS5sb2coYCR7bmFtZX0gdGltaW5nOiAke3QudG9GaXhlZCgzKX1tc2ApOwogICAgY29uc3QgZmlyZSA9ICguLi5hcmdzKSA9PiBGaXJlKC4uLmFyZ3MpOwogICAgY29uc3QgcmVkcmF3ID0gKC4uLmFyZ3MpID0+IFJlZHJhdyguLi5hcmdzKTsKCiAgICBhd2FpdCBvbmNlKHdpbmRvdywgJ2xvYWQnKTsKCiAgICBJbml0KCk7CgogICAgZm9yKDs7KSB7CiAgICAgIGZpcmUoKTsKICAgICAgcmVkcmF3KCk7CiAgICAgIGF3YWl0IGFuaW1hdGlvbkZyYW1lKGRlbGF5KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIEZpcmUoKSB7CiAgICBmb3IobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewogICAgICBwaXhlbHNbaGVpZ2h0XVt4XSA9IDI1NSAtIChSYW5kb21CeXRlKCkgJSAxMjgpOwogICAgICBwaXhlbHNbaGVpZ2h0ICsgMV1beF0gPSAyNTUgLSAoUmFuZG9tQnl0ZSgpICUgMTI4KTsKICAgIH0KCiAgICBmb3IobGV0IHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKICAgICAgZm9yKGxldCB4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHsKICAgICAgICBjb25zdCBzdW0gPSBbCiAgICAgICAgICBwaXhlbHNbeSArIDFdW01vZHVsbyh4IC0gMSwgd2lkdGgpXSwKICAgICAgICAgIHBpeGVsc1t5ICsgMV1beF0sCiAgICAgICAgICBwaXhlbHNbeSArIDFdW01vZHVsbyh4ICsgMSwgd2lkdGgpXSwKICAgICAgICAgIHBpeGVsc1t5ICsgMl1beF0KICAgICAgICBdLnJlZHVjZSgoYSwgcCkgPT4gYSArIChwIHwgMCksIDApOwoKICAgICAgICBwaXhlbHNbeV1beF0gPSAoc3VtICogMTUpID4+PiA2OwogICAgICB9CiAgICB9CiAgfQoKICBhc3luYyBmdW5jdGlvbiBSZWRyYXcoKSB7CiAgICBjb25zdCB7IGRhdGEgfSA9IGltYWdlOwoKICAgIGxldCBpID0gMDsKICAgIGxldCB0ID0gWy4uLm1hdHJpeF07CgogICAgZm9yKGxldCB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CiAgICAgIGZvcihsZXQgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CiAgICAgICAgY29uc3QgYyA9IHBhbGV0dGVbcGl4ZWxzW3ldW3hdXTsKICAgICAgICBkYXRhW2krK10gPSBjLnI7CiAgICAgICAgZGF0YVtpKytdID0gYy5nOwogICAgICAgIGRhdGFbaSsrXSA9IGMuYjsKICAgICAgICBkYXRhW2krK10gPSBjLmE7CiAgICAgIH0KICAgIH0KCiAgICBjb250ZXh0LnB1dEltYWdlRGF0YShpbWFnZSwgMCwgMCk7CiAgfQoKICBmdW5jdGlvbiBDcmVhdGVQYWxldHRlKCkgewogICAgY29uc3QgY29sb3JzID0gbmV3IEFycmF5KDI1Nik7CgogICAgZm9yKGxldCBpID0gMDsgaSA8IDY0OyBpKyspIHsKICAgICAgY29uc3QgdmFsdWUgPSBpICogNDsKCiAgICAgIGNvbG9yc1tpXSA9IG5ldyBSR0JBKHZhbHVlLCAwLCAwKTsKICAgICAgY29sb3JzW2kgKyA2NF0gPSBuZXcgUkdCQSgyNTUsIHZhbHVlLCAwKTsKICAgICAgY29sb3JzW2kgKyAxMjhdID0gbmV3IFJHQkEoMjU1LCAyNTUsIHZhbHVlKTsKICAgICAgY29sb3JzW2kgKyAxOTJdID0gbmV3IFJHQkEoMjU1LCAyNTUsIDI1NSk7CiAgICB9CiAgICByZXR1cm4gY29sb3JzOwogIH0KCiAgZnVuY3Rpb24gQ3JlYXRlUGFsZXR0ZUhTTCgpIHsKICAgIGNvbnN0IGNvbG9ycyA9IG5ldyBBcnJheSgyNTYpOwoKICAgIGNvbnN0IGh1ZXMgPSBbCiAgICAgIG5ldyBIU0xBKDAsIDEwMCwgMCksCiAgICAgIG5ldyBIU0xBKDAsIDEwMCwgNTApLAogICAgICBuZXcgSFNMQSgzMCwgMTAwLCA1MCksCiAgICAgIG5ldyBIU0xBKDYwLCAxMDAsIDUwKSwKICAgICAgbmV3IEhTTEEoNjAsIDEwMCwgMTAwKSwKICAgICAgbmV3IEhTTEEoNjAsIDEwMCwgMTAwKQogICAgXTsKCiAgICBjb25zdCBicmVha3BvaW50cyA9IFswLCA1MSwgODAsIDE1NCwgMjA1LCAyNTZdOwogICAgY29uc29sZS5sb2coJ2JyZWFrcG9pbnRzOicsIGJyZWFrcG9pbnRzKTsKCiAgICBmb3IobGV0IGkgPSAwOyBpIDwgMjU2OyBpKyspIHsKICAgICAgY29uc3QgaHVlID0gKHYgPT4gKHYgPT0gLTEgPyAoKSA9PiBodWVzLmxlbmd0aCAtIDIgOiB2ID0+IHYpKShicmVha3BvaW50cy5maW5kSW5kZXgoYiA9PiBpIDwgYikpOwogICAgICBjb25zdCByYW5nZSA9IGJyZWFrcG9pbnRzW2h1ZV0gLSAxIC0gYnJlYWtwb2ludHNbaHVlIC0gMV07CgogICAgICBjb2xvcnNbaV0gPSBIU0xBLmJsZW5kKGh1ZXNbaHVlIC0gMV0sIGh1ZXNbaHVlXSwgKGkgLSBicmVha3BvaW50c1todWUgLSAxXSkgLyByYW5nZSkudG9SR0JBKCk7CiAgICB9CiAgICByZXR1cm4gY29sb3JzOwogIH0KCiAgLy8gRm9yIHJhbmRvbSBudW1iZXJzLCB1c2UgInggPSAxODEgKiB4ICsgMzU5IiBmcm9tCiAgLy8gVG9tIERpY2tlbnMgIlJhbmRvbSBOdW1iZXIgR2VuZXJhdG9yIGZvciBNaWNyb2NvbnRyb2xsZXJzIgogIC8vIGh0dHBzOi8vd2ViLmFyY2hpdmUub3JnL3dlYi8yMDE3MDMyMzIwNDkxNy9odHRwOi8vaG9tZS5lYXJ0aGxpbmsubmV0L350ZGlja2Vucy82OGhjMTEvcmFuZG9tLzY4aGMxMXJhbmRvbS5odG1sCiAgbGV0IHNjcmF0Y2ggPSAwOwoKICBmdW5jdGlvbiBSYW5kb21CeXRlKCkgewogICAgY29uc3QgdmFsdWUgPSAxODEgKiBzY3JhdGNoICsgMzU5OwogICAgc2NyYXRjaCA9IHZhbHVlID4+PiAwOwogICAgcmV0dXJuICh2YWx1ZSA+Pj4gOCkgJiAweGZmOwogIH0KCiAgZnVuY3Rpb24gTW9kdWxvKG4sIG0pIHsKICAgIHJldHVybiAoKG4gJSBtKSArIG0pICUgbTsKICB9CgogIGxldCBlbGVtZW50LCByZWN0LCByYywgbW91c2VUcmFuc2Zvcm07CgogIGZ1bmN0aW9uIEJsYXplKHgsIHkpIHsKICAgIGZvcihsZXQgdHkgPSB5IC0gMTsgdHkgPCB5ICsgMTsgdHkrKykgewogICAgICBmb3IobGV0IHR4ID0geCAtIDE7IHR4IDwgeCArIDE7IHR4KyspIHsKICAgICAgICBwaXhlbHNbdHldW3R4XSA9IHJjOwogICAgICB9CiAgICB9CgogICAgcGl4ZWxzW3kgKyAxXVt4XSA9IHJjOwogIH0KCiAgZnVuY3Rpb24gTW91c2VIYW5kbGVyKGUpIHsKICAgIGxldCB7IHRhcmdldCwgYnV0dG9ucywgdHlwZSB9ID0gZTsKCiAgICBpZigndG91Y2hlcycgaW4gZSkgewogICAgICBmb3IobGV0IHRvdWNoIG9mIFsuLi5lLnRvdWNoZXNdKSB7CiAgICAgICAgY29uc3QgeyBjbGllbnRYLCBjbGllbnRZIH0gPSB0b3VjaDsKICAgICAgICBNb3VzZUhhbmRsZXIoewogICAgICAgICAgdHlwZSwKICAgICAgICAgIHRhcmdldCwKICAgICAgICAgIGJ1dHRvbnMsCiAgICAgICAgICBvZmZzZXRYOiBNYXRoLnRydW5jKGNsaWVudFgpIC0gcmVjdC54LAogICAgICAgICAgb2Zmc2V0WTogTWF0aC50cnVuYyhjbGllbnRZKSAtIHJlY3QueQogICAgICAgIH0pOwogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBnbG9iYWxUaGlzLnBvaW50ZXJFdmVudCA9IGU7CgogICAgY29uc3QgeCA9IE1hdGgucm91bmQoKGUub2Zmc2V0WCAqIHdpZHRoKSAvIHJlY3Qud2lkdGgpOwogICAgY29uc3QgeSA9IE1hdGgucm91bmQoKGUub2Zmc2V0WSAqIGhlaWdodCkgLyByZWN0LmhlaWdodCk7CgogICAgdHJ5IHsKICAgICAgaWYoLyhkb3dufHN0YXJ0KSQvLnRlc3QodHlwZSkpIHJjID0gcGl4ZWxzW3ldW3hdID4gMHgzMCA/IDAgOiBSYW5kb21CeXRlKCkgfCAweDgwOwoKICAgICAgQmxhemUoeCwgeSk7CiAgICB9IGNhdGNoKGUpIHt9CiAgfQoKICBmdW5jdGlvbiBSZXNpemVIYW5kbGVyKGUpIHsKICAgIHJlY3QgPSBjYW52YXNSZWN0OwogICAgbW91c2VUcmFuc2Zvcm0gPSBQb3NpdGlvblByb2Nlc3NvcigpOwogICAgY29uc29sZS5sb2coJ1Jlc2l6ZUhhbmRsZXInLCB7IGUsIHJlY3QgfSk7CiAgfQoKICBmdW5jdGlvbiBPcmllbnRhdGlvbkNoYW5nZShlKSB7CiAgICByZWN0ID0gY2FudmFzUmVjdDsKICAgIG1vdXNlVHJhbnNmb3JtID0gUG9zaXRpb25Qcm9jZXNzb3IoKTsKICAgIGNvbnNvbGUubG9nKCdPcmllbnRhdGlvbkNoYW5nZScsIHsgZSwgcmVjdCB9KTsKICB9CgogIE9iamVjdC5hc3NpZ24oZ2xvYmFsVGhpcywgeyBSYW5kb21CeXRlIH0pOwoKICBmdW5jdGlvbiBJbml0KCkgewogICAgd2luZG93LmNhbnZhcyA9IGVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdjYW52YXMnKTsKCiAgICBkZWZpbmUoCiAgICAgIGdsb2JhbFRoaXMsCiAgICAgIHByb3BlcnRpZXMoewogICAgICAgIGNhbnZhc0VsZW1lbnQ6ICgpID0+IEVsZW1lbnQuZmluZCgnY2FudmFzJyksCiAgICAgICAgZGl2RWxlbWVudDogKCkgPT4gRWxlbWVudC5maW5kKCdib2R5ID4gZGl2OmZpcnN0LWNoaWxkJykKICAgICAgfSksCiAgICAgIHByb3BlcnRpZXMoewogICAgICAgIHdpbmRvd1JlY3Q6ICgpID0+IG5ldyBSZWN0KHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpLAogICAgICAgIGJvZHlSZWN0OiAoKSA9PiBFbGVtZW50LnJlY3QoJ2JvZHknKS5yb3VuZCgwKSwKICAgICAgICBjYW52YXNSZWN0OiAoKSA9PiBFbGVtZW50LnJlY3QoJ2NhbnZhcycpLnJvdW5kKDApLAogICAgICAgIGRpdlJlY3Q6ICgpID0+IEVsZW1lbnQucmVjdCgnYm9keSA+IGRpdjpmaXJzdC1jaGlsZCcpLnJvdW5kKDApCiAgICAgIH0pLAogICAgICB7CiAgICAgICAgZ2V0UmVjdAogICAgICB9LAogICAgICBwcm9wZXJ0aWVzKHsKICAgICAgICB0cmFuc2Zvcm06IFsKICAgICAgICAgICgpID0+IG5ldyBUcmFuc2Zvcm1hdGlvbkxpc3QoRWxlbWVudC5nZXRDU1MoJ2JvZHkgPiBkaXY6Zmlyc3QtY2hpbGQnKS50cmFuc2Zvcm0pLAogICAgICAgICAgdmFsdWUgPT4gRWxlbWVudC5zZXRDU1MoJ2JvZHkgPiBkaXY6Zmlyc3QtY2hpbGQnLCB7IHRyYW5zZm9ybTogdmFsdWUgKyAnJyB9KQogICAgICAgIF0KICAgICAgfSkKICAgICk7CgogICAgY29uc3QgU1ZHQ29tcG9uZW50ID0gcHJvcHMgPT4gewogICAgICBjb25zdCByZWN0ID0gRWxlbWVudC5yZWN0KGRvY3VtZW50LmJvZHkpLnJvdW5kKDEpOwogICAgICBjb25zdCB7IGNlbnRlciwgd2lkdGgsIGhlaWdodCB9ID0gcmVjdDsKCiAgICAgIHJldHVybiBoKAogICAgICAgICdzdmcnLAogICAgICAgIHsgdmVyc2lvbjogJzEuMScsIHhtbG5zOiAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCB2aWV3Qm94OiBbLi4ucmVjdF0uam9pbignICcpLCB3aWR0aCwgaGVpZ2h0IH0sCiAgICAgICAgWwogICAgICAgICAgaCgnY2lyY2xlJywgewogICAgICAgICAgICBjeDogY2VudGVyLngsCiAgICAgICAgICAgIGN5OiBjZW50ZXIueSwKICAgICAgICAgICAgcjogMjUwLAogICAgICAgICAgICBzdHJva2U6ICcjMGYwJywKICAgICAgICAgICAgJ3N0cm9rZS13aWR0aCc6IDEsCiAgICAgICAgICAgIGZpbGw6IGByZ2JhKDgwLDgwLDgwLDAuMylgCiAgICAgICAgICB9KQogICAgICAgIF0KICAgICAgKTsKICAgIH07CgogICAgbGV0IHN2Z0NvbnRhaW5lciA9IEVsZW1lbnQuY3JlYXRlKCdkaXYnLCB7fSwgZG9jdW1lbnQuYm9keSk7CiAgICBFbGVtZW50LnNldENTUyhzdmdDb250YWluZXIsIHsgcG9zaXRpb246ICdhYnNvbHV0ZScsIHRvcDogMCwgbGVmdDogMCwgekluZGV4OiA5OTk5OTk5OSwgcG9pbnRlckV2ZW50czogJ25vbmUnIH0pOwoKICAgIC8qcmVuZGVyKGgoU1ZHQ29tcG9uZW50KSwgc3ZnQ29udGFpbmVyKTsqLwoKICAgIHJlY3QgPSBjYW52YXNSZWN0OwogICAgbW91c2VUcmFuc2Zvcm0gPSBQb3NpdGlvblByb2Nlc3NvcigpOwoKICAgIChhc3luYyBmdW5jdGlvbigpIHsKICAgICAgZm9yIGF3YWl0KGxldCBldmVudCBvZiBzdHJlYW1pZnkoWydvcmllbnRhdGlvbmNoYW5nZScsICdyZXNpemUnXSwgZG9jdW1lbnQpKSB7CiAgICAgICAgY29uc29sZS5sb2coZXZlbnQudHlwZSwgZXZlbnQpOwogICAgICAgIGdsb2JhbFRoaXNbZXZlbnQudHlwZV0gPSBldmVudDsKICAgICAgfQogICAgfSkoKTsKCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgUmVzaXplSGFuZGxlciwgdHJ1ZSk7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignb3JpZW50YXRpb25jaGFuZ2UnLCBPcmllbnRhdGlvbkNoYW5nZSwgdHJ1ZSk7CgogICAgLyogICBjb25zdCBoYW5kbGVyID0gTW91c2VIYW5kbGVyOwoKICAgIHN1YnNjcmliZShNb3ZlbWVudEl0ZXJhdG9yKGVsZW1lbnQpLCBoYW5kbGVyKTsqLwogIH0KCiAgZ2xvYmFsVGhpcy53cyA9IChnbG9iYWxUaGlzLnJ3cyA/Pz0gTmV3V1MoKSkud3M7CgogIChhc3luYyBmdW5jdGlvbigpIHsKICAgIGxldCB0cmFpbCA9IFtdLAogICAgICBzdGFydCwKICAgICAgbGFzdDsKICAgIGZvcig7OykgewogICAgICBsZXQgcHJldiwgcHQ7CgogICAgICBmb3IgYXdhaXQobGV0IGV2IG9mIE1vdmVtZW50SXRlcmF0b3Iod2luZG93KSkgewogICAgICAgIGlmKCFnbG9iYWxUaGlzLmNpZCkgewogICAgICAgICAgZ2xvYmFsVGhpcy5jaWQgPz89IE1ha2VDbGllbnRJRCgpOwoKICAgICAgICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoeyB0eXBlOiAnaGVsbG8nLCBjaWQgfSkpOwogICAgICAgIH0KCiAgICAgICAgaWYocmVjdC5pbnNpZGUoZXYpKSB7CiAgICAgICAgICBsZXQgcHQgPSAoZ2xvYmFsVGhpcy5tb3VzZVBvcyA9IG1vdXNlVHJhbnNmb3JtKGV2KSk7CiAgICAgICAgICBsZXQgZGlmZiA9IHB0LAogICAgICAgICAgICB0OwogICAgICAgICAgaWYocHJldikgZGlmZiA9IHB0LmRpZmYocHJldik7CgogICAgICAgICAgc3RhcnQgPz89IHQgPSBEYXRlLm5vdygpOwoKICAgICAgICAgIC8vdHJhaWwucHVzaCh7IC4uLnB0LCB0aW1lOiBEYXRlLm5vdygpICAtc3RhcnQgIH0pOwogICAgICAgICAgdHJhaWwucHVzaCgKICAgICAgICAgICAgdCAtIHN0YXJ0ICsgJy8nICsgKHByZXYgJiYgZGlmZi54ID4gMCA/ICcrJyA6ICcnKSArIGRpZmYueCArICcsJyArIChwcmV2ICYmIGRpZmYueSA+IDAgPyAnKycgOiAnJykgKyBkaWZmLnkKICAgICAgICAgICk7CgogICAgICAgICAgbGFzdCA9IHQ7CiAgICAgICAgICB0cnkgewogICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdibGF6ZScsIC4uLnB0KTsKICAgICAgICAgICAgcmMgPSBwaXhlbHNbcHQueV1bcHQueF0gPiAweDMwID8gMCA6IFJhbmRvbUJ5dGUoKSB8IDB4ODA7CgogICAgICAgICAgICBCbGF6ZShwdC54LCBwdC55KTsKICAgICAgICAgIH0gY2F0Y2goZSkge30KICAgICAgICAgIHByZXYgPSBwdDsKICAgICAgICB9CiAgICAgIH0KClNlbmRUcmFpbCgpOwoKICAgIGZ1bmN0aW9uIFNlbmRUcmFpbCgpIHsKICAgICAgICAgICAgICAgIAogIGlmKHRyYWlsLmxlbmd0aCkgewogICAgY29uc3QgcGF5bG9hZD17IHR5cGU6ICdibGF6ZScsIHN0YXJ0LCB0cmFpbDogdHJhaWwuam9pbignICcpIH07CiAgICBjb25zb2xlLmxvZygnU2VuZFRyYWlsJyxwYXlsb2FkKTsKICAgICAgICB3cy5zZW5kKEpTT04uc3RyaW5naWZ5KHBheWxvYWQpKTsKfQogICAgICB0cmFpbC5zcGxpY2UoMCwgdHJhaWwubGVuZ3RoKTsKICAgICAgc3RhcnQgPSB1bmRlZmluZWQ7CiAgICAgIHByZXYgPSB1bmRlZmluZWQ7CiAgICB9CiAgICB9CgogIH0pKCk7CgogIExvb3AoKTsKfQoKZGVmaW5lKGdsb2JhbFRoaXMsIHsgY3Jvc3NraXQsIFJHQkEsIEhTTEEsIFV0aWwsIE1hdHJpeCwgVHJhbnNmb3JtYXRpb25MaXN0IH0pOwpkZWZpbmUoZ2xvYmFsVGhpcywgeyBXZWJTb2NrZXRJdGVyYXRvciwgV2ViU29ja2V0VVJMLCBDcmVhdGVXZWJTb2NrZXQsIE5ld1dTLCBSZWNvbm5lY3RpbmdXZWJTb2NrZXQgfSk7CmRlZmluZShnbG9iYWxUaGlzLCB7IGRlZmluZSwgaXNVbmRlZmluZWQsIHByb3BlcnRpZXMsIGtleXMgfSk7CmRlZmluZShnbG9iYWxUaGlzLCB7IG9uY2UsIHN0cmVhbWlmeSwgdGhyb3R0bGUsIGRpc3RpbmN0LCBzdWJzY3JpYmUgfSk7CmRlZmluZShnbG9iYWxUaGlzLCB7IEludGVyc2VjdGlvbiwgTWF0cml4LCBpc1JlY3QsIFJlY3QsIFNpemUsIFBvaW50LCBMaW5lLCBUcmFuc2Zvcm1hdGlvbkxpc3QsIFZlY3RvciB9KTsKZGVmaW5lKGdsb2JhbFRoaXMsIHsKICB0aW1lciwKICBNYWtlVVVJRCwKICBNYWtlQ2xpZW50SUQsCiAgaXNTdHJlYW0sCiAgQWNxdWlyZVJlYWRlciwKICBBY3F1aXJlV3JpdGVyLAogIEFycmF5V3JpdGVyLAogIHJlYWRTdHJlYW0sCiAgUGlwZVRvLAogIFdyaXRhYmxlUmVwZWF0ZXIsCiAgV3JpdGVJdGVyYXRvciwKICBBc3luY1dyaXRlLAogIEFzeW5jUmVhZCwKICBSZWFkRnJvbUl0ZXJhdG9yLAogIFdyaXRlVG9SZXBlYXRlciwKICBMb2dTaW5rLAogIFN0cmluZ1JlYWRlciwKICBMaW5lUmVhZGVyLAogIERlYnVnVHJhbnNmb3JtU3RyZWFtLAogIENyZWF0ZVdyaXRhYmxlU3RyZWFtLAogIENyZWF0ZVRyYW5zZm9ybVN0cmVhbSwKICBSZXBlYXRlclNvdXJjZSwKICBSZXBlYXRlclNpbmssCiAgTGluZUJ1ZmZlclN0cmVhbSwKICBUZXh0VHJhbnNmb3JtU3RyZWFtLAogIENodW5rUmVhZGVyLAogIEJ5dGVSZWFkZXIsCiAgUGlwZVRvUmVwZWF0ZXIsCiAgUmVhZGVyLAogIFJlYWRBbGwsCiAgU3RyZWFtUmVhZEl0ZXJhdG9yCn0pOwoKZGVmaW5lKGdsb2JhbFRoaXMsIHsKICBFbGVtZW50LAogIGlzRWxlbWVudCwKICBTVkcsCiAgUmVhY3QsCiAgaCwKICBodG1sLAogIHJlbmRlciwKICBGcmFnbWVudCwKICBDb21wb25lbnQsCiAgY3JlYXRlUmVmLAogIHVzZVN0YXRlLAogIHVzZUxheW91dEVmZmVjdCwKICB1c2VSZWYsCiAgdG9DaGlsZEFycmF5Cn0pOwoKbWFpbigpOwoKZnVuY3Rpb24gZ2V0UmVjdChlbGVtKSB7CiAgcmV0dXJuIG5ldyBSZWN0KChlbGVtID8/IGRpdkVsZW1lbnQpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKS5yb3VuZCgxKTsKfQoAAAAAAAAAALw3AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAdjMAAAAAAAB2MwAAAAAAAAAAAAAAAPC/"
				],
				[
					1359,
					1,
					"insert",
					{
						"characters": " "
					},
					"AgAAALEvAAAAAAAAsi8AAAAAAAAAAAAAsi8AAAAAAACyLwAAAAAAAAMAAAAgLy8",
					"AQAAAAAAAAABAAAAtC8AAAAAAACxLwAAAAAAAAAAAAAAAPC/"
				],
				[
					1363,
					1,
					"insert",
					{
						"characters": "/"
					},
					"AQAAAO0vAAAAAAAA7i8AAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA7S8AAAAAAADtLwAAAAAAAAAAAAAAAPC/"
				],
				[
					1364,
					1,
					"left_delete",
					null,
					"AQAAAO0vAAAAAAAA7S8AAAAAAAABAAAALw",
					"AQAAAAAAAAABAAAA7i8AAAAAAADuLwAAAAAAAAAAAAAAAPC/"
				],
				[
					1365,
					2,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AgAAAO0vAAAAAAAA7y8AAAAAAAAAAAAA7i8AAAAAAADwLwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA7S8AAAAAAADtLwAAAAAAAAAAAAAAAPC/"
				],
				[
					1366,
					2,
					"run_macro_file",
					{
						"file": "res://Packages/Default/Delete Left Right.sublime-macro"
					},
					"BAAAAO4vAAAAAAAA7i8AAAAAAAABAAAAKO4vAAAAAAAA7i8AAAAAAAABAAAAKe0vAAAAAAAA7S8AAAAAAAABAAAAKO0vAAAAAAAA7S8AAAAAAAABAAAAKQ",
					"AQAAAAAAAAABAAAA7y8AAAAAAADvLwAAAAAAAAAAAAAAAPC/"
				],
				[
					1367,
					1,
					"left_delete",
					null,
					"AQAAAOwvAAAAAAAA7C8AAAAAAAABAAAAIA",
					"AQAAAAAAAAABAAAA7S8AAAAAAADtLwAAAAAAAAAAAAAAAPC/"
				],
				[
					1368,
					1,
					"insert",
					{
						"characters": "//"
					},
					"AgAAAOwvAAAAAAAA7S8AAAAAAAAAAAAA7S8AAAAAAADuLwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA7C8AAAAAAADsLwAAAAAAAAAAAAAAAPC/"
				],
				[
					1375,
					1,
					"toggle_comment",
					{
						"block": true
					},
					"AgAAAPIxAAAAAAAA9DEAAAAAAAAAAAAA4TEAAAAAAADjMQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA4TEAAAAAAADyMQAAAAAAAAAAAAAAAPC/"
				],
				[
					1404,
					1,
					"indent",
					null,
					"AQAAACcyAAAAAAAAKTIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAJzIAAAAAAABTMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1425,
					1,
					"insert",
					{
						"characters": "_"
					},
					"AQAAAOExAAAAAAAA4jEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA4TEAAAAAAADhMQAAAAAAAAAAAAAAAPC/"
				],
				[
					1426,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAOIxAAAAAAAA4zEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA4jEAAAAAAADiMQAAAAAAAAAAAAAAAPC/"
				],
				[
					1427,
					2,
					"left_delete",
					null,
					"AgAAAOIxAAAAAAAA4jEAAAAAAAABAAAAIOExAAAAAAAA4TEAAAAAAAABAAAAXw",
					"AQAAAAAAAAABAAAA4zEAAAAAAADjMQAAAAAAAAAAAAAAAPC/"
				],
				[
					1428,
					1,
					"insert",
					{
						"characters": ":"
					},
					"AQAAAOExAAAAAAAA4jEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA4TEAAAAAAADhMQAAAAAAAAAAAAAAAPC/"
				],
				[
					1429,
					1,
					"insert",
					{
						"characters": " [...trail]"
					},
					"CwAAAOIxAAAAAAAA4zEAAAAAAAAAAAAA4zEAAAAAAADkMQAAAAAAAAAAAADkMQAAAAAAAOUxAAAAAAAAAAAAAOUxAAAAAAAA5jEAAAAAAAAAAAAA5jEAAAAAAADnMQAAAAAAAAAAAADnMQAAAAAAAOgxAAAAAAAAAAAAAOgxAAAAAAAA6TEAAAAAAAAAAAAA6TEAAAAAAADqMQAAAAAAAAAAAADqMQAAAAAAAOsxAAAAAAAAAAAAAOsxAAAAAAAA7DEAAAAAAAAAAAAA7DEAAAAAAADtMQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA4jEAAAAAAADiMQAAAAAAAAAAAAAAAPC/"
				],
				[
					1431,
					1,
					"cut",
					null,
					"AQAAAO0xAAAAAAAA7TEAAAAAAAAVAAAALyo6IHRyYWlsLmpvaW4oJyAnKSov",
					"AQAAAAAAAAABAAAA7TEAAAAAAAACMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1440,
					1,
					"insert",
					{
						"characters": ".repoa"
					},
					"BgAAAEkyAAAAAAAASjIAAAAAAAAAAAAASjIAAAAAAABLMgAAAAAAAAAAAABLMgAAAAAAAEwyAAAAAAAAAAAAAEwyAAAAAAAATTIAAAAAAAAAAAAATTIAAAAAAABOMgAAAAAAAAAAAABOMgAAAAAAAE8yAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAASTIAAAAAAABJMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1441,
					2,
					"left_delete",
					null,
					"AgAAAE4yAAAAAAAATjIAAAAAAAABAAAAYU0yAAAAAAAATTIAAAAAAAABAAAAbw",
					"AQAAAAAAAAABAAAATzIAAAAAAABPMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1442,
					1,
					"insert",
					{
						"characters": "a"
					},
					"AQAAAE0yAAAAAAAATjIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAATTIAAAAAAABNMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1443,
					1,
					"left_delete",
					null,
					"AQAAAE0yAAAAAAAATTIAAAAAAAABAAAAYQ",
					"AQAAAAAAAAABAAAATjIAAAAAAABOMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1444,
					1,
					"insert",
					{
						"characters": "lace"
					},
					"BAAAAE0yAAAAAAAATjIAAAAAAAAAAAAATjIAAAAAAABPMgAAAAAAAAAAAABPMgAAAAAAAFAyAAAAAAAAAAAAAFAyAAAAAAAAUTIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAATTIAAAAAAABNMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1445,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAFEyAAAAAAAAUzIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAUTIAAAAAAABRMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1446,
					1,
					"insert",
					{
						"characters": "/"
					},
					"AQAAAFIyAAAAAAAAUzIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAUjIAAAAAAABSMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1447,
					1,
					"insert_snippet",
					{
						"contents": "\"$0\""
					},
					"AQAAAFMyAAAAAAAAVTIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAUzIAAAAAAABTMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1448,
					1,
					"insert",
					{
						"characters": "/g,"
					},
					"AwAAAFQyAAAAAAAAVTIAAAAAAAAAAAAAVTIAAAAAAABWMgAAAAAAAAAAAABWMgAAAAAAAFcyAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAVDIAAAAAAABUMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1449,
					1,
					"insert",
					{
						"characters": " '')"
					},
					"BAAAAFcyAAAAAAAAWDIAAAAAAAAAAAAAWDIAAAAAAABZMgAAAAAAAAAAAABZMgAAAAAAAFoyAAAAAAAAAAAAAFoyAAAAAAAAWzIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAVzIAAAAAAABXMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1450,
					2,
					"right_delete",
					null,
					"AgAAAFsyAAAAAAAAWzIAAAAAAAABAAAAIlsyAAAAAAAAWzIAAAAAAAABAAAAKQ",
					"AQAAAAAAAAABAAAAWzIAAAAAAABbMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1472,
					1,
					"insert",
					{
						"characters": "\""
					},
					"AQAAAFgyAAAAAAAAWTIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAWDIAAAAAAABYMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1474,
					1,
					"insert",
					{
						"characters": "\""
					},
					"AQAAAFoyAAAAAAAAWzIAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAWjIAAAAAAABaMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1475,
					1,
					"right_delete",
					null,
					"AQAAAFsyAAAAAAAAWzIAAAAAAAABAAAAJw",
					"AQAAAAAAAAABAAAAWzIAAAAAAABbMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1487,
					1,
					"left_delete",
					null,
					"AQAAAEkyAAAAAAAASTIAAAAAAAATAAAALnJlcGxhY2UoLyIvZywgIiciKQ",
					"AQAAAAAAAAABAAAASTIAAAAAAABcMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1490,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAAC4NwAAaW1wb3J0IHsgY3Jvc3NraXQsIENBTlZBUyB9IGZyb20gJy4vbGliL2Nyb3Nza2l0LmpzJzsKaW1wb3J0IHsgUkdCQSwgSFNMQSB9IGZyb20gJy4vbGliL2NvbG9yLmpzJzsKaW1wb3J0IHsgdGltZXIgfSBmcm9tICcuL2xpYi9hc3luYy9oZWxwZXJzLmpzJzsKaW1wb3J0IHsgV2ViU29ja2V0SXRlcmF0b3IsIFdlYlNvY2tldFVSTCwgQ3JlYXRlV2ViU29ja2V0LCBSZWNvbm5lY3RpbmdXZWJTb2NrZXQsIFN0cmVhbVJlYWRJdGVyYXRvciB9IGZyb20gJy4vbGliL2FzeW5jL3dlYnNvY2tldC5qcyc7CmltcG9ydCB7IG9uY2UsIHN0cmVhbWlmeSwgdGhyb3R0bGUsIGRpc3RpbmN0LCBzdWJzY3JpYmUgfSBmcm9tICcuL2xpYi9hc3luYy9ldmVudHMuanMnOwppbXBvcnQgeyBtZW1vaXplLCBkZWZpbmUsIGlzVW5kZWZpbmVkLCBwcm9wZXJ0aWVzLCBrZXlzLCB1bmlxdWUsIHJhbmRTdHIsIHJhbmRJbnQgfSBmcm9tICcuL2xpYi9taXNjLmpzJzsKaW1wb3J0IHsgaXNTdHJlYW0sIEFjcXVpcmVSZWFkZXIsIEFjcXVpcmVXcml0ZXIsIEFycmF5V3JpdGVyLCByZWFkU3RyZWFtLCBQaXBlVG8sIFdyaXRhYmxlUmVwZWF0ZXIsIFdyaXRlSXRlcmF0b3IsIEFzeW5jV3JpdGUsIEFzeW5jUmVhZCwgUmVhZEZyb21JdGVyYXRvciwgV3JpdGVUb1JlcGVhdGVyLCBMb2dTaW5rLCBTdHJpbmdSZWFkZXIsIExpbmVSZWFkZXIsIERlYnVnVHJhbnNmb3JtU3RyZWFtLCBDcmVhdGVXcml0YWJsZVN0cmVhbSwgQ3JlYXRlVHJhbnNmb3JtU3RyZWFtLCBSZXBlYXRlclNvdXJjZSwgUmVwZWF0ZXJTaW5rLCBMaW5lQnVmZmVyU3RyZWFtLCBUZXh0VHJhbnNmb3JtU3RyZWFtLCBDaHVua1JlYWRlciwgQnl0ZVJlYWRlciwgUGlwZVRvUmVwZWF0ZXIsIFJlYWRlciwgUmVhZEFsbCwgZGVmYXVsdCBhcyB1dGlscyB9IGZyb20gJy4vbGliL3N0cmVhbS91dGlscy5qcyc7CmltcG9ydCB7IEludGVyc2VjdGlvbiwgTWF0cml4LCBpc1JlY3QsIFJlY3QsIFNpemUsIFBvaW50LCBMaW5lLCBUcmFuc2Zvcm1hdGlvbkxpc3QsIFZlY3RvciB9IGZyb20gJy4vbGliL2dlb20uanMnOwppbXBvcnQgeyBFbGVtZW50LCBpc0VsZW1lbnQsIFNWRyB9IGZyb20gJy4vbGliL2RvbS5qcyc7CmltcG9ydCBSZWFjdCwgeyBoLCBodG1sLCByZW5kZXIsIEZyYWdtZW50LCBDb21wb25lbnQsIGNyZWF0ZVJlZiwgdXNlU3RhdGUsIHVzZUxheW91dEVmZmVjdCwgdXNlUmVmLCB0b0NoaWxkQXJyYXkgfSBmcm9tICcuL2xpYi9kb20vcHJlYWN0Q29tcG9uZW50LmpzJzsKCmZ1bmN0aW9uIE5ld1dTKCkgewogIGxldCB1cmwgPSBXZWJTb2NrZXRVUkwoJy93cycsIHsgbWlycm9yOiBjdXJyZW50RmlsZSB9KTsKICBsZXQgd3MgPSBuZXcgUmVjb25uZWN0aW5nV2ViU29ja2V0KHVybCwgJ2x3cy1taXJyb3ItcHJvdG9jb2wnKTsKICAoYXN5bmMgZnVuY3Rpb24oKSB7CiAgICBmb3IgYXdhaXQobGV0IGNodW5rIG9mIHdzKSB7CiAgICAgIGxldCBkYXRhID0gSlNPTi5wYXJzZShjaHVuayk7CgogICAgICBpZihkYXRhLmNpZCAhPSBnbG9iYWxUaGlzLmNpZCkgY29uc29sZS5sb2coJ1dTIHJlY2VpdmU6JywgZGF0YSk7CiAgICB9CiAgfSkoKTsKICByZXR1cm4gKGdsb2JhbFRoaXMud3MgPSB3cyk7Cn0KCmNvbnN0IE1ha2VVVUlEID0gKHJuZyA9IE1hdGgucmFuZG9tKSA9PiBbOCwgNCwgNCwgNCwgMTJdLm1hcChuID0+IHJhbmRTdHIobiwgJzAxMjM0NTY3ODlhYmNkZWYnKSwgcm5nKS5qb2luKCctJyk7CmNvbnN0IE1ha2VDbGllbnRJRCA9IChybmcgPSBNYXRoLnJhbmRvbSkgPT4gWzQsIDQsIDQsIDRdLm1hcChuID0+IHJhbmRTdHIobiwgWydBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWicsICdhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicsICcuLSQnXVtyYW5kSW50KDAsIDMpXSksIHJuZykuam9pbignJyk7CgpmdW5jdGlvbiBtYWluKCkgewogIGRlZmluZSgKICAgIGdsb2JhbFRoaXMsCiAgICBwcm9wZXJ0aWVzKAogICAgICB7CiAgICAgICAgY3VycmVudFVSTDogKCkgPT4gbmV3IFVSTChpbXBvcnQubWV0YS51cmwpLAogICAgICAgIGN1cnJlbnRGaWxlOiAoKSA9PiBnbG9iYWxUaGlzLmN1cnJlbnRVUkwucGF0aG5hbWUucmVwbGFjZSgvXlwvLywgJycpCiAgICAgIH0sCiAgICAgIHsgbWVtb2l6ZTogdHJ1ZSB9CiAgICApCiAgKTsKCiAgY29uc3Qgd2lkdGggPSAzMjA7CiAgY29uc3QgaGVpZ2h0ID0gMjAwOwogIGNvbnN0IHBhcmVudCA9IGRvY3VtZW50LmJvZHk7CgogIGNyb3Nza2l0LmluaXQoewogICAgcmVuZGVyZXI6IENBTlZBUywKICAgIHBhcmVudCwKICAgIHc6IHdpZHRoLAogICAgaDogaGVpZ2h0LAogICAgYWxwaGE6IGZhbHNlCiAgfSk7CgogIGZ1bmN0aW9uIFJlcGFyZW50KGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdjYW52YXMnKVswXSkgewogICAgY2FudmFzLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoY2FudmFzKTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKS5hcHBlbmRDaGlsZChjYW52YXMpOwogIH0KCiAgZnVuY3Rpb24gR2V0RWxlbWVudE1hdHJpeChlbGVtZW50KSB7CiAgICBsZXQgeyB0cmFuc2Zvcm0gfSA9IEVsZW1lbnQuZ2V0Q1NTKGRpdkVsZW1lbnQpOwoKICAgIHJldHVybiBNYXRyaXguZnJvbUNTUyh0cmFuc2Zvcm0pOwogIH0KCiAgZnVuY3Rpb24gU2V0Q3Jvc3NoYWlyKHBvcykgewogICAgbGV0IGNoID0gRWxlbWVudC5maW5kKCcjY3Jvc3NoYWlyJyk7CiAgICBsZXQgcmVjdCA9IEVsZW1lbnQuZ2V0UmVjdChjaCk7CgogICAgY29uc29sZS5sb2coJ1NldENyb3NzaGFpcicsIHsgY2gsIHJlY3QsIHBvcyB9KTsKICAgIHJlY3QueCA9IHBvcy54IC0gcmVjdC53aWR0aCAvIDI7CiAgICByZWN0LnkgPSBwb3MueSAtIHJlY3QuaGVpZ2h0IC8gMjsKCiAgICBFbGVtZW50LnNldFJlY3QoY2gsIHJlY3QpOwogIH0KCiAgZnVuY3Rpb24gRXZlbnRQb3NpdGlvbnMoZXZlbnRPclRvdWNoKSB7CiAgICBsZXQgcG9zaXRpb25zID0gdW5pcXVlKAogICAgICBrZXlzKGV2ZW50T3JUb3VjaCwgMikKICAgICAgICAuZmlsdGVyKG4gPT4gdHlwZW9mIG4gPT0gJ3N0cmluZycgJiYgL1tYWV0kLy50ZXN0KG4pKQogICAgICAgIC5tYXAobiA9PiBuLnNsaWNlKDAsIC0xKSkKICAgICk7CgogICAgcmV0dXJuIHBvc2l0aW9ucy5yZWR1Y2UoKGFjYywga2V5KSA9PiB7CiAgICAgIGFjY1trZXldID0gbmV3IFBvaW50KGV2ZW50T3JUb3VjaFtrZXkgKyAnWCddLCBldmVudE9yVG91Y2hba2V5ICsgJ1knXSk7CiAgICAgIHJldHVybiBhY2M7CiAgICB9LCB7fSk7CiAgfQoKICBmdW5jdGlvbiBQb3NpdGlvbk1hdHJpeChjYW52YXMgPSBjYW52YXNFbGVtZW50LCByZWN0ID0gY2FudmFzUmVjdCkgewogICAgbGV0IHZlcnRpY2FsID0gcmVjdC5hc3BlY3QoKSA8IDE7CiAgICBsZXQgdG9wTGVmdCA9IHJlY3QudG9Qb2ludHMoKVt2ZXJ0aWNhbCA/IDEgOiAwXTsKICAgIGxldCBtID0gTWF0cml4LmlkZW50aXR5KCkuc2NhbGUoY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTsKCiAgICBpZih2ZXJ0aWNhbCkgbSA9IG0ucm90YXRlKC1NYXRoLlBJIC8gMik7CgogICAgbSA9IG0uc2NhbGUoMSAvIHJlY3Qud2lkdGgsIDEgLyByZWN0LmhlaWdodCk7CiAgICBtID0gbS50cmFuc2xhdGUoLXRvcExlZnQueCwgLXRvcExlZnQueSk7CgogICAgcmV0dXJuIG07CiAgfQoKICBmdW5jdGlvbiBQb3NpdGlvblByb2Nlc3NvcihjYW52YXMgPSBjYW52YXNFbGVtZW50LCByZWN0ID0gY2FudmFzUmVjdCkgewogICAgbGV0IG0gPSBQb3NpdGlvbk1hdHJpeChjYW52YXMsIHJlY3QpOwogICAgcmV0dXJuIHBvcyA9PiBuZXcgUG9pbnQoLi4ubS50cmFuc2Zvcm1fcG9pbnQobmV3IFBvaW50KHBvcykpKS5yb3VuZCgxKTsKICB9CgogIGZ1bmN0aW9uIFByb2Nlc3NQb3NpdGlvbihwb3MpIHsKICAgIHJldHVybiBQb3NpdGlvblByb2Nlc3NvcigpKHBvcyk7CiAgfQoKICBhc3luYyBmdW5jdGlvbiogTW92ZW1lbnRJdGVyYXRvcihlbGVtZW50KSB7CiAgICBsZXQgZXYgPSBhd2FpdCBvbmNlKGVsZW1lbnQsICdtb3VzZWRvd24nLCAndG91Y2hzdGFydCcpOwogICAgbGV0IHR5cGUgPSBldi50eXBlLnNsaWNlKDAsIDUpOwogICAgeWllbGQgZXY7CiAgICBjb25zb2xlLmxvZyh0eXBlICsgJyBzdGFydCcpOwogICAgZm9yIGF3YWl0KGxldCBldmVudCBvZiBzdHJlYW1pZnkoWydtb3VzZXVwJywgJ21vdXNlbW92ZScsICd0b3VjaGVuZCcsICd0b3VjaG1vdmUnXSwgZWxlbWVudCkpIHsKICAgICAgLy9ldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICBpZigndG91Y2hlcycgaW4gZXZlbnQpIHsKICAgICAgICBpZihldmVudC50b3VjaGVzLmxlbmd0aCkgewogICAgICAgICAgZ2xvYmFsVGhpcy5tb3VzZUV2ZW50ID0gZXZlbnQ7CgogICAgICAgICAgeWllbGQqIFsuLi5ldmVudC50b3VjaGVzXS5tYXAoRXZlbnRQb3NpdGlvbnMpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zdCB7IHR5cGUsIGNsaWVudFg6IHgsIGNsaWVudFk6IHkgfSA9IGV2ZW50OwogICAgICAgIGxldCBvYmogPSB7IHR5cGUsIHgsIHkgfTsKICAgICAgICB5aWVsZCBvYmo7CiAgICAgIH0KICAgICAgaWYoLyh1cHxlbmQpJC8udGVzdChldmVudC50eXBlKSkgewogICAgICAgIGNvbnNvbGUubG9nKHR5cGUgKyAnIGVuZCcpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQoKICBSZXBhcmVudCgpOwoKICBjcm9zc2tpdC5jbGVhcigpOwogIGNyb3Nza2l0LnJlY3QoewogICAgeDogMCwKICAgIHk6IDAsCiAgICB3aWR0aCwKICAgIGhlaWdodCwKICAgIGZpbGw6ICdibGFjaycsCiAgICBzdHJva2U6ICdibGFjaycsCiAgICBhbmdsZTogMAogIH0pOwoKICBjb25zdCBidWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIod2lkdGggKiAoaGVpZ2h0ICsgMikpOwogIGNvbnN0IHBhbGV0dGUgPSBDcmVhdGVQYWxldHRlKCk7CiAgY29uc3QgcGFsZXR0ZUhTTCA9IENyZWF0ZVBhbGV0dGVIU0woKTsKCiAgY29uc3QgcGl4ZWxzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogaGVpZ2h0ICsgMiB9KS5tYXAoKHYsIGkpID0+IG5ldyBVaW50OENsYW1wZWRBcnJheShidWZmZXIsIGkgKiB3aWR0aCwgd2lkdGgpKTsKICBjb25zdCB7IGNvbnRleHQgfSA9IGNyb3Nza2l0OwogIGNvbnN0IGltYWdlID0gY29udGV4dC5jcmVhdGVJbWFnZURhdGEod2lkdGgsIGhlaWdodCk7CgogIGNvbnN0IHsgbm93LCB3YWl0Rm9yLCBhbmltYXRpb25GcmFtZSB9ID0gVXRpbDsKICBjb25zdCBmcHMgPSA1MDsKICBjb25zdCBtYXRyaXggPSBuZXcgTWF0cml4KCkudHJhbnNsYXRlKDE2MCwgMTAwKS5zY2FsZSgwLjUpOwoKICBPYmplY3QuYXNzaWduKGdsb2JhbFRoaXMsIHsKICAgIGJ1ZmZlciwKICAgIHBhbGV0dGUsCiAgICBwYWxldHRlSFNMLAogICAgcGl4ZWxzLAogICAgY29udGV4dCwKICAgIGltYWdlLAogICAgZnBzLAogICAgbWF0cml4LAogICAgUmVwYXJlbnQsCiAgICBkb206IHsgRWxlbWVudCB9LAogICAgZ2VvbTogeyBSZWN0IH0sCiAgICBNb3ZlbWVudEl0ZXJhdG9yLAogICAgTW91c2VIYW5kbGVyLAogICAgR2V0RWxlbWVudE1hdHJpeCwKICAgIFNldENyb3NzaGFpciwKICAgIEV2ZW50UG9zaXRpb25zLAogICAgUG9zaXRpb25Qcm9jZXNzb3IsCiAgICBQb3NpdGlvbk1hdHJpeCwKICAgIFByb2Nlc3NQb3NpdGlvbgogIH0pOwoKICBhc3luYyBmdW5jdGlvbiBMb29wKCkgewogICAgY29uc3QgZGVsYXkgPSAxMDAwIC8gZnBzOwogICAgY29uc3QgbG9nID0gKHQsIG5hbWUpID0+IGdsb2JhbFRoaXMuZG9Mb2cgJiYgY29uc29sZS5sb2coYCR7bmFtZX0gdGltaW5nOiAke3QudG9GaXhlZCgzKX1tc2ApOwogICAgY29uc3QgZmlyZSA9ICguLi5hcmdzKSA9PiBGaXJlKC4uLmFyZ3MpOwogICAgY29uc3QgcmVkcmF3ID0gKC4uLmFyZ3MpID0+IFJlZHJhdyguLi5hcmdzKTsKCiAgICBhd2FpdCBvbmNlKHdpbmRvdywgJ2xvYWQnKTsKCiAgICBJbml0KCk7CgogICAgZm9yKDs7KSB7CiAgICAgIGZpcmUoKTsKICAgICAgcmVkcmF3KCk7CiAgICAgIGF3YWl0IGFuaW1hdGlvbkZyYW1lKGRlbGF5KTsKICAgIH0KICB9CgogIGZ1bmN0aW9uIEZpcmUoKSB7CiAgICBmb3IobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewogICAgICBwaXhlbHNbaGVpZ2h0XVt4XSA9IDI1NSAtIChSYW5kb21CeXRlKCkgJSAxMjgpOwogICAgICBwaXhlbHNbaGVpZ2h0ICsgMV1beF0gPSAyNTUgLSAoUmFuZG9tQnl0ZSgpICUgMTI4KTsKICAgIH0KCiAgICBmb3IobGV0IHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKICAgICAgZm9yKGxldCB4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHsKICAgICAgICBjb25zdCBzdW0gPSBbcGl4ZWxzW3kgKyAxXVtNb2R1bG8oeCAtIDEsIHdpZHRoKV0sIHBpeGVsc1t5ICsgMV1beF0sIHBpeGVsc1t5ICsgMV1bTW9kdWxvKHggKyAxLCB3aWR0aCldLCBwaXhlbHNbeSArIDJdW3hdXS5yZWR1Y2UoKGEsIHApID0+IGEgKyAocCB8IDApLCAwKTsKCiAgICAgICAgcGl4ZWxzW3ldW3hdID0gKHN1bSAqIDE1KSA+Pj4gNjsKICAgICAgfQogICAgfQogIH0KCiAgYXN5bmMgZnVuY3Rpb24gUmVkcmF3KCkgewogICAgY29uc3QgeyBkYXRhIH0gPSBpbWFnZTsKCiAgICBsZXQgaSA9IDA7CiAgICBsZXQgdCA9IFsuLi5tYXRyaXhdOwoKICAgIGZvcihsZXQgeSA9IDA7IHkgPCBoZWlnaHQ7IHkrKykgewogICAgICBmb3IobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewogICAgICAgIGNvbnN0IGMgPSBwYWxldHRlW3BpeGVsc1t5XVt4XV07CiAgICAgICAgZGF0YVtpKytdID0gYy5yOwogICAgICAgIGRhdGFbaSsrXSA9IGMuZzsKICAgICAgICBkYXRhW2krK10gPSBjLmI7CiAgICAgICAgZGF0YVtpKytdID0gYy5hOwogICAgICB9CiAgICB9CgogICAgY29udGV4dC5wdXRJbWFnZURhdGEoaW1hZ2UsIDAsIDApOwogIH0KCiAgZnVuY3Rpb24gQ3JlYXRlUGFsZXR0ZSgpIHsKICAgIGNvbnN0IGNvbG9ycyA9IG5ldyBBcnJheSgyNTYpOwoKICAgIGZvcihsZXQgaSA9IDA7IGkgPCA2NDsgaSsrKSB7CiAgICAgIGNvbnN0IHZhbHVlID0gaSAqIDQ7CgogICAgICBjb2xvcnNbaV0gPSBuZXcgUkdCQSh2YWx1ZSwgMCwgMCk7CiAgICAgIGNvbG9yc1tpICsgNjRdID0gbmV3IFJHQkEoMjU1LCB2YWx1ZSwgMCk7CiAgICAgIGNvbG9yc1tpICsgMTI4XSA9IG5ldyBSR0JBKDI1NSwgMjU1LCB2YWx1ZSk7CiAgICAgIGNvbG9yc1tpICsgMTkyXSA9IG5ldyBSR0JBKDI1NSwgMjU1LCAyNTUpOwogICAgfQogICAgcmV0dXJuIGNvbG9yczsKICB9CgogIGZ1bmN0aW9uIENyZWF0ZVBhbGV0dGVIU0woKSB7CiAgICBjb25zdCBjb2xvcnMgPSBuZXcgQXJyYXkoMjU2KTsKCiAgICBjb25zdCBodWVzID0gW25ldyBIU0xBKDAsIDEwMCwgMCksIG5ldyBIU0xBKDAsIDEwMCwgNTApLCBuZXcgSFNMQSgzMCwgMTAwLCA1MCksIG5ldyBIU0xBKDYwLCAxMDAsIDUwKSwgbmV3IEhTTEEoNjAsIDEwMCwgMTAwKSwgbmV3IEhTTEEoNjAsIDEwMCwgMTAwKV07CgogICAgY29uc3QgYnJlYWtwb2ludHMgPSBbMCwgNTEsIDgwLCAxNTQsIDIwNSwgMjU2XTsKICAgIGNvbnNvbGUubG9nKCdicmVha3BvaW50czonLCBicmVha3BvaW50cyk7CgogICAgZm9yKGxldCBpID0gMDsgaSA8IDI1NjsgaSsrKSB7CiAgICAgIGNvbnN0IGh1ZSA9ICh2ID0+ICh2ID09IC0xID8gKCkgPT4gaHVlcy5sZW5ndGggLSAyIDogdiA9PiB2KSkoYnJlYWtwb2ludHMuZmluZEluZGV4KGIgPT4gaSA8IGIpKTsKICAgICAgY29uc3QgcmFuZ2UgPSBicmVha3BvaW50c1todWVdIC0gMSAtIGJyZWFrcG9pbnRzW2h1ZSAtIDFdOwoKICAgICAgY29sb3JzW2ldID0gSFNMQS5ibGVuZChodWVzW2h1ZSAtIDFdLCBodWVzW2h1ZV0sIChpIC0gYnJlYWtwb2ludHNbaHVlIC0gMV0pIC8gcmFuZ2UpLnRvUkdCQSgpOwogICAgfQogICAgcmV0dXJuIGNvbG9yczsKICB9CgogIC8vIEZvciByYW5kb20gbnVtYmVycywgdXNlICJ4ID0gMTgxICogeCArIDM1OSIgZnJvbQogIC8vIFRvbSBEaWNrZW5zICJSYW5kb20gTnVtYmVyIEdlbmVyYXRvciBmb3IgTWljcm9jb250cm9sbGVycyIKICAvLyBodHRwczovL3dlYi5hcmNoaXZlLm9yZy93ZWIvMjAxNzAzMjMyMDQ5MTcvaHR0cDovL2hvbWUuZWFydGhsaW5rLm5ldC9+dGRpY2tlbnMvNjhoYzExL3JhbmRvbS82OGhjMTFyYW5kb20uaHRtbAogIGxldCBzY3JhdGNoID0gMDsKCiAgZnVuY3Rpb24gUmFuZG9tQnl0ZSgpIHsKICAgIGNvbnN0IHZhbHVlID0gMTgxICogc2NyYXRjaCArIDM1OTsKICAgIHNjcmF0Y2ggPSB2YWx1ZSA+Pj4gMDsKICAgIHJldHVybiAodmFsdWUgPj4+IDgpICYgMHhmZjsKICB9CgogIGZ1bmN0aW9uIE1vZHVsbyhuLCBtKSB7CiAgICByZXR1cm4gKChuICUgbSkgKyBtKSAlIG07CiAgfQoKICBsZXQgZWxlbWVudCwgcmVjdCwgcmMsIG1vdXNlVHJhbnNmb3JtOwoKICBmdW5jdGlvbiBCbGF6ZSh4LCB5KSB7CiAgICBmb3IobGV0IHR5ID0geSAtIDE7IHR5IDwgeSArIDE7IHR5KyspIHsKICAgICAgZm9yKGxldCB0eCA9IHggLSAxOyB0eCA8IHggKyAxOyB0eCsrKSB7CiAgICAgICAgcGl4ZWxzW3R5XVt0eF0gPSByYzsKICAgICAgfQogICAgfQoKICAgIHBpeGVsc1t5ICsgMV1beF0gPSByYzsKICB9CgogIGZ1bmN0aW9uIE1vdXNlSGFuZGxlcihlKSB7CiAgICBsZXQgeyB0YXJnZXQsIGJ1dHRvbnMsIHR5cGUgfSA9IGU7CgogICAgaWYoJ3RvdWNoZXMnIGluIGUpIHsKICAgICAgZm9yKGxldCB0b3VjaCBvZiBbLi4uZS50b3VjaGVzXSkgewogICAgICAgIGNvbnN0IHsgY2xpZW50WCwgY2xpZW50WSB9ID0gdG91Y2g7CiAgICAgICAgTW91c2VIYW5kbGVyKHsKICAgICAgICAgIHR5cGUsCiAgICAgICAgICB0YXJnZXQsCiAgICAgICAgICBidXR0b25zLAogICAgICAgICAgb2Zmc2V0WDogTWF0aC50cnVuYyhjbGllbnRYKSAtIHJlY3QueCwKICAgICAgICAgIG9mZnNldFk6IE1hdGgudHJ1bmMoY2xpZW50WSkgLSByZWN0LnkKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9CgogICAgZ2xvYmFsVGhpcy5wb2ludGVyRXZlbnQgPSBlOwoKICAgIGNvbnN0IHggPSBNYXRoLnJvdW5kKChlLm9mZnNldFggKiB3aWR0aCkgLyByZWN0LndpZHRoKTsKICAgIGNvbnN0IHkgPSBNYXRoLnJvdW5kKChlLm9mZnNldFkgKiBoZWlnaHQpIC8gcmVjdC5oZWlnaHQpOwoKICAgIHRyeSB7CiAgICAgIGlmKC8oZG93bnxzdGFydCkkLy50ZXN0KHR5cGUpKSByYyA9IHBpeGVsc1t5XVt4XSA+IDB4MzAgPyAwIDogUmFuZG9tQnl0ZSgpIHwgMHg4MDsKCiAgICAgIEJsYXplKHgsIHkpOwogICAgfSBjYXRjaChlKSB7fQogIH0KCiAgZnVuY3Rpb24gUmVzaXplSGFuZGxlcihlKSB7CiAgICByZWN0ID0gY2FudmFzUmVjdDsKICAgIG1vdXNlVHJhbnNmb3JtID0gUG9zaXRpb25Qcm9jZXNzb3IoKTsKICAgIGNvbnNvbGUubG9nKCdSZXNpemVIYW5kbGVyJywgeyBlLCByZWN0IH0pOwogIH0KCiAgZnVuY3Rpb24gT3JpZW50YXRpb25DaGFuZ2UoZSkgewogICAgcmVjdCA9IGNhbnZhc1JlY3Q7CiAgICBtb3VzZVRyYW5zZm9ybSA9IFBvc2l0aW9uUHJvY2Vzc29yKCk7CiAgICBjb25zb2xlLmxvZygnT3JpZW50YXRpb25DaGFuZ2UnLCB7IGUsIHJlY3QgfSk7CiAgfQoKICBPYmplY3QuYXNzaWduKGdsb2JhbFRoaXMsIHsgUmFuZG9tQnl0ZSB9KTsKCiAgZnVuY3Rpb24gSW5pdCgpIHsKICAgIHdpbmRvdy5jYW52YXMgPSBlbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignY2FudmFzJyk7CgogICAgZGVmaW5lKAogICAgICBnbG9iYWxUaGlzLAogICAgICBwcm9wZXJ0aWVzKHsKICAgICAgICBjYW52YXNFbGVtZW50OiAoKSA9PiBFbGVtZW50LmZpbmQoJ2NhbnZhcycpLAogICAgICAgIGRpdkVsZW1lbnQ6ICgpID0+IEVsZW1lbnQuZmluZCgnYm9keSA+IGRpdjpmaXJzdC1jaGlsZCcpCiAgICAgIH0pLAogICAgICBwcm9wZXJ0aWVzKHsKICAgICAgICB3aW5kb3dSZWN0OiAoKSA9PiBuZXcgUmVjdCh3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KSwKICAgICAgICBib2R5UmVjdDogKCkgPT4gRWxlbWVudC5yZWN0KCdib2R5Jykucm91bmQoMCksCiAgICAgICAgY2FudmFzUmVjdDogKCkgPT4gRWxlbWVudC5yZWN0KCdjYW52YXMnKS5yb3VuZCgwKSwKICAgICAgICBkaXZSZWN0OiAoKSA9PiBFbGVtZW50LnJlY3QoJ2JvZHkgPiBkaXY6Zmlyc3QtY2hpbGQnKS5yb3VuZCgwKQogICAgICB9KSwKICAgICAgewogICAgICAgIGdldFJlY3QKICAgICAgfSwKICAgICAgcHJvcGVydGllcyh7CiAgICAgICAgdHJhbnNmb3JtOiBbKCkgPT4gbmV3IFRyYW5zZm9ybWF0aW9uTGlzdChFbGVtZW50LmdldENTUygnYm9keSA+IGRpdjpmaXJzdC1jaGlsZCcpLnRyYW5zZm9ybSksIHZhbHVlID0+IEVsZW1lbnQuc2V0Q1NTKCdib2R5ID4gZGl2OmZpcnN0LWNoaWxkJywgeyB0cmFuc2Zvcm06IHZhbHVlICsgJycgfSldCiAgICAgIH0pCiAgICApOwoKICAgIGNvbnN0IFNWR0NvbXBvbmVudCA9IHByb3BzID0+IHsKICAgICAgY29uc3QgcmVjdCA9IEVsZW1lbnQucmVjdChkb2N1bWVudC5ib2R5KS5yb3VuZCgxKTsKICAgICAgY29uc3QgeyBjZW50ZXIsIHdpZHRoLCBoZWlnaHQgfSA9IHJlY3Q7CgogICAgICByZXR1cm4gaCgnc3ZnJywgeyB2ZXJzaW9uOiAnMS4xJywgeG1sbnM6ICdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsIHZpZXdCb3g6IFsuLi5yZWN0XS5qb2luKCcgJyksIHdpZHRoLCBoZWlnaHQgfSwgWwogICAgICAgIGgoJ2NpcmNsZScsIHsKICAgICAgICAgIGN4OiBjZW50ZXIueCwKICAgICAgICAgIGN5OiBjZW50ZXIueSwKICAgICAgICAgIHI6IDI1MCwKICAgICAgICAgIHN0cm9rZTogJyMwZjAnLAogICAgICAgICAgJ3N0cm9rZS13aWR0aCc6IDEsCiAgICAgICAgICBmaWxsOiBgcmdiYSg4MCw4MCw4MCwwLjMpYAogICAgICAgIH0pCiAgICAgIF0pOwogICAgfTsKCiAgICBsZXQgc3ZnQ29udGFpbmVyID0gRWxlbWVudC5jcmVhdGUoJ2RpdicsIHt9LCBkb2N1bWVudC5ib2R5KTsKICAgIEVsZW1lbnQuc2V0Q1NTKHN2Z0NvbnRhaW5lciwgeyBwb3NpdGlvbjogJ2Fic29sdXRlJywgdG9wOiAwLCBsZWZ0OiAwLCB6SW5kZXg6IDk5OTk5OTk5LCBwb2ludGVyRXZlbnRzOiAnbm9uZScgfSk7CgogICAgLypyZW5kZXIoaChTVkdDb21wb25lbnQpLCBzdmdDb250YWluZXIpOyovCgogICAgcmVjdCA9IGNhbnZhc1JlY3Q7CiAgICBtb3VzZVRyYW5zZm9ybSA9IFBvc2l0aW9uUHJvY2Vzc29yKCk7CgogICAgKGFzeW5jIGZ1bmN0aW9uKCkgewogICAgICBmb3IgYXdhaXQobGV0IGV2ZW50IG9mIHN0cmVhbWlmeShbJ29yaWVudGF0aW9uY2hhbmdlJywgJ3Jlc2l6ZSddLCBkb2N1bWVudCkpIHsKICAgICAgICBjb25zb2xlLmxvZyhldmVudC50eXBlLCBldmVudCk7CiAgICAgICAgZ2xvYmFsVGhpc1tldmVudC50eXBlXSA9IGV2ZW50OwogICAgICB9CiAgICB9KSgpOwoKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBSZXNpemVIYW5kbGVyLCB0cnVlKTsKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvcmllbnRhdGlvbmNoYW5nZScsIE9yaWVudGF0aW9uQ2hhbmdlLCB0cnVlKTsKCiAgICAvKiAgIGNvbnN0IGhhbmRsZXIgPSBNb3VzZUhhbmRsZXI7CgogICAgc3Vic2NyaWJlKE1vdmVtZW50SXRlcmF0b3IoZWxlbWVudCksIGhhbmRsZXIpOyovCiAgfQoKICBnbG9iYWxUaGlzLndzID0gKGdsb2JhbFRoaXMucndzID8/PSBOZXdXUygpKS53czsKCiAgKGFzeW5jIGZ1bmN0aW9uKCkgewogICAgbGV0IHRyYWlsID0gW10sCiAgICAgIHN0YXJ0LAogICAgICBsYXN0OwogICAgZm9yKDs7KSB7CiAgICAgIGxldCBwcmV2LCBwdDsKCiAgICAgIGZvciBhd2FpdChsZXQgZXYgb2YgTW92ZW1lbnRJdGVyYXRvcih3aW5kb3cpKSB7CiAgICAgICAgaWYoIWdsb2JhbFRoaXMuY2lkKSB7CiAgICAgICAgICBnbG9iYWxUaGlzLmNpZCA/Pz0gTWFrZUNsaWVudElEKCk7CgogICAgICAgICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeSh7IHR5cGU6ICdoZWxsbycsIGNpZCB9KSk7CiAgICAgICAgfQoKICAgICAgICBpZihyZWN0Lmluc2lkZShldikpIHsKICAgICAgICAgIGxldCBwdCA9IChnbG9iYWxUaGlzLm1vdXNlUG9zID0gbW91c2VUcmFuc2Zvcm0oZXYpKTsKICAgICAgICAgIGxldCBkaWZmID0gcHQsCiAgICAgICAgICAgIHQ7CiAgICAgICAgICBpZihwcmV2KSBkaWZmID0gcHQuZGlmZihwcmV2KTsKCiAgICAgICAgICBzdGFydCA/Pz0gdCA9IERhdGUubm93KCk7CgogICAgICAgICAgdHJhaWwucHVzaCh7IC4uLnB0LCB0aW1lOiBEYXRlLm5vdygpICAtc3RhcnQgIH0pOwogICAgICAgIC8vIHRyYWlsLnB1c2godCAtIHN0YXJ0ICsgJy8nICsgKHByZXYgJiYgZGlmZi54ID4gMCA/ICcrJyA6ICcnKSArIGRpZmYueCArICcsJyArIChwcmV2ICYmIGRpZmYueSA+IDAgPyAnKycgOiAnJykgKyBkaWZmLnkpOwoKICAgICAgICAgIGxhc3QgPSB0OwogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnYmxhemUnLCAuLi5wdCk7CiAgICAgICAgICAgIHJjID0gcGl4ZWxzW3B0LnldW3B0LnhdID4gMHgzMCA/IDAgOiBSYW5kb21CeXRlKCkgfCAweDgwOwoKICAgICAgICAgICAgQmxhemUocHQueCwgcHQueSk7CiAgICAgICAgICB9IGNhdGNoKGUpIHt9CiAgICAgICAgICBwcmV2ID0gcHQ7CiAgICAgICAgfQogICAgICB9CgogICAgICBTZW5kVHJhaWwoKTsKCiAgICAgIGZ1bmN0aW9uIFNlbmRUcmFpbCgpIHsKICAgICAgICBpZih0cmFpbC5sZW5ndGgpIHsKICAgICAgICAgIGNvbnN0IHBheWxvYWQgPSB7IHR5cGU6ICdibGF6ZScsIHN0YXJ0LCB0cmFpbDogWy4uLnRyYWlsXSB9OwogICAgICAgICAgY29uc29sZS5sb2coJ1NlbmRUcmFpbCcsIHBheWxvYWQpOwogICAgICAgICAgICB3cy5zZW5kKEpTT04uc3RyaW5naWZ5KHBheWxvYWQpKTsKICAgICAgICB9CiAgICAgICAgdHJhaWwuc3BsaWNlKDAsIHRyYWlsLmxlbmd0aCk7CiAgICAgICAgc3RhcnQgPSB1bmRlZmluZWQ7CiAgICAgICAgcHJldiA9IHVuZGVmaW5lZDsKICAgICAgfQogICAgfQogIH0pKCk7CgogIExvb3AoKTsKfQoKZGVmaW5lKGdsb2JhbFRoaXMsIHsgY3Jvc3NraXQsIFJHQkEsIEhTTEEsIFV0aWwsIE1hdHJpeCwgVHJhbnNmb3JtYXRpb25MaXN0IH0pOwpkZWZpbmUoZ2xvYmFsVGhpcywgeyBXZWJTb2NrZXRJdGVyYXRvciwgV2ViU29ja2V0VVJMLCBDcmVhdGVXZWJTb2NrZXQsIE5ld1dTLCBSZWNvbm5lY3RpbmdXZWJTb2NrZXQgfSk7CmRlZmluZShnbG9iYWxUaGlzLCB7IGRlZmluZSwgaXNVbmRlZmluZWQsIHByb3BlcnRpZXMsIGtleXMgfSk7CmRlZmluZShnbG9iYWxUaGlzLCB7IG9uY2UsIHN0cmVhbWlmeSwgdGhyb3R0bGUsIGRpc3RpbmN0LCBzdWJzY3JpYmUgfSk7CmRlZmluZShnbG9iYWxUaGlzLCB7IEludGVyc2VjdGlvbiwgTWF0cml4LCBpc1JlY3QsIFJlY3QsIFNpemUsIFBvaW50LCBMaW5lLCBUcmFuc2Zvcm1hdGlvbkxpc3QsIFZlY3RvciB9KTsKZGVmaW5lKGdsb2JhbFRoaXMsIHsKICB0aW1lciwKICBNYWtlVVVJRCwKICBNYWtlQ2xpZW50SUQsCiAgaXNTdHJlYW0sCiAgQWNxdWlyZVJlYWRlciwKICBBY3F1aXJlV3JpdGVyLAogIEFycmF5V3JpdGVyLAogIHJlYWRTdHJlYW0sCiAgUGlwZVRvLAogIFdyaXRhYmxlUmVwZWF0ZXIsCiAgV3JpdGVJdGVyYXRvciwKICBBc3luY1dyaXRlLAogIEFzeW5jUmVhZCwKICBSZWFkRnJvbUl0ZXJhdG9yLAogIFdyaXRlVG9SZXBlYXRlciwKICBMb2dTaW5rLAogIFN0cmluZ1JlYWRlciwKICBMaW5lUmVhZGVyLAogIERlYnVnVHJhbnNmb3JtU3RyZWFtLAogIENyZWF0ZVdyaXRhYmxlU3RyZWFtLAogIENyZWF0ZVRyYW5zZm9ybVN0cmVhbSwKICBSZXBlYXRlclNvdXJjZSwKICBSZXBlYXRlclNpbmssCiAgTGluZUJ1ZmZlclN0cmVhbSwKICBUZXh0VHJhbnNmb3JtU3RyZWFtLAogIENodW5rUmVhZGVyLAogIEJ5dGVSZWFkZXIsCiAgUGlwZVRvUmVwZWF0ZXIsCiAgUmVhZGVyLAogIFJlYWRBbGwsCiAgU3RyZWFtUmVhZEl0ZXJhdG9yCn0pOwoKZGVmaW5lKGdsb2JhbFRoaXMsIHsKICBFbGVtZW50LAogIGlzRWxlbWVudCwKICBTVkcsCiAgUmVhY3QsCiAgaCwKICBodG1sLAogIHJlbmRlciwKICBGcmFnbWVudCwKICBDb21wb25lbnQsCiAgY3JlYXRlUmVmLAogIHVzZVN0YXRlLAogIHVzZUxheW91dEVmZmVjdCwKICB1c2VSZWYsCiAgdG9DaGlsZEFycmF5Cn0pOwoKbWFpbigpOwoKZnVuY3Rpb24gZ2V0UmVjdChlbGVtKSB7CiAgcmV0dXJuIG5ldyBSZWN0KChlbGVtID8/IGRpdkVsZW1lbnQpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKS5yb3VuZCgxKTsKfQoAAAAAAAAAAG84AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAASTIAAAAAAABJMgAAAAAAAAAAAAAAAPC/"
				],
				[
					1506,
					1,
					"insert",
					{
						"characters": "fuin"
					},
					"BQAAALgGAAAAAAAAuQYAAAAAAAAAAAAAuQYAAAAAAAC5BgAAAAAAAAUAAABjb25zdLkGAAAAAAAAugYAAAAAAAAAAAAAugYAAAAAAAC7BgAAAAAAAAAAAAC7BgAAAAAAALwGAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAvQYAAAAAAAC4BgAAAAAAAAAAAAAAAAAA"
				],
				[
					1507,
					2,
					"left_delete",
					null,
					"AgAAALsGAAAAAAAAuwYAAAAAAAABAAAAbroGAAAAAAAAugYAAAAAAAABAAAAaQ",
					"AQAAAAAAAAABAAAAvAYAAAAAAAC8BgAAAAAAAAAAAAAAAPC/"
				],
				[
					1508,
					1,
					"insert",
					{
						"characters": "nction"
					},
					"BgAAALoGAAAAAAAAuwYAAAAAAAAAAAAAuwYAAAAAAAC8BgAAAAAAAAAAAAC8BgAAAAAAAL0GAAAAAAAAAAAAAL0GAAAAAAAAvgYAAAAAAAAAAAAAvgYAAAAAAAC/BgAAAAAAAAAAAAC/BgAAAAAAAMAGAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAugYAAAAAAAC6BgAAAAAAAAAAAAAAAPC/"
				],
				[
					1510,
					1,
					"right_delete",
					null,
					"AQAAAM4GAAAAAAAAzgYAAAAAAAABAAAAPQ",
					"AQAAAAAAAAABAAAAzgYAAAAAAADOBgAAAAAAAAAAAAAAAPC/"
				],
				[
					1512,
					2,
					"left_delete",
					null,
					"AgAAAOQGAAAAAAAA5AYAAAAAAAABAAAAPuMGAAAAAAAA4wYAAAAAAAABAAAAPQ",
					"AQAAAAAAAAABAAAA5QYAAAAAAADlBgAAAAAAAP///////+9/"
				],
				[
					1513,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAOMGAAAAAAAA5AYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA4wYAAAAAAADjBgAAAAAAAAAAAAAAAPC/"
				],
				[
					1514,
					1,
					"wrap_block",
					{
						"begin": "{",
						"end": "}"
					},
					"AgAAAOQGAAAAAAAA5QYAAAAAAAAAAAAAdwcAAAAAAAB5BwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA5AYAAAAAAADkBgAAAAAAAAAAAAAAAPC/"
				],
				[
					1515,
					1,
					"insert",
					{
						"characters": "\nreturn"
					},
					"CAAAAOUGAAAAAAAA5gYAAAAAAAAAAAAA5gYAAAAAAADoBgAAAAAAAAAAAADoBgAAAAAAAOkGAAAAAAAAAAAAAOkGAAAAAAAA6gYAAAAAAAAAAAAA6gYAAAAAAADrBgAAAAAAAAAAAADrBgAAAAAAAOwGAAAAAAAAAAAAAOwGAAAAAAAA7QYAAAAAAAAAAAAA7QYAAAAAAADuBgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA5QYAAAAAAADlBgAAAAAAAAAAAAAAAPC/"
				],
				[
					1516,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAO4GAAAAAAAA7wYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA7gYAAAAAAADuBgAAAAAAAAAAAAAAAPC/"
				],
				[
					1517,
					2,
					"right_delete",
					null,
					"AgAAAO8GAAAAAAAA7wYAAAAAAAABAAAACu8GAAAAAAAA7wYAAAAAAAABAAAAIA",
					"AQAAAAAAAAABAAAA7wYAAAAAAADvBgAAAAAAAAAAAAAAAPC/"
				],
				[
					1520,
					1,
					"insert",
					{
						"characters": "c"
					},
					"AQAAAEYGAAAAAAAARwYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAARgYAAAAAAABGBgAAAAAAAAAAAAAAAPC/"
				],
				[
					1521,
					1,
					"left_delete",
					null,
					"AQAAAEYGAAAAAAAARgYAAAAAAAABAAAAYw",
					"AQAAAAAAAAABAAAARwYAAAAAAABHBgAAAAAAAAAAAAAAAPC/"
				],
				[
					1522,
					1,
					"insert",
					{
						"characters": "function"
					},
					"CAAAAEYGAAAAAAAARwYAAAAAAAAAAAAARwYAAAAAAABIBgAAAAAAAAAAAABIBgAAAAAAAEkGAAAAAAAAAAAAAEkGAAAAAAAASgYAAAAAAAAAAAAASgYAAAAAAABLBgAAAAAAAAAAAABLBgAAAAAAAEwGAAAAAAAAAAAAAEwGAAAAAAAATQYAAAAAAAAAAAAATQYAAAAAAABOBgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAARgYAAAAAAABGBgAAAAAAAAAAAAAAAPC/"
				],
				[
					1523,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAE4GAAAAAAAATwYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAATgYAAAAAAABOBgAAAAAAAAAAAAAAAPC/"
				],
				[
					1524,
					5,
					"right_delete",
					null,
					"BQAAAE8GAAAAAAAATwYAAAAAAAABAAAAY08GAAAAAAAATwYAAAAAAAABAAAAb08GAAAAAAAATwYAAAAAAAABAAAAbk8GAAAAAAAATwYAAAAAAAABAAAAc08GAAAAAAAATwYAAAAAAAABAAAAdA",
					"AQAAAAAAAAABAAAATwYAAAAAAABPBgAAAAAAAAAAAAAAAPC/"
				],
				[
					1526,
					1,
					"right_delete",
					null,
					"AQAAAFkGAAAAAAAAWQYAAAAAAAABAAAAPQ",
					"AQAAAAAAAAABAAAAWQYAAAAAAABZBgAAAAAAAAAAAAAAAPC/"
				],
				[
					1537,
					2,
					"left_delete",
					null,
					"AgAAAG8GAAAAAAAAbwYAAAAAAAABAAAAPm4GAAAAAAAAbgYAAAAAAAABAAAAPQ",
					"AQAAAAAAAAABAAAAcAYAAAAAAABwBgAAAAAAAAAAAAAAAPC/"
				],
				[
					1538,
					1,
					"insert",
					{
						"characters": "}"
					},
					"AQAAAG4GAAAAAAAAbwYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAbgYAAAAAAABuBgAAAAAAAAAAAAAAAPC/"
				],
				[
					1539,
					1,
					"left_delete",
					null,
					"AQAAAG4GAAAAAAAAbgYAAAAAAAABAAAAfQ",
					"AQAAAAAAAAABAAAAbwYAAAAAAABvBgAAAAAAAAAAAAAAAPC/"
				],
				[
					1540,
					1,
					"insert_snippet",
					{
						"contents": "{$0}"
					},
					"AQAAAG4GAAAAAAAAcAYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAbgYAAAAAAABuBgAAAAAAAAAAAAAAAPC/"
				],
				[
					1541,
					1,
					"insert",
					{
						"characters": " return"
					},
					"BwAAAG8GAAAAAAAAcAYAAAAAAAAAAAAAcAYAAAAAAABxBgAAAAAAAAAAAABxBgAAAAAAAHIGAAAAAAAAAAAAAHIGAAAAAAAAcwYAAAAAAAAAAAAAcwYAAAAAAAB0BgAAAAAAAAAAAAB0BgAAAAAAAHUGAAAAAAAAAAAAAHUGAAAAAAAAdgYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAbwYAAAAAAABvBgAAAAAAAAAAAAAAAPC/"
				],
				[
					1542,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAHYGAAAAAAAAdwYAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAdgYAAAAAAAB2BgAAAAAAAAAAAAAAAPC/"
				],
				[
					1543,
					2,
					"right_delete",
					null,
					"AgAAAHcGAAAAAAAAdwYAAAAAAAABAAAAfXcGAAAAAAAAdwYAAAAAAAABAAAAIA",
					"AQAAAAAAAAABAAAAdwYAAAAAAAB3BgAAAAAAAAAAAAAAAPC/"
				],
				[
					1545,
					1,
					"insert",
					{
						"characters": " }"
					},
					"AgAAAMAGAAAAAAAAwQYAAAAAAAAAAAAAwQYAAAAAAADCBgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAwAYAAAAAAADABgAAAAAAAP///////+9/"
				],
				[
					1556,
					1,
					"cut",
					null,
					"AQAAAOQEAAAAAAAA5AQAAAAAAACoAgAAZnVuY3Rpb24gTmV3V1MoKSB7CiAgbGV0IHVybCA9IFdlYlNvY2tldFVSTCgnL3dzJywgeyBtaXJyb3I6IGN1cnJlbnRGaWxlIH0pOwogIGxldCB3cyA9IG5ldyBSZWNvbm5lY3RpbmdXZWJTb2NrZXQodXJsLCAnbHdzLW1pcnJvci1wcm90b2NvbCcpOwogIChhc3luYyBmdW5jdGlvbigpIHsKICAgIGZvciBhd2FpdChsZXQgY2h1bmsgb2Ygd3MpIHsKICAgICAgbGV0IGRhdGEgPSBKU09OLnBhcnNlKGNodW5rKTsKCiAgICAgIGlmKGRhdGEuY2lkICE9IGdsb2JhbFRoaXMuY2lkKSBjb25zb2xlLmxvZygnV1MgcmVjZWl2ZTonLCBkYXRhKTsKICAgIH0KICB9KSgpOwogIHJldHVybiAoZ2xvYmFsVGhpcy53cyA9IHdzKTsKfQoKZnVuY3Rpb24gIE1ha2VVVUlEICAocm5nID0gTWF0aC5yYW5kb20pIHsgcmV0dXJuIFs4LCA0LCA0LCA0LCAxMl0ubWFwKG4gPT4gcmFuZFN0cihuLCAnMDEyMzQ1Njc4OWFiY2RlZicpLCBybmcpLmpvaW4oJy0nKTsgfQpmdW5jdGlvbiBNYWtlQ2xpZW50SUQgIChybmcgPSBNYXRoLnJhbmRvbSkgIHsKICByZXR1cm4gIFs0LCA0LCA0LCA0XQogICAgLm1hcChuID0+IHJhbmRTdHIobiwgWydBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWicsICdhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicsICcuLSQnXVtyYW5kSW50KDAsIDMpXSksIHJuZykKICAgIC5qb2luKCcnKTsKfQo",
					"AQAAAAAAAAABAAAA5AQAAAAAAACMBwAAAAAAAAAAAAAAAAAA"
				],
				[
					1565,
					1,
					"paste",
					null,
					"AQAAAN41AAAAAAAAhjgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA3jUAAAAAAADeNQAAAAAAAAAAAAAAAAAA"
				],
				[
					1568,
					1,
					"cut",
					null,
					"AQAAAHg1AAAAAAAAeDUAAAAAAAAOAwAACmZ1bmN0aW9uIGdldFJlY3QoZWxlbSkgewogIHJldHVybiBuZXcgUmVjdCgoZWxlbSA/PyBkaXZFbGVtZW50KS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSkucm91bmQoMSk7Cn0KZnVuY3Rpb24gTmV3V1MoKSB7CiAgbGV0IHVybCA9IFdlYlNvY2tldFVSTCgnL3dzJywgeyBtaXJyb3I6IGN1cnJlbnRGaWxlIH0pOwogIGxldCB3cyA9IG5ldyBSZWNvbm5lY3RpbmdXZWJTb2NrZXQodXJsLCAnbHdzLW1pcnJvci1wcm90b2NvbCcpOwogIChhc3luYyBmdW5jdGlvbigpIHsKICAgIGZvciBhd2FpdChsZXQgY2h1bmsgb2Ygd3MpIHsKICAgICAgbGV0IGRhdGEgPSBKU09OLnBhcnNlKGNodW5rKTsKCiAgICAgIGlmKGRhdGEuY2lkICE9IGdsb2JhbFRoaXMuY2lkKSBjb25zb2xlLmxvZygnV1MgcmVjZWl2ZTonLCBkYXRhKTsKICAgIH0KICB9KSgpOwogIHJldHVybiAoZ2xvYmFsVGhpcy53cyA9IHdzKTsKfQoKZnVuY3Rpb24gIE1ha2VVVUlEICAocm5nID0gTWF0aC5yYW5kb20pIHsgcmV0dXJuIFs4LCA0LCA0LCA0LCAxMl0ubWFwKG4gPT4gcmFuZFN0cihuLCAnMDEyMzQ1Njc4OWFiY2RlZicpLCBybmcpLmpvaW4oJy0nKTsgfQpmdW5jdGlvbiBNYWtlQ2xpZW50SUQgIChybmcgPSBNYXRoLnJhbmRvbSkgIHsKICByZXR1cm4gIFs0LCA0LCA0LCA0XQogICAgLm1hcChuID0+IHJhbmRTdHIobiwgWydBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWicsICdhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicsICcuLSQnXVtyYW5kSW50KDAsIDMpXSksIHJuZykKICAgIC5qb2luKCcnKTsKfQo",
					"AQAAAAAAAAABAAAAeDUAAAAAAACGOAAAAAAAAAAAAAAAAPC/"
				],
				[
					1573,
					1,
					"insert",
					{
						"characters": "\n\n"
					},
					"AgAAAPowAAAAAAAA+zAAAAAAAAAAAAAA+zAAAAAAAAD8MAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA+jAAAAAAAAD6MAAAAAAAAAAAAAAAAPC/"
				],
				[
					1574,
					1,
					"paste",
					null,
					"AQAAAPwwAAAAAAAACjQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA/DAAAAAAAAD8MAAAAAAAAAAAAAAAAPC/"
				]
			]
		},
		{
			"file": "lib/dom.js",
			"settings":
			{
				"buffer_size": 6598,
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					21,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAACoGQAALy9pbXBvcnQgUmVhY3RET00gZnJvbSAicmVhY3QtZG9tIjsKLy9pbXBvcnQgeyBTdmdQYXRoIH0gZnJvbSAiLi9zdmcvcGF0aC5qcyI7CmltcG9ydCBVdGlsIGZyb20gJy4vdXRpbC5qcyc7CmltcG9ydCB7IFBvaW50LCBpc1BvaW50IH0gZnJvbSAnLi9nZW9tL3BvaW50LmpzJzsKaW1wb3J0IHsgU2l6ZSwgaXNTaXplIH0gZnJvbSAnLi9nZW9tL3NpemUuanMnOwppbXBvcnQgeyBMaW5lLCBpc0xpbmUgfSBmcm9tICcuL2dlb20vbGluZS5qcyc7CmltcG9ydCB7IFJlY3QsIGlzUmVjdCB9IGZyb20gJy4vZ2VvbS9yZWN0LmpzJzsKaW1wb3J0IHsgUG9pbnRMaXN0IH0gZnJvbSAnLi9nZW9tL3BvaW50TGlzdC5qcyc7CmltcG9ydCB7IFBvbHlsaW5lIH0gZnJvbSAnLi9nZW9tL3BvbHlsaW5lLmpzJzsKaW1wb3J0IHsgTWF0cml4LCBpc01hdHJpeCB9IGZyb20gJy4vZ2VvbS9tYXRyaXguanMnOwppbXBvcnQgeyBCQm94IH0gZnJvbSAnLi9nZW9tL2Jib3guanMnOwppbXBvcnQgeyBUUkJMIH0gZnJvbSAnLi9nZW9tL3RyYmwuanMnOwppbXBvcnQgVGltZXIgZnJvbSAnLi9kb20vdGltZXIuanMnOwppbXBvcnQgeyBUcmVlIH0gZnJvbSAnLi9kb20vdHJlZS5qcyc7CmltcG9ydCB7IEV2ZW50IH0gZnJvbSAnLi9kb20vZXZlbnQuanMnOwppbXBvcnQgeyBOb2RlIH0gZnJvbSAnLi9kb20vbm9kZS5qcyc7CmltcG9ydCB7IFhQYXRoIH0gZnJvbSAnLi9kb20veHBhdGguanMnOwppbXBvcnQgeyBIU0xBLCBSR0JBIH0gZnJvbSAnLi9jb2xvci5qcyc7CmV4cG9ydCB7IEhTTEEsIFJHQkEgfSBmcm9tICcuL2NvbG9yLmpzJzsKaW1wb3J0IHsgRWxlbWVudCwgaXNFbGVtZW50IH0gZnJvbSAnLi9kb20vZWxlbWVudC5qcyc7CmltcG9ydCB7IENTUyB9IGZyb20gJy4vZG9tL2Nzcy5qcyc7CmltcG9ydCB7IFNWRyB9IGZyb20gJy4vZG9tL3N2Zy5qcyc7Ci8vaW1wb3J0IHsgUmVhY3RDb21wb25lbnQgfSBmcm9tICcuL2RvbS9yZWFjdENvbXBvbmVudC5qcyc7CmltcG9ydCB7IENvbnRhaW5lciB9IGZyb20gJy4vZG9tL2NvbnRhaW5lci5qcyc7CmltcG9ydCB7IExheWVyLCBSZW5kZXJlciB9IGZyb20gJy4vZG9tL2xheWVyLmpzJzsKaW1wb3J0IHsgU2VsZWN0IH0gZnJvbSAnLi9kb20vc2VsZWN0LmpzJzsKaW1wb3J0IHsgQWxpZ24sIEFuY2hvciB9IGZyb20gJy4vZ2VvbS9hbGlnbi5qcyc7CmltcG9ydCB7IEVsZW1lbnRQb3NQcm9wcywgRWxlbWVudFJlY3RQcm9wcywgRWxlbWVudFJlY3RQcm94eSwgRWxlbWVudFNpemVQcm9wcywgRWxlbWVudFdIUHJvcHMsIEVsZW1lbnRYWVByb3BzIH0gZnJvbSAnLi9kb20vZWxlbWVudFJlY3QuanMnOwoKZXhwb3J0IGZ1bmN0aW9uIGRvbSgpIHsKICBsZXQgYXJncyA9IFsuLi5hcmd1bWVudHNdOwogIGxldCByZXQgPSBbXTsKCiAgY29uc3QgZXh0ZW5kID0gKGUsIGZ1bmN0aW9ucykgPT4gewogICAgY29uc3Qga2V5cyA9IFsuLi5VdGlsLm1lbWJlcnMoZnVuY3Rpb25zKV0uZmlsdGVyKAogICAgICBrZXkgPT4gWydjYWxsZWUnLCAnY2FsbGVyJywgJ2FyZ3VtZW50cycsICdjYWxsJywgJ2JpbmQnLCAnYXBwbHknLCAncHJvdG90eXBlJywgJ2NvbnN0cnVjdG9yJywgJ2xlbmd0aCddLmluZGV4T2Yoa2V5KSA9PSAtMSAmJiB0eXBlb2YgZnVuY3Rpb25zW2tleV0gPT0gJ2Z1bmN0aW9uJwogICAgKTsKICAgIGZvcihsZXQga2V5IG9mIGtleXMpIGlmKGVba2V5XSA9PT0gdW5kZWZpbmVkKSBlW2tleV0gPSBmdW5jdGlvbnNba2V5XS5iaW5kKGZ1bmN0aW9ucywgZSk7CiAgfTsKCiAgYXJncyA9IGFyZ3MubWFwKGFyZyA9PiAodHlwZW9mIGFyZyA9PSAnc3RyaW5nJyA/IEVsZW1lbnQuZmluZEFsbChhcmcpIDogYXJnKSk7CgogIGZvcihsZXQgZSBvZiBhcmdzKSB7CiAgICBpZihlIGluc3RhbmNlb2YgU1ZHU1ZHRWxlbWVudCkgZXh0ZW5kKGUsIFNWRyk7CiAgICBpZihpc0VsZW1lbnQoZSkpIHsKICAgICAgZXh0ZW5kKGUsIEVsZW1lbnQpOwogICAgICBFbGVtZW50UG9zUHJvcHMoZSk7CiAgICAgIEVsZW1lbnRTaXplUHJvcHMoZSk7CiAgICAgIENTU1RyYW5zZm9ybVNldHRlcnMoZSk7CiAgICB9CgogICAgcmV0LnB1c2goZSk7CiAgfQogIGlmKHJldC5sZW5ndGggPT0gMSkgcmV0ID0gcmV0WzBdOwogIHJldHVybiByZXQ7Cn0KCmV4cG9ydCBjb25zdCBpc051bWJlciA9IGEgPT4gU3RyaW5nKGEpLnJlcGxhY2UoL15bMC05XSokLywgJycpID09ICcnOwoKZXhwb3J0IGZ1bmN0aW9uIFVuaXQoc3RyKSB7CiAgbGV0IHUgPQogICAgdGhpcyBpbnN0YW5jZW9mIFVuaXQKICAgICAgPyB0aGlzCiAgICAgIDogewogICAgICAgICAgZm9ybWF0KG51bWJlcikgewogICAgICAgICAgICByZXR1cm4gYCR7bnVtYmVyfSR7dGhpcy5uYW1lfWA7CiAgICAgICAgICB9CiAgICAgICAgfTsKICB1Lm5hbWUgPSBzdHIucmVwbGFjZSgvXlthLXpdKi8sICcnKTsKICByZXR1cm4gdTsKfQoKZXhwb3J0IGZ1bmN0aW9uIFNjYWxhclZhbHVlKCkge30KCmNvbnN0IGlmZGVmID0gKHZhbHVlLCBkZWYsIG5vZGVmKSA9PiAodmFsdWUgIT09IHVuZGVmaW5lZCA/IGRlZiA6IG5vZGVmKTsKCmV4cG9ydCBjb25zdCBFbGVtZW50VHJhbnNmb3JtYXRpb24gPSAoKSA9PiAoewogIHJvdGF0ZTogMCwKICB0cmFuc2xhdGU6IG5ldyBQb2ludCgwLCAwKSwKICBzY2FsZTogbmV3IFNpemUoMCwgMCksCiAgdG9TdHJpbmcoKSB7CiAgICBjb25zdCB7IHJvdGF0ZSwgdHJhbnNsYXRlLCBzY2FsZSB9ID0gdGhpczsKICAgIHJldHVybiBgcm90YXRlKCR7cm90YXRlfWRlZykgdHJhbnNsYXRlKCR7dHJhbnNsYXRlLnh9LCAke3RyYW5zbGF0ZS55fSkgc2NhbGUoJHtzY2FsZS53fSwke3NjYWxlLmh9KWA7CiAgfQp9KTsKCmV4cG9ydCBjb25zdCBDU1NUcmFuc2Zvcm1TZXR0ZXJzID0gZWxlbWVudCA9PiAoewogIHRyYW5zZm9ybWF0aW9uOiBFbGVtZW50VHJhbnNmb3JtYXRpb24oKSwKICBnZXQgcm90YXRlKCkgewogICAgcmV0dXJuIHRoaXMudHJhbnNmb3JtYXRpb24ucm90YXRlOwogIH0sCiAgc2V0IHJvdGF0ZShhKSB7CiAgICB0aGlzLnRyYW5zZm9ybWF0aW9uLnJvdGF0ZSA9IGE7CiAgICB0aGlzLnVwZGF0ZVRyYW5zZm9ybWF0aW9uKCk7CiAgfSwKICBnZXQgdHJhbnNsYXRlKCkgewogICAgcmV0dXJuIHRoaXMudHJhbnNmb3JtYXRpb24udHJhbnNsYXRlOwogIH0sCiAgc2V0IHRyYW5zbGF0ZShwb2ludCkgewogICAgdGhpcy50cmFuc2Zvcm1hdGlvbi50cmFuc2xhdGUuc2V0KHBvaW50LngsIHBvaW50LnkpOwogICAgdGhpcy51cGRhdGVUcmFuc2Zvcm1hdGlvbigpOwogIH0sCiAgZ2V0IHNjYWxlKCkgewogICAgcmV0dXJuIHRoaXMudHJhbnNmb3JtYXRpb24uc2NhbGU7CiAgfSwKICBzZXQgc2NhbGUoc2l6ZSkgewogICAgdGhpcy50cmFuc2Zvcm1hdGlvbi5zY2FsZS5zZXQoc2l6ZS53aWR0aCwgc2l6ZS5oZWlnaHQpOwogICAgdGhpcy51cGRhdGVUcmFuc2Zvcm1hdGlvbigpOwogIH0sCiAgdXBkYXRlVHJhbnNmb3JtYXRpb24oKSB7CiAgICBjb25zdCB0ID0gdGhpcy50cmFuc2Zvcm1hdGlvbi50b1N0cmluZygpOwogICAgY29uc29sZS5sb2coJ0NTU1RyYW5zZm9ybVNldHRlcnMudXBkYXRlVHJhbnNmb3JtYXRpb24nLCB0KTsKICAgIHRoaXMuc3R5bGUudHJhbnNmb3JtID0gdDsKICB9Cn0pOwoKZXhwb3J0IGNsYXNzIFRyYW5zaXRpb24gewogIHByb3BlcnR5ID0gJ25vbmUnOwogIGRlbGF5ID0gJyc7CiAgZHVyYXRpb24gPSAnJzsKICB0aW1pbmcgPSAnJzsKCiAgY29uc3RydWN0b3IocHJvcGVydHksIGRlbGF5LCBkdXJhdGlvbiwgdGltaW5nKSB7CiAgICB0aGlzLnByb3BlcnR5ID0gcHJvcGVydHk7CiAgICB0aGlzLmRlbGF5ID0gZGVsYXk7CiAgICB0aGlzLmR1cmF0aW9uID0gZHVyYXRpb247CiAgICB0aGlzLnRpbWluZyA9IHRpbWluZzsKICB9CgogIHN0YXRpYyBsaXN0KCkgewogICAgcmV0dXJuIG5ldyBUcmFuc2l0aW9uTGlzdCguLi5hcmd1bWVudHMpOwogIH0KfQoKZXhwb3J0IGNsYXNzIFRyYW5zaXRpb25MaXN0IGV4dGVuZHMgQXJyYXkgewogIGNvbnN0cnVjdG9yKCkgewogICAgY29uc3QgYXJncyA9IFsuLi5hcmd1bWVudHNdOwoKICAgIGFyZ3MuZm9yRWFjaChhcmcgPT4gdGhpcy5wdXNoKGFyZykpOwogIH0KCiAgcHJvcGVydHlMaXN0KG5hbWUpIHsKICAgIHJldHVybiB0aGlzLm1hcCh0cmFuc2l0aW9uID0+IHRyYW5zaXRpb25bbmFtZV0pOwogIH0KCiAgZ2V0IGNzcygpIHsKICAgIHJldHVybiB7CiAgICAgIHRyYW5zaXRpb25EZWxheTogdGhpcy5wcm9wZXJ0eUxpc3QoJ2RlbGF5Jykuam9pbignLCAnKSwKICAgICAgdHJhbnNpdGlvbkR1cmF0aW9uOiB0aGlzLnByb3BlcnR5TGlzdCgnZHVyYXRpb24nKS5qb2luKCcsICcpLAogICAgICB0cmFuc2l0aW9uUHJvcGVydHk6IHRoaXMucHJvcGVydHlMaXN0KCdwcm9wZXJ0eScpLmpvaW4oJywgJyksCiAgICAgIHRyYW5zaXRpb25UaW1pbmdGdW5jdGlvbjogdGhpcy5wcm9wZXJ0eUxpc3QoJ3RpbWluZycpLmpvaW4oJywgJykKICAgIH07CiAgfQp9CgpleHBvcnQgY29uc3QgUmFuZG9tQ29sb3IgPSAoKSA9PiB7CiAgY29uc3QgYyA9IEhTTEEucmFuZG9tKCk7CiAgcmV0dXJuIGMudG9TdHJpbmcoKTsKfTsKCi8qCmV4cG9ydCBjb25zdCBpc1RSQkwgPSBpbnN0ID0+IHt9OwpleHBvcnQgY29uc3QgaXNUaW1lciA9IGluc3QgPT4ge307CmV4cG9ydCBjb25zdCBpc1RyZWUgPSBpbnN0ID0+IHt9OwpleHBvcnQgY29uc3QgaXNDU1MgPSBpbnN0ID0+IHt9OwpleHBvcnQgY29uc3QgaXNDb250YWluZXIgPSBpbnN0ID0+IHt9OwpleHBvcnQgY29uc3QgaXNTVkcgPSBpbnN0ID0+IGluc3QudGFnTmFtZS50b0xvd2VyQ2FzZSgpID09ICJzdmciOwoKZXhwb3J0IGNvbnN0IGlzUmVhY3RDb21wb25lbnQgPSBpbnN0ID0+IHt9OwpleHBvcnQgY29uc3QgaXNSZW5kZXJlciA9IGluc3QgPT4ge307CmV4cG9ydCBjb25zdCBpc1NlbGVjdCA9IGluc3QgPT4ge307CiovCgpleHBvcnQgeyBQb2ludCwgaXNQb2ludCB9IGZyb20gJy4vZ2VvbS9wb2ludC5qcyc7CmV4cG9ydCB7IFNpemUsIGlzU2l6ZSB9IGZyb20gJy4vZ2VvbS9zaXplLmpzJzsKZXhwb3J0IHsgTGluZSwgaXNMaW5lIH0gZnJvbSAnLi9nZW9tL2xpbmUuanMnOwpleHBvcnQgeyBSZWN0LCBpc1JlY3QgfSBmcm9tICcuL2dlb20vcmVjdC5qcyc7CmV4cG9ydCB7IFBvaW50TGlzdCB9IGZyb20gJy4vZ2VvbS9wb2ludExpc3QuanMnOwpleHBvcnQgeyBQb2x5bGluZSB9IGZyb20gJy4vZ2VvbS9wb2x5bGluZS5qcyc7CmV4cG9ydCB7IE1hdHJpeCwgaXNNYXRyaXggfSBmcm9tICcuL2dlb20vbWF0cml4LmpzJzsKZXhwb3J0IHsgQkJveCB9IGZyb20gJy4vZ2VvbS9iYm94LmpzJzsKZXhwb3J0IHsgVFJCTCB9IGZyb20gJy4vZ2VvbS90cmJsLmpzJzsKZXhwb3J0IHsgVGltZXIgfSBmcm9tICcuL2RvbS90aW1lci5qcyc7CmV4cG9ydCB7IFRyZWUgfSBmcm9tICcuL2RvbS90cmVlLmpzJzsKZXhwb3J0IHsgTm9kZSB9IGZyb20gJy4vZG9tL25vZGUuanMnOwpleHBvcnQgeyBYUGF0aCB9IGZyb20gJy4vZG9tL3hwYXRoLmpzJzsKZXhwb3J0IHsgRWxlbWVudCwgaXNFbGVtZW50IH0gZnJvbSAnLi9kb20vZWxlbWVudC5qcyc7CmV4cG9ydCB7IENTUyB9IGZyb20gJy4vZG9tL2Nzcy5qcyc7CmV4cG9ydCB7IFNWRyB9IGZyb20gJy4vZG9tL3N2Zy5qcyc7Ci8vZXhwb3J0IHsgUmVhY3RDb21wb25lbnQgfSBmcm9tICcuL2RvbS9yZWFjdENvbXBvbmVudC5qcyc7CmV4cG9ydCB7IENvbnRhaW5lciB9IGZyb20gJy4vZG9tL2NvbnRhaW5lci5qcyc7CmV4cG9ydCB7IExheWVyLCBSZW5kZXJlciB9IGZyb20gJy4vZG9tL2xheWVyLmpzJzsKZXhwb3J0IHsgU2VsZWN0IH0gZnJvbSAnLi9kb20vc2VsZWN0LmpzJzsKZXhwb3J0IHsgRWxlbWVudFBvc1Byb3BzLCBFbGVtZW50UmVjdFByb3BzLCBFbGVtZW50UmVjdFByb3h5LCBFbGVtZW50U2l6ZVByb3BzLCBFbGVtZW50V0hQcm9wcywgRWxlbWVudFhZUHJvcHMgfSBmcm9tICcuL2RvbS9lbGVtZW50UmVjdC5qcyc7CmV4cG9ydCB7IEFsaWduLCBBbmNob3IgfSBmcm9tICcuL2dlb20vYWxpZ24uanMnOwoKZXhwb3J0IGRlZmF1bHQgT2JqZWN0LmFzc2lnbihkb20sIHsKICBBbGlnbiwKICBBbmNob3IsCiAgQ29udGFpbmVyLAogIENTUywKICBDU1NUcmFuc2Zvcm1TZXR0ZXJzLAogIE5vZGUsCiAgRWxlbWVudCwKICBFbGVtZW50UG9zUHJvcHMsCiAgRWxlbWVudFJlY3RQcm9wcywKICBFbGVtZW50UmVjdFByb3h5LAogIEVsZW1lbnRTaXplUHJvcHMsCiAgRWxlbWVudFRyYW5zZm9ybWF0aW9uLAogIEVsZW1lbnRXSFByb3BzLAogIEVsZW1lbnRYWVByb3BzLAogIGlzRWxlbWVudCwKICBpc0xpbmUsCiAgaXNNYXRyaXgsCiAgaXNOdW1iZXIsCiAgaXNQb2ludCwKICBpc1JlY3QsCiAgaXNTaXplLAogIExpbmUsCiAgTWF0cml4LAogIE5vZGUsCiAgUG9pbnQsCiAgUG9pbnRMaXN0LAogIFBvbHlsaW5lLAogIC8vUmVhY3RDb21wb25lbnQsCiAgUmVjdCwKICBSZW5kZXJlciwKCiAgLy9TZWxlY3QsCiAgU2l6ZSwKICBTVkcsCiAgVGltZXIsCiAgVHJhbnNpdGlvbiwKICBUcmFuc2l0aW9uTGlzdCwKICBUUkJMLAogIFRyZWUsCiAgRXZlbnQsCiAgWFBhdGgKfSk7CgAAAAAAAAAAxhkAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAABgIAAAAAAAAGAgAAAAAAAAAAAAAAAPC/"
				]
			]
		},
		{
			"file": "lib/dom/element.js",
			"settings":
			{
				"buffer_size": 36040,
				"line_ending": "Unix"
			}
		},
		{
			"file": "debugger-server.js",
			"settings":
			{
				"buffer_size": 15241,
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					4,
					1,
					"insert",
					{
						"characters": "\t"
					},
					"AQAAADINAAAAAAAANA0AAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAMg0AAAAAAAAyDQAAAAAAAAAAAAAAAAAA"
				],
				[
					5,
					1,
					"left_delete",
					null,
					"AQAAADINAAAAAAAAMg0AAAAAAAACAAAAICA",
					"AQAAAAAAAAABAAAANA0AAAAAAAA0DQAAAAAAAAAAAAAAAPC/"
				],
				[
					31,
					1,
					"",
					null,
					"AQAAAFs6AAAAAAAAXzoAAAAAAAAEAAAAOTAwMA",
					"AQAAAAAAAAABAAAAWzoAAAAAAABfOgAAAAAAAAAAAAAAAPC/"
				],
				[
					38,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAABiPAAAaW1wb3J0ICogYXMgc3RkIGZyb20gJ3N0ZCc7CmltcG9ydCAqIGFzIG9zIGZyb20gJ29zJzsKaW1wb3J0IHsgc2V0SW50ZXJ2YWwgfSBmcm9tICd0aW1lcnMnOwppbXBvcnQgKiBhcyBkZWVwIGZyb20gJy4vbGliL2RlZXAuanMnOwppbXBvcnQgKiBhcyBwYXRoIGZyb20gJy4vbGliL3BhdGguanMnOwppbXBvcnQgVXRpbCBmcm9tICcuL2xpYi91dGlsLmpzJzsKaW1wb3J0IHsgZGFlbW9uLCBhdGV4aXQsIGdldHBpZCwgdG9BcnJheUJ1ZmZlciwgdG9TdHJpbmcsIGVzY2FwZSwgcXVvdGUsIGRlZmluZSwgZXh0ZW5kQXJyYXksIGdldE9wdCB9IGZyb20gJ3V0aWwnOwppbXBvcnQgeyBDb25zb2xlIH0gZnJvbSAnLi9xdWlja2pzL3Fqcy1tb2R1bGVzL2xpYi9jb25zb2xlLmpzJzsKaW1wb3J0IFJFUEwgZnJvbSAnLi9xdWlja2pzL3Fqcy1tb2R1bGVzL2xpYi9yZXBsLmpzJzsKaW1wb3J0IGluc3BlY3QgZnJvbSAnLi9saWIvb2JqZWN0SW5zcGVjdC5qcyc7CmltcG9ydCAqIGFzIFRlcm1pbmFsIGZyb20gJy4vdGVybWluYWwuanMnOwppbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7CmltcG9ydCB7IHNldExvZywgbG9nTGV2ZWxzLCBnZXRTZXNzaW9ucywgTExMX1VTRVIsIExMTF9JTkZPLCBMTExfTk9USUNFLCBMTExfV0FSTiwgY2xpZW50LCBzZXJ2ZXIgfSBmcm9tICduZXQnOwppbXBvcnQgeyBEZWJ1Z2dlclByb3RvY29sIH0gZnJvbSAnLi9kZWJ1Z2dlcnByb3RvY29sLmpzJzsKaW1wb3J0IHsgU3RhcnREZWJ1Z2dlciwgQ29ubmVjdERlYnVnZ2VyIH0gZnJvbSAnLi9kZWJ1Z2dlci5qcyc7CmltcG9ydCB7IGZjbnRsLCBGX0dFVEZMLCBGX1NFVEZMLCBPX05PTkJMT0NLIH0gZnJvbSAnLi9xdWlja2pzL3Fqcy1mZmkvbGliL2ZjbnRsLmpzJzsKaW1wb3J0IHsgSWZEZWJ1ZywgTG9nSWZEZWJ1ZywgUmVhZEZpbGUsIExvYWRIaXN0b3J5LCBSZWFkSlNPTiwgUmVhZFhNTCwgTWFwRmlsZSwgV3JpdGVGaWxlLCBXcml0ZUpTT04sIFdyaXRlWE1MLCBSZWFkQkpTT04sIFdyaXRlQkpTT04sIERpckl0ZXJhdG9yLCBSZWN1cnNpdmVEaXJJdGVyYXRvciwgUmVhZERpclJlY3Vyc2l2ZSwgRmlsdGVyLCBGaWx0ZXJJbWFnZXMsIFNvcnRGaWxlcywgU3RhdEZpbGVzLCBSZWFkRmQsIEZkUmVhZGVyLCBDb3B5VG9DbGlwYm9hcmQsIFJlYWRDYWxsYmFjaywgTG9nQ2FsbCwgU3Bhd24sIEZldGNoVVJMIH0gZnJvbSAnLi9pby1oZWxwZXJzLmpzJzsKCmV4dGVuZEFycmF5KEFycmF5LnByb3RvdHlwZSk7Cgpjb25zdCBzY3JpcHROYW1lID0gKGFyZyA9IHNjcmlwdEFyZ3NbMF0pID0+IHBhdGguYmFzZW5hbWUoYXJnLCBwYXRoLmV4dG5hbWUoYXJnKSk7CgphdGV4aXQoKCkgPT4gewogIGNvbnNvbGUubG9nKCdhdGV4aXQnLCBhdGV4aXQpOwogIGxldCBzdGFjayA9IG5ldyBFcnJvcignJykuc3RhY2s7CiAgY29uc29sZS5sb2coJ3N0YWNrOicsIHN0YWNrKTsKfSk7CgpmdW5jdGlvbiBTdGFydFJFUEwocHJlZml4ID0gc2NyaXB0TmFtZSgpLCBzdWZmaXggPSAnJykgewogIGxldCByZXBsID0gbmV3IFJFUEwoYFx4MWJbMzg7NTsxNjVtJHtwcmVmaXh9IFx4MWJbMzg7NTszOW0ke3N1ZmZpeH1ceDFiWzBtYCwgZmFsc2UpOwogIHJlcGwuaGlzdG9yeUxvYWQobnVsbCwgZnMpOwogIHJlcGwubG9hZFNhdmVPcHRpb25zKCk7CiAgcmVwbC5pbnNwZWN0T3B0aW9ucyA9IHsgLi4uY29uc29sZS5vcHRpb25zLCBtYXhBcnJheUxlbmd0aDogSW5maW5pdHksIGNvbXBhY3Q6IDIgfTsKICBsZXQgeyBsb2cgfSA9IGNvbnNvbGU7CgogIHJlcGwuZGlyZWN0aXZlcy5pID0gWwogICAgbmFtZSA9PgogICAgICBpbXBvcnQobmFtZSkKICAgICAgICAudGhlbihtID0+IChnbG9iYWxUaGlzW25hbWUucmVwbGFjZSgvKC4qXC98XC5bXlwvLl0rJCkvZywgJycpXSA9IG0pKQogICAgICAgIC5jYXRjaCgoKSA9PiByZXBsLnByaW50U3RhdHVzKGBFUlJPUjogbW9kdWxlICcke25hbWV9JyBub3QgZm91bmRgKSksCiAgICAnaW1wb3J0IGEgbW9kdWxlJwogIF07CiAgcmVwbC5kaXJlY3RpdmVzLmQgPSBbKCkgPT4gZ2xvYmFsVGhpcy5kYWVtb24oKSwgJ2RldGFjaCddOwogIGNvbnNvbGUubG9nID0gcmVwbC5wcmludEZ1bmN0aW9uKCguLi5hcmdzKSA9PiB7CiAgICBsb2coJ0xPRycsIGNvbnNvbGUuY29uZmlnKHJlcGwuaW5zcGVjdE9wdGlvbnMpLCAuLi5hcmdzKTsKICB9KTsKICByZXBsLnJ1bigpOwogIHJldHVybiByZXBsOwp9CgpmdW5jdGlvbiBtYWluKC4uLmFyZ3MpIHsKICBjb25zdCBiYXNlID0gc2NyaXB0TmFtZSgpLnJlcGxhY2UoL1wuW2Etel0qJC8sICcnKTsKCiAgY29uc3QgY29uZmlnID0gUmVhZEpTT04oYC4ke2Jhc2V9LWNvbmZpZ2ApID8/IHt9OwoKICBnbG9iYWxUaGlzLmNvbnNvbGUgPSBuZXcgQ29uc29sZShzdGQuZXJyLCB7CiAgICBpbnNwZWN0T3B0aW9uczogeyBkZXB0aDogSW5maW5pdHksIGNvbXBhY3Q6IDIsIG1heEFycmF5TGVuZ3RoOiBJbmZpbml0eSwgY3VzdG9tSW5zcGVjdDogdHJ1ZSB9CiAgfSk7CgogIGxldCBwYXJhbXMgPSBnZXRPcHQoCiAgICB7CiAgICAgIHZlcmJvc2U6IFtmYWxzZSwgKGEsIHYpID0+ICh2IHwgMCkgKyAxLCAndiddLAogICAgICBsaXN0ZW46IFtmYWxzZSwgbnVsbCwgJ2wnXSwKICAgICAgY29ubmVjdDogW2ZhbHNlLCBudWxsLCAnYyddLAogICAgICBjbGllbnQ6IFtmYWxzZSwgbnVsbCwgJ0MnXSwKICAgICAgc2VydmVyOiBbZmFsc2UsIG51bGwsICdTJ10sCiAgICAgIGRlYnVnOiBbZmFsc2UsIG51bGwsICd4J10sCiAgICAgIHRsczogW2ZhbHNlLCAodiwgcHYsIG8pID0+ICgoby50bHMgPSB0cnVlKSwgdHJ1ZSksICd0J10sCiAgICAgICduby10bHMnOiBbZmFsc2UsICh2LCBwdiwgbykgPT4gKChvLnRscyA9IGZhbHNlKSwgdHJ1ZSksICdUJ10sCiAgICAgIGFkZHJlc3M6IFt0cnVlLCBudWxsLCAnYSddLAogICAgICBwb3J0OiBbdHJ1ZSwgbnVsbCwgJ3AnXSwKICAgICAgcXVpZXQ6IFtmYWxzZSwgbnVsbCwgJ3EnXSwKICAgICAgJ3NzbC1jZXJ0JzogW3RydWUsIG51bGxdLAogICAgICAnc3NsLXByaXZhdGUta2V5JzogW3RydWUsIG51bGxdLAogICAgICAnc3NsLWNhJzogW3RydWUsIG51bGxdLAogICAgICAnQCc6ICdhZGRyZXNzLHBvcnQnCiAgICB9LAogICAgYXJncwogICk7CiAgaWYocGFyYW1zWyduby10bHMnXSA9PT0gdHJ1ZSkgcGFyYW1zLnRscyA9IGZhbHNlOwogIGNvbnN0IHsKICAgIGFkZHJlc3MgPSAnMC4wLjAuMCcsCiAgICBwb3J0ID0gODk5OSwKICAgICdzc2wtY2VydCc6IHNzbENlcnQgPSAnbG9jYWxob3N0LmNydCcsCiAgICAnc3NsLXByaXZhdGUta2V5Jzogc3NsUHJpdmF0ZUtleSA9ICdsb2NhbGhvc3Qua2V5JywKICAgICdzc2wtY2EnOiBzc2xDQSA9ICcvZXRjL3NzbC9jZXJ0cy9jYS1jZXJ0aWZpY2F0ZXMuY3J0JywKICAgIHF1aWV0ID0gZmFsc2UsCiAgICBkZWJ1ZyA9IGZhbHNlLAogICAgdGxzID0gdHJ1ZQogIH0gPSBwYXJhbXM7CiAgY29uc3QgbGlzdGVuID0gcGFyYW1zLmNvbm5lY3QgJiYgIXBhcmFtcy5saXN0ZW4gPyBmYWxzZSA6IHRydWU7CiAgLy9jb25zdCBzZXJ2ZXIgPSAhcGFyYW1zLmNsaWVudCB8fCBwYXJhbXMuc2VydmVyOwogIGxldCBuYW1lID0gc2NyaXB0QXJnc1swXTsKICBuYW1lID0gbmFtZQogICAgLnJlcGxhY2UoLy4qXC8vLCAnJykKICAgIC5yZXBsYWNlKC8tL2csICcgJykKICAgIC5yZXBsYWNlKC9cLlteXC8uXSokLywgJycpOwoKICBsZXQgW3ByZWZpeCwgc3VmZml4XSA9IG5hbWUuc3BsaXQoJyAnKTsKCiAgbGV0IHByb3RvY29sID0gbmV3IFdlYWtNYXAoKTsKCiAgbGV0IHNvY2tldHMgPSAoZ2xvYmFsVGhpcy5zb2NrZXRzID8/PSBuZXcgU2V0KCkpOwoKICBjb25zdCBjcmVhdGVXUyA9IChnbG9iYWxUaGlzLmNyZWF0ZVdTID0gKHVybCwgY2FsbGJhY2tzLCBsaXN0ZW4pID0+IHsKICAgIGNvbnNvbGUubG9nKCdjcmVhdGVXUycsIHsgdXJsLCBjYWxsYmFja3MsIGxpc3RlbiB9KTsKCiAgICBzZXRMb2coCiAgICAgIHF1aWV0ID8gMCA6IExMTF9VU0VSIHwgKCgoZGVidWcgPyBMTExfSU5GTyA6IExMTF9XQVJOKSA8PCAxKSAtIDEpLAogICAgICBxdWlldCB8fCAhcGFyYW1zLmRlYnVnCiAgICAgICAgPyAoKSA9PiB7fQogICAgICAgIDogKGxldmVsLCBzdHIpID0+IHsKICAgICAgICAgICAgaWYoL0JJTkRfUFJPVE9DT0x8RFJPUF9QUk9UT0NPTHxDSEVDS19BQ0NFU1NfUklHSFRTfEFERF9IRUFERVJTLy50ZXN0KHN0cikpIHJldHVybjsKICAgICAgICAgICAgY29uc29sZS5sb2cobG9nTGV2ZWxzW2xldmVsXS5wYWRFbmQoMTApLCBzdHIudHJpbSgpKTsKICAgICAgICAgIH0KICAgICk7CgogICAgbGV0IG9wdGlvbnM7CiAgICBsZXQgY2hpbGQsIGRiZzsKICAgIGxldCBuZXRmbiA9IFtjbGllbnQsIHNlcnZlcl1bK2xpc3Rlbl07CiAgICBjb25zb2xlLmxvZygnY3JlYXRlV1MnLCB7IHVybCwgbmV0Zm4gfSk7CiAgICByZXR1cm4gbmV0Zm4oCiAgICAgIHVybCwKICAgICAgKG9wdGlvbnMgPSB7CiAgICAgICAgdGxzOiBwYXJhbXMudGxzLAogICAgICAgIHNzbENlcnQsCiAgICAgICAgc3NsUHJpdmF0ZUtleSwKICAgICAgICBzc2xDQSwKICAgICAgICBtaW1ldHlwZXM6IFsKICAgICAgICAgIFsnLnN2Z3onLCAnYXBwbGljYXRpb24vZ3ppcCddLAogICAgICAgICAgWycubWpzJywgJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnXSwKICAgICAgICAgIFsnLmVzJywgJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnXSwKICAgICAgICAgIFsnLndhc20nLCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJ10sCiAgICAgICAgICBbJy5lb3QnLCAnYXBwbGljYXRpb24vdm5kLm1zLWZvbnRvYmplY3QnXSwKICAgICAgICAgIFsnLmxpYicsICdhcHBsaWNhdGlvbi94LWFyY2hpdmUnXSwKICAgICAgICAgIFsnLmJ6MicsICdhcHBsaWNhdGlvbi94LWJ6aXAyJ10sCiAgICAgICAgICBbJy5naXRpZ25vcmUnLCAndGV4dC9wbGFpbiddLAogICAgICAgICAgWycuY21ha2UnLCAndGV4dC9wbGFpbiddLAogICAgICAgICAgWycuaGV4JywgJ3RleHQvcGxhaW4nXSwKICAgICAgICAgIFsnLm1kJywgJ3RleHQvcGxhaW4nXSwKICAgICAgICAgIFsnLnBieHByb2onLCAndGV4dC9wbGFpbiddLAogICAgICAgICAgWycud2F0JywgJ3RleHQvcGxhaW4nXSwKICAgICAgICAgIFsnLmMnLCAndGV4dC94LWMnXSwKICAgICAgICAgIFsnLmgnLCAndGV4dC94LWMnXSwKICAgICAgICAgIFsnLmNwcCcsICd0ZXh0L3gtYysrJ10sCiAgICAgICAgICBbJy5ocHAnLCAndGV4dC94LWMrKyddLAogICAgICAgICAgWycuZmlsdGVycycsICd0ZXh0L3htbCddLAogICAgICAgICAgWycucGxpc3QnLCAndGV4dC94bWwnXSwKICAgICAgICAgIFsnLnN0b3J5Ym9hcmQnLCAndGV4dC94bWwnXSwKICAgICAgICAgIFsnLnZjeHByb2onLCAndGV4dC94bWwnXSwKICAgICAgICAgIFsnLmJhdCcsICd0ZXh0L3gtbXNkb3MtYmF0Y2gnXSwKICAgICAgICAgIFsnLm1tJywgJ3RleHQveC1vYmplY3RpdmUtYyddLAogICAgICAgICAgWycubScsICd0ZXh0L3gtb2JqZWN0aXZlLWMnXSwKICAgICAgICAgIFsnLnNoJywgJ3RleHQveC1zaGVsbHNjcmlwdCddCiAgICAgICAgXSwKICAgICAgICBtb3VudHM6IFsKICAgICAgICAgIFsnL3Byb3h5JywgJ2lwdjQ6MTI3LjAuMC4xOjIyJywgbnVsbCwgJ3Byb3h5LXdzLXJhdy13cyddLAogICAgICAgICAgWycvbHdzJywgJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jaC8nLCBudWxsLCAnJ10sCiAgICAgICAgICBbJy8nLCAnLicsICdkZWJ1Z2dlci5odG1sJ10sCiAgICAgICAgICBmdW5jdGlvbiogY29uZmlnKHJlcSwgcmVzKSB7CiAgICAgICAgICAgIGNvbnN0IHsgYm9keSwgaGVhZGVycyB9ID0gcmVxOwogICAgICAgICAgICBjb25zb2xlLmxvZygnL2NvbmZpZycsIHsgcmVxLCByZXMgfSk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCcqY29uZmlnJywgeyBib2R5LCBoZWFkZXJzIH0pOwogICAgICAgICAgICB5aWVsZCAne30nOwogICAgICAgICAgfSwKICAgICAgICAgIGZ1bmN0aW9uKiBmaWxlcyhyZXEsIHJlcykgewogICAgICAgICAgICBjb25zdCB7IGJvZHksIGhlYWRlcnMgfSA9IHJlcTsKICAgICAgICAgICAgeWllbGQgZnMKICAgICAgICAgICAgICAucmVhZGRpclN5bmMoJy4nKQogICAgICAgICAgICAgIC5zb3J0KCkKICAgICAgICAgICAgICAubWFwKGYgPT4gZiArICdcbicpCiAgICAgICAgICAgICAgLmpvaW4oJycpOwogICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgLi4udXJsLAogICAgICAgIC4uLmNhbGxiYWNrcywKICAgICAgICBibG9jazogZmFsc2UsCiAgICAgICAgb25Db25uZWN0KHdzLCByZXEpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdvbkNvbm5lY3QnLCB7IHdzLCByZXEgfSwgcmVxICYmIHJlcS5oZWFkZXJzKTsKCiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh3cywgewogICAgICAgICAgICBzZW5kTWVzc2FnZTogewogICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZW5kTWVzc2FnZShtc2cpIHsKICAgICAgICAgICAgICAgIGxldCByZXQgPSB0aGlzLnNlbmQoSlNPTi5zdHJpbmdpZnkobXNnKSk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgd3Muc2VuZE1lc3NhZ2UoYCwgbXNnLCBgKSA9ICR7cmV0fWApOwogICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRiZzogeyB2YWx1ZTogbnVsbCwgZW51bWVyYWJsZTogZmFsc2UgfQogICAgICAgICAgfSk7CgogICAgICAgICAgc29ja2V0cy5hZGQod3MpOwogICAgICAgIH0sCiAgICAgICAgb25DbG9zZSh3cykgewogICAgICAgICAgY29uc29sZS5sb2coJ29uQ2xvc2UnLCB3cyk7CiAgICAgICAgICBkYmcuY2xvc2UoKTsKCiAgICAgICAgICBwcm90b2NvbC5kZWxldGUod3MpOwogICAgICAgICAgc29ja2V0cy5kZWxldGUod3MpOwogICAgICAgIH0sCiAgICAgICAgb25FcnJvcih3cykgewogICAgICAgICAgY29uc29sZS5sb2coJ29uRXJyb3InLCB3cyk7CiAgICAgICAgfSwKICAgICAgICBvbkh0dHAocmVxLCByZXNwKSB7CiAgICAgICAgICBjb25zdCB7IG1ldGhvZCwgaGVhZGVycyB9ID0gcmVxOwogICAgICAgICAgY29uc29sZS5sb2coJ1x4MWJbMzg7NTszM21vbkh0dHBceDFiWzBtIFtcbiAgJywgcmVxLCAnLFxuICAnLCByZXNwLCAnXG5dJyk7CiAgICAgICAgICBjb25zdCB7IGJvZHksIHVybCB9ID0gcmVzcDsKICAgICAgICAgIGNvbnNvbGUubG9nKCdceDFiWzM4OzU7MzNtb25IdHRwXHgxYlswbScsIHsgYm9keSB9KTsKCiAgICAgICAgICBjb25zdCBmaWxlID0gdXJsLnBhdGguc2xpY2UoMSk7CiAgICAgICAgICBjb25zdCBkaXIgPSBmaWxlLnJlcGxhY2UoL1wvW15cL10qJC9nLCAnJyk7CgogICAgICAgICAgaWYoZmlsZS5lbmRzV2l0aCgnLmpzJykpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ29uSHR0cCcsIHsgZmlsZSwgZGlyIH0pOwogICAgICAgICAgICBjb25zdCByZSA9IC9eKFxzKihpbXxleClwb3J0W15cbl0qZnJvbSBbJyJdKShbXi4vJyJdKikoWyciXVxzKjtbXHQgXSpcbj8pL2dtOwoKICAgICAgICAgICAgcmVzcC5ib2R5ID0gYm9keS5yZXBsYWNlQWxsKHJlLCAobWF0Y2gsIHAxLCBwMCwgcDIsIHAzLCBvZmZzZXQpID0+IHsKICAgICAgICAgICAgICBpZighL1tcL1wuXS8udGVzdChwMikpIHsKICAgICAgICAgICAgICAgIGxldCBmbmFtZSA9IGAke3AyfS5qc2A7CgogICAgICAgICAgICAgICAgaWYoIWZzLmV4aXN0c1N5bmMoZGlyICsgJy8nICsgZm5hbWUpKSByZXR1cm4gYC8qICR7bWF0Y2h9ICovYDsKCiAgICAgICAgICAgICAgICBtYXRjaCA9IFtwMSwgJy4vJyArIGZuYW1lLCBwM10uam9pbignJyk7CgogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2FyZ3MnLCB7IG1hdGNoLCBwMSwgcDIsIHAzLCBvZmZzZXQgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiBtYXRjaDsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHJlc3A7CiAgICAgICAgfSwKICAgICAgICBvbk1lc3NhZ2Uod3MsIGRhdGEpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdvbk1lc3NhZ2UnLCB3cywgZGF0YSk7CiAgICAgICAgICAvLyBzaG93U2Vzc2lvbnMoKTsKCiAgICAgICAgICBoYW5kbGVDb21tYW5kKHdzLCBkYXRhKTsKCiAgICAgICAgICBmdW5jdGlvbiBoYW5kbGVDb21tYW5kKHdzLCBkYXRhKSB7CiAgICAgICAgICAgIGxldCBvYmogPSBKU09OLnBhcnNlKGRhdGEpOwoKICAgICAgICAgICAgY29uc3QgeyBjb21tYW5kLCAuLi5yZXN0IH0gPSBvYmo7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdvbk1lc3NhZ2UnLCBjb21tYW5kLCByZXN0KTsKICAgICAgICAgICAgY29uc3QgeyBjb25uZWN0ID0gdHJ1ZSwgYWRkcmVzcyA9ICcxMjcuMC4wLjE6JyArIE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqICg2NTUzNSAtIDEwMjQpKSArIDEwMjQsIGFyZ3MgPSBbXSB9ID0gcmVzdDsKCiAgICAgICAgICAgIHN3aXRjaCAoY29tbWFuZCkgewogICAgICAgICAgICAgIGNhc2UgJ3N0YXJ0JzogewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3dzJywgd3MpOwogICAgICAgICAgICAgICAgY2hpbGQgPSAvKndzLmNoaWxkID0gKi8gU3RhcnREZWJ1Z2dlcihhcmdzLCBjb25uZWN0LCBhZGRyZXNzKTsKICAgICAgICAgICAgICAgIGNvbnN0IFssIHN0ZG91dCwgc3RkZXJyXSA9IGNoaWxkLnN0ZGlvOwogICAgICAgICAgICAgICAgZm9yKGxldCBmZCBvZiBbc3Rkb3V0LCBzdGRlcnJdKSB7CiAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coYGZjbnRsKCR7ZmR9LCBGX0dFVEZMKWApOwogICAgICAgICAgICAgICAgICBsZXQgZmxhZ3MgPSBmY250bChmZCwgRl9HRVRGTCk7CiAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coYGZjbnRsKCR7ZmR9LCBGX1NFVEZMLCAweCR7ZmxhZ3MudG9TdHJpbmcoMTYpfSlgKTsKICAgICAgICAgICAgICAgICAgZmxhZ3MgfD0gT19OT05CTE9DSzsKICAgICAgICAgICAgICAgICAgZmNudGwoZmQsIEZfU0VURkwsIGZsYWdzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZvcihsZXQgaSA9IDE7IGkgPD0gMjsgaSsrKSB7CiAgICAgICAgICAgICAgICAgIGxldCBmZCA9IGNoaWxkLnN0ZGlvW2ldOwogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnb3Muc2V0UmVhZEhhbmRsZXInLCBmZCk7CiAgICAgICAgICAgICAgICAgIG9zLnNldFJlYWRIYW5kbGVyKGZkLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGJ1ZiA9IG5ldyBBcnJheUJ1ZmZlcigxMDI0KTsKICAgICAgICAgICAgICAgICAgICBsZXQgciA9IG9zLnJlYWQoZmQsIGJ1ZiwgMCwgYnVmLmJ5dGVMZW5ndGgpOwoKICAgICAgICAgICAgICAgICAgICBpZihyID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGEgPSB0b1N0cmluZyhidWYuc2xpY2UoMCwgcikpOwogICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhgcmVhZCgke2ZkfSwgYnVmKSA9ICR7cn0gKCR7cXVvdGUoZGF0YSwgIiciKX0pYCk7CgogICAgICAgICAgICAgICAgICAgICAgd3Muc2VuZE1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnb3V0cHV0JywKICAgICAgICAgICAgICAgICAgICAgICAgY2hhbm5lbDogWydzdGRvdXQnLCAnc3RkZXJyJ11baSAtIDFdLAogICAgICAgICAgICAgICAgICAgICAgICBkYXRhCiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NoaWxkJywgY2hpbGQucGlkKTsKCiAgICAgICAgICAgICAgICBvcy5zbGVlcCgxMDAwKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgY2FzZSAnY29ubmVjdCc6IHsKICAgICAgICAgICAgICAgIGRiZyA9IHdzLmRiZyA9IENvbm5lY3REZWJ1Z2dlcihhZGRyZXNzLCAoZGJnLCBzb2NrKSA9PiB7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd3YWl0KCkgPScsIGNoaWxkLndhaXQoKSk7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjaGlsZCcsIGNoaWxkKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgb3Muc2V0V3JpdGVIYW5kbGVyKCtkYmcsIGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgICAgb3Muc2V0V3JpdGVIYW5kbGVyKCtkYmcsIG51bGwpOwogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgY29ubmVjdGVkIHRvICR7YWRkcmVzc31gLCBkYmcpOwoKICAgICAgICAgICAgICAgICAgc29ja2V0cy5hZGQoZGJnKTsKCiAgICAgICAgICAgICAgICAgIGNvbnN0IGN3ZCA9IHByb2Nlc3MuY3dkKCk7CiAgICAgICAgICAgICAgICAgIHdzLnNlbmRNZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAncmVzcG9uc2UnLAogICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlOiB7CiAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kOiAnc3RhcnQnLAogICAgICAgICAgICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgICAgICAgICAgIGN3ZCwKICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3MKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgbGV0IG1zZzsKCiAgICAgICAgICAgICAgICAgIHdoaWxlKGRiZy5vcGVuKSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgIG1zZyA9IGF3YWl0IERlYnVnZ2VyUHJvdG9jb2wucmVhZChkYmcpOwogICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0RlYnVnZ2VyUHJvdG9jb2wucmVhZCgpID0nLCBlc2NhcGUobXNnKSk7CiAgICAgICAgICAgICAgICAgICAgICBpZih0eXBlb2YgbXNnID09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXQ7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldCA9IHdzLnNlbmQobXNnKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYHdzLnNlbmQoJHtxdW90ZShtc2csICInIil9KSA9ICR7cmV0fWApOwogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Nsb3NlZCBzb2NrZXQnLCBkYmcpOwogICAgICAgICAgICAgICAgICAgICAgICBzb2NrZXRzLmRlbGV0ZShkYmcpOwogICAgICAgICAgICAgICAgICAgICAgICB3cy5zZW5kTWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2VuZCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uOiAnY2xvc2VkJwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9IGNhdGNoKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7IG1lc3NhZ2UsIHN0YWNrIH0gPSBlcnJvcjsKICAgICAgICAgICAgICAgICAgICAgIHdzLnNlbmRNZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJywKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHsgbWVzc2FnZSwgc3RhY2sgfQogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICBkYmcuY2xvc2UoKTsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihtc2cgPT09IG51bGwpIGJyZWFrOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkYmcnLCBkYmcpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGNhc2UgJ2ZpbGUnOiB7CiAgICAgICAgICAgICAgICBjb25zdCB7IHBhdGggfSA9IHJlc3Q7CiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gZnMucmVhZEZpbGVTeW5jKHBhdGgsICd1dGYtOCcpOwogICAgICAgICAgICAgICAgLy93cy5zZW5kKEpTT04uc3RyaW5naWZ5KHsgdHlwZTogJ3Jlc3BvbnNlJywgcmVzcG9uc2U6IHsgY29tbWFuZDogJ2ZpbGUnLCBwYXRoLCBkYXRhIH0gfSkpOwoKICAgICAgICAgICAgICAgIGNvbnN0IGxleGVyID0gbmV3IExleGVyKGRhdGEsIHBhdGgpOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2xleGVyJywgbGV4ZXIpOwogICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSBbXTsKCiAgICAgICAgICAgICAgICBmb3IoOzspIHsKICAgICAgICAgICAgICAgICAgY29uc3QgeyBwb3MsIHNpemUgfSA9IGxleGVyOwogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbGV4ZXInLCB7IHBvcywgc2l6ZSB9KTsKICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGxleGVyLm5leHQoKTsKICAgICAgICAgICAgICAgICAgaWYocmVzdWx0LmRvbmUpIGJyZWFrOwogICAgICAgICAgICAgICAgICBjb25zdCB0b2tlbiA9IHJlc3VsdC52YWx1ZTsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3Rva2VuJywgewogICAgICAgICAgICAgICAgICAgIGxleGVtZTogdG9rZW4ubGV4ZW1lLAogICAgICAgICAgICAgICAgICAgIGlkOiB0b2tlbi5pZCwKICAgICAgICAgICAgICAgICAgICBsb2M6IHRva2VuLmxvYyArICcnCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBjb25zdCB7IHR5cGUsIGlkLCBsZXhlbWUsIGxvYyB9ID0gdG9rZW47CiAgICAgICAgICAgICAgICAgIGNvbnN0IHsgbGluZSwgY29sdW1uLCBmaWxlIH0gPSBsb2M7CiAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ3Rva2VuJywge2xleGVtZSxpZCxsaW5lfSk7CgogICAgICAgICAgICAgICAgICBpZighbGluZXNbbGluZSAtIDFdKSBsaW5lcy5wdXNoKFtdKTsKICAgICAgICAgICAgICAgICAgbGV0IGEgPSBsaW5lc1tsaW5lIC0gMV07CiAgICAgICAgICAgICAgICAgIGEucHVzaChbbGV4ZW1lLCBpZF0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2xpbmVzJywgbGluZXMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGRlZmF1bHQ6IHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzZW5kIHRvIGRlYnVnZ2VyJywgZGF0YSk7CiAgICAgICAgICAgICAgICBEZWJ1Z2dlclByb3RvY29sLnNlbmQoZGJnLCBkYXRhKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgLypsZXQgcCA9IG5ldyBEZWJ1Z2dlclByb3RvY29sKCk7CiAgICAgICAgcHJvdG9jb2wuc2V0KHdzLCBwKTsqLwogICAgICAgIH0sCiAgICAgICAgb25GZChmZCwgcmQsIHdyKSB7CiAgICAgICAgICAvL2NvbnNvbGUubG9nKCdvbkZkJywgeyBmZCwgcmQsIHdyIH0pOwogICAgICAgICAgb3Muc2V0UmVhZEhhbmRsZXIoZmQsIHJkKTsKICAgICAgICAgIG9zLnNldFdyaXRlSGFuZGxlcihmZCwgd3IpOwogICAgICAgIH0sCiAgICAgICAgLi4uKHVybCAmJiB1cmwuaG9zdCA/IHVybCA6IHt9KQogICAgICB9KQogICAgKTsKICB9KTsKICBjb25zb2xlLmxvZygnWFgnKTsKCiAgLyogIGRlZmluZShnbG9iYWxUaGlzLCB7CiAgICBnZXQgY29ubmVjdGlvbnMoKSB7CiAgICAgIHJldHVybiBbLi4uZ2xvYmFsVGhpcy5zb2NrZXRzXTsKICAgIH0sCiAgICBnZXQgc29ja2xpc3QoKSB7CiAgICAgIHJldHVybiBbLi4uZ2xvYmFsVGhpcy5zb2NrZXRzXTsKICAgIH0sCiAgICBuZXQ6IHsgc2V0TG9nLCBMTExfVVNFUiwgTExMX05PVElDRSwgTExMX1dBUk4sIGNsaWVudCwgc2VydmVyIH0sCiAgICBTdGFydERlYnVnZ2VyLAogICAgQ29ubmVjdERlYnVnZ2VyLAogICAgRGVidWdnZXJQcm90b2NvbCwKICAgIHJlcGw6IFN0YXJ0UkVQTCgpLAogICAgZGFlbW9uKCkgewogICAgICByZXBsLnN0b3AoKTsKICAgICAgc3RkLnB1dHMoJ1xuZGV0YWNoaW5nLi4uJyk7CiAgICAgIGRhZW1vbigxLCAwKTsKICAgICAgc3RkLnB1dHMoJyBQSUQgJyArIGdldHBpZCgpICsgJ1xuJyk7CiAgICB9CiAgfSk7CiovCiAgZGVsZXRlIGdsb2JhbFRoaXMuREVCVUc7CgogIGxldCBpbnB1dEJ1ZiA9IG5ldyBBcnJheUJ1ZmZlcigxMCk7CiAgb3MudHR5U2V0UmF3KDApOwoKICBvcy5zZXRSZWFkSGFuZGxlcigwLCAoKSA9PiB7CiAgICBsZXQgciA9IGZzLnJlYWRTeW5jKDAsIGlucHV0QnVmLCAwLCBpbnB1dEJ1Zi5ieXRlTGVuZ3RoKTsKCiAgICBpZihyID4gMCkgewogICAgICBsZXQgYSA9IG5ldyBVaW50OEFycmF5KGlucHV0QnVmLnNsaWNlKDAsIHIpKTsKCiAgICAgIC8vY29uc29sZS5sb2coJ2EnLCBhKTsKCiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBhLmxlbmd0aDsgaSsrKSBpZihhW2ldID09IDEzKSBhW2ldID0gMTA7CgogICAgICBpZihhLmxlbmd0aCA9PSAxICYmIGFbMF0gPT0gMTI3KSBhID0gbmV3IFVpbnQ4QXJyYXkoWzgsIDB4MjAsIDhdKTsKCiAgICAgIGlmKGEubGVuZ3RoID09IDEgJiYgYVswXSA9PSAyNykgc2hvd1Nlc3Npb25zKCk7CiAgICAgIGVsc2UgZnMud3JpdGVTeW5jKDEsIGEuYnVmZmVyKTsKICAgIH0KICB9KTsKCiAgZnVuY3Rpb24gc2hvd1Nlc3Npb25zKCkgewogICAgbGV0IHNlc3Npb25zID0gZ2V0U2Vzc2lvbnMoKTsKICAgIGNvbnNvbGUubG9nKCdzZXNzaW9ucycsIGNvbnNvbGUuY29uZmlnKHsgbWF4QXJyYXlMZW5ndGg6IEluZmluaXR5LCBkZXB0aDogNCwgY3VzdG9tSW5zcGVjdDogdHJ1ZSwgY29tcGFjdDogMSB9KSwgc2Vzc2lvbnMpOwogIH0KCiAgLy9zZXRJbnRlcnZhbCgoKSA9PiBjb25zb2xlLmxvZygnaW50ZXJ2YWwnKSwgNTAwMCk7CgogIGdsb2JhbFRoaXMud3MgPSBjcmVhdGVXUyhgd3NzOi8vJHthZGRyZXNzfTo4OTk4L3dzYCwge30sIHRydWUpOwogIC8vICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZ2xvYmFsVGhpcywgJ0RFQlVHJywgeyBnZXQ6IERlYnVnRmxhZ3MgfSk7CgogIC8qIGlmKGxpc3RlbikgY2xpLmxpc3RlbihjcmVhdGVXUywgb3MpOwogIGVsc2UgY2xpLmNvbm5lY3QoY3JlYXRlV1MsIG9zKTsKKi8KICBmdW5jdGlvbiBxdWl0KHdoeSkgewogICAgY29uc29sZS5sb2coYHF1aXQoJyR7d2h5fScpYCk7CgogICAgbGV0IGNmZyA9IHsgaW5zcGVjdE9wdGlvbnM6IGNvbnNvbGUub3B0aW9ucyB9OwogICAgV3JpdGVKU09OKGAuJHtiYXNlfS1jb25maWdgLCBjZmcpOwogICAgLy8gcmVwbC5jbGVhbnVwKHdoeSk7CiAgfQp9Cgp0cnkgewogIG1haW4oLi4uc2NyaXB0QXJncy5zbGljZSgxKSk7Cn0gY2F0Y2goZXJyb3IpIHsKICBjb25zb2xlLmxvZyhgRkFJTDogJHtlcnJvcj8ubWVzc2FnZSA/PyBlcnJvcn1cbiR7ZXJyb3I/LnN0YWNrfWApOwp9IGZpbmFsbHkgewogIC8vY29uc29sZS5sb2coJ1NVQ0NFU1MnKTsKfQoAAAAAAAAAAN86AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA+TgAAAAAAAD5OAAAAAAAAAAAAAAAAPC/"
				],
				[
					39,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAADfOgAAaW1wb3J0ICogYXMgc3RkIGZyb20gJ3N0ZCc7CmltcG9ydCAqIGFzIG9zIGZyb20gJ29zJzsKaW1wb3J0IHsgc2V0SW50ZXJ2YWwgfSBmcm9tICd0aW1lcnMnOwppbXBvcnQgKiBhcyBmcm9tICcuL2xpYi9kZWVwLmpzJzsKaW1wb3J0ICogYXMgcGF0aCBmcm9tICcuL2xpYi9wYXRoLmpzJzsKaW1wb3J0IHsgZGFlbW9uLCBhdGV4aXQsIGdldHBpZCwgdG9TdHJpbmcsIGVzY2FwZSwgcXVvdGUsIGRlZmluZSwgZXh0ZW5kQXJyYXksIGdldE9wdCB9IGZyb20gJ3V0aWwnOwppbXBvcnQgeyBDb25zb2xlIH0gZnJvbSAnLi9xdWlja2pzL3Fqcy1tb2R1bGVzL2xpYi9jb25zb2xlLmpzJzsKaW1wb3J0IFJFUEwgZnJvbSAnLi9xdWlja2pzL3Fqcy1tb2R1bGVzL2xpYi9yZXBsLmpzJzsKaW1wb3J0ICogYXMgZnJvbSAnLi90ZXJtaW5hbC5qcyc7CmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJzsKaW1wb3J0IHsgc2V0TG9nLCBsb2dMZXZlbHMsIGdldFNlc3Npb25zLCBMTExfVVNFUiwgTExMX0lORk8sIExMTF9OT1RJQ0UsIExMTF9XQVJOLCBjbGllbnQsIHNlcnZlciB9IGZyb20gJ25ldCc7CmltcG9ydCB7IERlYnVnZ2VyUHJvdG9jb2wgfSBmcm9tICcuL2RlYnVnZ2VycHJvdG9jb2wuanMnOwppbXBvcnQgeyBTdGFydERlYnVnZ2VyLCBDb25uZWN0RGVidWdnZXIgfSBmcm9tICcuL2RlYnVnZ2VyLmpzJzsKaW1wb3J0IHsgZmNudGwsIEZfR0VURkwsIEZfU0VURkwsIE9fTk9OQkxPQ0sgfSBmcm9tICcuL3F1aWNranMvcWpzLWZmaS9saWIvZmNudGwuanMnOwppbXBvcnQgeyBSZWFkSlNPTiwgV3JpdGVKU09OIH0gZnJvbSAnLi9pby1oZWxwZXJzLmpzJzsKCmV4dGVuZEFycmF5KEFycmF5LnByb3RvdHlwZSk7Cgpjb25zdCBzY3JpcHROYW1lID0gKGFyZyA9IHNjcmlwdEFyZ3NbMF0pID0+IHBhdGguYmFzZW5hbWUoYXJnLCBwYXRoLmV4dG5hbWUoYXJnKSk7CgphdGV4aXQoKCkgPT4gewogIGNvbnNvbGUubG9nKCdhdGV4aXQnLCBhdGV4aXQpOwogIGxldCBzdGFjayA9IG5ldyBFcnJvcignJykuc3RhY2s7CiAgY29uc29sZS5sb2coJ3N0YWNrOicsIHN0YWNrKTsKfSk7CgpmdW5jdGlvbiBTdGFydFJFUEwocHJlZml4ID0gc2NyaXB0TmFtZSgpLCBzdWZmaXggPSAnJykgewogIGxldCByZXBsID0gbmV3IFJFUEwoYFx4MWJbMzg7NTsxNjVtJHtwcmVmaXh9IFx4MWJbMzg7NTszOW0ke3N1ZmZpeH1ceDFiWzBtYCwgZmFsc2UpOwogIHJlcGwuaGlzdG9yeUxvYWQobnVsbCwgZnMpOwogIHJlcGwubG9hZFNhdmVPcHRpb25zKCk7CiAgcmVwbC5pbnNwZWN0T3B0aW9ucyA9IHsgLi4uY29uc29sZS5vcHRpb25zLCBtYXhBcnJheUxlbmd0aDogSW5maW5pdHksIGNvbXBhY3Q6IDIgfTsKICBsZXQgeyBsb2cgfSA9IGNvbnNvbGU7CgogIHJlcGwuZGlyZWN0aXZlcy5pID0gWwogICAgbmFtZSA9PgogICAgICBpbXBvcnQobmFtZSkKICAgICAgICAudGhlbihtID0+IChnbG9iYWxUaGlzW25hbWUucmVwbGFjZSgvKC4qXC98XC5bXlwvLl0rJCkvZywgJycpXSA9IG0pKQogICAgICAgIC5jYXRjaCgoKSA9PiByZXBsLnByaW50U3RhdHVzKGBFUlJPUjogbW9kdWxlICcke25hbWV9JyBub3QgZm91bmRgKSksCiAgICAnaW1wb3J0IGEgbW9kdWxlJwogIF07CiAgcmVwbC5kaXJlY3RpdmVzLmQgPSBbKCkgPT4gZ2xvYmFsVGhpcy5kYWVtb24oKSwgJ2RldGFjaCddOwogIGNvbnNvbGUubG9nID0gcmVwbC5wcmludEZ1bmN0aW9uKCguLi5hcmdzKSA9PiB7CiAgICBsb2coJ0xPRycsIGNvbnNvbGUuY29uZmlnKHJlcGwuaW5zcGVjdE9wdGlvbnMpLCAuLi5hcmdzKTsKICB9KTsKICByZXBsLnJ1bigpOwogIHJldHVybiByZXBsOwp9CgpmdW5jdGlvbiBtYWluKC4uLmFyZ3MpIHsKICBjb25zdCBiYXNlID0gc2NyaXB0TmFtZSgpLnJlcGxhY2UoL1wuW2Etel0qJC8sICcnKTsKCiAgY29uc3QgY29uZmlnID0gUmVhZEpTT04oYC4ke2Jhc2V9LWNvbmZpZ2ApID8/IHt9OwoKICBnbG9iYWxUaGlzLmNvbnNvbGUgPSBuZXcgQ29uc29sZShzdGQuZXJyLCB7CiAgICBpbnNwZWN0T3B0aW9uczogeyBkZXB0aDogSW5maW5pdHksIGNvbXBhY3Q6IDIsIG1heEFycmF5TGVuZ3RoOiBJbmZpbml0eSwgY3VzdG9tSW5zcGVjdDogdHJ1ZSB9CiAgfSk7CgogIGxldCBwYXJhbXMgPSBnZXRPcHQoCiAgICB7CiAgICAgIHZlcmJvc2U6IFtmYWxzZSwgKGEsIHYpID0+ICh2IHwgMCkgKyAxLCAndiddLAogICAgICBsaXN0ZW46IFtmYWxzZSwgbnVsbCwgJ2wnXSwKICAgICAgY29ubmVjdDogW2ZhbHNlLCBudWxsLCAnYyddLAogICAgICBjbGllbnQ6IFtmYWxzZSwgbnVsbCwgJ0MnXSwKICAgICAgc2VydmVyOiBbZmFsc2UsIG51bGwsICdTJ10sCiAgICAgIGRlYnVnOiBbZmFsc2UsIG51bGwsICd4J10sCiAgICAgIHRsczogW2ZhbHNlLCAodiwgcHYsIG8pID0+ICgoby50bHMgPSB0cnVlKSwgdHJ1ZSksICd0J10sCiAgICAgICduby10bHMnOiBbZmFsc2UsICh2LCBwdiwgbykgPT4gKChvLnRscyA9IGZhbHNlKSwgdHJ1ZSksICdUJ10sCiAgICAgIGFkZHJlc3M6IFt0cnVlLCBudWxsLCAnYSddLAogICAgICBwb3J0OiBbdHJ1ZSwgbnVsbCwgJ3AnXSwKICAgICAgcXVpZXQ6IFtmYWxzZSwgbnVsbCwgJ3EnXSwKICAgICAgJ3NzbC1jZXJ0JzogW3RydWUsIG51bGxdLAogICAgICAnc3NsLXByaXZhdGUta2V5JzogW3RydWUsIG51bGxdLAogICAgICAnc3NsLWNhJzogW3RydWUsIG51bGxdLAogICAgICAnQCc6ICdhZGRyZXNzLHBvcnQnCiAgICB9LAogICAgYXJncwogICk7CiAgaWYocGFyYW1zWyduby10bHMnXSA9PT0gdHJ1ZSkgcGFyYW1zLnRscyA9IGZhbHNlOwogIGNvbnN0IHsKICAgIGFkZHJlc3MgPSAnMC4wLjAuMCcsCiAgICBwb3J0ID0gODk5OSwKICAgICdzc2wtY2VydCc6IHNzbENlcnQgPSAnbG9jYWxob3N0LmNydCcsCiAgICAnc3NsLXByaXZhdGUta2V5Jzogc3NsUHJpdmF0ZUtleSA9ICdsb2NhbGhvc3Qua2V5JywKICAgICdzc2wtY2EnOiBzc2xDQSA9ICcvZXRjL3NzbC9jZXJ0cy9jYS1jZXJ0aWZpY2F0ZXMuY3J0JywKICAgIHF1aWV0ID0gZmFsc2UsCiAgICBkZWJ1ZyA9IGZhbHNlLAogICAgdGxzID0gdHJ1ZQogIH0gPSBwYXJhbXM7CiAgY29uc3QgbGlzdGVuID0gcGFyYW1zLmNvbm5lY3QgJiYgIXBhcmFtcy5saXN0ZW4gPyBmYWxzZSA6IHRydWU7CiAgLy9jb25zdCBzZXJ2ZXIgPSAhcGFyYW1zLmNsaWVudCB8fCBwYXJhbXMuc2VydmVyOwogIGxldCBuYW1lID0gc2NyaXB0QXJnc1swXTsKICBuYW1lID0gbmFtZQogICAgLnJlcGxhY2UoLy4qXC8vLCAnJykKICAgIC5yZXBsYWNlKC8tL2csICcgJykKICAgIC5yZXBsYWNlKC9cLlteXC8uXSokLywgJycpOwoKICBsZXQgW3ByZWZpeCwgc3VmZml4XSA9IG5hbWUuc3BsaXQoJyAnKTsKCiAgbGV0IHByb3RvY29sID0gbmV3IFdlYWtNYXAoKTsKCiAgbGV0IHNvY2tldHMgPSAoZ2xvYmFsVGhpcy5zb2NrZXRzID8/PSBuZXcgU2V0KCkpOwoKICBjb25zdCBjcmVhdGVXUyA9IChnbG9iYWxUaGlzLmNyZWF0ZVdTID0gKHVybCwgY2FsbGJhY2tzLCBsaXN0ZW4pID0+IHsKICAgIGNvbnNvbGUubG9nKCdjcmVhdGVXUycsIHsgdXJsLCBjYWxsYmFja3MsIGxpc3RlbiB9KTsKCiAgICBzZXRMb2coCiAgICAgIHF1aWV0ID8gMCA6IExMTF9VU0VSIHwgKCgoZGVidWcgPyBMTExfSU5GTyA6IExMTF9XQVJOKSA8PCAxKSAtIDEpLAogICAgICBxdWlldCB8fCAhcGFyYW1zLmRlYnVnCiAgICAgICAgPyAoKSA9PiB7fQogICAgICAgIDogKGxldmVsLCBzdHIpID0+IHsKICAgICAgICAgICAgaWYoL0JJTkRfUFJPVE9DT0x8RFJPUF9QUk9UT0NPTHxDSEVDS19BQ0NFU1NfUklHSFRTfEFERF9IRUFERVJTLy50ZXN0KHN0cikpIHJldHVybjsKICAgICAgICAgICAgY29uc29sZS5sb2cobG9nTGV2ZWxzW2xldmVsXS5wYWRFbmQoMTApLCBzdHIudHJpbSgpKTsKICAgICAgICAgIH0KICAgICk7CgogICAgbGV0IG9wdGlvbnM7CiAgICBsZXQgY2hpbGQsIGRiZzsKICAgIGxldCBuZXRmbiA9IFtjbGllbnQsIHNlcnZlcl1bK2xpc3Rlbl07CiAgICBjb25zb2xlLmxvZygnY3JlYXRlV1MnLCB7IHVybCwgbmV0Zm4gfSk7CiAgICByZXR1cm4gbmV0Zm4oCiAgICAgIHVybCwKICAgICAgKG9wdGlvbnMgPSB7CiAgICAgICAgdGxzOiBwYXJhbXMudGxzLAogICAgICAgIHNzbENlcnQsCiAgICAgICAgc3NsUHJpdmF0ZUtleSwKICAgICAgICBzc2xDQSwKICAgICAgICBtaW1ldHlwZXM6IFsKICAgICAgICAgIFsnLnN2Z3onLCAnYXBwbGljYXRpb24vZ3ppcCddLAogICAgICAgICAgWycubWpzJywgJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnXSwKICAgICAgICAgIFsnLmVzJywgJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnXSwKICAgICAgICAgIFsnLndhc20nLCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJ10sCiAgICAgICAgICBbJy5lb3QnLCAnYXBwbGljYXRpb24vdm5kLm1zLWZvbnRvYmplY3QnXSwKICAgICAgICAgIFsnLmxpYicsICdhcHBsaWNhdGlvbi94LWFyY2hpdmUnXSwKICAgICAgICAgIFsnLmJ6MicsICdhcHBsaWNhdGlvbi94LWJ6aXAyJ10sCiAgICAgICAgICBbJy5naXRpZ25vcmUnLCAndGV4dC9wbGFpbiddLAogICAgICAgICAgWycuY21ha2UnLCAndGV4dC9wbGFpbiddLAogICAgICAgICAgWycuaGV4JywgJ3RleHQvcGxhaW4nXSwKICAgICAgICAgIFsnLm1kJywgJ3RleHQvcGxhaW4nXSwKICAgICAgICAgIFsnLnBieHByb2onLCAndGV4dC9wbGFpbiddLAogICAgICAgICAgWycud2F0JywgJ3RleHQvcGxhaW4nXSwKICAgICAgICAgIFsnLmMnLCAndGV4dC94LWMnXSwKICAgICAgICAgIFsnLmgnLCAndGV4dC94LWMnXSwKICAgICAgICAgIFsnLmNwcCcsICd0ZXh0L3gtYysrJ10sCiAgICAgICAgICBbJy5ocHAnLCAndGV4dC94LWMrKyddLAogICAgICAgICAgWycuZmlsdGVycycsICd0ZXh0L3htbCddLAogICAgICAgICAgWycucGxpc3QnLCAndGV4dC94bWwnXSwKICAgICAgICAgIFsnLnN0b3J5Ym9hcmQnLCAndGV4dC94bWwnXSwKICAgICAgICAgIFsnLnZjeHByb2onLCAndGV4dC94bWwnXSwKICAgICAgICAgIFsnLmJhdCcsICd0ZXh0L3gtbXNkb3MtYmF0Y2gnXSwKICAgICAgICAgIFsnLm1tJywgJ3RleHQveC1vYmplY3RpdmUtYyddLAogICAgICAgICAgWycubScsICd0ZXh0L3gtb2JqZWN0aXZlLWMnXSwKICAgICAgICAgIFsnLnNoJywgJ3RleHQveC1zaGVsbHNjcmlwdCddCiAgICAgICAgXSwKICAgICAgICBtb3VudHM6IFsKICAgICAgICAgIFsnL3Byb3h5JywgJ2lwdjQ6MTI3LjAuMC4xOjIyJywgbnVsbCwgJ3Byb3h5LXdzLXJhdy13cyddLAogICAgICAgICAgWycvbHdzJywgJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jaC8nLCBudWxsLCAnJ10sCiAgICAgICAgICBbJy8nLCAnLicsICdkZWJ1Z2dlci5odG1sJ10sCiAgICAgICAgICBmdW5jdGlvbiogY29uZmlnKHJlcSwgcmVzKSB7CiAgICAgICAgICAgIGNvbnN0IHsgYm9keSwgaGVhZGVycyB9ID0gcmVxOwogICAgICAgICAgICBjb25zb2xlLmxvZygnL2NvbmZpZycsIHsgcmVxLCByZXMgfSk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCcqY29uZmlnJywgeyBib2R5LCBoZWFkZXJzIH0pOwogICAgICAgICAgICB5aWVsZCAne30nOwogICAgICAgICAgfSwKICAgICAgICAgIGZ1bmN0aW9uKiBmaWxlcyhyZXEsIHJlcykgewogICAgICAgICAgICBjb25zdCB7IGJvZHksIGhlYWRlcnMgfSA9IHJlcTsKICAgICAgICAgICAgeWllbGQgZnMKICAgICAgICAgICAgICAucmVhZGRpclN5bmMoJy4nKQogICAgICAgICAgICAgIC5zb3J0KCkKICAgICAgICAgICAgICAubWFwKGYgPT4gZiArICdcbicpCiAgICAgICAgICAgICAgLmpvaW4oJycpOwogICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgLi4udXJsLAogICAgICAgIC4uLmNhbGxiYWNrcywKICAgICAgICBibG9jazogZmFsc2UsCiAgICAgICAgb25Db25uZWN0KHdzLCByZXEpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdvbkNvbm5lY3QnLCB7IHdzLCByZXEgfSwgcmVxICYmIHJlcS5oZWFkZXJzKTsKCiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh3cywgewogICAgICAgICAgICBzZW5kTWVzc2FnZTogewogICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZW5kTWVzc2FnZShtc2cpIHsKICAgICAgICAgICAgICAgIGxldCByZXQgPSB0aGlzLnNlbmQoSlNPTi5zdHJpbmdpZnkobXNnKSk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgd3Muc2VuZE1lc3NhZ2UoYCwgbXNnLCBgKSA9ICR7cmV0fWApOwogICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRiZzogeyB2YWx1ZTogbnVsbCwgZW51bWVyYWJsZTogZmFsc2UgfQogICAgICAgICAgfSk7CgogICAgICAgICAgc29ja2V0cy5hZGQod3MpOwogICAgICAgIH0sCiAgICAgICAgb25DbG9zZSh3cykgewogICAgICAgICAgY29uc29sZS5sb2coJ29uQ2xvc2UnLCB3cyk7CiAgICAgICAgICBkYmcuY2xvc2UoKTsKCiAgICAgICAgICBwcm90b2NvbC5kZWxldGUod3MpOwogICAgICAgICAgc29ja2V0cy5kZWxldGUod3MpOwogICAgICAgIH0sCiAgICAgICAgb25FcnJvcih3cykgewogICAgICAgICAgY29uc29sZS5sb2coJ29uRXJyb3InLCB3cyk7CiAgICAgICAgfSwKICAgICAgICBvbkh0dHAocmVxLCByZXNwKSB7CiAgICAgICAgICBjb25zdCB7IG1ldGhvZCwgaGVhZGVycyB9ID0gcmVxOwogICAgICAgICAgY29uc29sZS5sb2coJ1x4MWJbMzg7NTszM21vbkh0dHBceDFiWzBtIFtcbiAgJywgcmVxLCAnLFxuICAnLCByZXNwLCAnXG5dJyk7CiAgICAgICAgICBjb25zdCB7IGJvZHksIHVybCB9ID0gcmVzcDsKICAgICAgICAgIGNvbnNvbGUubG9nKCdceDFiWzM4OzU7MzNtb25IdHRwXHgxYlswbScsIHsgYm9keSB9KTsKCiAgICAgICAgICBjb25zdCBmaWxlID0gdXJsLnBhdGguc2xpY2UoMSk7CiAgICAgICAgICBjb25zdCBkaXIgPSBmaWxlLnJlcGxhY2UoL1wvW15cL10qJC9nLCAnJyk7CgogICAgICAgICAgaWYoZmlsZS5lbmRzV2l0aCgnLmpzJykpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ29uSHR0cCcsIHsgZmlsZSwgZGlyIH0pOwogICAgICAgICAgICBjb25zdCByZSA9IC9eKFxzKihpbXxleClwb3J0W15cbl0qZnJvbSBbJyJdKShbXi4vJyJdKikoWyciXVxzKjtbXHQgXSpcbj8pL2dtOwoKICAgICAgICAgICAgcmVzcC5ib2R5ID0gYm9keS5yZXBsYWNlQWxsKHJlLCAobWF0Y2gsIHAxLCBwMCwgcDIsIHAzLCBvZmZzZXQpID0+IHsKICAgICAgICAgICAgICBpZighL1tcL1wuXS8udGVzdChwMikpIHsKICAgICAgICAgICAgICAgIGxldCBmbmFtZSA9IGAke3AyfS5qc2A7CgogICAgICAgICAgICAgICAgaWYoIWZzLmV4aXN0c1N5bmMoZGlyICsgJy8nICsgZm5hbWUpKSByZXR1cm4gYC8qICR7bWF0Y2h9ICovYDsKCiAgICAgICAgICAgICAgICBtYXRjaCA9IFtwMSwgJy4vJyArIGZuYW1lLCBwM10uam9pbignJyk7CgogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2FyZ3MnLCB7IG1hdGNoLCBwMSwgcDIsIHAzLCBvZmZzZXQgfSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiBtYXRjaDsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHJlc3A7CiAgICAgICAgfSwKICAgICAgICBvbk1lc3NhZ2Uod3MsIGRhdGEpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdvbk1lc3NhZ2UnLCB3cywgZGF0YSk7CiAgICAgICAgICAvLyBzaG93U2Vzc2lvbnMoKTsKCiAgICAgICAgICBoYW5kbGVDb21tYW5kKHdzLCBkYXRhKTsKCiAgICAgICAgICBmdW5jdGlvbiBoYW5kbGVDb21tYW5kKHdzLCBkYXRhKSB7CiAgICAgICAgICAgIGxldCBvYmogPSBKU09OLnBhcnNlKGRhdGEpOwoKICAgICAgICAgICAgY29uc3QgeyBjb21tYW5kLCAuLi5yZXN0IH0gPSBvYmo7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCdvbk1lc3NhZ2UnLCBjb21tYW5kLCByZXN0KTsKICAgICAgICAgICAgY29uc3QgeyBjb25uZWN0ID0gdHJ1ZSwgYWRkcmVzcyA9ICcxMjcuMC4wLjE6JyArIE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqICg2NTUzNSAtIDEwMjQpKSArIDEwMjQsIGFyZ3MgPSBbXSB9ID0gcmVzdDsKCiAgICAgICAgICAgIHN3aXRjaCAoY29tbWFuZCkgewogICAgICAgICAgICAgIGNhc2UgJ3N0YXJ0JzogewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3dzJywgd3MpOwogICAgICAgICAgICAgICAgY2hpbGQgPSAvKndzLmNoaWxkID0gKi8gU3RhcnREZWJ1Z2dlcihhcmdzLCBjb25uZWN0LCBhZGRyZXNzKTsKICAgICAgICAgICAgICAgIGNvbnN0IFssIHN0ZG91dCwgc3RkZXJyXSA9IGNoaWxkLnN0ZGlvOwogICAgICAgICAgICAgICAgZm9yKGxldCBmZCBvZiBbc3Rkb3V0LCBzdGRlcnJdKSB7CiAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coYGZjbnRsKCR7ZmR9LCBGX0dFVEZMKWApOwogICAgICAgICAgICAgICAgICBsZXQgZmxhZ3MgPSBmY250bChmZCwgRl9HRVRGTCk7CiAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coYGZjbnRsKCR7ZmR9LCBGX1NFVEZMLCAweCR7ZmxhZ3MudG9TdHJpbmcoMTYpfSlgKTsKICAgICAgICAgICAgICAgICAgZmxhZ3MgfD0gT19OT05CTE9DSzsKICAgICAgICAgICAgICAgICAgZmNudGwoZmQsIEZfU0VURkwsIGZsYWdzKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZvcihsZXQgaSA9IDE7IGkgPD0gMjsgaSsrKSB7CiAgICAgICAgICAgICAgICAgIGxldCBmZCA9IGNoaWxkLnN0ZGlvW2ldOwogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnb3Muc2V0UmVhZEhhbmRsZXInLCBmZCk7CiAgICAgICAgICAgICAgICAgIG9zLnNldFJlYWRIYW5kbGVyKGZkLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGJ1ZiA9IG5ldyBBcnJheUJ1ZmZlcigxMDI0KTsKICAgICAgICAgICAgICAgICAgICBsZXQgciA9IG9zLnJlYWQoZmQsIGJ1ZiwgMCwgYnVmLmJ5dGVMZW5ndGgpOwoKICAgICAgICAgICAgICAgICAgICBpZihyID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGEgPSB0b1N0cmluZyhidWYuc2xpY2UoMCwgcikpOwogICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhgcmVhZCgke2ZkfSwgYnVmKSA9ICR7cn0gKCR7cXVvdGUoZGF0YSwgIiciKX0pYCk7CgogICAgICAgICAgICAgICAgICAgICAgd3Muc2VuZE1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnb3V0cHV0JywKICAgICAgICAgICAgICAgICAgICAgICAgY2hhbm5lbDogWydzdGRvdXQnLCAnc3RkZXJyJ11baSAtIDFdLAogICAgICAgICAgICAgICAgICAgICAgICBkYXRhCiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NoaWxkJywgY2hpbGQucGlkKTsKCiAgICAgICAgICAgICAgICBvcy5zbGVlcCgxMDAwKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgY2FzZSAnY29ubmVjdCc6IHsKICAgICAgICAgICAgICAgIGRiZyA9IHdzLmRiZyA9IENvbm5lY3REZWJ1Z2dlcihhZGRyZXNzLCAoZGJnLCBzb2NrKSA9PiB7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd3YWl0KCkgPScsIGNoaWxkLndhaXQoKSk7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjaGlsZCcsIGNoaWxkKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgb3Muc2V0V3JpdGVIYW5kbGVyKCtkYmcsIGFzeW5jICgpID0+IHsKICAgICAgICAgICAgICAgICAgb3Muc2V0V3JpdGVIYW5kbGVyKCtkYmcsIG51bGwpOwogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgY29ubmVjdGVkIHRvICR7YWRkcmVzc31gLCBkYmcpOwoKICAgICAgICAgICAgICAgICAgc29ja2V0cy5hZGQoZGJnKTsKCiAgICAgICAgICAgICAgICAgIGNvbnN0IGN3ZCA9IHByb2Nlc3MuY3dkKCk7CiAgICAgICAgICAgICAgICAgIHdzLnNlbmRNZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAncmVzcG9uc2UnLAogICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlOiB7CiAgICAgICAgICAgICAgICAgICAgICBjb21tYW5kOiAnc3RhcnQnLAogICAgICAgICAgICAgICAgICAgICAgYXJncywKICAgICAgICAgICAgICAgICAgICAgIGN3ZCwKICAgICAgICAgICAgICAgICAgICAgIGFkZHJlc3MKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgbGV0IG1zZzsKCiAgICAgICAgICAgICAgICAgIHdoaWxlKGRiZy5vcGVuKSB7CiAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgIG1zZyA9IGF3YWl0IERlYnVnZ2VyUHJvdG9jb2wucmVhZChkYmcpOwogICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0RlYnVnZ2VyUHJvdG9jb2wucmVhZCgpID0nLCBlc2NhcGUobXNnKSk7CiAgICAgICAgICAgICAgICAgICAgICBpZih0eXBlb2YgbXNnID09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByZXQ7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldCA9IHdzLnNlbmQobXNnKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coYHdzLnNlbmQoJHtxdW90ZShtc2csICInIil9KSA9ICR7cmV0fWApOwogICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Nsb3NlZCBzb2NrZXQnLCBkYmcpOwogICAgICAgICAgICAgICAgICAgICAgICBzb2NrZXRzLmRlbGV0ZShkYmcpOwogICAgICAgICAgICAgICAgICAgICAgICB3cy5zZW5kTWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2VuZCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhc29uOiAnY2xvc2VkJwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9IGNhdGNoKGVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICBjb25zdCB7IG1lc3NhZ2UsIHN0YWNrIH0gPSBlcnJvcjsKICAgICAgICAgICAgICAgICAgICAgIHdzLnNlbmRNZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJywKICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IHsgbWVzc2FnZSwgc3RhY2sgfQogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICBkYmcuY2xvc2UoKTsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZihtc2cgPT09IG51bGwpIGJyZWFrOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkYmcnLCBkYmcpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGNhc2UgJ2ZpbGUnOiB7CiAgICAgICAgICAgICAgICBjb25zdCB7IHBhdGggfSA9IHJlc3Q7CiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gZnMucmVhZEZpbGVTeW5jKHBhdGgsICd1dGYtOCcpOwogICAgICAgICAgICAgICAgLy93cy5zZW5kKEpTT04uc3RyaW5naWZ5KHsgdHlwZTogJ3Jlc3BvbnNlJywgcmVzcG9uc2U6IHsgY29tbWFuZDogJ2ZpbGUnLCBwYXRoLCBkYXRhIH0gfSkpOwoKICAgICAgICAgICAgICAgIGNvbnN0IGxleGVyID0gbmV3IExleGVyKGRhdGEsIHBhdGgpOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2xleGVyJywgbGV4ZXIpOwogICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSBbXTsKCiAgICAgICAgICAgICAgICBmb3IoOzspIHsKICAgICAgICAgICAgICAgICAgY29uc3QgeyBwb3MsIHNpemUgfSA9IGxleGVyOwogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbGV4ZXInLCB7IHBvcywgc2l6ZSB9KTsKICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGxleGVyLm5leHQoKTsKICAgICAgICAgICAgICAgICAgaWYocmVzdWx0LmRvbmUpIGJyZWFrOwogICAgICAgICAgICAgICAgICBjb25zdCB0b2tlbiA9IHJlc3VsdC52YWx1ZTsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3Rva2VuJywgewogICAgICAgICAgICAgICAgICAgIGxleGVtZTogdG9rZW4ubGV4ZW1lLAogICAgICAgICAgICAgICAgICAgIGlkOiB0b2tlbi5pZCwKICAgICAgICAgICAgICAgICAgICBsb2M6IHRva2VuLmxvYyArICcnCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICBjb25zdCB7IHR5cGUsIGlkLCBsZXhlbWUsIGxvYyB9ID0gdG9rZW47CiAgICAgICAgICAgICAgICAgIGNvbnN0IHsgbGluZSwgY29sdW1uLCBmaWxlIH0gPSBsb2M7CiAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ3Rva2VuJywge2xleGVtZSxpZCxsaW5lfSk7CgogICAgICAgICAgICAgICAgICBpZighbGluZXNbbGluZSAtIDFdKSBsaW5lcy5wdXNoKFtdKTsKICAgICAgICAgICAgICAgICAgbGV0IGEgPSBsaW5lc1tsaW5lIC0gMV07CiAgICAgICAgICAgICAgICAgIGEucHVzaChbbGV4ZW1lLCBpZF0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2xpbmVzJywgbGluZXMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGRlZmF1bHQ6IHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzZW5kIHRvIGRlYnVnZ2VyJywgZGF0YSk7CiAgICAgICAgICAgICAgICBEZWJ1Z2dlclByb3RvY29sLnNlbmQoZGJnLCBkYXRhKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgLypsZXQgcCA9IG5ldyBEZWJ1Z2dlclByb3RvY29sKCk7CiAgICAgICAgcHJvdG9jb2wuc2V0KHdzLCBwKTsqLwogICAgICAgIH0sCiAgICAgICAgb25GZChmZCwgcmQsIHdyKSB7CiAgICAgICAgICAvL2NvbnNvbGUubG9nKCdvbkZkJywgeyBmZCwgcmQsIHdyIH0pOwogICAgICAgICAgb3Muc2V0UmVhZEhhbmRsZXIoZmQsIHJkKTsKICAgICAgICAgIG9zLnNldFdyaXRlSGFuZGxlcihmZCwgd3IpOwogICAgICAgIH0sCiAgICAgICAgLi4uKHVybCAmJiB1cmwuaG9zdCA/IHVybCA6IHt9KQogICAgICB9KQogICAgKTsKICB9KTsKICBjb25zb2xlLmxvZygnWFgnKTsKCiAgLyogIGRlZmluZShnbG9iYWxUaGlzLCB7CiAgICBnZXQgY29ubmVjdGlvbnMoKSB7CiAgICAgIHJldHVybiBbLi4uZ2xvYmFsVGhpcy5zb2NrZXRzXTsKICAgIH0sCiAgICBnZXQgc29ja2xpc3QoKSB7CiAgICAgIHJldHVybiBbLi4uZ2xvYmFsVGhpcy5zb2NrZXRzXTsKICAgIH0sCiAgICBuZXQ6IHsgc2V0TG9nLCBMTExfVVNFUiwgTExMX05PVElDRSwgTExMX1dBUk4sIGNsaWVudCwgc2VydmVyIH0sCiAgICBTdGFydERlYnVnZ2VyLAogICAgQ29ubmVjdERlYnVnZ2VyLAogICAgRGVidWdnZXJQcm90b2NvbCwKICAgIHJlcGw6IFN0YXJ0UkVQTCgpLAogICAgZGFlbW9uKCkgewogICAgICByZXBsLnN0b3AoKTsKICAgICAgc3RkLnB1dHMoJ1xuZGV0YWNoaW5nLi4uJyk7CiAgICAgIGRhZW1vbigxLCAwKTsKICAgICAgc3RkLnB1dHMoJyBQSUQgJyArIGdldHBpZCgpICsgJ1xuJyk7CiAgICB9CiAgfSk7CiovCiAgZGVsZXRlIGdsb2JhbFRoaXMuREVCVUc7CgogIGxldCBpbnB1dEJ1ZiA9IG5ldyBBcnJheUJ1ZmZlcigxMCk7CiAgb3MudHR5U2V0UmF3KDApOwoKICBvcy5zZXRSZWFkSGFuZGxlcigwLCAoKSA9PiB7CiAgICBsZXQgciA9IGZzLnJlYWRTeW5jKDAsIGlucHV0QnVmLCAwLCBpbnB1dEJ1Zi5ieXRlTGVuZ3RoKTsKCiAgICBpZihyID4gMCkgewogICAgICBsZXQgYSA9IG5ldyBVaW50OEFycmF5KGlucHV0QnVmLnNsaWNlKDAsIHIpKTsKCiAgICAgIC8vY29uc29sZS5sb2coJ2EnLCBhKTsKCiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBhLmxlbmd0aDsgaSsrKSBpZihhW2ldID09IDEzKSBhW2ldID0gMTA7CgogICAgICBpZihhLmxlbmd0aCA9PSAxICYmIGFbMF0gPT0gMTI3KSBhID0gbmV3IFVpbnQ4QXJyYXkoWzgsIDB4MjAsIDhdKTsKCiAgICAgIGlmKGEubGVuZ3RoID09IDEgJiYgYVswXSA9PSAyNykgc2hvd1Nlc3Npb25zKCk7CiAgICAgIGVsc2UgZnMud3JpdGVTeW5jKDEsIGEuYnVmZmVyKTsKICAgIH0KICB9KTsKCiAgZnVuY3Rpb24gc2hvd1Nlc3Npb25zKCkgewogICAgbGV0IHNlc3Npb25zID0gZ2V0U2Vzc2lvbnMoKTsKICAgIGNvbnNvbGUubG9nKCdzZXNzaW9ucycsIGNvbnNvbGUuY29uZmlnKHsgbWF4QXJyYXlMZW5ndGg6IEluZmluaXR5LCBkZXB0aDogNCwgY3VzdG9tSW5zcGVjdDogdHJ1ZSwgY29tcGFjdDogMSB9KSwgc2Vzc2lvbnMpOwogIH0KCiAgLy9zZXRJbnRlcnZhbCgoKSA9PiBjb25zb2xlLmxvZygnaW50ZXJ2YWwnKSwgNTAwMCk7CgogIGdsb2JhbFRoaXMud3MgPSBjcmVhdGVXUyhgd3NzOi8vJHthZGRyZXNzfTo4OTk4L3dzYCwge30sIHRydWUpOwogIC8vICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZ2xvYmFsVGhpcywgJ0RFQlVHJywgeyBnZXQ6IERlYnVnRmxhZ3MgfSk7CgogIC8qIGlmKGxpc3RlbikgY2xpLmxpc3RlbihjcmVhdGVXUywgb3MpOwogIGVsc2UgY2xpLmNvbm5lY3QoY3JlYXRlV1MsIG9zKTsKKi8KICBmdW5jdGlvbiBxdWl0KHdoeSkgewogICAgY29uc29sZS5sb2coYHF1aXQoJyR7d2h5fScpYCk7CgogICAgbGV0IGNmZyA9IHsgaW5zcGVjdE9wdGlvbnM6IGNvbnNvbGUub3B0aW9ucyB9OwogICAgV3JpdGVKU09OKGAuJHtiYXNlfS1jb25maWdgLCBjZmcpOwogICAgLy8gcmVwbC5jbGVhbnVwKHdoeSk7CiAgfQp9Cgp0cnkgewogIG1haW4oLi4uc2NyaXB0QXJncy5zbGljZSgxKSk7Cn0gY2F0Y2goZXJyb3IpIHsKICBjb25zb2xlLmxvZyhgRkFJTDogJHtlcnJvcj8ubWVzc2FnZSA/PyBlcnJvcn1cbiR7ZXJyb3I/LnN0YWNrfWApOwp9IGZpbmFsbHkgewogIC8vY29uc29sZS5sb2coJ1NVQ0NFU1MnKTsKfQoAAAAAAAAAABs7AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA+TgAAAAAAAD5OAAAAAAAAAAAAAAAAPC/"
				],
				[
					56,
					1,
					"insert",
					{
						"characters": "//"
					},
					"AgAAAHAaAAAAAAAAcRoAAAAAAAAAAAAAcRoAAAAAAAByGgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAcBoAAAAAAABwGgAAAAAAAAAAAAAAAPC/"
				],
				[
					59,
					1,
					"insert",
					{
						"characters": "//"
					},
					"AgAAAO4aAAAAAAAA7xoAAAAAAAAAAAAA7xoAAAAAAADwGgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA7hoAAAAAAADuGgAAAAAAAAAAAAAAAPC/"
				],
				[
					80,
					1,
					"",
					null,
					"AQAAAKwbAAAAAAAAxRsAAAAAAAAXAAAAICAgICAgICAgICAgY29uc29sZS5sb2c",
					"AQAAAAAAAAABAAAArBsAAAAAAADDGwAAAAAAAAAAAAAAAPC/"
				],
				[
					81,
					1,
					"",
					null,
					"AQAAAGUdAAAAAAAAgx0AAAAAAAAcAAAACiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZw",
					"AQAAAAAAAAABAAAAZR0AAAAAAACBHQAAAAAAAAAAAAAAAPC/"
				],
				[
					101,
					1,
					"insert",
					{
						"characters": "0"
					},
					"AgAAAKI4AAAAAAAAozgAAAAAAAAAAAAAozgAAAAAAACjOAAAAAAAAAEAAAAx",
					"AQAAAAAAAAABAAAAojgAAAAAAACjOAAAAAAAAAAAAAAAAPC/"
				],
				[
					106,
					1,
					"insert",
					{
						"characters": "\n"
					},
					"AgAAAKM4AAAAAAAApDgAAAAAAAAAAAAApDgAAAAAAACoOAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAozgAAAAAAACjOAAAAAAAAAAAAAAAAPC/"
				],
				[
					110,
					3,
					"left_delete",
					null,
					"AwAAAKY4AAAAAAAApjgAAAAAAAABAAAAIKQ4AAAAAAAApDgAAAAAAAACAAAAICCjOAAAAAAAAKM4AAAAAAAAAQAAAAo",
					"AQAAAAAAAAABAAAApzgAAAAAAACnOAAAAAAAAAAAAAAAADtA"
				],
				[
					115,
					1,
					"right_delete",
					null,
					"AQAAAKM4AAAAAAAAozgAAAAAAAABAAAAIA",
					"AQAAAAAAAAABAAAAozgAAAAAAACjOAAAAAAAAAAAAAAAgI9A"
				],
				[
					173,
					1,
					"insert",
					{
						"characters": " "
					},
					"AgAAABw0AAAAAAAAHTQAAAAAAAAAAAAAHTQAAAAAAAAdNAAAAAAAAAQAAAAvKiAg",
					"AQAAAAAAAAABAAAAIDQAAAAAAAAcNAAAAAAAAAAAAAAAAPC/"
				],
				[
					176,
					1,
					"insert",
					{
						"characters": " "
					},
					"AgAAAOI1AAAAAAAA4zUAAAAAAAAAAAAA4zUAAAAAAADjNQAAAAAAAAIAAAAqLw",
					"AQAAAAAAAAABAAAA5DUAAAAAAADiNQAAAAAAAAAAAAAAAPC/"
				],
				[
					181,
					1,
					"toggle_comment",
					{
						"block": true
					},
					"AgAAAOM1AAAAAAAA5TUAAAAAAAAAAAAAHTQAAAAAAAAfNAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAA4zUAAAAAAAAdNAAAAAAAAAAAAAAAAPC/"
				],
				[
					183,
					1,
					"insert",
					{
						"characters": "\n\nlet"
					},
					"BQAAABk0AAAAAAAAGjQAAAAAAAAAAAAAGjQAAAAAAAAbNAAAAAAAAAAAAAAbNAAAAAAAABw0AAAAAAAAAAAAABw0AAAAAAAAHTQAAAAAAAAAAAAAHTQAAAAAAAAeNAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAGTQAAAAAAAAZNAAAAAAAAAAAAAAAAPC/"
				],
				[
					184,
					1,
					"insert",
					{
						"characters": " repl=new"
					},
					"CQAAAB40AAAAAAAAHzQAAAAAAAAAAAAAHzQAAAAAAAAgNAAAAAAAAAAAAAAgNAAAAAAAACE0AAAAAAAAAAAAACE0AAAAAAAAIjQAAAAAAAAAAAAAIjQAAAAAAAAjNAAAAAAAAAAAAAAjNAAAAAAAACQ0AAAAAAAAAAAAACQ0AAAAAAAAJTQAAAAAAAAAAAAAJTQAAAAAAAAmNAAAAAAAAAAAAAAmNAAAAAAAACc0AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAHjQAAAAAAAAeNAAAAAAAAAAAAAAAAPC/"
				],
				[
					185,
					1,
					"insert",
					{
						"characters": " R"
					},
					"AgAAACc0AAAAAAAAKDQAAAAAAAAAAAAAKDQAAAAAAAApNAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAJzQAAAAAAAAnNAAAAAAAAAAAAAAAAPC/"
				],
				[
					186,
					5,
					"left_delete",
					null,
					"BQAAACg0AAAAAAAAKDQAAAAAAAABAAAAUic0AAAAAAAAJzQAAAAAAAABAAAAICY0AAAAAAAAJjQAAAAAAAABAAAAdyU0AAAAAAAAJTQAAAAAAAABAAAAZSQ0AAAAAAAAJDQAAAAAAAABAAAAbg",
					"AQAAAAAAAAABAAAAKTQAAAAAAAApNAAAAAAAAAAAAAAAAPC/"
				],
				[
					187,
					1,
					"insert",
					{
						"characters": "StartREPL"
					},
					"CQAAACQ0AAAAAAAAJTQAAAAAAAAAAAAAJTQAAAAAAAAmNAAAAAAAAAAAAAAmNAAAAAAAACc0AAAAAAAAAAAAACc0AAAAAAAAKDQAAAAAAAAAAAAAKDQAAAAAAAApNAAAAAAAAAAAAAApNAAAAAAAACo0AAAAAAAAAAAAACo0AAAAAAAAKzQAAAAAAAAAAAAAKzQAAAAAAAAsNAAAAAAAAAAAAAAsNAAAAAAAAC00AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAJDQAAAAAAAAkNAAAAAAAAAAAAAAAAPC/"
				],
				[
					188,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAAC00AAAAAAAALzQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAALTQAAAAAAAAtNAAAAAAAAAAAAAAAAPC/"
				],
				[
					190,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAAC80AAAAAAAAMDQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAALzQAAAAAAAAvNAAAAAAAAAAAAAAAAPC/"
				],
				[
					192,
					1,
					"left_delete",
					null,
					"AQAAABk0AAAAAAAAGTQAAAAAAAABAAAACg",
					"AQAAAAAAAAABAAAAGjQAAAAAAAAaNAAAAAAAAAAAAAAAoGdA"
				],
				[
					197,
					1,
					"insert",
					{
						"characters": "\t"
					},
					"AQAAABo0AAAAAAAAHDQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAGjQAAAAAAAAaNAAAAAAAAAAAAAAAAPC/"
				],
				[
					201,
					1,
					"insert",
					{
						"characters": "\n"
					},
					"AgAAADQ0AAAAAAAANTQAAAAAAAAAAAAANTQAAAAAAAA3NAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAANDQAAAAAAAA0NAAAAAAAAAAAAAAAADJA"
				],
				[
					227,
					1,
					"cut",
					null,
					"AQAAABo0AAAAAAAAGjQAAAAAAAAYAAAAICBsZXQgcmVwbD1TdGFydFJFUEwoKTsK",
					"AQAAAAAAAAABAAAAGjQAAAAAAAAyNAAAAAAAAAAAAAAAAPC/"
				],
				[
					252,
					1,
					"insert",
					{
						"characters": "\n\n"
					},
					"BQAAADM5AAAAAAAANDkAAAAAAAAAAAAANDkAAAAAAAA2OQAAAAAAAAAAAAA2OQAAAAAAADc5AAAAAAAAAAAAADc5AAAAAAAAOTkAAAAAAAAAAAAANDkAAAAAAAA0OQAAAAAAAAIAAAAgIA",
					"AQAAAAAAAAABAAAAMzkAAAAAAAAzOQAAAAAAAAAAAAAAAPC/"
				],
				[
					272,
					1,
					"paste",
					null,
					"AQAAADc5AAAAAAAATzkAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAANzkAAAAAAAA3OQAAAAAAAAAAAAAAAPC/"
				],
				[
					275,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAABCOwAAaW1wb3J0ICogYXMgc3RkIGZyb20gJ3N0ZCc7CmltcG9ydCAqIGFzIG9zIGZyb20gJ29zJzsKaW1wb3J0IHsgc2V0SW50ZXJ2YWwgfSBmcm9tICd0aW1lcnMnOwppbXBvcnQgKiBhcyBkZWVwIGZyb20gJy4vbGliL2RlZXAuanMnOwppbXBvcnQgKiBhcyBwYXRoIGZyb20gJy4vbGliL3BhdGguanMnOwppbXBvcnQgeyBkYWVtb24sIGF0ZXhpdCwgZ2V0cGlkLCB0b1N0cmluZywgZXNjYXBlLCBxdW90ZSwgZGVmaW5lLCBleHRlbmRBcnJheSwgZ2V0T3B0IH0gZnJvbSAndXRpbCc7CmltcG9ydCB7IENvbnNvbGUgfSBmcm9tICcuL3F1aWNranMvcWpzLW1vZHVsZXMvbGliL2NvbnNvbGUuanMnOwppbXBvcnQgUkVQTCBmcm9tICcuL3F1aWNranMvcWpzLW1vZHVsZXMvbGliL3JlcGwuanMnOwppbXBvcnQgaW5zcGVjdCBmcm9tICcuL2xpYi9vYmplY3RJbnNwZWN0LmpzJzsKaW1wb3J0ICogYXMgVGVybWluYWwgZnJvbSAnLi90ZXJtaW5hbC5qcyc7CmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJzsKaW1wb3J0IHsgc2V0TG9nLCBsb2dMZXZlbHMsIGdldFNlc3Npb25zLCBMTExfVVNFUiwgTExMX0lORk8sIExMTF9OT1RJQ0UsIExMTF9XQVJOLCBjbGllbnQsIHNlcnZlciB9IGZyb20gJ25ldCc7CmltcG9ydCB7IERlYnVnZ2VyUHJvdG9jb2wgfSBmcm9tICcuL2RlYnVnZ2VycHJvdG9jb2wuanMnOwppbXBvcnQgeyBTdGFydERlYnVnZ2VyLCBDb25uZWN0RGVidWdnZXIgfSBmcm9tICcuL2RlYnVnZ2VyLmpzJzsKaW1wb3J0IHsgZmNudGwsIEZfR0VURkwsIEZfU0VURkwsIE9fTk9OQkxPQ0sgfSBmcm9tICcuL3F1aWNranMvcWpzLWZmaS9saWIvZmNudGwuanMnOwppbXBvcnQgeyBSZWFkSlNPTiwgV3JpdGVKU09OIH0gZnJvbSAnLi9pby1oZWxwZXJzLmpzJzsKCmV4dGVuZEFycmF5KEFycmF5LnByb3RvdHlwZSk7Cgpjb25zdCBzY3JpcHROYW1lID0gKGFyZyA9IHNjcmlwdEFyZ3NbMF0pID0+IHBhdGguYmFzZW5hbWUoYXJnLCBwYXRoLmV4dG5hbWUoYXJnKSk7CgphdGV4aXQoKCkgPT4gewogIGNvbnNvbGUubG9nKCdhdGV4aXQnLCBhdGV4aXQpOwogIGxldCBzdGFjayA9IG5ldyBFcnJvcignJykuc3RhY2s7CiAgY29uc29sZS5sb2coJ3N0YWNrOicsIHN0YWNrKTsKfSk7CgpmdW5jdGlvbiBTdGFydFJFUEwocHJlZml4ID0gc2NyaXB0TmFtZSgpLCBzdWZmaXggPSAnJykgewogIGxldCByZXBsID0gbmV3IFJFUEwoYFx4MWJbMzg7NTsxNjVtJHtwcmVmaXh9IFx4MWJbMzg7NTszOW0ke3N1ZmZpeH1ceDFiWzBtYCwgZmFsc2UpOwogIHJlcGwuaGlzdG9yeUxvYWQobnVsbCwgZnMpOwogIHJlcGwubG9hZFNhdmVPcHRpb25zKCk7CiAgcmVwbC5pbnNwZWN0T3B0aW9ucyA9IHsgLi4uY29uc29sZS5vcHRpb25zLCBtYXhBcnJheUxlbmd0aDogSW5maW5pdHksIGNvbXBhY3Q6IDIgfTsKICBsZXQgeyBsb2cgfSA9IGNvbnNvbGU7CgogIHJlcGwuZGlyZWN0aXZlcy5pID0gWwogICAgbmFtZSA9PgogICAgICBpbXBvcnQobmFtZSkKICAgICAgICAudGhlbihtID0+IChnbG9iYWxUaGlzW25hbWUucmVwbGFjZSgvKC4qXC98XC5bXlwvLl0rJCkvZywgJycpXSA9IG0pKQogICAgICAgIC5jYXRjaCgoKSA9PiByZXBsLnByaW50U3RhdHVzKGBFUlJPUjogbW9kdWxlICcke25hbWV9JyBub3QgZm91bmRgKSksCiAgICAnaW1wb3J0IGEgbW9kdWxlJwogIF07CiAgcmVwbC5kaXJlY3RpdmVzLmQgPSBbKCkgPT4gZ2xvYmFsVGhpcy5kYWVtb24oKSwgJ2RldGFjaCddOwogIGNvbnNvbGUubG9nID0gcmVwbC5wcmludEZ1bmN0aW9uKCguLi5hcmdzKSA9PiB7CiAgICBsb2coJ0xPRycsIGNvbnNvbGUuY29uZmlnKHJlcGwuaW5zcGVjdE9wdGlvbnMpLCAuLi5hcmdzKTsKICB9KTsKICByZXBsLnJ1bigpOwogIHJldHVybiByZXBsOwp9CgpmdW5jdGlvbiBtYWluKC4uLmFyZ3MpIHsKICBjb25zdCBiYXNlID0gc2NyaXB0TmFtZSgpLnJlcGxhY2UoL1wuW2Etel0qJC8sICcnKTsKCiAgY29uc3QgY29uZmlnID0gUmVhZEpTT04oYC4ke2Jhc2V9LWNvbmZpZ2ApID8/IHt9OwoKICBnbG9iYWxUaGlzLmNvbnNvbGUgPSBuZXcgQ29uc29sZShzdGQuZXJyLCB7CiAgICBpbnNwZWN0T3B0aW9uczogeyBkZXB0aDogSW5maW5pdHksIGNvbXBhY3Q6IDIsIG1heEFycmF5TGVuZ3RoOiBJbmZpbml0eSwgY3VzdG9tSW5zcGVjdDogdHJ1ZSB9CiAgfSk7CgogIGxldCBwYXJhbXMgPSBnZXRPcHQoCiAgICB7CiAgICAgIHZlcmJvc2U6IFtmYWxzZSwgKGEsIHYpID0+ICh2IHwgMCkgKyAxLCAndiddLAogICAgICBsaXN0ZW46IFtmYWxzZSwgbnVsbCwgJ2wnXSwKICAgICAgY29ubmVjdDogW2ZhbHNlLCBudWxsLCAnYyddLAogICAgICBjbGllbnQ6IFtmYWxzZSwgbnVsbCwgJ0MnXSwKICAgICAgc2VydmVyOiBbZmFsc2UsIG51bGwsICdTJ10sCiAgICAgIGRlYnVnOiBbZmFsc2UsIG51bGwsICd4J10sCiAgICAgIHRsczogW2ZhbHNlLCAodiwgcHYsIG8pID0+ICgoby50bHMgPSB0cnVlKSwgdHJ1ZSksICd0J10sCiAgICAgICduby10bHMnOiBbZmFsc2UsICh2LCBwdiwgbykgPT4gKChvLnRscyA9IGZhbHNlKSwgdHJ1ZSksICdUJ10sCiAgICAgIGFkZHJlc3M6IFt0cnVlLCBudWxsLCAnYSddLAogICAgICBwb3J0OiBbdHJ1ZSwgbnVsbCwgJ3AnXSwKICAgICAgcXVpZXQ6IFtmYWxzZSwgbnVsbCwgJ3EnXSwKICAgICAgJ3NzbC1jZXJ0JzogW3RydWUsIG51bGxdLAogICAgICAnc3NsLXByaXZhdGUta2V5JzogW3RydWUsIG51bGxdLAogICAgICAnc3NsLWNhJzogW3RydWUsIG51bGxdLAogICAgICAnQCc6ICdhZGRyZXNzLHBvcnQnCiAgICB9LAogICAgYXJncwogICk7CiAgaWYocGFyYW1zWyduby10bHMnXSA9PT0gdHJ1ZSkgcGFyYW1zLnRscyA9IGZhbHNlOwogIGNvbnN0IHsKICAgIGFkZHJlc3MgPSAnMC4wLjAuMCcsCiAgICBwb3J0ID0gODk5OSwKICAgICdzc2wtY2VydCc6IHNzbENlcnQgPSAnbG9jYWxob3N0LmNydCcsCiAgICAnc3NsLXByaXZhdGUta2V5Jzogc3NsUHJpdmF0ZUtleSA9ICdsb2NhbGhvc3Qua2V5JywKICAgICdzc2wtY2EnOiBzc2xDQSA9ICcvZXRjL3NzbC9jZXJ0cy9jYS1jZXJ0aWZpY2F0ZXMuY3J0JywKICAgIHF1aWV0ID0gZmFsc2UsCiAgICBkZWJ1ZyA9IGZhbHNlLAogICAgdGxzID0gdHJ1ZQogIH0gPSBwYXJhbXM7CiAgY29uc3QgbGlzdGVuID0gcGFyYW1zLmNvbm5lY3QgJiYgIXBhcmFtcy5saXN0ZW4gPyBmYWxzZSA6IHRydWU7CiAgLy9jb25zdCBzZXJ2ZXIgPSAhcGFyYW1zLmNsaWVudCB8fCBwYXJhbXMuc2VydmVyOwogIGxldCBuYW1lID0gc2NyaXB0QXJnc1swXTsKICBuYW1lID0gbmFtZQogICAgLnJlcGxhY2UoLy4qXC8vLCAnJykKICAgIC5yZXBsYWNlKC8tL2csICcgJykKICAgIC5yZXBsYWNlKC9cLlteXC8uXSokLywgJycpOwoKICBsZXQgW3ByZWZpeCwgc3VmZml4XSA9IG5hbWUuc3BsaXQoJyAnKTsKCiAgbGV0IHByb3RvY29sID0gbmV3IFdlYWtNYXAoKTsKCiAgbGV0IHNvY2tldHMgPSAoZ2xvYmFsVGhpcy5zb2NrZXRzID8/PSBuZXcgU2V0KCkpOwoKICBjb25zdCBjcmVhdGVXUyA9IChnbG9iYWxUaGlzLmNyZWF0ZVdTID0gKHVybCwgY2FsbGJhY2tzLCBsaXN0ZW4pID0+IHsKICAgIGNvbnNvbGUubG9nKCdjcmVhdGVXUycsIHsgdXJsLCBjYWxsYmFja3MsIGxpc3RlbiB9KTsKCiAgICBzZXRMb2coCiAgICAgIHF1aWV0ID8gMCA6IExMTF9VU0VSIHwgKCgoZGVidWcgPyBMTExfSU5GTyA6IExMTF9XQVJOKSA8PCAxKSAtIDEpLAogICAgICBxdWlldCB8fCAhcGFyYW1zLmRlYnVnCiAgICAgICAgPyAoKSA9PiB7fQogICAgICAgIDogKGxldmVsLCBzdHIpID0+IHsKICAgICAgICAgICAgaWYoL0JJTkRfUFJPVE9DT0x8RFJPUF9QUk9UT0NPTHxDSEVDS19BQ0NFU1NfUklHSFRTfEFERF9IRUFERVJTLy50ZXN0KHN0cikpIHJldHVybjsKICAgICAgICAgICAgY29uc29sZS5sb2cobG9nTGV2ZWxzW2xldmVsXS5wYWRFbmQoMTApLCBzdHIudHJpbSgpKTsKICAgICAgICAgIH0KICAgICk7CgogICAgbGV0IG9wdGlvbnM7CiAgICBsZXQgY2hpbGQsIGRiZzsKICAgIGxldCBuZXRmbiA9IFtjbGllbnQsIHNlcnZlcl1bK2xpc3Rlbl07CiAgICBjb25zb2xlLmxvZygnY3JlYXRlV1MnLCB7IHVybCwgbmV0Zm4gfSk7CiAgICByZXR1cm4gbmV0Zm4oCiAgICAgIHVybCwKICAgICAgKG9wdGlvbnMgPSB7CiAgICAgICAgdGxzOiBwYXJhbXMudGxzLAogICAgICAgIHNzbENlcnQsCiAgICAgICAgc3NsUHJpdmF0ZUtleSwKICAgICAgICBzc2xDQSwKICAgICAgICBtaW1ldHlwZXM6IFsKICAgICAgICAgIFsnLnN2Z3onLCAnYXBwbGljYXRpb24vZ3ppcCddLAogICAgICAgICAgWycubWpzJywgJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnXSwKICAgICAgICAgIFsnLmVzJywgJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnXSwKICAgICAgICAgIFsnLndhc20nLCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJ10sCiAgICAgICAgICBbJy5lb3QnLCAnYXBwbGljYXRpb24vdm5kLm1zLWZvbnRvYmplY3QnXSwKICAgICAgICAgIFsnLmxpYicsICdhcHBsaWNhdGlvbi94LWFyY2hpdmUnXSwKICAgICAgICAgIFsnLmJ6MicsICdhcHBsaWNhdGlvbi94LWJ6aXAyJ10sCiAgICAgICAgICBbJy5naXRpZ25vcmUnLCAndGV4dC9wbGFpbiddLAogICAgICAgICAgWycuY21ha2UnLCAndGV4dC9wbGFpbiddLAogICAgICAgICAgWycuaGV4JywgJ3RleHQvcGxhaW4nXSwKICAgICAgICAgIFsnLm1kJywgJ3RleHQvcGxhaW4nXSwKICAgICAgICAgIFsnLnBieHByb2onLCAndGV4dC9wbGFpbiddLAogICAgICAgICAgWycud2F0JywgJ3RleHQvcGxhaW4nXSwKICAgICAgICAgIFsnLmMnLCAndGV4dC94LWMnXSwKICAgICAgICAgIFsnLmgnLCAndGV4dC94LWMnXSwKICAgICAgICAgIFsnLmNwcCcsICd0ZXh0L3gtYysrJ10sCiAgICAgICAgICBbJy5ocHAnLCAndGV4dC94LWMrKyddLAogICAgICAgICAgWycuZmlsdGVycycsICd0ZXh0L3htbCddLAogICAgICAgICAgWycucGxpc3QnLCAndGV4dC94bWwnXSwKICAgICAgICAgIFsnLnN0b3J5Ym9hcmQnLCAndGV4dC94bWwnXSwKICAgICAgICAgIFsnLnZjeHByb2onLCAndGV4dC94bWwnXSwKICAgICAgICAgIFsnLmJhdCcsICd0ZXh0L3gtbXNkb3MtYmF0Y2gnXSwKICAgICAgICAgIFsnLm1tJywgJ3RleHQveC1vYmplY3RpdmUtYyddLAogICAgICAgICAgWycubScsICd0ZXh0L3gtb2JqZWN0aXZlLWMnXSwKICAgICAgICAgIFsnLnNoJywgJ3RleHQveC1zaGVsbHNjcmlwdCddCiAgICAgICAgXSwKICAgICAgICBtb3VudHM6IFsKICAgICAgICAgIFsnL3Byb3h5JywgJ2lwdjQ6MTI3LjAuMC4xOjIyJywgbnVsbCwgJ3Byb3h5LXdzLXJhdy13cyddLAogICAgICAgICAgWycvbHdzJywgJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jaC8nLCBudWxsLCAnJ10sCiAgICAgICAgICBbJy8nLCAnLicsICdkZWJ1Z2dlci5odG1sJ10sCiAgICAgICAgICBmdW5jdGlvbiogY29uZmlnKHJlcSwgcmVzKSB7CiAgICAgICAgICAgIGNvbnN0IHsgYm9keSwgaGVhZGVycyB9ID0gcmVxOwogICAgICAgICAgICBjb25zb2xlLmxvZygnL2NvbmZpZycsIHsgcmVxLCByZXMgfSk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCcqY29uZmlnJywgeyBib2R5LCBoZWFkZXJzIH0pOwogICAgICAgICAgICB5aWVsZCAne30nOwogICAgICAgICAgfSwKICAgICAgICAgIGZ1bmN0aW9uKiBmaWxlcyhyZXEsIHJlcykgewogICAgICAgICAgICBjb25zdCB7IGJvZHksIGhlYWRlcnMgfSA9IHJlcTsKICAgICAgICAgICAgeWllbGQgZnMKICAgICAgICAgICAgICAucmVhZGRpclN5bmMoJy4nKQogICAgICAgICAgICAgIC5zb3J0KCkKICAgICAgICAgICAgICAubWFwKGYgPT4gZiArICdcbicpCiAgICAgICAgICAgICAgLmpvaW4oJycpOwogICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgLi4udXJsLAogICAgICAgIC4uLmNhbGxiYWNrcywKICAgICAgICBibG9jazogZmFsc2UsCiAgICAgICAgb25Db25uZWN0KHdzLCByZXEpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdvbkNvbm5lY3QnLCB7IHdzLCByZXEgfSwgcmVxICYmIHJlcS5oZWFkZXJzKTsKCiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh3cywgewogICAgICAgICAgICBzZW5kTWVzc2FnZTogewogICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZW5kTWVzc2FnZShtc2cpIHsKICAgICAgICAgICAgICAgIGxldCByZXQgPSB0aGlzLnNlbmQoSlNPTi5zdHJpbmdpZnkobXNnKSk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgd3Muc2VuZE1lc3NhZ2UoYCwgbXNnLCBgKSA9ICR7cmV0fWApOwogICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRiZzogeyB2YWx1ZTogbnVsbCwgZW51bWVyYWJsZTogZmFsc2UgfQogICAgICAgICAgfSk7CgogICAgICAgICAgc29ja2V0cy5hZGQod3MpOwogICAgICAgIH0sCiAgICAgICAgb25DbG9zZSh3cykgewogICAgICAgICAgY29uc29sZS5sb2coJ29uQ2xvc2UnLCB3cyk7CiAgICAgICAgICBkYmcuY2xvc2UoKTsKCiAgICAgICAgICBwcm90b2NvbC5kZWxldGUod3MpOwogICAgICAgICAgc29ja2V0cy5kZWxldGUod3MpOwogICAgICAgIH0sCiAgICAgICAgb25FcnJvcih3cykgewogICAgICAgICAgY29uc29sZS5sb2coJ29uRXJyb3InLCB3cyk7CiAgICAgICAgfSwKICAgICAgICBvbkh0dHAocmVxLCByZXNwKSB7CiAgICAgICAgICBjb25zdCB7IG1ldGhvZCwgaGVhZGVycyB9ID0gcmVxOwogICAgICAgICAgLy9jb25zb2xlLmxvZygnXHgxYlszODs1OzMzbW9uSHR0cFx4MWJbMG0gW1xuICAnLCByZXEsICcsXG4gICcsIHJlc3AsICdcbl0nKTsKICAgICAgICAgIGNvbnN0IHsgYm9keSwgdXJsIH0gPSByZXNwOwogICAgICAgICAgLy9jb25zb2xlLmxvZygnXHgxYlszODs1OzMzbW9uSHR0cFx4MWJbMG0nLCB7IGJvZHkgfSk7CgogICAgICAgICAgY29uc3QgZmlsZSA9IHVybC5wYXRoLnNsaWNlKDEpOwogICAgICAgICAgY29uc3QgZGlyID0gZmlsZS5yZXBsYWNlKC9cL1teXC9dKiQvZywgJycpOwoKICAgICAgICAgIGlmKGZpbGUuZW5kc1dpdGgoJy5qcycpKSB7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ29uSHR0cCcsIHsgZmlsZSwgZGlyIH0pOwogICAgICAgICAgICBjb25zdCByZSA9IC9eKFxzKihpbXxleClwb3J0W15cbl0qZnJvbSBbJyJdKShbXi4vJyJdKikoWyciXVxzKjtbXHQgXSpcbj8pL2dtOwoKICAgICAgICAgICAgcmVzcC5ib2R5ID0gYm9keS5yZXBsYWNlQWxsKHJlLCAobWF0Y2gsIHAxLCBwMCwgcDIsIHAzLCBvZmZzZXQpID0+IHsKICAgICAgICAgICAgICBpZighL1tcL1wuXS8udGVzdChwMikpIHsKICAgICAgICAgICAgICAgIGxldCBmbmFtZSA9IGAke3AyfS5qc2A7CgogICAgICAgICAgICAgICAgaWYoIWZzLmV4aXN0c1N5bmMoZGlyICsgJy8nICsgZm5hbWUpKSByZXR1cm4gYC8qICR7bWF0Y2h9ICovYDsKCiAgICAgICAgICAgICAgICBtYXRjaCA9IFtwMSwgJy4vJyArIGZuYW1lLCBwM10uam9pbignJyk7CgogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnYXJncycsIHsgbWF0Y2gsIHAxLCBwMiwgcDMsIG9mZnNldCB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gcmVzcDsKICAgICAgICB9LAogICAgICAgIG9uTWVzc2FnZSh3cywgZGF0YSkgewogICAgICAgICAgY29uc29sZS5sb2coJ29uTWVzc2FnZScsIHdzLCBkYXRhKTsKICAgICAgICAgIC8vIHNob3dTZXNzaW9ucygpOwoKICAgICAgICAgIGhhbmRsZUNvbW1hbmQod3MsIGRhdGEpOwoKICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZUNvbW1hbmQod3MsIGRhdGEpIHsKICAgICAgICAgICAgbGV0IG9iaiA9IEpTT04ucGFyc2UoZGF0YSk7CgogICAgICAgICAgICBjb25zdCB7IGNvbW1hbmQsIC4uLnJlc3QgfSA9IG9iajsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ29uTWVzc2FnZScsIGNvbW1hbmQsIHJlc3QpOwogICAgICAgICAgICBjb25zdCB7IGNvbm5lY3QgPSB0cnVlLCBhZGRyZXNzID0gJzEyNy4wLjAuMTonICsgTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKDY1NTM1IC0gMTAyNCkpICsgMTAyNCwgYXJncyA9IFtdIH0gPSByZXN0OwoKICAgICAgICAgICAgc3dpdGNoIChjb21tYW5kKSB7CiAgICAgICAgICAgICAgY2FzZSAnc3RhcnQnOiB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnd3MnLCB3cyk7CiAgICAgICAgICAgICAgICBjaGlsZCA9IC8qd3MuY2hpbGQgPSAqLyBTdGFydERlYnVnZ2VyKGFyZ3MsIGNvbm5lY3QsIGFkZHJlc3MpOwogICAgICAgICAgICAgICAgY29uc3QgWywgc3Rkb3V0LCBzdGRlcnJdID0gY2hpbGQuc3RkaW87CiAgICAgICAgICAgICAgICBmb3IobGV0IGZkIG9mIFtzdGRvdXQsIHN0ZGVycl0pIHsKICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhgZmNudGwoJHtmZH0sIEZfR0VURkwpYCk7CiAgICAgICAgICAgICAgICAgIGxldCBmbGFncyA9IGZjbnRsKGZkLCBGX0dFVEZMKTsKICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhgZmNudGwoJHtmZH0sIEZfU0VURkwsIDB4JHtmbGFncy50b1N0cmluZygxNil9KWApOwogICAgICAgICAgICAgICAgICBmbGFncyB8PSBPX05PTkJMT0NLOwogICAgICAgICAgICAgICAgICBmY250bChmZCwgRl9TRVRGTCwgZmxhZ3MpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZm9yKGxldCBpID0gMTsgaSA8PSAyOyBpKyspIHsKICAgICAgICAgICAgICAgICAgbGV0IGZkID0gY2hpbGQuc3RkaW9baV07CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvcy5zZXRSZWFkSGFuZGxlcicsIGZkKTsKICAgICAgICAgICAgICAgICAgb3Muc2V0UmVhZEhhbmRsZXIoZmQsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICBsZXQgYnVmID0gbmV3IEFycmF5QnVmZmVyKDEwMjQpOwogICAgICAgICAgICAgICAgICAgIGxldCByID0gb3MucmVhZChmZCwgYnVmLCAwLCBidWYuYnl0ZUxlbmd0aCk7CgogICAgICAgICAgICAgICAgICAgIGlmKHIgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHRvU3RyaW5nKGJ1Zi5zbGljZSgwLCByKSk7CiAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGByZWFkKCR7ZmR9LCBidWYpID0gJHtyfSAoJHtxdW90ZShkYXRhLCAiJyIpfSlgKTsKCiAgICAgICAgICAgICAgICAgICAgICB3cy5zZW5kTWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdvdXRwdXQnLAogICAgICAgICAgICAgICAgICAgICAgICBjaGFubmVsOiBbJ3N0ZG91dCcsICdzdGRlcnInXVtpIC0gMV0sCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2hpbGQnLCBjaGlsZC5waWQpOwoKICAgICAgICAgICAgICAgIG9zLnNsZWVwKDEwMDApOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBjYXNlICdjb25uZWN0JzogewogICAgICAgICAgICAgICAgZGJnID0gd3MuZGJnID0gQ29ubmVjdERlYnVnZ2VyKGFkZHJlc3MsIChkYmcsIHNvY2spID0+IHsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3dhaXQoKSA9JywgY2hpbGQud2FpdCgpKTsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NoaWxkJywgY2hpbGQpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBvcy5zZXRXcml0ZUhhbmRsZXIoK2RiZywgYXN5bmMgKCkgPT4gewogICAgICAgICAgICAgICAgICBvcy5zZXRXcml0ZUhhbmRsZXIoK2RiZywgbnVsbCk7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBjb25uZWN0ZWQgdG8gJHthZGRyZXNzfWAsIGRiZyk7CgogICAgICAgICAgICAgICAgICBzb2NrZXRzLmFkZChkYmcpOwoKICAgICAgICAgICAgICAgICAgY29uc3QgY3dkID0gcHJvY2Vzcy5jd2QoKTsKICAgICAgICAgICAgICAgICAgd3Muc2VuZE1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICdyZXNwb25zZScsCiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2U6IHsKICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmQ6ICdzdGFydCcsCiAgICAgICAgICAgICAgICAgICAgICBhcmdzLAogICAgICAgICAgICAgICAgICAgICAgY3dkLAogICAgICAgICAgICAgICAgICAgICAgYWRkcmVzcwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBsZXQgbXNnOwoKICAgICAgICAgICAgICAgICAgd2hpbGUoZGJnLm9wZW4pIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgbXNnID0gYXdhaXQgRGVidWdnZXJQcm90b2NvbC5yZWFkKGRiZyk7CiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRGVidWdnZXJQcm90b2NvbC5yZWFkKCkgPScsIGVzY2FwZShtc2cpKTsKICAgICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBtc2cgPT0gJ3N0cmluZycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJldDsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gd3Muc2VuZChtc2cpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgd3Muc2VuZCgke3F1b3RlKG1zZywgIiciKX0pID0gJHtyZXR9YCk7CiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2xvc2VkIHNvY2tldCcsIGRiZyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNvY2tldHMuZGVsZXRlKGRiZyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHdzLnNlbmRNZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZW5kJywKICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb246ICdjbG9zZWQnCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2goZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgbWVzc2FnZSwgc3RhY2sgfSA9IGVycm9yOwogICAgICAgICAgICAgICAgICAgICAgd3Muc2VuZE1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLAogICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogeyBtZXNzYWdlLCBzdGFjayB9CiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgIGRiZy5jbG9zZSgpOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKG1zZyA9PT0gbnVsbCkgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2RiZycsIGRiZyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgY2FzZSAnZmlsZSc6IHsKICAgICAgICAgICAgICAgIGNvbnN0IHsgcGF0aCB9ID0gcmVzdDsKICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBmcy5yZWFkRmlsZVN5bmMocGF0aCwgJ3V0Zi04Jyk7CiAgICAgICAgICAgICAgICAvL3dzLnNlbmQoSlNPTi5zdHJpbmdpZnkoeyB0eXBlOiAncmVzcG9uc2UnLCByZXNwb25zZTogeyBjb21tYW5kOiAnZmlsZScsIHBhdGgsIGRhdGEgfSB9KSk7CgogICAgICAgICAgICAgICAgY29uc3QgbGV4ZXIgPSBuZXcgTGV4ZXIoZGF0YSwgcGF0aCk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbGV4ZXInLCBsZXhlcik7CiAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IFtdOwoKICAgICAgICAgICAgICAgIGZvcig7OykgewogICAgICAgICAgICAgICAgICBjb25zdCB7IHBvcywgc2l6ZSB9ID0gbGV4ZXI7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdsZXhlcicsIHsgcG9zLCBzaXplIH0pOwogICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gbGV4ZXIubmV4dCgpOwogICAgICAgICAgICAgICAgICBpZihyZXN1bHQuZG9uZSkgYnJlYWs7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHRva2VuID0gcmVzdWx0LnZhbHVlOwogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndG9rZW4nLCB7CiAgICAgICAgICAgICAgICAgICAgbGV4ZW1lOiB0b2tlbi5sZXhlbWUsCiAgICAgICAgICAgICAgICAgICAgaWQ6IHRva2VuLmlkLAogICAgICAgICAgICAgICAgICAgIGxvYzogdG9rZW4ubG9jICsgJycKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHsgdHlwZSwgaWQsIGxleGVtZSwgbG9jIH0gPSB0b2tlbjsKICAgICAgICAgICAgICAgICAgY29uc3QgeyBsaW5lLCBjb2x1bW4sIGZpbGUgfSA9IGxvYzsKICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygndG9rZW4nLCB7bGV4ZW1lLGlkLGxpbmV9KTsKCiAgICAgICAgICAgICAgICAgIGlmKCFsaW5lc1tsaW5lIC0gMV0pIGxpbmVzLnB1c2goW10pOwogICAgICAgICAgICAgICAgICBsZXQgYSA9IGxpbmVzW2xpbmUgLSAxXTsKICAgICAgICAgICAgICAgICAgYS5wdXNoKFtsZXhlbWUsIGlkXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbGluZXMnLCBsaW5lcyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgZGVmYXVsdDogewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NlbmQgdG8gZGVidWdnZXInLCBkYXRhKTsKICAgICAgICAgICAgICAgIERlYnVnZ2VyUHJvdG9jb2wuc2VuZChkYmcsIGRhdGEpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICAvKmxldCBwID0gbmV3IERlYnVnZ2VyUHJvdG9jb2woKTsKICAgICAgICBwcm90b2NvbC5zZXQod3MsIHApOyovCiAgICAgICAgfSwKICAgICAgICBvbkZkKGZkLCByZCwgd3IpIHsKICAgICAgICAgIC8vY29uc29sZS5sb2coJ29uRmQnLCB7IGZkLCByZCwgd3IgfSk7CiAgICAgICAgICBvcy5zZXRSZWFkSGFuZGxlcihmZCwgcmQpOwogICAgICAgICAgb3Muc2V0V3JpdGVIYW5kbGVyKGZkLCB3cik7CiAgICAgICAgfSwKICAgICAgICAuLi4odXJsICYmIHVybC5ob3N0ID8gdXJsIDoge30pCiAgICAgIH0pCiAgICApOwogIH0pOwogIGNvbnNvbGUubG9nKCdYWCcpOwoKICAKICAgLypkZWZpbmUoZ2xvYmFsVGhpcywgewogICAgZ2V0IGNvbm5lY3Rpb25zKCkgewogICAgICByZXR1cm4gWy4uLmdsb2JhbFRoaXMuc29ja2V0c107CiAgICB9LAogICAgZ2V0IHNvY2tsaXN0KCkgewogICAgICByZXR1cm4gWy4uLmdsb2JhbFRoaXMuc29ja2V0c107CiAgICB9LAogICAgbmV0OiB7IHNldExvZywgTExMX1VTRVIsIExMTF9OT1RJQ0UsIExMTF9XQVJOLCBjbGllbnQsIHNlcnZlciB9LAogICAgU3RhcnREZWJ1Z2dlciwKICAgIENvbm5lY3REZWJ1Z2dlciwKICAgIERlYnVnZ2VyUHJvdG9jb2wsCiAgICByZXBsOiBTdGFydFJFUEwoKSwKICAgIGRhZW1vbigpIHsKICAgICAgcmVwbC5zdG9wKCk7CiAgICAgIHN0ZC5wdXRzKCdcbmRldGFjaGluZy4uLicpOwogICAgICBkYWVtb24oMSwgMCk7CiAgICAgIHN0ZC5wdXRzKCcgUElEICcgKyBnZXRwaWQoKSArICdcbicpOwogICAgfQogIH0pOwogKi8KICBkZWxldGUgZ2xvYmFsVGhpcy5ERUJVRzsKCiAgbGV0IGlucHV0QnVmID0gbmV3IEFycmF5QnVmZmVyKDEwKTsKICBvcy50dHlTZXRSYXcoMCk7CgogIG9zLnNldFJlYWRIYW5kbGVyKDAsICgpID0+IHsKICAgIGxldCByID0gZnMucmVhZFN5bmMoMCwgaW5wdXRCdWYsIDAsIGlucHV0QnVmLmJ5dGVMZW5ndGgpOwoKICAgIGlmKHIgPiAwKSB7CiAgICAgIGxldCBhID0gbmV3IFVpbnQ4QXJyYXkoaW5wdXRCdWYuc2xpY2UoMCwgcikpOwoKICAgICAgLy9jb25zb2xlLmxvZygnYScsIGEpOwoKICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGEubGVuZ3RoOyBpKyspIGlmKGFbaV0gPT0gMTMpIGFbaV0gPSAxMDsKCiAgICAgIGlmKGEubGVuZ3RoID09IDEgJiYgYVswXSA9PSAxMjcpIGEgPSBuZXcgVWludDhBcnJheShbOCwgMHgyMCwgOF0pOwoKICAgICAgaWYoYS5sZW5ndGggPT0gMSAmJiBhWzBdID09IDI3KSBzaG93U2Vzc2lvbnMoKTsKICAgICAgZWxzZSBmcy53cml0ZVN5bmMoMSwgYS5idWZmZXIpOwogICAgfQogIH0pOwoKICBmdW5jdGlvbiBzaG93U2Vzc2lvbnMoKSB7CiAgICBsZXQgc2Vzc2lvbnMgPSBnZXRTZXNzaW9ucygpOwogICAgY29uc29sZS5sb2coJ3Nlc3Npb25zJywgY29uc29sZS5jb25maWcoeyBtYXhBcnJheUxlbmd0aDogSW5maW5pdHksIGRlcHRoOiA0LCBjdXN0b21JbnNwZWN0OiB0cnVlLCBjb21wYWN0OiAwIH0pLCBzZXNzaW9ucyk7CiAgfQoKICAvL3NldEludGVydmFsKCgpID0+IGNvbnNvbGUubG9nKCdpbnRlcnZhbCcpLCA1MDAwKTsKCiAgZ2xvYmFsVGhpcy53cyA9IGNyZWF0ZVdTKGB3c3M6Ly8ke2FkZHJlc3N9Ojg5OTgvd3NgLCB7fSwgdHJ1ZSk7CgogICAgbGV0IHJlcGw9U3RhcnRSRVBMKCk7CgogIC8vICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZ2xvYmFsVGhpcywgJ0RFQlVHJywgeyBnZXQ6IERlYnVnRmxhZ3MgfSk7CgogIC8qIGlmKGxpc3RlbikgY2xpLmxpc3RlbihjcmVhdGVXUywgb3MpOwogIGVsc2UgY2xpLmNvbm5lY3QoY3JlYXRlV1MsIG9zKTsKKi8KICBmdW5jdGlvbiBxdWl0KHdoeSkgewogICAgY29uc29sZS5sb2coYHF1aXQoJyR7d2h5fScpYCk7CgogICAgbGV0IGNmZyA9IHsgaW5zcGVjdE9wdGlvbnM6IGNvbnNvbGUub3B0aW9ucyB9OwogICAgV3JpdGVKU09OKGAuJHtiYXNlfS1jb25maWdgLCBjZmcpOwogICAgLy8gcmVwbC5jbGVhbnVwKHdoeSk7CiAgfQp9Cgp0cnkgewogIG1haW4oLi4uc2NyaXB0QXJncy5zbGljZSgxKSk7Cn0gY2F0Y2goZXJyb3IpIHsKICBjb25zb2xlLmxvZyhgRkFJTDogJHtlcnJvcj8ubWVzc2FnZSA/PyBlcnJvcn1cbiR7ZXJyb3I/LnN0YWNrfWApOwp9IGZpbmFsbHkgewogIC8vY29uc29sZS5sb2coJ1NVQ0NFU1MnKTsKfQoAAAAAAAAAAD47AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAATzkAAAAAAABPOQAAAAAAAAAAAAAAAPC/"
				],
				[
					280,
					1,
					"insert",
					{
						"characters": "define(globl"
					},
					"DAAAADM5AAAAAAAANDkAAAAAAAAAAAAANDkAAAAAAAA1OQAAAAAAAAAAAAA1OQAAAAAAADY5AAAAAAAAAAAAADY5AAAAAAAANzkAAAAAAAAAAAAANzkAAAAAAAA4OQAAAAAAAAAAAAA4OQAAAAAAADk5AAAAAAAAAAAAADk5AAAAAAAAOjkAAAAAAAAAAAAAOjkAAAAAAAA7OQAAAAAAAAAAAAA7OQAAAAAAADw5AAAAAAAAAAAAADw5AAAAAAAAPTkAAAAAAAAAAAAAPTkAAAAAAAA+OQAAAAAAAAAAAAA+OQAAAAAAAD85AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAMzkAAAAAAAAzOQAAAAAAAAAAAAAAADJA"
				],
				[
					281,
					1,
					"left_delete",
					null,
					"AQAAAD45AAAAAAAAPjkAAAAAAAABAAAAbA",
					"AQAAAAAAAAABAAAAPzkAAAAAAAA/OQAAAAAAAAAAAAAAAPC/"
				],
				[
					282,
					1,
					"insert",
					{
						"characters": "al"
					},
					"AgAAAD45AAAAAAAAPzkAAAAAAAAAAAAAPzkAAAAAAABAOQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAPjkAAAAAAAA+OQAAAAAAAAAAAAAAAPC/"
				],
				[
					283,
					2,
					"left_delete",
					null,
					"AgAAAD85AAAAAAAAPzkAAAAAAAABAAAAbD45AAAAAAAAPjkAAAAAAAABAAAAYQ",
					"AQAAAAAAAAABAAAAQDkAAAAAAABAOQAAAAAAAAAAAAAAAPC/"
				],
				[
					284,
					1,
					"insert",
					{
						"characters": "al"
					},
					"AgAAAD45AAAAAAAAPzkAAAAAAAAAAAAAPzkAAAAAAABAOQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAPjkAAAAAAAA+OQAAAAAAAAAAAAAAAPC/"
				],
				[
					285,
					11,
					"left_delete",
					null,
					"CwAAAD85AAAAAAAAPzkAAAAAAAABAAAAbD45AAAAAAAAPjkAAAAAAAABAAAAYT05AAAAAAAAPTkAAAAAAAABAAAAYjw5AAAAAAAAPDkAAAAAAAABAAAAbzs5AAAAAAAAOzkAAAAAAAABAAAAbDo5AAAAAAAAOjkAAAAAAAABAAAAZzk5AAAAAAAAOTkAAAAAAAABAAAAKDg5AAAAAAAAODkAAAAAAAABAAAAZTc5AAAAAAAANzkAAAAAAAABAAAAbjY5AAAAAAAANjkAAAAAAAABAAAAaTU5AAAAAAAANTkAAAAAAAABAAAAZg",
					"AQAAAAAAAAABAAAAQDkAAAAAAABAOQAAAAAAAAAAAAAAAPC/"
				],
				[
					286,
					2,
					"left_delete",
					null,
					"AgAAADQ5AAAAAAAANDkAAAAAAAABAAAAZTM5AAAAAAAAMzkAAAAAAAABAAAAZA",
					"AQAAAAAAAAABAAAANTkAAAAAAAA1OQAAAAAAAAAAAAAAAPC/"
				],
				[
					287,
					1,
					"insert",
					{
						"characters": "//"
					},
					"AgAAADM5AAAAAAAANDkAAAAAAAAAAAAANDkAAAAAAAA1OQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAMzkAAAAAAAAzOQAAAAAAAAAAAAAAAPC/"
				],
				[
					291,
					2,
					"left_delete",
					null,
					"AgAAAB00AAAAAAAAHTQAAAAAAAABAAAAKhw0AAAAAAAAHDQAAAAAAAABAAAALw",
					"AQAAAAAAAAABAAAAHjQAAAAAAAAeNAAAAAAAAAAAAAAAAEJA"
				],
				[
					295,
					1,
					"cut",
					null,
					"AQAAABo0AAAAAAAAGjQAAAAAAADLAQAAICBkZWZpbmUoZ2xvYmFsVGhpcywgewogICAgZ2V0IGNvbm5lY3Rpb25zKCkgewogICAgICByZXR1cm4gWy4uLmdsb2JhbFRoaXMuc29ja2V0c107CiAgICB9LAogICAgZ2V0IHNvY2tsaXN0KCkgewogICAgICByZXR1cm4gWy4uLmdsb2JhbFRoaXMuc29ja2V0c107CiAgICB9LAogICAgbmV0OiB7IHNldExvZywgTExMX1VTRVIsIExMTF9OT1RJQ0UsIExMTF9XQVJOLCBjbGllbnQsIHNlcnZlciB9LAogICAgU3RhcnREZWJ1Z2dlciwKICAgIENvbm5lY3REZWJ1Z2dlciwKICAgIERlYnVnZ2VyUHJvdG9jb2wsCiAgICByZXBsOiBTdGFydFJFUEwoKSwKICAgIGRhZW1vbigpIHsKICAgICAgcmVwbC5zdG9wKCk7CiAgICAgIHN0ZC5wdXRzKCdcbmRldGFjaGluZy4uLicpOwogICAgICBkYWVtb24oMSwgMCk7CiAgICAgIHN0ZC5wdXRzKCcgUElEICcgKyBnZXRwaWQoKSArICdcbicpOwogICAgfQogIH0pOwogKi8K",
					"AQAAAAAAAAABAAAAGjQAAAAAAADlNQAAAAAAAAAAAAAAAAAA"
				],
				[
					299,
					1,
					"insert",
					{
						"characters": "\n"
					},
					"AQAAAGM3AAAAAAAAZDcAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAYzcAAAAAAABjNwAAAAAAAAAAAAAAAAAA"
				],
				[
					300,
					1,
					"paste",
					null,
					"AQAAAGQ3AAAAAAAALzkAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAZDcAAAAAAABkNwAAAAAAAAAAAAAAAPC/"
				],
				[
					302,
					2,
					"left_delete",
					null,
					"AgAAAC05AAAAAAAALTkAAAAAAAABAAAALyw5AAAAAAAALDkAAAAAAAABAAAAKg",
					"AQAAAAAAAAABAAAALjkAAAAAAAAuOQAAAAAAAAAAAAAAAPC/"
				],
				[
					317,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAAA9OwAAaW1wb3J0ICogYXMgc3RkIGZyb20gJ3N0ZCc7CmltcG9ydCAqIGFzIG9zIGZyb20gJ29zJzsKaW1wb3J0IHsgc2V0SW50ZXJ2YWwgfSBmcm9tICd0aW1lcnMnOwppbXBvcnQgKiBhcyBkZWVwIGZyb20gJy4vbGliL2RlZXAuanMnOwppbXBvcnQgKiBhcyBwYXRoIGZyb20gJy4vbGliL3BhdGguanMnOwppbXBvcnQgeyBkYWVtb24sIGF0ZXhpdCwgZ2V0cGlkLCB0b1N0cmluZywgZXNjYXBlLCBxdW90ZSwgZGVmaW5lLCBleHRlbmRBcnJheSwgZ2V0T3B0IH0gZnJvbSAndXRpbCc7CmltcG9ydCB7IENvbnNvbGUgfSBmcm9tICcuL3F1aWNranMvcWpzLW1vZHVsZXMvbGliL2NvbnNvbGUuanMnOwppbXBvcnQgUkVQTCBmcm9tICcuL3F1aWNranMvcWpzLW1vZHVsZXMvbGliL3JlcGwuanMnOwppbXBvcnQgaW5zcGVjdCBmcm9tICcuL2xpYi9vYmplY3RJbnNwZWN0LmpzJzsKaW1wb3J0ICogYXMgVGVybWluYWwgZnJvbSAnLi90ZXJtaW5hbC5qcyc7CmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJzsKaW1wb3J0IHsgc2V0TG9nLCBsb2dMZXZlbHMsIGdldFNlc3Npb25zLCBMTExfVVNFUiwgTExMX0lORk8sIExMTF9OT1RJQ0UsIExMTF9XQVJOLCBjbGllbnQsIHNlcnZlciB9IGZyb20gJ25ldCc7CmltcG9ydCB7IERlYnVnZ2VyUHJvdG9jb2wgfSBmcm9tICcuL2RlYnVnZ2VycHJvdG9jb2wuanMnOwppbXBvcnQgeyBTdGFydERlYnVnZ2VyLCBDb25uZWN0RGVidWdnZXIgfSBmcm9tICcuL2RlYnVnZ2VyLmpzJzsKaW1wb3J0IHsgZmNudGwsIEZfR0VURkwsIEZfU0VURkwsIE9fTk9OQkxPQ0sgfSBmcm9tICcuL3F1aWNranMvcWpzLWZmaS9saWIvZmNudGwuanMnOwppbXBvcnQgeyBSZWFkSlNPTiwgV3JpdGVKU09OIH0gZnJvbSAnLi9pby1oZWxwZXJzLmpzJzsKCmV4dGVuZEFycmF5KEFycmF5LnByb3RvdHlwZSk7Cgpjb25zdCBzY3JpcHROYW1lID0gKGFyZyA9IHNjcmlwdEFyZ3NbMF0pID0+IHBhdGguYmFzZW5hbWUoYXJnLCBwYXRoLmV4dG5hbWUoYXJnKSk7CgphdGV4aXQoKCkgPT4gewogIGNvbnNvbGUubG9nKCdhdGV4aXQnLCBhdGV4aXQpOwogIGxldCBzdGFjayA9IG5ldyBFcnJvcignJykuc3RhY2s7CiAgY29uc29sZS5sb2coJ3N0YWNrOicsIHN0YWNrKTsKfSk7CgpmdW5jdGlvbiBTdGFydFJFUEwocHJlZml4ID0gc2NyaXB0TmFtZSgpLCBzdWZmaXggPSAnJykgewogIGxldCByZXBsID0gbmV3IFJFUEwoYFx4MWJbMzg7NTsxNjVtJHtwcmVmaXh9IFx4MWJbMzg7NTszOW0ke3N1ZmZpeH1ceDFiWzBtYCwgZmFsc2UpOwogIHJlcGwuaGlzdG9yeUxvYWQobnVsbCwgZnMpOwogIHJlcGwubG9hZFNhdmVPcHRpb25zKCk7CiAgcmVwbC5pbnNwZWN0T3B0aW9ucyA9IHsgLi4uY29uc29sZS5vcHRpb25zLCBtYXhBcnJheUxlbmd0aDogSW5maW5pdHksIGNvbXBhY3Q6IDIgfTsKICBsZXQgeyBsb2cgfSA9IGNvbnNvbGU7CgogIHJlcGwuZGlyZWN0aXZlcy5pID0gWwogICAgbmFtZSA9PgogICAgICBpbXBvcnQobmFtZSkKICAgICAgICAudGhlbihtID0+IChnbG9iYWxUaGlzW25hbWUucmVwbGFjZSgvKC4qXC98XC5bXlwvLl0rJCkvZywgJycpXSA9IG0pKQogICAgICAgIC5jYXRjaCgoKSA9PiByZXBsLnByaW50U3RhdHVzKGBFUlJPUjogbW9kdWxlICcke25hbWV9JyBub3QgZm91bmRgKSksCiAgICAnaW1wb3J0IGEgbW9kdWxlJwogIF07CiAgcmVwbC5kaXJlY3RpdmVzLmQgPSBbKCkgPT4gZ2xvYmFsVGhpcy5kYWVtb24oKSwgJ2RldGFjaCddOwogIGNvbnNvbGUubG9nID0gcmVwbC5wcmludEZ1bmN0aW9uKCguLi5hcmdzKSA9PiB7CiAgICBsb2coJ0xPRycsIGNvbnNvbGUuY29uZmlnKHJlcGwuaW5zcGVjdE9wdGlvbnMpLCAuLi5hcmdzKTsKICB9KTsKICByZXBsLnJ1bigpOwogIHJldHVybiByZXBsOwp9CgpmdW5jdGlvbiBtYWluKC4uLmFyZ3MpIHsKICBjb25zdCBiYXNlID0gc2NyaXB0TmFtZSgpLnJlcGxhY2UoL1wuW2Etel0qJC8sICcnKTsKCiAgY29uc3QgY29uZmlnID0gUmVhZEpTT04oYC4ke2Jhc2V9LWNvbmZpZ2ApID8/IHt9OwoKICBnbG9iYWxUaGlzLmNvbnNvbGUgPSBuZXcgQ29uc29sZShzdGQuZXJyLCB7CiAgICBpbnNwZWN0T3B0aW9uczogeyBkZXB0aDogSW5maW5pdHksIGNvbXBhY3Q6IDIsIG1heEFycmF5TGVuZ3RoOiBJbmZpbml0eSwgY3VzdG9tSW5zcGVjdDogdHJ1ZSB9CiAgfSk7CgogIGxldCBwYXJhbXMgPSBnZXRPcHQoCiAgICB7CiAgICAgIHZlcmJvc2U6IFtmYWxzZSwgKGEsIHYpID0+ICh2IHwgMCkgKyAxLCAndiddLAogICAgICBsaXN0ZW46IFtmYWxzZSwgbnVsbCwgJ2wnXSwKICAgICAgY29ubmVjdDogW2ZhbHNlLCBudWxsLCAnYyddLAogICAgICBjbGllbnQ6IFtmYWxzZSwgbnVsbCwgJ0MnXSwKICAgICAgc2VydmVyOiBbZmFsc2UsIG51bGwsICdTJ10sCiAgICAgIGRlYnVnOiBbZmFsc2UsIG51bGwsICd4J10sCiAgICAgIHRsczogW2ZhbHNlLCAodiwgcHYsIG8pID0+ICgoby50bHMgPSB0cnVlKSwgdHJ1ZSksICd0J10sCiAgICAgICduby10bHMnOiBbZmFsc2UsICh2LCBwdiwgbykgPT4gKChvLnRscyA9IGZhbHNlKSwgdHJ1ZSksICdUJ10sCiAgICAgIGFkZHJlc3M6IFt0cnVlLCBudWxsLCAnYSddLAogICAgICBwb3J0OiBbdHJ1ZSwgbnVsbCwgJ3AnXSwKICAgICAgcXVpZXQ6IFtmYWxzZSwgbnVsbCwgJ3EnXSwKICAgICAgJ3NzbC1jZXJ0JzogW3RydWUsIG51bGxdLAogICAgICAnc3NsLXByaXZhdGUta2V5JzogW3RydWUsIG51bGxdLAogICAgICAnc3NsLWNhJzogW3RydWUsIG51bGxdLAogICAgICAnQCc6ICdhZGRyZXNzLHBvcnQnCiAgICB9LAogICAgYXJncwogICk7CiAgaWYocGFyYW1zWyduby10bHMnXSA9PT0gdHJ1ZSkgcGFyYW1zLnRscyA9IGZhbHNlOwogIGNvbnN0IHsKICAgIGFkZHJlc3MgPSAnMC4wLjAuMCcsCiAgICBwb3J0ID0gODk5OSwKICAgICdzc2wtY2VydCc6IHNzbENlcnQgPSAnbG9jYWxob3N0LmNydCcsCiAgICAnc3NsLXByaXZhdGUta2V5Jzogc3NsUHJpdmF0ZUtleSA9ICdsb2NhbGhvc3Qua2V5JywKICAgICdzc2wtY2EnOiBzc2xDQSA9ICcvZXRjL3NzbC9jZXJ0cy9jYS1jZXJ0aWZpY2F0ZXMuY3J0JywKICAgIHF1aWV0ID0gZmFsc2UsCiAgICBkZWJ1ZyA9IGZhbHNlLAogICAgdGxzID0gdHJ1ZQogIH0gPSBwYXJhbXM7CiAgY29uc3QgbGlzdGVuID0gcGFyYW1zLmNvbm5lY3QgJiYgIXBhcmFtcy5saXN0ZW4gPyBmYWxzZSA6IHRydWU7CiAgLy9jb25zdCBzZXJ2ZXIgPSAhcGFyYW1zLmNsaWVudCB8fCBwYXJhbXMuc2VydmVyOwogIGxldCBuYW1lID0gc2NyaXB0QXJnc1swXTsKICBuYW1lID0gbmFtZQogICAgLnJlcGxhY2UoLy4qXC8vLCAnJykKICAgIC5yZXBsYWNlKC8tL2csICcgJykKICAgIC5yZXBsYWNlKC9cLlteXC8uXSokLywgJycpOwoKICBsZXQgW3ByZWZpeCwgc3VmZml4XSA9IG5hbWUuc3BsaXQoJyAnKTsKCiAgbGV0IHByb3RvY29sID0gbmV3IFdlYWtNYXAoKTsKCiAgbGV0IHNvY2tldHMgPSAoZ2xvYmFsVGhpcy5zb2NrZXRzID8/PSBuZXcgU2V0KCkpOwoKICBjb25zdCBjcmVhdGVXUyA9IChnbG9iYWxUaGlzLmNyZWF0ZVdTID0gKHVybCwgY2FsbGJhY2tzLCBsaXN0ZW4pID0+IHsKICAgIGNvbnNvbGUubG9nKCdjcmVhdGVXUycsIHsgdXJsLCBjYWxsYmFja3MsIGxpc3RlbiB9KTsKCiAgICBzZXRMb2coCiAgICAgIHF1aWV0ID8gMCA6IExMTF9VU0VSIHwgKCgoZGVidWcgPyBMTExfSU5GTyA6IExMTF9XQVJOKSA8PCAxKSAtIDEpLAogICAgICBxdWlldCB8fCAhcGFyYW1zLmRlYnVnCiAgICAgICAgPyAoKSA9PiB7fQogICAgICAgIDogKGxldmVsLCBzdHIpID0+IHsKICAgICAgICAgICAgaWYoL0JJTkRfUFJPVE9DT0x8RFJPUF9QUk9UT0NPTHxDSEVDS19BQ0NFU1NfUklHSFRTfEFERF9IRUFERVJTLy50ZXN0KHN0cikpIHJldHVybjsKICAgICAgICAgICAgY29uc29sZS5sb2cobG9nTGV2ZWxzW2xldmVsXS5wYWRFbmQoMTApLCBzdHIudHJpbSgpKTsKICAgICAgICAgIH0KICAgICk7CgogICAgbGV0IG9wdGlvbnM7CiAgICBsZXQgY2hpbGQsIGRiZzsKICAgIGxldCBuZXRmbiA9IFtjbGllbnQsIHNlcnZlcl1bK2xpc3Rlbl07CiAgICBjb25zb2xlLmxvZygnY3JlYXRlV1MnLCB7IHVybCwgbmV0Zm4gfSk7CiAgICByZXR1cm4gbmV0Zm4oCiAgICAgIHVybCwKICAgICAgKG9wdGlvbnMgPSB7CiAgICAgICAgdGxzOiBwYXJhbXMudGxzLAogICAgICAgIHNzbENlcnQsCiAgICAgICAgc3NsUHJpdmF0ZUtleSwKICAgICAgICBzc2xDQSwKICAgICAgICBtaW1ldHlwZXM6IFsKICAgICAgICAgIFsnLnN2Z3onLCAnYXBwbGljYXRpb24vZ3ppcCddLAogICAgICAgICAgWycubWpzJywgJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnXSwKICAgICAgICAgIFsnLmVzJywgJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnXSwKICAgICAgICAgIFsnLndhc20nLCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJ10sCiAgICAgICAgICBbJy5lb3QnLCAnYXBwbGljYXRpb24vdm5kLm1zLWZvbnRvYmplY3QnXSwKICAgICAgICAgIFsnLmxpYicsICdhcHBsaWNhdGlvbi94LWFyY2hpdmUnXSwKICAgICAgICAgIFsnLmJ6MicsICdhcHBsaWNhdGlvbi94LWJ6aXAyJ10sCiAgICAgICAgICBbJy5naXRpZ25vcmUnLCAndGV4dC9wbGFpbiddLAogICAgICAgICAgWycuY21ha2UnLCAndGV4dC9wbGFpbiddLAogICAgICAgICAgWycuaGV4JywgJ3RleHQvcGxhaW4nXSwKICAgICAgICAgIFsnLm1kJywgJ3RleHQvcGxhaW4nXSwKICAgICAgICAgIFsnLnBieHByb2onLCAndGV4dC9wbGFpbiddLAogICAgICAgICAgWycud2F0JywgJ3RleHQvcGxhaW4nXSwKICAgICAgICAgIFsnLmMnLCAndGV4dC94LWMnXSwKICAgICAgICAgIFsnLmgnLCAndGV4dC94LWMnXSwKICAgICAgICAgIFsnLmNwcCcsICd0ZXh0L3gtYysrJ10sCiAgICAgICAgICBbJy5ocHAnLCAndGV4dC94LWMrKyddLAogICAgICAgICAgWycuZmlsdGVycycsICd0ZXh0L3htbCddLAogICAgICAgICAgWycucGxpc3QnLCAndGV4dC94bWwnXSwKICAgICAgICAgIFsnLnN0b3J5Ym9hcmQnLCAndGV4dC94bWwnXSwKICAgICAgICAgIFsnLnZjeHByb2onLCAndGV4dC94bWwnXSwKICAgICAgICAgIFsnLmJhdCcsICd0ZXh0L3gtbXNkb3MtYmF0Y2gnXSwKICAgICAgICAgIFsnLm1tJywgJ3RleHQveC1vYmplY3RpdmUtYyddLAogICAgICAgICAgWycubScsICd0ZXh0L3gtb2JqZWN0aXZlLWMnXSwKICAgICAgICAgIFsnLnNoJywgJ3RleHQveC1zaGVsbHNjcmlwdCddCiAgICAgICAgXSwKICAgICAgICBtb3VudHM6IFsKICAgICAgICAgIFsnL3Byb3h5JywgJ2lwdjQ6MTI3LjAuMC4xOjIyJywgbnVsbCwgJ3Byb3h5LXdzLXJhdy13cyddLAogICAgICAgICAgWycvbHdzJywgJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jaC8nLCBudWxsLCAnJ10sCiAgICAgICAgICBbJy8nLCAnLicsICdkZWJ1Z2dlci5odG1sJ10sCiAgICAgICAgICBmdW5jdGlvbiogY29uZmlnKHJlcSwgcmVzKSB7CiAgICAgICAgICAgIGNvbnN0IHsgYm9keSwgaGVhZGVycyB9ID0gcmVxOwogICAgICAgICAgICBjb25zb2xlLmxvZygnL2NvbmZpZycsIHsgcmVxLCByZXMgfSk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCcqY29uZmlnJywgeyBib2R5LCBoZWFkZXJzIH0pOwogICAgICAgICAgICB5aWVsZCAne30nOwogICAgICAgICAgfSwKICAgICAgICAgIGZ1bmN0aW9uKiBmaWxlcyhyZXEsIHJlcykgewogICAgICAgICAgICBjb25zdCB7IGJvZHksIGhlYWRlcnMgfSA9IHJlcTsKICAgICAgICAgICAgeWllbGQgZnMKICAgICAgICAgICAgICAucmVhZGRpclN5bmMoJy4nKQogICAgICAgICAgICAgIC5zb3J0KCkKICAgICAgICAgICAgICAubWFwKGYgPT4gZiArICdcbicpCiAgICAgICAgICAgICAgLmpvaW4oJycpOwogICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgLi4udXJsLAogICAgICAgIC4uLmNhbGxiYWNrcywKICAgICAgICBibG9jazogZmFsc2UsCiAgICAgICAgb25Db25uZWN0KHdzLCByZXEpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdvbkNvbm5lY3QnLCB7IHdzLCByZXEgfSwgcmVxICYmIHJlcS5oZWFkZXJzKTsKCiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh3cywgewogICAgICAgICAgICBzZW5kTWVzc2FnZTogewogICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZW5kTWVzc2FnZShtc2cpIHsKICAgICAgICAgICAgICAgIGxldCByZXQgPSB0aGlzLnNlbmQoSlNPTi5zdHJpbmdpZnkobXNnKSk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgd3Muc2VuZE1lc3NhZ2UoYCwgbXNnLCBgKSA9ICR7cmV0fWApOwogICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRiZzogeyB2YWx1ZTogbnVsbCwgZW51bWVyYWJsZTogZmFsc2UgfQogICAgICAgICAgfSk7CgogICAgICAgICAgc29ja2V0cy5hZGQod3MpOwogICAgICAgIH0sCiAgICAgICAgb25DbG9zZSh3cykgewogICAgICAgICAgY29uc29sZS5sb2coJ29uQ2xvc2UnLCB3cyk7CiAgICAgICAgICBkYmcuY2xvc2UoKTsKCiAgICAgICAgICBwcm90b2NvbC5kZWxldGUod3MpOwogICAgICAgICAgc29ja2V0cy5kZWxldGUod3MpOwogICAgICAgIH0sCiAgICAgICAgb25FcnJvcih3cykgewogICAgICAgICAgY29uc29sZS5sb2coJ29uRXJyb3InLCB3cyk7CiAgICAgICAgfSwKICAgICAgICBvbkh0dHAocmVxLCByZXNwKSB7CiAgICAgICAgICBjb25zdCB7IG1ldGhvZCwgaGVhZGVycyB9ID0gcmVxOwogICAgICAgICAgLy9jb25zb2xlLmxvZygnXHgxYlszODs1OzMzbW9uSHR0cFx4MWJbMG0gW1xuICAnLCByZXEsICcsXG4gICcsIHJlc3AsICdcbl0nKTsKICAgICAgICAgIGNvbnN0IHsgYm9keSwgdXJsIH0gPSByZXNwOwogICAgICAgICAgLy9jb25zb2xlLmxvZygnXHgxYlszODs1OzMzbW9uSHR0cFx4MWJbMG0nLCB7IGJvZHkgfSk7CgogICAgICAgICAgY29uc3QgZmlsZSA9IHVybC5wYXRoLnNsaWNlKDEpOwogICAgICAgICAgY29uc3QgZGlyID0gZmlsZS5yZXBsYWNlKC9cL1teXC9dKiQvZywgJycpOwoKICAgICAgICAgIGlmKGZpbGUuZW5kc1dpdGgoJy5qcycpKSB7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ29uSHR0cCcsIHsgZmlsZSwgZGlyIH0pOwogICAgICAgICAgICBjb25zdCByZSA9IC9eKFxzKihpbXxleClwb3J0W15cbl0qZnJvbSBbJyJdKShbXi4vJyJdKikoWyciXVxzKjtbXHQgXSpcbj8pL2dtOwoKICAgICAgICAgICAgcmVzcC5ib2R5ID0gYm9keS5yZXBsYWNlQWxsKHJlLCAobWF0Y2gsIHAxLCBwMCwgcDIsIHAzLCBvZmZzZXQpID0+IHsKICAgICAgICAgICAgICBpZighL1tcL1wuXS8udGVzdChwMikpIHsKICAgICAgICAgICAgICAgIGxldCBmbmFtZSA9IGAke3AyfS5qc2A7CgogICAgICAgICAgICAgICAgaWYoIWZzLmV4aXN0c1N5bmMoZGlyICsgJy8nICsgZm5hbWUpKSByZXR1cm4gYC8qICR7bWF0Y2h9ICovYDsKCiAgICAgICAgICAgICAgICBtYXRjaCA9IFtwMSwgJy4vJyArIGZuYW1lLCBwM10uam9pbignJyk7CgogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnYXJncycsIHsgbWF0Y2gsIHAxLCBwMiwgcDMsIG9mZnNldCB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gcmVzcDsKICAgICAgICB9LAogICAgICAgIG9uTWVzc2FnZSh3cywgZGF0YSkgewogICAgICAgICAgY29uc29sZS5sb2coJ29uTWVzc2FnZScsIHdzLCBkYXRhKTsKICAgICAgICAgIC8vIHNob3dTZXNzaW9ucygpOwoKICAgICAgICAgIGhhbmRsZUNvbW1hbmQod3MsIGRhdGEpOwoKICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZUNvbW1hbmQod3MsIGRhdGEpIHsKICAgICAgICAgICAgbGV0IG9iaiA9IEpTT04ucGFyc2UoZGF0YSk7CgogICAgICAgICAgICBjb25zdCB7IGNvbW1hbmQsIC4uLnJlc3QgfSA9IG9iajsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ29uTWVzc2FnZScsIGNvbW1hbmQsIHJlc3QpOwogICAgICAgICAgICBjb25zdCB7IGNvbm5lY3QgPSB0cnVlLCBhZGRyZXNzID0gJzEyNy4wLjAuMTonICsgTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKDY1NTM1IC0gMTAyNCkpICsgMTAyNCwgYXJncyA9IFtdIH0gPSByZXN0OwoKICAgICAgICAgICAgc3dpdGNoIChjb21tYW5kKSB7CiAgICAgICAgICAgICAgY2FzZSAnc3RhcnQnOiB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnd3MnLCB3cyk7CiAgICAgICAgICAgICAgICBjaGlsZCA9IC8qd3MuY2hpbGQgPSAqLyBTdGFydERlYnVnZ2VyKGFyZ3MsIGNvbm5lY3QsIGFkZHJlc3MpOwogICAgICAgICAgICAgICAgY29uc3QgWywgc3Rkb3V0LCBzdGRlcnJdID0gY2hpbGQuc3RkaW87CiAgICAgICAgICAgICAgICBmb3IobGV0IGZkIG9mIFtzdGRvdXQsIHN0ZGVycl0pIHsKICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhgZmNudGwoJHtmZH0sIEZfR0VURkwpYCk7CiAgICAgICAgICAgICAgICAgIGxldCBmbGFncyA9IGZjbnRsKGZkLCBGX0dFVEZMKTsKICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhgZmNudGwoJHtmZH0sIEZfU0VURkwsIDB4JHtmbGFncy50b1N0cmluZygxNil9KWApOwogICAgICAgICAgICAgICAgICBmbGFncyB8PSBPX05PTkJMT0NLOwogICAgICAgICAgICAgICAgICBmY250bChmZCwgRl9TRVRGTCwgZmxhZ3MpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZm9yKGxldCBpID0gMTsgaSA8PSAyOyBpKyspIHsKICAgICAgICAgICAgICAgICAgbGV0IGZkID0gY2hpbGQuc3RkaW9baV07CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvcy5zZXRSZWFkSGFuZGxlcicsIGZkKTsKICAgICAgICAgICAgICAgICAgb3Muc2V0UmVhZEhhbmRsZXIoZmQsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICBsZXQgYnVmID0gbmV3IEFycmF5QnVmZmVyKDEwMjQpOwogICAgICAgICAgICAgICAgICAgIGxldCByID0gb3MucmVhZChmZCwgYnVmLCAwLCBidWYuYnl0ZUxlbmd0aCk7CgogICAgICAgICAgICAgICAgICAgIGlmKHIgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHRvU3RyaW5nKGJ1Zi5zbGljZSgwLCByKSk7CiAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGByZWFkKCR7ZmR9LCBidWYpID0gJHtyfSAoJHtxdW90ZShkYXRhLCAiJyIpfSlgKTsKCiAgICAgICAgICAgICAgICAgICAgICB3cy5zZW5kTWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdvdXRwdXQnLAogICAgICAgICAgICAgICAgICAgICAgICBjaGFubmVsOiBbJ3N0ZG91dCcsICdzdGRlcnInXVtpIC0gMV0sCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2hpbGQnLCBjaGlsZC5waWQpOwoKICAgICAgICAgICAgICAgIG9zLnNsZWVwKDEwMDApOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBjYXNlICdjb25uZWN0JzogewogICAgICAgICAgICAgICAgZGJnID0gd3MuZGJnID0gQ29ubmVjdERlYnVnZ2VyKGFkZHJlc3MsIChkYmcsIHNvY2spID0+IHsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3dhaXQoKSA9JywgY2hpbGQud2FpdCgpKTsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NoaWxkJywgY2hpbGQpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBvcy5zZXRXcml0ZUhhbmRsZXIoK2RiZywgYXN5bmMgKCkgPT4gewogICAgICAgICAgICAgICAgICBvcy5zZXRXcml0ZUhhbmRsZXIoK2RiZywgbnVsbCk7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBjb25uZWN0ZWQgdG8gJHthZGRyZXNzfWAsIGRiZyk7CgogICAgICAgICAgICAgICAgICBzb2NrZXRzLmFkZChkYmcpOwoKICAgICAgICAgICAgICAgICAgY29uc3QgY3dkID0gcHJvY2Vzcy5jd2QoKTsKICAgICAgICAgICAgICAgICAgd3Muc2VuZE1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICdyZXNwb25zZScsCiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2U6IHsKICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmQ6ICdzdGFydCcsCiAgICAgICAgICAgICAgICAgICAgICBhcmdzLAogICAgICAgICAgICAgICAgICAgICAgY3dkLAogICAgICAgICAgICAgICAgICAgICAgYWRkcmVzcwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBsZXQgbXNnOwoKICAgICAgICAgICAgICAgICAgd2hpbGUoZGJnLm9wZW4pIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgbXNnID0gYXdhaXQgRGVidWdnZXJQcm90b2NvbC5yZWFkKGRiZyk7CiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRGVidWdnZXJQcm90b2NvbC5yZWFkKCkgPScsIGVzY2FwZShtc2cpKTsKICAgICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBtc2cgPT0gJ3N0cmluZycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJldDsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gd3Muc2VuZChtc2cpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgd3Muc2VuZCgke3F1b3RlKG1zZywgIiciKX0pID0gJHtyZXR9YCk7CiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2xvc2VkIHNvY2tldCcsIGRiZyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNvY2tldHMuZGVsZXRlKGRiZyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHdzLnNlbmRNZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZW5kJywKICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb246ICdjbG9zZWQnCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2goZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgbWVzc2FnZSwgc3RhY2sgfSA9IGVycm9yOwogICAgICAgICAgICAgICAgICAgICAgd3Muc2VuZE1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLAogICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogeyBtZXNzYWdlLCBzdGFjayB9CiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgIGRiZy5jbG9zZSgpOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKG1zZyA9PT0gbnVsbCkgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2RiZycsIGRiZyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgY2FzZSAnZmlsZSc6IHsKICAgICAgICAgICAgICAgIGNvbnN0IHsgcGF0aCB9ID0gcmVzdDsKICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBmcy5yZWFkRmlsZVN5bmMocGF0aCwgJ3V0Zi04Jyk7CiAgICAgICAgICAgICAgICAvL3dzLnNlbmQoSlNPTi5zdHJpbmdpZnkoeyB0eXBlOiAncmVzcG9uc2UnLCByZXNwb25zZTogeyBjb21tYW5kOiAnZmlsZScsIHBhdGgsIGRhdGEgfSB9KSk7CgogICAgICAgICAgICAgICAgY29uc3QgbGV4ZXIgPSBuZXcgTGV4ZXIoZGF0YSwgcGF0aCk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbGV4ZXInLCBsZXhlcik7CiAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IFtdOwoKICAgICAgICAgICAgICAgIGZvcig7OykgewogICAgICAgICAgICAgICAgICBjb25zdCB7IHBvcywgc2l6ZSB9ID0gbGV4ZXI7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdsZXhlcicsIHsgcG9zLCBzaXplIH0pOwogICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gbGV4ZXIubmV4dCgpOwogICAgICAgICAgICAgICAgICBpZihyZXN1bHQuZG9uZSkgYnJlYWs7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHRva2VuID0gcmVzdWx0LnZhbHVlOwogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndG9rZW4nLCB7CiAgICAgICAgICAgICAgICAgICAgbGV4ZW1lOiB0b2tlbi5sZXhlbWUsCiAgICAgICAgICAgICAgICAgICAgaWQ6IHRva2VuLmlkLAogICAgICAgICAgICAgICAgICAgIGxvYzogdG9rZW4ubG9jICsgJycKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHsgdHlwZSwgaWQsIGxleGVtZSwgbG9jIH0gPSB0b2tlbjsKICAgICAgICAgICAgICAgICAgY29uc3QgeyBsaW5lLCBjb2x1bW4sIGZpbGUgfSA9IGxvYzsKICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygndG9rZW4nLCB7bGV4ZW1lLGlkLGxpbmV9KTsKCiAgICAgICAgICAgICAgICAgIGlmKCFsaW5lc1tsaW5lIC0gMV0pIGxpbmVzLnB1c2goW10pOwogICAgICAgICAgICAgICAgICBsZXQgYSA9IGxpbmVzW2xpbmUgLSAxXTsKICAgICAgICAgICAgICAgICAgYS5wdXNoKFtsZXhlbWUsIGlkXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbGluZXMnLCBsaW5lcyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgZGVmYXVsdDogewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NlbmQgdG8gZGVidWdnZXInLCBkYXRhKTsKICAgICAgICAgICAgICAgIERlYnVnZ2VyUHJvdG9jb2wuc2VuZChkYmcsIGRhdGEpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICAvKmxldCBwID0gbmV3IERlYnVnZ2VyUHJvdG9jb2woKTsKICAgICAgICBwcm90b2NvbC5zZXQod3MsIHApOyovCiAgICAgICAgfSwKICAgICAgICBvbkZkKGZkLCByZCwgd3IpIHsKICAgICAgICAgIC8vY29uc29sZS5sb2coJ29uRmQnLCB7IGZkLCByZCwgd3IgfSk7CiAgICAgICAgICBvcy5zZXRSZWFkSGFuZGxlcihmZCwgcmQpOwogICAgICAgICAgb3Muc2V0V3JpdGVIYW5kbGVyKGZkLCB3cik7CiAgICAgICAgfSwKICAgICAgICAuLi4odXJsICYmIHVybC5ob3N0ID8gdXJsIDoge30pCiAgICAgIH0pCiAgICApOwogIH0pOwogIGNvbnNvbGUubG9nKCdYWCcpOwoKICBkZWxldGUgZ2xvYmFsVGhpcy5ERUJVRzsKCiAgbGV0IGlucHV0QnVmID0gbmV3IEFycmF5QnVmZmVyKDEwKTsKICBvcy50dHlTZXRSYXcoMCk7CgogIG9zLnNldFJlYWRIYW5kbGVyKDAsICgpID0+IHsKICAgIGxldCByID0gZnMucmVhZFN5bmMoMCwgaW5wdXRCdWYsIDAsIGlucHV0QnVmLmJ5dGVMZW5ndGgpOwoKICAgIGlmKHIgPiAwKSB7CiAgICAgIGxldCBhID0gbmV3IFVpbnQ4QXJyYXkoaW5wdXRCdWYuc2xpY2UoMCwgcikpOwoKICAgICAgLy9jb25zb2xlLmxvZygnYScsIGEpOwoKICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGEubGVuZ3RoOyBpKyspIGlmKGFbaV0gPT0gMTMpIGFbaV0gPSAxMDsKCiAgICAgIGlmKGEubGVuZ3RoID09IDEgJiYgYVswXSA9PSAxMjcpIGEgPSBuZXcgVWludDhBcnJheShbOCwgMHgyMCwgOF0pOwoKICAgICAgaWYoYS5sZW5ndGggPT0gMSAmJiBhWzBdID09IDI3KSBzaG93U2Vzc2lvbnMoKTsKICAgICAgZWxzZSBmcy53cml0ZVN5bmMoMSwgYS5idWZmZXIpOwogICAgfQogIH0pOwoKICBmdW5jdGlvbiBzaG93U2Vzc2lvbnMoKSB7CiAgICBsZXQgc2Vzc2lvbnMgPSBnZXRTZXNzaW9ucygpOwogICAgY29uc29sZS5sb2coJ3Nlc3Npb25zJywgY29uc29sZS5jb25maWcoeyBtYXhBcnJheUxlbmd0aDogSW5maW5pdHksIGRlcHRoOiA0LCBjdXN0b21JbnNwZWN0OiB0cnVlLCBjb21wYWN0OiAwIH0pLCBzZXNzaW9ucyk7CiAgfQoKICAvL3NldEludGVydmFsKCgpID0+IGNvbnNvbGUubG9nKCdpbnRlcnZhbCcpLCA1MDAwKTsKCiAgZ2xvYmFsVGhpcy53cyA9IGNyZWF0ZVdTKGB3c3M6Ly8ke2FkZHJlc3N9Ojg5OTgvd3NgLCB7fSwgdHJ1ZSk7CgogIGRlZmluZShnbG9iYWxUaGlzLCB7CiAgICBnZXQgY29ubmVjdGlvbnMoKSB7CiAgICAgIHJldHVybiBbLi4uZ2xvYmFsVGhpcy5zb2NrZXRzXTsKICAgIH0sCiAgICBnZXQgc29ja2xpc3QoKSB7CiAgICAgIHJldHVybiBbLi4uZ2xvYmFsVGhpcy5zb2NrZXRzXTsKICAgIH0sCiAgICBuZXQ6IHsgc2V0TG9nLCBMTExfVVNFUiwgTExMX05PVElDRSwgTExMX1dBUk4sIGNsaWVudCwgc2VydmVyIH0sCiAgICBTdGFydERlYnVnZ2VyLAogICAgQ29ubmVjdERlYnVnZ2VyLAogICAgRGVidWdnZXJQcm90b2NvbCwKICAgIHJlcGw6IFN0YXJ0UkVQTCgpLAogICAgZGFlbW9uKCkgewogICAgICByZXBsLnN0b3AoKTsKICAgICAgc3RkLnB1dHMoJ1xuZGV0YWNoaW5nLi4uJyk7CiAgICAgIGRhZW1vbigxLCAwKTsKICAgICAgc3RkLnB1dHMoJyBQSUQgJyArIGdldHBpZCgpICsgJ1xuJyk7CiAgICB9CiAgfSk7CiAKCiAgLy9sZXQgcmVwbCA9IFN0YXJ0UkVQTCgpOwoKICAvLyAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGdsb2JhbFRoaXMsICdERUJVRycsIHsgZ2V0OiBEZWJ1Z0ZsYWdzIH0pOwoKICAvKiBpZihsaXN0ZW4pIGNsaS5saXN0ZW4oY3JlYXRlV1MsIG9zKTsKICBlbHNlIGNsaS5jb25uZWN0KGNyZWF0ZVdTLCBvcyk7CiovCiAgZnVuY3Rpb24gcXVpdCh3aHkpIHsKICAgIGNvbnNvbGUubG9nKGBxdWl0KCcke3doeX0nKWApOwoKICAgIGxldCBjZmcgPSB7IGluc3BlY3RPcHRpb25zOiBjb25zb2xlLm9wdGlvbnMgfTsKICAgIFdyaXRlSlNPTihgLiR7YmFzZX0tY29uZmlnYCwgY2ZnKTsKICAgIC8vIHJlcGwuY2xlYW51cCh3aHkpOwogIH0KfQoKdHJ5IHsKICBtYWluKC4uLnNjcmlwdEFyZ3Muc2xpY2UoMSkpOwp9IGNhdGNoKGVycm9yKSB7CiAgY29uc29sZS5sb2coYEZBSUw6ICR7ZXJyb3I/Lm1lc3NhZ2UgPz8gZXJyb3J9XG4ke2Vycm9yPy5zdGFja31gKTsKfSBmaW5hbGx5IHsKICAvL2NvbnNvbGUubG9nKCdTVUNDRVNTJyk7Cn0KAAAAAAAAAAA7OwAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAsBwAAAAAAACwHAAAAAAAAAAAAAAAAPC/"
				],
				[
					318,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAAA7OwAAaW1wb3J0ICogYXMgc3RkIGZyb20gJ3N0ZCc7CmltcG9ydCAqIGFzIG9zIGZyb20gJ29zJzsKaW1wb3J0IHsgc2V0SW50ZXJ2YWwgfSBmcm9tICd0aW1lcnMnOwppbXBvcnQgKiBhcyBkZWVwIGZyb20gJy4vbGliL2RlZXAuanMnOwppbXBvcnQgKiBhcyBwYXRoIGZyb20gJy4vbGliL3BhdGguanMnOwppbXBvcnQgeyBkYWVtb24sIGF0ZXhpdCwgZ2V0cGlkLCB0b1N0cmluZywgZXNjYXBlLCBxdW90ZSwgZGVmaW5lLCBleHRlbmRBcnJheSwgZ2V0T3B0IH0gZnJvbSAndXRpbCc7CmltcG9ydCB7IENvbnNvbGUgfSBmcm9tICcuL3F1aWNranMvcWpzLW1vZHVsZXMvbGliL2NvbnNvbGUuanMnOwppbXBvcnQgUkVQTCBmcm9tICcuL3F1aWNranMvcWpzLW1vZHVsZXMvbGliL3JlcGwuanMnOwppbXBvcnQgaW5zcGVjdCBmcm9tICcuL2xpYi9vYmplY3RJbnNwZWN0LmpzJzsKaW1wb3J0ICogYXMgVGVybWluYWwgZnJvbSAnLi90ZXJtaW5hbC5qcyc7CmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJzsKaW1wb3J0IHsgc2V0TG9nLCBsb2dMZXZlbHMsIGdldFNlc3Npb25zLCBMTExfVVNFUiwgTExMX0lORk8sIExMTF9OT1RJQ0UsIExMTF9XQVJOLCBjbGllbnQsIHNlcnZlciB9IGZyb20gJ25ldCc7CmltcG9ydCB7IERlYnVnZ2VyUHJvdG9jb2wgfSBmcm9tICcuL2RlYnVnZ2VycHJvdG9jb2wuanMnOwppbXBvcnQgeyBTdGFydERlYnVnZ2VyLCBDb25uZWN0RGVidWdnZXIgfSBmcm9tICcuL2RlYnVnZ2VyLmpzJzsKaW1wb3J0IHsgZmNudGwsIEZfR0VURkwsIEZfU0VURkwsIE9fTk9OQkxPQ0sgfSBmcm9tICcuL3F1aWNranMvcWpzLWZmaS9saWIvZmNudGwuanMnOwppbXBvcnQgeyBSZWFkSlNPTiwgV3JpdGVKU09OIH0gZnJvbSAnLi9pby1oZWxwZXJzLmpzJzsKCmV4dGVuZEFycmF5KEFycmF5LnByb3RvdHlwZSk7Cgpjb25zdCBzY3JpcHROYW1lID0gKGFyZyA9IHNjcmlwdEFyZ3NbMF0pID0+IHBhdGguYmFzZW5hbWUoYXJnLCBwYXRoLmV4dG5hbWUoYXJnKSk7CgphdGV4aXQoKCkgPT4gewogIGNvbnNvbGUubG9nKCdhdGV4aXQnLCBhdGV4aXQpOwogIGxldCBzdGFjayA9IG5ldyBFcnJvcignJykuc3RhY2s7CiAgY29uc29sZS5sb2coJ3N0YWNrOicsIHN0YWNrKTsKfSk7CgpmdW5jdGlvbiBTdGFydFJFUEwocHJlZml4ID0gc2NyaXB0TmFtZSgpLCBzdWZmaXggPSAnJykgewogIGxldCByZXBsID0gbmV3IFJFUEwoYFx4MWJbMzg7NTsxNjVtJHtwcmVmaXh9IFx4MWJbMzg7NTszOW0ke3N1ZmZpeH1ceDFiWzBtYCwgZmFsc2UpOwogIHJlcGwuaGlzdG9yeUxvYWQobnVsbCwgZnMpOwogIHJlcGwubG9hZFNhdmVPcHRpb25zKCk7CiAgcmVwbC5pbnNwZWN0T3B0aW9ucyA9IHsgLi4uY29uc29sZS5vcHRpb25zLCBtYXhBcnJheUxlbmd0aDogSW5maW5pdHksIGNvbXBhY3Q6IDIgfTsKICBsZXQgeyBsb2cgfSA9IGNvbnNvbGU7CgogIHJlcGwuZGlyZWN0aXZlcy5pID0gWwogICAgbmFtZSA9PgogICAgICBpbXBvcnQobmFtZSkKICAgICAgICAudGhlbihtID0+IChnbG9iYWxUaGlzW25hbWUucmVwbGFjZSgvKC4qXC98XC5bXlwvLl0rJCkvZywgJycpXSA9IG0pKQogICAgICAgIC5jYXRjaCgoKSA9PiByZXBsLnByaW50U3RhdHVzKGBFUlJPUjogbW9kdWxlICcke25hbWV9JyBub3QgZm91bmRgKSksCiAgICAnaW1wb3J0IGEgbW9kdWxlJwogIF07CiAgcmVwbC5kaXJlY3RpdmVzLmQgPSBbKCkgPT4gZ2xvYmFsVGhpcy5kYWVtb24oKSwgJ2RldGFjaCddOwogIGNvbnNvbGUubG9nID0gcmVwbC5wcmludEZ1bmN0aW9uKCguLi5hcmdzKSA9PiB7CiAgICBsb2coJ0xPRycsIGNvbnNvbGUuY29uZmlnKHJlcGwuaW5zcGVjdE9wdGlvbnMpLCAuLi5hcmdzKTsKICB9KTsKICByZXBsLnJ1bigpOwogIHJldHVybiByZXBsOwp9CgpmdW5jdGlvbiBtYWluKC4uLmFyZ3MpIHsKICBjb25zdCBiYXNlID0gc2NyaXB0TmFtZSgpLnJlcGxhY2UoL1wuW2Etel0qJC8sICcnKTsKCiAgY29uc3QgY29uZmlnID0gUmVhZEpTT04oYC4ke2Jhc2V9LWNvbmZpZ2ApID8/IHt9OwoKICBnbG9iYWxUaGlzLmNvbnNvbGUgPSBuZXcgQ29uc29sZShzdGQuZXJyLCB7CiAgICBpbnNwZWN0T3B0aW9uczogeyBkZXB0aDogSW5maW5pdHksIGNvbXBhY3Q6IDIsIG1heEFycmF5TGVuZ3RoOiBJbmZpbml0eSwgY3VzdG9tSW5zcGVjdDogdHJ1ZSB9CiAgfSk7CgogIGxldCBwYXJhbXMgPSBnZXRPcHQoCiAgICB7CiAgICAgIHZlcmJvc2U6IFtmYWxzZSwgKGEsIHYpID0+ICh2IHwgMCkgKyAxLCAndiddLAogICAgICBsaXN0ZW46IFtmYWxzZSwgbnVsbCwgJ2wnXSwKICAgICAgY29ubmVjdDogW2ZhbHNlLCBudWxsLCAnYyddLAogICAgICBjbGllbnQ6IFtmYWxzZSwgbnVsbCwgJ0MnXSwKICAgICAgc2VydmVyOiBbZmFsc2UsIG51bGwsICdTJ10sCiAgICAgIGRlYnVnOiBbZmFsc2UsIG51bGwsICd4J10sCiAgICAgIHRsczogW2ZhbHNlLCAodiwgcHYsIG8pID0+ICgoby50bHMgPSB0cnVlKSwgdHJ1ZSksICd0J10sCiAgICAgICduby10bHMnOiBbZmFsc2UsICh2LCBwdiwgbykgPT4gKChvLnRscyA9IGZhbHNlKSwgdHJ1ZSksICdUJ10sCiAgICAgIGFkZHJlc3M6IFt0cnVlLCBudWxsLCAnYSddLAogICAgICBwb3J0OiBbdHJ1ZSwgbnVsbCwgJ3AnXSwKICAgICAgcXVpZXQ6IFtmYWxzZSwgbnVsbCwgJ3EnXSwKICAgICAgJ3NzbC1jZXJ0JzogW3RydWUsIG51bGxdLAogICAgICAnc3NsLXByaXZhdGUta2V5JzogW3RydWUsIG51bGxdLAogICAgICAnc3NsLWNhJzogW3RydWUsIG51bGxdLAogICAgICAnQCc6ICdhZGRyZXNzLHBvcnQnCiAgICB9LAogICAgYXJncwogICk7CiAgaWYocGFyYW1zWyduby10bHMnXSA9PT0gdHJ1ZSkgcGFyYW1zLnRscyA9IGZhbHNlOwogIGNvbnN0IHsKICAgIGFkZHJlc3MgPSAnMC4wLjAuMCcsCiAgICBwb3J0ID0gODk5OSwKICAgICdzc2wtY2VydCc6IHNzbENlcnQgPSAnbG9jYWxob3N0LmNydCcsCiAgICAnc3NsLXByaXZhdGUta2V5Jzogc3NsUHJpdmF0ZUtleSA9ICdsb2NhbGhvc3Qua2V5JywKICAgICdzc2wtY2EnOiBzc2xDQSA9ICcvZXRjL3NzbC9jZXJ0cy9jYS1jZXJ0aWZpY2F0ZXMuY3J0JywKICAgIHF1aWV0ID0gZmFsc2UsCiAgICBkZWJ1ZyA9IGZhbHNlLAogICAgdGxzID0gdHJ1ZQogIH0gPSBwYXJhbXM7CiAgY29uc3QgbGlzdGVuID0gcGFyYW1zLmNvbm5lY3QgJiYgIXBhcmFtcy5saXN0ZW4gPyBmYWxzZSA6IHRydWU7CiAgLy9jb25zdCBzZXJ2ZXIgPSAhcGFyYW1zLmNsaWVudCB8fCBwYXJhbXMuc2VydmVyOwogIGxldCBuYW1lID0gc2NyaXB0QXJnc1swXTsKICBuYW1lID0gbmFtZQogICAgLnJlcGxhY2UoLy4qXC8vLCAnJykKICAgIC5yZXBsYWNlKC8tL2csICcgJykKICAgIC5yZXBsYWNlKC9cLlteXC8uXSokLywgJycpOwoKICBsZXQgW3ByZWZpeCwgc3VmZml4XSA9IG5hbWUuc3BsaXQoJyAnKTsKCiAgbGV0IHByb3RvY29sID0gbmV3IFdlYWtNYXAoKTsKCiAgbGV0IHNvY2tldHMgPSAoZ2xvYmFsVGhpcy5zb2NrZXRzID8/PSBuZXcgU2V0KCkpOwoKICBjb25zdCBjcmVhdGVXUyA9IChnbG9iYWxUaGlzLmNyZWF0ZVdTID0gKHVybCwgY2FsbGJhY2tzLCBsaXN0ZW4pID0+IHsKICAgIGNvbnNvbGUubG9nKCdjcmVhdGVXUycsIHsgdXJsLCBjYWxsYmFja3MsIGxpc3RlbiB9KTsKCiAgICBzZXRMb2coCiAgICAgIHF1aWV0ID8gMCA6IExMTF9VU0VSIHwgKCgoZGVidWcgPyBMTExfSU5GTyA6IExMTF9XQVJOKSA8PCAxKSAtIDEpLAogICAgICBxdWlldCB8fCAhcGFyYW1zLmRlYnVnCiAgICAgICAgPyAoKSA9PiB7fQogICAgICAgIDogKGxldmVsLCBzdHIpID0+IHsKICAgICAgICAgICAgaWYoL0JJTkRfUFJPVE9DT0x8RFJPUF9QUk9UT0NPTHxDSEVDS19BQ0NFU1NfUklHSFRTfEFERF9IRUFERVJTLy50ZXN0KHN0cikpIHJldHVybjsKICAgICAgICAgICAgY29uc29sZS5sb2cobG9nTGV2ZWxzW2xldmVsXS5wYWRFbmQoMTApLCBzdHIudHJpbSgpKTsKICAgICAgICAgIH0KICAgICk7CgogICAgbGV0IG9wdGlvbnM7CiAgICBsZXQgY2hpbGQsIGRiZzsKICAgIGxldCBuZXRmbiA9IFtjbGllbnQsIHNlcnZlcl1bK2xpc3Rlbl07CiAgICBjb25zb2xlLmxvZygnY3JlYXRlV1MnLCB7IHVybCwgbmV0Zm4gfSk7CiAgICByZXR1cm4gbmV0Zm4oCiAgICAgIHVybCwKICAgICAgKG9wdGlvbnMgPSB7CiAgICAgICAgdGxzOiBwYXJhbXMudGxzLAogICAgICAgIHNzbENlcnQsCiAgICAgICAgc3NsUHJpdmF0ZUtleSwKICAgICAgICBzc2xDQSwKICAgICAgICBtaW1ldHlwZXM6IFsKICAgICAgICAgIFsnLnN2Z3onLCAnYXBwbGljYXRpb24vZ3ppcCddLAogICAgICAgICAgWycubWpzJywgJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnXSwKICAgICAgICAgIFsnLmVzJywgJ2FwcGxpY2F0aW9uL2phdmFzY3JpcHQnXSwKICAgICAgICAgIFsnLndhc20nLCAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJ10sCiAgICAgICAgICBbJy5lb3QnLCAnYXBwbGljYXRpb24vdm5kLm1zLWZvbnRvYmplY3QnXSwKICAgICAgICAgIFsnLmxpYicsICdhcHBsaWNhdGlvbi94LWFyY2hpdmUnXSwKICAgICAgICAgIFsnLmJ6MicsICdhcHBsaWNhdGlvbi94LWJ6aXAyJ10sCiAgICAgICAgICBbJy5naXRpZ25vcmUnLCAndGV4dC9wbGFpbiddLAogICAgICAgICAgWycuY21ha2UnLCAndGV4dC9wbGFpbiddLAogICAgICAgICAgWycuaGV4JywgJ3RleHQvcGxhaW4nXSwKICAgICAgICAgIFsnLm1kJywgJ3RleHQvcGxhaW4nXSwKICAgICAgICAgIFsnLnBieHByb2onLCAndGV4dC9wbGFpbiddLAogICAgICAgICAgWycud2F0JywgJ3RleHQvcGxhaW4nXSwKICAgICAgICAgIFsnLmMnLCAndGV4dC94LWMnXSwKICAgICAgICAgIFsnLmgnLCAndGV4dC94LWMnXSwKICAgICAgICAgIFsnLmNwcCcsICd0ZXh0L3gtYysrJ10sCiAgICAgICAgICBbJy5ocHAnLCAndGV4dC94LWMrKyddLAogICAgICAgICAgWycuZmlsdGVycycsICd0ZXh0L3htbCddLAogICAgICAgICAgWycucGxpc3QnLCAndGV4dC94bWwnXSwKICAgICAgICAgIFsnLnN0b3J5Ym9hcmQnLCAndGV4dC94bWwnXSwKICAgICAgICAgIFsnLnZjeHByb2onLCAndGV4dC94bWwnXSwKICAgICAgICAgIFsnLmJhdCcsICd0ZXh0L3gtbXNkb3MtYmF0Y2gnXSwKICAgICAgICAgIFsnLm1tJywgJ3RleHQveC1vYmplY3RpdmUtYyddLAogICAgICAgICAgWycubScsICd0ZXh0L3gtb2JqZWN0aXZlLWMnXSwKICAgICAgICAgIFsnLnNoJywgJ3RleHQveC1zaGVsbHNjcmlwdCddCiAgICAgICAgXSwKICAgICAgICBtb3VudHM6IFsKICAgICAgICAgIFsnL3Byb3h5JywgJ2lwdjQ6MTI3LjAuMC4xOjIyJywgbnVsbCwgJ3Byb3h5LXdzLXJhdy13cyddLAogICAgICAgICAgWycvbHdzJywgJ2h0dHBzOi8vd3d3Lmdvb2dsZS5jaC8nLCBudWxsLCAnJ10sCiAgICAgICAgICBbJy8nLCAnLicsICdkZWJ1Z2dlci5odG1sJ10sCiAgICAgICAgICBmdW5jdGlvbiogY29uZmlnKHJlcSwgcmVzKSB7CiAgICAgICAgICAgIGNvbnN0IHsgYm9keSwgaGVhZGVycyB9ID0gcmVxOwogICAgICAgICAgICBjb25zb2xlLmxvZygnL2NvbmZpZycsIHsgcmVxLCByZXMgfSk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCcqY29uZmlnJywgeyBib2R5LCBoZWFkZXJzIH0pOwogICAgICAgICAgICB5aWVsZCAne30nOwogICAgICAgICAgfSwKICAgICAgICAgIGZ1bmN0aW9uKiBmaWxlcyhyZXEsIHJlcykgewogICAgICAgICAgICBjb25zdCB7IGJvZHksIGhlYWRlcnMgfSA9IHJlcTsKICAgICAgICAgICAgeWllbGQgZnMKICAgICAgICAgICAgICAucmVhZGRpclN5bmMoJy4nKQogICAgICAgICAgICAgIC5zb3J0KCkKICAgICAgICAgICAgICAubWFwKGYgPT4gZiArICdcbicpCiAgICAgICAgICAgICAgLmpvaW4oJycpOwogICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgLi4udXJsLAogICAgICAgIC4uLmNhbGxiYWNrcywKICAgICAgICBibG9jazogZmFsc2UsCiAgICAgICAgb25Db25uZWN0KHdzLCByZXEpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdvbkNvbm5lY3QnLCB7IHdzLCByZXEgfSwgcmVxICYmIHJlcS5oZWFkZXJzKTsKCiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh3cywgewogICAgICAgICAgICBzZW5kTWVzc2FnZTogewogICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZW5kTWVzc2FnZShtc2cpIHsKICAgICAgICAgICAgICAgIGxldCByZXQgPSB0aGlzLnNlbmQoSlNPTi5zdHJpbmdpZnkobXNnKSk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgd3Muc2VuZE1lc3NhZ2UoYCwgbXNnLCBgKSA9ICR7cmV0fWApOwogICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGRiZzogeyB2YWx1ZTogbnVsbCwgZW51bWVyYWJsZTogZmFsc2UgfQogICAgICAgICAgfSk7CgogICAgICAgICAgc29ja2V0cy5hZGQod3MpOwogICAgICAgIH0sCiAgICAgICAgb25DbG9zZSh3cykgewogICAgICAgICAgY29uc29sZS5sb2coJ29uQ2xvc2UnLCB3cyk7CiAgICAgICAgICBkYmcuY2xvc2UoKTsKCiAgICAgICAgICBwcm90b2NvbC5kZWxldGUod3MpOwogICAgICAgICAgc29ja2V0cy5kZWxldGUod3MpOwogICAgICAgIH0sCiAgICAgICAgb25FcnJvcih3cykgewogICAgICAgICAgY29uc29sZS5sb2coJ29uRXJyb3InLCB3cyk7CiAgICAgICAgfSwKICAgICAgICBvbkh0dHAocmVxLCByZXNwKSB7CiAgICAgICAgICBjb25zdCB7IG1ldGhvZCwgaGVhZGVycyB9ID0gcmVxOwogICAgICAgICAgLy9jb25zb2xlLmxvZygnXHgxYlszODs1OzMzbW9uSHR0cFx4MWJbMG0gW1xuICAnLCByZXEsICcsXG4gICcsIHJlc3AsICdcbl0nKTsKICAgICAgICAgIGNvbnN0IHsgYm9keSwgdXJsIH0gPSByZXNwOwogICAgICAgICAgLy9jb25zb2xlLmxvZygnXHgxYlszODs1OzMzbW9uSHR0cFx4MWJbMG0nLCB7IGJvZHkgfSk7CgogICAgICAgICAgY29uc3QgZmlsZSA9IHVybC5wYXRoLnNsaWNlKDEpOwogICAgICAgICAgY29uc3QgZGlyID0gZmlsZS5yZXBsYWNlKC9cL1teXC9dKiQvZywgJycpOwoKICAgICAgICAgIGlmKGZpbGUuZW5kc1dpdGgoJy5qcycpKSB7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ29uSHR0cCcsIHsgZmlsZSwgZGlyIH0pOwogICAgICAgICAgICBjb25zdCByZSA9IC9eKFxzKihpbXxleClwb3J0W15cbl0qZnJvbSBbJyJdKShbXi4vJyJdKikoWyciXVxzKjtbXHQgXSpcbj8pL2dtOwoKICAgICAgICAgICAgcmVzcC5ib2R5ID0gYm9keS5yZXBsYWNlQWxsKHJlLCAobWF0Y2gsIHAxLCBwMCwgcDIsIHAzLCBvZmZzZXQpID0+IHsKICAgICAgICAgICAgICBpZighL1tcL1wuXS8udGVzdChwMikpIHsKICAgICAgICAgICAgICAgIGxldCBmbmFtZSA9IGAke3AyfS5qc2A7CgogICAgICAgICAgICAgICAgaWYoIWZzLmV4aXN0c1N5bmMoZGlyICsgJy8nICsgZm5hbWUpKSByZXR1cm4gYC8qICR7bWF0Y2h9ICovYDsKCiAgICAgICAgICAgICAgICBtYXRjaCA9IFtwMSwgJy4vJyArIGZuYW1lLCBwM10uam9pbignJyk7CgogICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnYXJncycsIHsgbWF0Y2gsIHAxLCBwMiwgcDMsIG9mZnNldCB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gcmVzcDsKICAgICAgICB9LAogICAgICAgIG9uTWVzc2FnZSh3cywgZGF0YSkgewogICAgICAgICAgY29uc29sZS5sb2coJ29uTWVzc2FnZScsIHdzLCBkYXRhKTsKICAgICAgICAgIC8vIHNob3dTZXNzaW9ucygpOwoKICAgICAgICAgIGhhbmRsZUNvbW1hbmQod3MsIGRhdGEpOwoKICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZUNvbW1hbmQod3MsIGRhdGEpIHsKICAgICAgICAgICAgbGV0IG9iaiA9IEpTT04ucGFyc2UoZGF0YSk7CgogICAgICAgICAgICBjb25zdCB7IGNvbW1hbmQsIC4uLnJlc3QgfSA9IG9iajsKICAgICAgICAgICAgLy8gY29uc29sZS5sb2coJ29uTWVzc2FnZScsIGNvbW1hbmQsIHJlc3QpOwogICAgICAgICAgICBjb25zdCB7IGNvbm5lY3QgPSB0cnVlLCBhZGRyZXNzID0gJzEyNy4wLjAuMTonICsgTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogKDY1NTM1IC0gMTAyNCkpICsgMTAyNCwgYXJncyA9IFtdIH0gPSByZXN0OwoKICAgICAgICAgICAgc3dpdGNoIChjb21tYW5kKSB7CiAgICAgICAgICAgICAgY2FzZSAnc3RhcnQnOiB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnd3MnLCB3cyk7CiAgICAgICAgICAgICAgICBjaGlsZCA9IC8qd3MuY2hpbGQgPSAqLyBTdGFydERlYnVnZ2VyKGFyZ3MsIGNvbm5lY3QsIGFkZHJlc3MpOwogICAgICAgICAgICAgICAgY29uc3QgWywgc3Rkb3V0LCBzdGRlcnJdID0gY2hpbGQuc3RkaW87CiAgICAgICAgICAgICAgICBmb3IobGV0IGZkIG9mIFtzdGRvdXQsIHN0ZGVycl0pIHsKICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhgZmNudGwoJHtmZH0sIEZfR0VURkwpYCk7CiAgICAgICAgICAgICAgICAgIGxldCBmbGFncyA9IGZjbnRsKGZkLCBGX0dFVEZMKTsKICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhgZmNudGwoJHtmZH0sIEZfU0VURkwsIDB4JHtmbGFncy50b1N0cmluZygxNil9KWApOwogICAgICAgICAgICAgICAgICBmbGFncyB8PSBPX05PTkJMT0NLOwogICAgICAgICAgICAgICAgICBmY250bChmZCwgRl9TRVRGTCwgZmxhZ3MpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZm9yKGxldCBpID0gMTsgaSA8PSAyOyBpKyspIHsKICAgICAgICAgICAgICAgICAgbGV0IGZkID0gY2hpbGQuc3RkaW9baV07CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvcy5zZXRSZWFkSGFuZGxlcicsIGZkKTsKICAgICAgICAgICAgICAgICAgb3Muc2V0UmVhZEhhbmRsZXIoZmQsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICBsZXQgYnVmID0gbmV3IEFycmF5QnVmZmVyKDEwMjQpOwogICAgICAgICAgICAgICAgICAgIGxldCByID0gb3MucmVhZChmZCwgYnVmLCAwLCBidWYuYnl0ZUxlbmd0aCk7CgogICAgICAgICAgICAgICAgICAgIGlmKHIgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHRvU3RyaW5nKGJ1Zi5zbGljZSgwLCByKSk7CiAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGByZWFkKCR7ZmR9LCBidWYpID0gJHtyfSAoJHtxdW90ZShkYXRhLCAiJyIpfSlgKTsKCiAgICAgICAgICAgICAgICAgICAgICB3cy5zZW5kTWVzc2FnZSh7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdvdXRwdXQnLAogICAgICAgICAgICAgICAgICAgICAgICBjaGFubmVsOiBbJ3N0ZG91dCcsICdzdGRlcnInXVtpIC0gMV0sCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2hpbGQnLCBjaGlsZC5waWQpOwoKICAgICAgICAgICAgICAgIG9zLnNsZWVwKDEwMDApOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBjYXNlICdjb25uZWN0JzogewogICAgICAgICAgICAgICAgZGJnID0gd3MuZGJnID0gQ29ubmVjdERlYnVnZ2VyKGFkZHJlc3MsIChkYmcsIHNvY2spID0+IHsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3dhaXQoKSA9JywgY2hpbGQud2FpdCgpKTsKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NoaWxkJywgY2hpbGQpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBvcy5zZXRXcml0ZUhhbmRsZXIoK2RiZywgYXN5bmMgKCkgPT4gewogICAgICAgICAgICAgICAgICBvcy5zZXRXcml0ZUhhbmRsZXIoK2RiZywgbnVsbCk7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBjb25uZWN0ZWQgdG8gJHthZGRyZXNzfWAsIGRiZyk7CgogICAgICAgICAgICAgICAgICBzb2NrZXRzLmFkZChkYmcpOwoKICAgICAgICAgICAgICAgICAgY29uc3QgY3dkID0gcHJvY2Vzcy5jd2QoKTsKICAgICAgICAgICAgICAgICAgd3Muc2VuZE1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICdyZXNwb25zZScsCiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2U6IHsKICAgICAgICAgICAgICAgICAgICAgIGNvbW1hbmQ6ICdzdGFydCcsCiAgICAgICAgICAgICAgICAgICAgICBhcmdzLAogICAgICAgICAgICAgICAgICAgICAgY3dkLAogICAgICAgICAgICAgICAgICAgICAgYWRkcmVzcwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBsZXQgbXNnOwoKICAgICAgICAgICAgICAgICAgd2hpbGUoZGJnLm9wZW4pIHsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgbXNnID0gYXdhaXQgRGVidWdnZXJQcm90b2NvbC5yZWFkKGRiZyk7CiAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnRGVidWdnZXJQcm90b2NvbC5yZWFkKCkgPScsIGVzY2FwZShtc2cpKTsKICAgICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBtc2cgPT0gJ3N0cmluZycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJldDsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gd3Muc2VuZChtc2cpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhgd3Muc2VuZCgke3F1b3RlKG1zZywgIiciKX0pID0gJHtyZXR9YCk7CiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2xvc2VkIHNvY2tldCcsIGRiZyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHNvY2tldHMuZGVsZXRlKGRiZyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHdzLnNlbmRNZXNzYWdlKHsKICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZW5kJywKICAgICAgICAgICAgICAgICAgICAgICAgICByZWFzb246ICdjbG9zZWQnCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2goZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgbWVzc2FnZSwgc3RhY2sgfSA9IGVycm9yOwogICAgICAgICAgICAgICAgICAgICAgd3Muc2VuZE1lc3NhZ2UoewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLAogICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogeyBtZXNzYWdlLCBzdGFjayB9CiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgIGRiZy5jbG9zZSgpOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKG1zZyA9PT0gbnVsbCkgYnJlYWs7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2RiZycsIGRiZyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgY2FzZSAnZmlsZSc6IHsKICAgICAgICAgICAgICAgIGNvbnN0IHsgcGF0aCB9ID0gcmVzdDsKICAgICAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBmcy5yZWFkRmlsZVN5bmMocGF0aCwgJ3V0Zi04Jyk7CiAgICAgICAgICAgICAgICAvL3dzLnNlbmQoSlNPTi5zdHJpbmdpZnkoeyB0eXBlOiAncmVzcG9uc2UnLCByZXNwb25zZTogeyBjb21tYW5kOiAnZmlsZScsIHBhdGgsIGRhdGEgfSB9KSk7CgogICAgICAgICAgICAgICAgY29uc3QgbGV4ZXIgPSBuZXcgTGV4ZXIoZGF0YSwgcGF0aCk7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbGV4ZXInLCBsZXhlcik7CiAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IFtdOwoKICAgICAgICAgICAgICAgIGZvcig7OykgewogICAgICAgICAgICAgICAgICBjb25zdCB7IHBvcywgc2l6ZSB9ID0gbGV4ZXI7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdsZXhlcicsIHsgcG9zLCBzaXplIH0pOwogICAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gbGV4ZXIubmV4dCgpOwogICAgICAgICAgICAgICAgICBpZihyZXN1bHQuZG9uZSkgYnJlYWs7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHRva2VuID0gcmVzdWx0LnZhbHVlOwogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndG9rZW4nLCB7CiAgICAgICAgICAgICAgICAgICAgbGV4ZW1lOiB0b2tlbi5sZXhlbWUsCiAgICAgICAgICAgICAgICAgICAgaWQ6IHRva2VuLmlkLAogICAgICAgICAgICAgICAgICAgIGxvYzogdG9rZW4ubG9jICsgJycKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIGNvbnN0IHsgdHlwZSwgaWQsIGxleGVtZSwgbG9jIH0gPSB0b2tlbjsKICAgICAgICAgICAgICAgICAgY29uc3QgeyBsaW5lLCBjb2x1bW4sIGZpbGUgfSA9IGxvYzsKICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygndG9rZW4nLCB7bGV4ZW1lLGlkLGxpbmV9KTsKCiAgICAgICAgICAgICAgICAgIGlmKCFsaW5lc1tsaW5lIC0gMV0pIGxpbmVzLnB1c2goW10pOwogICAgICAgICAgICAgICAgICBsZXQgYSA9IGxpbmVzW2xpbmUgLSAxXTsKICAgICAgICAgICAgICAgICAgYS5wdXNoKFtsZXhlbWUsIGlkXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbGluZXMnLCBsaW5lcyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgZGVmYXVsdDogewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NlbmQgdG8gZGVidWdnZXInLCBkYXRhKTsKICAgICAgICAgICAgICAgIERlYnVnZ2VyUHJvdG9jb2wuc2VuZChkYmcsIGRhdGEpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICAvKmxldCBwID0gbmV3IERlYnVnZ2VyUHJvdG9jb2woKTsKICAgICAgICBwcm90b2NvbC5zZXQod3MsIHApOyovCiAgICAgICAgfSwKICAgICAgICBvbkZkKGZkLCByZCwgd3IpIHsKICAgICAgICAgIC8vY29uc29sZS5sb2coJ29uRmQnLCB7IGZkLCByZCwgd3IgfSk7CiAgICAgICAgICBvcy5zZXRSZWFkSGFuZGxlcihmZCwgcmQpOwogICAgICAgICAgb3Muc2V0V3JpdGVIYW5kbGVyKGZkLCB3cik7CiAgICAgICAgfSwKICAgICAgICAuLi4odXJsICYmIHVybC5ob3N0ID8gdXJsIDoge30pCiAgICAgIH0pCiAgICApOwogIH0pOwogIGNvbnNvbGUubG9nKCdYWCcpOwoKICBkZWxldGUgZ2xvYmFsVGhpcy5ERUJVRzsKCiAgbGV0IGlucHV0QnVmID0gbmV3IEFycmF5QnVmZmVyKDEwKTsKICBvcy50dHlTZXRSYXcoMCk7CgogIG9zLnNldFJlYWRIYW5kbGVyKDAsICgpID0+IHsKICAgIGxldCByID0gZnMucmVhZFN5bmMoMCwgaW5wdXRCdWYsIDAsIGlucHV0QnVmLmJ5dGVMZW5ndGgpOwoKICAgIGlmKHIgPiAwKSB7CiAgICAgIGxldCBhID0gbmV3IFVpbnQ4QXJyYXkoaW5wdXRCdWYuc2xpY2UoMCwgcikpOwoKICAgICAgLy9jb25zb2xlLmxvZygnYScsIGEpOwoKICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGEubGVuZ3RoOyBpKyspIGlmKGFbaV0gPT0gMTMpIGFbaV0gPSAxMDsKCiAgICAgIGlmKGEubGVuZ3RoID09IDEgJiYgYVswXSA9PSAxMjcpIGEgPSBuZXcgVWludDhBcnJheShbOCwgMHgyMCwgOF0pOwoKICAgICAgaWYoYS5sZW5ndGggPT0gMSAmJiBhWzBdID09IDI3KSBzaG93U2Vzc2lvbnMoKTsKICAgICAgZWxzZSBmcy53cml0ZVN5bmMoMSwgYS5idWZmZXIpOwogICAgfQogIH0pOwoKICBmdW5jdGlvbiBzaG93U2Vzc2lvbnMoKSB7CiAgICBsZXQgc2Vzc2lvbnMgPSBnZXRTZXNzaW9ucygpOwogICAgY29uc29sZS5sb2coJ3Nlc3Npb25zJywgY29uc29sZS5jb25maWcoeyBtYXhBcnJheUxlbmd0aDogSW5maW5pdHksIGRlcHRoOiA0LCBjdXN0b21JbnNwZWN0OiB0cnVlLCBjb21wYWN0OiAwIH0pLCBzZXNzaW9ucyk7CiAgfQoKICAvL3NldEludGVydmFsKCgpID0+IGNvbnNvbGUubG9nKCdpbnRlcnZhbCcpLCA1MDAwKTsKCiAgZ2xvYmFsVGhpcy53cyA9IGNyZWF0ZVdTKGB3c3M6Ly8ke2FkZHJlc3N9Ojg5OTgvd3NgLCB7fSwgdHJ1ZSk7CgogIGRlZmluZShnbG9iYWxUaGlzLCB7CiAgICBnZXQgY29ubmVjdGlvbnMoKSB7CiAgICAgIHJldHVybiBbLi4uZ2xvYmFsVGhpcy5zb2NrZXRzXTsKICAgIH0sCiAgICBnZXQgc29ja2xpc3QoKSB7CiAgICAgIHJldHVybiBbLi4uZ2xvYmFsVGhpcy5zb2NrZXRzXTsKICAgIH0sCiAgICBuZXQ6IHsgc2V0TG9nLCBMTExfVVNFUiwgTExMX05PVElDRSwgTExMX1dBUk4sIGNsaWVudCwgc2VydmVyIH0sCiAgICBTdGFydERlYnVnZ2VyLAogICAgQ29ubmVjdERlYnVnZ2VyLAogICAgRGVidWdnZXJQcm90b2NvbCwKICAgIHJlcGw6IFN0YXJ0UkVQTCgpLAogICAgZGFlbW9uKCkgewogICAgICByZXBsLnN0b3AoKTsKICAgICAgc3RkLnB1dHMoJ1xuZGV0YWNoaW5nLi4uJyk7CiAgICAgIGRhZW1vbigxLCAwKTsKICAgICAgc3RkLnB1dHMoJyBQSUQgJyArIGdldHBpZCgpICsgJ1xuJyk7CiAgICB9CiAgfSk7CgogIC8vbGV0IHJlcGwgPSBTdGFydFJFUEwoKTsKCiAgLy8gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShnbG9iYWxUaGlzLCAnREVCVUcnLCB7IGdldDogRGVidWdGbGFncyB9KTsKCiAgLyogaWYobGlzdGVuKSBjbGkubGlzdGVuKGNyZWF0ZVdTLCBvcyk7CiAgZWxzZSBjbGkuY29ubmVjdChjcmVhdGVXUywgb3MpOwoqLwogIGZ1bmN0aW9uIHF1aXQod2h5KSB7CiAgICBjb25zb2xlLmxvZyhgcXVpdCgnJHt3aHl9JylgKTsKCiAgICBsZXQgY2ZnID0geyBpbnNwZWN0T3B0aW9uczogY29uc29sZS5vcHRpb25zIH07CiAgICBXcml0ZUpTT04oYC4ke2Jhc2V9LWNvbmZpZ2AsIGNmZyk7CiAgICAvLyByZXBsLmNsZWFudXAod2h5KTsKICB9Cn0KCnRyeSB7CiAgbWFpbiguLi5zY3JpcHRBcmdzLnNsaWNlKDEpKTsKfSBjYXRjaChlcnJvcikgewogIGNvbnNvbGUubG9nKGBGQUlMOiAke2Vycm9yPy5tZXNzYWdlID8/IGVycm9yfVxuJHtlcnJvcj8uc3RhY2t9YCk7Cn0gZmluYWxseSB7CiAgLy9jb25zb2xlLmxvZygnU1VDQ0VTUycpOwp9CgAAAAAAAAAAiTsAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAsBwAAAAAAACwHAAAAAAAAAAAAAAAAPC/"
				]
			]
		},
		{
			"file": "debugger-client.js",
			"settings":
			{
				"buffer_size": 14360,
				"line_ending": "Unix"
			},
			"undo_stack":
			[
			]
		},
		{
			"file": "draw.html",
			"settings":
			{
				"buffer_size": 500,
				"line_ending": "Unix"
			}
		},
		{
			"contents": "Searching 4708 files for \"^js_lexer_constructor\" (regex, case sensitive)\n\n~/Projects/plot-cv/quickjs/qjs-modules/quickjs-lexer.c:\n  632  \n  633  JSValue\n  634: js_lexer_constructor(JSContext* ctx, JSValueConst new_target, int argc, JSValueConst argv[]) {\n  635    JSValue proto, ret;\n  636    Lexer* lex;\n\n1 match in 1 file\n\n\nSearching 4708 files for \"js_is_arraybuffer\" (regex, case sensitive)\n\n~/Projects/plot-cv/quickjs/qjs-net/lib/jsutils.c:\n  769    }\n  770  \n  771:   if(js_is_arraybuffer(ctx, value)) {\n  772      ret.value = JS_DupValue(ctx, value);\n  773      ret.data = JS_GetArrayBuffer(ctx, &ret.size, ret.value);\n  ...\n  836  \n  837  BOOL\n  838: js_is_arraybuffer(JSContext* ctx, JSValueConst value) {\n  839    if(JS_IsObject(value)) {\n  840      size_t len;\n\n~/Projects/plot-cv/quickjs/qjs-net/lib/jsutils.h:\n  178  JSBuffer js_input_args(JSContext*, int argc, JSValueConst argv[]);\n  179  int js_buffer_fromargs(JSContext*, int argc, JSValueConst argv[], JSBuffer* buf);\n  180: BOOL js_is_arraybuffer(JSContext*, JSValueConst value);\n  181  BOOL js_is_dataview(JSContext*, JSValueConst value);\n  182  BOOL js_is_typedarray(JSContext*, JSValueConst value);\n\n~/Projects/plot-cv/quickjs/qjs-modules/quickjs-misc.c:\n  172    //  JSValue arraybuffer_ctor = js_global_get_str(ctx, \"ArrayBuffer\");\n  173  \n  174:   if(js_value_isclass(ctx, argv[0], JS_CLASS_ARRAY_BUFFER) || js_is_arraybuffer(ctx, argv[0]) /* || JS_IsInstanceOf(ctx, argv[0], arraybuffer_ctor)*/) {\n  175      uint8_t* data;\n  176      size_t len;\n  ...\n  215    char buf[128];\n  216  \n  217:   if(js_is_arraybuffer(ctx, argv[0]) || js_is_sharedarraybuffer(ctx, argv[0])) {\n  218      size_t len;\n  219      ptr = JS_GetArrayBuffer(ctx, &len, argv[0]);\n  ...\n  326    uint64_t newlen;\n  327  \n  328:   if(!js_is_arraybuffer(ctx, argv[0]))\n  329      return JS_ThrowTypeError(ctx, \"argument 1 must be an ArrayBuffer\");\n  330  \n  ...\n 1918      case IS_UNDEFINED: r = JS_IsUndefined(arg); break;\n 1919      case IS_UNINITIALIZED: r = JS_IsUninitialized(arg); break;\n 1920:     case IS_ARRAYBUFFER: r = js_is_arraybuffer(ctx, arg); break;\n 1921    }\n 1922    if(r == -1)\n ....\n 1935    }\n 1936  \n 1937:   if(js_is_arraybuffer(ctx, argv[0])) {\n 1938      InputBuffer buf = js_output_args(ctx, argc, argv);\n 1939      uint32_t count = 0, reclen;\n\n~/Projects/plot-cv/quickjs/qjs-modules/quickjs-archive.c:\n  291      return JS_EXCEPTION;\n  292  \n  293:   if(argc < 1 || !js_is_arraybuffer(ctx, argv[0])) {\n  294      void* data;\n  295      size_t size;\n\n~/Projects/plot-cv/quickjs/qjs-modules/quickjs-mmap.c:\n  142  js_mmap_tostring(JSContext* ctx, JSValueConst this_val, int argc, JSValueConst argv[]) {\n  143    JSValue ret = JS_UNDEFINED;\n  144:   if(js_is_arraybuffer(ctx, argv[0])) {\n  145      uint8_t* data;\n  146      size_t len;\n\n~/Projects/plot-cv/quickjs/qjs-modules/quickjs-inspect.c:\n  518      dbuf_putstr(buf, \"new Uint8Array([\");\n  519    else {\n  520:     if(js_is_arraybuffer(ctx, value))\n  521        dbuf_putstr(buf, \"ArrayBuffer\");\n  522      else if(js_is_sharedarraybuffer(ctx, value))\n  ...\n  873      int32_t d = depth > 2000000000 ? INT32_MAX - depth : depth;\n  874  \n  875:     // if(!js_is_arraybuffer(ctx, value))\n  876      deepest = property_enumeration_deepest(ctx, value, opts->compact + 1);\n  877  \n  ...\n  890  \n  891      if(!is_array && !is_typedarray) {\n  892:       if(js_is_arraybuffer(ctx, value) || js_is_sharedarraybuffer(ctx, value))\n  893          return js_inspect_print_arraybuffer(ctx, buf, value, opts, depth + 1);\n  894        if(js_is_date(ctx, value))\n\n~/Projects/plot-cv/quickjs/qjs-modules/quickjs-sockets.c:\n  123  static BOOL\n  124  js_sockaddr_init(JSContext* ctx, int argc, JSValueConst argv[], SockAddr* a) {\n  125:   if(argc == 1 && js_is_arraybuffer(ctx, argv[0])) {\n  126      uint8_t* data;\n  127      size_t len;\n  ...\n  387      tv->tv_usec = usec;\n  388      return TRUE;\n  389:   } else if(js_is_arraybuffer(ctx, arg)) {\n  390      uint8_t* data;\n  391      size_t len;\n  ...\n  409      JS_SetPropertyUint32(ctx, arg, 1, JS_NewUint32(ctx, tv->tv_usec));\n  410      return TRUE;\n  411:   } else if(js_is_arraybuffer(ctx, arg)) {\n  412      uint8_t* data;\n  413      size_t len;\n  ...\n  434      }\n  435      return TRUE;\n  436:   } else if(js_is_arraybuffer(ctx, arg)) {\n  437      uint8_t* data;\n  438      size_t len;\n  ...\n  454          JS_SetPropertyUint32(ctx, arg, i++, JS_NewUint32(ctx, fd));\n  455      return TRUE;\n  456:   } else if(js_is_arraybuffer(ctx, arg)) {\n  457      uint8_t* data;\n  458      size_t len;\n  ...\n  495    }\n  496  \n  497:   if(js_is_arraybuffer(ctx, arg)) {\n  498      uint8_t* data;\n  499      size_t len;\n  ...\n  521      JS_SetPropertyStr(ctx, arg, \"revents\", JS_NewInt32(ctx, pfd->revents));\n  522      return TRUE;\n  523:   } else if(js_is_arraybuffer(ctx, arg)) {\n  524      uint8_t* data;\n  525      size_t len;\n  ...\n  648    int32_t timeout = -1;\n  649    struct pollfd* pfds;\n  650:   BOOL is_array = js_is_array(ctx, argv[0]), is_arraybuffer = js_is_arraybuffer(ctx, argv[0]);\n  651  \n  652    if(argc >= 2 && JS_IsNumber(argv[1]))\n\n~/Projects/plot-cv/quickjs/qjs-modules/include/utils.h:\n  681  }\n  682  \n  683: BOOL js_is_arraybuffer(JSContext*, JSValueConst);\n  684  BOOL js_is_sharedarraybuffer(JSContext*, JSValueConst);\n  685  BOOL js_is_date(JSContext*, JSValueConst);\n\n~/Projects/plot-cv/quickjs/qjs-modules/src/utils.c:\n 2011  \n 2012  BOOL\n 2013: js_is_arraybuffer(JSContext* ctx, JSValueConst value) {\n 2014    BOOL ret = FALSE;\n 2015    if(!JS_IsObject(value))\n ....\n 2254  js_arraybuffer_bytelength(JSContext* ctx, JSValueConst value) {\n 2255    int64_t len = -1;\n 2256:   if(js_is_arraybuffer(ctx, value)) {\n 2257      JSValue length = JS_GetPropertyStr(ctx, value, \"byteLength\");\n 2258      JS_ToInt64(ctx, &len, length);\n\n~/Projects/plot-cv/quickjs/qjs-modules/src/buffer-utils.c:\n  484    }\n  485  \n  486:   if(js_value_isclass(ctx, value, JS_CLASS_ARRAY_BUFFER) || js_is_arraybuffer(ctx, value)) {\n  487      ret.value = JS_DupValue(ctx, value);\n  488      ret.data = JS_GetArrayBuffer(ctx, &ret.size, ret.value);\n\n25 matches across 10 files\n\n\nSearching 4708 files for \"^js_is_arraybuffer\" (regex, case sensitive)\n\n~/Projects/plot-cv/quickjs/qjs-net/lib/jsutils.c:\n  836  \n  837  BOOL\n  838: js_is_arraybuffer(JSContext* ctx, JSValueConst value) {\n  839    if(JS_IsObject(value)) {\n  840      size_t len;\n\n~/Projects/plot-cv/quickjs/qjs-modules/src/utils.c:\n 2011  \n 2012  BOOL\n 2013: js_is_arraybuffer(JSContext* ctx, JSValueConst value) {\n 2014    BOOL ret = FALSE;\n 2015    if(!JS_IsObject(value))\n\n2 matches across 2 files\n\n\nSearching 4708 files for \"^js_is_arraybuffer\" (regex, case sensitive)\n\n~/Projects/plot-cv/quickjs/qjs-net/lib/jsutils.c:\n  836  \n  837  BOOL\n  838: js_is_arraybuffer(JSContext* ctx, JSValueConst value) {\n  839    if(JS_IsObject(value)) {\n  840      size_t len;\n\n~/Projects/plot-cv/quickjs/qjs-modules/src/utils.c:\n 2011  \n 2012  BOOL\n 2013: js_is_arraybuffer(JSContext* ctx, JSValueConst value) {\n 2014    BOOL ret = FALSE;\n 2015    if(!JS_IsObject(value))\n\n2 matches across 2 files\n",
			"settings":
			{
				"buffer_size": 7109,
				"line_ending": "Unix",
				"name": "Find Results",
				"scratch": true
			},
			"undo_stack":
			[
			]
		},
		{
			"file": "quickjs/qjs-net/lib/jsutils.c",
			"settings":
			{
				"buffer_size": 25008,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			},
			"undo_stack":
			[
			]
		},
		{
			"file": "quickjs/qjs-modules/src/utils.c",
			"settings":
			{
				"buffer_size": 93368,
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					201,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAAAJbQEAI3VuZGVmIF9JU09DOTlfU09VUkNFCiNkZWZpbmUgX0lTT0M5OV9TT1VSQ0UgMQojaW5jbHVkZSAidXRpbHMuaCIKI2luY2x1ZGUgImRlZmluZXMuaCIKI2luY2x1ZGUgPGxpc3QuaD4KI2luY2x1ZGUgPGN1dGlscy5oPgojaW5jbHVkZSAidmVjdG9yLmgiCiNpbmNsdWRlIDxsaWJyZWdleHAuaD4KI2luY2x1ZGUgInF1aWNranMtaW50ZXJuYWwuaCIKI2luY2x1ZGUgImJ1ZmZlci11dGlscy5oIgojaW5jbHVkZSA8dGltZS5oPgojaW5jbHVkZSA8bWF0aC5oPgojaW5jbHVkZSA8ZXJybm8uaD4KI2luY2x1ZGUgPHNpZ25hbC5oPgojaW5jbHVkZSA8c3lzL3N0YXQuaD4KI2luY2x1ZGUgPHN5cy90aW1lLmg+CiNpbmNsdWRlIDxxdWlja2pzLWxpYmMuaD4KI2luY2x1ZGUgImRlYnVnLmgiCgojaWYgZGVmaW5lZChfX0VNU0NSSVBURU5fXykgJiYgZGVmaW5lZChfX0dOVUNfXykKI2RlZmluZSBhdG9taWNfYWRkX2ludCBfX3N5bmNfYWRkX2FuZF9mZXRjaAojZW5kaWYKCi8qKgogKiBcYWRkdG9ncm91cCB1dGlscwogKiBAewogKi8Kdm9pZCBxdWlja3NvcnRfcih2b2lkKiwgc2l6ZV90LCBzaXplX3QsIGludCAoKikoY29uc3Qgdm9pZCosIGNvbnN0IHZvaWQqLCB2b2lkKiksIHZvaWQqKTsKaW50IHN0cnZlcnNjbXAoY29uc3QgY2hhciosIGNvbnN0IGNoYXIqKTsKCiNpZm5kZWYgSU5GSU5JVFkKI2RlZmluZSBJTkZJTklUWSBfX2J1aWx0aW5faW5mKCkKI2VuZGlmCgojaWZkZWYgVVNFX1dPUktFUgojaW5jbHVkZSA8cHRocmVhZC5oPgojaW5jbHVkZSA8c3RkYXRvbWljLmg+CgpzdGF0aWMgaW50CmF0b21pY19hZGRfaW50KGludCogcHRyLCBpbnQgdikgewogIHJldHVybiBhdG9taWNfZmV0Y2hfYWRkKChfQXRvbWljKHVpbnQzMl90KSopcHRyLCB2KSArIHY7Cn0KI2VuZGlmCgojaWYgZGVmaW5lZChfX2xpbnV4X18pIHx8IGRlZmluZWQoX19BUFBMRV9fKQp1aW50NjRfdAp0aW1lX3VzKHZvaWQpIHsKICBzdHJ1Y3QgdGltZXNwZWMgdHM7CiAgY2xvY2tfZ2V0dGltZShDTE9DS19NT05PVE9OSUMsICZ0cyk7CiAgcmV0dXJuICh1aW50NjRfdCl0cy50dl9zZWMgKiAxMDAwMDAwICsgKHRzLnR2X25zZWMgLyAxMDAwKTsKfQojZWxzZQovKiBtb3JlIHBvcnRhYmxlLCBidXQgZG9lcyBub3Qgd29yayBpZiB0aGUgZGF0ZSBpcyB1cGRhdGVkICovCnVpbnQ2NF90CnRpbWVfdXModm9pZCkgewogIHN0cnVjdCB0aW1ldmFsIHR2OwogIGdldHRpbWVvZmRheSgmdHYsIDApOwogIHJldHVybiAoaW50NjRfdCl0di50dl9zZWMgKiAxMDAwMDAwICsgdHYudHZfdXNlYzsKfQojZW5kaWYKCmpzX3JlYWxsb2NfaGVscGVyKHV0aWxzX2pzX3JlYWxsb2MpOwpqc19yZWFsbG9jX3J0X2hlbHBlcih1dGlsc19qc19yZWFsbG9jX3J0KTsKCmludApyZWdleHBfZmxhZ3NfZnJvbXN0cmluZyhjb25zdCBjaGFyKiBzKSB7CiAgaW50IGZsYWdzID0gMDsKCiAgaWYoc3RyX2NvbnRhaW5zKHMsICdnJykpCiAgICBmbGFncyB8PSBMUkVfRkxBR19HTE9CQUw7CiAgaWYoc3RyX2NvbnRhaW5zKHMsICdpJykpCiAgICBmbGFncyB8PSBMUkVfRkxBR19JR05PUkVDQVNFOwogIGlmKHN0cl9jb250YWlucyhzLCAnbScpKQogICAgZmxhZ3MgfD0gTFJFX0ZMQUdfTVVMVElMSU5FOwogIGlmKHN0cl9jb250YWlucyhzLCAncycpKQogICAgZmxhZ3MgfD0gTFJFX0ZMQUdfRE9UQUxMOwogIGlmKHN0cl9jb250YWlucyhzLCAndScpKQogICAgZmxhZ3MgfD0gTFJFX0ZMQUdfVVRGMTY7CiAgaWYoc3RyX2NvbnRhaW5zKHMsICd5JykpCiAgICBmbGFncyB8PSBMUkVfRkxBR19TVElDS1k7CgogIHJldHVybiBmbGFnczsKfQoKaW50CnJlZ2V4cF9mbGFnc190b3N0cmluZyhpbnQgZmxhZ3MsIGNoYXIqIGJ1ZikgewogIGNoYXIqIG91dCA9IGJ1ZjsKCiAgaWYoZmxhZ3MgJiBMUkVfRkxBR19HTE9CQUwpCiAgICAqb3V0KysgPSAnZyc7CiAgaWYoZmxhZ3MgJiBMUkVfRkxBR19JR05PUkVDQVNFKQogICAgKm91dCsrID0gJ2knOwogIGlmKGZsYWdzICYgTFJFX0ZMQUdfTVVMVElMSU5FKQogICAgKm91dCsrID0gJ20nOwogIGlmKGZsYWdzICYgTFJFX0ZMQUdfRE9UQUxMKQogICAgKm91dCsrID0gJ3MnOwogIGlmKGZsYWdzICYgTFJFX0ZMQUdfVVRGMTYpCiAgICAqb3V0KysgPSAndSc7CiAgaWYoZmxhZ3MgJiBMUkVfRkxBR19TVElDS1kpCiAgICAqb3V0KysgPSAneSc7CgogICpvdXQgPSAnXDAnOwogIHJldHVybiBvdXQgLSBidWY7Cn0KClJlZ0V4cApyZWdleHBfZnJvbV9hcmd2KGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdLCBKU0NvbnRleHQqIGN0eCkgewogIFJlZ0V4cCByZSA9IHswLCAwLCAwfTsKICBjb25zdCBjaGFyKiBmbGFnc3RyOwogIGFzc2VydChhcmdjID4gMCk7CiAgCiAgaWYoanNfaXNfcmVnZXhwKGN0eCwgYXJndlswXSkpIHsKICAgIHJlLnNvdXJjZSA9IGpzX2dldF9wcm9wZXJ0eXN0cl9zdHJpbmdsZW4oY3R4LCBhcmd2WzBdLCAic291cmNlIiwgJnJlLmxlbik7CiAgICByZS5mbGFncyA9IHJlZ2V4cF9mbGFnc19mcm9tc3RyaW5nKChmbGFnc3RyID0ganNfZ2V0X3Byb3BlcnR5c3RyX2NzdHJpbmcoY3R4LCBhcmd2WzBdLCAiZmxhZ3MiKSkpOwogICAganNfY3N0cmluZ19mcmVlKGN0eCwgZmxhZ3N0cik7CiAgfSBlbHNlIHsKICAgIHJlLnNvdXJjZSA9IGpzX3Rvc3RyaW5nbGVuKGN0eCwgJnJlLmxlbiwgYXJndlswXSk7CiAgICBpZihhcmdjID4gMSAmJiBKU19Jc1N0cmluZyhhcmd2WzFdKSkgewogICAgICByZS5mbGFncyA9IHJlZ2V4cF9mbGFnc19mcm9tc3RyaW5nKChmbGFnc3RyID0gSlNfVG9DU3RyaW5nKGN0eCwgYXJndlsxXSkpKTsKICAgICAganNfY3N0cmluZ19mcmVlKGN0eCwgZmxhZ3N0cik7CiAgICB9CiAgfQogIHJldHVybiByZTsKfQoKUmVnRXhwCnJlZ2V4cF9mcm9tX3N0cmluZyhjaGFyKiBzdHIsIGludCBmbGFncykgewogIFJlZ0V4cCByZSA9IHtzdHIsIHN0cmxlbihzdHIpLCBmbGFnc307CiAgcmV0dXJuIHJlOwp9CgpSZWdFeHAKcmVnZXhwX2Zyb21fZGJ1ZihEeW5CdWYqIGRidWYsIGludCBmbGFncykgewogIFJlZ0V4cCByZSA9IHsoY2hhciopZGJ1Zi0+YnVmLCBkYnVmLT5zaXplLCBmbGFnc307CiAgZGJ1Zi0+YnVmID0gMDsKICBkYnVmLT5hbGxvY2F0ZWRfc2l6ZSA9IDA7CiAgZGJ1Zi0+c2l6ZSA9IDA7CiAgcmV0dXJuIHJlOwp9Cgp1aW50OF90KgpyZWdleHBfY29tcGlsZShSZWdFeHAgcmUsIEpTQ29udGV4dCogY3R4KSB7CiAgY2hhciBlcnJvcl9tc2dbNjRdOwogIGludCBsZW4gPSAwOwogIHVpbnQ4X3QqIGJ5dGVjb2RlOwoKICBpZighKGJ5dGVjb2RlID0gbHJlX2NvbXBpbGUoJmxlbiwgZXJyb3JfbXNnLCBzaXplb2YoZXJyb3JfbXNnKSwgcmUuc291cmNlLCByZS5sZW4sIHJlLmZsYWdzLCBjdHgpKSkKICAgIEpTX1Rocm93SW50ZXJuYWxFcnJvcihjdHgsICJFcnJvciBjb21waWxpbmcgcmVnZXggLyUuKnMvOiAlcyIsIChpbnQpcmUubGVuLCByZS5zb3VyY2UsIGVycm9yX21zZyk7CgogIHJldHVybiBieXRlY29kZTsKfQoKQk9PTApyZWdleHBfbWF0Y2goY29uc3QgdWludDhfdCogYmMsIGNvbnN0IHZvaWQqIGNidWYsIHNpemVfdCBjbGVuLCBKU0NvbnRleHQqIGN0eCkgewogIHVpbnQ4X3QqIGNhcHR1cmVbNTEyXTsKICBCT09MIHJldCA9IEZBTFNFOwogIHN3aXRjaChscmVfZXhlYyhjYXB0dXJlLCBiYywgY2J1ZiwgMCwgY2xlbiwgMCwgY3R4KSkgewogICAgY2FzZSAxOiByZXQgPSBUUlVFOyBicmVhazsKICAgIGNhc2UgLTE6IGZwcmludGYoc3RkZXJyLCAicmVnZXhwX21hdGNoIEVSUk9SXG4iKTsgYnJlYWs7CiAgICBjYXNlIDA6IGJyZWFrOwogIH0KICByZXR1cm4gcmV0Owp9CgpKU1ZhbHVlCnJlZ2V4cF90b192YWx1ZShSZWdFeHAgcmUsIEpTQ29udGV4dCogY3R4KSB7CiAgY2hhciBmbGFnc3RyWzMyXSA9IHswfTsKICBzaXplX3QgZmxhZ2xlbiA9IHJlZ2V4cF9mbGFnc190b3N0cmluZyhyZS5mbGFncywgZmxhZ3N0cik7CiAgSlNWYWx1ZUNvbnN0IGFyZ3NbMl0gPSB7SlNfTmV3U3RyaW5nTGVuKGN0eCwgcmUuc291cmNlLCByZS5sZW4pLCBKU19OZXdTdHJpbmdMZW4oY3R4LCBmbGFnc3RyLCBmbGFnbGVuKX07CiAgSlNWYWx1ZSByZWdleCwgY3RvciA9IGpzX2dsb2JhbF9nZXRfc3RyKGN0eCwgIlJlZ0V4cCIpOwogIHJlZ2V4ID0gSlNfQ2FsbENvbnN0cnVjdG9yKGN0eCwgY3RvciwgMiwgYXJncyk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgYXJnc1swXSk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgYXJnc1sxXSk7CiAgcmV0dXJuIHJlZ2V4Owp9Cgp2b2lkCnJlZ2V4cF9mcmVlX3J0KFJlZ0V4cCByZSwgSlNSdW50aW1lKiBydCkgewogIGpzX2ZyZWVfcnQocnQsIHJlLnNvdXJjZSk7Cn0KCmludDY0X3QKanNfYXJyYXlfbGVuZ3RoKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgYXJyYXkpIHsKICBpbnQ2NF90IGxlbiA9IC0xOwogIC8qaWYoanNfaXNfYXJyYXkoY3R4LCBhcnJheSkgfHwganNfaXNfdHlwZWRhcnJheShhcnJheSl8fCBqc19pc19hcnJheV9saWtlKGN0eCwgYXJyYXkpKSovIHsKICAgIEpTVmFsdWUgbGVuZ3RoID0gSlNfR2V0UHJvcGVydHlTdHIoY3R4LCBhcnJheSwgImxlbmd0aCIpOwogICAgaWYoSlNfSXNOdW1iZXIobGVuZ3RoKSkKICAgICAgSlNfVG9JbnQ2NChjdHgsICZsZW4sIGxlbmd0aCk7CiAgICBKU19GcmVlVmFsdWUoY3R4LCBsZW5ndGgpOwogIH0KICByZXR1cm4gbGVuOwp9Cgp2b2lkCmpzX2FycmF5X2NsZWFyKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgYXJyYXkpIHsKICBpbnQ2NF90IGxlbiA9IGpzX2FycmF5X2xlbmd0aChjdHgsIGFycmF5KTsKICBKU1ZhbHVlIHJldDsKICBKU0F0b20gc3BsaWNlID0gSlNfTmV3QXRvbShjdHgsICJzcGxpY2UiKTsKICBKU1ZhbHVlQ29uc3QgYXJnc1syXSA9IHtKU19OZXdJbnQ2NChjdHgsIDApLCBKU19OZXdJbnQ2NChjdHgsIGxlbil9OwoKICByZXQgPSBKU19JbnZva2UoY3R4LCBhcnJheSwgc3BsaWNlLCAyLCBhcmdzKTsKICBKU19GcmVlQXRvbShjdHgsIHNwbGljZSk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgcmV0KTsKCiAgYXNzZXJ0KGpzX2FycmF5X2xlbmd0aChjdHgsIGFycmF5KSA9PSAwKTsKfQoKSlNWYWx1ZQpqc19pbnR2X3RvX2FycmF5KEpTQ29udGV4dCogY3R4LCBpbnQqIGludHYsIHNpemVfdCBsZW4pIHsKICBKU1ZhbHVlIHJldCA9IEpTX05ld0FycmF5KGN0eCk7CiAgaWYoaW50dikgewogICAgc2l6ZV90IGk7CiAgICBmb3IoaSA9IDA7IGkgPCBsZW47IGkrKykgSlNfU2V0UHJvcGVydHlVaW50MzIoY3R4LCByZXQsIGksIEpTX05ld0ludDMyKGN0eCwgaW50dltpXSkpOwogIH0KICByZXR1cm4gcmV0Owp9CgpjaGFyKioKanNfYXJyYXlfdG9fYXJndihKU0NvbnRleHQqIGN0eCwgc2l6ZV90KiBsZW5wLCBKU1ZhbHVlQ29uc3QgYXJyYXkpIHsKICBzaXplX3QgaSwgbGVuID0ganNfYXJyYXlfbGVuZ3RoKGN0eCwgYXJyYXkpOwogIGNoYXIqKiByZXQgPSBqc19tYWxsb2N6KGN0eCwgc2l6ZW9mKGNoYXIqKSAqIChsZW4gKyAxKSk7CiAgZm9yKGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgIEpTVmFsdWUgaXRlbSA9IEpTX0dldFByb3BlcnR5VWludDMyKGN0eCwgYXJyYXksIGkpOwogICAgcmV0W2ldID0ganNfdG9zdHJpbmcoY3R4LCBpdGVtKTsKICAgIEpTX0ZyZWVWYWx1ZShjdHgsIGl0ZW0pOwogIH0KICBpZihsZW5wKQogICAgKmxlbnAgPSBsZW47CiAgcmV0dXJuIHJldDsKfQoKaW50MzJfdCoKanNfYXJyYXlfdG9faW50MzJ2KEpTQ29udGV4dCogY3R4LCBzaXplX3QqIGxlbnAsIEpTVmFsdWVDb25zdCBhcnJheSkgewogIHNpemVfdCBpLCBsZW4gPSBqc19hcnJheV9sZW5ndGgoY3R4LCBhcnJheSk7CiAgaW50MzJfdCogcmV0ID0ganNfbWFsbG9jeihjdHgsIHNpemVvZihpbnQzMl90KSAqIChsZW4gKyAxKSk7CiAgZm9yKGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgIEpTVmFsdWUgaXRlbSA9IEpTX0dldFByb3BlcnR5VWludDMyKGN0eCwgYXJyYXksIGkpOwogICAgSlNfVG9JbnQzMihjdHgsICZyZXRbaV0sIGl0ZW0pOwogICAgSlNfRnJlZVZhbHVlKGN0eCwgaXRlbSk7CiAgfQogIGlmKGxlbnApCiAgICAqbGVucCA9IGxlbjsKICByZXR1cm4gcmV0Owp9Cgp1aW50MzJfdCoKanNfYXJyYXlfdG9fdWludDMydihKU0NvbnRleHQqIGN0eCwgc2l6ZV90KiBsZW5wLCBKU1ZhbHVlQ29uc3QgYXJyYXkpIHsKICBzaXplX3QgaSwgbGVuID0ganNfYXJyYXlfbGVuZ3RoKGN0eCwgYXJyYXkpOwogIHVpbnQzMl90KiByZXQgPSBqc19tYWxsb2N6KGN0eCwgc2l6ZW9mKHVpbnQzMl90KSAqIChsZW4gKyAxKSk7CiAgZm9yKGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgIEpTVmFsdWUgaXRlbSA9IEpTX0dldFByb3BlcnR5VWludDMyKGN0eCwgYXJyYXksIGkpOwogICAgSlNfVG9VaW50MzIoY3R4LCAmcmV0W2ldLCBpdGVtKTsKICAgIEpTX0ZyZWVWYWx1ZShjdHgsIGl0ZW0pOwogIH0KICBpZihsZW5wKQogICAgKmxlbnAgPSBsZW47CiAgcmV0dXJuIHJldDsKfQoKaW50NjRfdCoKanNfYXJyYXlfdG9faW50NjR2KEpTQ29udGV4dCogY3R4LCBzaXplX3QqIGxlbnAsIEpTVmFsdWVDb25zdCBhcnJheSkgewogIHNpemVfdCBpLCBsZW4gPSBqc19hcnJheV9sZW5ndGgoY3R4LCBhcnJheSk7CiAgaW50NjRfdCogcmV0ID0ganNfbWFsbG9jeihjdHgsIHNpemVvZihpbnQ2NF90KSAqIChsZW4gKyAxKSk7CiAgZm9yKGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgIEpTVmFsdWUgaXRlbSA9IEpTX0dldFByb3BlcnR5VWludDMyKGN0eCwgYXJyYXksIGkpOwogICAgSlNfVG9JbnQ2NEV4dChjdHgsICZyZXRbaV0sIGl0ZW0pOwogICAgSlNfRnJlZVZhbHVlKGN0eCwgaXRlbSk7CiAgfQogIGlmKGxlbnApCiAgICAqbGVucCA9IGxlbjsKICByZXR1cm4gcmV0Owp9CgppbnQKanNfYXJyYXlfY29weXMoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBhcnJheSwgaW50IG4sIGNoYXIqKiBzdHJhKSB7CiAgaW50IGksIGxlbiA9IE1JTl9OVU0obiwganNfYXJyYXlfbGVuZ3RoKGN0eCwgYXJyYXkpKTsKICBmb3IoaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgSlNWYWx1ZSBpdGVtID0gSlNfR2V0UHJvcGVydHlVaW50MzIoY3R4LCBhcnJheSwgaSk7CiAgICBpZihzdHJhW2ldKQogICAgICBqc19mcmVlKGN0eCwgc3RyYVtpXSk7CiAgICBzdHJhW2ldID0ganNfdG9zdHJpbmcoY3R4LCBpdGVtKTsKICAgIEpTX0ZyZWVWYWx1ZShjdHgsIGl0ZW0pOwogIH0KICByZXR1cm4gaTsKfQoKaW50CmpzX3N0cnZfY29weXMoSlNDb250ZXh0KiBjdHgsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdLCBpbnQgbiwgY2hhcioqIHN0cmEpIHsKICBpbnQgaSwgbGVuID0gTUlOX05VTShuLCBhcmdjKTsKICBmb3IoaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgaWYoIUpTX0lzTnVsbChhcmd2W2ldKSAmJiAhSlNfSXNVbmRlZmluZWQoYXJndltpXSkpCiAgICAgIHN0cmFbaV0gPSBqc190b3N0cmluZyhjdHgsIGFyZ3ZbaV0pOwogICAgZWxzZQogICAgICBzdHJhW2ldID0gMDsKICB9CiAgZm9yKDsgaSA8IG47IGkrKykgc3RyYVtpXSA9IDA7CgogIHJldHVybiBpOwp9CgpKU0F0b20KanNfYXRvbV9mcm9tKEpTQ29udGV4dCogY3R4LCBjb25zdCBjaGFyKiBzdHIpIHsKICBpZihzdHJbMF0gPT0gJ1snKSB7CiAgICBKU1ZhbHVlIG9iaiwgdmFsID0gSlNfVU5ERUZJTkVEOwogICAgSlNBdG9tIHByb3AsIHJldDsKICAgIHNpemVfdCBvYmpsZW4sIHByb3BsZW47CiAgICBvYmpsZW4gPSBzdHJfY2hyKCZzdHJbMV0sICcuJyk7CiAgICBvYmogPSBqc19nbG9iYWxfZ2V0X3N0cl9uKGN0eCwgJnN0clsxXSwgb2JqbGVuKTsKICAgIHByb3BsZW4gPSBzdHJfY2hyKCZzdHJbMSArIG9iamxlbiArIDFdLCAnXScpOwogICAgcHJvcCA9IEpTX05ld0F0b21MZW4oY3R4LCAmc3RyWzEgKyBvYmpsZW4gKyAxXSwgcHJvcGxlbik7CiAgICB2YWwgPSBKU19HZXRQcm9wZXJ0eShjdHgsIG9iaiwgcHJvcCk7CiAgICBKU19GcmVlQXRvbShjdHgsIHByb3ApOwogICAgcmV0ID0gSlNfVmFsdWVUb0F0b20oY3R4LCB2YWwpOwogICAgSlNfRnJlZVZhbHVlKGN0eCwgdmFsKTsKICAgIHJldHVybiByZXQ7CiAgfQoKICByZXR1cm4gSlNfTmV3QXRvbShjdHgsIHN0cik7Cn0KCnZvaWQKanNfYXRvbV9kdW1wKEpTQ29udGV4dCogY3R4LCBKU0F0b20gYXRvbSwgRHluQnVmKiBkYiwgQk9PTCBjb2xvcikgewogIGNvbnN0IGNoYXIqIHN0cjsKICBCT09MIGlzX2ludDsKICBzdHIgPSBKU19BdG9tVG9DU3RyaW5nKGN0eCwgYXRvbSk7CiAgaXNfaW50ID0ganNfYXRvbV9pc2ludChhdG9tKSB8fCBpc19pbnRlZ2VyKHN0cik7CiAgaWYoY29sb3IpCiAgICBkYnVmX3B1dHN0cihkYiwgaXNfaW50ID8gQ09MT1JfQlJPV04gOiBDT0xPUl9HUkFZKTsKCiAgZGJ1Zl9wdXRzdHIoZGIsIHN0cik7CiAgaWYoY29sb3IpCiAgICBkYnVmX3B1dHN0cihkYiwgQ09MT1JfQ1lBTik7CgogIGlmKCFpc19pbnQpCiAgICBkYnVmX3ByaW50ZihkYiwgIigweCV4KSIsIGpzX2F0b21fdG9iaW5hcnkoYXRvbSkpOwoKICBpZihjb2xvcikKICAgIGRidWZfcHV0c3RyKGRiLCBDT0xPUl9OT05FKTsKfQoKdW5zaWduZWQgaW50CmpzX2F0b21fdG9iaW5hcnkoSlNBdG9tIGF0b20pIHsKICBzc2l6ZV90IHJldDsKICBpZihqc19hdG9tX2lzaW50KGF0b20pKSB7CiAgICByZXQgPSBqc19hdG9tX3RvaW50KGF0b20pOwogICAgcmV0ID0gLXJldDsKICB9IGVsc2UgewogICAgcmV0ID0gYXRvbTsKICB9CiAgcmV0dXJuIHJldDsKfQoKY29uc3QgY2hhcioKanNfYXRvbV90b19jc3RyaW5nbGVuKEpTQ29udGV4dCogY3R4LCBzaXplX3QqIGxlbiwgSlNBdG9tIGF0b20pIHsKICBKU1ZhbHVlIHY7CiAgY29uc3QgY2hhciogczsKICB2ID0gSlNfQXRvbVRvVmFsdWUoY3R4LCBhdG9tKTsKICBzID0gSlNfVG9DU3RyaW5nTGVuKGN0eCwgbGVuLCB2KTsKICBKU19GcmVlVmFsdWUoY3R4LCB2KTsKICByZXR1cm4gczsKfQoKaW50MzJfdApqc19hdG9tX3RvaW50MzIoSlNDb250ZXh0KiBjdHgsIEpTQXRvbSBhdG9tKSB7CiAgaWYoIWpzX2F0b21faXNpbnQoYXRvbSkpIHsKICAgIGludDY0X3QgaSA9IElOVDY0X01JTjsKICAgIGpzX2F0b21fdG9pbnQ2NChjdHgsICZpLCBhdG9tKTsKICAgIHJldHVybiBpOwogIH0KICByZXR1cm4gLWF0b207Cn0KCmludApqc19hdG9tX3RvaW50NjQoSlNDb250ZXh0KiBjdHgsIGludDY0X3QqIGksIEpTQXRvbSBhdG9tKSB7CiAgaW50IHJldDsKICBKU1ZhbHVlIHZhbHVlOwogICppID0gSU5UNjRfTUFYOwogIHZhbHVlID0gSlNfQXRvbVRvVmFsdWUoY3R4LCBhdG9tKTsKICByZXQgPSAhSlNfVG9JbnQ2NChjdHgsIGksIHZhbHVlKTsKICBKU19GcmVlVmFsdWUoY3R4LCB2YWx1ZSk7CiAgcmV0dXJuIHJldDsKfQoKQk9PTApqc19hdG9tX2lzX2luZGV4KEpTQ29udGV4dCogY3R4LCBpbnQ2NF90KiBwdmFsLCBKU0F0b20gYXRvbSkgewogIEpTVmFsdWUgdmFsdWU7CiAgQk9PTCByZXQgPSBGQUxTRTsKICBpbnQ2NF90IGluZGV4OwoKICBpZihhdG9tICYgKDFVIDw8IDMxKSkgewogICAgKnB2YWwgPSBhdG9tICYgKH4oMVUgPDwgMzEpKTsKICAgIHJldHVybiBUUlVFOwogIH0KCiAgdmFsdWUgPSBKU19BdG9tVG9WYWx1ZShjdHgsIGF0b20pOwoKICBpZihKU19Jc051bWJlcih2YWx1ZSkpIHsKICAgIEpTX1RvSW50NjQoY3R4LCAmaW5kZXgsIHZhbHVlKTsKICAgIHJldCA9IFRSVUU7CiAgfSBlbHNlIGlmKEpTX0lzU3RyaW5nKHZhbHVlKSkgewogICAgY29uc3QgY2hhciogcyA9IEpTX1RvQ1N0cmluZyhjdHgsIHZhbHVlKTsKICAgIGlmKHNbMF0gPT0gJy0nICYmIGlzX2RpZ2l0X2NoYXIoc1tzWzBdID09ICctJ10pKSB7CiAgICAgIGluZGV4ID0gYXRvaShzKTsKICAgICAgcmV0ID0gVFJVRTsKICAgIH0KICAgIEpTX0ZyZWVDU3RyaW5nKGN0eCwgcyk7CiAgfQoKICBpZihyZXQgPT0gVFJVRSkKICAgICpwdmFsID0gaW5kZXg7CgogIHJldHVybiByZXQ7Cn0KCkJPT0wKanNfYXRvbV9pc19zdHJpbmcoSlNDb250ZXh0KiBjdHgsIEpTQXRvbSBhdG9tLCBjb25zdCBjaGFyKiBvdGhlcikgewogIGNvbnN0IGNoYXIqIHN0ciA9IEpTX0F0b21Ub0NTdHJpbmcoY3R4LCBhdG9tKTsKICBCT09MIHJldCA9ICFzdHJjbXAoc3RyLCBvdGhlcik7CiAgSlNfRnJlZUNTdHJpbmcoY3R4LCBzdHIpOwogIHJldHVybiByZXQ7Cn0KCkJPT0wKanNfYXRvbV9pc19sZW5ndGgoSlNDb250ZXh0KiBjdHgsIEpTQXRvbSBhdG9tKSB7CiAgcmV0dXJuIGpzX2F0b21faXNfc3RyaW5nKGN0eCwgYXRvbSwgImxlbmd0aCIpOwp9Cgpjb25zdCBjaGFyKgpqc19mdW5jdGlvbl9uYW1lKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsdWUpIHsKICBKU0F0b20gYXRvbTsKICBKU1ZhbHVlIHN0ciwgbmFtZSwgYXJnc1syXSwgaWR4OwogIGNvbnN0IGNoYXIqIHMgPSAwOwogIGludDMyX3QgaSA9IC0xOwogIHN0ciA9IGpzX3ZhbHVlX3Rvc3RyaW5nKGN0eCwgIkZ1bmN0aW9uIiwgdmFsdWUpOwogIGF0b20gPSBKU19OZXdBdG9tKGN0eCwgImluZGV4T2YiKTsKICBhcmdzWzBdID0gSlNfTmV3U3RyaW5nKGN0eCwgImZ1bmN0aW9uICIpOwogIGlkeCA9IEpTX0ludm9rZShjdHgsIHN0ciwgYXRvbSwgMSwgYXJncyk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgYXJnc1swXSk7CiAgSlNfVG9JbnQzMihjdHgsICZpLCBpZHgpOwogIGlmKGkgIT0gMCkgewogICAgSlNfRnJlZUF0b20oY3R4LCBhdG9tKTsKICAgIEpTX0ZyZWVWYWx1ZShjdHgsIHN0cik7CiAgICByZXR1cm4gMDsKICB9CiAgYXJnc1swXSA9IEpTX05ld1N0cmluZyhjdHgsICIoIik7CiAgaWR4ID0gSlNfSW52b2tlKGN0eCwgc3RyLCBhdG9tLCAxLCBhcmdzKTsKICBKU19GcmVlVmFsdWUoY3R4LCBhcmdzWzBdKTsKICBKU19GcmVlQXRvbShjdHgsIGF0b20pOwogIGF0b20gPSBKU19OZXdBdG9tKGN0eCwgInN1YnN0cmluZyIpOwogIGFyZ3NbMF0gPSBKU19OZXdVaW50MzIoY3R4LCA5KTsKICBhcmdzWzFdID0gaWR4OwogIG5hbWUgPSBKU19JbnZva2UoY3R4LCBzdHIsIGF0b20sIDIsIGFyZ3MpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIGFyZ3NbMF0pOwogIEpTX0ZyZWVWYWx1ZShjdHgsIGFyZ3NbMV0pOwogIEpTX0ZyZWVWYWx1ZShjdHgsIHN0cik7CiAgSlNfRnJlZUF0b20oY3R4LCBhdG9tKTsKICBzID0gSlNfVG9DU3RyaW5nKGN0eCwgbmFtZSk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgbmFtZSk7CiAgcmV0dXJuIHM7Cn0KCmludApqc19mdW5jdGlvbl9hcmdjKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsdWUpIHsKICByZXR1cm4ganNfZ2V0X3Byb3BlcnR5c3RyX2ludDMyKGN0eCwgdmFsdWUsICJsZW5ndGgiKTsKfQoKSlNDRnVuY3Rpb24qCmpzX2Z1bmN0aW9uX2NmdW5jKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsdWUpIHsKICBpZihqc192YWx1ZV9pc2NsYXNzKGN0eCwgdmFsdWUsIEpTX0NMQVNTX0NfRlVOQ1RJT04pKSB7CiAgICBKU09iamVjdCogb2JqID0gSlNfVkFMVUVfR0VUX09CSih2YWx1ZSk7CiAgICByZXR1cm4gb2JqLT51LmNmdW5jLmNfZnVuY3Rpb24uZ2VuZXJpYzsKICB9CiAgcmV0dXJuIDA7Cn0KCnN0YXRpYyBKU1ZhbHVlCmpzX2Z1bmN0aW9uX2JvdW5kKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdLCBpbnQgbWFnaWMsIEpTVmFsdWUqIGZ1bmNfZGF0YSkgewogIGludCBpID0gMCwgaiA9IDAsIGsgPSBBQlNfTlVNKG1hZ2ljKSwgbCA9IFNJR05fTlVNKG1hZ2ljKTsKICBKU1ZhbHVlIGFyZ3NbYXJnYyArIGtdOwoKICBmb3IoaSA9IDA7IGkgPCBtYWdpYzsgaSsrKSBhcmdzW2ldID0gZnVuY19kYXRhW2kgKyAxXTsKICBmb3IoaiA9IDA7IGogPCBhcmdjOyBqKyspIGFyZ3NbaSsrXSA9IGFyZ3Zbal07CgogIHJldHVybiBKU19DYWxsKGN0eCwgZnVuY19kYXRhWzBdLCBsID8gYXJnc1swXSA6IHRoaXNfdmFsLCBpLCBhcmdzICsgbCk7Cn0KCkpTVmFsdWUKanNfZnVuY3Rpb25fYmluZChKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IGZ1bmMsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdKSB7CiAgSlNWYWx1ZSBkYXRhW2FyZ2MgKyAxXTsKICBpbnQgaTsKICBkYXRhWzBdID0gSlNfRHVwVmFsdWUoY3R4LCBmdW5jKTsKICBmb3IoaSA9IDA7IGkgPCBhcmdjOyBpKyspIGRhdGFbaSArIDFdID0gSlNfRHVwVmFsdWUoY3R4LCBhcmd2W2ldKTsKICByZXR1cm4gSlNfTmV3Q0Z1bmN0aW9uRGF0YShjdHgsIGpzX2Z1bmN0aW9uX2JvdW5kLCAwLCBhcmdjLCBhcmdjICsgMSwgZGF0YSk7Cn0KCnN0YXRpYyBKU1ZhbHVlCmpzX2Z1bmN0aW9uX2JvdW5kX3RoaXMoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB0aGlzX3ZhbCwgaW50IGFyZ2MsIEpTVmFsdWVDb25zdCBhcmd2W10sIGludCBtYWdpYywgSlNWYWx1ZSBmdW5jX2RhdGFbXSkgewogIHJldHVybiBKU19DYWxsKGN0eCwgZnVuY19kYXRhWzBdLCBmdW5jX2RhdGFbMV0sIGFyZ2MsIGFyZ3YpOwp9CgpKU1ZhbHVlCmpzX2Z1bmN0aW9uX2JpbmRfdGhpcyhKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IGZ1bmMsIEpTVmFsdWVDb25zdCB0aGlzX3ZhbCkgewogIEpTVmFsdWUgZGF0YVsyXTsKICBkYXRhWzBdID0gSlNfRHVwVmFsdWUoY3R4LCBmdW5jKTsKICBkYXRhWzFdID0gSlNfRHVwVmFsdWUoY3R4LCB0aGlzX3ZhbCk7CiAgcmV0dXJuIEpTX05ld0NGdW5jdGlvbkRhdGEoY3R4LCBqc19mdW5jdGlvbl9ib3VuZF90aGlzLCBqc19mdW5jdGlvbl9hcmdjKGN0eCwgZnVuYyksIDAsIDIsIGRhdGEpOwp9CgpzdGF0aWMgSlNWYWx1ZQpqc19mdW5jdGlvbl90aHJvd19mbihKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsLCBpbnQgYXJnYywgSlNWYWx1ZUNvbnN0IGFyZ3ZbXSwgaW50IG1hZ2ljLCBKU1ZhbHVlQ29uc3QgZGF0YVtdKSB7CiAgaWYoIUpTX0lzVW5kZWZpbmVkKGRhdGFbMF0pKQogICAgcmV0dXJuIEpTX1Rocm93KGN0eCwgZGF0YVswXSk7CgogIHJldHVybiBKU19EdXBWYWx1ZShjdHgsIGFyZ2MgPj0gMSA/IGFyZ3ZbMF0gOiBKU19VTkRFRklORUQpOwp9CgpKU1ZhbHVlCmpzX2Z1bmN0aW9uX3Rocm93KEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgZXJyKSB7CiAgSlNWYWx1ZUNvbnN0IGRhdGFbMV07CiAgZGF0YVswXSA9IEpTX0R1cFZhbHVlKGN0eCwgZXJyKTsKICByZXR1cm4gSlNfTmV3Q0Z1bmN0aW9uRGF0YShjdHgsIGpzX2Z1bmN0aW9uX3Rocm93X2ZuLCAwLCAwLCAxLCBkYXRhKTsKfQoKc3RhdGljIEpTVmFsdWUKanNfZnVuY3Rpb25fcmV0dXJuX3ZhbHVlX2ZuKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdLCBpbnQgbWFnaWMsIEpTVmFsdWVDb25zdCBkYXRhW10pIHsKICByZXR1cm4gZGF0YVswXTsKfQoKSlNWYWx1ZQpqc19mdW5jdGlvbl9yZXR1cm5fdW5kZWZpbmVkKEpTQ29udGV4dCogY3R4KSB7CiAgSlNWYWx1ZSBkYXRhWzFdOwogIGRhdGFbMF0gPSBKU19VTkRFRklORUQ7CiAgcmV0dXJuIEpTX05ld0NGdW5jdGlvbkRhdGEoY3R4LCBqc19mdW5jdGlvbl9yZXR1cm5fdmFsdWVfZm4sIDAsIDAsIDEsIGRhdGEpOwp9CgpKU1ZhbHVlCmpzX2Z1bmN0aW9uX3JldHVybl92YWx1ZShKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHZhbHVlKSB7CiAgSlNWYWx1ZSBkYXRhWzFdOwogIGRhdGFbMF0gPSBKU19EdXBWYWx1ZShjdHgsIHZhbHVlKTsKICByZXR1cm4gSlNfTmV3Q0Z1bmN0aW9uRGF0YShjdHgsIGpzX2Z1bmN0aW9uX3JldHVybl92YWx1ZV9mbiwgMCwgMCwgMSwgZGF0YSk7Cn0KCkpTVmFsdWUKanNfZ2xvYmFsX2dldF9zdHIoSlNDb250ZXh0KiBjdHgsIGNvbnN0IGNoYXIqIHByb3ApIHsKICBKU1ZhbHVlIGdsb2JhbF9vYmosIHJldDsKICBnbG9iYWxfb2JqID0gSlNfR2V0R2xvYmFsT2JqZWN0KGN0eCk7CiAgcmV0ID0gSlNfR2V0UHJvcGVydHlTdHIoY3R4LCBnbG9iYWxfb2JqLCBwcm9wKTsKICBKU19GcmVlVmFsdWUoY3R4LCBnbG9iYWxfb2JqKTsKICByZXR1cm4gcmV0Owp9CgpKU1ZhbHVlCmpzX2dsb2JhbF9nZXRfc3RyX24oSlNDb250ZXh0KiBjdHgsIGNvbnN0IGNoYXIqIHByb3AsIHNpemVfdCBsZW4pIHsKICBKU1ZhbHVlIHJldDsKICBKU0F0b20gYXRvbSA9IEpTX05ld0F0b21MZW4oY3R4LCBwcm9wLCBsZW4pOwogIHJldCA9IGpzX2dsb2JhbF9nZXRfYXRvbShjdHgsIGF0b20pOwogIEpTX0ZyZWVBdG9tKGN0eCwgYXRvbSk7CiAgcmV0dXJuIHJldDsKfQoKSlNWYWx1ZQpqc19nbG9iYWxfZ2V0X2F0b20oSlNDb250ZXh0KiBjdHgsIEpTQXRvbSBwcm9wKSB7CiAgSlNWYWx1ZSBnbG9iYWxfb2JqLCByZXQ7CiAgZ2xvYmFsX29iaiA9IEpTX0dldEdsb2JhbE9iamVjdChjdHgpOwogIHJldCA9IEpTX0dldFByb3BlcnR5KGN0eCwgZ2xvYmFsX29iaiwgcHJvcCk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgZ2xvYmFsX29iaik7CiAgcmV0dXJuIHJldDsKfQoKSlNWYWx1ZQpqc19nbG9iYWxfcHJvdG90eXBlKEpTQ29udGV4dCogY3R4LCBjb25zdCBjaGFyKiBjbGFzc19uYW1lKSB7CiAgSlNWYWx1ZSBjdG9yLCByZXQ7CiAgY3RvciA9IGpzX2dsb2JhbF9nZXRfc3RyKGN0eCwgY2xhc3NfbmFtZSk7CiAgcmV0ID0gSlNfR2V0UHJvcGVydHlTdHIoY3R4LCBjdG9yLCAicHJvdG90eXBlIik7CiAgSlNfRnJlZVZhbHVlKGN0eCwgY3Rvcik7CiAgcmV0dXJuIHJldDsKfQoKSlNWYWx1ZQpqc19nbG9iYWxfc3RhdGljX2Z1bmMoSlNDb250ZXh0KiBjdHgsIGNvbnN0IGNoYXIqIGNsYXNzX25hbWUsIGNvbnN0IGNoYXIqIGZ1bmNfbmFtZSkgewogIEpTVmFsdWUgY3RvciwgZnVuYzsKICBjdG9yID0ganNfZ2xvYmFsX2dldF9zdHIoY3R4LCBjbGFzc19uYW1lKTsKICBmdW5jID0gSlNfR2V0UHJvcGVydHlTdHIoY3R4LCBjdG9yLCBmdW5jX25hbWUpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIGN0b3IpOwogIHJldHVybiBmdW5jOwp9CgpKU1ZhbHVlCmpzX2dsb2JhbF9wcm90b3R5cGVfZnVuYyhKU0NvbnRleHQqIGN0eCwgY29uc3QgY2hhciogY2xhc3NfbmFtZSwgY29uc3QgY2hhciogZnVuY19uYW1lKSB7CiAgSlNWYWx1ZSBwcm90bywgZnVuYzsKICBwcm90byA9IGpzX2dsb2JhbF9wcm90b3R5cGUoY3R4LCBjbGFzc19uYW1lKTsKICBmdW5jID0gSlNfR2V0UHJvcGVydHlTdHIoY3R4LCBwcm90bywgZnVuY19uYW1lKTsKICBKU19GcmVlVmFsdWUoY3R4LCBwcm90byk7CiAgcmV0dXJuIGZ1bmM7Cn0KCkpTVmFsdWUKanNfaXRlcmF0b3JfbWV0aG9kKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3Qgb2JqKSB7CiAgSlNBdG9tIGF0b207CiAgSlNWYWx1ZSByZXQgPSBKU19VTkRFRklORUQ7CiAgYXRvbSA9IGpzX3N5bWJvbF9zdGF0aWNfYXRvbShjdHgsICJhc3luY0l0ZXJhdG9yIik7CiAgaWYoSlNfSGFzUHJvcGVydHkoY3R4LCBvYmosIGF0b20pKQogICAgcmV0ID0gSlNfR2V0UHJvcGVydHkoY3R4LCBvYmosIGF0b20pOwoKICBKU19GcmVlQXRvbShjdHgsIGF0b20pOwogIGlmKCFKU19Jc0Z1bmN0aW9uKGN0eCwgcmV0KSkgewogICAgYXRvbSA9IGpzX3N5bWJvbF9zdGF0aWNfYXRvbShjdHgsICJpdGVyYXRvciIpOwogICAgaWYoSlNfSGFzUHJvcGVydHkoY3R4LCBvYmosIGF0b20pKQogICAgICByZXQgPSBKU19HZXRQcm9wZXJ0eShjdHgsIG9iaiwgYXRvbSk7CgogICAgSlNfRnJlZUF0b20oY3R4LCBhdG9tKTsKICB9CiAgcmV0dXJuIHJldDsKfQoKSlNWYWx1ZQpqc19pdGVyYXRvcl9uZXcoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBvYmopIHsKICBKU1ZhbHVlIGZuLCByZXQgPSBKU19VTkRFRklORUQ7CiAgZm4gPSBqc19pdGVyYXRvcl9tZXRob2QoY3R4LCBvYmopOwogIGlmKEpTX0lzRnVuY3Rpb24oY3R4LCBmbikpCiAgICByZXQgPSBKU19DYWxsKGN0eCwgZm4sIG9iaiwgMCwgMCk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgZm4pOwogIHJldHVybiByZXQ7Cn0KCkpTVmFsdWUKanNfaXRlcmF0b3JfbmV4dChKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IG9iaiwgQk9PTCogZG9uZV9wKSB7CiAgSlNWYWx1ZSBmbiwgcmVzdWx0LCBkb25lLCB2YWx1ZTsKICBmbiA9IEpTX0dldFByb3BlcnR5U3RyKGN0eCwgb2JqLCAibmV4dCIpOwogIHJlc3VsdCA9IEpTX0NhbGwoY3R4LCBmbiwgb2JqLCAwLCAwKTsKICBKU19GcmVlVmFsdWUoY3R4LCBmbik7CiAgZG9uZSA9IEpTX0dldFByb3BlcnR5U3RyKGN0eCwgcmVzdWx0LCAiZG9uZSIpOwogIHZhbHVlID0gSlNfR2V0UHJvcGVydHlTdHIoY3R4LCByZXN1bHQsICJ2YWx1ZSIpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIHJlc3VsdCk7CiAgKmRvbmVfcCA9IEpTX1RvQm9vbChjdHgsIGRvbmUpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIGRvbmUpOwogIHJldHVybiB2YWx1ZTsKfQoKSlNWYWx1ZQpqc19pdGVyYXRvcl9yZXN1bHQoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB2YWx1ZSwgQk9PTCBkb25lKSB7CiAgSlNWYWx1ZSByZXQgPSBKU19OZXdPYmplY3QoY3R4KTsKCiAgSlNfU2V0UHJvcGVydHlTdHIoY3R4LCByZXQsICJ2YWx1ZSIsIEpTX0R1cFZhbHVlKGN0eCwgdmFsdWUpKTsKICBKU19TZXRQcm9wZXJ0eVN0cihjdHgsIHJldCwgImRvbmUiLCBKU19OZXdCb29sKGN0eCwgZG9uZSkpOwoKICByZXR1cm4gcmV0Owp9CgpzdGF0aWMgSlNWYWx1ZQpqc19pdGVyYXRvcl90aGVuX2ZuKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdLCBpbnQgbWFnaWMsIEpTVmFsdWVDb25zdCBkYXRhW10pIHsKICBKU1ZhbHVlIHJldCA9IEpTX05ld09iamVjdChjdHgpOwoKICBpZihhcmdjID49IDEpCiAgICBKU19TZXRQcm9wZXJ0eVN0cihjdHgsIHJldCwgInZhbHVlIiwgSlNfRHVwVmFsdWUoY3R4LCBhcmd2WzBdKSk7CiAgSlNfU2V0UHJvcGVydHlTdHIoY3R4LCByZXQsICJkb25lIiwgSlNfRHVwVmFsdWUoY3R4LCBkYXRhWzBdKSk7CgogIHJldHVybiByZXQ7Cn0KCkpTVmFsdWUKanNfaXRlcmF0b3JfdGhlbihKU0NvbnRleHQqIGN0eCwgQk9PTCBkb25lKSB7CiAgSlNWYWx1ZSByZXQ7CiAgSlNWYWx1ZUNvbnN0IGRhdGFbMV0gPSB7SlNfTmV3Qm9vbChjdHgsIGRvbmUpfTsKCiAgcmV0dXJuIEpTX05ld0NGdW5jdGlvbkRhdGEoY3R4LCBqc19pdGVyYXRvcl90aGVuX2ZuLCAxLCAwLCAxLCBkYXRhKTsKfQoKSlNWYWx1ZQpqc19vYmplY3RfY29uc3RydWN0b3IoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB2YWx1ZSkgewogIEpTVmFsdWUgY3RvciA9IEpTX1VOREVGSU5FRDsKICBpZihKU19Jc09iamVjdCh2YWx1ZSkpCiAgICBjdG9yID0gSlNfR2V0UHJvcGVydHlTdHIoY3R4LCB2YWx1ZSwgImNvbnN0cnVjdG9yIik7CiAgcmV0dXJuIGN0b3I7Cn0KCkpTVmFsdWUKanNfb2JqZWN0X3NwZWNpZXMoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB2YWx1ZSkgewogIEpTVmFsdWUgY3RvciA9IGpzX29iamVjdF9jb25zdHJ1Y3RvcihjdHgsIHZhbHVlKTsKICBKU0F0b20gc3ltYm9sX3NwZWNpZXMgPSBqc19zeW1ib2xfc3RhdGljX2F0b20oY3R4LCAic3BlY2llcyIpOwogIEpTVmFsdWUgc3BlY2llcyA9IEpTX0dldFByb3BlcnR5KGN0eCwgY3Rvciwgc3ltYm9sX3NwZWNpZXMpOwogIEpTX0ZyZWVBdG9tKGN0eCwgc3ltYm9sX3NwZWNpZXMpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIGN0b3IpOwogIHJldHVybiBzcGVjaWVzOwp9CgpjaGFyKgpqc19vYmplY3RfY2xhc3NuYW1lKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsdWUpIHsKICBKU1ZhbHVlIHByb3RvLCBjdG9yOwogIGNvbnN0IGNoYXIqIHN0cjsKICBjaGFyKiBuYW1lID0gMDsKICBpbnQgbmFtZWxlbjsKICBjdG9yID0ganNfb2JqZWN0X2NvbnN0cnVjdG9yKGN0eCwgdmFsdWUpOwogIGlmKCFKU19Jc0Z1bmN0aW9uKGN0eCwgY3RvcikpIHsKICAgIHByb3RvID0gSlNfR2V0UHJvdG90eXBlKGN0eCwgdmFsdWUpOwogICAgY3RvciA9IGpzX29iamVjdF9jb25zdHJ1Y3RvcihjdHgsIHByb3RvKTsKICB9CiAgaWYoKHN0ciA9IEpTX1RvQ1N0cmluZyhjdHgsIGN0b3IpKSkgewogICAgaWYoIXN0cm5jbXAoc3RyLCAiZnVuY3Rpb24gIiwgOSkpIHsKICAgICAgbmFtZWxlbiA9IGJ5dGVfY2hyKHN0ciArIDksIHN0cmxlbihzdHIpIC0gOSwgJygnKTsKICAgICAgaWYobmFtZWxlbikKICAgICAgICBuYW1lID0ganNfc3RybmR1cChjdHgsIHN0ciArIDksIG5hbWVsZW4pOwogICAgfQogIH0KICBpZighbmFtZSkgewogICAgaWYoc3RyKQogICAgICBqc19jc3RyaW5nX2ZyZWUoY3R4LCBzdHIpOwogICAgaWYoKHN0ciA9IEpTX1RvQ1N0cmluZyhjdHgsIEpTX0dldFByb3BlcnR5U3RyKGN0eCwgY3RvciwgIm5hbWUiKSkpICYmICpzdHIpCiAgICAgIG5hbWUgPSBqc19zdHJkdXAoY3R4LCBzdHIpOwogIH0KICBpZihzdHIpCiAgICBqc19jc3RyaW5nX2ZyZWUoY3R4LCBzdHIpOwogIHJldHVybiBuYW1lOwp9CgpCT09MCmpzX29iamVjdF9lcXVhbHMoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBhLCBKU1ZhbHVlQ29uc3QgYikgewogIEpTUHJvcGVydHlFbnVtICphdG9tc19hLCAqYXRvbXNfYjsKICB1aW50MzJfdCBpLCBuYXRvbXNfYSwgbmF0b21zX2I7CiAgaW50MzJfdCB0YSwgdGI7CiAgdGEgPSBqc192YWx1ZV90eXBlKGN0eCwgYSk7CiAgdGIgPSBqc192YWx1ZV90eXBlKGN0eCwgYik7CiAgYXNzZXJ0KHRhID09IFRZUEVfT0JKRUNUKTsKICBhc3NlcnQodGIgPT0gVFlQRV9PQkpFQ1QpOwogIGlmKEpTX0dldE93blByb3BlcnR5TmFtZXMoY3R4LCAmYXRvbXNfYSwgJm5hdG9tc19hLCBhLCBKU19HUE5fU1RSSU5HX01BU0sgfCBKU19HUE5fU1lNQk9MX01BU0sgfCBKU19HUE5fRU5VTV9PTkxZKSkKICAgIHJldHVybiBGQUxTRTsKCiAgaWYoSlNfR2V0T3duUHJvcGVydHlOYW1lcyhjdHgsICZhdG9tc19iLCAmbmF0b21zX2IsIGIsIEpTX0dQTl9TVFJJTkdfTUFTSyB8IEpTX0dQTl9TWU1CT0xfTUFTSyB8IEpTX0dQTl9FTlVNX09OTFkpKQogICAgcmV0dXJuIEZBTFNFOwoKICBpZihuYXRvbXNfYSAhPSBuYXRvbXNfYikKICAgIHJldHVybiBGQUxTRTsKCiAgcXVpY2tzb3J0X3IoJmF0b21zX2EsIG5hdG9tc19hLCBzaXplb2YoSlNQcm9wZXJ0eUVudW0pLCAmanNfcHJvcGVudW1fY21wLCBjdHgpOwogIHF1aWNrc29ydF9yKCZhdG9tc19iLCBuYXRvbXNfYiwgc2l6ZW9mKEpTUHJvcGVydHlFbnVtKSwgJmpzX3Byb3BlbnVtX2NtcCwgY3R4KTsKICBmb3IoaSA9IDA7IGkgPCBuYXRvbXNfYTsgaSsrKQogICAgaWYoYXRvbXNfYVtpXS5hdG9tICE9IGF0b21zX2JbaV0uYXRvbSkKICAgICAgcmV0dXJuIEZBTFNFOwogIHJldHVybiBUUlVFOwp9CgpCT09MCmpzX29iamVjdF9zYW1lMihKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IGEsIEpTVmFsdWVDb25zdCBiKSB7CiAgcmV0dXJuIGpzX29iamVjdF9zYW1lKGEsIGIpOwp9CgppbnQKanNfb2JqZWN0X2lzKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsdWUsIGNvbnN0IGNoYXIqIGNtcCkgewogIEJPT0wgcmV0ID0gRkFMU0U7CiAgY29uc3QgY2hhciogc3RyOwogIGlmKChzdHIgPSBqc19vYmplY3RfdG9zdHJpbmcoY3R4LCB2YWx1ZSkpKSB7CiAgICByZXQgPSBzdHJjbXAoc3RyLCBjbXApID09IDA7CiAgICBqc19jc3RyaW5nX2ZyZWUoY3R4LCBzdHIpOwogIH0KICByZXR1cm4gcmV0Owp9CgpKU1ZhbHVlCmpzX29iamVjdF9jb25zdHJ1Y3QoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBjdG9yKSB7CiAgSlNWYWx1ZUNvbnN0IGFyZ3NbXSA9IHtKU19VTkRFRklORUR9OwogIHJldHVybiBKU19DYWxsQ29uc3RydWN0b3IoY3R4LCBjdG9yLCAwLCBhcmdzKTsKfQoKSlNWYWx1ZQpqc19vYmplY3RfZXJyb3IoSlNDb250ZXh0KiBjdHgsIGNvbnN0IGNoYXIqIG1lc3NhZ2UpIHsKICBKU1ZhbHVlQ29uc3QgYXJnc1tdID0ge0pTX05ld1N0cmluZyhjdHgsIG1lc3NhZ2UpfTsKICBKU1ZhbHVlIHJldCA9IGpzX29iamVjdF9uZXcoY3R4LCAiRXJyb3IiLCAxLCBhcmdzKTsKICBKU19GcmVlVmFsdWUoY3R4LCBhcmdzWzBdKTsKICByZXR1cm4gcmV0Owp9CgpKU1ZhbHVlCmpzX29iamVjdF9uZXcoSlNDb250ZXh0KiBjdHgsIGNvbnN0IGNoYXIqIGNsYXNzX25hbWUsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdKSB7CiAgSlNWYWx1ZSBjdG9yID0ganNfZ2xvYmFsX2dldF9zdHIoY3R4LCBjbGFzc19uYW1lKTsKICBKU1ZhbHVlIG9iaiA9IEpTX0NhbGxDb25zdHJ1Y3RvcihjdHgsIGN0b3IsIGFyZ2MsIGFyZ3YpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIGN0b3IpOwogIHJldHVybiBvYmo7Cn0KCkpTVmFsdWUKanNfb2JqZWN0X2Z1bmN0aW9uKEpTQ29udGV4dCogY3R4LCBjb25zdCBjaGFyKiBmdW5jX25hbWUsIEpTVmFsdWVDb25zdCBvYmopIHsKICBKU1ZhbHVlIHJldCwgY3RvciA9IGpzX2dsb2JhbF9nZXRfc3RyKGN0eCwgIk9iamVjdCIpOwogIHJldCA9IGpzX2ludm9rZShjdHgsIGN0b3IsIGZ1bmNfbmFtZSwgMSwgJm9iaik7CiAgSlNfRnJlZVZhbHVlKGN0eCwgY3Rvcik7CiAgcmV0dXJuIHJldDsKfQoKQk9PTApqc19oYXNfcHJvcGVydHlzdHIoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBvYmosIGNvbnN0IGNoYXIqIHN0cikgewogIEpTQXRvbSBhdG9tOwogIEJPT0wgcmV0ID0gRkFMU0U7CiAgYXRvbSA9IEpTX05ld0F0b20oY3R4LCBzdHIpOwogIHJldCA9IEpTX0hhc1Byb3BlcnR5KGN0eCwgb2JqLCBhdG9tKTsKICBKU19GcmVlQXRvbShjdHgsIGF0b20pOwogIHJldHVybiByZXQ7Cn0KCkpTVmFsdWUKanNfZ2V0X3Byb3BlcnR5YXRvbV92YWx1ZShKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IG9iaiwgSlNBdG9tIHByb3ApIHsKICByZXR1cm4gSlNfR2V0UHJvcGVydHlJbnRlcm5hbChjdHgsIG9iaiwgcHJvcCwgSlNfTlVMTCwgRkFMU0UpOwp9CgpCT09MCmpzX2dldF9wcm9wZXJ0eXN0cl9ib29sKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3Qgb2JqLCBjb25zdCBjaGFyKiBzdHIpIHsKICBCT09MIHJldCA9IEZBTFNFOwogIEpTVmFsdWUgdmFsdWU7CiAgdmFsdWUgPSBKU19HZXRQcm9wZXJ0eVN0cihjdHgsIG9iaiwgc3RyKTsKICBpZighSlNfSXNFeGNlcHRpb24odmFsdWUpKQogICAgcmV0ID0gSlNfVG9Cb29sKGN0eCwgdmFsdWUpOwoKICBKU19GcmVlVmFsdWUoY3R4LCB2YWx1ZSk7CiAgcmV0dXJuIHJldDsKfQoKaW50NjRfdApqc19nZXRfcHJvcGVydHlzdHJfaW50NjQoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBvYmosIGNvbnN0IGNoYXIqIHN0cikgewogIGludDY0X3QgcmV0ID0gMDsKICBKU1ZhbHVlIHZhbHVlOwogIHZhbHVlID0gSlNfR2V0UHJvcGVydHlTdHIoY3R4LCBvYmosIHN0cik7CiAgSlNfVG9JbnQ2NChjdHgsICZyZXQsIHZhbHVlKTsKICBKU19GcmVlVmFsdWUoY3R4LCB2YWx1ZSk7CiAgcmV0dXJuIHJldDsKfQoKY29uc3QgY2hhcioKanNfZ2V0X3Byb3BlcnR5c3RyX2NzdHJpbmcoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBvYmosIGNvbnN0IGNoYXIqIHByb3ApIHsKICBKU1ZhbHVlIHZhbHVlOwogIGNvbnN0IGNoYXIqIHJldDsKICB2YWx1ZSA9IEpTX0dldFByb3BlcnR5U3RyKGN0eCwgb2JqLCBwcm9wKTsKICBpZihKU19Jc1VuZGVmaW5lZCh2YWx1ZSkgfHwgSlNfSXNFeGNlcHRpb24odmFsdWUpKQogICAgcmV0dXJuIDA7CgogIHJldCA9IEpTX1RvQ1N0cmluZyhjdHgsIHZhbHVlKTsKICBKU19GcmVlVmFsdWUoY3R4LCB2YWx1ZSk7CiAgcmV0dXJuIHJldDsKfQoKY29uc3QgY2hhcioKanNfZ2V0X3Byb3BlcnR5c3RyX2NzdHJpbmdsZW4oSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBvYmosIGNvbnN0IGNoYXIqIHByb3AsIHNpemVfdCogbGVucCkgewogIEpTVmFsdWUgdmFsdWU7CiAgY29uc3QgY2hhciogcmV0OwogIHZhbHVlID0gSlNfR2V0UHJvcGVydHlTdHIoY3R4LCBvYmosIHByb3ApOwogIGlmKEpTX0lzVW5kZWZpbmVkKHZhbHVlKSB8fCBKU19Jc0V4Y2VwdGlvbih2YWx1ZSkpCiAgICByZXR1cm4gMDsKCiAgcmV0ID0gSlNfVG9DU3RyaW5nTGVuKGN0eCwgbGVucCwgdmFsdWUpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIHZhbHVlKTsKICByZXR1cm4gcmV0Owp9Cgpjb25zdCBjaGFyKgpqc19nZXRfcHJvcGVydHlpbnRfY3N0cmluZyhKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IG9iaiwgdWludDMyX3QgcHJvcCkgewogIEpTVmFsdWUgdmFsdWU7CiAgY2hhciogcmV0OwogIHZhbHVlID0gSlNfR2V0UHJvcGVydHlVaW50MzIoY3R4LCBvYmosIHByb3ApOwogIC8qIGlmKEpTX0lzVW5kZWZpbmVkKHZhbHVlKSB8fCBKU19Jc0V4Y2VwdGlvbih2YWx1ZSkpCiAgICAgcmV0dXJuIDA7Ki8KCiAgcmV0ID0ganNfdG9zdHJpbmcoY3R4LCB2YWx1ZSk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgdmFsdWUpOwogIHJldHVybiByZXQ7Cn0KCmludDMyX3QKanNfZ2V0X3Byb3BlcnR5aW50X2ludDMyKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3Qgb2JqLCB1aW50MzJfdCBwcm9wKSB7CiAgaW50MzJfdCByZXQ7CiAgSlNWYWx1ZSB2YWx1ZSA9IEpTX0dldFByb3BlcnR5VWludDMyKGN0eCwgb2JqLCBwcm9wKTsKICBKU19Ub0ludDMyKGN0eCwgJnJldCwgdmFsdWUpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIHZhbHVlKTsKICByZXR1cm4gcmV0Owp9CgpjaGFyKgpqc19nZXRfcHJvcGVydHlzdHJfc3RyaW5nKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3Qgb2JqLCBjb25zdCBjaGFyKiBwcm9wKSB7CiAgSlNWYWx1ZSB2YWx1ZTsKICBjaGFyKiByZXQ7CiAgdmFsdWUgPSBKU19HZXRQcm9wZXJ0eVN0cihjdHgsIG9iaiwgcHJvcCk7CiAgaWYoSlNfSXNVbmRlZmluZWQodmFsdWUpIHx8IEpTX0lzRXhjZXB0aW9uKHZhbHVlKSkKICAgIHJldHVybiAwOwoKICByZXQgPSBqc190b3N0cmluZyhjdHgsIHZhbHVlKTsKICBKU19GcmVlVmFsdWUoY3R4LCB2YWx1ZSk7CiAgcmV0dXJuIHJldDsKfQoKY2hhcioKanNfZ2V0X3Byb3BlcnR5c3RyX3N0cmluZ2xlbihKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IG9iaiwgY29uc3QgY2hhciogcHJvcCwgc2l6ZV90KiBsZW5wKSB7CiAgSlNWYWx1ZSB2YWx1ZTsKICBjaGFyKiByZXQ7CiAgdmFsdWUgPSBKU19HZXRQcm9wZXJ0eVN0cihjdHgsIG9iaiwgcHJvcCk7CiAgaWYoSlNfSXNVbmRlZmluZWQodmFsdWUpIHx8IEpTX0lzRXhjZXB0aW9uKHZhbHVlKSkKICAgIHJldHVybiAwOwoKICByZXQgPSBqc190b3N0cmluZ2xlbihjdHgsIGxlbnAsIHZhbHVlKTsKICBKU19GcmVlVmFsdWUoY3R4LCB2YWx1ZSk7CiAgcmV0dXJuIHJldDsKfQoKaW50MzJfdApqc19nZXRfcHJvcGVydHlzdHJfaW50MzIoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBvYmosIGNvbnN0IGNoYXIqIHByb3ApIHsKICBKU1ZhbHVlIHZhbHVlOwogIGludDMyX3QgcmV0OwogIHZhbHVlID0gSlNfR2V0UHJvcGVydHlTdHIoY3R4LCBvYmosIHByb3ApOwogIGlmKEpTX0lzVW5kZWZpbmVkKHZhbHVlKSB8fCBKU19Jc0V4Y2VwdGlvbih2YWx1ZSkpCiAgICByZXR1cm4gMDsKICBKU19Ub0ludDMyKGN0eCwgJnJldCwgdmFsdWUpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIHZhbHVlKTsKICByZXR1cm4gcmV0Owp9Cgp1aW50NjRfdApqc19nZXRfcHJvcGVydHlzdHJfdWludDY0KEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3Qgb2JqLCBjb25zdCBjaGFyKiBwcm9wKSB7CiAgSlNWYWx1ZSB2YWx1ZTsKICB1aW50NjRfdCByZXQ7CiAgdmFsdWUgPSBKU19HZXRQcm9wZXJ0eVN0cihjdHgsIG9iaiwgcHJvcCk7CiAgaWYoSlNfSXNVbmRlZmluZWQodmFsdWUpIHx8IEpTX0lzRXhjZXB0aW9uKHZhbHVlKSkKICAgIHJldHVybiAwOwogIEpTX1RvSW5kZXgoY3R4LCAmcmV0LCB2YWx1ZSk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgdmFsdWUpOwogIHJldHVybiByZXQ7Cn0KCkpTQXRvbQpqc19nZXRfcHJvcGVydHlzdHJfYXRvbShKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IG9iaiwgY29uc3QgY2hhciogcHJvcCkgewogIEpTVmFsdWUgdmFsdWU7CiAgSlNBdG9tIHJldDsKICB2YWx1ZSA9IEpTX0dldFByb3BlcnR5U3RyKGN0eCwgb2JqLCBwcm9wKTsKICBpZihKU19Jc1VuZGVmaW5lZCh2YWx1ZSkgfHwgSlNfSXNFeGNlcHRpb24odmFsdWUpKQogICAgcmV0dXJuIDA7CiAgcmV0ID0gSlNfVmFsdWVUb0F0b20oY3R4LCB2YWx1ZSk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgdmFsdWUpOwogIHJldHVybiByZXQ7Cn0KCnZvaWQKanNfc2V0X3Byb3BlcnR5aW50X3N0cmluZyhKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IG9iaiwgdWludDMyX3QgaSwgY29uc3QgY2hhciogc3RyKSB7CiAgSlNWYWx1ZSB2YWx1ZTsKICB2YWx1ZSA9IEpTX05ld1N0cmluZyhjdHgsIHN0cik7CiAgSlNfU2V0UHJvcGVydHlVaW50MzIoY3R4LCBvYmosIGksIHZhbHVlKTsKfQoKdm9pZApqc19zZXRfcHJvcGVydHlpbnRfaW50KEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3Qgb2JqLCB1aW50MzJfdCBpLCBpbnQzMl90IHZhbHVlKSB7CiAgSlNfU2V0UHJvcGVydHlVaW50MzIoY3R4LCBvYmosIGksIEpTX05ld0ludDMyKGN0eCwgdmFsdWUpKTsKfQoKdm9pZApqc19zZXRfcHJvcGVydHlzdHJfc3RyaW5nKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3Qgb2JqLCBjb25zdCBjaGFyKiBwcm9wLCBjb25zdCBjaGFyKiBzdHIpIHsKICBKU1ZhbHVlIHZhbHVlOwogIHZhbHVlID0gSlNfTmV3U3RyaW5nKGN0eCwgc3RyKTsKICBKU19TZXRQcm9wZXJ0eVN0cihjdHgsIG9iaiwgcHJvcCwgdmFsdWUpOwp9Cgp2b2lkCmpzX3NldF9wcm9wZXJ0eXN0cl9zdHJpbmdsZW4oSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBvYmosIGNvbnN0IGNoYXIqIHByb3AsIGNvbnN0IGNoYXIqIHN0ciwgc2l6ZV90IGxlbikgewogIEpTVmFsdWUgdmFsdWU7CiAgdmFsdWUgPSBKU19OZXdTdHJpbmdMZW4oY3R4LCBzdHIsIGxlbik7CiAgSlNfU2V0UHJvcGVydHlTdHIoY3R4LCBvYmosIHByb3AsIHZhbHVlKTsKfQoKaW50CmpzX2dldF9wcm9wZXJ0eWRlc2NyaXB0b3IoSlNDb250ZXh0KiBjdHgsIEpTUHJvcGVydHlEZXNjcmlwdG9yKiBkZXNjLCBKU1ZhbHVlQ29uc3QgdmFsdWUsIEpTQXRvbSBwcm9wKSB7CiAgSlNWYWx1ZSBvYmosIHByb3RvOwogIG9iaiA9IEpTX0R1cFZhbHVlKGN0eCwgdmFsdWUpOwogIGRvIHsKICAgIGlmKEpTX0dldE93blByb3BlcnR5KGN0eCwgZGVzYywgb2JqLCBwcm9wKSA9PSBUUlVFKQogICAgICByZXR1cm4gVFJVRTsKICAgIHByb3RvID0gSlNfR2V0UHJvdG90eXBlKGN0eCwgb2JqKTsKICAgIGlmKEpTX1ZBTFVFX0dFVF9PQkoocHJvdG8pID09IEpTX1ZBTFVFX0dFVF9PQkoob2JqKSkKICAgICAgYnJlYWs7CiAgICBKU19GcmVlVmFsdWUoY3R4LCBvYmopOwogICAgb2JqID0gcHJvdG87CiAgfSB3aGlsZShKU19Jc09iamVjdChvYmopKTsKICByZXR1cm4gRkFMU0U7Cn0KCkpTQ2xhc3NJRApqc19jbGFzc19pZChKU0NvbnRleHQqIGN0eCwgaW50IGlkKSB7CiAgcmV0dXJuIGN0eC0+cnQtPmNsYXNzX2FycmF5W2lkXS5jbGFzc19pZDsKfQoKSlNDbGFzc0lECmpzX2NsYXNzX25ld2lkKHZvaWQpIHsKICBKU0NsYXNzSUQgaWQ7CiAgSlNfTmV3Q2xhc3NJRCgmaWQpOwogIHJldHVybiBpZDsKfQoKSlNDbGFzcyoKanNfY2xhc3NfZ2V0KEpTQ29udGV4dCogY3R4LCBKU0NsYXNzSUQgaWQpIHsKICBKU0NsYXNzKiByZXQgPSAmY3R4LT5ydC0+Y2xhc3NfYXJyYXlbaWRdOwogIHJldHVybiByZXQtPmNsYXNzX2lkID09IGlkID8gcmV0IDogMDsKfQoKSlNDbGFzc0lECmpzX2NsYXNzX2ZpbmQoSlNDb250ZXh0KiBjdHgsIGNvbnN0IGNoYXIqIG5hbWUpIHsKICBKU0F0b20gYXRvbSA9IEpTX05ld0F0b20oY3R4LCBuYW1lKTsKICBKU1J1bnRpbWUqIHJ0ID0gY3R4LT5ydDsKICBpbnQgaSwgbiA9IHJ0LT5jbGFzc19jb3VudDsKICBmb3IoaSA9IDA7IGkgPCBuOyBpKyspCiAgICBpZihydC0+Y2xhc3NfYXJyYXlbaV0uY2xhc3NfbmFtZSA9PSBhdG9tKQogICAgICByZXR1cm4gaTsKCiAgcmV0dXJuIC0xOwp9CgpKU0F0b20KanNfY2xhc3NfYXRvbShKU0NvbnRleHQqIGN0eCwgSlNDbGFzc0lEIGlkKSB7CiAgSlNBdG9tIGF0b20gPSAwOwogIGlmKGlkID4gMCAmJiBpZCA8IChKU0NsYXNzSUQpY3R4LT5ydC0+Y2xhc3NfY291bnQpCiAgICBhdG9tID0gY3R4LT5ydC0+Y2xhc3NfYXJyYXlbaWRdLmNsYXNzX25hbWU7CiAgcmV0dXJuIGF0b207Cn0KCmNvbnN0IGNoYXIqCmpzX2NsYXNzX25hbWUoSlNDb250ZXh0KiBjdHgsIEpTQ2xhc3NJRCBpZCkgewogIEpTQXRvbSBhdG9tID0gY3R4LT5ydC0+Y2xhc3NfYXJyYXlbaWRdLmNsYXNzX25hbWU7CiAgcmV0dXJuIEpTX0F0b21Ub0NTdHJpbmcoY3R4LCBhdG9tKTsKfQoKY29uc3QgY2hhcioKanNfb2JqZWN0X3Rvc3RyaW5nKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsdWUpIHsKICBzdGF0aWMgdGhyZWFkX2xvY2FsIEpTVmFsdWUgbWV0aG9kOwoKICBpZihKU19WQUxVRV9HRVRfVEFHKG1ldGhvZCkgPT0gMCkKICAgIG1ldGhvZCA9IGpzX2dsb2JhbF9wcm90b3R5cGVfZnVuYyhjdHgsICJPYmplY3QiLCAidG9TdHJpbmciKTsKCiAgcmV0dXJuIGpzX29iamVjdF90b3N0cmluZzIoY3R4LCBtZXRob2QsIHZhbHVlKTsKfQoKY29uc3QgY2hhcioKanNfb2JqZWN0X3Rvc3RyaW5nMihKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IG1ldGhvZCwgSlNWYWx1ZUNvbnN0IHZhbHVlKSB7CiAgSlNWYWx1ZSBzdHIgPSBKU19DYWxsKGN0eCwgbWV0aG9kLCB2YWx1ZSwgMCwgMCk7CiAgY29uc3QgY2hhciogcyA9IEpTX1RvQ1N0cmluZyhjdHgsIHN0cik7CiAgSlNfRnJlZVZhbHVlKGN0eCwgc3RyKTsKICByZXR1cm4gczsKfQoKY29uc3QgY2hhcioKanNfZnVuY3Rpb25fdG9zdHJpbmcoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB2YWx1ZSkgewogIEpTVmFsdWUgc3RyID0ganNfdmFsdWVfdG9zdHJpbmcoY3R4LCAiRnVuY3Rpb24iLCB2YWx1ZSk7CiAgY29uc3QgY2hhciogcyA9IEpTX1RvQ1N0cmluZyhjdHgsIHN0cik7CiAgSlNfRnJlZVZhbHVlKGN0eCwgc3RyKTsKICByZXR1cm4gczsKfQoKQk9PTApqc19mdW5jdGlvbl9pc25hdGl2ZShKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHZhbHVlKSB7CiAgY29uc3QgY2hhciogZm4gPSBqc19mdW5jdGlvbl90b3N0cmluZyhjdHgsIHZhbHVlKTsKICBCT09MIHJldCA9ICEhc3Ryc3RyKGZuLCAiXG4gICAgW25hdGl2ZSBjb2RlXVxuIik7CiAgSlNfRnJlZUNTdHJpbmcoY3R4LCBmbik7CiAgcmV0dXJuIHJldDsKfQoKSlNWYWx1ZQpqc19mdW5jdGlvbl9wcm90b3R5cGUoSlNDb250ZXh0KiBjdHgpIHsKICByZXR1cm4ganNfZ2xvYmFsX3Byb3RvdHlwZShjdHgsICJGdW5jdGlvbiIpOwp9CgpCT09MCmpzX2lzX2lucHV0KEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsdWUpIHsKICByZXR1cm4gSlNfSXNTdHJpbmcodmFsdWUpIHx8IGpzX3ZhbHVlX2lzY2xhc3MoY3R4LCB2YWx1ZSwgSlNfQ0xBU1NfQVJSQVlfQlVGRkVSKTsKfQoKaW50CmpzX3Byb3BlbnVtX2NtcChjb25zdCB2b2lkKiBhLCBjb25zdCB2b2lkKiBiLCB2b2lkKiBwdHIpIHsKICBKU0NvbnRleHQqIGN0eCA9IHB0cjsKICBjb25zdCBjaGFyICpzdHJhLCAqc3RyYjsKICBpbnQgcmV0OwogIHN0cmEgPSBKU19BdG9tVG9DU3RyaW5nKGN0eCwgKChjb25zdCBKU1Byb3BlcnR5RW51bSopYSktPmF0b20pOwogIHN0cmIgPSBKU19BdG9tVG9DU3RyaW5nKGN0eCwgKChjb25zdCBKU1Byb3BlcnR5RW51bSopYiktPmF0b20pOwogIHJldCA9IHN0cnZlcnNjbXAoc3RyYSwgc3RyYik7CiAganNfY3N0cmluZ19mcmVlKGN0eCwgc3RyYSk7CiAganNfY3N0cmluZ19mcmVlKGN0eCwgc3RyYik7CiAgcmV0dXJuIHJldDsKfQoKdm9pZApqc19wcm9wZXJ0eWVudW1zX2ZyZWUoSlNDb250ZXh0KiBjdHgsIEpTUHJvcGVydHlFbnVtKiBwcm9wcywgc2l6ZV90IGxlbikgewogIHVpbnQzMl90IGk7CiAgZm9yKGkgPSAwOyBpIDwgbGVuOyBpKyspIEpTX0ZyZWVBdG9tKGN0eCwgcHJvcHNbaV0uYXRvbSk7CiAgLy8ganNfZnJlZShjdHgsIHByb3BzKTsKfQoKdm9pZApqc19zdHJ2X2ZyZWVfbihKU0NvbnRleHQqIGN0eCwgaW50IG4sIGNoYXIqIGFyZ3ZbXSkgewogIGludCBpOwogIGZvcihpID0gMDsgaSA8IG47IGkrKykgewogICAgaWYoYXJndltpXSkgewogICAgICBqc19mcmVlKGN0eCwgYXJndltpXSk7CiAgICAgIGFyZ3ZbaV0gPSAwOwogICAgfQogIH0KfQoKdm9pZApqc19zdHJ2X2ZyZWUoSlNDb250ZXh0KiBjdHgsIGNoYXIqKiBzdHJ2KSB7CiAgc2l6ZV90IGk7CiAgaWYoc3RydiA9PSAwKQogICAgcmV0dXJuOwoKICBmb3IoaSA9IDA7IHN0cnZbaV07IGkrKykgeyBqc19mcmVlKGN0eCwgc3RydltpXSk7IH0KICBqc19mcmVlKGN0eCwgc3Rydik7Cn0KCnZvaWQKanNfc3Rydl9mcmVlX3J0KEpTUnVudGltZSogcnQsIGNoYXIqKiBzdHJ2KSB7CiAgc2l6ZV90IGk7CiAgaWYoc3RydiA9PSAwKQogICAgcmV0dXJuOwoKICBmb3IoaSA9IDA7IHN0cnZbaV07IGkrKykgeyBqc19mcmVlX3J0KHJ0LCBzdHJ2W2ldKTsgfQogIGpzX2ZyZWVfcnQocnQsIHN0cnYpOwp9CgpKU1ZhbHVlCmpzX3N0cnZfdG9fYXJyYXkoSlNDb250ZXh0KiBjdHgsIGNoYXIqKiBzdHJ2KSB7CiAgSlNWYWx1ZSByZXQgPSBKU19OZXdBcnJheShjdHgpOwogIGlmKHN0cnYpIHsKICAgIHNpemVfdCBpOwogICAgZm9yKGkgPSAwOyBzdHJ2W2ldOyBpKyspIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgcmV0LCBpLCBKU19OZXdTdHJpbmcoY3R4LCBzdHJ2W2ldKSk7CiAgfQogIHJldHVybiByZXQ7Cn0KCnNpemVfdApqc19zdHJ2X2xlbmd0aChjaGFyKiogc3RydikgewogIHNpemVfdCBpOwogIGZvcihpID0gMDsgc3RydltpXTsgaSsrKSB7fQogIHJldHVybiBpOwp9CgpjaGFyKioKanNfc3Rydl9kdXAoSlNDb250ZXh0KiBjdHgsIGNoYXIqKiBzdHJ2KSB7CiAgY2hhcioqIHJldDsKICBzaXplX3QgaSwgbGVuID0ganNfc3Rydl9sZW5ndGgoc3Rydik7CiAgcmV0ID0ganNfbWFsbG9jKGN0eCwgKGxlbiArIDEpICogc2l6ZW9mKGNoYXIqKSk7CiAgZm9yKGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgcmV0W2ldID0ganNfc3RyZHVwKGN0eCwgc3RydltpXSk7IH0KICByZXRbaV0gPSAwOwogIHJldHVybiByZXQ7Cn0KCkpTQXRvbQpqc19zeW1ib2xfc3RhdGljX2F0b20oSlNDb250ZXh0KiBjdHgsIGNvbnN0IGNoYXIqIG5hbWUpIHsKICBKU1ZhbHVlIHN5bSA9IGpzX3N5bWJvbF9zdGF0aWNfdmFsdWUoY3R4LCBuYW1lKTsKICBKU0F0b20gcmV0ID0gSlNfVmFsdWVUb0F0b20oY3R4LCBzeW0pOwogIEpTX0ZyZWVWYWx1ZShjdHgsIHN5bSk7CiAgcmV0dXJuIHJldDsKfQoKSlNWYWx1ZQpqc19zeW1ib2xfc3RhdGljX3ZhbHVlKEpTQ29udGV4dCogY3R4LCBjb25zdCBjaGFyKiBuYW1lKSB7CiAgSlNWYWx1ZSBzeW1ib2xfY3RvciwgcmV0OwogIHN5bWJvbF9jdG9yID0ganNfc3ltYm9sX2N0b3IoY3R4KTsKICByZXQgPSBKU19HZXRQcm9wZXJ0eVN0cihjdHgsIHN5bWJvbF9jdG9yLCBuYW1lKTsKICBKU19GcmVlVmFsdWUoY3R4LCBzeW1ib2xfY3Rvcik7CiAgcmV0dXJuIHJldDsKfQoKSlNWYWx1ZQpqc19zeW1ib2xfY3RvcihKU0NvbnRleHQqIGN0eCkgewogIHJldHVybiBqc19nbG9iYWxfZ2V0X3N0cihjdHgsICJTeW1ib2wiKTsKfQoKSlNWYWx1ZQpqc19zeW1ib2xfaW52b2tlX3N0YXRpYyhKU0NvbnRleHQqIGN0eCwgY29uc3QgY2hhciogbmFtZSwgSlNWYWx1ZUNvbnN0IGFyZykgewogIEpTVmFsdWUgcmV0OwogIEpTQXRvbSBtZXRob2RfbmFtZSA9IEpTX05ld0F0b20oY3R4LCBuYW1lKTsKICByZXQgPSBKU19JbnZva2UoY3R4LCBqc19zeW1ib2xfY3RvcihjdHgpLCBtZXRob2RfbmFtZSwgMSwgJmFyZyk7CiAgSlNfRnJlZUF0b20oY3R4LCBtZXRob2RfbmFtZSk7CiAgcmV0dXJuIHJldDsKfQoKSlNWYWx1ZQpqc19zeW1ib2xfZm9yKEpTQ29udGV4dCogY3R4LCBjb25zdCBjaGFyKiBzeW1fZm9yKSB7CiAgSlNWYWx1ZSBrZXksIHN5bTsKICBKU0F0b20gYXRvbTsKICBrZXkgPSBKU19OZXdTdHJpbmcoY3R4LCBzeW1fZm9yKTsKICBzeW0gPSBqc19zeW1ib2xfaW52b2tlX3N0YXRpYyhjdHgsICJmb3IiLCBrZXkpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIGtleSk7CiAgcmV0dXJuIHN5bTsKfQoKSlNBdG9tCmpzX3N5bWJvbF9mb3JfYXRvbShKU0NvbnRleHQqIGN0eCwgY29uc3QgY2hhciogc3ltX2ZvcikgewogIEpTVmFsdWUgc3ltID0ganNfc3ltYm9sX2ZvcihjdHgsIHN5bV9mb3IpOwogIEpTQXRvbSBhdG9tID0gSlNfVmFsdWVUb0F0b20oY3R4LCBzeW0pOwogIEpTX0ZyZWVWYWx1ZShjdHgsIHN5bSk7CiAgcmV0dXJuIGF0b207Cn0KCkpTVmFsdWUKanNfc3ltYm9sX3RvX3N0cmluZyhKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHN5bSkgewogIEpTVmFsdWUgdmFsdWUsIHN0cjsKICBKU0F0b20gYXRvbTsKICB2YWx1ZSA9IGpzX3N5bWJvbF9pbnZva2Vfc3RhdGljKGN0eCwgImtleUZvciIsIHN5bSk7CiAgaWYoIUpTX0lzVW5kZWZpbmVkKHZhbHVlKSkKICAgIHJldHVybiB2YWx1ZTsKCiAgYXRvbSA9IEpTX1ZhbHVlVG9BdG9tKGN0eCwgc3ltKTsKICBzdHIgPSBKU19BdG9tVG9TdHJpbmcoY3R4LCBhdG9tKTsKICBKU19GcmVlQXRvbShjdHgsIGF0b20pOwogIHJldHVybiBzdHI7Cn0KCmNvbnN0IGNoYXIqCmpzX3N5bWJvbF90b19jc3RyaW5nKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3Qgc3ltKSB7CiAgSlNWYWx1ZSB2YWx1ZSA9IGpzX3N5bWJvbF90b19zdHJpbmcoY3R4LCBzeW0pOwogIGNvbnN0IGNoYXIqIHN0cjsKICBzdHIgPSBKU19Ub0NTdHJpbmcoY3R4LCB2YWx1ZSk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgdmFsdWUpOwogIHJldHVybiBzdHI7Cn0KCkpTVmFsdWUqCmpzX3ZhbHVlc19kdXAoSlNDb250ZXh0KiBjdHgsIGludCBudmFsdWVzLCBKU1ZhbHVlQ29uc3QqIHZhbHVlcykgewogIEpTVmFsdWUqIHJldCA9IGpzX21hbGxvY3pfcnQoY3R4LT5ydCwgc2l6ZW9mKEpTVmFsdWUpICogbnZhbHVlcyk7CiAgaW50IGk7CiAgZm9yKGkgPSAwOyBpIDwgbnZhbHVlczsgaSsrKSByZXRbaV0gPSBKU19EdXBWYWx1ZVJUKGN0eC0+cnQsIHZhbHVlc1tpXSk7CiAgcmV0dXJuIHJldDsKfQovKgp2b2lkCmpzX3ZhbHVlc19mcmVlKEpTQ29udGV4dCogY3R4LCBpbnQgbnZhbHVlcywgSlNWYWx1ZUNvbnN0KiB2YWx1ZXMpIHsKICBpbnQgaTsKICBmb3IoaSA9IDA7IGkgPCBudmFsdWVzOyBpKyspIEpTX0ZyZWVWYWx1ZShjdHgsIHZhbHVlc1tpXSk7CiAganNfZnJlZShjdHgsIHZhbHVlcyk7Cn0KKi8Kdm9pZApqc192YWx1ZXNfZnJlZShKU1J1bnRpbWUqIHJ0LCBpbnQgbnZhbHVlcywgSlNWYWx1ZUNvbnN0KiB2YWx1ZXMpIHsKICBpbnQgaTsKICBmb3IoaSA9IDA7IGkgPCBudmFsdWVzOyBpKyspIEpTX0ZyZWVWYWx1ZVJUKHJ0LCB2YWx1ZXNbaV0pOwogIGpzX2ZyZWVfcnQocnQsIHZhbHVlcyk7Cn0KCkpTVmFsdWUKanNfdmFsdWVzX3RvYXJyYXkoSlNDb250ZXh0KiBjdHgsIGludCBudmFsdWVzLCBKU1ZhbHVlQ29uc3QqIHZhbHVlcykgewogIGludCBpOwogIEpTVmFsdWUgcmV0ID0gSlNfTmV3QXJyYXkoY3R4KTsKICBmb3IoaSA9IDA7IGkgPCBudmFsdWVzOyBpKyspIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgcmV0LCBpLCBKU19EdXBWYWx1ZShjdHgsIHZhbHVlc1tpXSkpOwogIHJldHVybiByZXQ7Cn0KCkpTVmFsdWUqCmpzX3ZhbHVlc19mcm9tYXJyYXkoSlNDb250ZXh0KiBjdHgsIHNpemVfdCogbnZhbHVlc19wLCBKU1ZhbHVlQ29uc3QgYXJyKSB7CiAgc2l6ZV90IGksIGxlbiA9IGpzX2FycmF5X2xlbmd0aChjdHgsIGFycik7CiAgSlNWYWx1ZSogcmV0ID0ganNfbWFsbG9jeihjdHgsIHNpemVvZihKU1ZhbHVlQ29uc3QpICogbGVuKTsKCiAgaWYobnZhbHVlc19wKQogICAgKm52YWx1ZXNfcCA9IGxlbjsKCiAgZm9yKGkgPSAwOyBpIDwgbGVuOyBpKyspIHsgcmV0W2ldID0gSlNfR2V0UHJvcGVydHlVaW50MzIoY3R4LCBhcnIsIGkpOyB9CiAgcmV0dXJuIHJldDsKfQoKY29uc3QgY2hhcioKanNfdmFsdWVfdGFnX25hbWUoaW50IHRhZykgewogIHN3aXRjaCh0YWcpIHsKICAgIGNhc2UgSlNfVEFHX0JJR19ERUNJTUFMOiByZXR1cm4gIkJJR19ERUNJTUFMIjsKICAgIGNhc2UgSlNfVEFHX0JJR19JTlQ6IHJldHVybiAiQklHX0lOVCI7CiAgICBjYXNlIEpTX1RBR19CSUdfRkxPQVQ6IHJldHVybiAiQklHX0ZMT0FUIjsKICAgIGNhc2UgSlNfVEFHX1NZTUJPTDogcmV0dXJuICJTWU1CT0wiOwogICAgY2FzZSBKU19UQUdfU1RSSU5HOiByZXR1cm4gIlNUUklORyI7CiAgICBjYXNlIEpTX1RBR19NT0RVTEU6IHJldHVybiAiTU9EVUxFIjsKICAgIGNhc2UgSlNfVEFHX0ZVTkNUSU9OX0JZVEVDT0RFOiByZXR1cm4gIkZVTkNUSU9OX0JZVEVDT0RFIjsKICAgIGNhc2UgSlNfVEFHX09CSkVDVDogcmV0dXJuICJPQkpFQ1QiOwogICAgY2FzZSBKU19UQUdfSU5UOiByZXR1cm4gIklOVCI7CiAgICBjYXNlIEpTX1RBR19CT09MOiByZXR1cm4gIkJPT0wiOwogICAgY2FzZSBKU19UQUdfTlVMTDogcmV0dXJuICJOVUxMIjsKICAgIGNhc2UgSlNfVEFHX1VOREVGSU5FRDogcmV0dXJuICJVTkRFRklORUQiOwogICAgY2FzZSBKU19UQUdfVU5JTklUSUFMSVpFRDogcmV0dXJuICJVTklOSVRJQUxJWkVEIjsKICAgIGNhc2UgSlNfVEFHX0NBVENIX09GRlNFVDogcmV0dXJuICJDQVRDSF9PRkZTRVQiOwogICAgY2FzZSBKU19UQUdfRVhDRVBUSU9OOiByZXR1cm4gIkVYQ0VQVElPTiI7CiAgICBjYXNlIEpTX1RBR19GTE9BVDY0OiByZXR1cm4gIkZMT0FUNjQiOwogIH0KICBhc3NlcnQoMCk7Cn0KCmNvbnN0IGNoYXIqIGNvbnN0Kgpqc192YWx1ZV90eXBlcygpIHsKICByZXR1cm4gKGNvbnN0IGNoYXIqIGNvbnN0W10pewogICAgICAidW5kZWZpbmVkIiwgICAgICJudWxsIiwgICAgICAgICAiYm9vbCIsICAgICAgImludCIsICJvYmplY3QiLCAgICJzdHJpbmciLCAic3ltYm9sIiwgImJpZ19mbG9hdCIsCiAgICAgICJiaWdfaW50IiwgICAgICAgImJpZ19kZWNpbWFsIiwgICJmbG9hdDY0IiwgICAibmFuIiwgImZ1bmN0aW9uIiwgImFycmF5IiwgICJtb2R1bGUiLCAiZnVuY3Rpb25fYnl0ZWNvZGUiLAogICAgICAidW5pbml0aWFsaXplZCIsICJjYXRjaF9vZmZzZXQiLCAiZXhjZXB0aW9uIiwgMCwKICB9Owp9Cgpjb25zdCBjaGFyKgpqc192YWx1ZV90eXBlb2YoSlNWYWx1ZUNvbnN0IHZhbHVlKSB7CiAgaW50MzJfdCBmbGFnID0ganNfdmFsdWVfdHlwZV9mbGFnKHZhbHVlKTsKICByZXR1cm4gKChjb25zdCBjaGFyKiBjb25zdFtdKXsKICAgICAgInVuZGVmaW5lZCIsICAgICAib2JqZWN0IiwgICAgICAgImJvb2xlYW4iLCAgICJudW1iZXIiLCAib2JqZWN0IiwgICAic3RyaW5nIiwgInN5bWJvbCIsICJiaWdmbG9hdCIsCiAgICAgICJiaWdpbnQiLCAgICAgICAgImJpZ2RlY2ltYWwiLCAgICJudW1iZXIiLCAgICAibnVtYmVyIiwgImZ1bmN0aW9uIiwgIm9iamVjdCIsICJtb2R1bGUiLCAiZnVuY3Rpb25fYnl0ZWNvZGUiLAogICAgICAidW5pbml0aWFsaXplZCIsICJjYXRjaF9vZmZzZXQiLCAiZXhjZXB0aW9uIiwgMCwKICB9KVtmbGFnXTsKfQoKY29uc3QgY2hhcioKanNfdmFsdWVfdHlwZV9uYW1lKGludDMyX3QgdHlwZSkgewogIGludDMyX3QgZmxhZyA9IGpzX3ZhbHVlX3R5cGUyZmxhZyh0eXBlKTsKICBjb25zdCBjaGFyKiBjb25zdCB0eXBlc1tdID0gewogICAgICAidW5kZWZpbmVkIiwgICAgICJudWxsIiwgICAgICAgICAiYm9vbCIsICAgICAgImludCIsICJvYmplY3QiLCAgICJzdHJpbmciLCAic3ltYm9sIiwgImJpZ19mbG9hdCIsCiAgICAgICJiaWdfaW50IiwgICAgICAgImJpZ19kZWNpbWFsIiwgICJmbG9hdDY0IiwgICAibmFuIiwgImZ1bmN0aW9uIiwgImFycmF5IiwgICJtb2R1bGUiLCAiZnVuY3Rpb25fYnl0ZWNvZGUiLAogICAgICAidW5pbml0aWFsaXplZCIsICJjYXRjaF9vZmZzZXQiLCAiZXhjZXB0aW9uIiwKICB9OwogIGlmKGZsYWcgPj0gMCAmJiBmbGFnIDwgY291bnRvZih0eXBlcykpCiAgICByZXR1cm4gdHlwZXNbZmxhZ107CiAgcmV0dXJuIDA7Cn0KCmNvbnN0IGNoYXIqCmpzX3ZhbHVlX3R5cGVzdHIoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB2YWx1ZSkgewogIGludDMyX3QgdHlwZSA9IGpzX3ZhbHVlX3R5cGUoY3R4LCB2YWx1ZSk7CiAgcmV0dXJuIGpzX3ZhbHVlX3R5cGVfbmFtZSh0eXBlKTsKfQoKQk9PTApqc192YWx1ZV9oYXNfcmVmX2NvdW50KEpTVmFsdWUgdikgewogIHJldHVybiAoKHVuc2lnbmVkKWpzX3ZhbHVlX3RhZyh2KSA+PSAodW5zaWduZWQpSlNfVEFHX0ZJUlNUKTsKfQoKZW51bSB2YWx1ZV9tYXNrCmpzX3ZhbHVlX3R5cGUoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB2YWx1ZSkgewogIGludDMyX3QgZmxhZzsKICB1aW50MzJfdCB0eXBlID0gMDsKICBpZigoZmxhZyA9IGpzX3ZhbHVlX3R5cGVfZ2V0KGN0eCwgdmFsdWUpKSA9PSAtMSkKICAgIHJldHVybiAwOwoKICBpZihmbGFnID09IEZMQUdfQVJSQVkgLyp8fCBmbGFnID09IEZMQUdfRlVOQ1RJT04qLykKICAgIHR5cGUgfD0gVFlQRV9PQkpFQ1Q7CgogIHR5cGUgfD0gMSA8PCBmbGFnOwoKICByZXR1cm4gdHlwZTsKfQoKaW50MzJfdApqc192YWx1ZV90eXBlX2dldChKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHZhbHVlKSB7CiAgaWYoSlNfSXNBcnJheShjdHgsIHZhbHVlKSkKICAgIHJldHVybiBGTEFHX0FSUkFZOwoKICBpZihKU19Jc0Z1bmN0aW9uKGN0eCwgdmFsdWUpICYmIEpTX0dldENsYXNzSUQodmFsdWUpIDw9IEpTX0NMQVNTX0FTWU5DX0dFTkVSQVRPUikKICAgIHJldHVybiBGTEFHX0ZVTkNUSU9OOwoKICBpZihKU19WQUxVRV9JU19OQU4odmFsdWUpKQogICAgcmV0dXJuIEZMQUdfTkFOOwoKICByZXR1cm4ganNfdmFsdWVfdHlwZV9mbGFnKHZhbHVlKTsKfQoKaW50MzJfdApqc192YWx1ZV90eXBlX2ZsYWcoSlNWYWx1ZUNvbnN0IHZhbHVlKSB7CiAgc3dpdGNoKEpTX1ZBTFVFX0dFVF9UQUcodmFsdWUpKSB7CiAgICBjYXNlIEpTX1RBR19CSUdfREVDSU1BTDogcmV0dXJuIEZMQUdfQklHX0RFQ0lNQUw7CiAgICBjYXNlIEpTX1RBR19CSUdfSU5UOiByZXR1cm4gRkxBR19CSUdfSU5UOwogICAgY2FzZSBKU19UQUdfQklHX0ZMT0FUOiByZXR1cm4gRkxBR19CSUdfRkxPQVQ7CiAgICBjYXNlIEpTX1RBR19TWU1CT0w6IHJldHVybiBGTEFHX1NZTUJPTDsKICAgIGNhc2UgSlNfVEFHX1NUUklORzogcmV0dXJuIEZMQUdfU1RSSU5HOwogICAgY2FzZSBKU19UQUdfTU9EVUxFOiByZXR1cm4gRkxBR19NT0RVTEU7CiAgICBjYXNlIEpTX1RBR19GVU5DVElPTl9CWVRFQ09ERTogcmV0dXJuIEZMQUdfRlVOQ1RJT05fQllURUNPREU7CiAgICBjYXNlIEpTX1RBR19PQkpFQ1Q6IHJldHVybiBGTEFHX09CSkVDVDsKICAgIGNhc2UgSlNfVEFHX0lOVDogcmV0dXJuIEZMQUdfSU5UOwogICAgY2FzZSBKU19UQUdfQk9PTDogcmV0dXJuIEZMQUdfQk9PTDsKICAgIGNhc2UgSlNfVEFHX05VTEw6IHJldHVybiBGTEFHX05VTEw7CiAgICBjYXNlIEpTX1RBR19VTkRFRklORUQ6IHJldHVybiBGTEFHX1VOREVGSU5FRDsKICAgIGNhc2UgSlNfVEFHX1VOSU5JVElBTElaRUQ6IHJldHVybiBGTEFHX1VOSU5JVElBTElaRUQ7CiAgICBjYXNlIEpTX1RBR19DQVRDSF9PRkZTRVQ6IHJldHVybiBGTEFHX0NBVENIX09GRlNFVDsKICAgIGNhc2UgSlNfVEFHX0VYQ0VQVElPTjogcmV0dXJuIEZMQUdfRVhDRVBUSU9OOwogICAgY2FzZSBKU19UQUdfRkxPQVQ2NDogcmV0dXJuIEZMQUdfRkxPQVQ2NDsKICB9CiAgcmV0dXJuIC0xOwp9Cgp2b2lkCmpzX3ZhbHVlX2ZyZWUoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWUgdikgewogIGlmKGpzX3ZhbHVlX2hhc19yZWZfY291bnQodikpIHsKICAgIEpTUmVmQ291bnRIZWFkZXIqIHAgPSAoSlNSZWZDb3VudEhlYWRlciopanNfdmFsdWVfcHRyKHYpOwogICAgaWYocC0+cmVmX2NvdW50ID4gMCkgewogICAgICAtLXAtPnJlZl9jb3VudDsKICAgICAgaWYocC0+cmVmX2NvdW50ID09IDApCiAgICAgICAgX19KU19GcmVlVmFsdWUoY3R4LCB2KTsKICAgIH0KICB9Cn0KCkpTVmFsdWUKanNfdmFsdWVfY2xvbmUoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB2YWx1ZSkgewogIGVudW0gdmFsdWVfbWFzayB0eXBlID0gMSA8PCBqc192YWx1ZV90eXBlX2dldChjdHgsIHZhbHVlKTsKICBKU1ZhbHVlIHJldCA9IEpTX1VOREVGSU5FRDsKICBzd2l0Y2godHlwZSkgewogICAgLypjYXNlIFRZUEVfU1RSSU5HOiB7CiAgICAgc2l6ZV90IGxlbjsKICAgICBjb25zdCBjaGFyKiBzdHI7CiAgICAgc3RyID0gSlNfVG9DU3RyaW5nTGVuKGN0eCwgJmxlbiwgdmFsdWUpOwogICAgIHJldCA9IEpTX05ld1N0cmluZ0xlbihjdHgsIHN0ciwgbGVuKTsKICAgICBqc19jc3RyaW5nX2ZyZWUoY3R4LCBzdHIpOwogICAgIGJyZWFrOwogICAgIH0qLwogICAgY2FzZSBUWVBFX0lOVDogewogICAgICByZXQgPSBKU19OZXdJbnQzMihjdHgsIEpTX1ZBTFVFX0dFVF9JTlQodmFsdWUpKTsKICAgICAgYnJlYWs7CiAgICB9CiAgICBjYXNlIFRZUEVfRkxPQVQ2NDogewogICAgICByZXQgPSBKU19OZXdGbG9hdDY0KGN0eCwgSlNfVkFMVUVfR0VUX0ZMT0FUNjQodmFsdWUpKTsKICAgICAgYnJlYWs7CiAgICB9CiAgICBjYXNlIFRZUEVfQk9PTDogewogICAgICByZXQgPSBKU19OZXdCb29sKGN0eCwgSlNfVkFMVUVfR0VUX0JPT0wodmFsdWUpKTsKICAgICAgYnJlYWs7CiAgICB9CiAgICBjYXNlIFRZUEVfRlVOQ1RJT046CiAgICBjYXNlIFRZUEVfQVJSQVk6CiAgICBjYXNlIFRZUEVfT0JKRUNUOiB7CiAgICAgIEpTUHJvcGVydHlFbnVtKiB0YWJfYXRvbTsKICAgICAgdWludDMyX3QgdGFiX2F0b21fbGVuOwogICAgICByZXQgPSBKU19Jc0FycmF5KGN0eCwgdmFsdWUpID8gSlNfTmV3QXJyYXkoY3R4KSA6IEpTX05ld09iamVjdChjdHgpOwogICAgICBpZighSlNfR2V0T3duUHJvcGVydHlOYW1lcyhjdHgsICZ0YWJfYXRvbSwgJnRhYl9hdG9tX2xlbiwgdmFsdWUsIEpTX0dQTl9TVFJJTkdfTUFTSyB8IEpTX0dQTl9TWU1CT0xfTUFTSyB8IEpTX0dQTl9FTlVNX09OTFkpKSB7CiAgICAgICAgdWludDMyX3QgaTsKICAgICAgICBmb3IoaSA9IDA7IGkgPCB0YWJfYXRvbV9sZW47IGkrKykgewogICAgICAgICAgSlNWYWx1ZSBwcm9wOwogICAgICAgICAgcHJvcCA9IEpTX0dldFByb3BlcnR5KGN0eCwgdmFsdWUsIHRhYl9hdG9tW2ldLmF0b20pOwogICAgICAgICAgSlNfU2V0UHJvcGVydHkoY3R4LCByZXQsIHRhYl9hdG9tW2ldLmF0b20sIGpzX3ZhbHVlX2Nsb25lKGN0eCwgcHJvcCkpOwogICAgICAgIH0KICAgICAgfQogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgVFlQRV9VTkRFRklORUQ6CiAgICBjYXNlIFRZUEVfTlVMTDoKICAgIGNhc2UgVFlQRV9TVFJJTkc6CiAgICBjYXNlIFRZUEVfU1lNQk9MOgogICAgY2FzZSBUWVBFX0JJR19ERUNJTUFMOgogICAgY2FzZSBUWVBFX0JJR19JTlQ6CiAgICBjYXNlIFRZUEVfQklHX0ZMT0FUOiB7CiAgICAgIHJldCA9IEpTX0R1cFZhbHVlKGN0eCwgdmFsdWUpOwogICAgICBicmVhazsKICAgIH0KICAgIGRlZmF1bHQ6IHsKICAgICAgcmV0ID0gSlNfVGhyb3dUeXBlRXJyb3IoY3R4LCAiTm8gc3VjaCB0eXBlOiAlcyAoMHglMDh4KVxuIiwganNfdmFsdWVfdHlwZV9uYW1lKHR5cGUpLCB0eXBlKTsKICAgICAgYnJlYWs7CiAgICB9CiAgfQogIHJldHVybiByZXQ7Cn0KCnZvaWQKanNfdmFsdWVfZndyaXRlKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsLCBGSUxFKiBmKSB7CiAgRHluQnVmIGRidWYgPSB7MH07CiAgc2l6ZV90IG47CiAgZGJ1Zl9pbml0MigmZGJ1ZiwgY3R4LCAocmVhbGxvY19mdW5jKikmdXRpbHNfanNfcmVhbGxvYyk7CiAganNfdmFsdWVfZHVtcChjdHgsIHZhbCwgJmRidWYpOwogIGRidWZfcHV0YygmZGJ1ZiwgJ1xuJyk7CiAgbiA9IGRidWYuc2l6ZTsKICBkYnVmXzAoJmRidWYpOwogIGZ3cml0ZShkYnVmLmJ1ZiwgMSwgbiwgZik7CiAgZmZsdXNoKGYpOwogIGRidWZfZnJlZSgmZGJ1Zik7Cn0KCnZvaWQKanNfdmFsdWVfZHVtcChKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHZhbHVlLCBEeW5CdWYqIGRiKSB7CiAgY29uc3QgY2hhciogc3RyOwogIHNpemVfdCBsZW47CiAgZGJ1Zl9wdXRzdHIoZGIsIGpzX3ZhbHVlX3R5cGVzdHIoY3R4LCB2YWx1ZSkpOwogIGRidWZfcHV0c3RyKGRiLCAiICIpOwogIGlmKEpTX0lzRXhjZXB0aW9uKHZhbHVlKSkgewogICAgZGJ1Zl9wdXRzdHIoZGIsICJbZXhjZXB0aW9uXSIpOwogIH0gZWxzZSBpZihKU19Jc01vZHVsZSh2YWx1ZSkpIHsKICAgIGRidWZfcHV0c3RyKGRiLCAiW21vZHVsZV0iKTsKICB9IGVsc2UgaWYoSlNfSXNGdW5jdGlvbihjdHgsIHZhbHVlKSkgewogICAgSlNWYWx1ZSBzcmMgPSBqc19pbnZva2UoY3R4LCB2YWx1ZSwgInRvU291cmNlIiwgMCwgMCk7CiAgICBqc192YWx1ZV9kdW1wKGN0eCwgc3JjLCBkYik7CiAgICBKU19GcmVlVmFsdWUoY3R4LCBzcmMpOwogIH0gZWxzZSBpZihKU19Jc09iamVjdCh2YWx1ZSkpIHsKICAgIGNvbnN0IGNoYXIqIHN0ciA9IGpzX29iamVjdF90b3N0cmluZyhjdHgsIHZhbHVlKTsKICAgIGRidWZfcHV0c3RyKGRiLCBzdHIpOwogICAganNfY3N0cmluZ19mcmVlKGN0eCwgc3RyKTsKICAgIGlmKGRiLT5zaXplICYmIGRiLT5idWZbZGItPnNpemUgLSAxXSA9PSAnXG4nKQogICAgICBkYi0+c2l6ZS0tOwogIH0gZWxzZSB7CiAgICBpbnQgaXNfc3RyaW5nID0gSlNfSXNTdHJpbmcodmFsdWUpOwoKICAgIGlmKGlzX3N0cmluZykKICAgICAgZGJ1Zl9wdXRjKGRiLCAnIicpOwoKICAgIHN0ciA9IEpTX1RvQ1N0cmluZ0xlbihjdHgsICZsZW4sIHZhbHVlKTsKICAgIGRidWZfYXBwZW5kKGRiLCAoY29uc3QgdWludDhfdCopc3RyLCBsZW4pOwoKICAgIGpzX2NzdHJpbmdfZnJlZShjdHgsIHN0cik7CgogICAgaWYoaXNfc3RyaW5nKQogICAgICBkYnVmX3B1dGMoZGIsICciJyk7CiAgICBlbHNlIGlmKEpTX0lzQmlnRmxvYXQodmFsdWUpKQogICAgICBkYnVmX3B1dGMoZGIsICdsJyk7CiAgICBlbHNlIGlmKEpTX0lzQmlnRGVjaW1hbCh2YWx1ZSkpCiAgICAgIGRidWZfcHV0YyhkYiwgJ20nKTsKICAgIGVsc2UgaWYoSlNfSXNCaWdJbnQoY3R4LCB2YWx1ZSkpCiAgICAgIGRidWZfcHV0YyhkYiwgJ24nKTsKICB9Cn0KCkJPT0wKanNfdmFsdWVfZXF1YWxzKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgYSwgSlNWYWx1ZUNvbnN0IGIpIHsKICBpbnQzMl90IHRhLCB0YjsKICBCT09MIHJldCA9IEZBTFNFOwogIHRhID0ganNfdmFsdWVfdHlwZShjdHgsIGEpOwogIHRiID0ganNfdmFsdWVfdHlwZShjdHgsIGIpOwoKICBpZih0YSAhPSB0YikgewogICAgcmV0ID0gRkFMU0U7CiAgfSBlbHNlIGlmKHRhICYgdGIgJiAoVFlQRV9OVUxMIHwgVFlQRV9VTkRFRklORUQgfCBUWVBFX05BTikpIHsKICAgIHJldCA9IFRSVUU7CiAgfSBlbHNlIGlmKHRhICYgdGIgJiAoVFlQRV9CSUdfSU5UIHwgVFlQRV9CSUdfRkxPQVQgfCBUWVBFX0JJR19ERUNJTUFMKSkgewogICAgY29uc3QgY2hhciAqYXN0ciwgKmJzdHI7CgogICAgYXN0ciA9IEpTX1RvQ1N0cmluZyhjdHgsIGEpOwogICAgYnN0ciA9IEpTX1RvQ1N0cmluZyhjdHgsIGIpOwoKICAgIHJldCA9ICFzdHJjbXAoYXN0ciwgYnN0cik7CgogICAgSlNfRnJlZUNTdHJpbmcoY3R4LCBhc3RyKTsKICAgIEpTX0ZyZWVDU3RyaW5nKGN0eCwgYnN0cik7CgogIH0gZWxzZSBpZih0YSAmIFRZUEVfSU5UKSB7CiAgICBpbnQzMl90IGludGEsIGludGI7CgogICAgaW50YSA9IEpTX1ZBTFVFX0dFVF9JTlQoYSk7CiAgICBpbnRiID0gSlNfVkFMVUVfR0VUX0lOVChiKTsKICAgIHJldCA9IGludGEgPT0gaW50YjsKICB9IGVsc2UgaWYodGEgJiBUWVBFX0JPT0wpIHsKICAgIEJPT0wgYm9vbGEsIGJvb2xiOwoKICAgIGJvb2xhID0gISFKU19WQUxVRV9HRVRfQk9PTChhKTsKICAgIGJvb2xiID0gISFKU19WQUxVRV9HRVRfQk9PTChiKTsKICAgIHJldCA9IGJvb2xhID09IGJvb2xiOwoKICB9IGVsc2UgaWYodGEgJiBUWVBFX0ZMT0FUNjQpIHsKICAgIGRvdWJsZSBmbHRhLCBmbHRiOwoKICAgIGZsdGEgPSBKU19WQUxVRV9HRVRfRkxPQVQ2NChhKTsKICAgIGZsdGIgPSBKU19WQUxVRV9HRVRfRkxPQVQ2NChiKTsKICAgIHJldCA9IGZsdGEgPT0gZmx0YjsKCiAgfSBlbHNlIGlmKHRhICYgVFlQRV9PQkpFQ1QpIHsKICAgIHJldCA9IGpzX29iamVjdF9zYW1lKGEsIGIpID8gVFJVRSA6IGpzX29iamVjdF9lcXVhbHMoY3R4LCBhLCBiKTsKCiAgfSBlbHNlIGlmKHRhICYgVFlQRV9TVFJJTkcpIHsKICAgIGNvbnN0IGNoYXIgKnN0cmEsICpzdHJiOwoKICAgIHN0cmEgPSBKU19Ub0NTdHJpbmcoY3R4LCBhKTsKICAgIHN0cmIgPSBKU19Ub0NTdHJpbmcoY3R4LCBiKTsKCiAgICByZXQgPSAhc3RyY21wKHN0cmEsIHN0cmIpOwoKICAgIGpzX2NzdHJpbmdfZnJlZShjdHgsIHN0cmEpOwogICAganNfY3N0cmluZ19mcmVlKGN0eCwgc3RyYik7CiAgfQoKICByZXR1cm4gcmV0Owp9CgpKU1ZhbHVlCmpzX3ZhbHVlX2Zyb21fY2hhcihKU0NvbnRleHQqIGN0eCwgaW50IGMpIHsKICB1aW50OF90IGJ1ZlsxNl07CiAgc2l6ZV90IGxlbiA9IHVuaWNvZGVfdG9fdXRmOChidWYsIGMpOwogIHJldHVybiBKU19OZXdTdHJpbmdMZW4oY3R4LCAoY29uc3QgY2hhciopYnVmLCBsZW4pOwp9Cgp2b2lkCmpzX3ZhbHVlX3ByaW50KEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsdWUpIHsKICBEeW5CdWYgZGJ1ZjsKICBkYnVmX2luaXQyKCZkYnVmLCBjdHgsIChyZWFsbG9jX2Z1bmMqKSZ1dGlsc19qc19yZWFsbG9jKTsKICBqc192YWx1ZV9kdW1wKGN0eCwgdmFsdWUsICZkYnVmKTsKICBkYnVmXzAoJmRidWYpOwogIGZwdXRzKChjb25zdCBjaGFyKilkYnVmLmJ1Ziwgc3Rkb3V0KTsKICBkYnVmX2ZyZWUoJmRidWYpOwp9CgppbnQKanNfdmFsdWVfdG9zaXplKEpTQ29udGV4dCogY3R4LCBzaXplX3QqIHN6LCBKU1ZhbHVlQ29uc3QgdmFsdWUpIHsKICB1aW50NjRfdCB1NjQgPSAwOwogIGludCByOwogIHIgPSBKU19Ub0luZGV4KGN0eCwgJnU2NCwgdmFsdWUpOwogICpzeiA9IHU2NDsKICByZXR1cm4gcjsKfQoKdm9pZApqc192YWx1ZV9mcmVlX3J0KEpTUnVudGltZSogcnQsIEpTVmFsdWUgdikgewogIGlmKGpzX3ZhbHVlX2hhc19yZWZfY291bnQodikpIHsKICAgIEpTUmVmQ291bnRIZWFkZXIqIHAgPSAoSlNSZWZDb3VudEhlYWRlciopanNfdmFsdWVfcHRyKHYpOwogICAgLS1wLT5yZWZfY291bnQ7CiAgICBpZihwLT5yZWZfY291bnQgPT0gMCkKICAgICAgX19KU19GcmVlVmFsdWVSVChydCwgdik7CiAgfQp9CgpKU1ZhbHVlCmpzX3ZhbHVlX2NvZXJjZShKU0NvbnRleHQqIGN0eCwgY29uc3QgY2hhciogZnVuY19uYW1lLCBKU1ZhbHVlQ29uc3QgYXJnKSB7CiAgcmV0dXJuIGpzX2dsb2JhbF9jYWxsKGN0eCwgZnVuY19uYW1lLCAxLCAmYXJnKTsKfQoKY2hhcioKanNfY3N0cmluZ19wdHIoSlNWYWx1ZUNvbnN0IHYpIHsKICBKU1N0cmluZyogcDsKCiAgaWYoSlNfSXNTdHJpbmcodikpIHsKICAgIHAgPSBKU19WQUxVRV9HRVRfUFRSKHYpOwogICAgcmV0dXJuIChjaGFyKilwLT51LnN0cjg7CiAgfQogIHJldHVybiAwOwp9CgpzaXplX3QKanNfY3N0cmluZ19sZW4oSlNWYWx1ZUNvbnN0IHYpIHsKICBKU1N0cmluZyogcDsKCiAgaWYoSlNfSXNTdHJpbmcodikpIHsKICAgIHAgPSBKU19WQUxVRV9HRVRfUFRSKHYpOwogICAgcmV0dXJuIHAtPmxlbjsKICB9CiAgcmV0dXJuIDA7Cn0KCmNoYXIqCmpzX2NzdHJpbmdfZHVwKEpTQ29udGV4dCogY3R4LCBjb25zdCBjaGFyKiBzdHIpIHsKICBKU1N0cmluZyogcDsKICBpZighc3RyKQogICAgcmV0dXJuIDA7CiAgLyogcHVycG9zZWx5IHJlbW92aW5nIGNvbnN0bmVzcyAqLwogIHAgPSAoSlNTdHJpbmcqKSh2b2lkKikoc3RyIC0gb2Zmc2V0b2YoSlNTdHJpbmcsIHUpKTsKICBKU19EdXBWYWx1ZShjdHgsIEpTX01LUFRSKEpTX1RBR19TVFJJTkcsIHApKTsKICByZXR1cm4gKGNoYXIqKXN0cjsKfQoKSlNWYWx1ZUNvbnN0CmpzX2NzdHJpbmdfdmFsdWUoY29uc3QgY2hhciogcHRyKSB7CiAgSlNTdHJpbmcqIHA7CiAgaWYoIXB0cikKICAgIHJldHVybiBKU19VTkRFRklORUQ7CgogIHAgPSAoSlNTdHJpbmcqKSh2b2lkKikocHRyIC0gb2Zmc2V0b2YoSlNTdHJpbmcsIHUpKTsKICByZXR1cm4gSlNfTUtQVFIoSlNfVEFHX1NUUklORywgcCk7Cn0KCnZvaWQKanNfY3N0cmluZ19kdW1wKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsdWUsIER5bkJ1ZiogZGIpIHsKICBjb25zdCBjaGFyKiBzdHI7CiAgc2l6ZV90IGxlbjsKCiAgc3RyID0gSlNfVG9DU3RyaW5nTGVuKGN0eCwgJmxlbiwgdmFsdWUpOwogIGRidWZfYXBwZW5kKGRiLCAoY29uc3QgdWludDhfdCopc3RyLCBsZW4pOwoKICBqc19jc3RyaW5nX2ZyZWUoY3R4LCBzdHIpOwp9CgpKU1ZhbHVlCmpzX21hcF9uZXcoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBlbnRyaWVzKSB7CiAgcmV0dXJuIGpzX29iamVjdF9uZXcoY3R4LCAiTWFwIiwgMSwgJmVudHJpZXMpOwp9CgpKU1ZhbHVlCm1vZHVsZV9uYW1lKEpTQ29udGV4dCogY3R4LCBKU01vZHVsZURlZiogbSkgewogIGlmKG0tPm1vZHVsZV9uYW1lIDwgY3R4LT5ydC0+YXRvbV9jb3VudCkKICAgIHJldHVybiBKU19BdG9tVG9WYWx1ZShjdHgsIG0tPm1vZHVsZV9uYW1lKTsKCiAgcmV0dXJuIEpTX1VOREVGSU5FRDsKfQoKY29uc3QgY2hhcioKbW9kdWxlX25hbWVjc3RyKEpTQ29udGV4dCogY3R4LCBKU01vZHVsZURlZiogbSkgewogIHJldHVybiBKU19BdG9tVG9DU3RyaW5nKGN0eCwgbS0+bW9kdWxlX25hbWUpOwp9CgpjaGFyKgptb2R1bGVfbmFtZXN0cihKU0NvbnRleHQqIGN0eCwgSlNNb2R1bGVEZWYqIG0pIHsKICBjb25zdCBjaGFyKiBuYW1lID0gbW9kdWxlX25hbWVjc3RyKGN0eCwgbSk7CiAgY2hhciogc3RyID0ganNfc3RyZHVwKGN0eCwgbmFtZSk7CiAgSlNfRnJlZUNTdHJpbmcoY3R4LCBuYW1lKTsKICByZXR1cm4gc3RyOwp9CgpzdGF0aWMgSlNWYWx1ZQpjYWxsX21vZHVsZV9mdW5jKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QqIGFyZ3YsIGludCBtYWdpYywgSlNWYWx1ZSogZGF0YSkgewogIHVuaW9uIHsKICAgIEpTTW9kdWxlSW5pdEZ1bmMqIGluaXRfZnVuYzsKICAgIGludDMyX3QgaVsyXTsKICB9IHU7CgogIHUuaVswXSA9IEpTX1ZBTFVFX0dFVF9JTlQoZGF0YVswXSk7CiAgdS5pWzFdID0gSlNfVkFMVUVfR0VUX0lOVChkYXRhWzFdKTsKCiAgaWYoYXJnYyA+PSAxICYmIEpTX0lzTW9kdWxlKGFyZ3ZbMF0pKQogICAgcmV0dXJuIEpTX05ld0ludDMyKGN0eCwgdS5pbml0X2Z1bmMoY3R4LCBKU19WQUxVRV9HRVRfUFRSKGFyZ3ZbMF0pKSk7CgogIHJldHVybiBKU19UaHJvd1R5cGVFcnJvcihjdHgsICJhcmd1bWVudCAxIG1vZHVsZSBleHBlY3RlZCIpOwp9CgpKU1ZhbHVlCm1vZHVsZV9mdW5jKEpTQ29udGV4dCogY3R4LCBKU01vZHVsZURlZiogbSkgewogIEpTVmFsdWUgZnVuYyA9IEpTX1VOREVGSU5FRDsKICBpZihKU19Jc0Z1bmN0aW9uKGN0eCwgbS0+ZnVuY19vYmopKSB7CiAgICBmdW5jID0gSlNfRHVwVmFsdWUoY3R4LCBtLT5mdW5jX29iaik7CiAgfSBlbHNlIGlmKG0tPmluaXRfZnVuYykgewogICAgdW5pb24gewogICAgICBKU01vZHVsZUluaXRGdW5jKiBpbml0X2Z1bmM7CiAgICAgIGludDMyX3QgaVsyXTsKICAgIH0gdSA9IHttLT5pbml0X2Z1bmN9OwogICAgSlNWYWx1ZUNvbnN0IGRhdGFbMl0gPSB7CiAgICAgICAgSlNfTUtWQUwoSlNfVEFHX0lOVCwgdS5pWzBdKSwKICAgICAgICBKU19NS1ZBTChKU19UQUdfSU5ULCB1LmlbMV0pLAogICAgfTsKICAgIGZ1bmMgPSBKU19OZXdDRnVuY3Rpb25EYXRhKGN0eCwgY2FsbF9tb2R1bGVfZnVuYywgMSwgMCwgMiwgZGF0YSk7CiAgfQogIHJldHVybiBmdW5jOwp9CgpKU1ZhbHVlCm1vZHVsZV9ucyhKU0NvbnRleHQqIGN0eCwgSlNNb2R1bGVEZWYqIG0pIHsKICByZXR1cm4gSlNfRHVwVmFsdWUoY3R4LCBtLT5tb2R1bGVfbnMpOwp9CgpKU1ZhbHVlCm1vZHVsZV9leHBvcnRzX2ZpbmQoSlNDb250ZXh0KiBjdHgsIEpTTW9kdWxlRGVmKiBtLCBKU0F0b20gYXRvbSkgewogIHNpemVfdCBpOwogIGZvcihpID0gMDsgaSA8IG0tPmV4cG9ydF9lbnRyaWVzX2NvdW50OyBpKyspIHsKICAgIEpTRXhwb3J0RW50cnkqIGVudHJ5ID0gJm0tPmV4cG9ydF9lbnRyaWVzW2ldOwoKICAgIGlmKGVudHJ5LT5leHBvcnRfbmFtZSA9PSBhdG9tKSB7CiAgICAgIEpTVmFyUmVmKiByZWYgPSBlbnRyeS0+dS5sb2NhbC52YXJfcmVmOwogICAgICBKU1ZhbHVlIGV4cG9ydCA9IHJlZiA/IEpTX0R1cFZhbHVlKGN0eCwgcmVmLT5wdmFsdWUgPyAqcmVmLT5wdmFsdWUgOiByZWYtPnZhbHVlKSA6IEpTX1VOREVGSU5FRDsKICAgICAgcmV0dXJuIGV4cG9ydDsKICAgIH0KICB9CiAgcmV0dXJuIEpTX1VOREVGSU5FRDsKfQoKdm9pZAptb2R1bGVfZXhwb3J0c19nZXQoSlNDb250ZXh0KiBjdHgsIEpTTW9kdWxlRGVmKiBtLCBCT09MIHJlbmFtZV9kZWZhdWx0LCBKU1ZhbHVlQ29uc3QgZXhwb3J0cykgewogIEpTQXRvbSBkZWYgPSBKU19OZXdBdG9tKGN0eCwgImRlZmF1bHQiKTsKCiAgc2l6ZV90IGk7CiAgZm9yKGkgPSAwOyBpIDwgbS0+ZXhwb3J0X2VudHJpZXNfY291bnQ7IGkrKykgewogICAgSlNFeHBvcnRFbnRyeSogZW50cnkgPSAmbS0+ZXhwb3J0X2VudHJpZXNbaV07CiAgICBKU1ZhclJlZiogcmVmID0gZW50cnktPnUubG9jYWwudmFyX3JlZjsKICAgIEpTVmFsdWUgdmFsID0gSlNfVU5ERUZJTkVEOwogICAgSlNBdG9tIG5hbWUgPSBlbnRyeS0+ZXhwb3J0X25hbWU7CgogICAgaWYocmVmKSB7CiAgICAgIHZhbCA9IEpTX0R1cFZhbHVlKGN0eCwgcmVmLT5wdmFsdWUgPyAqcmVmLT5wdmFsdWUgOiByZWYtPnZhbHVlKTsKICAgICAgaWYocmVuYW1lX2RlZmF1bHQgJiYgbmFtZSA9PSBkZWYpCiAgICAgICAgbmFtZSA9IG0tPm1vZHVsZV9uYW1lOwogICAgfQogICAgSlNfU2V0UHJvcGVydHkoY3R4LCBleHBvcnRzLCBuYW1lLCB2YWwpOwogIH0KICBKU19GcmVlQXRvbShjdHgsIGRlZik7Cn0KCkpTVmFsdWUKbW9kdWxlX2ltcG9ydHMoSlNDb250ZXh0KiBjdHgsIEpTTW9kdWxlRGVmKiBtKSB7CiAgSlNWYWx1ZSBvYmogPSBKU19OZXdBcnJheShjdHgpOwogIHVpbnQzMl90IGk7CiAgSlNPYmplY3QqIHAgPSBqc192YWx1ZV9vYmoobS0+ZnVuY19vYmopOwogIEpTVmFyUmVmKiogdmFyX3JlZnMgPSBwID8gcC0+dS5mdW5jLnZhcl9yZWZzIDogMDsKCiAgZm9yKGkgPSAwOyBpIDwgbS0+aW1wb3J0X2VudHJpZXNfY291bnQ7IGkrKykgewogICAgSlNJbXBvcnRFbnRyeSogZW50cnkgPSAmbS0+aW1wb3J0X2VudHJpZXNbaV07CiAgICBKU1JlcU1vZHVsZUVudHJ5KiByZXFfbW9kdWxlID0gJm0tPnJlcV9tb2R1bGVfZW50cmllc1tlbnRyeS0+cmVxX21vZHVsZV9pZHhdOwogICAgSlNWYWx1ZSB2YWwgPSBKU19VTkRFRklORUQ7CiAgICBKU0F0b20gbmFtZSA9IGVudHJ5LT5pbXBvcnRfbmFtZTsKICAgIEpTQXRvbSBtb2R1bGVfbmFtZSA9IHJlcV9tb2R1bGUtPm1vZHVsZV9uYW1lOwoKICAgIEpTVmFsdWUgaW1wb3J0X3ZhbHVlID0gSlNfTmV3QXJyYXkoY3R4KTsKCiAgICBKU19TZXRQcm9wZXJ0eVVpbnQzMihjdHgsIGltcG9ydF92YWx1ZSwgMCwgSlNfQXRvbVRvVmFsdWUoY3R4LCBuYW1lKSk7CiAgICBKU19TZXRQcm9wZXJ0eVVpbnQzMihjdHgsIGltcG9ydF92YWx1ZSwgMSwgSlNfQXRvbVRvVmFsdWUoY3R4LCBtb2R1bGVfbmFtZSkpOwogICAgSlNfU2V0UHJvcGVydHlVaW50MzIoY3R4LCBvYmosIGksIGltcG9ydF92YWx1ZSk7CiAgfQogIHJldHVybiBvYmo7Cn0KCkpTVmFsdWUKbW9kdWxlX2RlZmF1bHRfZXhwb3J0KEpTQ29udGV4dCogY3R4LCBKU01vZHVsZURlZiogbSkgewogIEpTQXRvbSBkZWYgPSBKU19OZXdBdG9tKGN0eCwgImRlZmF1bHQiKTsKICBKU1ZhbHVlIHJldCA9IEpTX1VOREVGSU5FRDsKICBzaXplX3QgaTsKCiAgZm9yKGkgPSAwOyBpIDwgbS0+ZXhwb3J0X2VudHJpZXNfY291bnQ7IGkrKykgewogICAgSlNFeHBvcnRFbnRyeSogZW50cnkgPSAmbS0+ZXhwb3J0X2VudHJpZXNbaV07CiAgICBKU1ZhclJlZiogcmVmID0gZW50cnktPnUubG9jYWwudmFyX3JlZjsKICAgIEpTQXRvbSBuYW1lID0gZW50cnktPmV4cG9ydF9uYW1lOwoKICAgIGlmKHJlZikgewogICAgICBpZihuYW1lID09IGRlZikgewogICAgICAgIHJldCA9IEpTX0R1cFZhbHVlKGN0eCwgcmVmLT5wdmFsdWUgPyAqcmVmLT5wdmFsdWUgOiByZWYtPnZhbHVlKTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogIH0KICBKU19GcmVlQXRvbShjdHgsIGRlZik7CiAgcmV0dXJuIHJldDsKfQoKSlNWYWx1ZQptb2R1bGVfZXhwb3J0cyhKU0NvbnRleHQqIGN0eCwgSlNNb2R1bGVEZWYqIG0pIHsKICBKU1ZhbHVlIGV4cG9ydHM7CiAgZXhwb3J0cyA9IEpTX05ld09iamVjdCAvKlByb3RvKi8gKGN0eCAvKiwgSlNfTlVMTCovKTsKICBtb2R1bGVfZXhwb3J0c19nZXQoY3R4LCBtLCBGQUxTRSwgZXhwb3J0cyk7CiAgcmV0dXJuIGV4cG9ydHM7Cn0KCnN0cnVjdCBsaXN0X2hlYWQqCmpzX21vZHVsZXNfbGlzdChKU0NvbnRleHQqIGN0eCkgewogIHJldHVybiAmY3R4LT5sb2FkZWRfbW9kdWxlczsKfQoKSlNWYWx1ZQpqc19tb2R1bGVzX2FycmF5KEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBtYWdpYykgewogIHN0cnVjdCBsaXN0X2hlYWQqIGVsOwogIEpTVmFsdWUgcmV0ID0gSlNfTmV3QXJyYXkoY3R4KTsKICB1aW50MzJfdCBpID0gMDsKICBsaXN0X2Zvcl9lYWNoKGVsLCAmY3R4LT5sb2FkZWRfbW9kdWxlcykgewogICAgSlNNb2R1bGVEZWYqIG0gPSBsaXN0X2VudHJ5KGVsLCBKU01vZHVsZURlZiwgbGluayk7CiAgICBjaGFyKiBzdHIgPSBtb2R1bGVfbmFtZXN0cihjdHgsIG0pOwogICAgSlNWYWx1ZSBlbnRyeSA9IG1hZ2ljID8gbW9kdWxlX2VudHJ5KGN0eCwgbSkgOiBtb2R1bGVfdmFsdWUoY3R4LCBtKTsKICAgIGlmKDEgLypzdHJbMF0gIT0gJzwnKi8pCiAgICAgIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgcmV0LCBpKyssIGVudHJ5KTsKICAgIGVsc2UKICAgICAgSlNfRnJlZVZhbHVlKGN0eCwgZW50cnkpOwogICAganNfZnJlZShjdHgsIHN0cik7CiAgfQogIHJldHVybiByZXQ7Cn0KCkpTVmFsdWUKanNfbW9kdWxlc19lbnRyaWVzKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBtYWdpYykgewogIHN0cnVjdCBsaXN0X2hlYWQqIGVsOwogIEpTVmFsdWUgcmV0ID0gSlNfTmV3QXJyYXkoY3R4KTsKICB1aW50MzJfdCBpID0gMDsKICBsaXN0X2Zvcl9lYWNoKGVsLCAmY3R4LT5sb2FkZWRfbW9kdWxlcykgewogICAgSlNNb2R1bGVEZWYqIG0gPSBsaXN0X2VudHJ5KGVsLCBKU01vZHVsZURlZiwgbGluayk7CiAgICAvLyAgY2hhciogbmFtZSA9IG1vZHVsZV9uYW1lc3RyKGN0eCwgbSk7CiAgICBKU1ZhbHVlIGVudHJ5ID0gSlNfTmV3QXJyYXkoY3R4KTsKICAgIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgZW50cnksIDAsIEpTX0F0b21Ub1ZhbHVlKGN0eCwgbS0+bW9kdWxlX25hbWUpKTsKICAgIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgZW50cnksIDEsIG1hZ2ljID8gbW9kdWxlX2VudHJ5KGN0eCwgbSkgOiBtb2R1bGVfdmFsdWUoY3R4LCBtKSk7CiAgICBpZigxIC8qc3RyWzBdICE9ICc8JyovKQogICAgICBKU19TZXRQcm9wZXJ0eVVpbnQzMihjdHgsIHJldCwgaSsrLCBlbnRyeSk7CiAgICBlbHNlCiAgICAgIEpTX0ZyZWVWYWx1ZShjdHgsIGVudHJ5KTsKICAgIC8vICBqc19mcmVlKGN0eCwgbmFtZSk7CiAgfQogIHJldHVybiByZXQ7Cn0KCkpTVmFsdWUKanNfbW9kdWxlc19tYXAoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB0aGlzX3ZhbCwgaW50IG1hZ2ljKSB7CiAgSlNWYWx1ZSBtYXAsIGVudHJpZXMgPSBqc19tb2R1bGVzX2VudHJpZXMoY3R4LCB0aGlzX3ZhbCwgbWFnaWMpOwogIG1hcCA9IGpzX21hcF9uZXcoY3R4LCBlbnRyaWVzKTsKICBKU19GcmVlVmFsdWUoY3R4LCBlbnRyaWVzKTsKICByZXR1cm4gbWFwOwp9CgpKU1ZhbHVlCmpzX21vZHVsZXNfb2JqZWN0KEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBtYWdpYykgewogIHN0cnVjdCBsaXN0X2hlYWQqIGl0OwogIEpTVmFsdWUgb2JqID0gSlNfTmV3T2JqZWN0KGN0eCk7CiAgbGlzdF9mb3JfZWFjaChpdCwgJmN0eC0+bG9hZGVkX21vZHVsZXMpIHsKICAgIEpTTW9kdWxlRGVmKiBtID0gbGlzdF9lbnRyeShpdCwgSlNNb2R1bGVEZWYsIGxpbmspOwogICAgY2hhciogbmFtZSA9IG1vZHVsZV9uYW1lc3RyKGN0eCwgbSk7CiAgICBKU1ZhbHVlIGVudHJ5ID0gbWFnaWMgPyBtb2R1bGVfZW50cnkoY3R4LCBtKSA6IG1vZHVsZV92YWx1ZShjdHgsIG0pOwogICAgaWYoMSAvKnN0clswXSAhPSAnPCcqLykKICAgICAgSlNfU2V0UHJvcGVydHlTdHIoY3R4LCBvYmosIGJhc2VuYW1lKG5hbWUpLCBlbnRyeSk7CiAgICBlbHNlCiAgICAgIEpTX0ZyZWVWYWx1ZShjdHgsIGVudHJ5KTsKICAgIGpzX2ZyZWUoY3R4LCBuYW1lKTsKICB9CiAgcmV0dXJuIG9iajsKfQoKSlNWYWx1ZQptb2R1bGVfdmFsdWUoSlNDb250ZXh0KiBjdHgsIEpTTW9kdWxlRGVmKiBtKSB7CiAgcmV0dXJuIEpTX0R1cFZhbHVlKGN0eCwgSlNfTUtQVFIoSlNfVEFHX01PRFVMRSwgbSkpOwp9CgpKU1ZhbHVlCm1vZHVsZV9lbnRyeShKU0NvbnRleHQqIGN0eCwgSlNNb2R1bGVEZWYqIG0pIHsKICBKU1ZhbHVlIGVudHJ5ID0gSlNfTmV3QXJyYXkoY3R4KTsKICBKU19TZXRQcm9wZXJ0eVVpbnQzMihjdHgsIGVudHJ5LCAwLCBtb2R1bGVfbnMoY3R4LCBtKSk7CiAgSlNfU2V0UHJvcGVydHlVaW50MzIoY3R4LCBlbnRyeSwgMSwgbW9kdWxlX2V4cG9ydHMoY3R4LCBtKSk7CiAgSlNfU2V0UHJvcGVydHlVaW50MzIoY3R4LCBlbnRyeSwgMiwgbW9kdWxlX2Z1bmMoY3R4LCBtKSk7CiAgcmV0dXJuIGVudHJ5Owp9CgpKU1ZhbHVlCm1vZHVsZV9vYmplY3QoSlNDb250ZXh0KiBjdHgsIEpTTW9kdWxlRGVmKiBtKSB7CiAgSlNWYWx1ZSBucywgZXhwb3J0cywgZnVuYywgb2JqID0gSlNfTmV3T2JqZWN0KGN0eCk7CiAgSlNfU2V0UHJvcGVydHlTdHIoY3R4LCBvYmosICJuYW1lIiwgbW9kdWxlX25hbWUoY3R4LCBtKSk7CiAgSlNfU2V0UHJvcGVydHlTdHIoY3R4LCBvYmosICJyZXNvbHZlZCIsIEpTX05ld0Jvb2woY3R4LCBtLT5yZXNvbHZlZCkpOwogIEpTX1NldFByb3BlcnR5U3RyKGN0eCwgb2JqLCAiZnVuY19jcmVhdGVkIiwgSlNfTmV3Qm9vbChjdHgsIG0tPmZ1bmNfY3JlYXRlZCkpOwogIEpTX1NldFByb3BlcnR5U3RyKGN0eCwgb2JqLCAiaW5zdGFudGlhdGVkIiwgSlNfTmV3Qm9vbChjdHgsIG0tPmluc3RhbnRpYXRlZCkpOwogIEpTX1NldFByb3BlcnR5U3RyKGN0eCwgb2JqLCAiZXZhbHVhdGVkIiwgSlNfTmV3Qm9vbChjdHgsIG0tPmV2YWx1YXRlZCkpOwoKICBucyA9IG1vZHVsZV9ucyhjdHgsIG0pOwogIGlmKCFKU19Jc1VuZGVmaW5lZChucykpCiAgICBKU19TZXRQcm9wZXJ0eVN0cihjdHgsIG9iaiwgIm5zIiwgbnMpOwogIGV4cG9ydHMgPSBtb2R1bGVfZXhwb3J0cyhjdHgsIG0pOwogIGlmKCFKU19Jc1VuZGVmaW5lZChleHBvcnRzKSkKICAgIEpTX1NldFByb3BlcnR5U3RyKGN0eCwgb2JqLCAiZXhwb3J0cyIsIG1vZHVsZV9leHBvcnRzKGN0eCwgbSkpOwogIGZ1bmMgPSBtb2R1bGVfZnVuYyhjdHgsIG0pOwogIGlmKCFKU19Jc1VuZGVmaW5lZChmdW5jKSkKICAgIEpTX1NldFByb3BlcnR5U3RyKGN0eCwgb2JqLCAiZnVuYyIsIGZ1bmMpOwogIHJldHVybiBvYmo7Cn0KCkpTTW9kdWxlRGVmKgpqc19tb2R1bGVfZGVmKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsdWUpIHsKICBKU01vZHVsZURlZiogbSA9IDA7CiAgaWYoSlNfSXNTdHJpbmcodmFsdWUpKSB7CiAgICBjb25zdCBjaGFyKiBuYW1lID0gSlNfVG9DU3RyaW5nKGN0eCwgdmFsdWUpOwogICAgbSA9IGpzX21vZHVsZV9maW5kKGN0eCwgbmFtZSk7CiAgICBKU19GcmVlQ1N0cmluZyhjdHgsIG5hbWUpOwogIH0gZWxzZSBpZihKU19WQUxVRV9HRVRfVEFHKHZhbHVlKSA9PSBKU19UQUdfTU9EVUxFKSB7CiAgICBtID0gSlNfVkFMVUVfR0VUX1BUUih2YWx1ZSk7CiAgfQogIHJldHVybiBtOwp9CgpKU01vZHVsZURlZioKanNfbW9kdWxlX2ZpbmRfZndkKEpTQ29udGV4dCogY3R4LCBjb25zdCBjaGFyKiBuYW1lKSB7CiAgc3RydWN0IGxpc3RfaGVhZCogZWw7CiAgc2l6ZV90IG5hbWVsZW4gPSBzdHJsZW4obmFtZSk7CgogIGxpc3RfZm9yX2VhY2goZWwsICZjdHgtPmxvYWRlZF9tb2R1bGVzKSB7CiAgICBKU01vZHVsZURlZiogbSA9IGxpc3RfZW50cnkoZWwsIEpTTW9kdWxlRGVmLCBsaW5rKTsKICAgIGNoYXIgKm4sICpzdHIgPSBtb2R1bGVfbmFtZXN0cihjdHgsIG0pOwogICAgc2l6ZV90IGxlbjsKICAgIG4gPSBiYXNlbmFtZShzdHIpOwogICAgbGVuID0gc3RyX3JjaHIobiwgJy4nKTsKICAgIGlmKCFzdHJjbXAoc3RyLCBuYW1lKSB8fCAhc3RyY21wKG4sIG5hbWUpIHx8IChsZW4gPT0gbmFtZWxlbiAmJiAhc3RybmNtcChuLCBuYW1lLCBsZW4pKSkKICAgICAgcmV0dXJuIG07CiAgICBqc19mcmVlKGN0eCwgc3RyKTsKICB9CgogIHJldHVybiAwOwp9CgpKU01vZHVsZURlZioKanNfbW9kdWxlX2ZpbmRfcmV2KEpTQ29udGV4dCogY3R4LCBjb25zdCBjaGFyKiBuYW1lKSB7CiAgc3RydWN0IGxpc3RfaGVhZCogZWw7CiAgc2l6ZV90IG5hbWVsZW4gPSBzdHJsZW4obmFtZSk7CgogIGxpc3RfZm9yX2VhY2hfcHJldihlbCwgJmN0eC0+bG9hZGVkX21vZHVsZXMpIHsKICAgIEpTTW9kdWxlRGVmKiBtID0gbGlzdF9lbnRyeShlbCwgSlNNb2R1bGVEZWYsIGxpbmspOwogICAgY2hhciAqbiwgKnN0ciA9IG1vZHVsZV9uYW1lc3RyKGN0eCwgbSk7CiAgICBzaXplX3QgbGVuOwogICAgbiA9IGJhc2VuYW1lKHN0cik7CiAgICBsZW4gPSBzdHJfcmNocihuLCAnLicpOwogICAgaWYoIXN0cmNtcChzdHIsIG5hbWUpIHx8ICFzdHJjbXAobiwgbmFtZSkgfHwgKGxlbiA9PSBuYW1lbGVuICYmICFzdHJuY21wKG4sIG5hbWUsIGxlbikpKQogICAgICByZXR1cm4gbTsKICAgIGpzX2ZyZWUoY3R4LCBzdHIpOwogIH0KCiAgcmV0dXJuIDA7Cn0KCmludApqc19tb2R1bGVfaW5kZXhvZihKU0NvbnRleHQqIGN0eCwgSlNNb2R1bGVEZWYqIGRlZikgewogIHN0cnVjdCBsaXN0X2hlYWQqIGVsOwogIGludCBpID0gMDsKICBsaXN0X2Zvcl9lYWNoKGVsLCAmY3R4LT5sb2FkZWRfbW9kdWxlcykgewogICAgSlNNb2R1bGVEZWYqIG0gPSBsaXN0X2VudHJ5KGVsLCBKU01vZHVsZURlZiwgbGluayk7CiAgICBpZihtID09IGRlZikKICAgICAgcmV0dXJuIGk7CiAgICArK2k7CiAgfQogIHJldHVybiAtMTsKfQovKgpWZWN0b3IKanNfbW9kdWxlX3ZlY3RvcihKU0NvbnRleHQqIGN0eCkgewogIFZlY3RvciByZXQgPSBWRUNUT1IoY3R4KTsKICBzdHJ1Y3QgbGlzdF9oZWFkKiBlbDsKICBsaXN0X2Zvcl9lYWNoKGVsLCAmY3R4LT5sb2FkZWRfbW9kdWxlcykgewogICAgSlNNb2R1bGVEZWYqIG0gPSBsaXN0X2VudHJ5KGVsLCBKU01vZHVsZURlZiwgbGluayk7CiAgICB2ZWN0b3JfcHVzaCgmcmV0LCBtKTsKICB9CiAgcmV0dXJuIHJldDsKfQoqLwpKU01vZHVsZURlZioKanNfbW9kdWxlX2F0KEpTQ29udGV4dCogY3R4LCBpbnQgaW5kZXgpIHsKICBzdHJ1Y3QgbGlzdF9oZWFkKiBlbDsKICBpbnQgaSA9IDA7CiAgaWYoaW5kZXggPj0gMCkgewogICAgbGlzdF9mb3JfZWFjaChlbCwgJmN0eC0+bG9hZGVkX21vZHVsZXMpIHsKICAgICAgSlNNb2R1bGVEZWYqIG0gPSBsaXN0X2VudHJ5KGVsLCBKU01vZHVsZURlZiwgbGluayk7CiAgICAgIGlmKGluZGV4ID09IGkpCiAgICAgICAgcmV0dXJuIG07CiAgICAgICsraTsKICAgIH0KICB9IGVsc2UgewogICAgaW5kZXggPSAtKGluZGV4ICsgMSk7CiAgICBsaXN0X2Zvcl9lYWNoX3ByZXYoZWwsICZjdHgtPmxvYWRlZF9tb2R1bGVzKSB7CiAgICAgIEpTTW9kdWxlRGVmKiBtID0gbGlzdF9lbnRyeShlbCwgSlNNb2R1bGVEZWYsIGxpbmspOwogICAgICBpZihpbmRleCA9PSBpKQogICAgICAgIHJldHVybiBtOwogICAgICArK2k7CiAgICB9CiAgfQogIHJldHVybiAwOwp9CgpCT09MCmpzX2lzX2FycmF5YnVmZmVyKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsdWUpIHsKICBCT09MIHJldCA9IEZBTFNFOwogIGlmKCFKU19Jc09iamVjdCh2YWx1ZSkpCiAgICByZXR1cm4gcmV0OwogIGlmKCFyZXQpCiAgICByZXQgfD0ganNfdmFsdWVfaXNjbGFzcyhjdHgsIHZhbHVlLCBKU19DTEFTU19BUlJBWV9CVUZGRVIpOwogIGlmKCFyZXQpCiAgICByZXQgfD0ganNfb2JqZWN0X2lzKGN0eCwgdmFsdWUsICJbb2JqZWN0IEFycmF5QnVmZmVyXSIpOwogIGlmKCFyZXQpCiAgICBpZihKU19Jc09iamVjdCh2YWx1ZSkpIHsKICAgICAgSlNWYWx1ZSBjdG9yID0ganNfZ2xvYmFsX2dldF9zdHIoY3R4LCAiQXJyYXlCdWZmZXIiKTsKICAgICAgcmV0ID0gSlNfSXNJbnN0YW5jZU9mKGN0eCwgdmFsdWUsIGN0b3IpOwogICAgICBKU19GcmVlVmFsdWUoY3R4LCBjdG9yKTsKICAgIH0KICByZXR1cm4gcmV0Owp9CgpCT09MCmpzX2lzX3NoYXJlZGFycmF5YnVmZmVyKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsdWUpIHsKICByZXR1cm4gSlNfSXNPYmplY3QodmFsdWUpICYmIChqc192YWx1ZV9pc2NsYXNzKGN0eCwgdmFsdWUsIEpTX0NMQVNTX1NIQVJFRF9BUlJBWV9CVUZGRVIpKTsKfQoKQk9PTApqc19pc19kYXRlKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsdWUpIHsKICByZXR1cm4gSlNfSXNPYmplY3QodmFsdWUpICYmIChqc192YWx1ZV9pc2NsYXNzKGN0eCwgdmFsdWUsIEpTX0NMQVNTX0RBVEUpKTsKfQoKQk9PTApqc19pc19tYXAoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB2YWx1ZSkgewogIHJldHVybiBKU19Jc09iamVjdCh2YWx1ZSkgJiYgKGpzX3ZhbHVlX2lzY2xhc3MoY3R4LCB2YWx1ZSwgSlNfQ0xBU1NfTUFQKSk7Cn0KCkJPT0wKanNfaXNfc2V0KEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsdWUpIHsKICByZXR1cm4gSlNfSXNPYmplY3QodmFsdWUpICYmIChqc192YWx1ZV9pc2NsYXNzKGN0eCwgdmFsdWUsIEpTX0NMQVNTX1NFVCkpOwp9CgpCT09MCmpzX2lzX2dlbmVyYXRvcihKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHZhbHVlKSB7CiAgcmV0dXJuIEpTX0lzT2JqZWN0KHZhbHVlKSAmJiAoanNfdmFsdWVfaXNjbGFzcyhjdHgsIHZhbHVlLCBKU19DTEFTU19HRU5FUkFUT1IpKTsKfQoKQk9PTApqc19pc19yZWdleHAoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB2YWx1ZSkgewogIHJldHVybiBKU19Jc09iamVjdCh2YWx1ZSkgJiYgKGpzX3ZhbHVlX2lzY2xhc3MoY3R4LCB2YWx1ZSwgSlNfQ0xBU1NfUkVHRVhQKSk7Cn0KCkJPT0wKanNfaXNfcHJvbWlzZShKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHZhbHVlKSB7CiAgcmV0dXJuIEpTX0lzT2JqZWN0KHZhbHVlKSAmJiAoanNfdmFsdWVfaXNjbGFzcyhjdHgsIHZhbHVlLCBKU19DTEFTU19QUk9NSVNFKSB8fCBqc19vYmplY3RfaXMoY3R4LCB2YWx1ZSwgIltvYmplY3QgUHJvbWlzZV0iKSk7Cn0KCkJPT0wKanNfaXNfZGF0YXZpZXcoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB2YWx1ZSkgewogIHJldHVybiBKU19Jc09iamVjdCh2YWx1ZSkgJiYgKGpzX3ZhbHVlX2lzY2xhc3MoY3R4LCB2YWx1ZSwgSlNfQ0xBU1NfREFUQVZJRVcpKTsKfQoKQk9PTApqc19pc19pdGVyYWJsZShKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IG9iaikgewogIEpTQXRvbSBhdG9tOwogIEJPT0wgcmV0ID0gRkFMU0U7CiAgYXRvbSA9IGpzX3N5bWJvbF9zdGF0aWNfYXRvbShjdHgsICJpdGVyYXRvciIpOwogIGlmKEpTX0hhc1Byb3BlcnR5KGN0eCwgb2JqLCBhdG9tKSkKICAgIHJldCA9IFRSVUU7CgogIEpTX0ZyZWVBdG9tKGN0eCwgYXRvbSk7CiAgaWYoIXJldCkgewogICAgYXRvbSA9IGpzX3N5bWJvbF9zdGF0aWNfYXRvbShjdHgsICJhc3luY0l0ZXJhdG9yIik7CiAgICBpZihKU19IYXNQcm9wZXJ0eShjdHgsIG9iaiwgYXRvbSkpCiAgICAgIHJldCA9IFRSVUU7CgogICAgSlNfRnJlZUF0b20oY3R4LCBhdG9tKTsKICB9CiAgcmV0dXJuIHJldDsKfQoKQk9PTApqc19pc19pdGVyYXRvcihKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IG9iaikgewogIGlmKEpTX0lzT2JqZWN0KG9iaikpIHsKICAgIEpTVmFsdWUgbmV4dCA9IEpTX0dldFByb3BlcnR5U3RyKGN0eCwgb2JqLCAibmV4dCIpOwoKICAgIGlmKEpTX0lzRnVuY3Rpb24oY3R4LCBuZXh0KSkKICAgICAgcmV0dXJuIFRSVUU7CiAgfQogIHJldHVybiBGQUxTRTsKfQoKQk9PTApqc19pc19uYW4oSlNWYWx1ZUNvbnN0IG9iaikgewogIHJldHVybiBKU19WQUxVRV9JU19OQU4ob2JqKTsKfQoKSlNWYWx1ZQpqc190eXBlZGFycmF5X3Byb3RvdHlwZShKU0NvbnRleHQqIGN0eCkgewogIEpTVmFsdWUgdThhcnJfcHJvdG8gPSBqc19nbG9iYWxfcHJvdG90eXBlKGN0eCwgIlVpbnQ4QXJyYXkiKTsKICBKU1ZhbHVlIHR5cGVkYXJyX3Byb3RvID0gSlNfR2V0UHJvdG90eXBlKGN0eCwgdThhcnJfcHJvdG8pOwogIEpTX0ZyZWVWYWx1ZShjdHgsIHU4YXJyX3Byb3RvKTsKICByZXR1cm4gdHlwZWRhcnJfcHJvdG87Cn0KCkpTVmFsdWUKanNfdHlwZWRhcnJheV9jb25zdHJ1Y3RvcihKU0NvbnRleHQqIGN0eCkgewogIEpTVmFsdWUgdHlwZWRhcnJfcHJvdG8gPSBqc190eXBlZGFycmF5X3Byb3RvdHlwZShjdHgpOwogIEpTVmFsdWUgdHlwZWRhcnJfY3RvciA9IEpTX0dldFByb3BlcnR5U3RyKGN0eCwgdHlwZWRhcnJfcHJvdG8sICJjb25zdHJ1Y3RvciIpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIHR5cGVkYXJyX3Byb3RvKTsKICByZXR1cm4gdHlwZWRhcnJfY3RvcjsKfQoKSlNWYWx1ZQpqc190eXBlZGFycmF5X25ldyhKU0NvbnRleHQqIGN0eCwgaW50IGJpdHMsIEJPT0wgZmxvYXRpbmcsIEJPT0wgc2lnbiwgSlNWYWx1ZUNvbnN0IGJ1ZmZlcikgewogIGNoYXIgY2xhc3NfbmFtZVs2NF0gPSB7MH07CgogIHNucHJpbnRmKGNsYXNzX25hbWUsIHNpemVvZihjbGFzc19uYW1lKSwgIiVzJXMlZEFycmF5IiwgKCFmbG9hdGluZyAmJiBiaXRzID49IDY0KSA/ICJCaWciIDogIiIsIGZsb2F0aW5nID8gIkZsb2F0IiA6IHNpZ24gPyAiSW50IiA6ICJVaW50IiwgYml0cyk7CgogIEpTVmFsdWUgcmV0LCB0eXBlZGFycmF5X2N0b3IgPSBqc19nbG9iYWxfZ2V0X3N0cihjdHgsIGNsYXNzX25hbWUpOwogIHJldCA9IEpTX0NhbGxDb25zdHJ1Y3RvcihjdHgsIHR5cGVkYXJyYXlfY3RvciwgMSwgJmJ1ZmZlcik7CgogIEpTX0ZyZWVWYWx1ZShjdHgsIHR5cGVkYXJyYXlfY3Rvcik7CiAgcmV0dXJuIHJldDsKfQoKSlNWYWx1ZQpqc19pbnZva2UoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB0aGlzX29iaiwgY29uc3QgY2hhciogbWV0aG9kLCBpbnQgYXJnYywgSlNWYWx1ZUNvbnN0IGFyZ3ZbXSkgewogIEpTQXRvbSBhdG9tOwogIEpTVmFsdWUgcmV0OwogIGF0b20gPSBKU19OZXdBdG9tKGN0eCwgbWV0aG9kKTsKICByZXQgPSBKU19JbnZva2UoY3R4LCB0aGlzX29iaiwgYXRvbSwgYXJnYywgYXJndik7CiAgSlNfRnJlZUF0b20oY3R4LCBhdG9tKTsKICByZXR1cm4gcmV0Owp9CgpKU1ZhbHVlCmpzX3N5bWJvbF9vcGVyYXRvcnNldF92YWx1ZShKU0NvbnRleHQqIGN0eCkgewogIHJldHVybiBqc19zeW1ib2xfc3RhdGljX3ZhbHVlKGN0eCwgIm9wZXJhdG9yU2V0Iik7Cn0KCkpTQXRvbQpqc19zeW1ib2xfb3BlcmF0b3JzZXRfYXRvbShKU0NvbnRleHQqIGN0eCkgewogIEpTVmFsdWUgb3BlcmF0b3Jfc2V0ID0ganNfc3ltYm9sX29wZXJhdG9yc2V0X3ZhbHVlKGN0eCk7CiAgSlNBdG9tIGF0b20gPSBKU19WYWx1ZVRvQXRvbShjdHgsIG9wZXJhdG9yX3NldCk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgb3BlcmF0b3Jfc2V0KTsKICByZXR1cm4gYXRvbTsKfQoKSlNWYWx1ZQpqc19vcGVyYXRvcnNfY3JlYXRlKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlKiB0aGlzX29iaikgewogIEpTVmFsdWUgb3BlcmF0b3JzID0ganNfZ2xvYmFsX2dldF9zdHIoY3R4LCAiT3BlcmF0b3JzIik7CiAgSlNWYWx1ZSBjcmVhdGVfZnVuID0gSlNfR2V0UHJvcGVydHlTdHIoY3R4LCBvcGVyYXRvcnMsICJjcmVhdGUiKTsKICBpZih0aGlzX29iaikKICAgICp0aGlzX29iaiA9IG9wZXJhdG9yczsKICBlbHNlCiAgICBKU19GcmVlVmFsdWUoY3R4LCBvcGVyYXRvcnMpOwogIHJldHVybiBjcmVhdGVfZnVuOwp9CgpKU1ZhbHVlCmpzX251bWJlcl9uZXcoSlNDb250ZXh0KiBjdHgsIGludDMyX3QgbikgewogIGlmKG4gPT0gSU5UMzJfTUFYKQogICAgcmV0dXJuIEpTX05ld0Zsb2F0NjQoY3R4LCBJTkZJTklUWSk7CgogIHJldHVybiBKU19OZXdJbnQzMihjdHgsIG4pOwp9CgpKU1ZhbHVlCmpzX2RhdGVfbmV3KEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgYXJnKSB7CiAgSlNWYWx1ZSBjdG9yID0ganNfZ2xvYmFsX2dldF9zdHIoY3R4LCAiRGF0ZSIpOwogIEpTVmFsdWUgcmV0ID0gSlNfQ2FsbENvbnN0cnVjdG9yKGN0eCwgY3RvciwgMSwgJmFyZyk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgY3Rvcik7CiAgcmV0dXJuIHJldDsKfQoKSlNWYWx1ZQpqc19kYXRlX2Zyb21fbXMoSlNDb250ZXh0KiBjdHgsIGludDY0X3QgbXMpIHsKICBKU1ZhbHVlIGFyZyA9IEpTX05ld0ludDY0KGN0eCwgbXMpOwogIEpTVmFsdWUgcmV0ID0ganNfZGF0ZV9uZXcoY3R4LCBhcmcpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIGFyZyk7CiAgcmV0dXJuIHJldDsKfQoKSlNWYWx1ZQpqc19kYXRlX2Zyb21fdGltZV9ucyhKU0NvbnRleHQqIGN0eCwgdGltZV90IHQsIGxvbmcgbnMpIHsKICByZXR1cm4ganNfZGF0ZV9mcm9tX21zKGN0eCwgdCAqIDEwMDB1bGwgKyBucyAvIDEwMDAwMDB1bGwpOwp9CgpKU1ZhbHVlCmpzX2RhdGVfZnJvbV90aW1lc3BlYyhKU0NvbnRleHQqIGN0eCwgY29uc3Qgc3RydWN0IHRpbWVzcGVjIHRzKSB7CiAgcmV0dXJuIGpzX2RhdGVfZnJvbV90aW1lX25zKGN0eCwgdHMudHZfc2VjLCB0cy50dl9uc2VjKTsKfQoKaW50NjRfdApqc19kYXRlX2dldHRpbWUoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBhcmcpIHsKICBpbnQ2NF90IHIgPSAtMTsKICBKU0F0b20gbWV0aG9kID0gSlNfTmV3QXRvbShjdHgsICJnZXRUaW1lIik7CiAgSlNWYWx1ZSB2YWx1ZSA9IEpTX0ludm9rZShjdHgsIGFyZywgbWV0aG9kLCAwLCAwKTsKICBKU19GcmVlQXRvbShjdHgsIG1ldGhvZCk7CiAgaWYoSlNfSXNOdW1iZXIodmFsdWUpKQogICAgSlNfVG9JbnQ2NChjdHgsICZyLCB2YWx1ZSk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgdmFsdWUpOwogIHJldHVybiByOwp9CgppbnQ2NF90CmpzX2RhdGVfdGltZShKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZSBhcmcpIHsKICBpbnQ2NF90IHIgPSAtMTsKICBpZihKU19Jc09iamVjdChhcmcpKQogICAgciA9IGpzX2RhdGVfZ2V0dGltZShjdHgsIGFyZyk7CiAgZWxzZSBpZighanNfaXNfbnVsbGlzaChjdHgsIGFyZykpCiAgICBKU19Ub0ludDY0KGN0eCwgJnIsIGFyZyk7CiAgcmV0dXJuIHI7Cn0KCnN0cnVjdCB0aW1lc3BlYwpqc19kYXRlX3RpbWVzcGVjKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlIGFyZykgewogIHN0cnVjdCB0aW1lc3BlYyB0czsKICBpbnQ2NF90IHIgPSBqc19kYXRlX3RpbWUoY3R4LCBhcmcpOwogIHRzLnR2X3NlYyA9IHIgLyAxMDAwdWxsOwogIHRzLnR2X25zZWMgPSAociAtIHRzLnR2X3NlYykgKiAxMDAwMDAwdWxsOwogIHJldHVybiB0czsKfQoKdm9pZApqc19hcnJheWJ1ZmZlcl9mcmVldmFsdWUoSlNSdW50aW1lKiBydCwgdm9pZCogb3BhcXVlLCB2b2lkKiBwdHIpIHsKICBKU1ZhbHVlKiB2YWxwdHIgPSBvcGFxdWU7CiAgSlNfRnJlZVZhbHVlUlQocnQsICp2YWxwdHIpOwogIGpzX2ZyZWVfcnQocnQsIG9wYXF1ZSk7Cn0KCkpTVmFsdWUKanNfYXJyYXlidWZmZXJfZnJvbXZhbHVlKEpTQ29udGV4dCogY3R4LCB2b2lkKiB4LCBzaXplX3QgbiwgSlNWYWx1ZUNvbnN0IHZhbCkgewogIEpTVmFsdWUqIHZhbHB0cjsKICBpZighKHZhbHB0ciA9IGpzX21hbGxvYyhjdHgsIHNpemVvZihKU1ZhbHVlKSkpKQogICAgcmV0dXJuIEpTX1Rocm93T3V0T2ZNZW1vcnkoY3R4KTsKICAqdmFscHRyID0gSlNfRHVwVmFsdWUoY3R4LCB2YWwpOwogIHJldHVybiBKU19OZXdBcnJheUJ1ZmZlcihjdHgsIHgsIG4sIGpzX2FycmF5YnVmZmVyX2ZyZWV2YWx1ZSwgdmFscHRyLCBGQUxTRSk7Cn0KCmludDY0X3QKanNfYXJyYXlidWZmZXJfYnl0ZWxlbmd0aChKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHZhbHVlKSB7CiAgaW50NjRfdCBsZW4gPSAtMTsKICBpZihqc19pc19hcnJheWJ1ZmZlcihjdHgsIHZhbHVlKSkgewogICAgSlNWYWx1ZSBsZW5ndGggPSBKU19HZXRQcm9wZXJ0eVN0cihjdHgsIHZhbHVlLCAiYnl0ZUxlbmd0aCIpOwogICAgSlNfVG9JbnQ2NChjdHgsICZsZW4sIGxlbmd0aCk7CiAgICBKU19GcmVlVmFsdWUoY3R4LCBsZW5ndGgpOwogIH0KICByZXR1cm4gbGVuOwp9CgpKU1ZhbHVlCmpzX2V2YWxfbW9kdWxlKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3Qgb2JqLCBCT09MIGxvYWRfb25seSkgewogIEpTVmFsdWUgcmV0ID0gSlNfVU5ERUZJTkVEOwogIGludCB0YWcgPSBKU19WQUxVRV9HRVRfVEFHKG9iaik7CiAgaWYodGFnID09IEpTX1RBR19NT0RVTEUpIHsKICAgIGlmKCFsb2FkX29ubHkgJiYgSlNfUmVzb2x2ZU1vZHVsZShjdHgsIG9iaikgPCAwKSB7CiAgICAgIEpTX0ZyZWVWYWx1ZShjdHgsIG9iaik7CiAgICAgIHJldHVybiBKU19UaHJvd0ludGVybmFsRXJyb3IoY3R4LCAiRmFpbGVkIHJlc29sdmluZyBtb2R1bGUiKTsKICAgIH0KICAgIGpzX21vZHVsZV9zZXRfaW1wb3J0X21ldGEoY3R4LCBvYmosIEZBTFNFLCAhbG9hZF9vbmx5KTsKICAgIHJldHVybiBsb2FkX29ubHkgPyBKU19EdXBWYWx1ZShjdHgsIG9iaikgOiBKU19FdmFsRnVuY3Rpb24oY3R4LCBvYmopOwogIH0KICByZXR1cm4gSlNfVGhyb3dJbnRlcm5hbEVycm9yKGN0eCwgImludmFsaWQgdGFnICVpIiwgdGFnKTsKfQoKSlNWYWx1ZQpqc19ldmFsX2JpbmFyeShKU0NvbnRleHQqIGN0eCwgY29uc3QgdWludDhfdCogYnVmLCBzaXplX3QgYnVmX2xlbiwgQk9PTCBsb2FkX29ubHkpIHsKICBKU1ZhbHVlIG9iaiA9IEpTX1JlYWRPYmplY3QoY3R4LCBidWYsIGJ1Zl9sZW4sIEpTX1JFQURfT0JKX0JZVEVDT0RFKTsKICBpZihKU19Jc0V4Y2VwdGlvbihvYmopKQogICAgcmV0dXJuIG9iajsKICAvLyBwcmludGYoImpzX2V2YWxfYmluYXJ5IG9iaj0lc1xuIiwganNfdmFsdWVfdHlwZXN0cihjdHgsIG9iaikpOwogIGlmKCFsb2FkX29ubHkpIHsKICAgIEpTVmFsdWUgdG1wID0ganNfZXZhbF9tb2R1bGUoY3R4LCBvYmosIGxvYWRfb25seSk7CiAgICBpbnQgdGFnID0gSlNfVkFMVUVfR0VUX1RBRyh0bXApOwogICAgLy8gcHJpbnRmKCJqc19ldmFsX2JpbmFyeSB0bXA9JXNcbiIsIGpzX3ZhbHVlX3R5cGVzdHIoY3R4LCB0bXApKTsKICAgIGlmKCFKU19Jc0V4Y2VwdGlvbih0bXApICYmICFKU19Jc1VuZGVmaW5lZCh0bXApKQogICAgICBpZih0YWcgPj0gSlNfVEFHX0ZJUlNUICYmIHRhZyA8PSBKU19UQUdfRkxPQVQ2NCkKICAgICAgICByZXR1cm4gdG1wOwogIH0KICByZXR1cm4gb2JqOwp9CgpKU1ZhbHVlCmpzX2V2YWxfYnVmKEpTQ29udGV4dCogY3R4LCBjb25zdCB2b2lkKiBidWYsIGludCBidWZfbGVuLCBjb25zdCBjaGFyKiBmaWxlbmFtZSwgaW50IGV2YWxfZmxhZ3MpIHsKICBKU1ZhbHVlIHZhbDsKCiAgaWYoKGV2YWxfZmxhZ3MgJiBKU19FVkFMX1RZUEVfTUFTSykgPT0gSlNfRVZBTF9UWVBFX01PRFVMRSkgewogICAgLyogZm9yIHRoZSBtb2R1bGVzLCB3ZSBjb21waWxlIHRoZW4gcnVuIHRvIGJlIGFibGUgdG8gc2V0IGltcG9ydC5tZXRhICovCiAgICBpZighZmlsZW5hbWUpCiAgICAgIGZpbGVuYW1lID0gIjxpbnB1dD4iOwoKICAgIHZhbCA9IEpTX0V2YWwoY3R4LCBidWYsIGJ1Zl9sZW4sIGZpbGVuYW1lID8gZmlsZW5hbWUgOiAiPGlucHV0PiIsIGV2YWxfZmxhZ3MgfCBKU19FVkFMX0ZMQUdfQ09NUElMRV9PTkxZKTsKICAgIGlmKCFKU19Jc0V4Y2VwdGlvbih2YWwpKSB7CiAgICAgIGpzX21vZHVsZV9zZXRfaW1wb3J0X21ldGEoY3R4LCB2YWwsICEhZmlsZW5hbWUgJiYgZmlsZW5hbWVbMF0gIT0gJzwnLCBUUlVFKTsKICAgICAgdmFsID0gSlNfRXZhbEZ1bmN0aW9uKGN0eCwgdmFsKTsKICAgIH0KICB9IGVsc2UgewogICAgdmFsID0gSlNfRXZhbChjdHgsIGJ1ZiwgYnVmX2xlbiwgZmlsZW5hbWUsIGV2YWxfZmxhZ3MpOwogIH0KICAvKiBpZihKU19Jc0V4Y2VwdGlvbih2YWwpKQogICAgIGpzX2Vycm9yX3ByaW50KGN0eCwgSlNfR2V0RXhjZXB0aW9uKGN0eCkpOyovCiAgcmV0dXJuIHZhbDsKfQoKSlNWYWx1ZQpqc19ldmFsX2ZpbGUoSlNDb250ZXh0KiBjdHgsIGNvbnN0IGNoYXIqIGZpbGVuYW1lLCBpbnQgZXZhbF9mbGFncykgewogIHVpbnQ4X3QqIGJ1ZjsKICBzaXplX3QgYnVmX2xlbjsKCiAgaWYoIShidWYgPSBqc19sb2FkX2ZpbGUoY3R4LCAmYnVmX2xlbiwgZmlsZW5hbWUpKSkKICAgIHJldHVybiBKU19UaHJvd0ludGVybmFsRXJyb3IoY3R4LCAiRXJyb3IgbG9hZGluZyAnJXMnOiAlcyIsIGZpbGVuYW1lLCBzdHJlcnJvcihlcnJubykpOwoKICByZXR1cm4ganNfZXZhbF9idWYoY3R4LCBidWYsIGJ1Zl9sZW4sIGZpbGVuYW1lLCBldmFsX2ZsYWdzKTsKfQoKaW50CmpzX2V2YWxfc3RyKEpTQ29udGV4dCogY3R4LCBjb25zdCBjaGFyKiBzdHIsIGNvbnN0IGNoYXIqIGZpbGUsIGludCBmbGFncykgewogIGludDMyX3QgcmV0ID0gMDsKICBKU1ZhbHVlIHZhbCA9IGpzX2V2YWxfYnVmKGN0eCwgc3RyLCBzdHJsZW4oc3RyKSwgZmlsZSwgZmxhZ3MpOwogIGlmKEpTX0lzRXhjZXB0aW9uKHZhbCkpCiAgICByZXQgPSAtMTsKICBlbHNlIGlmKEpTX0lzTnVtYmVyKHZhbCkpCiAgICBKU19Ub0ludDMyKGN0eCwgJnJldCwgdmFsKTsKICByZXR1cm4gcmV0Owp9CgppbnQgX19hdHRyaWJ1dGVfXygoZm9ybWF0KHByaW50ZiwgMywgNCkpKSBqc19ldmFsX2ZtdChKU0NvbnRleHQqIGN0eCwgaW50IGZsYWdzLCBjb25zdCBjaGFyKiBmbXQsIC4uLikgewogIGludCByZXQ7CiAgdmFfbGlzdCBhcDsKICBEeW5CdWYgYnVmOwogIGRidWZfaW5pdDIoJmJ1ZiwgY3R4LCAocmVhbGxvY19mdW5jKikmdXRpbHNfanNfcmVhbGxvYyk7CiAgdmFfc3RhcnQoYXAsIGZtdCk7CiAgZGJ1Zl92cHJpbnRmKCZidWYsIGZtdCwgYXApOwogIHZhX2VuZChhcCk7CiAgZGJ1Zl8wKCZidWYpOwogIHJldCA9IGpzX2V2YWxfc3RyKGN0eCwgKGNvbnN0IGNoYXIqKWJ1Zi5idWYsICI8aW5wdXQ+IiwgZmxhZ3MpOwogIGRidWZfZnJlZSgmYnVmKTsKICByZXR1cm4gcmV0Owp9Cgp0aHJlYWRfbG9jYWwgdWludDY0X3QganNfcGVuZGluZ19zaWduYWxzID0gMDsKCmludDY0X3QKanNfdGltZV9tcyh2b2lkKSB7CiAgc3RydWN0IHRpbWVzcGVjIHRzOwogIGNsb2NrX2dldHRpbWUoQ0xPQ0tfTU9OT1RPTklDLCAmdHMpOwogIHJldHVybiAodWludDY0X3QpdHMudHZfc2VjICogMTAwMCArICh0cy50dl9uc2VjIC8gMTAwMDAwMCk7Cn0KCmludApqc19pbnRlcnJ1cHRfaGFuZGxlcihKU1J1bnRpbWUqIHJ0LCB2b2lkKiBvcGFxdWUpIHsKICByZXR1cm4gKGpzX3BlbmRpbmdfc2lnbmFscyA+PiBTSUdJTlQpICYgMTsKfQoKdm9pZApqc190aW1lcl91bmxpbmsoSlNSdW50aW1lKiBydCwgSlNPU1RpbWVyKiB0aCkgewogIGlmKHRoLT5saW5rLnByZXYpIHsKICAgIGxpc3RfZGVsKCZ0aC0+bGluayk7CiAgICB0aC0+bGluay5wcmV2ID0gdGgtPmxpbmsubmV4dCA9IDA7CiAgfQp9Cgp2b2lkCmpzX3RpbWVyX2ZyZWUoSlNSdW50aW1lKiBydCwgSlNPU1RpbWVyKiB0aCkgewogIEpTX0ZyZWVWYWx1ZVJUKHJ0LCB0aC0+ZnVuYyk7CiAganNfZnJlZV9ydChydCwgdGgpOwp9Cgp2b2lkCmpzX2NhbGxfaGFuZGxlcihKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IGZ1bmMpIHsKICBKU1ZhbHVlIHJldCwgZnVuYzE7CiAgZnVuYzEgPSBKU19EdXBWYWx1ZShjdHgsIGZ1bmMpOwogIHJldCA9IEpTX0NhbGwoY3R4LCBmdW5jMSwgSlNfVU5ERUZJTkVELCAwLCAwKTsKICBKU19GcmVlVmFsdWUoY3R4LCBmdW5jMSk7CiAgaWYoSlNfSXNFeGNlcHRpb24ocmV0KSkKICAgIGpzX3N0ZF9kdW1wX2Vycm9yKGN0eCk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgcmV0KTsKfQp2b2lkKgpqc19zYWJfYWxsb2Modm9pZCogb3BhcXVlLCBzaXplX3Qgc2l6ZSkgewogIEpTU0FCSGVhZGVyKiBzYWI7CiAgc2FiID0gbWFsbG9jKHNpemVvZihKU1NBQkhlYWRlcikgKyBzaXplKTsKICBpZighc2FiKQogICAgcmV0dXJuIDA7CiAgc2FiLT5yZWZfY291bnQgPSAxOwogIHJldHVybiBzYWItPmJ1ZjsKfQp2b2lkCmpzX3NhYl9mcmVlKHZvaWQqIG9wYXF1ZSwgdm9pZCogcHRyKSB7CiAgSlNTQUJIZWFkZXIqIHNhYjsKICBpbnQgcmVmX2NvdW50OwogIHNhYiA9IChKU1NBQkhlYWRlciopKCh1aW50OF90KilwdHIgLSBzaXplb2YoSlNTQUJIZWFkZXIpKTsKICByZWZfY291bnQgPSBhdG9taWNfYWRkX2ludCgmc2FiLT5yZWZfY291bnQsIC0xKTsKICBhc3NlcnQocmVmX2NvdW50ID49IDApOwogIGlmKHJlZl9jb3VudCA9PSAwKSB7CiAgICBmcmVlKHNhYik7CiAgfQp9Cgp2b2lkCmpzX3NhYl9kdXAodm9pZCogb3BhcXVlLCB2b2lkKiBwdHIpIHsKICBKU1NBQkhlYWRlciogc2FiOwogIHNhYiA9IChKU1NBQkhlYWRlciopKCh1aW50OF90KilwdHIgLSBzaXplb2YoSlNTQUJIZWFkZXIpKTsKICBhdG9taWNfYWRkX2ludCgmc2FiLT5yZWZfY291bnQsIDEpOwp9Cgp2b2lkCmpzX2Vycm9yX2R1bXAoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBlcnJvciwgRHluQnVmKiBkYikgewogIGNvbnN0IGNoYXIgKnN0ciwgKnN0YWNrID0gMDsKICBpZihKU19Jc09iamVjdChlcnJvcikpIHsKICAgIEpTVmFsdWUgc3QgPSBKU19HZXRQcm9wZXJ0eVN0cihjdHgsIGVycm9yLCAic3RhY2siKTsKICAgIGlmKCFKU19Jc1VuZGVmaW5lZChzdCkpCiAgICAgIHN0YWNrID0gSlNfVG9DU3RyaW5nKGN0eCwgc3QpOwogICAgSlNfRnJlZVZhbHVlKGN0eCwgc3QpOwogIH0KICBpZigoc3RyID0gSlNfVG9DU3RyaW5nKGN0eCwgZXJyb3IpKSkgewogICAgY29uc3QgY2hhciogdHlwZSA9IEpTX0lzT2JqZWN0KGVycm9yKSA/IGpzX29iamVjdF9jbGFzc25hbWUoY3R4LCBlcnJvcikgOiBqc192YWx1ZV90eXBlc3RyKGN0eCwgZXJyb3IpOwoKICAgIGlmKCFzdHJfc3RhcnQoc3RyLCB0eXBlKSkgewogICAgICBkYnVmX3B1dHN0cihkYiwgdHlwZSk7CiAgICAgIGRidWZfcHV0c3RyKGRiLCAiOiAiKTsKICAgIH0KICAgIGRidWZfcHV0c3RyKGRiLCBzdHIpOwogICAgZGJ1Zl9wdXRjKGRiLCAnXG4nKTsKICAgIGlmKHN0YWNrKSB7CiAgICAgIGRidWZfcHV0c3RyKGRiLCAiU1RBQ0tcbiIpOwogICAgICBkYnVmX3B1dHN0cihkYiwgc3RhY2spOwogICAgICBkYnVmX3B1dGMoZGIsICdcbicpOwogICAgfQogICAgZGJ1Zl8wKGRiKTsKICB9CiAgaWYoc3RhY2spCiAgICBKU19GcmVlQ1N0cmluZyhjdHgsIHN0YWNrKTsKICBKU19GcmVlQ1N0cmluZyhjdHgsIHN0cik7Cn0KCmNoYXIqCmpzX2Vycm9yX3Rvc3RyaW5nKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgZXJyb3IpIHsKICBEeW5CdWYgZGI7CiAgZGJ1Zl9pbml0MigmZGIsIGN0eCwgKHJlYWxsb2NfZnVuYyopJnV0aWxzX2pzX3JlYWxsb2MpOwogIGpzX2Vycm9yX2R1bXAoY3R4LCBlcnJvciwgJmRiKTsKICByZXR1cm4gKGNoYXIqKWRiLmJ1ZjsKfQoKdm9pZApqc19lcnJvcl9wcmludChKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IGVycm9yKSB7CiAgY29uc3QgY2hhciAqc3RyID0gMCwgKnN0YWNrID0gMDsKCiAgaWYoSlNfSXNPYmplY3QoZXJyb3IpKSB7CiAgICBKU1ZhbHVlIHN0ID0gSlNfR2V0UHJvcGVydHlTdHIoY3R4LCBlcnJvciwgInN0YWNrIik7CgogICAgaWYoIUpTX0lzVW5kZWZpbmVkKHN0KSkKICAgICAgc3RhY2sgPSBKU19Ub0NTdHJpbmcoY3R4LCBzdCk7CgogICAgSlNfRnJlZVZhbHVlKGN0eCwgc3QpOwogIH0KCiAgLy8gZnB1dHMoIlRvcGxldmVsIGVycm9yOlxuIiwgc3RkZXJyKTsKCiAgaWYoIUpTX0lzTnVsbChlcnJvcikgJiYgKHN0ciA9IEpTX1RvQ1N0cmluZyhjdHgsIGVycm9yKSkpIHsKICAgIGNvbnN0IGNoYXIqIHR5cGUgPSBKU19Jc09iamVjdChlcnJvcikgPyBqc19vYmplY3RfY2xhc3NuYW1lKGN0eCwgZXJyb3IpIDoganNfdmFsdWVfdHlwZXN0cihjdHgsIGVycm9yKTsKICAgIGNvbnN0IGNoYXIqIGV4Y2VwdGlvbiA9IHN0cjsKICAgIHNpemVfdCB0eXBlbGVuID0gc3RybGVuKHR5cGUpOwoKICAgIGlmKCFzdHJuY21wKGV4Y2VwdGlvbiwgdHlwZSwgdHlwZWxlbikgJiYgZXhjZXB0aW9uW3R5cGVsZW5dID09ICc6JykgewogICAgICBleGNlcHRpb24gKz0gdHlwZWxlbiArIDI7CiAgICB9CiAgICBmcHJpbnRmKHN0ZGVyciwgIiVzOiAlc1xuIiwgdHlwZSwgZXhjZXB0aW9uKTsKICB9CiAgaWYoc3RhY2sgJiYgKnN0YWNrKQogICAgZnByaW50ZihzdGRlcnIsICJTdGFjazpcbiVzXG4iLCBzdGFjayk7CgogIGZmbHVzaChzdGRlcnIpOwogIGlmKHN0YWNrKQogICAgSlNfRnJlZUNTdHJpbmcoY3R4LCBzdGFjayk7CiAgaWYoc3RyKQogICAgSlNfRnJlZUNTdHJpbmcoY3R4LCBzdHIpOwp9CgpKU1ZhbHVlCmpzX2Vycm9yX3N0YWNrKEpTQ29udGV4dCogY3R4KSB7CiAgSlNWYWx1ZSBlcnJvciA9IGpzX29iamVjdF9lcnJvcihjdHgsICIiKTsKICBKU1ZhbHVlIHN0YWNrID0gSlNfR2V0UHJvcGVydHlTdHIoY3R4LCBlcnJvciwgInN0YWNrIik7CiAgSlNfRnJlZVZhbHVlKGN0eCwgZXJyb3IpOwogIHJldHVybiBzdGFjazsKfQoKLypKU1ZhbHVlCmpzX2Vycm9yX3VuY2F0Y2hhYmxlKEpTQ29udGV4dCogY3R4KSB7CiAgSlNWYWx1ZSBvYmo7CgogIG9iaiA9IEpTX05ld0Vycm9yKGN0eCk7CiAgSlNfU2V0VW5jYXRjaGFibGVFcnJvcihjdHgsIG9iaiwgVFJVRSk7CiAgcmV0dXJuIG9iajsKfSovCgpKU1ZhbHVlCmpzX2lvaGFuZGxlcl9mbihKU0NvbnRleHQqIGN0eCwgQk9PTCB3cml0ZSkgewogIEpTTW9kdWxlRGVmKiBvczsKICBjb25zdCBjaGFyKiBoYW5kbGVyc1syXSA9IHsic2V0UmVhZEhhbmRsZXIiLCAic2V0V3JpdGVIYW5kbGVyIn07CiAgSlNBdG9tIGZ1bmNfbmFtZTsKICBKU1ZhbHVlIHNldF9oYW5kbGVyOwoKICBpZighKG9zID0ganNfbW9kdWxlX2ZpbmQoY3R4LCAib3MiKSkpCiAgICByZXR1cm4gSlNfVGhyb3dSZWZlcmVuY2VFcnJvcihjdHgsICInb3MnIG1vZHVsZSByZXF1aXJlZCIpOwoKICBmdW5jX25hbWUgPSBKU19OZXdBdG9tKGN0eCwgaGFuZGxlcnNbd3JpdGVdKTsKICBzZXRfaGFuZGxlciA9IG1vZHVsZV9leHBvcnRzX2ZpbmQoY3R4LCBvcywgZnVuY19uYW1lKTsKICBKU19GcmVlQXRvbShjdHgsIGZ1bmNfbmFtZSk7CgogIGlmKCFKU19Jc0Z1bmN0aW9uKGN0eCwgc2V0X2hhbmRsZXIpKSB7CiAgICBKU19GcmVlVmFsdWUoY3R4LCBzZXRfaGFuZGxlcik7CiAgICByZXR1cm4gSlNfVGhyb3dSZWZlcmVuY2VFcnJvcihjdHgsICJubyBvcy4lcyBmdW5jdGlvbiIsIGhhbmRsZXJzW3dyaXRlXSk7CiAgfQoKICByZXR1cm4gc2V0X2hhbmRsZXI7Cn0KCkJPT0wKanNfaW9oYW5kbGVyX3NldChKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHNldF9oYW5kbGVyLCBpbnQgZmQsIEpTVmFsdWVDb25zdCBoYW5kbGVyKSB7CiAgSlNWYWx1ZSByZXQsIGFyZ3NbMl0gPSB7CiAgICAgICAgICAgICAgICAgICBKU19OZXdJbnQzMihjdHgsIGZkKSwKICAgICAgICAgICAgICAgICAgIGhhbmRsZXIsCiAgICAgICAgICAgICAgIH07CgogIGlmKEpTX0lzRXhjZXB0aW9uKHNldF9oYW5kbGVyKSkKICAgIHJldHVybiBGQUxTRTsKCiAgcmV0ID0gSlNfQ2FsbChjdHgsIHNldF9oYW5kbGVyLCBKU19VTkRFRklORUQsIGNvdW50b2YoYXJncyksIGFyZ3MpOwoKICBpZihKU19Jc0V4Y2VwdGlvbihyZXQpKQogICAgcmV0dXJuIEZBTFNFOwoKICBKU19GcmVlVmFsdWUoY3R4LCByZXQpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIHNldF9oYW5kbGVyKTsKICBKU19GcmVlVmFsdWUoY3R4LCBhcmdzWzBdKTsKCiAgcmV0dXJuIFRSVUU7Cn0KCnN0YXRpYyB0aHJlYWRfbG9jYWwgSlNDRnVuY3Rpb24qIHJlYWRoYW5kbGVyX2NmdW5jOwoKSlNDRnVuY3Rpb24qCmpzX2lvaGFuZGxlcl9jZnVuYyhKU0NvbnRleHQqIGN0eCwgQk9PTCB3cml0ZSkgewogIGlmKCFyZWFkaGFuZGxlcl9jZnVuYykgewogICAgSlNWYWx1ZSBzZXRfaGFuZGxlcjsKICAgIEpTT2JqZWN0KiBvYmo7CiAgICBzZXRfaGFuZGxlciA9IGpzX2lvaGFuZGxlcl9mbihjdHgsIHdyaXRlKTsKICAgIGlmKEpTX0lzRXhjZXB0aW9uKHNldF9oYW5kbGVyKSkKICAgICAgcmV0dXJuIDA7CiAgICByZWFkaGFuZGxlcl9jZnVuYyA9IGpzX2Z1bmN0aW9uX2NmdW5jKGN0eCwgc2V0X2hhbmRsZXIpOwogIH0KICByZXR1cm4gcmVhZGhhbmRsZXJfY2Z1bmM7Cn0KCkpTVmFsdWUKanNfcHJvbWlzZV9yZXNvbHZlKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgcHJvbWlzZSkgewogIEpTVmFsdWUgcmV0LCBjdG9yID0ganNfZ2xvYmFsX2dldF9zdHIoY3R4LCAiUHJvbWlzZSIpOwogIHJldCA9IGpzX2ludm9rZShjdHgsIGN0b3IsICJyZXNvbHZlIiwgMSwgJnByb21pc2UpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIGN0b3IpOwogIHJldHVybiByZXQ7Cn0KCkpTVmFsdWUKanNfcHJvbWlzZV90aGVuKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgcHJvbWlzZSwgSlNWYWx1ZUNvbnN0IGZ1bmMpIHsKICByZXR1cm4ganNfaW52b2tlKGN0eCwgcHJvbWlzZSwgInRoZW4iLCAxLCAmZnVuYyk7Cn0KCkpTVmFsdWUKanNfcHJvbWlzZV9jYXRjaChKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHByb21pc2UsIEpTVmFsdWVDb25zdCBmdW5jKSB7CiAgcmV0dXJuIGpzX2ludm9rZShjdHgsIHByb21pc2UsICJjYXRjaCIsIDEsICZmdW5jKTsKfQoKSlNWYWx1ZQpqc19wcm9taXNlX3dyYXAoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB2YWx1ZSkgewogIEpTVmFsdWUgcmV0LCBwcm9taXNlLCByZXNvbHZpbmdfZnVuY3NbMl07CiAgcHJvbWlzZSA9IEpTX05ld1Byb21pc2VDYXBhYmlsaXR5KGN0eCwgcmVzb2x2aW5nX2Z1bmNzKTsKICByZXQgPSBKU19DYWxsKGN0eCwgcmVzb2x2aW5nX2Z1bmNzWzBdLCBKU19VTkRFRklORUQsIDEsICZ2YWx1ZSk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgcmV0KTsKCiAgSlNfRnJlZVZhbHVlKGN0eCwgcmVzb2x2aW5nX2Z1bmNzWzBdKTsKICBKU19GcmVlVmFsdWUoY3R4LCByZXNvbHZpbmdfZnVuY3NbMV0pOwogIHJldHVybiBwcm9taXNlOwp9CgpKU1ZhbHVlCmpzX3Byb21pc2VfYWRvcHQoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB2YWx1ZSkgewogIGlmKGpzX2lzX3Byb21pc2UoY3R4LCB2YWx1ZSkpCiAgICByZXR1cm4gSlNfRHVwVmFsdWUoY3R4LCB2YWx1ZSk7CiAgcmV0dXJuIGpzX3Byb21pc2Vfd3JhcChjdHgsIHZhbHVlKTsKfQoKSlNWYWx1ZQpqc190b19zdHJpbmcoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB0aGlzX29iaikgewogIEpTVmFsdWUgcmV0ID0gSlNfVU5ERUZJTkVEOwogIEpTQXRvbSBrZXkgPSBKU19OZXdBdG9tKGN0eCwgInRvU3RyaW5nIik7CiAgaWYoSlNfSGFzUHJvcGVydHkoY3R4LCB0aGlzX29iaiwga2V5KSkKICAgIHJldCA9IEpTX0ludm9rZShjdHgsIHRoaXNfb2JqLCBrZXksIDAsIDApOwogIGVsc2UKICAgIHJldCA9IEpTX1Rocm93VHlwZUVycm9yKGN0eCwgInZhbHVlIGhhcyBubyAudG9TdHJpbmcoKSBtZXRob2QiKTsKICBKU19GcmVlQXRvbShjdHgsIGtleSk7CiAgcmV0dXJuIHJldDsKfQoKSlNWYWx1ZQpqc190b19zb3VyY2UoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB0aGlzX29iaikgewogIEpTVmFsdWUgcmV0ID0gSlNfVU5ERUZJTkVEOwogIEpTQXRvbSBrZXkgPSBKU19OZXdBdG9tKGN0eCwgInRvU291cmNlIik7CiAgaWYoSlNfSGFzUHJvcGVydHkoY3R4LCB0aGlzX29iaiwga2V5KSkKICAgIHJldCA9IEpTX0ludm9rZShjdHgsIHRoaXNfb2JqLCBrZXksIDAsIDApOwogIGVsc2UKICAgIHJldCA9IEpTX1Rocm93VHlwZUVycm9yKGN0eCwgInZhbHVlIGhhcyBubyAudG9Tb3VyY2UoKSBtZXRob2QiKTsKICBKU19GcmVlQXRvbShjdHgsIGtleSk7CiAgcmV0dXJuIHJldDsKfQoKdm9pZAphcmd1bWVudHNfZHVtcChBcmd1bWVudHMgY29uc3QqIGFyZ3MsIC8qSlNDb250ZXh0KiBjdHgsKi8gRHluQnVmKiBkYnVmKSB7CiAgaW50IG4gPSBhcmdzLT5jLCBpOwoKICBpZihuID4gMSkKICAgIGRidWZfcHV0c3RyKGRidWYsICIoIik7CiAgZm9yKGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICBjb25zdCBjaGFyKiBhcmcgPSBhcmdzLT52W2ldOwogICAgaWYoaSA+IDApCiAgICAgIGRidWZfcHV0c3RyKGRidWYsICIsICIpOwogICAgZGJ1Zl9wdXRzdHIoZGJ1ZiwgYXJnID8gYXJnIDogIk5VTEwiKTsKICB9CiAgaWYobiA+IDEpCiAgICBkYnVmX3B1dHN0cihkYnVmLCAiKSIpOwp9CgpCT09MCmFyZ3VtZW50c19hbGxvYyhBcmd1bWVudHMqIGFyZ3MsIEpTQ29udGV4dCogY3R4LCBpbnQgbikgewogIGludCBpLCBqLCBjOwogIGlmKGFyZ3MtPmEpIHsKICAgIGlmKCEoYXJncy0+diA9IGpzX3JlYWxsb2MoY3R4LCBhcmdzLT52LCBzaXplb2YoY2hhciopICogKG4gKyAxKSkpKQogICAgICByZXR1cm4gRkFMU0U7CiAgICBmb3IoaSA9IGFyZ3MtPmM7IGkgPCBhcmdzLT5hOyBpKyspIGFyZ3MtPnZbaV0gPSAwOwogICAgYXJncy0+YSA9IG47CiAgfSBlbHNlIHsKICAgIGNoYXIqKiB2OwogICAgaWYoISh2ID0ganNfbWFsbG9jeihjdHgsIHNpemVvZihjaGFyKikgKiAobiArIDEpKSkpCiAgICAgIHJldHVybiBGQUxTRTsKICAgIGMgPSBNSU5fTlVNKGFyZ3MtPmMsIG4pOwogICAgZm9yKGkgPSAwOyBpIDwgYzsgaSsrKSB2W2ldID0ganNfc3RyZHVwKGN0eCwgYXJncy0+dltpXSk7CiAgICBmb3IoaiA9IGM7IGogPCBhcmdzLT5jOyBqKyspIGpzX2ZyZWUoY3R4LCAodm9pZCopYXJncy0+dltqXSk7CiAgICBmb3IoaiA9IGk7IGogPD0gbjsgaisrKSB2W2pdID0gMDsKICAgIGFyZ3MtPnYgPSAoY29uc3QgY2hhcioqKXY7CiAgICBhcmdzLT5jID0gYzsKICAgIGFyZ3MtPmEgPSBuOwogIH0KICByZXR1cm4gVFJVRTsKfQoKY29uc3QgY2hhcioKYXJndW1lbnRzX3B1c2goQXJndW1lbnRzKiBhcmdzLCBKU0NvbnRleHQqIGN0eCwgY29uc3QgY2hhciogYXJnKSB7CiAgaW50IHI7CiAgaWYoYXJncy0+YyArIDEgPj0gYXJncy0+YSkKICAgIGlmKCFhcmd1bWVudHNfYWxsb2MoYXJncywgY3R4LCBhcmdzLT5hICsgMSkpCiAgICAgIHJldHVybiAwOwogIHIgPSBhcmdzLT5jOwogIGFyZ3MtPnZbcl0gPSBqc19zdHJkdXAoY3R4LCBhcmcpOwogIGFyZ3MtPnZbciArIDFdID0gMDsKICBhcmdzLT5jKys7CiAgcmV0dXJuIGFyZ3MtPnZbcl07Cn0KCkJPT0wKanNfYXJndW1lbnRzX2FsbG9jKEpTQXJndW1lbnRzKiBhcmdzLCBKU0NvbnRleHQqIGN0eCwgaW50IG4pIHsKICBpbnQgaTsKICBpZihhcmdzLT5hKSB7CiAgICBpZighKGFyZ3MtPnYgPSBqc19yZWFsbG9jKGN0eCwgYXJncy0+diwgc2l6ZW9mKEpTVmFsdWVDb25zdCkgKiAobiArIDEpKSkpCiAgICAgIHJldHVybiBGQUxTRTsKCiAgICBmb3IoaSA9IGFyZ3MtPmM7IGkgPCBhcmdzLT5hOyBpKyspIGFyZ3MtPnZbaV0gPSBKU19VTkRFRklORUQ7CiAgfSBlbHNlIHsKICAgIEpTVmFsdWVDb25zdCogdjsKCiAgICBpZighKHYgPSBqc19tYWxsb2N6KGN0eCwgc2l6ZW9mKEpTVmFsdWVDb25zdCkgKiAobiArIDEpKSkpCiAgICAgIHJldHVybiBGQUxTRTsKICAgIG1lbWNweSh2LCBhcmdzLT52LCBzaXplb2YoSlNWYWx1ZUNvbnN0KSAqIChhcmdzLT5jICsgMSkpOwogICAgYXJncy0+diA9IHY7CiAgICBhcmdzLT5hID0gbjsKICB9CiAgcmV0dXJuIFRSVUU7Cn0KCnZvaWQKanNfYXJndW1lbnRzX2R1bXAoSlNBcmd1bWVudHMgY29uc3QqIGFyZ3MsIEpTQ29udGV4dCogY3R4LCBEeW5CdWYqIGRidWYpIHsKICBpbnQgbiA9IGFyZ3MtPmMsIGk7CgogIGlmKG4gPiAxKQogICAgZGJ1Zl9wdXRzdHIoZGJ1ZiwgIigiKTsKCiAgZm9yKGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICBKU1ZhbHVlIGFyZyA9IGFyZ3MtPnZbaV07CiAgICBpZihKU19Jc0V4Y2VwdGlvbihhcmcpKQogICAgICBicmVhazsKCiAgICBqc192YWx1ZV9kdW1wKGN0eCwgYXJnLCBkYnVmKTsKICAgIGlmKGkgPiAwKQogICAgICBkYnVmX3B1dHN0cihkYnVmLCAiLCAiKTsKICB9CgogIGlmKG4gPiAxKQogICAgZGJ1Zl9wdXRzdHIoZGJ1ZiwgIikiKTsKfQoKY2hhcioKanNfdG9zdHJpbmdsZW4oSlNDb250ZXh0KiBjdHgsIHNpemVfdCogbGVucCwgSlNWYWx1ZUNvbnN0IHZhbHVlKSB7CiAgc2l6ZV90IGxlbjsKICBjb25zdCBjaGFyKiBjc3RyOwogIGNoYXIqIHJldCA9IDA7CiAgaWYoKGNzdHIgPSBKU19Ub0NTdHJpbmdMZW4oY3R4LCAmbGVuLCB2YWx1ZSkpKSB7CiAgICByZXQgPSBqc19zdHJuZHVwKGN0eCwgY3N0ciwgbGVuKTsKICAgIGlmKGxlbnApCiAgICAgICpsZW5wID0gbGVuOwogICAganNfY3N0cmluZ19mcmVlKGN0eCwgY3N0cik7CiAgfQogIHJldHVybiByZXQ7Cn0KCmNoYXIqCmpzX3Rvc3RyaW5nKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsdWUpIHsKICByZXR1cm4ganNfdG9zdHJpbmdsZW4oY3R4LCAwLCB2YWx1ZSk7Cn0KCmNoYXIqCmpzX3Rvc291cmNlKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsdWUpIHsKICBKU1ZhbHVlIHNyYyA9IGpzX3RvX3NvdXJjZShjdHgsIHZhbHVlKTsKICBjb25zdCBjaGFyKiBzdHIgPSBKU19Ub0NTdHJpbmcoY3R4LCBzcmMpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIHNyYyk7CiAgY2hhciogcmV0ID0ganNfc3RyZHVwKGN0eCwgc3RyKTsKICBKU19GcmVlQ1N0cmluZyhjdHgsIHN0cik7CiAgcmV0dXJuIHJldDsKfQoKd2NoYXJfdCoKanNfdG93c3RyaW5nbGVuKEpTQ29udGV4dCogY3R4LCBzaXplX3QqIGxlbnAsIEpTVmFsdWVDb25zdCB2YWx1ZSkgewogIHNpemVfdCBpLCBsZW47CiAgY29uc3QgY2hhciogY3N0cjsKICB3Y2hhcl90KiByZXQgPSAwOwogIGlmKChjc3RyID0gSlNfVG9DU3RyaW5nTGVuKGN0eCwgJmxlbiwgdmFsdWUpKSkgewogICAgcmV0ID0ganNfbWFsbG9jeihjdHgsIHNpemVvZih3Y2hhcl90KSAqIChsZW4gKyAxKSk7CiAgICBjb25zdCB1aW50OF90ICpwdHIgPSAoY29uc3QgdWludDhfdCopY3N0ciwgKmVuZCA9IChjb25zdCB1aW50OF90Kiljc3RyICsgbGVuOwoKICAgIGZvcihpID0gMDsgcHRyIDwgZW5kOykgeyByZXRbaSsrXSA9IHVuaWNvZGVfZnJvbV91dGY4KHB0ciwgZW5kIC0gcHRyLCAmcHRyKTsgfQoKICAgIGlmKGxlbnApCiAgICAgICpsZW5wID0gaTsKICB9CiAgcmV0dXJuIHJldDsKfQoKY2hhcioKanNfanNvbl9zdHJpbmdpZnkoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB2YWx1ZSkgewogIEpTVmFsdWUgc3RydjsKICBjaGFyKiBzdHIgPSAwOwogIHN0cnYgPSBKU19KU09OU3RyaW5naWZ5KGN0eCwgdmFsdWUsIEpTX05VTEwsIEpTX01LVkFMKEpTX1RBR19JTlQsIDIpKTsKICBzdHIgPSBqc190b3N0cmluZyhjdHgsIHN0cnYpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIHN0cnYpOwogIHJldHVybiBzdHI7Cn0KCkJPT0wKanNfaXNfaWRlbnRpZmllcl9sZW4oSlNDb250ZXh0KiBjdHgsIGNvbnN0IGNoYXIqIHN0ciwgc2l6ZV90IGxlbikgewogIC8qIGNsYW5nLWZvcm1hdCBvZmYgKi8gCiAgUmVnRXhwIHJlID0gcmVnZXhwX2Zyb21fc3RyaW5nKChjaGFyKikiKFskX2EtekEtWl18W1xceGFhXFx4YjVcXHhiYVxceGMwLVxceGQ2XFx4ZDgtXFx4ZjZcXHhmOC1cXHUwMmMxXFx1MDJjNi1cXHUwMmQxXFx1MDJlMC1cXHUwMmU0XFx1MDJlY1xcdTAyZWVcXHUwMzcwLVxcdTAzNzRcXHUwMzc2XFx1MDM3N1xcdTAzN2EtXFx1MDM3ZFxcdTAzODZcXHUwMzg4LVxcdTAzOGFcXHUwMzhjXFx1MDM4ZS1cXHUwM2ExXFx1MDNhMy1cXHUwM2Y1XFx1MDNmNy1cXHUwNDgxXFx1MDQ4YS1cXHUwNTI3XFx1MDUzMS1cXHUwNTU2XFx1MDU1OVxcdTA1NjEtXFx1MDU4N1xcdTA1ZDAtXFx1MDVlYVxcdTA1ZjAtXFx1MDVmMlxcdTA2MjAtXFx1MDY0YVxcdTA2NmVcXHUwNjZmXFx1MDY3MS1cXHUwNmQzXFx1MDZkNVxcdTA2ZTVcXHUwNmU2XFx1MDZlZVxcdTA2ZWZcXHUwNmZhLVxcdTA2ZmNcXHUwNmZmXFx1MDcxMFxcdTA3MTItXFx1MDcyZlxcdTA3NGQtXFx1MDdhNVxcdTA3YjFcXHUwN2NhLVxcdTA3ZWFcXHUwN2Y0XFx1MDdmNVxcdTA3ZmFcXHUwODAwLVxcdTA4MTVcXHUwODFhXFx1MDgyNFxcdTA4MjhcXHUwODQwLVxcdTA4NThcXHUwOGEwXFx1MDhhMi1cXHUwOGFjXFx1MDkwNC1cXHUwOTM5XFx1MDkzZFxcdTA5NTBcXHUwOTU4LVxcdTA5NjFcXHUwOTcxLVxcdTA5NzdcXHUwOTc5LVxcdTA5N2ZcXHUwOTg1LVxcdTA5OGNcXHUwOThmXFx1MDk5MFxcdTA5OTMtXFx1MDlhOFxcdTA5YWEtXFx1MDliMFxcdTA5YjJcXHUwOWI2LVxcdTA5YjlcXHUwOWJkXFx1MDljZVxcdTA5ZGNcXHUwOWRkXFx1MDlkZi1cXHUwOWUxXFx1MDlmMFxcdTA5ZjFcXHUwYTA1LVxcdTBhMGFcXHUwYTBmXFx1MGExMFxcdTBhMTMtXFx1MGEyOFxcdTBhMmEtXFx1MGEzMFxcdTBhMzJcXHUwYTMzXFx1MGEzNVxcdTBhMzZcXHUwYTM4XFx1MGEzOVxcdTBhNTktXFx1MGE1Y1xcdTBhNWVcXHUwYTcyLVxcdTBhNzRcXHUwYTg1LVxcdTBhOGRcXHUwYThmLVxcdTBhOTFcXHUwYTkzLVxcdTBhYThcXHUwYWFhLVxcdTBhYjBcXHUwYWIyXFx1MGFiM1xcdTBhYjUtXFx1MGFiOVxcdTBhYmRcXHUwYWQwXFx1MGFlMFxcdTBhZTFcXHUwYjA1LVxcdTBiMGNcXHUwYjBmXFx1MGIxMFxcdTBiMTMtXFx1MGIyOFxcdTBiMmEtXFx1MGIzMFxcdTBiMzJcXHUwYjMzXFx1MGIzNS1cXHUwYjM5XFx1MGIzZFxcdTBiNWNcXHUwYjVkXFx1MGI1Zi1cXHUwYjYxXFx1MGI3MVxcdTBiODNcXHUwYjg1LVxcdTBiOGFcXHUwYjhlLVxcdTBiOTBcXHUwYjkyLVxcdTBiOTVcXHUwYjk5XFx1MGI5YVxcdTBiOWNcXHUwYjllXFx1MGI5ZlxcdTBiYTNcXHUwYmE0XFx1MGJhOC1cXHUwYmFhXFx1MGJhZS1cXHUwYmI5XFx1MGJkMFxcdTBjMDUtXFx1MGMwY1xcdTBjMGUtXFx1MGMxMFxcdTBjMTItXFx1MGMyOFxcdTBjMmEtXFx1MGMzM1xcdTBjMzUtXFx1MGMzOVxcdTBjM2RcXHUwYzU4XFx1MGM1OVxcdTBjNjBcXHUwYzYxXFx1MGM4NS1cXHUwYzhjXFx1MGM4ZS1cXHUwYzkwXFx1MGM5Mi1cXHUwY2E4XFx1MGNhYS1cXHUwY2IzXFx1MGNiNS1cXHUwY2I5XFx1MGNiZFxcdTBjZGVcXHUwY2UwXFx1MGNlMVxcdTBjZjFcXHUwY2YyXFx1MGQwNS1cXHUwZDBjXFx1MGQwZS1cXHUwZDEwXFx1MGQxMi1cXHUwZDNhXFx1MGQzZFxcdTBkNGVcXHUwZDYwXFx1MGQ2MVxcdTBkN2EtXFx1MGQ3ZlxcdTBkODUtXFx1MGQ5NlxcdTBkOWEtXFx1MGRiMVxcdTBkYjMtXFx1MGRiYlxcdTBkYmRcXHUwZGMwLVxcdTBkYzZcXHUwZTAxLVxcdTBlMzBcXHUwZTMyXFx1MGUzM1xcdTBlNDAtXFx1MGU0NlxcdTBlODFcXHUwZTgyXFx1MGU4NFxcdTBlODdcXHUwZTg4XFx1MGU4YVxcdTBlOGRcXHUwZTk0LVxcdTBlOTdcXHUwZTk5LVxcdTBlOWZcXHUwZWExLVxcdTBlYTNcXHUwZWE1XFx1MGVhN1xcdTBlYWFcXHUwZWFiXFx1MGVhZC1cXHUwZWIwXFx1MGViMlxcdTBlYjNcXHUwZWJkXFx1MGVjMC1cXHUwZWM0XFx1MGVjNlxcdTBlZGMtXFx1MGVkZlxcdTBmMDBcXHUwZjQwLVxcdTBmNDdcXHUwZjQ5LVxcdTBmNmNcXHUwZjg4LVxcdTBmOGNcXHUxMDAwLVxcdTEwMmFcXHUxMDNmXFx1MTA1MC1cXHUxMDU1XFx1MTA1YS1cXHUxMDVkXFx1MTA2MVxcdTEwNjVcXHUxMDY2XFx1MTA2ZS1cXHUxMDcwXFx1MTA3NS1cXHUxMDgxXFx1MTA4ZVxcdTEwYTAtXFx1MTBjNVxcdTEwYzdcXHUxMGNkXFx1MTBkMC1cXHUxMGZhXFx1MTBmYy1cXHUxMjQ4XFx1MTI0YS1cXHUxMjRkXFx1MTI1MC1cXHUxMjU2XFx1MTI1OFxcdTEyNWEtXFx1MTI1ZFxcdTEyNjAtXFx1MTI4OFxcdTEyOGEtXFx1MTI4ZFxcdTEyOTAtXFx1MTJiMFxcdTEyYjItXFx1MTJiNVxcdTEyYjgtXFx1MTJiZVxcdTEyYzBcXHUxMmMyLVxcdTEyYzVcXHUxMmM4LVxcdTEyZDZcXHUxMmQ4LVxcdTEzMTBcXHUxMzEyLVxcdTEzMTVcXHUxMzE4LVxcdTEzNWFcXHUxMzgwLVxcdTEzOGZcXHUxM2EwLVxcdTEzZjRcXHUxNDAxLVxcdTE2NmNcXHUxNjZmLVxcdTE2N2ZcXHUxNjgxLVxcdTE2OWFcXHUxNmEwLVxcdTE2ZWFcXHUxNmVlLVxcdTE2ZjBcXHUxNzAwLVxcdTE3MGNcXHUxNzBlLVxcdTE3MTFcXHUxNzIwLVxcdTE3MzFcXHUxNzQwLVxcdTE3NTFcXHUxNzYwLVxcdTE3NmNcXHUxNzZlLVxcdTE3NzBcXHUxNzgwLVxcdTE3YjNcXHUxN2Q3XFx1MTdkY1xcdTE4MjAtXFx1MTg3N1xcdTE4ODAtXFx1MThhOFxcdTE4YWFcXHUxOGIwLVxcdTE4ZjVcXHUxOTAwLVxcdTE5MWNcXHUxOTUwLVxcdTE5NmRcXHUxOTcwLVxcdTE5NzRcXHUxOTgwLVxcdTE5YWJcXHUxOWMxLVxcdTE5YzdcXHUxYTAwLVxcdTFhMTZcXHUxYTIwLVxcdTFhNTRcXHUxYWE3XFx1MWIwNS1cXHUxYjMzXFx1MWI0NS1cXHUxYjRiXFx1MWI4My1cXHUxYmEwXFx1MWJhZVxcdTFiYWZcXHUxYmJhLVxcdTFiZTVcXHUxYzAwLVxcdTFjMjNcXHUxYzRkLVxcdTFjNGZcXHUxYzVhLVxcdTFjN2RcXHUxY2U5LVxcdTFjZWNcXHUxY2VlLVxcdTFjZjFcXHUxY2Y1XFx1MWNmNlxcdTFkMDAtXFx1MWRiZlxcdTFlMDAtXFx1MWYxNVxcdTFmMTgtXFx1MWYxZFxcdTFmMjAtXFx1MWY0NVxcdTFmNDgtXFx1MWY0ZFxcdTFmNTAtXFx1MWY1N1xcdTFmNTlcXHUxZjViXFx1MWY1ZFxcdTFmNWYtXFx1MWY3ZFxcdTFmODAtXFx1MWZiNFxcdTFmYjYtXFx1MWZiY1xcdTFmYmVcXHUxZmMyLVxcdTFmYzRcXHUxZmM2LVxcdTFmY2NcXHUxZmQwLVxcdTFmZDNcXHUxZmQ2LVxcdTFmZGJcXHUxZmUwLVxcdTFmZWNcXHUxZmYyLVxcdTFmZjRcXHUxZmY2LVxcdTFmZmNcXHUyMDcxXFx1MjA3ZlxcdTIwOTAtXFx1MjA5Y1xcdTIxMDJcXHUyMTA3XFx1MjEwYS1cXHUyMTEzXFx1MjExNVxcdTIxMTktXFx1MjExZFxcdTIxMjRcXHUyMTI2XFx1MjEyOFxcdTIxMmEtXFx1MjEyZFxcdTIxMmYtXFx1MjEzOVxcdTIxM2MtXFx1MjEzZlxcdTIxNDUtXFx1MjE0OVxcdTIxNGVcXHUyMTYwLVxcdTIxODhcXHUyYzAwLVxcdTJjMmVcXHUyYzMwLVxcdTJjNWVcXHUyYzYwLVxcdTJjZTRcXHUyY2ViLVxcdTJjZWVcXHUyY2YyXFx1MmNmM1xcdTJkMDAtXFx1MmQyNVxcdTJkMjdcXHUyZDJkXFx1MmQzMC1cXHUyZDY3XFx1MmQ2ZlxcdTJkODAtXFx1MmQ5NlxcdTJkYTAtXFx1MmRhNlxcdTJkYTgtXFx1MmRhZVxcdTJkYjAtXFx1MmRiNlxcdTJkYjgtXFx1MmRiZVxcdTJkYzAtXFx1MmRjNlxcdTJkYzgtXFx1MmRjZVxcdTJkZDAtXFx1MmRkNlxcdTJkZDgtXFx1MmRkZVxcdTJlMmZcXHUzMDA1LVxcdTMwMDdcXHUzMDIxLVxcdTMwMjlcXHUzMDMxLVxcdTMwMzVcXHUzMDM4LVxcdTMwM2NcXHUzMDQxLVxcdTMwOTZcXHUzMDlkLVxcdTMwOWZcXHUzMGExLVxcdTMwZmFcXHUzMGZjLVxcdTMwZmZcXHUzMTA1LVxcdTMxMmRcXHUzMTMxLVxcdTMxOGVcXHUzMWEwLVxcdTMxYmFcXHUzMWYwLVxcdTMxZmZcXHUzNDAwLVxcdTRkYjVcXHU0ZTAwLVxcdTlmY2NcXHVhMDAwLVxcdWE0OGNcXHVhNGQwLVxcdWE0ZmRcXHVhNTAwLVxcdWE2MGNcXHVhNjEwLVxcdWE2MWZcXHVhNjJhXFx1YTYyYlxcdWE2NDAtXFx1YTY2ZVxcdWE2N2YtXFx1YTY5N1xcdWE2YTAtXFx1YTZlZlxcdWE3MTctXFx1YTcxZlxcdWE3MjItXFx1YTc4OFxcdWE3OGItXFx1YTc4ZVxcdWE3OTAtXFx1YTc5M1xcdWE3YTAtXFx1YTdhYVxcdWE3ZjgtXFx1YTgwMVxcdWE4MDMtXFx1YTgwNVxcdWE4MDctXFx1YTgwYVxcdWE4MGMtXFx1YTgyMlxcdWE4NDAtXFx1YTg3M1xcdWE4ODItXFx1YThiM1xcdWE4ZjItXFx1YThmN1xcdWE4ZmJcXHVhOTBhLVxcdWE5MjVcXHVhOTMwLVxcdWE5NDZcXHVhOTYwLVxcdWE5N2NcXHVhOTg0LVxcdWE5YjJcXHVhOWNmXFx1YWEwMC1cXHVhYTI4XFx1YWE0MC1cXHVhYTQyXFx1YWE0NC1cXHVhYTRiXFx1YWE2MC1cXHVhYTc2XFx1YWE3YVxcdWFhODAtXFx1YWFhZlxcdWFhYjFcXHVhYWI1XFx1YWFiNlxcdWFhYjktXFx1YWFiZFxcdWFhYzBcXHVhYWMyXFx1YWFkYi1cXHVhYWRkXFx1YWFlMC1cXHVhYWVhXFx1YWFmMi1cXHVhYWY0XFx1YWIwMS1cXHVhYjA2XFx1YWIwOS1cXHVhYjBlXFx1YWIxMS1cXHVhYjE2XFx1YWIyMC1cXHVhYjI2XFx1YWIyOC1cXHVhYjJlXFx1YWJjMC1cXHVhYmUyXFx1YWMwMC1cXHVkN2EzXFx1ZDdiMC1cXHVkN2M2XFx1ZDdjYi1cXHVkN2ZiXFx1ZjkwMC1cXHVmYTZkXFx1ZmE3MC1cXHVmYWQ5XFx1ZmIwMC1cXHVmYjA2XFx1ZmIxMy1cXHVmYjE3XFx1ZmIxZFxcdWZiMWYtXFx1ZmIyOFxcdWZiMmEtXFx1ZmIzNlxcdWZiMzgtXFx1ZmIzY1xcdWZiM2VcXHVmYjQwXFx1ZmI0MVxcdWZiNDNcXHVmYjQ0XFx1ZmI0Ni1cXHVmYmIxXFx1ZmJkMy1cXHVmZDNkXFx1ZmQ1MC1cXHVmZDhmXFx1ZmQ5Mi1cXHVmZGM3XFx1ZmRmMC1cXHVmZGZiXFx1ZmU3MC1cXHVmZTc0XFx1ZmU3Ni1cXHVmZWZjXFx1ZmYyMS1cXHVmZjNhXFx1ZmY0MS1cXHVmZjVhXFx1ZmY2Ni1cXHVmZmJlXFx1ZmZjMi1cXHVmZmM3XFx1ZmZjYS1cXHVmZmNmXFx1ZmZkMi1cXHVmZmQ3XFx1ZmZkYS1cXHVmZmRjXXxcXFxcW3VdWzAtOWEtZkEtRl17NH0pKFskX2EtekEtWl18W1xceGFhXFx4YjVcXHhiYVxceGMwLVxceGQ2XFx4ZDgtXFx4ZjZcXHhmOC1cXHUwMmMxXFx1MDJjNi1cXHUwMmQxXFx1MDJlMC1cXHUwMmU0XFx1MDJlY1xcdTAyZWVcXHUwMzcwLVxcdTAzNzRcXHUwMzc2XFx1MDM3N1xcdTAzN2EtXFx1MDM3ZFxcdTAzODZcXHUwMzg4LVxcdTAzOGFcXHUwMzhjXFx1MDM4ZS1cXHUwM2ExXFx1MDNhMy1cXHUwM2Y1XFx1MDNmNy1cXHUwNDgxXFx1MDQ4YS1cXHUwNTI3XFx1MDUzMS1cXHUwNTU2XFx1MDU1OVxcdTA1NjEtXFx1MDU4N1xcdTA1ZDAtXFx1MDVlYVxcdTA1ZjAtXFx1MDVmMlxcdTA2MjAtXFx1MDY0YVxcdTA2NmVcXHUwNjZmXFx1MDY3MS1cXHUwNmQzXFx1MDZkNVxcdTA2ZTVcXHUwNmU2XFx1MDZlZVxcdTA2ZWZcXHUwNmZhLVxcdTA2ZmNcXHUwNmZmXFx1MDcxMFxcdTA3MTItXFx1MDcyZlxcdTA3NGQtXFx1MDdhNVxcdTA3YjFcXHUwN2NhLVxcdTA3ZWFcXHUwN2Y0XFx1MDdmNVxcdTA3ZmFcXHUwODAwLVxcdTA4MTVcXHUwODFhXFx1MDgyNFxcdTA4MjhcXHUwODQwLVxcdTA4NThcXHUwOGEwXFx1MDhhMi1cXHUwOGFjXFx1MDkwNC1cXHUwOTM5XFx1MDkzZFxcdTA5NTBcXHUwOTU4LVxcdTA5NjFcXHUwOTcxLVxcdTA5NzdcXHUwOTc5LVxcdTA5N2ZcXHUwOTg1LVxcdTA5OGNcXHUwOThmXFx1MDk5MFxcdTA5OTMtXFx1MDlhOFxcdTA5YWEtXFx1MDliMFxcdTA5YjJcXHUwOWI2LVxcdTA5YjlcXHUwOWJkXFx1MDljZVxcdTA5ZGNcXHUwOWRkXFx1MDlkZi1cXHUwOWUxXFx1MDlmMFxcdTA5ZjFcXHUwYTA1LVxcdTBhMGFcXHUwYTBmXFx1MGExMFxcdTBhMTMtXFx1MGEyOFxcdTBhMmEtXFx1MGEzMFxcdTBhMzJcXHUwYTMzXFx1MGEzNVxcdTBhMzZcXHUwYTM4XFx1MGEzOVxcdTBhNTktXFx1MGE1Y1xcdTBhNWVcXHUwYTcyLVxcdTBhNzRcXHUwYTg1LVxcdTBhOGRcXHUwYThmLVxcdTBhOTFcXHUwYTkzLVxcdTBhYThcXHUwYWFhLVxcdTBhYjBcXHUwYWIyXFx1MGFiM1xcdTBhYjUtXFx1MGFiOVxcdTBhYmRcXHUwYWQwXFx1MGFlMFxcdTBhZTFcXHUwYjA1LVxcdTBiMGNcXHUwYjBmXFx1MGIxMFxcdTBiMTMtXFx1MGIyOFxcdTBiMmEtXFx1MGIzMFxcdTBiMzJcXHUwYjMzXFx1MGIzNS1cXHUwYjM5XFx1MGIzZFxcdTBiNWNcXHUwYjVkXFx1MGI1Zi1cXHUwYjYxXFx1MGI3MVxcdTBiODNcXHUwYjg1LVxcdTBiOGFcXHUwYjhlLVxcdTBiOTBcXHUwYjkyLVxcdTBiOTVcXHUwYjk5XFx1MGI5YVxcdTBiOWNcXHUwYjllXFx1MGI5ZlxcdTBiYTNcXHUwYmE0XFx1MGJhOC1cXHUwYmFhXFx1MGJhZS1cXHUwYmI5XFx1MGJkMFxcdTBjMDUtXFx1MGMwY1xcdTBjMGUtXFx1MGMxMFxcdTBjMTItXFx1MGMyOFxcdTBjMmEtXFx1MGMzM1xcdTBjMzUtXFx1MGMzOVxcdTBjM2RcXHUwYzU4XFx1MGM1OVxcdTBjNjBcXHUwYzYxXFx1MGM4NS1cXHUwYzhjXFx1MGM4ZS1cXHUwYzkwXFx1MGM5Mi1cXHUwY2E4XFx1MGNhYS1cXHUwY2IzXFx1MGNiNS1cXHUwY2I5XFx1MGNiZFxcdTBjZGVcXHUwY2UwXFx1MGNlMVxcdTBjZjFcXHUwY2YyXFx1MGQwNS1cXHUwZDBjXFx1MGQwZS1cXHUwZDEwXFx1MGQxMi1cXHUwZDNhXFx1MGQzZFxcdTBkNGVcXHUwZDYwXFx1MGQ2MVxcdTBkN2EtXFx1MGQ3ZlxcdTBkODUtXFx1MGQ5NlxcdTBkOWEtXFx1MGRiMVxcdTBkYjMtXFx1MGRiYlxcdTBkYmRcXHUwZGMwLVxcdTBkYzZcXHUwZTAxLVxcdTBlMzBcXHUwZTMyXFx1MGUzM1xcdTBlNDAtXFx1MGU0NlxcdTBlODFcXHUwZTgyXFx1MGU4NFxcdTBlODdcXHUwZTg4XFx1MGU4YVxcdTBlOGRcXHUwZTk0LVxcdTBlOTdcXHUwZTk5LVxcdTBlOWZcXHUwZWExLVxcdTBlYTNcXHUwZWE1XFx1MGVhN1xcdTBlYWFcXHUwZWFiXFx1MGVhZC1cXHUwZWIwXFx1MGViMlxcdTBlYjNcXHUwZWJkXFx1MGVjMC1cXHUwZWM0XFx1MGVjNlxcdTBlZGMtXFx1MGVkZlxcdTBmMDBcXHUwZjQwLVxcdTBmNDdcXHUwZjQ5LVxcdTBmNmNcXHUwZjg4LVxcdTBmOGNcXHUxMDAwLVxcdTEwMmFcXHUxMDNmXFx1MTA1MC1cXHUxMDU1XFx1MTA1YS1cXHUxMDVkXFx1MTA2MVxcdTEwNjVcXHUxMDY2XFx1MTA2ZS1cXHUxMDcwXFx1MTA3NS1cXHUxMDgxXFx1MTA4ZVxcdTEwYTAtXFx1MTBjNVxcdTEwYzdcXHUxMGNkXFx1MTBkMC1cXHUxMGZhXFx1MTBmYy1cXHUxMjQ4XFx1MTI0YS1cXHUxMjRkXFx1MTI1MC1cXHUxMjU2XFx1MTI1OFxcdTEyNWEtXFx1MTI1ZFxcdTEyNjAtXFx1MTI4OFxcdTEyOGEtXFx1MTI4ZFxcdTEyOTAtXFx1MTJiMFxcdTEyYjItXFx1MTJiNVxcdTEyYjgtXFx1MTJiZVxcdTEyYzBcXHUxMmMyLVxcdTEyYzVcXHUxMmM4LVxcdTEyZDZcXHUxMmQ4LVxcdTEzMTBcXHUxMzEyLVxcdTEzMTVcXHUxMzE4LVxcdTEzNWFcXHUxMzgwLVxcdTEzOGZcXHUxM2EwLVxcdTEzZjRcXHUxNDAxLVxcdTE2NmNcXHUxNjZmLVxcdTE2N2ZcXHUxNjgxLVxcdTE2OWFcXHUxNmEwLVxcdTE2ZWFcXHUxNmVlLVxcdTE2ZjBcXHUxNzAwLVxcdTE3MGNcXHUxNzBlLVxcdTE3MTFcXHUxNzIwLVxcdTE3MzFcXHUxNzQwLVxcdTE3NTFcXHUxNzYwLVxcdTE3NmNcXHUxNzZlLVxcdTE3NzBcXHUxNzgwLVxcdTE3YjNcXHUxN2Q3XFx1MTdkY1xcdTE4MjAtXFx1MTg3N1xcdTE4ODAtXFx1MThhOFxcdTE4YWFcXHUxOGIwLVxcdTE4ZjVcXHUxOTAwLVxcdTE5MWNcXHUxOTUwLVxcdTE5NmRcXHUxOTcwLVxcdTE5NzRcXHUxOTgwLVxcdTE5YWJcXHUxOWMxLVxcdTE5YzdcXHUxYTAwLVxcdTFhMTZcXHUxYTIwLVxcdTFhNTRcXHUxYWE3XFx1MWIwNS1cXHUxYjMzXFx1MWI0NS1cXHUxYjRiXFx1MWI4My1cXHUxYmEwXFx1MWJhZVxcdTFiYWZcXHUxYmJhLVxcdTFiZTVcXHUxYzAwLVxcdTFjMjNcXHUxYzRkLVxcdTFjNGZcXHUxYzVhLVxcdTFjN2RcXHUxY2U5LVxcdTFjZWNcXHUxY2VlLVxcdTFjZjFcXHUxY2Y1XFx1MWNmNlxcdTFkMDAtXFx1MWRiZlxcdTFlMDAtXFx1MWYxNVxcdTFmMTgtXFx1MWYxZFxcdTFmMjAtXFx1MWY0NVxcdTFmNDgtXFx1MWY0ZFxcdTFmNTAtXFx1MWY1N1xcdTFmNTlcXHUxZjViXFx1MWY1ZFxcdTFmNWYtXFx1MWY3ZFxcdTFmODAtXFx1MWZiNFxcdTFmYjYtXFx1MWZiY1xcdTFmYmVcXHUxZmMyLVxcdTFmYzRcXHUxZmM2LVxcdTFmY2NcXHUxZmQwLVxcdTFmZDNcXHUxZmQ2LVxcdTFmZGJcXHUxZmUwLVxcdTFmZWNcXHUxZmYyLVxcdTFmZjRcXHUxZmY2LVxcdTFmZmNcXHUyMDcxXFx1MjA3ZlxcdTIwOTAtXFx1MjA5Y1xcdTIxMDJcXHUyMTA3XFx1MjEwYS1cXHUyMTEzXFx1MjExNVxcdTIxMTktXFx1MjExZFxcdTIxMjRcXHUyMTI2XFx1MjEyOFxcdTIxMmEtXFx1MjEyZFxcdTIxMmYtXFx1MjEzOVxcdTIxM2MtXFx1MjEzZlxcdTIxNDUtXFx1MjE0OVxcdTIxNGVcXHUyMTYwLVxcdTIxODhcXHUyYzAwLVxcdTJjMmVcXHUyYzMwLVxcdTJjNWVcXHUyYzYwLVxcdTJjZTRcXHUyY2ViLVxcdTJjZWVcXHUyY2YyXFx1MmNmM1xcdTJkMDAtXFx1MmQyNVxcdTJkMjdcXHUyZDJkXFx1MmQzMC1cXHUyZDY3XFx1MmQ2ZlxcdTJkODAtXFx1MmQ5NlxcdTJkYTAtXFx1MmRhNlxcdTJkYTgtXFx1MmRhZVxcdTJkYjAtXFx1MmRiNlxcdTJkYjgtXFx1MmRiZVxcdTJkYzAtXFx1MmRjNlxcdTJkYzgtXFx1MmRjZVxcdTJkZDAtXFx1MmRkNlxcdTJkZDgtXFx1MmRkZVxcdTJlMmZcXHUzMDA1LVxcdTMwMDdcXHUzMDIxLVxcdTMwMjlcXHUzMDMxLVxcdTMwMzVcXHUzMDM4LVxcdTMwM2NcXHUzMDQxLVxcdTMwOTZcXHUzMDlkLVxcdTMwOWZcXHUzMGExLVxcdTMwZmFcXHUzMGZjLVxcdTMwZmZcXHUzMTA1LVxcdTMxMmRcXHUzMTMxLVxcdTMxOGVcXHUzMWEwLVxcdTMxYmFcXHUzMWYwLVxcdTMxZmZcXHUzNDAwLVxcdTRkYjVcXHU0ZTAwLVxcdTlmY2NcXHVhMDAwLVxcdWE0OGNcXHVhNGQwLVxcdWE0ZmRcXHVhNTAwLVxcdWE2MGNcXHVhNjEwLVxcdWE2MWZcXHVhNjJhXFx1YTYyYlxcdWE2NDAtXFx1YTY2ZVxcdWE2N2YtXFx1YTY5N1xcdWE2YTAtXFx1YTZlZlxcdWE3MTctXFx1YTcxZlxcdWE3MjItXFx1YTc4OFxcdWE3OGItXFx1YTc4ZVxcdWE3OTAtXFx1YTc5M1xcdWE3YTAtXFx1YTdhYVxcdWE3ZjgtXFx1YTgwMVxcdWE4MDMtXFx1YTgwNVxcdWE4MDctXFx1YTgwYVxcdWE4MGMtXFx1YTgyMlxcdWE4NDAtXFx1YTg3M1xcdWE4ODItXFx1YThiM1xcdWE4ZjItXFx1YThmN1xcdWE4ZmJcXHVhOTBhLVxcdWE5MjVcXHVhOTMwLVxcdWE5NDZcXHVhOTYwLVxcdWE5N2NcXHVhOTg0LVxcdWE5YjJcXHVhOWNmXFx1YWEwMC1cXHVhYTI4XFx1YWE0MC1cXHVhYTQyXFx1YWE0NC1cXHVhYTRiXFx1YWE2MC1cXHVhYTc2XFx1YWE3YVxcdWFhODAtXFx1YWFhZlxcdWFhYjFcXHVhYWI1XFx1YWFiNlxcdWFhYjktXFx1YWFiZFxcdWFhYzBcXHVhYWMyXFx1YWFkYi1cXHVhYWRkXFx1YWFlMC1cXHVhYWVhXFx1YWFmMi1cXHVhYWY0XFx1YWIwMS1cXHVhYjA2XFx1YWIwOS1cXHVhYjBlXFx1YWIxMS1cXHVhYjE2XFx1YWIyMC1cXHVhYjI2XFx1YWIyOC1cXHVhYjJlXFx1YWJjMC1cXHVhYmUyXFx1YWMwMC1cXHVkN2EzXFx1ZDdiMC1cXHVkN2M2XFx1ZDdjYi1cXHVkN2ZiXFx1ZjkwMC1cXHVmYTZkXFx1ZmE3MC1cXHVmYWQ5XFx1ZmIwMC1cXHVmYjA2XFx1ZmIxMy1cXHVmYjE3XFx1ZmIxZFxcdWZiMWYtXFx1ZmIyOFxcdWZiMmEtXFx1ZmIzNlxcdWZiMzgtXFx1ZmIzY1xcdWZiM2VcXHVmYjQwXFx1ZmI0MVxcdWZiNDNcXHVmYjQ0XFx1ZmI0Ni1cXHVmYmIxXFx1ZmJkMy1cXHVmZDNkXFx1ZmQ1MC1cXHVmZDhmXFx1ZmQ5Mi1cXHVmZGM3XFx1ZmRmMC1cXHVmZGZiXFx1ZmU3MC1cXHVmZTc0XFx1ZmU3Ni1cXHVmZWZjXFx1ZmYyMS1cXHVmZjNhXFx1ZmY0MS1cXHVmZjVhXFx1ZmY2Ni1cXHVmZmJlXFx1ZmZjMi1cXHVmZmM3XFx1ZmZjYS1cXHVmZmNmXFx1ZmZkMi1cXHVmZmQ3XFx1ZmZkYS1cXHVmZmRjXXxcXFxcW3VdWzAtOWEtZkEtRl17NH18W1xceGFhXFx4YjVcXHhiYVxceGMwLVxceGQ2XFx4ZDgtXFx4ZjZcXHhmOC1cXHUwMmMxXFx1MDJjNi1cXHUwMmQxXFx1MDJlMC1cXHUwMmU0XFx1MDJlY1xcdTAyZWVcXHUwMzcwLVxcdTAzNzRcXHUwMzc2XFx1MDM3N1xcdTAzN2EtXFx1MDM3ZFxcdTAzODZcXHUwMzg4LVxcdTAzOGFcXHUwMzhjXFx1MDM4ZS1cXHUwM2ExXFx1MDNhMy1cXHUwM2Y1XFx1MDNmNy1cXHUwNDgxXFx1MDQ4YS1cXHUwNTI3XFx1MDUzMS1cXHUwNTU2XFx1MDU1OVxcdTA1NjEtXFx1MDU4N1xcdTA1ZDAtXFx1MDVlYVxcdTA1ZjAtXFx1MDVmMlxcdTA2MjAtXFx1MDY0YVxcdTA2NmVcXHUwNjZmXFx1MDY3MS1cXHUwNmQzXFx1MDZkNVxcdTA2ZTVcXHUwNmU2XFx1MDZlZVxcdTA2ZWZcXHUwNmZhLVxcdTA2ZmNcXHUwNmZmXFx1MDcxMFxcdTA3MTItXFx1MDcyZlxcdTA3NGQtXFx1MDdhNVxcdTA3YjFcXHUwN2NhLVxcdTA3ZWFcXHUwN2Y0XFx1MDdmNVxcdTA3ZmFcXHUwODAwLVxcdTA4MTVcXHUwODFhXFx1MDgyNFxcdTA4MjhcXHUwODQwLVxcdTA4NThcXHUwOGEwXFx1MDhhMi1cXHUwOGFjXFx1MDkwNC1cXHUwOTM5XFx1MDkzZFxcdTA5NTBcXHUwOTU4LVxcdTA5NjFcXHUwOTcxLVxcdTA5NzdcXHUwOTc5LVxcdTA5N2ZcXHUwOTg1LVxcdTA5OGNcXHUwOThmXFx1MDk5MFxcdTA5OTMtXFx1MDlhOFxcdTA5YWEtXFx1MDliMFxcdTA5YjJcXHUwOWI2LVxcdTA5YjlcXHUwOWJkXFx1MDljZVxcdTA5ZGNcXHUwOWRkXFx1MDlkZi1cXHUwOWUxXFx1MDlmMFxcdTA5ZjFcXHUwYTA1LVxcdTBhMGFcXHUwYTBmXFx1MGExMFxcdTBhMTMtXFx1MGEyOFxcdTBhMmEtXFx1MGEzMFxcdTBhMzJcXHUwYTMzXFx1MGEzNVxcdTBhMzZcXHUwYTM4XFx1MGEzOVxcdTBhNTktXFx1MGE1Y1xcdTBhNWVcXHUwYTcyLVxcdTBhNzRcXHUwYTg1LVxcdTBhOGRcXHUwYThmLVxcdTBhOTFcXHUwYTkzLVxcdTBhYThcXHUwYWFhLVxcdTBhYjBcXHUwYWIyXFx1MGFiM1xcdTBhYjUtXFx1MGFiOVxcdTBhYmRcXHUwYWQwXFx1MGFlMFxcdTBhZTFcXHUwYjA1LVxcdTBiMGNcXHUwYjBmXFx1MGIxMFxcdTBiMTMtXFx1MGIyOFxcdTBiMmEtXFx1MGIzMFxcdTBiMzJcXHUwYjMzXFx1MGIzNS1cXHUwYjM5XFx1MGIzZFxcdTBiNWNcXHUwYjVkXFx1MGI1Zi1cXHUwYjYxXFx1MGI3MVxcdTBiODNcXHUwYjg1LVxcdTBiOGFcXHUwYjhlLVxcdTBiOTBcXHUwYjkyLVxcdTBiOTVcXHUwYjk5XFx1MGI5YVxcdTBiOWNcXHUwYjllXFx1MGI5ZlxcdTBiYTNcXHUwYmE0XFx1MGJhOC1cXHUwYmFhXFx1MGJhZS1cXHUwYmI5XFx1MGJkMFxcdTBjMDUtXFx1MGMwY1xcdTBjMGUtXFx1MGMxMFxcdTBjMTItXFx1MGMyOFxcdTBjMmEtXFx1MGMzM1xcdTBjMzUtXFx1MGMzOVxcdTBjM2RcXHUwYzU4XFx1MGM1OVxcdTBjNjBcXHUwYzYxXFx1MGM4NS1cXHUwYzhjXFx1MGM4ZS1cXHUwYzkwXFx1MGM5Mi1cXHUwY2E4XFx1MGNhYS1cXHUwY2IzXFx1MGNiNS1cXHUwY2I5XFx1MGNiZFxcdTBjZGVcXHUwY2UwXFx1MGNlMVxcdTBjZjFcXHUwY2YyXFx1MGQwNS1cXHUwZDBjXFx1MGQwZS1cXHUwZDEwXFx1MGQxMi1cXHUwZDNhXFx1MGQzZFxcdTBkNGVcXHUwZDYwXFx1MGQ2MVxcdTBkN2EtXFx1MGQ3ZlxcdTBkODUtXFx1MGQ5NlxcdTBkOWEtXFx1MGRiMVxcdTBkYjMtXFx1MGRiYlxcdTBkYmRcXHUwZGMwLVxcdTBkYzZcXHUwZTAxLVxcdTBlMzBcXHUwZTMyXFx1MGUzM1xcdTBlNDAtXFx1MGU0NlxcdTBlODFcXHUwZTgyXFx1MGU4NFxcdTBlODdcXHUwZTg4XFx1MGU4YVxcdTBlOGRcXHUwZTk0LVxcdTBlOTdcXHUwZTk5LVxcdTBlOWZcXHUwZWExLVxcdTBlYTNcXHUwZWE1XFx1MGVhN1xcdTBlYWFcXHUwZWFiXFx1MGVhZC1cXHUwZWIwXFx1MGViMlxcdTBlYjNcXHUwZWJkXFx1MGVjMC1cXHUwZWM0XFx1MGVjNlxcdTBlZGMtXFx1MGVkZlxcdTBmMDBcXHUwZjQwLVxcdTBmNDdcXHUwZjQ5LVxcdTBmNmNcXHUwZjg4LVxcdTBmOGNcXHUxMDAwLVxcdTEwMmFcXHUxMDNmXFx1MTA1MC1cXHUxMDU1XFx1MTA1YS1cXHUxMDVkXFx1MTA2MVxcdTEwNjVcXHUxMDY2XFx1MTA2ZS1cXHUxMDcwXFx1MTA3NS1cXHUxMDgxXFx1MTA4ZVxcdTEwYTAtXFx1MTBjNVxcdTEwYzdcXHUxMGNkXFx1MTBkMC1cXHUxMGZhXFx1MTBmYy1cXHUxMjQ4XFx1MTI0YS1cXHUxMjRkXFx1MTI1MC1cXHUxMjU2XFx1MTI1OFxcdTEyNWEtXFx1MTI1ZFxcdTEyNjAtXFx1MTI4OFxcdTEyOGEtXFx1MTI4ZFxcdTEyOTAtXFx1MTJiMFxcdTEyYjItXFx1MTJiNVxcdTEyYjgtXFx1MTJiZVxcdTEyYzBcXHUxMmMyLVxcdTEyYzVcXHUxMmM4LVxcdTEyZDZcXHUxMmQ4LVxcdTEzMTBcXHUxMzEyLVxcdTEzMTVcXHUxMzE4LVxcdTEzNWFcXHUxMzgwLVxcdTEzOGZcXHUxM2EwLVxcdTEzZjRcXHUxNDAxLVxcdTE2NmNcXHUxNjZmLVxcdTE2N2ZcXHUxNjgxLVxcdTE2OWFcXHUxNmEwLVxcdTE2ZWFcXHUxNmVlLVxcdTE2ZjBcXHUxNzAwLVxcdTE3MGNcXHUxNzBlLVxcdTE3MTFcXHUxNzIwLVxcdTE3MzFcXHUxNzQwLVxcdTE3NTFcXHUxNzYwLVxcdTE3NmNcXHUxNzZlLVxcdTE3NzBcXHUxNzgwLVxcdTE3YjNcXHUxN2Q3XFx1MTdkY1xcdTE4MjAtXFx1MTg3N1xcdTE4ODAtXFx1MThhOFxcdTE4YWFcXHUxOGIwLVxcdTE4ZjVcXHUxOTAwLVxcdTE5MWNcXHUxOTUwLVxcdTE5NmRcXHUxOTcwLVxcdTE5NzRcXHUxOTgwLVxcdTE5YWJcXHUxOWMxLVxcdTE5YzdcXHUxYTAwLVxcdTFhMTZcXHUxYTIwLVxcdTFhNTRcXHUxYWE3XFx1MWIwNS1cXHUxYjMzXFx1MWI0NS1cXHUxYjRiXFx1MWI4My1cXHUxYmEwXFx1MWJhZVxcdTFiYWZcXHUxYmJhLVxcdTFiZTVcXHUxYzAwLVxcdTFjMjNcXHUxYzRkLVxcdTFjNGZcXHUxYzVhLVxcdTFjN2RcXHUxY2U5LVxcdTFjZWNcXHUxY2VlLVxcdTFjZjFcXHUxY2Y1XFx1MWNmNlxcdTFkMDAtXFx1MWRiZlxcdTFlMDAtXFx1MWYxNVxcdTFmMTgtXFx1MWYxZFxcdTFmMjAtXFx1MWY0NVxcdTFmNDgtXFx1MWY0ZFxcdTFmNTAtXFx1MWY1N1xcdTFmNTlcXHUxZjViXFx1MWY1ZFxcdTFmNWYtXFx1MWY3ZFxcdTFmODAtXFx1MWZiNFxcdTFmYjYtXFx1MWZiY1xcdTFmYmVcXHUxZmMyLVxcdTFmYzRcXHUxZmM2LVxcdTFmY2NcXHUxZmQwLVxcdTFmZDNcXHUxZmQ2LVxcdTFmZGJcXHUxZmUwLVxcdTFmZWNcXHUxZmYyLVxcdTFmZjRcXHUxZmY2LVxcdTFmZmNcXHUyMDcxXFx1MjA3ZlxcdTIwOTAtXFx1MjA5Y1xcdTIxMDJcXHUyMTA3XFx1MjEwYS1cXHUyMTEzXFx1MjExNVxcdTIxMTktXFx1MjExZFxcdTIxMjRcXHUyMTI2XFx1MjEyOFxcdTIxMmEtXFx1MjEyZFxcdTIxMmYtXFx1MjEzOVxcdTIxM2MtXFx1MjEzZlxcdTIxNDUtXFx1MjE0OVxcdTIxNGVcXHUyMTYwLVxcdTIxODhcXHUyYzAwLVxcdTJjMmVcXHUyYzMwLVxcdTJjNWVcXHUyYzYwLVxcdTJjZTRcXHUyY2ViLVxcdTJjZWVcXHUyY2YyXFx1MmNmM1xcdTJkMDAtXFx1MmQyNVxcdTJkMjdcXHUyZDJkXFx1MmQzMC1cXHUyZDY3XFx1MmQ2ZlxcdTJkODAtXFx1MmQ5NlxcdTJkYTAtXFx1MmRhNlxcdTJkYTgtXFx1MmRhZVxcdTJkYjAtXFx1MmRiNlxcdTJkYjgtXFx1MmRiZVxcdTJkYzAtXFx1MmRjNlxcdTJkYzgtXFx1MmRjZVxcdTJkZDAtXFx1MmRkNlxcdTJkZDgtXFx1MmRkZVxcdTJlMmZcXHUzMDA1LVxcdTMwMDdcXHUzMDIxLVxcdTMwMjlcXHUzMDMxLVxcdTMwMzVcXHUzMDM4LVxcdTMwM2NcXHUzMDQxLVxcdTMwOTZcXHUzMDlkLVxcdTMwOWZcXHUzMGExLVxcdTMwZmFcXHUzMGZjLVxcdTMwZmZcXHUzMTA1LVxcdTMxMmRcXHUzMTMxLVxcdTMxOGVcXHUzMWEwLVxcdTMxYmFcXHUzMWYwLVxcdTMxZmZcXHUzNDAwLVxcdTRkYjVcXHU0ZTAwLVxcdTlmY2NcXHVhMDAwLVxcdWE0OGNcXHVhNGQwLVxcdWE0ZmRcXHVhNTAwLVxcdWE2MGNcXHVhNjEwLVxcdWE2MWZcXHVhNjJhXFx1YTYyYlxcdWE2NDAtXFx1YTY2ZVxcdWE2N2YtXFx1YTY5N1xcdWE2YTAtXFx1YTZlZlxcdWE3MTctXFx1YTcxZlxcdWE3MjItXFx1YTc4OFxcdWE3OGItXFx1YTc4ZVxcdWE3OTAtXFx1YTc5M1xcdWE3YTAtXFx1YTdhYVxcdWE3ZjgtXFx1YTgwMVxcdWE4MDMtXFx1YTgwNVxcdWE4MDctXFx1YTgwYVxcdWE4MGMtXFx1YTgyMlxcdWE4NDAtXFx1YTg3M1xcdWE4ODItXFx1YThiM1xcdWE4ZjItXFx1YThmN1xcdWE4ZmJcXHVhOTBhLVxcdWE5MjVcXHVhOTMwLVxcdWE5NDZcXHVhOTYwLVxcdWE5N2NcXHVhOTg0LVxcdWE5YjJcXHVhOWNmXFx1YWEwMC1cXHVhYTI4XFx1YWE0MC1cXHVhYTQyXFx1YWE0NC1cXHVhYTRiXFx1YWE2MC1cXHVhYTc2XFx1YWE3YVxcdWFhODAtXFx1YWFhZlxcdWFhYjFcXHVhYWI1XFx1YWFiNlxcdWFhYjktXFx1YWFiZFxcdWFhYzBcXHVhYWMyXFx1YWFkYi1cXHVhYWRkXFx1YWFlMC1cXHVhYWVhXFx1YWFmMi1cXHVhYWY0XFx1YWIwMS1cXHVhYjA2XFx1YWIwOS1cXHVhYjBlXFx1YWIxMS1cXHVhYjE2XFx1YWIyMC1cXHVhYjI2XFx1YWIyOC1cXHVhYjJlXFx1YWJjMC1cXHVhYmUyXFx1YWMwMC1cXHVkN2EzXFx1ZDdiMC1cXHVkN2M2XFx1ZDdjYi1cXHVkN2ZiXFx1ZjkwMC1cXHVmYTZkXFx1ZmE3MC1cXHVmYWQ5XFx1ZmIwMC1cXHVmYjA2XFx1ZmIxMy1cXHVmYjE3XFx1ZmIxZFxcdWZiMWYtXFx1ZmIyOFxcdWZiMmEtXFx1ZmIzNlxcdWZiMzgtXFx1ZmIzY1xcdWZiM2VcXHVmYjQwXFx1ZmI0MVxcdWZiNDNcXHVmYjQ0XFx1ZmI0Ni1cXHVmYmIxXFx1ZmJkMy1cXHVmZDNkXFx1ZmQ1MC1cXHVmZDhmXFx1ZmQ5Mi1cXHVmZGM3XFx1ZmRmMC1cXHVmZGZiXFx1ZmU3MC1cXHVmZTc0XFx1ZmU3Ni1cXHVmZWZjXFx1ZmYyMS1cXHVmZjNhXFx1ZmY0MS1cXHVmZjVhXFx1ZmY2Ni1cXHVmZmJlXFx1ZmZjMi1cXHVmZmM3XFx1ZmZjYS1cXHVmZmNmXFx1ZmZkMi1cXHVmZmQ3XFx1ZmZkYS1cXHVmZmRjMC05XFx1MDMwMC1cXHUwMzZmXFx1MDQ4My1cXHUwNDg3XFx1MDU5MS1cXHUwNWJkXFx1MDViZlxcdTA1YzFcXHUwNWMyXFx1MDVjNFxcdTA1YzVcXHUwNWM3XFx1MDYxMC1cXHUwNjFhXFx1MDY0Yi1cXHUwNjY5XFx1MDY3MFxcdTA2ZDYtXFx1MDZkY1xcdTA2ZGYtXFx1MDZlNFxcdTA2ZTdcXHUwNmU4XFx1MDZlYS1cXHUwNmVkXFx1MDZmMC1cXHUwNmY5XFx1MDcxMVxcdTA3MzAtXFx1MDc0YVxcdTA3YTYtXFx1MDdiMFxcdTA3YzAtXFx1MDdjOVxcdTA3ZWItXFx1MDdmM1xcdTA4MTYtXFx1MDgxOVxcdTA4MWItXFx1MDgyM1xcdTA4MjUtXFx1MDgyN1xcdTA4MjktXFx1MDgyZFxcdTA4NTktXFx1MDg1YlxcdTA4ZTQtXFx1MDhmZVxcdTA5MDAtXFx1MDkwM1xcdTA5M2EtXFx1MDkzY1xcdTA5M2UtXFx1MDk0ZlxcdTA5NTEtXFx1MDk1N1xcdTA5NjJcXHUwOTYzXFx1MDk2Ni1cXHUwOTZmXFx1MDk4MS1cXHUwOTgzXFx1MDliY1xcdTA5YmUtXFx1MDljNFxcdTA5YzdcXHUwOWM4XFx1MDljYi1cXHUwOWNkXFx1MDlkN1xcdTA5ZTJcXHUwOWUzXFx1MDllNi1cXHUwOWVmXFx1MGEwMS1cXHUwYTAzXFx1MGEzY1xcdTBhM2UtXFx1MGE0MlxcdTBhNDdcXHUwYTQ4XFx1MGE0Yi1cXHUwYTRkXFx1MGE1MVxcdTBhNjYtXFx1MGE3MVxcdTBhNzVcXHUwYTgxLVxcdTBhODNcXHUwYWJjXFx1MGFiZS1cXHUwYWM1XFx1MGFjNy1cXHUwYWM5XFx1MGFjYi1cXHUwYWNkXFx1MGFlMlxcdTBhZTNcXHUwYWU2LVxcdTBhZWZcXHUwYjAxLVxcdTBiMDNcXHUwYjNjXFx1MGIzZS1cXHUwYjQ0XFx1MGI0N1xcdTBiNDhcXHUwYjRiLVxcdTBiNGRcXHUwYjU2XFx1MGI1N1xcdTBiNjJcXHUwYjYzXFx1MGI2Ni1cXHUwYjZmXFx1MGI4MlxcdTBiYmUtXFx1MGJjMlxcdTBiYzYtXFx1MGJjOFxcdTBiY2EtXFx1MGJjZFxcdTBiZDdcXHUwYmU2LVxcdTBiZWZcXHUwYzAxLVxcdTBjMDNcXHUwYzNlLVxcdTBjNDRcXHUwYzQ2LVxcdTBjNDhcXHUwYzRhLVxcdTBjNGRcXHUwYzU1XFx1MGM1NlxcdTBjNjJcXHUwYzYzXFx1MGM2Ni1cXHUwYzZmXFx1MGM4MlxcdTBjODNcXHUwY2JjXFx1MGNiZS1cXHUwY2M0XFx1MGNjNi1cXHUwY2M4XFx1MGNjYS1cXHUwY2NkXFx1MGNkNVxcdTBjZDZcXHUwY2UyXFx1MGNlM1xcdTBjZTYtXFx1MGNlZlxcdTBkMDJcXHUwZDAzXFx1MGQzZS1cXHUwZDQ0XFx1MGQ0Ni1cXHUwZDQ4XFx1MGQ0YS1cXHUwZDRkXFx1MGQ1N1xcdTBkNjJcXHUwZDYzXFx1MGQ2Ni1cXHUwZDZmXFx1MGQ4MlxcdTBkODNcXHUwZGNhXFx1MGRjZi1cXHUwZGQ0XFx1MGRkNlxcdTBkZDgtXFx1MGRkZlxcdTBkZjJcXHUwZGYzXFx1MGUzMVxcdTBlMzQtXFx1MGUzYVxcdTBlNDctXFx1MGU0ZVxcdTBlNTAtXFx1MGU1OVxcdTBlYjFcXHUwZWI0LVxcdTBlYjlcXHUwZWJiXFx1MGViY1xcdTBlYzgtXFx1MGVjZFxcdTBlZDAtXFx1MGVkOVxcdTBmMThcXHUwZjE5XFx1MGYyMC1cXHUwZjI5XFx1MGYzNVxcdTBmMzdcXHUwZjM5XFx1MGYzZVxcdTBmM2ZcXHUwZjcxLVxcdTBmODRcXHUwZjg2XFx1MGY4N1xcdTBmOGQtXFx1MGY5N1xcdTBmOTktXFx1MGZiY1xcdTBmYzZcXHUxMDJiLVxcdTEwM2VcXHUxMDQwLVxcdTEwNDlcXHUxMDU2LVxcdTEwNTlcXHUxMDVlLVxcdTEwNjBcXHUxMDYyLVxcdTEwNjRcXHUxMDY3LVxcdTEwNmRcXHUxMDcxLVxcdTEwNzRcXHUxMDgyLVxcdTEwOGRcXHUxMDhmLVxcdTEwOWRcXHUxMzVkLVxcdTEzNWZcXHUxNzEyLVxcdTE3MTRcXHUxNzMyLVxcdTE3MzRcXHUxNzUyXFx1MTc1M1xcdTE3NzJcXHUxNzczXFx1MTdiNC1cXHUxN2QzXFx1MTdkZFxcdTE3ZTAtXFx1MTdlOVxcdTE4MGItXFx1MTgwZFxcdTE4MTAtXFx1MTgxOVxcdTE4YTlcXHUxOTIwLVxcdTE5MmJcXHUxOTMwLVxcdTE5M2JcXHUxOTQ2LVxcdTE5NGZcXHUxOWIwLVxcdTE5YzBcXHUxOWM4XFx1MTljOVxcdTE5ZDAtXFx1MTlkOVxcdTFhMTctXFx1MWExYlxcdTFhNTUtXFx1MWE1ZVxcdTFhNjAtXFx1MWE3Y1xcdTFhN2YtXFx1MWE4OVxcdTFhOTAtXFx1MWE5OVxcdTFiMDAtXFx1MWIwNFxcdTFiMzQtXFx1MWI0NFxcdTFiNTAtXFx1MWI1OVxcdTFiNmItXFx1MWI3M1xcdTFiODAtXFx1MWI4MlxcdTFiYTEtXFx1MWJhZFxcdTFiYjAtXFx1MWJiOVxcdTFiZTYtXFx1MWJmM1xcdTFjMjQtXFx1MWMzN1xcdTFjNDAtXFx1MWM0OVxcdTFjNTAtXFx1MWM1OVxcdTFjZDAtXFx1MWNkMlxcdTFjZDQtXFx1MWNlOFxcdTFjZWRcXHUxY2YyLVxcdTFjZjRcXHUxZGMwLVxcdTFkZTZcXHUxZGZjLVxcdTFkZmZcXHUyMDBjXFx1MjAwZFxcdTIwM2ZcXHUyMDQwXFx1MjA1NFxcdTIwZDAtXFx1MjBkY1xcdTIwZTFcXHUyMGU1LVxcdTIwZjBcXHUyY2VmLVxcdTJjZjFcXHUyZDdmXFx1MmRlMC1cXHUyZGZmXFx1MzAyYS1cXHUzMDJmXFx1MzA5OVxcdTMwOWFcXHVhNjIwLVxcdWE2MjlcXHVhNjZmXFx1YTY3NC1cXHVhNjdkXFx1YTY5ZlxcdWE2ZjBcXHVhNmYxXFx1YTgwMlxcdWE4MDZcXHVhODBiXFx1YTgyMy1cXHVhODI3XFx1YTg4MFxcdWE4ODFcXHVhOGI0LVxcdWE4YzRcXHVhOGQwLVxcdWE4ZDlcXHVhOGUwLVxcdWE4ZjFcXHVhOTAwLVxcdWE5MDlcXHVhOTI2LVxcdWE5MmRcXHVhOTQ3LVxcdWE5NTNcXHVhOTgwLVxcdWE5ODNcXHVhOWIzLVxcdWE5YzBcXHVhOWQwLVxcdWE5ZDlcXHVhYTI5LVxcdWFhMzZcXHVhYTQzXFx1YWE0Y1xcdWFhNGRcXHVhYTUwLVxcdWFhNTlcXHVhYTdiXFx1YWFiMFxcdWFhYjItXFx1YWFiNFxcdWFhYjdcXHVhYWI4XFx1YWFiZVxcdWFhYmZcXHVhYWMxXFx1YWFlYi1cXHVhYWVmXFx1YWFmNVxcdWFhZjZcXHVhYmUzLVxcdWFiZWFcXHVhYmVjXFx1YWJlZFxcdWFiZjAtXFx1YWJmOVxcdWZiMWVcXHVmZTAwLVxcdWZlMGZcXHVmZTIwLVxcdWZlMjZcXHVmZTMzXFx1ZmUzNFxcdWZlNGQtXFx1ZmU0ZlxcdWZmMTAtXFx1ZmYxOVxcdWZmM2ZdfFswLTldKSoiLCBMUkVfRkxBR19TVElDS1kpOwogIC8qIGNsYW5nLWZvcm1hdCBvbiAqLwogIHVpbnQ4X3QqIGJjOwogIEJPT0wgcmV0ID0gRkFMU0U7CiAgaWYoKGJjID0gcmVnZXhwX2NvbXBpbGUocmUsIGN0eCkpKSB7CgogICAgcmV0ID0gcmVnZXhwX21hdGNoKGJjLCBzdHIsIGxlbiwgY3R4KTsKICAgIGpzX2ZyZWUoY3R4LCBiYyk7CiAgfQoKICByZXR1cm4gcmV0Owp9CgpCT09MCmpzX2lzX2lkZW50aWZpZXJfYXRvbShKU0NvbnRleHQqIGN0eCwgSlNBdG9tIGF0b20pIHsKICBjb25zdCBjaGFyKiBzdHI7CiAgc2l6ZV90IGxlbjsKICBCT09MIHJldDsKICBzdHIgPSBqc19hdG9tX3RvX2NzdHJpbmdsZW4oY3R4LCAmbGVuLCBhdG9tKTsKICByZXQgPSBqc19pc19pZGVudGlmaWVyX2xlbihjdHgsIHN0ciwgbGVuKTsKICBKU19GcmVlQ1N0cmluZyhjdHgsIHN0cik7CiAgcmV0dXJuIHJldDsKfQoKSlNWYWx1ZQpqc19nZXRfdG9zdHJpbmd0YWdfdmFsdWUoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBvYmopIHsKICBKU0F0b20gdG9zdHJpbmdfdGFnID0ganNfc3ltYm9sX3N0YXRpY19hdG9tKGN0eCwgInRvU3RyaW5nVGFnIik7CiAgSlNWYWx1ZSByZXQgPSBKU19HZXRQcm9wZXJ0eShjdHgsIG9iaiwgdG9zdHJpbmdfdGFnKTsKICBKU19GcmVlQXRvbShjdHgsIHRvc3RyaW5nX3RhZyk7CiAgcmV0dXJuIHJldDsKfQoKdm9pZApqc19zZXRfdG9zdHJpbmd0YWdfdmFsdWUoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBvYmosIEpTVmFsdWUgdmFsdWUpIHsKICBKU0F0b20gdG9zdHJpbmdfdGFnID0ganNfc3ltYm9sX3N0YXRpY19hdG9tKGN0eCwgInRvU3RyaW5nVGFnIik7CiAgSlNfRGVmaW5lUHJvcGVydHlWYWx1ZShjdHgsIG9iaiwgdG9zdHJpbmdfdGFnLCB2YWx1ZSwgSlNfUFJPUF9DT05GSUdVUkFCTEUgfCBKU19QUk9QX1dSSVRBQkxFKTsKICBKU19GcmVlQXRvbShjdHgsIHRvc3RyaW5nX3RhZyk7Cn0KCnZvaWQKanNfc2V0X3Rvc3RyaW5ndGFnX3N0cihKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IG9iaiwgY29uc3QgY2hhciogc3RyKSB7CiAganNfc2V0X3Rvc3RyaW5ndGFnX3ZhbHVlKGN0eCwgb2JqLCBKU19OZXdTdHJpbmcoY3R4LCBzdHIpKTsKfQoKY29uc3QgY2hhcioKanNfZ2V0X3Rvc3RyaW5ndGFnX2NzdHIoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBvYmopIHsKICBKU1ZhbHVlIHRhZyA9IGpzX2dldF90b3N0cmluZ3RhZ192YWx1ZShjdHgsIG9iaik7CiAgY29uc3QgY2hhciogcmV0ID0gMDsKCiAgaWYoSlNfSXNTdHJpbmcodGFnKSkKICAgIHJldCA9IEpTX1RvQ1N0cmluZyhjdHgsIHRhZyk7CgogIEpTX0ZyZWVWYWx1ZShjdHgsIHRhZyk7CiAgcmV0dXJuIHJldDsKfQoKdHlwZWRlZiBzdHJ1Y3QgewogIENDbG9zdXJlRnVuYyogZnVuYzsKICB1aW50MTZfdCBsZW5ndGg7CiAgdWludDE2X3QgbWFnaWM7CiAgdm9pZCogb3BhcXVlOwogIHZvaWQgKCpvcGFxdWVfZmluYWxpemUpKHZvaWQqKTsKfSBDQ2xvc3VyZVJlY29yZDsKCnN0YXRpYyB0aHJlYWRfbG9jYWwgSlNDbGFzc0lEIGpzX2NjbG9zdXJlX2NsYXNzX2lkOwoKc3RhdGljIGlubGluZSBDQ2xvc3VyZVJlY29yZCoKanNfY2Nsb3N1cmVfZGF0YShKU1ZhbHVlQ29uc3QgdmFsdWUpIHsKICByZXR1cm4gSlNfR2V0T3BhcXVlKHZhbHVlLCBqc19jY2xvc3VyZV9jbGFzc19pZCk7Cn0KCnN0YXRpYyBpbmxpbmUgQ0Nsb3N1cmVSZWNvcmQqCmpzX2NjbG9zdXJlX2RhdGEyKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdmFsdWUpIHsKICByZXR1cm4gSlNfR2V0T3BhcXVlMihjdHgsIHZhbHVlLCBqc19jY2xvc3VyZV9jbGFzc19pZCk7Cn0KCnN0YXRpYyBKU1ZhbHVlCmpzX2NjbG9zdXJlX2NhbGwoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCBmdW5jX29iaiwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsLCBpbnQgYXJnYywgSlNWYWx1ZUNvbnN0IGFyZ3ZbXSwgaW50IGZsYWdzKSB7CiAgQ0Nsb3N1cmVSZWNvcmQqIGNjcjsKCiAgaWYoIShjY3IgPSBqc19jY2xvc3VyZV9kYXRhMihjdHgsIGZ1bmNfb2JqKSkpCiAgICByZXR1cm4gSlNfRVhDRVBUSU9OOwoKICBKU1ZhbHVlQ29uc3QqIGFyZ19idWY7CiAgaW50IGk7CgogIC8qIFhYWDogY291bGQgYWRkIHRoZSBmdW5jdGlvbiBvbiB0aGUgc3RhY2sgZm9yIGRlYnVnICovCiAgaWYodW5saWtlbHkoYXJnYyA8IGNjci0+bGVuZ3RoKSkgewogICAgYXJnX2J1ZiA9IGFsbG9jYShzaXplb2YoYXJnX2J1ZlswXSkgKiBjY3ItPmxlbmd0aCk7CiAgICBmb3IoaSA9IDA7IGkgPCBhcmdjOyBpKyspIGFyZ19idWZbaV0gPSBhcmd2W2ldOwogICAgZm9yKGkgPSBhcmdjOyBpIDwgY2NyLT5sZW5ndGg7IGkrKykgYXJnX2J1ZltpXSA9IEpTX1VOREVGSU5FRDsKICB9IGVsc2UgewogICAgYXJnX2J1ZiA9IGFyZ3Y7CiAgfQoKICByZXR1cm4gY2NyLT5mdW5jKGN0eCwgdGhpc192YWwsIGFyZ2MsIGFyZ19idWYsIGNjci0+bWFnaWMsIGNjci0+b3BhcXVlKTsKfQoKc3RhdGljIHZvaWQKanNfY2Nsb3N1cmVfZmluYWxpemVyKEpTUnVudGltZSogcnQsIEpTVmFsdWUgdmFsKSB7CiAgQ0Nsb3N1cmVSZWNvcmQqIGNjcjsKCiAgaWYoKGNjciA9IGpzX2NjbG9zdXJlX2RhdGEodmFsKSkpIHsKCiAgICBpZihjY3ItPm9wYXF1ZV9maW5hbGl6ZSkKICAgICAgY2NyLT5vcGFxdWVfZmluYWxpemUoY2NyLT5vcGFxdWUpOwoKICAgIGpzX2ZyZWVfcnQocnQsIGNjcik7CiAgfQp9CgpzdGF0aWMgSlNDbGFzc0RlZiBqc19jY2xvc3VyZV9jbGFzcyA9IHsKICAgIC5jbGFzc19uYW1lID0gIkpTQ0Nsb3N1cmUiLAogICAgLmZpbmFsaXplciA9IGpzX2NjbG9zdXJlX2ZpbmFsaXplciwKICAgIC5jYWxsID0ganNfY2Nsb3N1cmVfY2FsbCwKfTsKCkpTVmFsdWUKanNfZnVuY3Rpb25fY2Nsb3N1cmUoSlNDb250ZXh0KiBjdHgsIENDbG9zdXJlRnVuYyogZnVuYywgaW50IGxlbmd0aCwgaW50IG1hZ2ljLCB2b2lkKiBvcGFxdWUsIHZvaWQgKCpvcGFxdWVfZmluYWxpemUpKHZvaWQqKSkgewogIENDbG9zdXJlUmVjb3JkKiBjY3I7CiAgSlNWYWx1ZSBmdW5jX3Byb3RvLCBmdW5jX29iajsKCiAgaWYoanNfY2Nsb3N1cmVfY2xhc3NfaWQgPT0gMCkgewogICAgSlNfTmV3Q2xhc3NJRCgmanNfY2Nsb3N1cmVfY2xhc3NfaWQpOwogICAgSlNfTmV3Q2xhc3MoSlNfR2V0UnVudGltZShjdHgpLCBqc19jY2xvc3VyZV9jbGFzc19pZCwgJmpzX2NjbG9zdXJlX2NsYXNzKTsKICB9CgogIGZ1bmNfcHJvdG8gPSBqc19mdW5jdGlvbl9wcm90b3R5cGUoY3R4KTsKICBmdW5jX29iaiA9IEpTX05ld09iamVjdFByb3RvQ2xhc3MoY3R4LCBmdW5jX3Byb3RvLCBqc19jY2xvc3VyZV9jbGFzc19pZCk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgZnVuY19wcm90byk7CgogIGlmKEpTX0lzRXhjZXB0aW9uKGZ1bmNfb2JqKSkKICAgIHJldHVybiBmdW5jX29iajsKCiAgaWYoIShjY3IgPSBqc19tYWxsb2MoY3R4LCBzaXplb2YoQ0Nsb3N1cmVSZWNvcmQpKSkpIHsKICAgIEpTX0ZyZWVWYWx1ZShjdHgsIGZ1bmNfb2JqKTsKICAgIHJldHVybiBKU19FWENFUFRJT047CiAgfQoKICBjY3ItPmZ1bmMgPSBmdW5jOwogIGNjci0+bGVuZ3RoID0gbGVuZ3RoOwogIGNjci0+bWFnaWMgPSBtYWdpYzsKICBjY3ItPm9wYXF1ZSA9IG9wYXF1ZTsKICBjY3ItPm9wYXF1ZV9maW5hbGl6ZSA9IG9wYXF1ZV9maW5hbGl6ZTsKCiAgSlNfU2V0T3BhcXVlKGZ1bmNfb2JqLCBjY3IpOwoKICAvLyBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgZnVuY19vYmosICJsZW5ndGgiLCBKU19OZXdVaW50MzIoY3R4LCBsZW5ndGgpLCBKU19QUk9QX0NPTkZJR1VSQUJMRSk7CgogIHJldHVybiBmdW5jX29iajsKfQoKLyoqCiAqIEB9CiAqLwoAAAAAAAAAALhsAQAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAmjABAAAAAACaMAEAAAAAAAAAAAAAAPC/"
				]
			]
		},
		{
			"file": "quickjs/qjs-modules/tests/test_lexer.js",
			"settings":
			{
				"buffer_size": 14983,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					30,
					1,
					"left_delete",
					null,
					"AQAAADYCAAAAAAAANgIAAAAAAAABAAAAIA",
					"AQAAAAAAAAABAAAANwIAAAAAAAA3AgAAAAAAAAAAAAAAAPC/"
				],
				[
					31,
					1,
					"insert",
					{
						"characters": ",startInteractive"
					},
					"EQAAADYCAAAAAAAANwIAAAAAAAAAAAAANwIAAAAAAAA4AgAAAAAAAAAAAAA4AgAAAAAAADkCAAAAAAAAAAAAADkCAAAAAAAAOgIAAAAAAAAAAAAAOgIAAAAAAAA7AgAAAAAAAAAAAAA7AgAAAAAAADwCAAAAAAAAAAAAADwCAAAAAAAAPQIAAAAAAAAAAAAAPQIAAAAAAAA+AgAAAAAAAAAAAAA+AgAAAAAAAD8CAAAAAAAAAAAAAD8CAAAAAAAAQAIAAAAAAAAAAAAAQAIAAAAAAABBAgAAAAAAAAAAAABBAgAAAAAAAEICAAAAAAAAAAAAAEICAAAAAAAAQwIAAAAAAAAAAAAAQwIAAAAAAABEAgAAAAAAAAAAAABEAgAAAAAAAEUCAAAAAAAAAAAAAEUCAAAAAAAARgIAAAAAAAAAAAAARgIAAAAAAABHAgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAANgIAAAAAAAA2AgAAAAAAAAAAAAAAAPC/"
				],
				[
					43,
					1,
					"insert",
					{
						"characters": "\nstartInteractive89"
					},
					"FAAAACA6AAAAAAAAIToAAAAAAAAAAAAAIToAAAAAAAAjOgAAAAAAAAAAAAAjOgAAAAAAACQ6AAAAAAAAAAAAACQ6AAAAAAAAJToAAAAAAAAAAAAAJToAAAAAAAAmOgAAAAAAAAAAAAAmOgAAAAAAACc6AAAAAAAAAAAAACc6AAAAAAAAKDoAAAAAAAAAAAAAKDoAAAAAAAApOgAAAAAAAAAAAAApOgAAAAAAACo6AAAAAAAAAAAAACo6AAAAAAAAKzoAAAAAAAAAAAAAKzoAAAAAAAAsOgAAAAAAAAAAAAAsOgAAAAAAAC06AAAAAAAAAAAAAC06AAAAAAAALjoAAAAAAAAAAAAALjoAAAAAAAAvOgAAAAAAAAAAAAAvOgAAAAAAADA6AAAAAAAAAAAAADA6AAAAAAAAMToAAAAAAAAAAAAAMToAAAAAAAAyOgAAAAAAAAAAAAAyOgAAAAAAADM6AAAAAAAAAAAAADM6AAAAAAAANDoAAAAAAAAAAAAANDoAAAAAAAA1OgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAIDoAAAAAAAAgOgAAAAAAAAAAAAAAAPC/"
				],
				[
					44,
					2,
					"left_delete",
					null,
					"AgAAADQ6AAAAAAAANDoAAAAAAAABAAAAOTM6AAAAAAAAMzoAAAAAAAABAAAAOA",
					"AQAAAAAAAAABAAAANToAAAAAAAA1OgAAAAAAAAAAAAAAAPC/"
				],
				[
					45,
					1,
					"insert_snippet",
					{
						"contents": "($0)"
					},
					"AQAAADM6AAAAAAAANToAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAMzoAAAAAAAAzOgAAAAAAAAAAAAAAAPC/"
				],
				[
					47,
					1,
					"insert",
					{
						"characters": ";"
					},
					"AQAAADU6AAAAAAAANjoAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAANToAAAAAAAA1OgAAAAAAAAAAAAAAAPC/"
				],
				[
					50,
					1,
					"insert",
					{
						"characters": "//"
					},
					"AgAAADk6AAAAAAAAOjoAAAAAAAAAAAAAOjoAAAAAAAA7OgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAOToAAAAAAAA5OgAAAAAAAAAAAAAAADJA"
				],
				[
					83,
					1,
					"insert",
					{
						"characters": "globalThis."
					},
					"CwAAADMgAAAAAAAANCAAAAAAAAAAAAAANCAAAAAAAAA1IAAAAAAAAAAAAAA1IAAAAAAAADYgAAAAAAAAAAAAADYgAAAAAAAANyAAAAAAAAAAAAAANyAAAAAAAAA4IAAAAAAAAAAAAAA4IAAAAAAAADkgAAAAAAAAAAAAADkgAAAAAAAAOiAAAAAAAAAAAAAAOiAAAAAAAAA7IAAAAAAAAAAAAAA7IAAAAAAAADwgAAAAAAAAAAAAADwgAAAAAAAAPSAAAAAAAAAAAAAAPSAAAAAAAAA+IAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAMyAAAAAAAAAzIAAAAAAAAAAAAAAAAPC/"
				],
				[
					84,
					1,
					"insert",
					{
						"characters": "lexer"
					},
					"BQAAAD4gAAAAAAAAPyAAAAAAAAAAAAAAPyAAAAAAAABAIAAAAAAAAAAAAABAIAAAAAAAAEEgAAAAAAAAAAAAAEEgAAAAAAAAQiAAAAAAAAAAAAAAQiAAAAAAAABDIAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAPiAAAAAAAAA+IAAAAAAAAAAAAAAAAPC/"
				],
				[
					85,
					1,
					"insert",
					{
						"characters": " ="
					},
					"AgAAAEMgAAAAAAAARCAAAAAAAAAAAAAARCAAAAAAAABFIAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAQyAAAAAAAABDIAAAAAAAAAAAAAAAAPC/"
				],
				[
					86,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAEUgAAAAAAAARiAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAARSAAAAAAAABFIAAAAAAAAAAAAAAAAPC/"
				],
				[
					89,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAACFOgAAaW1wb3J0ICogYXMgb3MgZnJvbSAnb3MnOwppbXBvcnQgKiBhcyBzdGQgZnJvbSAnc3RkJzsKaW1wb3J0IGZzIGZyb20gJ2ZzJzsKaW1wb3J0IGluc3BlY3QgZnJvbSAnaW5zcGVjdCc7CmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7CmltcG9ydCB7IFByZWRpY2F0ZSB9IGZyb20gJ3ByZWRpY2F0ZSc7CmltcG9ydCB7IExvY2F0aW9uLCBMZXhlciwgVG9rZW4gfSBmcm9tICdsZXhlcic7CmltcG9ydCB7IENvbnNvbGUgfSBmcm9tICdjb25zb2xlJzsKaW1wb3J0IEVDTUFTY3JpcHRMZXhlciBmcm9tICcuLi9saWIvbGV4ZXIvZWNtYXNjcmlwdC5qcyc7CmltcG9ydCBDTGV4ZXIgZnJvbSAnLi4vbGliL2xleGVyL2MuanMnOwppbXBvcnQgQk5GTGV4ZXIgZnJvbSAnLi4vbGliL2xleGVyL2JuZi5qcyc7CmltcG9ydCBDU1ZMZXhlciBmcm9tICcuLi9saWIvbGV4ZXIvY3N2LmpzJzsKaW1wb3J0IHsgZXNjYXBlLCBxdW90ZSwgdG9TdHJpbmcgfSBmcm9tICdtaXNjJzsKaW1wb3J0IHsgZGVmaW5lLCBjdXJyeSwgdW5pcXVlLCBzcGxpdCwgZXh0ZW5kQXJyYXksIGlzT2JqZWN0LCBnZXRPcHQsIGtleXMsc3RhcnRJbnRlcmFjdGl2ZX0gZnJvbSAndXRpbCc7CmltcG9ydCB7IG1tYXAsIG11bm1hcCwgUFJPVF9SRUFELCBQUk9UX1dSSVRFLCBNQVBfUFJJVkFURSwgTUFQX1NIQVJFRCwgTUFQX0FOT05ZTU9VUyB9IGZyb20gJ21tYXAnOwppbXBvcnQgeyBUcnlDYXRjaCB9IGZyb20gJy4uL2xpYi9wYXJzZXIvZWJuZi5qcyc7CgooJ3VzZSBzdHJpY3QnKTsKKCd1c2UgbWF0aCcpOwoKbGV0IGJ1ZmZlcnMgPSB7fSwKICBtb2R1bGVzID0ge307CgpsZXQgVDsKCmV4dGVuZEFycmF5KEFycmF5LnByb3RvdHlwZSk7Cgpjb25zdCBBZGRVbmlxdWUgPSAoYXJyLCBpdGVtKSA9PiAoYXJyLmluZGV4T2YoaXRlbSkgPT0gLTEgPyBhcnIucHVzaChpdGVtKSA6IG51bGwpOwpjb25zdCBJbnRUb0RXb3JkID0gaXZhbCA9PiAoaXNOYU4oaXZhbCkgPT09IGZhbHNlICYmIGl2YWwgPCAwID8gaXZhbCArIDQyOTQ5NjcyOTYgOiBpdmFsKTsKY29uc3QgSW50VG9CaW5hcnkgPSBpID0+IChpID09IC0xIHx8IHR5cGVvZiBpICE9ICdudW1iZXInID8gaSA6ICcwYicgKyBJbnRUb0RXb3JkKGkpLnRvU3RyaW5nKDIpKTsKY29uc3QgY29kZSA9IFsKICAiY29uc3Qgc3RyID0gc3RhY2sudG9TdHJpbmcoKS5yZXBsYWNlKC9cXG5cXHMqYXQgL2csICdcXG4nKTsiLAogICcvUmVnLipFeC9pLnRlc3QobiknLAogICcvXFxuL2cnLAogICdjb25zdCBbbWF0Y2gsIHBhdHRlcm4sIGZsYWdzXSA9IC9eXFwvKC4qKVxcLyhbYS16XSopJC8uZXhlYyh0b2tlbi52YWx1ZSk7JywKICAnL15cXHNcXCgoLiopOihbMC05XSopOihbMC05XSopXFwpJC8uZXhlYyhsaW5lKTsnCl07Cgpjb25zdCBidWZmZXJSZWYgPSBuZXcgV2Vha01hcCgpOwoKZnVuY3Rpb24gQnVmZmVyRmlsZShmaWxlKSB7CiAgY29uc29sZS5sb2coJ0J1ZmZlckZpbGUnLCBmaWxlKTsKICBpZihidWZmZXJzW2ZpbGVdKSByZXR1cm4gYnVmZmVyc1tmaWxlXTsKICBsZXQgYiA9IChidWZmZXJzW2ZpbGVdID0gZnMucmVhZEZpbGVTeW5jKGZpbGUsIHsgZmxhZzogJ3InIH0pKTsKICBpZighaXNPYmplY3QoYikpIHsKICAgIGNvbnN0IHNpemUgPSBmcy5zaXplU3luYyhmaWxlKTsKICAgIGlmKHNpemUgPCAwKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignRXJyb3IgZ2V0dGluZyBzaXplIG9mICcgKyBmaWxlICsgJzogKCcgKyBmcy5lcnJubyArICcpICcgKyBmcy5lcnJzdHIpOwogICAgfQogICAgY29uc3QgZmQgPSBvcy5vcGVuKGZpbGUsIG9zLk9fUkRPTkxZKTsKICAgIGNvbnNvbGUubG9nKCdtbWFwJywgWzAsIHNpemUsIFBST1RfUkVBRCwgTUFQX1BSSVZBVEUsIGZkLCAwXSk7CiAgICBiID0gbW1hcCgwLCBzaXplLCBQUk9UX1JFQUQsIE1BUF9QUklWQVRFLCBmZCwgMCk7CiAgfQogIGJ1ZmZlclJlZi5zZXQoYiwgZmlsZSk7CiAgcmV0dXJuIGJ1ZmZlcnNbZmlsZV07Cn0KCmZ1bmN0aW9uIEJ1ZmZlckxlbmd0aHMoZmlsZSkgewogIHJldHVybiBidWZmZXJzW2ZpbGVdLm1hcChiID0+IGIuYnl0ZUxlbmd0aCk7Cn0KCmZ1bmN0aW9uIEJ1ZmZlck9mZnNldHMoZmlsZSkgewogIHJldHVybiBidWZmZXJzW2ZpbGVdLnJlZHVjZSgoW3BvcywgbGlzdF0sIGIpID0+IFtwb3MgKyBiLmJ5dGVMZW5ndGgsIGxpc3QuY29uY2F0KFtwb3NdKV0sIFswLCBbXV0pWzFdOwp9CgpmdW5jdGlvbiBCdWZmZXJSYW5nZXMoZmlsZSkgewogIHJldHVybiBidWZmZXJzW2ZpbGVdLnJlZHVjZSgoW3BvcywgbGlzdF0sIGIpID0+IFtwb3MgKyBiLmJ5dGVMZW5ndGgsIGxpc3QuY29uY2F0KFtbcG9zLCBiLmJ5dGVMZW5ndGhdXSldLCBbMCwgW11dKVsxXTsKfQoKZnVuY3Rpb24gV3JpdGVGaWxlKGZpbGUsIHRvaykgewogIGxldCBmID0gc3RkLm9wZW4oZmlsZSwgJ3crJyk7CiAgZi5wdXRzKHRvayk7CiAgY29uc29sZS5sb2coJ1dyb3RlICInICsgZmlsZSArICciOiAnICsgdG9rLmxlbmd0aCArICcgYnl0ZXMnKTsKfQoKZnVuY3Rpb24gRHVtcExleGVyKGxleCkgewogIGNvbnN0IHsgc2l6ZSwgcG9zLCBzdGFydCwgbGluZSwgY29sdW1uLCBsaW5lU3RhcnQsIGxpbmVFbmQsIGNvbHVtbkluZGV4IH0gPSBsZXg7CiAgcmV0dXJuICdMZXhlciAnICsgaW5zcGVjdCh7IHN0YXJ0LCBwb3MsIHNpemUgfSk7Cn0KCmZ1bmN0aW9uIER1bXBUb2tlbih0b2spIHsKICBjb25zdCB7IGxlbmd0aCwgb2Zmc2V0LCBjaGFycywgbG9jIH0gPSB0b2s7CiAgcmV0dXJuIGDimIUgVG9rZW4gJHtpbnNwZWN0KHsgY2hhcnMsIG9mZnNldCwgbGVuZ3RoLCBsb2MgfSwgeyBkZXB0aDogMSB9KX1gOwp9Cgpjb25zdCBXaGF0ID0gewogIElNUE9SVDogMCwKICBFWFBPUlQ6IDEKfTsKCmNvbnN0IEltcG9ydFR5cGVzID0gewogIElNUE9SVDogMCwKICBJTVBPUlRfREVGQVVMVDogMSwKICBJTVBPUlRfTkFNRVNQQUNFOiAyCn07Cgpjb25zdCBUb2tJcyA9IGN1cnJ5KCh0eXBlLCBsZXhlbWUsIHRvaykgPT4gewogIGlmKGxleGVtZSAhPSB1bmRlZmluZWQpIHsKICAgIGlmKHR5cGVvZiBsZXhlbWUgPT0gJ3N0cmluZycgJiYgdG9rLmxleGVtZSAhPSBsZXhlbWUpIHJldHVybiBmYWxzZTsKICAgIGVsc2UgaWYoQXJyYXkuaXNBcnJheShsZXhlbWUpICYmIGxleGVtZS5pbmRleE9mKHRvay5sZXhlbWUpID09IC0xKSByZXR1cm4gZmFsc2U7CiAgfQogIGlmKHR5cGUgIT0gdW5kZWZpbmVkKSB7CiAgICBpZih0eXBlb2YgdHlwZSA9PSAnc3RyaW5nJyAmJiB0b2sudHlwZSAhPSB0eXBlKSByZXR1cm4gZmFsc2U7CiAgICBpZih0eXBlb2YgdHlwZSA9PSAnbnVtYmVyJyAmJiB0b2suaWQgIT0gdHlwZSkgcmV0dXJuIGZhbHNlOwogIH0KICByZXR1cm4gdHJ1ZTsKfSk7Cgpjb25zdCBJc0tleXdvcmQgPSBUb2tJcygna2V5d29yZCcpOwpjb25zdCBJc1B1bmN0dWF0b3IgPSBUb2tJcygncHVuY3R1YXRvcicpOwpjb25zdCBJc0lkZW50aWZpZXIgPSBUb2tJcygnaWRlbnRpZmllcicpOwpjb25zdCBJc1N0cmluZ0xpdGVyYWwgPSBUb2tJcygnc3RyaW5nTGl0ZXJhbCcpOwoKZnVuY3Rpb24gSW1wb3J0VHlwZShzZXEpIHsKICBpZihJc0tleXdvcmQoJ2ltcG9ydCcsIHNlcVswXSkpIHNlcS5zaGlmdCgpOwogIGlmKElzUHVuY3R1YXRvcignKicsIHNlcVswXSkpIHsKICAgIGlmKElzS2V5d29yZCgnYXMnLCBzZXFbMV0pKSByZXR1cm4gSW1wb3J0VHlwZXMuSU1QT1JUX05BTUVTUEFDRTsKICB9IGVsc2UgaWYoSXNJZGVudGlmaWVyKHVuZGVmaW5lZCwgc2VxWzBdKSkgewogICAgaWYoSXNLZXl3b3JkKCdmcm9tJywgc2VxWzFdKSkgcmV0dXJuIEltcG9ydFR5cGVzLklNUE9SVF9ERUZBVUxUOwogIH0KICByZXR1cm4gSW1wb3J0VHlwZXMuSU1QT1JUOwp9CgpmdW5jdGlvbiBJbXBvcnRGaWxlKHNlcSkgewogIGxldCBpZHggPSBzZXEuZmluZEluZGV4KHRvayA9PiBJc0tleXdvcmQoJ2Zyb20nLCB0b2spKTsKICB3aGlsZShzZXFbaWR4XSAmJiBzZXFbaWR4XS50eXBlICE9ICdzdHJpbmdMaXRlcmFsJykgKytpZHg7CiAgcmV0dXJuIHNlcVtpZHhdLmxleGVtZS5yZXBsYWNlKC9eWyciYF0oLiopWyciYF0kL2csICckMScpOwp9CgpmdW5jdGlvbiBFeHBvcnROYW1lKHNlcSkgewogIGxldCBpZHggPSBzZXEuZmluZEluZGV4KHRvayA9PiBJc0lkZW50aWZpZXIodW5kZWZpbmVkLCB0b2spIHx8IElzS2V5d29yZCgnZGVmYXVsdCcsIHRvaykpOwogIHJldHVybiBzZXFbaWR4XT8ubGV4ZW1lOwp9CgpmdW5jdGlvbiBBZGRFeHBvcnQodG9rZW5zKSB7CiAgbGV0IGNvZGUgPSB0b2tlbnMubWFwKHRvayA9PiB0b2subGV4ZW1lKS5qb2luKCcnKTsKICB0b2tlbnMgPSB0b2tlbnMuZmlsdGVyKHRvayA9PiB0b2sudHlwZSAhPSAnd2hpdGVzcGFjZScpOwogIGxldCBsZW4gPSB0b2tlbnMuZmluZEluZGV4KHRvayA9PiBJc0lkZW50aWZpZXIodW5kZWZpbmVkLCB0b2spIHx8IElzS2V5d29yZCgnZGVmYXVsdCcsIHRvaykpICsgMTsKICB0b2tlbnMgPSB0b2tlbnMuc2xpY2UoMCwgbGVuKTsKICBsZXQgZXhwID0gZGVmaW5lKAogICAgewogICAgICB0eXBlOiB0b2tlbnNbMV0/LmxleGVtZSwKICAgICAgdG9rZW5zLAogICAgICBleHBvcnRlZDogRXhwb3J0TmFtZSh0b2tlbnMpLAogICAgICByYW5nZTogWyt0b2tlbnNbMF0/LmxvYywgK3Rva2Vucy5sYXN0Py5sb2NdCiAgICB9LAogICAgeyBjb2RlLCBsb2M6IHRva2Vuc1swXT8ubG9jIH0KICApOwogIHJldHVybiBleHA7Cn0KCmZ1bmN0aW9uIEFkZEltcG9ydCh0b2tlbnMpIHsKICBsZXQgcmFuZ2UgPSBbK3Rva2Vuc1swXS5sb2MsICt0b2tlbnMubGFzdC5sb2NdOwogIGxldCBjb2RlID0gdG9rZW5zLm1hcCh0b2sgPT4gdG9rLmxleGVtZSkuam9pbignJyk7CiAgdG9rZW5zID0gdG9rZW5zLmZpbHRlcih0b2sgPT4gdG9rLnR5cGUgIT0gJ3doaXRlc3BhY2UnKTsKICBsZXQgdHlwZSA9IEltcG9ydFR5cGUodG9rZW5zKTsKICBsZXQgZmlsZSA9IEltcG9ydEZpbGUodG9rZW5zKTsKICBjb25zdCB7IGxvYywgc2VxIH0gPSB0b2tlbnNbMF07CiAgbGV0IGltcCA9IGRlZmluZSh7IHR5cGUsIGZpbGUsIGxvYywgc2VxLCByYW5nZSB9LCB7IHRva2VucywgY29kZSB9KTsKICBpbXAubG9jYWwgPSB7CiAgICBbSW1wb3J0VHlwZXMuSU1QT1JUX05BTUVTUEFDRV06ICgpID0+IHsKICAgICAgbGV0IGlkeCA9IHRva2Vucy5maW5kSW5kZXgodG9rID0+IElzS2V5d29yZCgnYXMnLCB0b2spKTsKICAgICAgcmV0dXJuIHRva2Vuc1tpZHggKyAxXS5sZXhlbWU7CiAgICB9LAogICAgW0ltcG9ydFR5cGVzLklNUE9SVF9ERUZBVUxUXTogKCkgPT4gewogICAgICBsZXQgaWR4ID0gdG9rZW5zLmZpbmRJbmRleCh0b2sgPT4gSXNLZXl3b3JkKCdpbXBvcnQnLCB0b2spKTsKICAgICAgcmV0dXJuIHRva2Vuc1tpZHggKyAxXS5sZXhlbWU7CiAgICB9LAogICAgW0ltcG9ydFR5cGVzLklNUE9SVF06ICgpID0+IHsKICAgICAgbGV0IGlkeCA9IDA7CiAgICAgIGxldCBzcGVjaWZpZXIgPSBbXTsKICAgICAgbGV0IHNwZWNpZmllcnMgPSBbXTsKICAgICAgaWYoSXNLZXl3b3JkKCdpbXBvcnQnLCB0b2tlbnNbaWR4XSkpICsraWR4OwogICAgICBpZihJc1B1bmN0dWF0b3IoJ3snLCB0b2tlbnNbaWR4XSkpICsraWR4OwogICAgICBmb3IoOyAhSXNLZXl3b3JkKCdmcm9tJywgdG9rZW5zW2lkeF0pOyArK2lkeCkgewogICAgICAgIGlmKElzUHVuY3R1YXRvcihbJywnLCAnfSddLCB0b2tlbnNbaWR4XSkpIHsKICAgICAgICAgIGlmKHNwZWNpZmllci5sZW5ndGgpIHNwZWNpZmllcnMucHVzaChzcGVjaWZpZXIpOwogICAgICAgICAgc3BlY2lmaWVyID0gW107CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHNwZWNpZmllci5wdXNoKHRva2Vuc1tpZHhdLmxleGVtZSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBzcGVjaWZpZXJzOwogICAgfQogIH1bdHlwZV0oKTsKICByZXR1cm4gaW1wOwp9CgpmdW5jdGlvbiBQcmludEVTNkltcG9ydChpbXApIHsKICByZXR1cm4gewogICAgW0ltcG9ydFR5cGVzLklNUE9SVF9OQU1FU1BBQ0VdOiAoeyBsb2NhbCwgZmlsZSB9KSA9PiBgaW1wb3J0ICogYXMgJHtsb2NhbH0gZnJvbSAnJHtmaWxlfSc7YCwKICAgIFtJbXBvcnRUeXBlcy5JTVBPUlRfREVGQVVMVF06ICh7IGxvY2FsLCBmaWxlIH0pID0+IGBpbXBvcnQgJHtsb2NhbH0gZnJvbSAnJHtmaWxlfSc7YCwKICAgIFtJbXBvcnRUeXBlcy5JTVBPUlRdOiAoeyBsb2NhbCwgZmlsZSB9KSA9PiBgaW1wb3J0IHsgJHtsb2NhbC5qb2luKCcsICcpfSB9IGZyb20gJyR7ZmlsZX0nO2AKICB9W2ltcC50eXBlXShpbXApOwp9CgpmdW5jdGlvbiBQcmludENKU0ltcG9ydCh7IHR5cGUsIGxvY2FsLCBmaWxlIH0pIHsKICByZXR1cm4gewogICAgW0ltcG9ydFR5cGVzLklNUE9SVF9OQU1FU1BBQ0VdOiAoKSA9PiBgY29uc3QgJHtsb2NhbH0gPSByZXF1aXJlKCcke2ZpbGV9Jyk7YCwKICAgIFtJbXBvcnRUeXBlcy5JTVBPUlRfREVGQVVMVF06ICgpID0+IGBjb25zdCAke2xvY2FsfSA9IHJlcXVpcmUoJyR7ZmlsZX0nKTtgLAogICAgW0ltcG9ydFR5cGVzLklNUE9SVF06ICgpID0+IGBjb25zdCB7ICR7bG9jYWwuam9pbignLCAnKX0gfSA9IHJlcXVpcmUoJyR7ZmlsZX0nKTtgCiAgfVt0eXBlXSgpOwp9CgpmdW5jdGlvbiBtYWluKC4uLmFyZ3MpIHsKICBnbG9iYWxUaGlzLmNvbnNvbGUgPSBuZXcgQ29uc29sZShwcm9jZXNzLnN0ZGVyciwgewogICAgaW5zcGVjdE9wdGlvbnM6IHsKICAgICAgY29sb3JzOiB0cnVlLAogICAgICBkZXB0aDogOCwKICAgICAgYnJlYWtMZW5ndGg6IDE2MCwKICAgICAgbWF4U3RyaW5nTGVuZ3RoOiBJbmZpbml0eSwKICAgICAgbWF4QXJyYXlMZW5ndGg6IEluZmluaXR5LAogICAgICBjb21wYWN0OiAxLAogICAgICBzdHJpbmdCcmVha05ld2xpbmU6IGZhbHNlLAogICAgICBoaWRlS2V5czogW1N5bWJvbC50b1N0cmluZ1RhZ10KICAgIH0KICB9KTsKICBjb25zb2xlLmxvZygnYXJncycsIGFyZ3MpOwogIGxldCBvcHRpbmQgPSAwOwogIGxldCBjb2RlID0gJ2MnOwogIGxldCBkZWJ1ZywKICAgIGZpbGVzID0gW107CiAgbGV0IHBhcmFtcyA9IGdldE9wdCgKICAgIHsKICAgICAgb3V0cHV0OiBbdHJ1ZSwgbnVsbCwgJ28nXSwKICAgICAgcmVjdXJzaXZlOiBbZmFsc2UsIG51bGwsICdyJ10sCiAgICAgIGluY2x1ZGU6IFt0cnVlLCBudWxsLCAnaSddLAogICAgICBleGNsdWRlOiBbdHJ1ZSwgbnVsbCwgJ3gnXSwKICAgICAgb3V0cHV0SW1wczogW2ZhbHNlLCBudWxsLCAnSSddLAogICAgICBvdXRwdXRUZXh0OiBbZmFsc2UsIG51bGwsICdUJ10sCiAgICAgIGRlYnVnOiBbZmFsc2UsICgpID0+IChkZWJ1ZyA9IChkZWJ1ZyB8IDApICsgMSksICd4J10sCiAgICAgICdAJzogJ2ZpbGUnCiAgICB9LAogICAgYXJncwogICk7CiAgZmlsZXMgPSBwYXJhbXNbJ0AnXTsKICBjb25zb2xlLmxvZygnZmlsZXMnLCBmaWxlcyk7CiAgY29uc3QgUmVsYXRpdmVQYXRoID0gZmlsZSA9PiBwYXRoLmpvaW4ocGF0aC5kaXJuYW1lKHByb2Nlc3MuYXJndlsxXSksICcuLicsIGZpbGUpOwoKICBpZighZmlsZXMubGVuZ3RoKSBmaWxlcy5wdXNoKFJlbGF0aXZlUGF0aCgnbGliL3V0aWwuanMnKSk7CiAgZm9yKGxldCBmaWxlIG9mIGZpbGVzKSBQcm9jZXNzRmlsZShmaWxlKTsKCiAgZnVuY3Rpb24gUHJvY2Vzc0ZpbGUoZmlsZSkgewogICAgY29uc29sZS5sb2coYExvYWRpbmcgJyR7ZmlsZX0nLi4uYCk7CiAgICBjb25zdCBsb2cgPSAoLi4uYXJncykgPT4gY29uc29sZS5sb2coYCR7ZmlsZX06YCwgLi4uYXJncyk7CiAgICBsZXQgc3RyID0gZmlsZSA/IEJ1ZmZlckZpbGUoZmlsZSkgOiBjb2RlWzFdOwoKICAgIGxldCBsZW4gPSBzdHIubGVuZ3RoOwogICAgbGV0IHR5cGUgPSBwYXRoLmV4dG5hbWUoZmlsZSkuc3Vic3RyaW5nKDEpOwogICAgbG9nKCdkYXRhOicsIGVzY2FwZShzdHIuc2xpY2UoMCwgMTAwKSkpOwogICAgbGV0IGxleCA9IHsKICAgICAganM6IG5ldyBFQ01BU2NyaXB0TGV4ZXIoc3RyLCBmaWxlKSwKICAgICAgYzogbmV3IENMZXhlcihzdHIsIENMZXhlci5MT05HRVNULCBmaWxlKSwKICAgICAgYm5mOiBuZXcgQk5GTGV4ZXIoc3RyLCBmaWxlKSwKICAgICAgY3N2OiBuZXcgQ1NWTGV4ZXIoc3RyLCBmaWxlKQogICAgfTsKICAgIGxleC5oID0gbGV4LmM7CiAgICBsZXguZzQgPSBsZXguYm5mOwogICAgbGV4LmVibmYgPSBsZXguYm5mOwogICAgbGV4LmwgPSBsZXguYm5mOwogICAgbGV4LnkgPSBsZXguYm5mOwogICAgbGV4Lmpzb24gPSBsZXguanM7CiAgICBjb25zdCBsZXhlciA9IGdsb2JhbFRoaXMubGV4ZXIgPSBsZXhbdHlwZV07CgogICAgY29uc29sZS5sb2coJ2xleGVyJywgbGV4ZXIpOwogICAgVCA9IGxleGVyLnRva2Vucy5yZWR1Y2UoKGFjYywgbmFtZSwgaWQpID0+ICh7IC4uLmFjYywgW25hbWVdOiBpZCB9KSwge30pOwoKICAgIGxvZygnbGV4ZXI6JywgbGV4ZXIuY29uc3RydWN0b3IubmFtZSk7CiAgICAvL2xvZygnbGV4ZXIudG9rZW5zOicsIGxleGVyLnRva2Vucyk7CiAgICBsb2coJ2NvZGU6JywgY29kZSk7CgogICAgbGV4ZXIuaGFuZGxlciA9IGxleCA9PiB7CiAgICAgIGNvbnN0IHsgbG9jLCBtb2RlLCBwb3MsIHN0YXJ0LCBieXRlTGVuZ3RoLCBzdGF0ZSB9ID0gbGV4OwogICAgICBsb2coJyAnLnJlcGVhdChsb2MuY29sdW1uIC0gMSkgKyAnXicpOwogICAgfTsKICAgIGxldCB0b2tlbkxpc3QgPSBbXSwKICAgICAgZGVjbGFyYXRpb25zID0gW107CiAgICBjb25zdCBjb2xTaXplcyA9IFsxMiwgOCwgNCwgMjAsIDMyLCAxMCwgMF07CgogICAgbGV0IGluY2x1ZGUgPSAoKHBhcmFtcy5pbmNsdWRlID8/ICcnKSArICcnKQogICAgICAuc3BsaXQoL1ssXHNdKy9nKQogICAgICAuZmlsdGVyKGkgPT4gaSBpbiBsZXhlci5ydWxlcyB8fCAhaXNOYU4oK2kpKQogICAgICAubWFwKGkgPT4gKGkgaW4gbGV4ZXIucnVsZXMgPyBsZXhlci5ydWxlc1tpXSA6IGkpKTsKCiAgICBsZXQgZXhjbHVkZSA9ICgocGFyYW1zLmV4Y2x1ZGUgPz8gJycpICsgJycpCiAgICAgIC5zcGxpdCgvWyxcc10rL2cpCiAgICAgIC5maWx0ZXIoaSA9PiBpIGluIGxleGVyLnJ1bGVzIHx8ICFpc05hTigraSkpCiAgICAgIC5tYXAoaSA9PiAoaSBpbiBsZXhlci5ydWxlcyA/IGxleGVyLnJ1bGVzW2ldIDogaSkpOwoKICAgIGxldCBtYXRjaCA9CiAgICAgIGluY2x1ZGUubGVuZ3RoICsgZXhjbHVkZS5sZW5ndGggPiAwCiAgICAgICAgPyBpZCA9PiB7CiAgICAgICAgICAgIGlmKGV4Y2x1ZGUuY29udGFpbnMoaWQpKSByZXR1cm4gZmFsc2U7CgogICAgICAgICAgICAvLyAgcmV0dXJuIChpbmNsdWRlLmxlbmd0aCA9PSAwIHx8IGluY2x1ZGUuY29udGFpbnMoaWQpKSAmJiAhZXhjbHVkZS5jb250YWlucyhpZCk7CiAgICAgICAgICAgIHJldHVybiBpbmNsdWRlLmNvbnRhaW5zKGlkKSB8fCBleGNsdWRlLmxlbmd0aCA+IDA7CiAgICAgICAgICB9CiAgICAgICAgOiBudWxsOwoKICAgIGxvZygnaW5jbHVkZScsIGluY2x1ZGUpOwogICAgbG9nKCdleGNsdWRlJywgZXhjbHVkZSk7CiAgICBsb2coJ21hdGNoJywgbWF0Y2gpOwoKICAgIGNvbnN0IHByaW50VG9rID0gcGFyYW1zLm91dHB1dFRleHQKICAgICAgPyAodG9rLCBwcmVmaXgpID0+IHsKICAgICAgICAgIHN0ZC5wdXRzKHRvay5sZXhlbWUpOwogICAgICAgIH0KICAgICAgOiBkZWJ1ZyB8fCBtYXRjaAogICAgICA/ICh0b2ssIHByZWZpeCkgPT4gewogICAgICAgICAgY29uc3QgcmFuZ2UgPSB0b2suY2hhclJhbmdlOwogICAgICAgICAgY29uc3QgW3N0YXJ0LCBlbmRdID0gdG9rLmNoYXJSYW5nZTsKICAgICAgICAgIGxldCBzID0gdG9TdHJpbmcoc3RyKS5zbGljZShzdGFydCwgZW5kKTsKCiAgICAgICAgICBjb25zdCBjb2xzID0gW3ByZWZpeCwgYHRva1ske3Rvay5ieXRlTGVuZ3RofV1gLCB0b2suaWQsIHRvay50eXBlLCB0b2subGV4ZW1lLCB0b2subGV4ZW1lLmxlbmd0aCwgdG9rLmxvYywgYCAnJHtzfSdgXTsKICAgICAgICAgIHN0ZC5lcnIucHV0cyhjb2xzLnJlZHVjZSgoYWNjLCBjb2wsIGkpID0+IGFjYyArIChjb2wgKyAnJykucmVwbGFjZUFsbCgnXG4nLCAnXFxuJykucGFkRW5kKGNvbFNpemVzW2ldKSwgJycpICsgJ1xuJyk7CiAgICAgICAgfQogICAgICA6ICgpID0+IHt9OwoKICAgIGxldCB0b2ssCiAgICAgIGkgPSAwOwogICAgbG9nKCdub3cnLCBEYXRlLm5vdygpKTsKCiAgICBsb2cobGV4ZXIucnVsZU5hbWVzLmxlbmd0aCwgJ3J1bGVzJywgbGV4ZXIucnVsZU5hbWVzLnVuaXF1ZSgpLmxlbmd0aCwgJ3VuaXF1ZSBydWxlcycpOwogICAgbG9nKCdsZXhlci5tYXNrJywgSW50VG9CaW5hcnkobGV4ZXIubWFzaykpOwogICAgbG9nKCdsZXhlci5za2lwJywgbGV4ZXIuc2tpcCk7CiAgICBsb2coJ2xleGVyLnNraXAnLCBJbnRUb0JpbmFyeShsZXhlci5za2lwKSk7CiAgICBsb2coJ2xleGVyLnN0YXRlcycsIGxleGVyLnN0YXRlcyk7CiAgICBsb2coYG5ldyBMb2NhdGlvbigxMCwgMywgMjgsICdmaWxlLnR4dCcpYCwgbmV3IExvY2F0aW9uKDEwLCAzLCAyOCwgJ2ZpbGUudHh0JykpOwogICAgbGV0IG1hc2sgPSBJbnRUb0JpbmFyeShsZXhlci5tYXNrKTsKICAgIGxldCBzdGF0ZSA9IGxleGVyLnRvcFN0YXRlKCk7CiAgICBsZXhlci5iZWdpbkNvZGUgPSAoKSA9PiAoY29kZSA9PSAnanMnID8gMGIxMDAwIDogMGIwMTAwKTsKICAgIGxldCB0b2tlbnMgPSBbXTsKICAgIGxldCBzdGFydCA9IERhdGUubm93KCk7CiAgICBjb25zdCBiYWxhbmNlciA9ICgpID0+IHsKICAgICAgbGV0IHNlbGY7CiAgICAgIGxldCBzdGFjayA9IFtdOwogICAgICBjb25zdCB0YWJsZSA9IHsgJ30nOiAneycsICddJzogJ1snLCAnKSc6ICcoJyB9OwogICAgICBzZWxmID0gZnVuY3Rpb24gUGFyZW50aGVzZUJhbGFuY2VyKHRvaykgewogICAgICAgIHN3aXRjaCAodG9rPy5sZXhlbWUpIHsKICAgICAgICAgIGNhc2UgJ3snOgogICAgICAgICAgY2FzZSAnWyc6CiAgICAgICAgICBjYXNlICcoJzogewogICAgICAgICAgICBzdGFjay5wdXNoKHRvay5sZXhlbWUpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIGNhc2UgJ30nOgogICAgICAgICAgY2FzZSAnXSc6CiAgICAgICAgICBjYXNlICcpJzogewogICAgICAgICAgICBpZihzdGFjay5sYXN0ICE9IHRhYmxlW3Rvay5sZXhlbWVdKSB0aHJvdyBuZXcgRXJyb3IoYHRvcCAnJHtzdGFjay5sYXN0fScgIT0gJyR7dG9rLmxleGVtZX0nIFsgJHtzdGFjay5tYXAocyA9PiBgJyR7c30nYCkuam9pbignLCAnKX0gXWApOwogICAgICAgICAgICBzdGFjay5wb3AoKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9OwogICAgICBPYmplY3QuYXNzaWduKHNlbGYsIHsKICAgICAgICBzdGFjaywKICAgICAgICByZXNldCgpIHsKICAgICAgICAgIHN0YWNrLmNsZWFyKCk7CiAgICAgICAgfSwKICAgICAgICBnZXQgZGVwdGgoKSB7CiAgICAgICAgICByZXR1cm4gc3RhY2subGVuZ3RoOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHJldHVybiBzZWxmOwogICAgfTsKICAgIGxldCBiYWxhbmNlcnMgPSBbYmFsYW5jZXIoKV07CiAgICBsZXQgaW1wb3J0cyA9IFtdLAogICAgICBleHBvcnRzID0gW10sCiAgICAgIGltcGV4cCwKICAgICAgY29uZCwKICAgICAgaW1wID0gW10sCiAgICAgIGNvdW50ID0gMDsKICAgIGxldCBzaG93VG9rZW4gPSB0b2sgPT4gewogICAgICBpZigobGV4ZXIuY29uc3RydWN0b3IgIT0gRUNNQVNjcmlwdExleGVyICYmIHRvay50eXBlICE9ICd3aGl0ZXNwYWNlJykgfHwgL14oKGltfGV4KXBvcnR8ZnJvbXxhcykkLy50ZXN0KHRvay5sZXhlbWUpKSB7CiAgICAgICAgbGV0IGEgPSBbdG9rLnR5cGUucGFkRW5kKDIwLCAnICcpLCBlc2NhcGUodG9rLmxleGVtZSldOwogICAgICAgIHN0ZC5wdXRzKGEuam9pbignJykgKyAnXG4nKTsKICAgICAgfQogICAgfTsKICAgIGxldCBpdCA9IGxleGVyW1N5bWJvbC5pdGVyYXRvcl0oKTsKCiAgICBjb25zb2xlLmxvZygnaXQnLCBpdCk7CiAgICBjb25zb2xlLmxvZygnaW5jbHVkZScsIGluY2x1ZGUpOwogICAgY29uc29sZS5sb2coJ2V4Y2x1ZGUnLCBleGNsdWRlKTsKICAgIGNvbnNvbGUubG9nKCdtYXRjaCcsIG1hdGNoKTsKICAgIGNvbnNvbGUubG9nKCdtYXRjaCgwKScsIG1hdGNoKDApKTsKICAgIGZvcig7OykgewogICAgICBsZXQgeyBzdGF0ZURlcHRoIH0gPSBsZXhlcjsKICAgICAgbGV0IG5leHRUb2sgPSBpdC5uZXh0KCk7CiAgICAgIGxldCB7IGRvbmUsIHZhbHVlIH0gPSBuZXh0VG9rOwogICAgICBpZihkb25lKSBicmVhazsKICAgICAgY291bnQrKzsKICAgICAgbGV0IG5ld1N0YXRlID0gbGV4ZXIudG9wU3RhdGUoKTsKICAgICAgaWYobmV3U3RhdGUgIT0gc3RhdGUpIHsKICAgICAgICBpZihzdGF0ZSA9PSAnVEVNUExBVEUnICYmIGxleGVyLnN0YXRlRGVwdGggPiBzdGF0ZURlcHRoKSBiYWxhbmNlcnMucHVzaChiYWxhbmNlcigpKTsKICAgICAgICBpZihuZXdTdGF0ZSA9PSAnVEVNUExBVEUnICYmIGxleGVyLnN0YXRlRGVwdGggPCBzdGF0ZURlcHRoKSBiYWxhbmNlcnMucG9wKCk7CiAgICAgIH0KICAgICAgbGV0IG4gPSBiYWxhbmNlcnMubGFzdC5kZXB0aDsKICAgICAgaWYoISh0b2sgPSBsZXhlci50b2tlbikpIGJyZWFrOwogICAgICBpZihuID09IDAgJiYgdG9rLmxleGVtZSA9PSAnfScgJiYgbGV4ZXIuc3RhdGVEZXB0aCA+IDApIHsKICAgICAgICBsZXhlci5wb3BTdGF0ZSgpOwogICAgICB9IGVsc2UgewogICAgICAgIGJhbGFuY2VyKHRvayk7CiAgICAgICAgaWYobiA+IDAgJiYgYmFsYW5jZXJzLmxhc3QuZGVwdGggPT0gMCkgbG9nKCdiYWxhbmNlcicpOwogICAgICAgIGlmKFsnaW1wb3J0JywgJ2V4cG9ydCddLmluZGV4T2YodG9rLmxleGVtZSkgPj0gMCkgewogICAgICAgICAgaW1wZXhwID0gV2hhdFt0b2subGV4ZW1lLnRvVXBwZXJDYXNlKCldOwogICAgICAgICAgbGV0IHByZXYgPSB0b2tlbnNbdG9rZW5zLmxlbmd0aCAtIDFdOwogICAgICAgICAgewogICAgICAgICAgICBjb25kID0gdHJ1ZTsKICAgICAgICAgICAgaW1wID0gW107CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmKGNvbmQgPT0gdHJ1ZSkgewogICAgICAgICAgaW1wLnB1c2godG9rKTsKICAgICAgICAgIGlmKFsnOycsICdcbiddLmluZGV4T2YodG9rLmxleGVtZSkgIT0gLTEpIHsKICAgICAgICAgICAgY29uZCA9IGZhbHNlOwogICAgICAgICAgICBpZihpbXAuc29tZShpID0+IGkubGV4ZW1lID09ICdmcm9tJykpIHsKICAgICAgICAgICAgICBpZihpbXBleHAgPT0gV2hhdC5JTVBPUlQpIGltcG9ydHMucHVzaChBZGRJbXBvcnQoaW1wKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoaW1wZXhwID09IFdoYXQuRVhQT1JUKSBleHBvcnRzLnB1c2goQWRkRXhwb3J0KGltcCkpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZihtYXRjaCA/IG1hdGNoKHRvay5pZCkgOiB0b2sudHlwZSAhPSAnd2hpdGVzcGFjZScpIHByaW50VG9rKHRvaywgbmV3U3RhdGUpOwogICAgICAgIHRva2Vucy5wdXNoKHRvayk7CiAgICAgIH0KICAgICAgc3RhdGUgPSBuZXdTdGF0ZTsKICAgIH0KICAgIGNvbnN0IGV4cG9ydFRva2VucyA9IHRva2Vucy5yZWR1Y2UoKGFjYywgdG9rLCBpKSA9PiAodG9rLmxleGVtZSA9PSAnZXhwb3J0JyA/IGFjYy5jb25jYXQoW2ldKSA6IGFjYyksIFtdKTsKICAgIGxvZygnRXhwb3J0IHRva2VucycsIGV4cG9ydFRva2Vucyk7CiAgICBjb25zdCBleHBvcnROYW1lcyA9IGV4cG9ydFRva2Vucy5tYXAoaW5kZXggPT4gRXhwb3J0TmFtZSh0b2tlbnMuc2xpY2UoaW5kZXgpKSk7CiAgICBsb2coJ0V4cG9ydCBuYW1lcycsIGV4cG9ydE5hbWVzKTsKICAgIGxvZygnRVM2IGltcG9ydHMnLCBpbXBvcnRzLm1hcChQcmludEVTNkltcG9ydCkpOwogICAgbG9nKCdDSlMgaW1wb3J0cycsIGltcG9ydHMubWFwKFByaW50Q0pTSW1wb3J0KSk7CgogICAgaWYocGFyYW1zLm91dHB1dEltcHMpIHN0ZC5wdXRzKGBpbXBvcnQgeyAke2V4cG9ydE5hbWVzLmpvaW4oJywgJyl9IH0gZnJvbSAnJHtmaWxlfSdcbmApOwoKICAgIG1vZHVsZXNbZmlsZV0gPSB7IGltcG9ydHMsIGV4cG9ydHMgfTsKICAgIGxldCBmaWxlSW1wb3J0cyA9IGltcG9ydHMuZmlsdGVyKGltcCA9PiAvXC5qcyQvaS50ZXN0KGltcC5maWxlKSk7CiAgICBsZXQgc3BsaXRQb2ludHMgPSB1bmlxdWUoZmlsZUltcG9ydHMucmVkdWNlKChhY2MsIGltcCkgPT4gWy4uLmFjYywgLi4uaW1wLnJhbmdlXSwgW10pKTsKICAgIGJ1ZmZlcnNbZmlsZV0gPSBbLi4uc3BsaXQoQnVmZmVyRmlsZShmaWxlKSwgLi4uc3BsaXRQb2ludHMpXS5tYXAoYiA9PiBiID8/IHRvU3RyaW5nKGIsIDAsIGIuYnl0ZUxlbmd0aCkpOwogICAgbG9nKGBzcGxpdFBvaW50c2AsIHNwbGl0UG9pbnRzKTsKICAgIGxvZygKICAgICAgJ2ZpbGVJbXBvcnRzJywKICAgICAgZmlsZUltcG9ydHMubWFwKGltcCA9PiBpbXAuZmlsZSkKICAgICk7CiAgICBsZXQgZGlyID0gcGF0aC5kaXJuYW1lKGZpbGUpOwoKICAgIGlmKHBhcmFtcy5yZWN1cnNpdmUpCiAgICAgIGZpbGVJbXBvcnRzLmZvckVhY2goaW1wID0+IHsKICAgICAgICBsZXQgcCA9IHBhdGguY29sbGFwc2UocGF0aC5qb2luKGRpciwgaW1wLmZpbGUpKTsKICAgICAgICBsb2coJ3AnLCBwKTsKICAgICAgICBBZGRVbmlxdWUoZmlsZXMsIHApOwogICAgICB9KTsKICAgIGxldCBlbmQgPSBEYXRlLm5vdygpOwoKICAgIGxvZyhgdG9vayAke2VuZCAtIHN0YXJ0fW1zICgke2NvdW50fSB0b2tlbnMpYCk7CiAgICBsb2coJ2xleGVyJywgbGV4ZXIpOwogICAgc3RkLmdjKCk7CiAgfQogIGNvbnNvbGUubG9nKCdmaWxlcycsIGZpbGVzKTsKfQoKdHJ5IHsKICBtYWluKC4uLnNjcmlwdEFyZ3Muc2xpY2UoMSkpOwp9IGNhdGNoKGVycm9yKSB7CiAgY29uc29sZS5sb2coYEZBSUw6ICR7ZXJyb3IubWVzc2FnZX1cbiR7ZXJyb3Iuc3RhY2t9YCk7CiAgc3RhcnRJbnRlcmFjdGl2ZSgpOwogIC8vc3RkLmV4aXQoMSk7Cn0gZmluYWxseSB7CiAgY29uc29sZS5sb2coJ1NVQ0NFU1MnKTsKfQoAAAAAAAAAAIc6AAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAARiAAAAAAAABGIAAAAAAAAAAAAAAAAPC/"
				]
			]
		},
		{
			"file": "quickjs/quickjs.h",
			"settings":
			{
				"buffer_size": 42139,
				"line_ending": "Unix"
			},
			"undo_stack":
			[
			]
		},
		{
			"file": "draw.js",
			"settings":
			{
				"buffer_size": 13788,
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					36,
					1,
					"revert",
					null,
					"AwAAAAAAAAAAAAAAAAAAAAAAAAD2NQAAaW1wb3J0IFJlYWN0LCB7IEZyYWdtZW50LCBoLCByZW5kZXIsIENvbXBvbmVudCB9IGZyb20gJy4vbGliL2RvbS9wcmVhY3RDb21wb25lbnQuanMnOwppbXBvcnQgeyBTVkcgYXMgU1ZHQ29tcG9uZW50IH0gZnJvbSAnLi9saWIvZWFnbGUvY29tcG9uZW50cy9zdmcuanMnOwppbXBvcnQgeyBCQm94IH0gZnJvbSAnLi9saWIvZ2VvbS9iYm94LmpzJzsKaW1wb3J0IHRya2wgZnJvbSAnLi9saWIvdHJrbC5qcyc7CmltcG9ydCB7IE1hdHJpeCB9IGZyb20gJy4vbGliL2dlb20vbWF0cml4LmpzJzsKaW1wb3J0IHsgdXNlVHJrbCB9IGZyb20gJy4vbGliL2hvb2tzL3VzZVRya2wuanMnOwppbXBvcnQgeyBBbGlnbiwgUG9pbnQsIFJlY3QsIFBvaW50TGlzdCwgU2l6ZSB9IGZyb20gJy4vbGliL2dlb20uanMnOwppbXBvcnQgeyBFbGVtZW50IH0gZnJvbSAnLi9saWIvZG9tL2VsZW1lbnQuanMnOwppbXBvcnQgeyBTVkcgfSBmcm9tICcuL2xpYi9kb20vc3ZnLmpzJzsKaW1wb3J0IHsgSFNMQSwgUkdCQSB9IGZyb20gJy4vbGliL2NvbG9yLmpzJzsKaW1wb3J0IHsgc3RyZWFtaWZ5LCAgc3Vic2NyaWJlIH0gZnJvbSAnLi9saWIvYXN5bmMvZXZlbnRzLmpzJzsKaW1wb3J0IHsgQXJjLCBBcmNUbyB9IGZyb20gJy4vbGliL2dlb20vYXJjLmpzJzsKaW1wb3J0IHsgdW5pcXVlLCBkZWZpbmUsIHJhbmdlIH0gZnJvbSAnLi9saWIvbWlzYy5qcyc7CmltcG9ydCB7IEtvbG9yV2hlZWwgfSBmcm9tICcuL2xpYi9Lb2xvcldoZWVsLmpzJzsKaW1wb3J0IENhY2hlIGZyb20gJy4vbGliL2xzY2FjaGUuanMnOwppbXBvcnQgeyBtYWtlTG9jYWxTdG9yYWdlLCBsb2dTdG9yZUFkYXB0ZXIsIG1ha2VMb2NhbFN0b3JlLCBtYWtlRHVtbXlTdG9yYWdlLCBnZXRMb2NhbFN0b3JhZ2UsIG1ha2VBdXRvU3RvcmVIYW5kbGVyIH0gZnJvbSAnLi9saWIvYXV0b1N0b3JlLmpzJzsKCmxldCByZWYgPSAoZ2xvYmFsVGhpcy5yZWYgPSB0cmtsKG51bGwpKTsKbGV0IHN2Z0VsZW07CmxldCBzY3JlZW5DVE0sIHN2Z0NUTTsKbGV0IGFuY2hvclBvaW50cyA9IChnbG9iYWxUaGlzLmFuY2hvclBvaW50cyA9IHRya2woW10pKTsKbGV0IGFyYyA9IChnbG9iYWxUaGlzLmFyYyA9IFRyYWNrZWQoeyBzdGFydDogeyB4OiAxMCwgeTogMTAgfSwgZW5kOiB7IHg6IDIwLCB5OiAyMCB9LCBjdXJ2ZTogOTAgfSkpOwpsZXQgbHMgPSAoZ2xvYmFsVGhpcy5scyA9IG5ldyBTdG9yYWdlKCkpOwoKZnVuY3Rpb24gaXNDb21wb25lbnQob2JqKSB7CiAgaWYodHlwZW9mIG9iaiA9PSAnb2JqZWN0JyAmJiBvYmogIT09IG51bGwpIHJldHVybiAncHJvcHMnIGluIG9iajsKfQoKZnVuY3Rpb24gU3RvcmFnZSgpIHsKICBsZXQgbHMgPSBsb2NhbFN0b3JhZ2U7CiAgcmV0dXJuIG5ldyBQcm94eSgKICAgIHt9LAogICAgewogICAgICBnZXQodGFyZ2V0LCBwcm9wLCByZWNlaXZlcikgewogICAgICAgIGlmKHR5cGVvZiBwcm9wID09ICdzdHJpbmcnKSB7CiAgICAgICAgICBsZXQgdmFsdWUgPSBscy5nZXRJdGVtKHByb3ApOwogICAgICAgICAgaWYodHlwZW9mIHZhbHVlID09ICdzdHJpbmcnKSByZXR1cm4gSlNPTi5wYXJzZSh2YWx1ZSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBzZXQodGFyZ2V0LCBwcm9wLCB2YWx1ZSkgewogICAgICAgIGlmKHR5cGVvZiBwcm9wID09ICdzdHJpbmcnKSBscy5zZXRJdGVtKHByb3AsIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7CiAgICAgIH0sCiAgICAgIG93bktleXModGFyZ2V0KSB7CiAgICAgICAgbGV0IGksCiAgICAgICAgICByZXQgPSBbXTsKICAgICAgICBmb3IoaSA9IDA7IGkgPCBscy5sZW5ndGg7IGkrKykgcmV0LnB1c2gobHMua2V5KGkpKTsKICAgICAgICByZXR1cm4gcmV0OwogICAgICB9CiAgICB9CiAgKTsKfQoKZnVuY3Rpb24qIFdhbGtVcChlbGVtKSB7CiAgZG8gewogICAgeWllbGQgZWxlbTsKICB9IHdoaWxlKChlbGVtID0gZWxlbS5wYXJlbnRFbGVtZW50KSk7Cn0KCmZ1bmN0aW9uIEl0ZXJhdGVTb21lKGl0ZXIsIHByZWQgPSBlbGVtID0+IGZhbHNlKSB7CiAgbGV0IGkgPSAwOwogIGZvcihsZXQgZWxlbSBvZiBpdGVyKSB7CiAgICBsZXQgcmV0OwogICAgaWYoKHJldCA9IHByZWQoZWxlbSwgaSsrKSkpIHJldHVybiByZXQ7CiAgfQp9CgpmdW5jdGlvbiBHZXRBbGxQcm9wZXJ0eU5hbWVzKG9iaikgewogIGNvbnN0IHJldCA9IG5ldyBTZXQoKTsKICBkbyB7CiAgICBpZihvYmogPT0gT2JqZWN0LnByb3RvdHlwZSkgYnJlYWs7CiAgICBmb3IobGV0IG5hbWUgb2YgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMob2JqKSkgcmV0LmFkZChuYW1lKTsKICB9IHdoaWxlKChvYmogPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKSkpOwoKICByZXR1cm4gWy4uLnJldF07Cn0KCmZ1bmN0aW9uIENsb25lT2JqZWN0KG9iaiwgcHJlZCA9IChrZXksIHZhbHVlKSA9PiB0cnVlKSB7CiAgbGV0IG5hbWVzID0gR2V0QWxsUHJvcGVydHlOYW1lcyhvYmopOwogIGxldCByZXQgPSB7fTsKICBmb3IobGV0IG5hbWUgb2YgbmFtZXMpIHsKICAgIGlmKCFwcmVkKG5hbWUsIG9ialtuYW1lXSkpIGNvbnRpbnVlOwogICAgbGV0IHZhbHVlID0gb2JqW25hbWVdOwogICAgaWYodHlwZW9mIHZhbHVlID09ICdmdW5jdGlvbicgJiYgbmFtZSAhPSAnY29uc3RydWN0b3InKSB2YWx1ZSA9ICguLi5hcmdzKSA9PiB2YWx1ZS5jYWxsKG9iaiwgLi4uYXJncyk7CgogICAgcmV0W25hbWVdID0gdmFsdWU7CiAgfQogIHJldHVybiByZXQ7Cn0KCmNvbnN0IFRhYmxlID0gcHJvcHMgPT4gewogIHJldHVybiBoKAogICAgJ3RhYmxlJywKICAgIHsgY2VsbHNwYWNpbmc6IDAsIGNlbGxwYWRkaW5nOiAwIH0sCiAgICAocHJvcHMucm93cyA/PyBwcm9wcy5jaGlsZHJlbikubWFwKHJvdyA9PgogICAgICBBcnJheS5pc0FycmF5KHJvdykKICAgICAgICA/IGgoCiAgICAgICAgICAgICd0cicsCiAgICAgICAgICAgIHt9LAogICAgICAgICAgICByb3cubWFwKGNlbGwgPT4gKGlzQ29tcG9uZW50KGNlbGwpID8gY2VsbCA6IGgoJ3RkJywge30sIFtjZWxsXSkpKQogICAgICAgICAgKQogICAgICAgIDogcm93CiAgICApCiAgKTsKfTsKCmZ1bmN0aW9uIE9ic2VydmFibGUob2JqLCBjaGFuZ2UgPSAocHJvcCwgdmFsdWUpID0+IHt9KSB7CiAgcmV0dXJuIG5ldyBQcm94eShvYmosIHsKICAgIGdldCh0YXJnZXQsIHByb3AsIHJlY2VpdmVyKSB7CiAgICAgIGlmKHByb3AgPT0gJ3dyYXBwZWQnKSByZXR1cm4gb2JqOwoKICAgICAgcmV0dXJuIFJlZmxlY3QuZ2V0KHRhcmdldCwgcHJvcCwgcmVjZWl2ZXIpOwogICAgfSwKICAgIHNldCh0YXJnZXQsIHByb3AsIHZhbHVlKSB7CiAgICAgIGxldCBvbGRWYWx1ZSA9IHRhcmdldFtwcm9wXTsKICAgICAgUmVmbGVjdC5zZXQodGFyZ2V0LCBwcm9wLCB2YWx1ZSk7CiAgICAgIGlmKG9sZFZhbHVlICE9IHZhbHVlKSBjaGFuZ2UuY2FsbChvYmosIHByb3AsIHZhbHVlKTsKICAgIH0KICB9KTsKfQoKZnVuY3Rpb24gVHJhY2tlZChvYmopIHsKICBsZXQgcmV0LCBvYnNydjsKICBvYnNydiA9IE9ic2VydmFibGUob2JqLCAocHJvcCwgdmFsdWUpID0+IHsKICAgIHJldChvYnNydik7CiAgfSk7CiAgcmV0ID0gdHJrbChvYnNydik7CgogIHJldHVybiByZXQ7Cn0KCmNvbnN0IEFuY2hvclBvaW50cyA9ICh7IHBvaW50cywgLi4ucHJvcHMgfSkgPT4gewogIGxldCBkYXRhID0gdXNlVHJrbChwb2ludHMpOwoKICByZXR1cm4gaCgKICAgICdnJywKICAgIHt9LAogICAgZGF0YS5tYXAocHQgPT4gewogICAgICByZXR1cm4gaCgnY2lyY2xlJywgewogICAgICAgIGN4OiBwdC54LAogICAgICAgIGN5OiBwdC55LAogICAgICAgIHI6IDAuOCwKICAgICAgICBzdHJva2U6ICdibGFjaycsCiAgICAgICAgJ3N0cm9rZS13aWR0aCc6IDAuMSwKICAgICAgICBmaWxsOiAncmdiYSgyNTUsMCwwLDAuOCknCiAgICAgIH0pOwogICAgfSkKICApOwp9OwoKY29uc3QgUGF0aCA9ICh7IHBvaW50cywgLi4ucHJvcHMgfSkgPT4gewogIGxldCBkYXRhID0gWy4uLnVzZVRya2wocG9pbnRzKV07CgogIGlmKGRhdGEubGVuZ3RoID09IDApIHJldHVybiBudWxsOwoKICBsZXQgZCA9IGBNICR7ZGF0YS5zaGlmdCgpfWAgKyBkYXRhLnJlZHVjZSgoYWNjLCBwdCkgPT4gYWNjICsgYCBMICR7cHR9YCwgJycpOwoKICByZXR1cm4gaCgncGF0aCcsIHsgZCwgZmlsbDogJ25vbmUnLCBzdHJva2U6ICdibGFjaycsICdzdHJva2Utd2lkdGgnOiAwLjEgfSk7Cn07Cgpjb25zdCBFbGxpcHRpY0FyYyA9ICh7IGRhdGEsIC4uLnByb3BzIH0pID0+IHsKICBsZXQgeyBzdGFydCwgZW5kLCBjdXJ2ZSB9ID0gdXNlVHJrbChkYXRhKTsKCiAgcmV0dXJuIGgoJ3BhdGgnLCB7CiAgICBkOiBgTSAke25ldyBQb2ludChzdGFydCl9IGAgKyBBcmNUbyhlbmQueCAtIHN0YXJ0LngsIGVuZC55IC0gc3RhcnQueSwgY3VydmUpLAogICAgZmlsbDogJ25vbmUnLAogICAgc3Ryb2tlOiAnYmxhY2snLAogICAgJ3N0cm9rZS13aWR0aCc6IDAuMQogIH0pOwp9OwoKZnVuY3Rpb24gQWRkUG9pbnQocHQpIHsKICBhbmNob3JQb2ludHMoYW5jaG9yUG9pbnRzKCkuY29uY2F0KFtwdF0pKTsKfQoKZnVuY3Rpb24gR2V0RWxlbWVudFNpZ25hbChlbGVtKSB7CiAgcmV0dXJuIGVsZW0uZ2V0QXR0cmlidXRlKCdkYXRhLXNpZ25hbCcpOwp9CgpmdW5jdGlvbiBHZXRFbGVtZW50c0J5U2lnbmFsKHNpZ25hbE5hbWUpIHsKICByZXR1cm4gRWxlbWVudC5maW5kQWxsKCcqW2RhdGEtc2lnbmFsPScrc2lnbmFsTmFtZS5yZXBsYWNlKC8oXCQpL2csICdcXCQxJykrJ10nKTsKfQoKZnVuY3Rpb24gU29ydEVsZW1lbnRzQnlQb3NpdGlvbihlbGVtZW50cykgewogIGxldCBlbnRyaWVzID0gZWxlbWVudHMubWFwKGUgPT4gW2UsIG5ldyBQb2ludChFbGVtZW50LnJlY3QoZSkuY29ybmVycygpWzBdKV0pOwogIGdsb2JhbFRoaXMuZW50cmllcyA9IGVudHJpZXM7CiAgZW50cmllcy5zb3J0KChhLCBiKSA9PiBhWzFdLnZhbHVlT2YoLTE2KSAtIGJbMV0udmFsdWVPZigtMTYpKTsKICBjb25zb2xlLmxvZygnU29ydEVsZW1lbnRzQnlQb3NpdGlvbicsIHsgZW50cmllcyB9KTsKICByZXR1cm4gZW50cmllcy5tYXAoKFtlLCByZWN0XSkgPT4gZSk7Cn0KCmZ1bmN0aW9uIENyZWF0ZUVsZW1lbnQocG9zLCBzaXplKSB7CiAgbGV0IHsgeCwgeSB9ID0gbmV3IFBvaW50KHBvcyk7CiAgbGV0IHsgd2lkdGgsIGhlaWdodCB9ID0gc2l6ZSA/IG5ldyBTaXplKHNpemUpIDoge307CgogIGxldCBzdHlsZSA9IHsgYmFja2dyb3VuZDogJ3JlZCcsIGxlZnQ6IGAke3h9cHhgLCB0b3A6IGAke3l9cHhgLCBwb3NpdGlvbjogJ2ZpeGVkJywgbWFyZ2luOiBgMCAwIDAgMGAgfTsKCiAgaWYod2lkdGgpIHN0eWxlLndpZHRoID0gYCR7d2lkdGh9cHhgOwogIGlmKGhlaWdodCkgc3R5bGUuaGVpZ2h0ID0gYCR7aGVpZ2h0fXB4YDsKCiAgcmV0dXJuIEVsZW1lbnQuY3JlYXRlKAogICAgJ2RpdicsCiAgICB7CiAgICAgIGlubmVySFRNTDogJ3gnLAogICAgICBzdHlsZQogICAgfSwKICAgIGRvY3VtZW50LmJvZHkKICApOwp9CgpmdW5jdGlvbiBHZXRQb3NpdGlvbihlbGVtZW50KSB7CiAgbGV0IHggPSArZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2N4Jyk7CiAgbGV0IHkgPSArZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2N5Jyk7CiAgcmV0dXJuIG5ldyBQb2ludCh4LCB5KTsKfQoKZnVuY3Rpb24gRmluZFBvaW50KHBvcykgewogIGxldCBwdCA9IGFuY2hvclBvaW50cygpLmZpbmQocHQyID0+IFBvaW50LmVxdWFscyhwdDIsIHBvcykpOwogIHJldHVybiBwdDsKfQoKZnVuY3Rpb24gTW91c2VFdmVudHMoZWxlbWVudCkgewogIGNvbnN0IGlzVG91Y2ggPSAnb250b3VjaHN0YXJ0JyBpbiBlbGVtZW50OwogIHJldHVybiBzdHJlYW1pZnkoCiAgICBpc1RvdWNoID8gWyd0b3VjaG1vdmUnLCAndG91Y2hlbmQnXSA6IFsnbW91c2Vtb3ZlJywgJ21vdXNldXAnXSwKICAgIGVsZW1lbnQsCiAgICBpc1RvdWNoID8gZSA9PiAhZS50eXBlLmVuZHNXaXRoKCdlbmQnKSA6IGUgPT4gIWUudHlwZS5lbmRzV2l0aCgndXAnKQogICk7Cn0KCmFzeW5jIGZ1bmN0aW9uKiBUb3VjaEV2ZW50cyhlbGVtZW50KSB7CiAgbGV0IHRvdWNoZXM7CiAgZm9yIGF3YWl0KGxldCBldmVudCBvZiBNb3VzZUV2ZW50cyhlbGVtZW50KSkgewogICAgY29uc3QgeyB0eXBlIH0gPSBldmVudDsKICAgIC8vIGNvbnNvbGUubG9nKCdUb3VjaEV2ZW50cycsIHsgdHlwZSxldmVudCB9KTsKCiAgICBpZigndG91Y2hlcycgaW4gZXZlbnQgJiYgZXZlbnQudG91Y2hlcy5sZW5ndGgpIHsKICAgICAgdG91Y2hlcyA9IFsuLi5ldmVudC50b3VjaGVzXTsKCiAgICAgIGZvcihsZXQgdG91Y2ggb2YgdG91Y2hlcykgewogICAgICAgIC8vZGVmaW5lKGdsb2JhbFRoaXMsIHsgZXZlbnQsIHRvdWNoIH0pOwogICAgICAgIHlpZWxkIGRlZmluZShDbG9uZU9iamVjdChldmVudCksIENsb25lT2JqZWN0KHRvdWNoKSk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGlmKHR5cGUuZW5kc1dpdGgoJ2VuZCcpKSBldmVudCA9IGRlZmluZShldmVudCwgQ2xvbmVPYmplY3QodG91Y2hlc1t0b3VjaGVzLmxlbmd0aCAtIDFdKSk7CgogICAgICB5aWVsZCBldmVudDsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIEdldFNpZ25hbE5hbWVzKCkgewogIHJldHVybiB1bmlxdWUoRWxlbWVudC5maW5kQWxsKGAqW2RhdGEtc2lnbmFsXWApLm1hcChlID0+IGUuZ2V0QXR0cmlidXRlKCdkYXRhLXNpZ25hbCcpKSkuc29ydCgoYSwgYikgPT4KICAgIGEgPT0gJ0dORCcgPyAtMSA6IGEgPT0gJ1ZDQycgPyAoYiAhPSAnR05EJyA/IC0xIDogMSkgOiAxID8/IGEubG9jYWxlQ29tcGFyZShiKQogICk7Cn0KCmZ1bmN0aW9uIEdldFNpZ25hbENvbG9yKHNpZ25hbE5hbWUpIHsKICBmb3IobGV0IGVsZW0gb2YgRWxlbWVudC5maW5kQWxsKCcqW2RhdGEtc2lnbmFsPScrc2lnbmFsTmFtZS5yZXBsYWNlKC8oXCQpL2csICdcXCQxJykrJ10nKSkgewogICAgbGV0IHN0cm9rZSA9IGVsZW0uZ2V0QXR0cmlidXRlKCdzdHJva2UnKTsKICAgIGlmKHN0cm9rZSkgcmV0dXJuIHN0cm9rZTsKICB9Cn0KCmZ1bmN0aW9uKiBHZXRTaWduYWxFbnRyaWVzKCkgewogIGZvcihsZXQgbmFtZSBvZiBHZXRTaWduYWxOYW1lcygpKSB5aWVsZCBbbmFtZSwgR2V0U2lnbmFsQ29sb3IobmFtZSldOwp9CgpmdW5jdGlvbiBDb2xvclNpZ25hbHMoKSB7CiAgbGV0IG5hbWVzID0gR2V0U2lnbmFsTmFtZXMoKTsKICBsZXQgcGFsZXR0ZSA9IE1ha2VQYWxldHRlKG5hbWVzLmxlbmd0aCk7CgogIGdsb2JhbFRoaXMucGFsZXR0ZShwYWxldHRlKTsKCiAgY29uc29sZS5sb2coJ0NvbG9yU2lnbmFscycsIHsgbmFtZXMsIHBhbGV0dGUgfSk7CiAgbGV0IGkgPSAwOwogIGZvcihsZXQgbmFtZSBvZiBuYW1lcykgewogICAgQ29sb3JTaWduYWwobmFtZSwgcGFsZXR0ZVtpKytdKTsKICB9Cn0KCmZ1bmN0aW9uIFJlbmRlclBhbGV0dGUocHJvcHMpIHsKICBsZXQgZGF0YSA9IHVzZVRya2wocHJvcHMuZGF0YSk7CiAgbGV0IG5hbWVzID0gR2V0U2lnbmFsTmFtZXMoKTsKICByZXR1cm4gaCgKICAgIFRhYmxlLAogICAge30sCgogICAgKGRhdGEgPz8gW10pLm1hcCgoY29sb3IsIGkpID0+IFtuYW1lc1tpXSA/PyBpICsgJycsIGgoJ3RkJywgeyBzdHlsZTogeyBiYWNrZ3JvdW5kOiBjb2xvciwgJ21pbi13aWR0aCc6ICcxZW0nIH0gfSldKQogICk7Cn0KCmZ1bmN0aW9uIENvbG9yU2lnbmFsKHNpZ25hbE5hbWUsIGNvbG9yKSB7CiAgZm9yKGxldCBlbGVtIG9mIEVsZW1lbnQuZmluZEFsbCgnKltkYXRhLXNpZ25hbD0nK3NpZ25hbE5hbWUucmVwbGFjZSgvKFwkKS9nLCAnXFwkMScpKyddJykpIHsKICAgIC8vY29uc29sZS5sb2coJ0NvbG9yU2lnbmFsJywgZWxlbSk7CiAgICBlbGVtLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgY29sb3IpOwogIH0KfQoKYXN5bmMgZnVuY3Rpb24gTG9hZFNWRyhmaWxlbmFtZSkgewogIGxldCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGZpbGVuYW1lKTsKICBsZXQgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTsKCiAgLy9jb25zb2xlLmxvZygnTG9hZFNWRycsIHsgZmlsZW5hbWUsIGRhdGEgfSk7CgogIGxldCBlbGVtID0gRWxlbWVudC5jcmVhdGUoJ2RpdicsIHsgY2xhc3M6ICdzdmcnIH0sIGRvY3VtZW50LmJvZHkpOwogIGNvbnN0IHsgYm9keSB9ID0gZG9jdW1lbnQ7CiAgZWxlbS5pbm5lckhUTUwgPSBkYXRhOwogIGVsZW0uaW5zZXJ0QmVmb3JlKEVsZW1lbnQuY3JlYXRlKCdoNCcsIHsgaW5uZXJIVE1MOiBmaWxlbmFtZSB9LCBbXSksIGVsZW0uY2hpbGRyZW5bMF0pOwogIGxldCB6b29tUG9zID0gMCwKICAgIHpvb21GYWN0b3IgPSAxOwogIGNvbnN0IGlzVG91Y2ggPSAnb250b3VjaHN0YXJ0JyBpbiBlbGVtOwoKICBlbGVtLm9ubW91c2V3aGVlbCA9IFpvb21IYW5kbGVyOwoKICBlbGVtW2lzVG91Y2ggPyAnb250b3VjaHN0YXJ0JyA6ICdvbm1vdXNlZG93biddID0gTW92ZUhhbmRsZXI7CgogIGZ1bmN0aW9uIFpvb21IYW5kbGVyKGUpIHsKICAgIGNvbnN0IHsgZGVsdGFZLCBzY3JlZW5YOiB4LCBzY3JlZW5ZOiB5IH0gPSBlOwogICAgem9vbVBvcyAtPSBkZWx0YVkgLyAxMDAwOwogICAgem9vbUZhY3RvciA9IE1hdGgucG93KDEwLCB6b29tUG9zKTsKCiAgICAvL2NvbnNvbGUubG9nKCd3aGVlbCcsIHsgeCwgeSwgem9vbUZhY3RvciB9KTsKCiAgICBFbGVtZW50LnNldENTUyhlbGVtLCB7CiAgICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZSgkey14fXB4LCAkey15fXB4KSBzY2FsZSgke3pvb21GYWN0b3J9LCAke3pvb21GYWN0b3J9KSB0cmFuc2xhdGUoJHt4IC8gem9vbUZhY3Rvcn1weCwgJHsKICAgICAgICB5IC8gem9vbUZhY3RvcgogICAgICB9cHgpIGAKICAgIH0pOwogIH0KCiAgYXN5bmMgZnVuY3Rpb24gTW92ZUhhbmRsZXIoZSkgewogICAgbGV0IHsgY2xpZW50WDogc3RhcnRYLCBjbGllbnRZOiBzdGFydFksIHR5cGUsIHRvdWNoZXMsIHRhcmdldCwgY3VycmVudFRhcmdldCB9ID0gZTsKICAgIHN0YXJ0WCA/Pz0gdG91Y2hlc1swXS5jbGllbnRYOwogICAgc3RhcnRZID8/PSB0b3VjaGVzWzBdLmNsaWVudFk7CgogICAgY29uc29sZS5sb2coJ01vdmVIYW5kbGVyJywgeyB0eXBlLCBzdGFydFgsIHN0YXJ0WSwgdG91Y2hlcyB9KTsKICAgIGxldCByZWN0ID0gbmV3IFJlY3QoRWxlbWVudC5nZXRSZWN0KGVsZW0pKTsKICAgIGZvciBhd2FpdChsZXQgZXYgb2YgVG91Y2hFdmVudHMoZG9jdW1lbnQuYm9keSkpIHsKICAgICAgbGV0IHsgY2xpZW50WDogeCwgY2xpZW50WTogeSB9ID0gZXY7CiAgICAgIGNvbnNvbGUubG9nKCdNb3ZlSGFuZGxlcicsIHsgeCwgeSB9KTsKICAgICAgbGV0IHJlbCA9IG5ldyBQb2ludCh7IHg6IHggLSBzdGFydFgsIHk6IHkgLSBzdGFydFkgfSk7CiAgICAgIGxldCBwb3MgPSBuZXcgUmVjdCguLi5yZWwuc3VtKHJlY3QudXBwZXJMZWZ0KSwgcmVjdC53aWR0aCwgcmVjdC5oZWlnaHQpOwogICAgICBFbGVtZW50Lm1vdmUoZWxlbSwgcG9zLnVwcGVyTGVmdCk7CiAgICB9CiAgfQoKICBFbGVtZW50LnNldENTUyhlbGVtLCB7IHBvc2l0aW9uOiAnYWJzb2x1dGUnLCBsZWZ0OiAnMHB4JywgdG9wOiAnMHB4JyB9KTsKCiAgcmV0dXJuIGVsZW07Cn0KCmZ1bmN0aW9uIE1ha2VQYWxldHRlMihudW0pIHsKICBsZXQgcmVzdWx0ID0gW107CiAgbmV3IEtvbG9yV2hlZWwoJyMwMDAwZmYnKS5hYnMoMCwgLTEsIC0xLCBudW0gLSAxKS5lYWNoKGZ1bmN0aW9uICgpIHsKICAgIHJlc3VsdC5wdXNoKHRoaXMuZ2V0SGV4KCkpOwogIH0pOwogIHJlc3VsdC5wdXNoKCcjMDAwMDAwJyk7CiAgcmVzdWx0LnJldmVyc2UoKTsKICByZXR1cm4gcmVzdWx0Owp9CgpmdW5jdGlvbiBNYWtlUGFsZXR0ZShudW0pIHsKICAvL2xldCBjbD1uZXcgcmFuZ2UoMCwzNTAsICgzNjAvbnVtKSkucmV2ZXJzZSgpLm1hcChyID0+IG5ldyBIU0xBKHIsIDEwMCw1MCwxKSk7CiAgbGV0IHNpZ25hbENvbG9ycyA9IGAjMDAwMDAwCiNlMDIyMzEKI2ZmOWIwMAojZTRlMjBiCiM2OGRiMTkKIzE5N2RmZgojYTEzOGZmCiNiNmI2YjZgLnNwbGl0KCdcbicpOwogIGxldCByZXN1bHQgPSBbXTsKICBzaWduYWxDb2xvcnMuc2hpZnQoKTsKICBzaWduYWxDb2xvcnMuc2hpZnQoKTsKICBzaWduYWxDb2xvcnMucG9wKCk7CgogIGZvcihsZXQgaSA9IDA7IGkgPCBudW0gLSAyOyBpKyspIHJlc3VsdC5wdXNoKHNpZ25hbENvbG9yc1tpICUgc2lnbmFsQ29sb3JzLmxlbmd0aF0pOwoKICAvL2xldCByZXN1bHQ9Y2wubWFwKGMgPT4gYy50b1JHQkEoKSsnJykKICByZXN1bHQudW5zaGlmdCgnI2UwMjIzMScpOwogIHJlc3VsdC51bnNoaWZ0KCcjMDAwMDAwJyk7CiAgLy9yZXN1bHQucmV2ZXJzZSgpOwogIGdsb2JhbFRoaXMucGFsZXR0ZShyZXN1bHQpOwogIHJldHVybiByZXN1bHQ7Cn0KCk9iamVjdC5hc3NpZ24oZ2xvYmFsVGhpcywgewogIE1hdHJpeCwKICBQb2ludCwKICBQb2ludExpc3QsCiAgQWxpZ24sCiAgUmVjdCwKICBFbGVtZW50LAogIFNWRywKICBDcmVhdGVFbGVtZW50LAogIEdldFBvc2l0aW9uLAogIEZpbmRQb2ludCwKICBNb3VzZUV2ZW50cywKICBUb3VjaEV2ZW50cywKICBBcmMsCiAgQXJjVG8sCiAgVHJhY2tlZCwKICBMb2FkU1ZHLAogIENvbG9yU2lnbmFsLAogIEdldFNpZ25hbE5hbWVzLAogIEdldFNpZ25hbENvbG9yLAogIEtvbG9yV2hlZWwsCiAgTWFrZVBhbGV0dGUsCiAgUmVuZGVyUGFsZXR0ZSwKICBDb2xvclNpZ25hbHMsCiAgVGFibGUsCiAgR2V0U2lnbmFsRW50cmllcywKICBkZWZpbmUsCiAgcmFuZ2UsCiAgV2Fsa1VwLAogIEl0ZXJhdGVTb21lLAogIEdldEFsbFByb3BlcnR5TmFtZXMsCiAgQ2xvbmVPYmplY3QsCiAgQ2FjaGUsCiAgbWFrZUxvY2FsU3RvcmFnZSwKICBsb2dTdG9yZUFkYXB0ZXIsCiAgbWFrZUxvY2FsU3RvcmUsCiAgbWFrZUR1bW15U3RvcmFnZSwKICBnZXRMb2NhbFN0b3JhZ2UsCiAgbWFrZUF1dG9TdG9yZUhhbmRsZXIsCiAgU3RvcmFnZSwKICBHZXRFbGVtZW50U2lnbmFsLAogIEdldEVsZW1lbnRzQnlTaWduYWwsCiAgU29ydEVsZW1lbnRzQnlQb3NpdGlvbiwKICBoLAogIGlzQ29tcG9uZW50LAogIFJHQkEsCiAgSFNMQQp9KTsKCndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgYXN5bmMgZSA9PiB7CiAgbGV0IGVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJlYWN0Jyk7CgogIHJlZi5zdWJzY3JpYmUodmFsdWUgPT4gewogICAgc3ZnRWxlbSA9IGdsb2JhbFRoaXMuc3ZnRWxlbSA9IHZhbHVlLmJhc2U7CiAgICBjb25zb2xlLmxvZygncmVmJywgdmFsdWUpOwoKICAgIHN2Z0NUTSA9IGdsb2JhbFRoaXMuc3ZnQ1RNID0gTWF0cml4LmZyb21ET00oc3ZnRWxlbS5nZXRTY3JlZW5DVE0oKSkuaW52ZXJ0KCk7CiAgICBzY3JlZW5DVE0gPSBnbG9iYWxUaGlzLnNjcmVlbkNUTSA9IE1hdHJpeC5mcm9tRE9NKHN2Z0VsZW0uZ2V0U2NyZWVuQ1RNKCkpOwoKICAgIGNvbnN0IGlzVG91Y2ggPSAnb250b3VjaHN0YXJ0JyBpbiBzdmdFbGVtOwoKICAgIHN2Z0VsZW0uYWRkRXZlbnRMaXN0ZW5lcihpc1RvdWNoID8gJ3RvdWNoc3RhcnQnIDogJ21vdXNlZG93bicsIGFzeW5jIGUgPT4gewogICAgICBjb25zdCB7IHR5cGUgfSA9IGU7CiAgICAgIGNvbnNvbGUubG9nKCdvbicgKyB0eXBlLCBlKTsKCiAgICAgIGNvbnN0IHsgY2xpZW50WDogeCwgY2xpZW50WTogeSwgdGFyZ2V0LCBjdXJyZW50VGFyZ2V0IH0gPSBlOwoKICAgICAgbGV0IHh5LAogICAgICAgIHB0LAogICAgICAgIHBvcyA9IG5ldyBQb2ludCguLi5zdmdDVE0udHJhbnNmb3JtX3h5KHgsIHkpKTsKCiAgICAgIGlmKHRhcmdldC50YWdOYW1lICE9ICdzdmcnKSB7CiAgICAgICAgT2JqZWN0LmFzc2lnbihnbG9iYWxUaGlzLCB7IHRhcmdldCB9KTsKCiAgICAgICAgeHkgPSBHZXRQb3NpdGlvbih0YXJnZXQpOwogICAgICAgIHB0ID0gRmluZFBvaW50KHh5KTsKICAgICAgfQoKICAgICAgaWYoIXB0KSBBZGRQb2ludChwb3MpOwogICAgICBlbHNlIE1vdmVQb2ludCgpOwogICAgICAvLyAgIGNvbnNvbGUubG9nKCd0b3VjaHN0YXJ0JywgeyB4eSwgcHQgfSk7CgogICAgICBhc3luYyBmdW5jdGlvbiBNb3ZlUG9pbnQoKSB7CiAgICAgICAgZm9yIGF3YWl0KGxldCBldiBvZiBUb3VjaEV2ZW50cyhzdmdFbGVtKSkgewogICAgICAgICAgbGV0IHsgY2xpZW50WCwgY2xpZW50WSB9ID0gZXY7CiAgICAgICAgICBsZXQgdHBvcyA9IG5ldyBQb2ludCguLi5zdmdDVE0udHJhbnNmb3JtX3h5KGNsaWVudFgsIGNsaWVudFkpKTsKCiAgICAgICAgICBsZXQgZGlmZiA9IHRwb3MuZGlmZihwb3MpOwoKICAgICAgICAgIHB0LnggPSB0cG9zLng7CiAgICAgICAgICBwdC55ID0gdHBvcy55OwogICAgICAgICAgYW5jaG9yUG9pbnRzKFsuLi5hbmNob3JQb2ludHMoKV0pOwoKICAgICAgICAgIC8vIGNvbnNvbGUubG9nKCd0b3VjaCcsIHsgcHQsIGRpZmYgfSk7CiAgICAgICAgfQogICAgICB9CgogICAgICBjb25zb2xlLmxvZygnbW91c2Vkb3duJywgeyB4LCB5LCB0YXJnZXQsIGN1cnJlbnRUYXJnZXQgfSk7CiAgICB9KTsKICB9KTsKCiAgbGV0IGNvbXBvbmVudCA9IGgoRnJhZ21lbnQsIHt9LCBbCiAgICBoKFNWR0NvbXBvbmVudCwgeyByZWYsIHZpZXdCb3g6IG5ldyBCQm94KDAsIDAsIDE2MCwgMTAwKSB9LCBbCiAgICAgIGgoJ2NpcmNsZScsIHsgY3g6IDMwLCBjeTogMzAsIHI6IDIsIHN0cm9rZTogJ3JlZCcsICdzdHJva2Utd2lkdGgnOiAwLjEsIGZpbGw6ICdub25lJyB9KSwKICAgICAgaChQYXRoLCB7IHBvaW50czogYW5jaG9yUG9pbnRzIH0sIFtdKSwKICAgICAgaChBbmNob3JQb2ludHMsIHsgcG9pbnRzOiBhbmNob3JQb2ludHMgfSwgW10pLAogICAgICBoKEVsbGlwdGljQXJjLCB7IGRhdGE6IGFyYyB9LCBbXSkKICAgIF0pLAogICAgaChSZW5kZXJQYWxldHRlLCB7IGRhdGE6IChnbG9iYWxUaGlzLnBhbGV0dGUgPSB0cmtsKFtdKSkgfSkKICBdKTsKCiAgcmVuZGVyKGNvbXBvbmVudCwgZWxlbWVudCk7CgogIHNldFRpbWVvdXQoKCkgPT4gewogICAgTG9hZFNWRygnTWluZC1TeW5jaHJvbml6aW5nLUdlbmVyYXRvci1QaW5IZHJQb3QtYm9hcmQuc3ZnJykudGhlbigoKSA9PiB7CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIEVsZW1lbnQuZmluZCgnc3ZnID4gI2JnJykuc3R5bGUuc2V0UHJvcGVydHkoJ3BvaW50ZXItZXZlbnRzJywgJ25vbmUnKTsKCiAgICAgICAgQ29sb3JTaWduYWxzKCk7CiAgICAgIH0sIDEwMDApOwogICAgfSwgMTAwKTsKICB9KTsKCiAgZm9yIGF3YWl0KGxldCBldmVudCBvZiBzdHJlYW1pZnkoWydtb3VzZW1vdmUnLCAndG91Y2htb3ZlJ10sIGRvY3VtZW50LmJvZHksIGUgPT4gdHJ1ZSkpIHsKICAgIGNvbnN0IHsgY2xpZW50WDogeCwgY2xpZW50WTogeSwgdGFyZ2V0LCBjdXJyZW50VGFyZ2V0IH0gPSBldmVudDsKCiAgICBsZXQgZWxlbWVudHMgPSBbLi4uZG9jdW1lbnQuZWxlbWVudHNGcm9tUG9pbnQoeCwgeSldLmZpbHRlcihJc1NWR0VsZW1lbnQpOwoKICAgIGlmKGVsZW1lbnRzLmxlbmd0aCkgewogICAgICBsZXQgc2lnbmFscyA9IGVsZW1lbnRzLm1hcChlID0+IFtlLCBHZXRFbGVtZW50U2lnbmFsKGUpXSkuZmlsdGVyKChbZSwgc2lnXSkgPT4gc2lnICE9IG51bGwpOwogICAgICBsZXQgc2lnbmFsID0gKHNpZ25hbHNbMF0gPz8gW10pWzFdOwoKICAgICAgaWYoc2lnbmFsKSBnbG9iYWxUaGlzLmVsZW1lbnRzID0gR2V0RWxlbWVudHNCeVNpZ25hbChzaWduYWwpOwoKICAgICAgLy8gY29uc29sZS5sb2coJ21vdmUnLCB7IHgsIHksIHNpZ25hbCB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBJc1NWR0VsZW1lbnQoZWxlbSkgewogICAgICByZXR1cm4gSXRlcmF0ZVNvbWUoV2Fsa1VwKGVsZW0pLCAoZSwgaSkgPT4gaSA+IDAgJiYgZS50YWdOYW1lID09ICdzdmcnKTsKICAgIH0KICB9Cn0pOwoAAAAAAAAAANw1AAAAAAAAAAAAAAAAAAAAAAAA3DUAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAADLAwAAAAAAAMsDAAAAAAAAAAAAAAAA8L8"
				]
			]
		},
		{
			"file": "quickjs/qjs-modules/resolve-imports.js",
			"settings":
			{
				"buffer_size": 46874,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					64,
					1,
					"paste",
					null,
					"AQAAAEwhAAAAAAAAfCEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAATCEAAAAAAABMIQAAAAAAAAAAAAAAAPC/"
				],
				[
					73,
					1,
					"insert",
					{
						"characters": "1"
					},
					"AgAAAFwhAAAAAAAAXSEAAAAAAAAAAAAAXSEAAAAAAABdIQAAAAAAAAEAAAAy",
					"AQAAAAAAAAABAAAAXCEAAAAAAABdIQAAAAAAAAAAAAAAAPC/"
				],
				[
					78,
					1,
					"insert",
					{
						"characters": "lex."
					},
					"BQAAAGwhAAAAAAAAbSEAAAAAAAAAAAAAbSEAAAAAAABtIQAAAAAAAAUAAAB0b2tlbm0hAAAAAAAAbiEAAAAAAAAAAAAAbiEAAAAAAABvIQAAAAAAAAAAAABvIQAAAAAAAHAhAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAbCEAAAAAAABxIQAAAAAAAAAAAAAAAPC/"
				],
				[
					79,
					1,
					"insert",
					{
						"characters": "jks"
					},
					"AwAAAHAhAAAAAAAAcSEAAAAAAAAAAAAAcSEAAAAAAAByIQAAAAAAAAAAAAByIQAAAAAAAHMhAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAcCEAAAAAAABwIQAAAAAAAAAAAAAAAPC/"
				],
				[
					80,
					2,
					"left_delete",
					null,
					"AgAAAHIhAAAAAAAAciEAAAAAAAABAAAAc3EhAAAAAAAAcSEAAAAAAAABAAAAaw",
					"AQAAAAAAAAABAAAAcyEAAAAAAABzIQAAAAAAAAAAAAAAAPC/"
				],
				[
					81,
					1,
					"insert",
					{
						"characters": "s"
					},
					"AQAAAHEhAAAAAAAAciEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAcSEAAAAAAABxIQAAAAAAAAAAAAAAAPC/"
				],
				[
					90,
					3,
					"right_delete",
					null,
					"AwAAAHYhAAAAAAAAdiEAAAAAAAABAAAAb3YhAAAAAAAAdiEAAAAAAAABAAAAa3YhAAAAAAAAdiEAAAAAAAABAAAAZQ",
					"AQAAAAAAAAABAAAAdiEAAAAAAAB2IQAAAAAAAAAAAAAAAPC/"
				],
				[
					91,
					1,
					"left_delete",
					null,
					"AQAAAHUhAAAAAAAAdSEAAAAAAAABAAAAdA",
					"AQAAAAAAAAABAAAAdiEAAAAAAAB2IQAAAAAAAAAAAAAAAPC/"
				],
				[
					92,
					1,
					"insert",
					{
						"characters": "lex.jks"
					},
					"BwAAAHUhAAAAAAAAdiEAAAAAAAAAAAAAdiEAAAAAAAB3IQAAAAAAAAAAAAB3IQAAAAAAAHghAAAAAAAAAAAAAHghAAAAAAAAeSEAAAAAAAAAAAAAeSEAAAAAAAB6IQAAAAAAAAAAAAB6IQAAAAAAAHshAAAAAAAAAAAAAHshAAAAAAAAfCEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAdSEAAAAAAAB1IQAAAAAAAAAAAAAAAPC/"
				],
				[
					93,
					2,
					"left_delete",
					null,
					"AgAAAHshAAAAAAAAeyEAAAAAAAABAAAAc3ohAAAAAAAAeiEAAAAAAAABAAAAaw",
					"AQAAAAAAAAABAAAAfCEAAAAAAAB8IQAAAAAAAAAAAAAAAPC/"
				],
				[
					94,
					1,
					"insert",
					{
						"characters": "s"
					},
					"AQAAAHohAAAAAAAAeyEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAeiEAAAAAAAB6IQAAAAAAAAAAAAAAAPC/"
				],
				[
					97,
					1,
					"right_delete",
					null,
					"AQAAAHshAAAAAAAAeyEAAAAAAAABAAAAbg",
					"AQAAAAAAAAABAAAAeyEAAAAAAAB7IQAAAAAAAAAAAAAAAPC/"
				],
				[
					99,
					3,
					"right_delete",
					null,
					"AwAAAHghAAAAAAAAeCEAAAAAAAABAAAALnghAAAAAAAAeCEAAAAAAAABAAAAanghAAAAAAAAeCEAAAAAAAABAAAAcw",
					"AQAAAAAAAAABAAAAeCEAAAAAAAB4IQAAAAAAAAAAAAAAAPC/"
				],
				[
					100,
					1,
					"insert",
					{
						"characters": "er"
					},
					"AgAAAHghAAAAAAAAeSEAAAAAAAAAAAAAeSEAAAAAAAB6IQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAeCEAAAAAAAB4IQAAAAAAAAAAAAAAAPC/"
				],
				[
					102,
					3,
					"left_delete",
					null,
					"AwAAAHEhAAAAAAAAcSEAAAAAAAABAAAAc3AhAAAAAAAAcCEAAAAAAAABAAAAam8hAAAAAAAAbyEAAAAAAAABAAAALg",
					"AQAAAAAAAAABAAAAciEAAAAAAAByIQAAAAAAAAAAAAAAAPC/"
				],
				[
					103,
					1,
					"insert",
					{
						"characters": "er"
					},
					"AgAAAG8hAAAAAAAAcCEAAAAAAAAAAAAAcCEAAAAAAABxIQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAbyEAAAAAAABvIQAAAAAAAAAAAAAAAPC/"
				],
				[
					106,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAAAutwAAIyEvdXNyL2Jpbi9lbnYgcWpzbQppbXBvcnQgKiBhcyBvcyBmcm9tICdvcyc7CmltcG9ydCAqIGFzIHN0ZCBmcm9tICdzdGQnOwppbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7CmltcG9ydCBpbnNwZWN0IGZyb20gJ2luc3BlY3QnOwppbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnOwppbXBvcnQgeyBMZXhlciwgVG9rZW4gfSBmcm9tICdsZXhlcic7CmltcG9ydCB7IENvbnNvbGUgfSBmcm9tICdjb25zb2xlJzsKaW1wb3J0IEVDTUFTY3JpcHRMZXhlciBmcm9tICdsaWIvbGV4ZXIvZWNtYXNjcmlwdC5qcyc7CmltcG9ydCB7IGludGVyc2VjdGlvbiwgZGlmZmVyZW5jZSwgc3ltbWV0cmljRGlmZmVyZW5jZSwgdW5pb24sIGVycm9yLCBnZXRzZXQsIG1lbW9pemUsIHJhbmRJbnQsIGdldFR5cGVOYW1lLCBnZXRUeXBlU3RyLCBpc09iamVjdCwgc2hvcnRlbiwgdG9TdHJpbmcsIHRvQXJyYXlCdWZmZXIsIGRlZmluZSwgY3VycnksIHVuaXF1ZSwgc3BsaXQsIGV4dGVuZEFycmF5LCBjYW1lbGl6ZSwgZ2V0T3B0LCBxdW90ZSwgZXNjYXBlLCB0eXBlcyB9IGZyb20gJ3V0aWwnOwoKKCd1c2Ugc3RyaWN0Jyk7CigndXNlIG1hdGgnKTsKCmNvbnN0IGluc3BlY3RTeW1ib2wgPSBTeW1ib2wuZm9yKCdxdWlja2pzLmluc3BlY3QuY3VzdG9tJyk7CgpjbGFzcyBBcmd1bWVudEVycm9yIGV4dGVuZHMgRXJyb3IgewogIGNvbnN0cnVjdG9yKC4uLmFyZ3MpIHsKICAgIHN1cGVyKC4uLmFyZ3MpOwogICAgdGhpcy5zdGFjayA9IG51bGw7CiAgfQp9CgpsZXQgYnVmZmVycyA9IHt9LAogIG1vZHVsZXMgPSB7fSwKICBzaG93VGltaW5nLAogIHJlbW92ZUV4cG9ydHMgPSBmYWxzZSwKICBvbmx5SW1wb3J0cyA9IGZhbHNlLAogIGdsb2JhbEV4cG9ydHMgPSAwLAogIHNob3dEZXBzID0gMCwKICByZW1vdmVJbXBvcnRzID0gZmFsc2UsCiAgcmVtb3ZlQ29tbWVudHMgPSBmYWxzZSwKICByZWFkUGFja2FnZSA9IGZhbHNlLAogIHVzZXJTY3JpcHQgPSBmYWxzZSwKICByZWxhdGl2ZVRvLAogIG91dHB1dEZpbGUsCiAgcmVjdXJzaXZlLAogIGRlYnVnID0gMCwKICBoZWFkZXIgPSBbXSwKICBmb290ZXIgPSBbXSwKICBwcm9jZXNzZWQgPSBuZXcgU2V0KCksCiAgYnVmZmVyUmVmID0gbmV3IFdlYWtNYXAoKSwKICBmaWxlQnVmZmVycyA9IG5ldyBNYXAoKSwKICBmaWxlTWFwcyA9IG5ldyBNYXAoKSwKICBkZXBlbmRlbmN5TWFwID0gbmV3IE1hcCgpLAogIHByaW50RmlsZXMsCiAgcXVpZXQgPSBmYWxzZSwKICBsb2dGaWxlID0gKCkgPT4ge307CgpsZXQgZGVwZW5kZW5jeVRyZWUgPSBtZW1vaXplKGFyZyA9PiBbXSwgZGVwZW5kZW5jeU1hcCk7CmxldCBidWZmZXJNYXAgPSBnZXRzZXQoYnVmZmVyUmVmKTsKbGV0IGlkZW50aWZpZXJzVXNlZDsKCmZ1bmN0aW9uIFJlYWRKU09OKGZpbGVuYW1lKSB7CiAgbGV0IGRhdGEgPSBmcy5yZWFkRmlsZVN5bmMoZmlsZW5hbWUsICd1dGYtOCcpOwogIHJldHVybiBkYXRhID8gSlNPTi5wYXJzZShkYXRhKSA6IG51bGw7Cn0KCmNvbnN0IFJlYWRQYWNrYWdlSlNPTiA9IG1lbW9pemUoKCkgPT4gUmVhZEpTT04oJ3BhY2thZ2UuanNvbicpID8/IHsgX21vZHVsZUFsaWFzZXM6IHt9IH0pOwoKZnVuY3Rpb24gUmVzb2x2ZUFsaWFzKGZpbGVuYW1lKSB7CiAgbGV0IHsgX21vZHVsZUFsaWFzZXMgfSA9IFJlYWRQYWNrYWdlSlNPTigpOwoKICBpZihmaWxlbmFtZSBpbiBfbW9kdWxlQWxpYXNlcykgcmV0dXJuIF9tb2R1bGVBbGlhc2VzW2ZpbGVuYW1lXTsKICByZXR1cm4gZmlsZW5hbWU7Cn0KCmZ1bmN0aW9uIE5vcm1hbGl6ZVBhdGgocCkgewogIHAgPSBwYXRoLmFic29sdXRlKHApOwogIHAgPSBwYXRoLnJlbGF0aXZlKHAsIHBhdGguZ2V0Y3dkKCkpOwogIHAgPSBwYXRoLm5vcm1hbGl6ZShwKTsKICBpZighcGF0aC5pc0Fic29sdXRlKHApKSBpZiAoIXAuc3RhcnRzV2l0aCgnLi8nKSAmJiAhcC5zdGFydHNXaXRoKCcuLi8nKSAmJiBwICE9ICcuLicpIHAgPSAnLi8nICsgcDsKICByZXR1cm4gcDsKfQoKY29uc3QgRmlsZUJhbm5lckNvbW1lbnQgPSAoZmlsZW5hbWUsIGkpID0+IHsKICBsZXQgcyA9ICcnOwogIHMgKz0gYCAke2kgPyAnZW5kJyA6ICdzdGFydCd9IG9mICckey8qcGF0aC5iYXNlbmFtZSovIGZpbGVuYW1lfScgYDsKICBsZXQgbiA9IE1hdGgubWF4KDAsIE1hdGguZmxvb3IoKDgwIC0gNiAtIHMubGVuZ3RoKSAvIDIpKTsKICBzID0gJy8qICcgKyAnLScucmVwZWF0KG4pICsgczsKICBzICs9ICctJy5yZXBlYXQoTWF0aC5tYXgoMCwgODAgLSAzIC0gcy5sZW5ndGgpKSArICcgKi8nOwogIGlmKGkgPT0gMCkgcyA9ICdcbicgKyBzICsgJ1xuJzsKICBlbHNlIHMgPSBzICsgJ1xuJzsKICByZXR1cm4gczsKfTsKCmV4dGVuZEFycmF5KEFycmF5LnByb3RvdHlwZSk7Cgpjb25zdCBJc0J1aWx0aW4gPSBtb2R1bGVOYW1lID0+IC9eW15cLy5dKyQvLnRlc3QobW9kdWxlTmFtZSk7CmNvbnN0IGNvbXBhY3QgPSAobiwgbW9yZSA9IHt9KSA9PgogIGNvbnNvbGUuY29uZmlnKHsKICAgIGNvbXBhY3Q6IG4sCiAgICBtYXhBcnJheUxlbmd0aDogMTAwLAogICAgLi4ubW9yZQogIH0pOwpjb25zdCBBZGRVbmlxdWUgPSAoYXJyLCBpdGVtKSA9PiAoYXJyLmluZGV4T2YoaXRlbSkgPT0gLTEgPyBhcnIucHVzaChpdGVtKSA6IG51bGwpOwpjb25zdCBJbnRUb0RXb3JkID0gaXZhbCA9PiAoaXNOYU4oaXZhbCkgPT09IGZhbHNlICYmIGl2YWwgPCAwID8gaXZhbCArIDQyOTQ5NjcyOTYgOiBpdmFsKTsKY29uc3QgSW50VG9CaW5hcnkgPSBpID0+IChpID09IC0xIHx8IHR5cGVvZiBpICE9ICdudW1iZXInID8gaSA6ICcwYicgKyBJbnRUb0RXb3JkKGkpLnRvU3RyaW5nKDIpKTsKCmNvbnN0IFdoYXQgPSB7CiAgSU1QT1JUOiBTeW1ib2wuZm9yKCdpbXBvcnQnKSwKICBFWFBPUlQ6IFN5bWJvbC5mb3IoJ2V4cG9ydCcpCn07Cgpjb25zdCBJbXBvcnRUeXBlcyA9IHsKICBJTVBPUlQ6IDAsCiAgSU1QT1JUX0RFRkFVTFQ6IDEsCiAgSU1QT1JUX05BTUVTUEFDRTogMgp9OwoKY29uc3QgSXNPbmVPZiA9IGN1cnJ5KChuLCB2YWx1ZSkgPT4gKEFycmF5LmlzQXJyYXkobikgPyBuLnNvbWUobnVtID0+IG51bSA9PT0gdmFsdWUpIDogbiA9PT0gdmFsdWUpKTsKY29uc3QgVG9rSXMgPSBjdXJyeSgodHlwZSwgbGV4ZW1lLCB0b2spID0+IHsKICBpZih0b2sgIT0gdW5kZWZpbmVkKSB7CiAgICBpZihsZXhlbWUgIT0gdW5kZWZpbmVkKSBpZiAodHlwZW9mIGxleGVtZSA9PSAnc3RyaW5nJyAmJiAhSXNPbmVPZihsZXhlbWUsIHRvay5sZXhlbWUpKSByZXR1cm4gZmFsc2U7CiAgICBpZih0eXBlICE9IHVuZGVmaW5lZCkgewogICAgICBpZih0eXBlb2YgdHlwZSA9PSAnc3RyaW5nJyAmJiAhSXNPbmVPZih0eXBlLCB0b2sudHlwZSkpIHJldHVybiBmYWxzZTsKICAgICAgaWYodHlwZW9mIHR5cGUgPT0gJ251bWJlcicgJiYgIUlzT25lT2YodHlwZSwgdG9rLmlkKSkgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHJldHVybiB0cnVlOwogIH0KfSk7CmNvbnN0IENvbXBhcmVSYW5nZSA9IChhLCBiKSA9PiAoYSA9PT0gbnVsbCB8fCBiID09PSBudWxsID8gMCA6IHR5cGVvZiBhWzBdID09ICdudW1iZXInICYmIHR5cGVvZiBiWzBdID09ICdudW1iZXInICYmIGFbMF0gIT0gYlswXSA/IGFbMF0gLSBiWzBdIDogYVsxXSAtIGJbMV0pOwoKY29uc3QgSXNLZXl3b3JkID0gVG9rSXMoJ2tleXdvcmQnKTsKY29uc3QgSXNQdW5jdHVhdG9yID0gVG9rSXMoJ3B1bmN0dWF0b3InKTsKY29uc3QgSXNJZGVudGlmaWVyID0gVG9rSXMoJ2lkZW50aWZpZXInKTsKY29uc3QgSXNTdHJpbmdMaXRlcmFsID0gVG9rSXMoJ3N0cmluZ0xpdGVyYWwnKTsKY29uc3QgUHV0c0Z1bmN0aW9uID0gb3V0Rm4gPT4gc3RyID0+IHsKICBsZXQgYiA9IHR5cGVzLmlzQXJyYXlCdWZmZXIoc3RyKSA/IHN0ciA6IHRvQXJyYXlCdWZmZXIoc3RyKTsKICByZXR1cm4gb3V0Rm4oYiwgYi5ieXRlTGVuZ3RoKTsKfTsKCmNvbnN0IElzV2hpdGVTcGFjZSA9IHN0ciA9PiAvXlxzKiQvLnRlc3Qoc3RyKSB8fCBzdHIudHJpbSgpID09ICcnOwoKY29uc3QgZGVidWdMb2cgPSAoc3RyLCAuLi5hcmdzKSA9PiB7CiAgY29uc3QgcHJlZCA9IGFyZyA9PiBpc09iamVjdChhcmcpICYmICdjb21wYWN0JyBpbiBhcmc7CiAgbGV0IG9wdHMgPSBhcmdzLmZpbHRlcihwcmVkKTsKCiAgb3B0cyA9IG9wdHMucmVkdWNlKChhY2MsIG9wdCkgPT4gZGVmaW5lKGFjYywgb3B0KSwgb3B0cy5zaGlmdCgpID8/IHt9KTsKCiAgaWYob3B0cy5jb21wYWN0ID09PSB1bmRlZmluZWQpIGRlZmluZShvcHRzLCBjb21wYWN0KDEpKTsKICBpZihvcHRzLm1heEFycmF5TGVuZ3RoID09PSB1bmRlZmluZWQpIGRlZmluZShvcHRzLCB7IG1heEFycmF5TGVuZ3RoOiAxMCB9KTsKICBpZihvcHRzLmRlcHRoID09PSB1bmRlZmluZWQpIGRlZmluZShvcHRzLCB7IGRlcHRoOiBJbmZpbml0eSB9KTsKCiAgYXJncyA9IGFyZ3MuZmlsdGVyKGFyZyA9PiAhcHJlZChhcmcpKTsKCiAgb3B0cy5jb21wYWN0ID0gZmFsc2U7CgogIGNvbnNvbGUubG9nKHN0ciwgb3B0cywgLi4uYXJncyk7Cn07CgpmdW5jdGlvbiBGaWxlV3JpdGVyKGZpbGUpIHsKICBsZXQgZmQgPSBvcy5vcGVuKGZpbGUsIG9zLk9fV1JPTkxZIHwgb3MuT19DUkVBVCB8IG9zLk9fVFJVTkMsIDBvNjQ0KTsKICByZXR1cm4gZGVmaW5lKEZkV3JpdGVyKGZkLCBmaWxlKSwgewogICAgY2xvc2U6ICgpID0+IG9zLmNsb3NlKGZkKQogIH0pOwp9CgpmdW5jdGlvbiBGaWxlUmVwbGFjZXIoZmlsZSkgewogIGxldCBmZCA9IG9zLm9wZW4oZmlsZSArICcubmV3Jywgb3MuT19XUk9OTFkgfCBvcy5PX0NSRUFUIHwgb3MuT19UUlVOQywgMG82NDQpOwogIHJldHVybiBkZWZpbmUoRmRXcml0ZXIoZmQsIGZpbGUpLCB7CiAgICBjbG9zZTogKCkgPT4gewogICAgICAvL2NvbnNvbGUubG9nKCdGaWxlUmVwbGFjZXIuY2xvc2UnLCBmZCk7CiAgICAgIGxldCBzaXplID0gZnMuc2l6ZVN5bmMoZmQpOwogICAgICBvcy5jbG9zZShmZCk7CiAgICAgIGxldCBlcnIgPSBvcy5yZW5hbWUoZmlsZSwgZmlsZSArICcub2xkJyk7CiAgICAgIGVyciA9IG9zLnJlbmFtZShmaWxlICsgJy5uZXcnLCBmaWxlKTsKICAgICAgLy9jb25zb2xlLmxvZygnb3MucmVuYW1lKCkgPScsIGVycik7CiAgICAgIGlmKGVycikgdGhyb3cgbmV3IEVycm9yKGBGaWxlUmVwbGFjZXIgcmVuYW1lKCkgZXJyb3I6ICR7c3RkLnN0cmVycm9yKC1lcnIpfWApOwogICAgICBjb25zb2xlLmxvZyhgJHtmaWxlfSB3cml0dGVuICgke3NpemV9IGJ5dGVzKWApOwogICAgfQogIH0pOwp9CgpmdW5jdGlvbiBGZFdyaXRlcihmZCwgZmlsZSkgewogIGxldCBmbjsKICBmbiA9IChidWYsIGxlbikgPT4gewogICAgaWYoIXR5cGVzLmlzQXJyYXlCdWZmZXIoYnVmKSkgYnVmID0gdG9BcnJheUJ1ZmZlcihidWYpOwogICAgbGVuID8/PSBidWYuYnl0ZUxlbmd0aDsKICAgIGxldCByZXN1bHQgPSBvcy53cml0ZShmZCwgYnVmLCAwLCBsZW4pOwogICAgcmV0dXJuIHJlc3VsdDsKICB9OwoKICBkZWZpbmUoZm4sIHsKICAgIGZkLAogICAgZmlsZSwKICAgIHB1dHM6IFB1dHNGdW5jdGlvbihmbiksCiAgICB3cml0ZTogZm4sCiAgICBjbG9zZTogKCkgPT4ge30sCiAgICBzZWVrOiAod2hlbmNlLCBvZmZzZXQpID0+IG9zLnNlZWsoZmQsIHdoZW5jZSwgb2Zmc2V0KSwKICAgIFtTeW1ib2wudG9TdHJpbmdUYWddOiBgRmlsZVdyaXRlcjwgJHtmZH0gPmAsCiAgICBpbnNwZWN0KCkgewogICAgICByZXR1cm4gaW5zcGVjdCh7IGZkIH0pID8/IHRoaXNbU3ltYm9sLnRvU3RyaW5nVGFnXTsKICAgIH0KICB9KTsKICByZXR1cm4gZm47Cn0KCmZ1bmN0aW9uIER1bW15V3JpdGVyKG5hbWUpIHsKICBsZXQgZm4gPSAoYnVmLCBsZW4pID0+IGxlbjsKICBkZWZpbmUoZm4sIHsKICAgIG5hbWUsCiAgICBwdXRzOiBQdXRzRnVuY3Rpb24oZm4pLAogICAgd3JpdGU6IGZuLAogICAgY2xvc2U6ICgpID0+IHt9LAogICAgc2VlazogKCkgPT4ge30sCiAgICBbU3ltYm9sLnRvU3RyaW5nVGFnXTogYER1bW15V3JpdGVyPCAke25hbWV9ID5gLAogICAgaW5zcGVjdCgpIHsKICAgICAgcmV0dXJuIGluc3BlY3QoeyBmZCB9KSA/PyB0aGlzW1N5bWJvbC50b1N0cmluZ1RhZ107CiAgICB9CiAgfSk7CiAgcmV0dXJuIGZuOwp9CgpmdW5jdGlvbiBJbXBvcnRJZHMoc2VxKSB7CiAgcmV0dXJuIHNlcS5maWx0ZXIodG9rID0+IElzSWRlbnRpZmllcihudWxsLCB0b2spKTsKfQoKZnVuY3Rpb24gSW1wRXhwVHlwZShzZXEpIHsKICBpZihzZXEuc29tZSh0b2sgPT4gSXNLZXl3b3JkKCdpbXBvcnQnLCB0b2spKSkgcmV0dXJuIFdoYXQuSU1QT1JUOwogIGlmKHNlcS5zb21lKHRvayA9PiBJc0tleXdvcmQoJ2V4cG9ydCcsIHRvaykpKSByZXR1cm4gV2hhdC5FWFBPUlQ7Cn0KCmZ1bmN0aW9uIEltcG9ydFR5cGUoc2VxKSB7CiAgaWYoSXNLZXl3b3JkKFsnaW1wb3J0JywgJ2V4cG9ydCddLCBzZXFbMF0pKSBzZXEuc2hpZnQoKTsKICBpZihJc1B1bmN0dWF0b3IoJyonLCBzZXFbMF0pKSB7CiAgICBpZihJc0tleXdvcmQoJ2FzJywgc2VxWzFdKSkgcmV0dXJuIEltcG9ydFR5cGVzLklNUE9SVF9OQU1FU1BBQ0U7CiAgfSBlbHNlIGlmKElzSWRlbnRpZmllcih1bmRlZmluZWQsIHNlcVswXSkpIHsKICAgIGlmKElzS2V5d29yZCgnZnJvbScsIHNlcVsxXSkpIHJldHVybiBJbXBvcnRUeXBlcy5JTVBPUlRfREVGQVVMVDsKICB9CgogIHJldHVybiBJbXBvcnRUeXBlcy5JTVBPUlQ7Cn0KCmZ1bmN0aW9uIEltcG9ydEZpbGUoc2VxKSB7CiAgc2VxID0gTm9uV1Moc2VxKTsKICBsZXQgaWR4ID0gc2VxLmZpbmRJbmRleCh0b2sgPT4gSXNLZXl3b3JkKCdmcm9tJywgdG9rKSk7CiAgd2hpbGUoc2VxW2lkeF0gJiYgc2VxW2lkeF0udHlwZSAhPSAnc3RyaW5nTGl0ZXJhbCcpICsraWR4OwogIGlmKHNlcVtpZHhdKQogICAgaWYoc2VxW2lkeF0udHlwZSA9PSAnc3RyaW5nTGl0ZXJhbCcpIHsKICAgICAgbGV0IGYgPSBzZXFbaWR4XS5sZXhlbWUucmVwbGFjZSgvXltcJ1wiXGBdKC4qKVtcJ1wiXGBdJC9nLCAnJDEnKTsKICAgICAgcmV0dXJuIGY7CiAgICB9Cn0KCmZ1bmN0aW9uIEV4cG9ydE5hbWUoc2VxKSB7CiAgbGV0IGlkeCA9IHNlcS5maW5kSW5kZXgodG9rID0+IElzSWRlbnRpZmllcih1bmRlZmluZWQsIHRvaykgfHwgSXNLZXl3b3JkKCdkZWZhdWx0JywgdG9rKSk7CgogIHdoaWxlKHNlcVtpZHhdICYmIHNlcVtpZHhdLnR5cGUgIT0gJ2lkZW50aWZpZXInKSBpZHgrKzsKCiAgcmV0dXJuIHNlcVtpZHhdPy5sZXhlbWU7Cn0KCmZ1bmN0aW9uIEJ5dGVTZXF1ZW5jZSh0b2tlbnMpIHsKICBpZih0b2tlbnMubGVuZ3RoKSB7CiAgICBsZXQgeyBsb2MgfSA9IHRva2Vuc1swXTsKICAgIGxldCBzdGFydCA9IGxvYy5ieXRlT2Zmc2V0OwogICAgbGV0IHRvdGFsID0gdG9rZW5zLnJlZHVjZSgobiwgdCkgPT4gbiArIHQuYnl0ZUxlbmd0aCwgMCk7CiAgICBsZXQgZW5kID0gc3RhcnQgKyB0b3RhbDsKICAgIC8vbGV0IGxpbmUgPSB0b1N0cmluZyhCdWZmZXJGaWxlKGxvYy5maWxlKS5zbGljZShzdGFydCwgZW5kKSk7CiAgICByZXR1cm4gW3N0YXJ0LCBlbmRdOwogIH0KfQoKZnVuY3Rpb24gTW9kdWxlTG9hZGVyKG1vZHVsZSkgewogIGxldCBmaWxlOwoKICBpZihwYXRoLmlzRGlyZWN0b3J5KG1vZHVsZSkpIHsKICAgIGZpbGUgPSBNb2R1bGVMb2FkZXIocGF0aC5qb2luKG1vZHVsZSwgJ2luZGV4LmpzJykpOwogIH0gZWxzZSBpZihwYXRoLmlzRmlsZShtb2R1bGUpKSB7CiAgICBmaWxlID0gbW9kdWxlOwogIH0gZWxzZSBpZighL1wuanMkLy50ZXN0KG1vZHVsZSkpIHsKICAgIGZpbGUgPSBNb2R1bGVMb2FkZXIobW9kdWxlICsgJy5qcycpOwogIH0KCiAgcmV0dXJuIGZpbGU7Cn0KCmZ1bmN0aW9uIFByb2Nlc3NGaWxlKHNvdXJjZSwgbG9nID0gKCkgPT4ge30sIHJlY3Vyc2l2ZSwgZGVwdGggPSAwKSB7CiAgc291cmNlID0gcGF0aC5ub3JtYWxpemUoc291cmNlKTsKCiAgaWYocHJpbnRGaWxlcykgc3RkLnB1dHMoc291cmNlICsgJ1xuJyk7CgogIGlmKHJlYWRQYWNrYWdlKSBzb3VyY2UgPSBSZXNvbHZlQWxpYXMoc291cmNlKTsKCiAgbG9nKGBQcm9jZXNzaW5nICR7c291cmNlfWApOwoKICBsZXQgc3RhcnQgPSBEYXRlLm5vdygpOwogIGNvbnN0IGRpciA9IHBhdGguZGlybmFtZShzb3VyY2UpOwoKICBpZihkZWJ1ZyA+PSAyKSBjb25zb2xlLmxvZygnUHJvY2Vzc0ZpbGUnLCB7IHNvdXJjZSB9KTsKCiAgbGV0IGJ5dGVidWYgPSBCdWZmZXJGaWxlKHNvdXJjZSk7CgogIGxldCBsZW4gPSBieXRlYnVmLmJ5dGVMZW5ndGgsCiAgICB0eXBlID0gcGF0aC5leHRuYW1lKHNvdXJjZSkuc3Vic3RyaW5nKDEpLAogICAgYmFzZSA9IGNhbWVsaXplKHBhdGguYmFzZW5hbWUoc291cmNlLCAnLicgKyB0eXBlKS5yZXBsYWNlKC9bXjAtOUEtWmEtel9dL2csICdfJykpOwoKICBsZXQgbGV4ID0gewogICAganM6IG5ldyBFQ01BU2NyaXB0TGV4ZXIoYnl0ZWJ1Ziwgc291cmNlKQogIH07CgogIGxleC5tanMgPSBsZXguanM7CiAgbGV4LmNqcyA9IGxleC5qczsKICBsZXguanNvbiA9IGxleC5qczsKCiAgY29uc3QgbGV4ZXIgPSBsZXhbdHlwZV07CiAgICBpZihkZWJ1ZyA+PSAxKSBjb25zb2xlLmxvZygnbGV4ZXInLCBsZXhlcik7CgogIC8vIFQgPSBsZXhlci50b2tlbnMucmVkdWNlKChhY2MsIG5hbWUsIGlkKSA9PiAoeyAuLi5hY2MsIFtuYW1lXTogaWQgfSksIHt9KTsKCiAgbGV0IGUgPSBuZXcgU3ludGF4RXJyb3IoKTsKCiAgaWYoIWxleGVyKSB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGxleGluZzogJHtzb3VyY2V9YCk7CgogIGxleGVyLmhhbmRsZXIgPSBsZXggPT4gewogICAgY29uc3QgeyBsb2MsIG1vZGUsIHBvcywgc3RhcnQsIGJ5dGVMZW5ndGgsIHN0YXRlIH0gPSBsZXg7CiAgICBsb2coJyAnLnJlcGVhdChsb2MuY29sdW1uIC0gMSkgKyAnXicpOwogIH07CgogIGxldCB0b2tlbkxpc3QgPSBbXSwKICAgIGRlY2xhcmF0aW9ucyA9IFtdOwogIGNvbnN0IGNvbFNpemVzID0gWzEyLCA4LCA0LCAyMCwgMzIsIDEwLCAwXTsKCiAgbGV0IHRvaywKICAgIGkgPSAwLAogICAgbWFzayA9IEludFRvQmluYXJ5KGxleGVyLm1hc2spLAogICAgc3RhdGUgPSBsZXhlci50b3BTdGF0ZSgpOwogIGxleGVyLmJlZ2luQ29kZSA9ICgpID0+IChjb2RlID09ICdqcycgPyAwYjEwMDAgOiAwYjAxMDApOwogIGNvbnN0IGJhbGFuY2VyID0gKCkgPT4gewogICAgbGV0IHNlbGY7CiAgICBsZXQgc3RhY2sgPSBbXTsKICAgIGNvbnN0IHRhYmxlID0geyAnfSc6ICd7JywgJ10nOiAnWycsICcpJzogJygnIH07CgogICAgc2VsZiA9IGZ1bmN0aW9uIFBhcmVudGhlc2VCYWxhbmNlcih0b2spIHsKICAgICAgc3dpdGNoICh0b2s/LmxleGVtZSkgewogICAgICAgIGNhc2UgJ3snOgogICAgICAgIGNhc2UgJ1snOgogICAgICAgIGNhc2UgJygnOiB7CiAgICAgICAgICBzdGFjay5wdXNoKHRvay5sZXhlbWUpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQoKICAgICAgICBjYXNlICd9JzoKICAgICAgICBjYXNlICddJzoKICAgICAgICBjYXNlICcpJzogewogICAgICAgICAgaWYoc3RhY2subGFzdCAhPSB0YWJsZVt0b2subGV4ZW1lXSkgdGhyb3cgbmV3IEVycm9yKGB0b3AgJyR7c3RhY2subGFzdH0nICE9ICcke3Rvay5sZXhlbWV9JyBbICR7c3RhY2subWFwKHMgPT4gYCcke3N9J2ApLmpvaW4oJywgJyl9IF1gKTsKCiAgICAgICAgICBzdGFjay5wb3AoKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBPYmplY3QuYXNzaWduKHNlbGYsIHsKICAgICAgc3RhY2ssCiAgICAgIHJlc2V0KCkgewogICAgICAgIHN0YWNrLmNsZWFyKCk7CiAgICAgIH0sCiAgICAgIC8qIHByZXR0aWVyLWlnbm9yZSAqLyBnZXQgZGVwdGgoKSB7CiAgICAgICAgcmV0dXJuIHN0YWNrLmxlbmd0aDsKICAgICAgfQogICAgfSk7CgogICAgcmV0dXJuIHNlbGY7CiAgfTsKCiAgbGV0IGJhbGFuY2VycyA9IFtiYWxhbmNlcigpXSwKICAgIGltcG9ydHMgPSBbXSwKICAgIGV4cG9ydHMgPSBbXSwKICAgIGNvbW1lbnRzID0gW10sCiAgICBpbXBleHAsCiAgICBjb25kLAogICAgaW1wID0gW10sCiAgICBzaG93VG9rZW4gPSB0b2sgPT4gewogICAgICBpZigobGV4ZXIuY29uc3RydWN0b3IgIT0gRUNNQVNjcmlwdExleGVyICYmIHRvay50eXBlICE9ICd3aGl0ZXNwYWNlJykgfHwgL14oKGltfGV4KXBvcnR8ZnJvbXxhcykkLy50ZXN0KHRvay5sZXhlbWUpKSB7CiAgICAgICAgbGV0IGEgPSBbLyooZmlsZSArICc6JyArIHRvay5sb2MpLnBhZEVuZChmaWxlLmxlbmd0aCsxMCksKi8gdG9rLnR5cGUucGFkRW5kKDIwLCAnICcpLCBlc2NhcGUodG9rLmxleGVtZSldOwogICAgICAgIHN0ZC5wdXRzKGEuam9pbignJykgKyAnXG4nKTsKICAgICAgfQogICAgfTsKCiAgY29uc3QgUGF0aEFkanVzdCA9IHMgPT4gewogICAgbGV0IGogPSBwYXRoLmpvaW4oZGlyLCBzKTsKICAgIGogPSBwYXRoLmNvbGxhcHNlKGopOwogICAgaiA9IHBhdGgubm9ybWFsaXplKGopOwogICAgaWYocGF0aC5pc1JlbGF0aXZlKGopKSBqID0gJy4vJyArIGo7CiAgICByZXR1cm4gTW9kdWxlTG9hZGVyKGopOwogIH07CgogIGxldCBwcmV2VG9rZW4sCiAgICBkb25lSW1wb3J0cywKICAgIHVzZWQgPSBpZGVudGlmaWVyc1VzZWQgPyBpZGVudGlmaWVyc1VzZWQoc291cmNlKSA6IG51bGw7CiAgZm9yKDs7KSB7CiAgICBsZXQgeyBzdGF0ZURlcHRoIH0gPSBsZXhlcjsKICAgIGxldCB2YWx1ZSA9IGxleGVyLm5leHQoKTsKICAgIGxldCBkb25lID0gdmFsdWUgPT09IHVuZGVmaW5lZDsKICAgIGlmKGRvbmUpIGJyZWFrOwogICAgbGV0IG5ld1N0YXRlID0gbGV4ZXIudG9wU3RhdGUoKTsKICAgIGlmKG5ld1N0YXRlICE9IHN0YXRlKSB7CiAgICAgIGlmKHN0YXRlID09ICdURU1QTEFURScgJiYgbGV4ZXIuc3RhdGVEZXB0aCA+IHN0YXRlRGVwdGgpIGJhbGFuY2Vycy5wdXNoKGJhbGFuY2VyKCkpOwogICAgICBpZihuZXdTdGF0ZSA9PSAnVEVNUExBVEUnICYmIGxleGVyLnN0YXRlRGVwdGggPCBzdGF0ZURlcHRoKSBiYWxhbmNlcnMucG9wKCk7CiAgICB9CgogICAgbGV0IG4gPSBiYWxhbmNlcnMubGFzdC5kZXB0aDsKICAgIGNvbnN0IHsgdG9rZW4gfSA9IGxleGVyOwogICAgaWYoIXRva2VuKSBicmVhazsKICAgIGNvbnN0IHsgbGVuZ3RoLCBzZXEgfSA9IHRva2VuOwoKICAgIGlmKHRva2VuLnR5cGUgPT0gJ2lkZW50aWZpZXInKSB7CiAgICAgIGlmKGRvbmVJbXBvcnRzKSB7CiAgICAgICAgaWYodXNlZCkgewogICAgICAgICAgbGV0IHsgc2l6ZSB9ID0gdXNlZDsKICAgICAgICAgIHVzZWQuYWRkKHRva2VuLmxleGVtZSk7CiAgICAgICAgICBpZihkZWJ1ZyA+PSAyKSBjb25zb2xlLmxvZyhgYWRkZWRbJHtzaXplfV1gLCBzb3VyY2UsIHRva2VuLmxleGVtZSk7CiAgICAgICAgfQogICAgICB9IC8qZWxzZSB7CiAgICAgICAgaW1wb3J0ZWQuYWRkKHRva2VuLmxleGVtZSk7CiAgICAgIH0qLwogICAgfQoKICAgIGlmKGRlYnVnID49IDIpIGNvbnNvbGUubG9nKCd0b2tlbicsIHRva2VuKTsKICAgIC8qICAgaWYoZGVidWcgPj0gMSkgY29uc29sZS5sb2coJ2xleGVyLm1vZGUnLCBsZXhlci5tb2RlKTsKICAgICAqLwogICAgaWYobiA9PSAwICYmIHRva2VuLmxleGVtZSA9PSAnfScgJiYgbGV4ZXIuc3RhdGVEZXB0aCA+IDApIHsKICAgICAgbGV4ZXIucG9wU3RhdGUoKTsKICAgIH0gZWxzZSB7CiAgICAgIGJhbGFuY2VyKHRva2VuKTsKICAgICAgaWYobiA+IDAgJiYgYmFsYW5jZXJzLmxhc3QuZGVwdGggPT0gMCkgbG9nKCdiYWxhbmNlcicpOwogICAgICBpZigvY29tbWVudC9pLnRlc3QodG9rZW4udHlwZSkpIHsKICAgICAgICBjb21tZW50cy5wdXNoKHRva2VuKTsKICAgICAgfQoKICAgICAgaWYoWydpbXBvcnQnLCAnZXhwb3J0J10uaW5kZXhPZih0b2tlbi5sZXhlbWUpID49IDApIHsKICAgICAgICBpbXBleHAgPSBXaGF0W3Rva2VuLmxleGVtZS50b1VwcGVyQ2FzZSgpXTsKICAgICAgICBjb25kID0gdHJ1ZTsKICAgICAgICBpbXAgPSB0b2tlbi5sZXhlbWUgPT0gJ2V4cG9ydCcgPyBbdG9rZW5dIDogW107CiAgICAgIH0KCiAgICAgIGlmKGRlYnVnID49IDMpIGNvbnNvbGUubG9nKGB0b2tlblske2ltcC5sZW5ndGh9XWAsIHRva2VuLmxvYyArICcnLCBjb25zb2xlLmNvbmZpZyh7IGJyZWFrTGVuZ3RoOiA4MCwgY29tcGFjdDogMCB9KSwgdG9rZW4pOwoKICAgICAgaWYodG9rZW4ubGV4ZW1lID09ICc7JyAmJiBjb25kICE9PSB0cnVlKSBkb25lSW1wb3J0cyA9IHRydWU7CgogICAgICBpZihvbmx5SW1wb3J0cyAmJiBkb25lSW1wb3J0cykgYnJlYWs7CgogICAgICBpZihjb25kID09IHRydWUpIHsKICAgICAgICBpZihpbXAuaW5kZXhPZih0b2tlbikgPT0gLTEpIGltcC5wdXNoKHRva2VuKTsKICAgICAgICAvL2NvbnNvbGUubG9nKCBpbXBbMF0ubG9jKycnLGNvbnNvbGUuY29uZmlnKHticmVha0xlbmd0aDo4MCwgY29tcGFjdDogMH0pLCBOb25XUyhpbXApKTsKICAgICAgICBpZihpbXAubGFzdC5sZXhlbWUgPT0gJzsnKSB7CiAgICAgICAgICBpZihkZWJ1ZyA+IDIpCiAgICAgICAgICAgIGNvbnNvbGUubG9nKAogICAgICAgICAgICAgICdpbXAnLAogICAgICAgICAgICAgIGltcFswXS5sb2MgKyAnJywKICAgICAgICAgICAgICBjb25zb2xlLmNvbmZpZyh7CiAgICAgICAgICAgICAgICBicmVha0xlbmd0aDogODAsCiAgICAgICAgICAgICAgICBjb21wYWN0OiAwCiAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgVG9rZW5TZXF1ZW5jZShpbXApICsgJycKICAgICAgICAgICAgKTsKICAgICAgICAgIGNvbmQgPSBmYWxzZTsKICAgICAgICAgIGlmKGltcGV4cCA9PSBXaGF0LklNUE9SVCB8fCBpbXAuc29tZShpID0+IElzS2V5d29yZCgnZnJvbScsIGkpKSkgewogICAgICAgICAgICBpZihpbXBbMV0ubGV4ZW1lICE9ICcoJykgewogICAgICAgICAgICAgIGxldCBvYmogPSBuZXcgSW1wb3J0KGltcCwgUGF0aEFkanVzdCwgZGVwdGgpOwogICAgICAgICAgICAgIGlmKG9iaikgewogICAgICAgICAgICAgICAgb2JqLnNvdXJjZSA9IHNvdXJjZTsKICAgICAgICAgICAgICAgIGltcG9ydHMucHVzaChvYmopOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgbGV0IG9iaiA9IG5ldyBFeHBvcnQoaW1wLCBQYXRoQWRqdXN0LCBkZXB0aCk7CiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ29iaicsY29uc29sZS5jb25maWcoe2JyZWFrTGVuZ3RoOjgwLCBjb21wYWN0OiAxfSksIG9iaiwgb2JqLmxvYysnJyk7CiAgICAgICAgICAgIGlmKG9iaikgewogICAgICAgICAgICAgIG9iai5zb3VyY2UgPSBzb3VyY2U7CgogICAgICAgICAgICAgIGV4cG9ydHMucHVzaChvYmopOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICBwcmV2VG9rZW4gPSB0b2tlbjsKICAgIH0KCiAgICBzdGF0ZSA9IG5ld1N0YXRlOwogIH0KCiAgZnVuY3Rpb24gRXhwb3J0KHRva2VucywgcmVsYXRpdmVQYXRoID0gcyA9PiBzKSB7CiAgICBpZih0b2tlbnNbMF0uc2VxID09IHRva2Vuc1sxXS5zZXEpIHRva2Vucy5zaGlmdCgpOwogICAgY29uc3QgeyBsb2MsIHNlcSB9ID0gdG9rZW5zWzBdOwogICAgaWYoIS9eKGltfGV4KXBvcnQkL2kudGVzdCh0b2tlbnNbMF0ubGV4ZW1lKSkgdGhyb3cgbmV3IEVycm9yKGBBZGRFeHBvcnQgdG9rZW5zOiBgICsgaW5zcGVjdCh0b2tlbnMsIHsgY29tcGFjdDogZmFsc2UgfSkpOwogICAgbGV0IGRlZiA9IHRva2Vucy5maW5kSW5kZXgodG9rID0+IElzS2V5d29yZCgnZGVmYXVsdCcsIHRvaykpOwogICAgbGV0IGsgPSAxOwogICAgd2hpbGUodG9rZW5zW2tdLnR5cGUgPT0gJ3doaXRlc3BhY2UnIHx8IElzS2V5d29yZChbJ2xldCcsICdjbGFzcycsICdmdW5jdGlvbicsICdjb25zdCddLCB0b2tlbnNba10pKSBrKys7CiAgICB3aGlsZSh0b2tlbnNba10gJiYgdG9rZW5zW2tdLnR5cGUgIT0gJ2lkZW50aWZpZXInKSBrKys7CiAgICBsZXQgbmFtZSA9IEV4cG9ydE5hbWUodG9rZW5zKTsKICAgIGxldCBleHBvcnRlZCA9IGRlZiAhPSAtMSA/ICdkZWZhdWx0JyA6IG5hbWU7CiAgICBsZXQgZmlsZSA9IEltcG9ydEZpbGUodG9rZW5zKTsKICAgIGlmKGZpbGUgPT0gJyAnKSB0aHJvdyBuZXcgRXJyb3IoJ1hYWCAnICsgaW5zcGVjdCh0b2tlbnMsIHsgY29tcGFjdDogZmFsc2UgfSkpOwogICAgY29uc3QgaWR4ID0gZGVmICE9IC0xID8gZGVmIDogZmlsZSA/IHRva2Vucy5maW5kSW5kZXgodG9rID0+IHRvay5sZXhlbWUgPT0gJzsnKSA6IHRva2Vucy5zbGljZSgxKS5maW5kSW5kZXgodG9rID0+IHRvay50eXBlICE9ICd3aGl0ZXNwYWNlJyk7CiAgICBjb25zdCBvID0gTm9uV1ModG9rZW5zKVsxXS5sZXhlbWUgPT0gJ3snOwogICAgY29uc3QgcmVtb3ZlID0gbyB8fCBkZWYgIT0gLTEgPyB0b2tlbnMuc2xpY2UoKSA6IHRva2Vucy5zbGljZSgwLCBkZWYgPT0gaWR4ID8gaWR4ICsgMiA6IGlkeCArIDEpOwogICAgaWYocmVtb3ZlWzBdKSBpZiAocmVtb3ZlWzBdLmxleGVtZSAhPSAnZXhwb3J0JykgdGhyb3cgbmV3IEVycm9yKGBBZGRFeHBvcnQgdG9rZW5zOiBgICsgaW5zcGVjdCh0b2tlbnMsIHsgY29tcGFjdDogZmFsc2UgfSkpOwogICAgY29uc3QgcmFuZ2UgPSBCeXRlU2VxdWVuY2UocmVtb3ZlKSA/PyBCeXRlU2VxdWVuY2UodG9rZW5zKTsKICAgIGxldCBzb3VyY2UgPSBsb2MuZmlsZTsKICAgIGxldCB0eXBlID0gSW1wRXhwVHlwZSh0b2tlbnMpOwogICAgbGV0IGNvZGUgPSBUb2tlblNlcXVlbmNlKHRva2VucykudG9TdHJpbmcoKTsgLy8gdG9TdHJpbmcoQnVmZmVyRmlsZShzb3VyY2UpLnNsaWNlKC4uLnJhbmdlKSk7CiAgICBpZihkZWYgIT0gLTEpCiAgICAgIGlmKGRlYnVnID49IDIpCiAgICAgICAgY29uc29sZS5sb2coJ0FkZEV4cG9ydCcsIHsKICAgICAgICAgIHNvdXJjZSwKICAgICAgICAgIGZpbGUsCiAgICAgICAgICBjb2RlLAogICAgICAgICAgcmFuZ2UsCiAgICAgICAgICBsb2MsCiAgICAgICAgICB0b2tlbnMKICAgICAgICB9KTsKICAgIGxldCBsZW4gPSB0b2tlbnMubGVuZ3RoOwogICAgaWYobykgewogICAgICBleHBvcnRlZCA9IHRva2Vucy5maWx0ZXIodG9rID0+IHRvay50eXBlID09ICdpZGVudGlmaWVyJykubWFwKHRvayA9PiB0b2subGV4ZW1lKTsKICAgIH0KCiAgICBpZihOb25XUyh0b2tlbnMpWzFdLmxleGVtZSAhPSAneycpIGxlbiA9IHRva2Vucy5maW5kSW5kZXgodG9rID0+IElzSWRlbnRpZmllcih1bmRlZmluZWQsIHRvaykgfHwgSXNLZXl3b3JkKCdkZWZhdWx0JywgdG9rKSkgKyAxOwogICAgdG9rZW5zID0gdG9rZW5zLnNsaWNlKDAsIGxlbik7CiAgICBsZXQgZXhwID0gZGVmaW5lKAogICAgICB7CiAgICAgICAgdHlwZTogV2hhdC5FWFBPUlQsCiAgICAgICAgZmlsZTogZmlsZSAmJiAvXC4vLnRlc3QoZmlsZSkgPyByZWxhdGl2ZVBhdGgoZmlsZSkgOiBmaWxlLAogICAgICAgIHRva2VucywKICAgICAgICBleHBvcnRlZCwKICAgICAgICBuYW1lLAogICAgICAgIHJhbmdlCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBjb2RlLAogICAgICAgIGxvYywKICAgICAgICBkZXB0aCwKICAgICAgICBwYXRoKCkgewogICAgICAgICAgY29uc3QgeyBmaWxlIH0gPSB0aGlzOwogICAgICAgICAgaWYodHlwZW9mIGZpbGUgPT0gJ3N0cmluZycpIHJldHVybiByZWxhdGl2ZVBhdGgoZmlsZSk7CiAgICAgICAgfQogICAgICB9CiAgICApOwogICAgcmV0dXJuIE9iamVjdC5zZXRQcm90b3R5cGVPZihleHAsIEV4cG9ydC5wcm90b3R5cGUpOwogIH0KCiAgZGVmaW5lKEV4cG9ydC5wcm90b3R5cGUsIHsKICAgIGlkcygpIHsKICAgICAgcmV0dXJuIEltcG9ydElkcyh0aGlzLnRva2VucykubWFwKCh7IGxleGVtZSB9KSA9PiBsZXhlbWUpOwogICAgfQogIH0pOwoKICBmdW5jdGlvbiBJbXBvcnQodG9rZW5zLCByZWxhdGl2ZVBhdGggPSBzID0+IHMsIGRlcHRoKSB7CiAgICB0b2tlbnMgPSB0b2tlbnNbMF0uc2VxID09PSB0b2tlbnNbMV0uc2VxID8gdG9rZW5zLnNsaWNlKDEpIDogdG9rZW5zLnNsaWNlKCk7CiAgICBpZighL14oaW18ZXgpcG9ydCQvaS50ZXN0KHRva2Vuc1swXS5sZXhlbWUpKSB0aHJvdyBuZXcgRXJyb3IoYEFkZEltcG9ydCB0b2tlbnM6IGAgKyBpbnNwZWN0KHRva2VucywgeyBjb21wYWN0OiBmYWxzZSB9KSk7CiAgICBjb25zdCB0b2sgPSB0b2tlbnNbMF07CiAgICBjb25zdCB7IGxvYywgc2VxIH0gPSB0b2s7CiAgICBsZXQgc291cmNlID0gbG9jLmZpbGU7CiAgICBsZXQgdHlwZSA9IEltcEV4cFR5cGUodG9rZW5zLnNsaWNlKCkpLAogICAgICBmaWxlID0gSW1wb3J0RmlsZSh0b2tlbnMuc2xpY2UoKSk7CiAgICBjb25zdCByYW5nZSA9IEJ5dGVTZXF1ZW5jZSh0b2tlbnMuc2xpY2UoKSk7CiAgICByYW5nZVswXSA9IGxvYy5ieXRlT2Zmc2V0OwogICAgbGV0IGNvZGUgPSB0b1N0cmluZyhCdWZmZXJGaWxlKHNvdXJjZSkuc2xpY2UoLi4ucmFuZ2UpKTsKICAgIGlmKGRlYnVnID49IDIpCiAgICAgIGNvbnNvbGUubG9nKCdBZGRJbXBvcnQnLCBjb21wYWN0KDEpLCB7CiAgICAgICAgc291cmNlLAogICAgICAgIGZpbGUsCiAgICAgICAgY29kZSwKICAgICAgICBsb2MsCiAgICAgICAgcmFuZ2UKICAgICAgfSk7CiAgICBsZXQgaW1wID0gT2JqZWN0LnNldFByb3RvdHlwZU9mKAogICAgICBkZWZpbmUoCiAgICAgICAgewogICAgICAgICAgdHlwZSwKICAgICAgICAgIGZpbGU6IGZpbGUgJiYgL1wuLy50ZXN0KGZpbGUpID8gcmVsYXRpdmVQYXRoKGZpbGUpIDogZmlsZSwKICAgICAgICAgIHJhbmdlCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICB0b2tlbnM6IHRva2Vucy5zbGljZSgpLAogICAgICAgICAgY29kZSwKICAgICAgICAgIGxvYywKICAgICAgICAgIGRlcHRoLAogICAgICAgICAgcGF0aCgpIHsKICAgICAgICAgICAgY29uc3QgeyBmaWxlIH0gPSB0aGlzOwogICAgICAgICAgICBpZih0eXBlb2YgZmlsZSA9PSAnc3RyaW5nJykgcmV0dXJuIHJlbGF0aXZlUGF0aChmaWxlKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICksCiAgICAgIEltcG9ydC5wcm90b3R5cGUKICAgICk7CiAgICBsZXQgZm4gPSB7CiAgICAgIFtJbXBvcnRUeXBlcy5JTVBPUlRfTkFNRVNQQUNFXSgpIHsKICAgICAgICByZXR1cm4gdGhpcy50b2tlbnNbdGhpcy50b2tlbnMuZmluZEluZGV4KHRvayA9PiBJc0tleXdvcmQoJ2FzJywgdG9rKSkgKyAxXS5sZXhlbWU7CiAgICAgIH0sCiAgICAgIFtJbXBvcnRUeXBlcy5JTVBPUlRfREVGQVVMVF0oKSB7CiAgICAgICAgY29uc3QgeyB0b2tlbnMgfSA9IHRoaXM7CiAgICAgICAgcmV0dXJuIHRva2Vuc1t0b2tlbnMuZmluZEluZGV4KHRvayA9PiBJc0tleXdvcmQoJ2ltcG9ydCcsIHRvaykpICsgMV0ubGV4ZW1lOwogICAgICB9LAogICAgICBbSW1wb3J0VHlwZXMuSU1QT1JUXSgpIHsKICAgICAgICBjb25zdCB7IHRva2VucyB9ID0gdGhpczsKICAgICAgICBsZXQgaSA9IDAsCiAgICAgICAgICBzID0gW10sCiAgICAgICAgICBhID0gW107CiAgICAgICAgaWYoSXNLZXl3b3JkKFsnaW1wb3J0JywgJ2V4cG9ydCddLCB0b2tlbnNbaV0pKSArK2k7CiAgICAgICAgaWYoSXNQdW5jdHVhdG9yKCd7JywgdG9rZW5zW2ldKSkgKytpOwogICAgICAgIGZvcig7IHRva2Vuc1tpXSAmJiAhSXNLZXl3b3JkKCdmcm9tJywgdG9rZW5zW2ldKTsgKytpKSB7CiAgICAgICAgICBpZihJc1B1bmN0dWF0b3IoWycsJywgJ30nXSwgdG9rZW5zW2ldKSkgewogICAgICAgICAgICBpZihzLmxlbmd0aCkgYS5wdXNoKHMpOwogICAgICAgICAgICBzID0gW107CiAgICAgICAgICB9IGVsc2UgaWYoSXNJZGVudGlmaWVyKHRva2Vuc1tpXSkpIHsKICAgICAgICAgICAgcy5wdXNoKHRva2Vuc1tpXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGEgPSBhLmZsYXQoKS5maWx0ZXIodG9rID0+IHRvay50eXBlID09ICdpZGVudGlmaWVyJyk7CiAgICAgICAgcmV0dXJuIGEubWFwKHRvayA9PiB0b2subGV4ZW1lKTsKICAgICAgfQogICAgfVt0eXBlXTsKICAgIGlmKHR5cGVvZiBmbiA9PSAnZnVuY3Rpb24nKSB7CiAgICAgIGxldCBsb2NhbCA9IGZuLmNhbGwoaW1wKTsKICAgICAgZGVmaW5lKGltcCwgeyBsb2NhbCB9KTsKICAgIH0KCiAgICByZXR1cm4gaW1wOwogIH0KCiAgZGVmaW5lKEltcG9ydC5wcm90b3R5cGUsIHsKICAgIGlkcygpIHsKICAgICAgcmV0dXJuIEltcG9ydElkcyh0aGlzLnRva2Vucy5zbGljZSgpKS5tYXAoKHsgbGV4ZW1lIH0pID0+IGxleGVtZSk7CiAgICB9LAogICAgdG9Db2RlKGZpbHRlcklkcyA9IGlkID0+IHRydWUpIHsKICAgICAgaWYodGhpcy5pZHMoKS5maWx0ZXIoZmlsdGVySWRzKS5sZW5ndGggPT0gMCkgcmV0dXJuICcnOwogICAgICBsZXQgdG9rZW5zID0gdGhpcy50b2tlbnMuZmlsdGVyKHRvayA9PiAodG9rLnR5cGUgPT0gJ2lkZW50aWZpZXInID8gZmlsdGVySWRzKHRvay5sZXhlbWUpIDogdHJ1ZSkpOwogICAgICBsZXQgcHJldiwgcG53czsKICAgICAgdG9rZW5zID0gdG9rZW5zLnJlZHVjZSgoYWNjLCB0b2ssIGkpID0+IHsKICAgICAgICBpZihwcmV2ICYmIHByZXYudHlwZSA9PSAnd2hpdGVzcGFjZScgJiYgdG9rLnR5cGUgPT0gJ3doaXRlc3BhY2UnKSByZXR1cm4gYWNjOwogICAgICAgIGlmKHBud3MgIT09IHVuZGVmaW5lZCAmJiBbJywnLCAneyddLmluZGV4T2YoYWNjW3Bud3NdLmxleGVtZSkgIT0gLTEgJiYgWycsJywgJ30nXS5pbmRleE9mKHRvay5sZXhlbWUpICE9IC0xKSB7CiAgICAgICAgICBpZih0b2subGV4ZW1lID09ICd9JykgYWNjLnNwbGljZShwbndzLCAxKTsKICAgICAgICAgIGlmKHRvay5sZXhlbWUgPT0gJ30nKSB7CiAgICAgICAgICAgIHBud3MgPSBhY2MubGVuZ3RoOwogICAgICAgICAgICBhY2MucHVzaCh0b2spOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIGFjYzsKICAgICAgICB9CiAgICAgICAgaWYodG9rLnR5cGUgIT0gJ3doaXRlc3BhY2UnKSBwbndzID0gYWNjLmxlbmd0aDsKICAgICAgICBwcmV2ID0gdG9rOwogICAgICAgIGFjYy5wdXNoKHRvayk7CiAgICAgICAgcmV0dXJuIGFjYzsKICAgICAgfSwgW10pOwogICAgICB0b2tlbnMgPSBBZGRXaGl0ZXNwYWNlKHRva2Vucyk7CiAgICAgIGNvbnNvbGUubG9nKCd0b2tlbnMnLCB0b2tlbnMpOwogICAgICByZXR1cm4gVG9rZW5TZXF1ZW5jZSh0b2tlbnMpLnRvU3RyaW5nKCk7CiAgICB9CiAgfSk7CgogIGxldCBlbmQgPSBEYXRlLm5vdygpOwoKICBpZihzaG93VGltaW5nKSBjb25zb2xlLmxvZyhgTGV4aW5nICcke3NvdXJjZS5yZXBsYWNlKC9eXC5cLy8sICcnKX0nIHRvb2sgJHtlbmQgLSBzdGFydH1tc2ApOwogIHN0YXJ0ID0gRGF0ZS5ub3coKTsKCiAgbGV0IGV4cG9ydHNGcm9tID0gZXhwb3J0cy5maWx0ZXIoZXhwID0+IGV4cC50b2tlbnMpLmZpbHRlcihleHAgPT4gZXhwLnRva2Vucy5zb21lKHRvayA9PiB0b2subGV4ZW1lID09ICdmcm9tJykpOwoKICBpZihwYXRoLmlzUmVsYXRpdmUoc291cmNlKSAmJiAhL14oXC58XC5cLilcLy8udGVzdChzb3VyY2UpKSBzb3VyY2UgPSAnLi8nICsgc291cmNlOwoKICBtb2R1bGVzW3NvdXJjZV0gPSB7IGltcG9ydHMsIGV4cG9ydHMgfTsKCiAgbGV0IGFsbEV4cG9ydHNJbXBvcnRzID0gZXhwb3J0cy5jb25jYXQoaW1wb3J0cykuc29ydCgoYSwgYikgPT4gYS5yYW5nZVswXSAtIGIucmFuZ2VbMF0pOwogIGxldCBmaWxlSW1wb3J0cyA9IGFsbEV4cG9ydHNJbXBvcnRzLmZpbHRlcihpbXAgPT4gdHlwZW9mIGltcC5maWxlID09ICdzdHJpbmcnKTsKICBsZXQgc3BsaXRQb2ludHMgPSB1bmlxdWUoZmlsZUltcG9ydHMucmVkdWNlKChhY2MsIGltcCkgPT4gWy4uLmFjYywgLi4uaW1wLnJhbmdlXSwgW10pKTsKICBidWZmZXJzW3NvdXJjZV0gPSBbLi4uc3BsaXQoQnVmZmVyRmlsZShzb3VyY2UpLCAuLi5zcGxpdFBvaW50cyldLm1hcChiID0+IGIgPz8gdG9TdHJpbmcoYiwgMCwgYi5ieXRlTGVuZ3RoKSk7CgogIGxldCBtYXAgPSBGaWxlTWFwLmZvcihzb3VyY2UpOwogIGxldCBpbXBvcnRlZCA9IHVzZWQgJiYgbmV3IFNldCgpOwoKICBpZih1c2VkKSB7CiAgICBmb3IobGV0IGltcGV4cCBvZiBhbGxFeHBvcnRzSW1wb3J0cykgewogICAgICBpZihpbXBleHAudHlwZSA9PSBXaGF0LklNUE9SVCkgewogICAgICAgIGxldCBpZHMgPSBpbXBleHAuaWRzKCk7CiAgICAgICAgZm9yKGxldCBpZCBvZiBpZHMpIGltcG9ydGVkLmFkZChpZCk7CiAgICAgIH0KICAgIH0KCiAgICBsZXQgbnVtUmVwbGFjZSA9IDA7CiAgICBmb3IobGV0IGltcGV4cCBvZiBhbGxFeHBvcnRzSW1wb3J0cykgewogICAgICBpZihpbXBleHAudHlwZSA9PSBXaGF0LklNUE9SVCkgewogICAgICAgIGxldCBpZHMgPSBpbXBleHAuaWRzKCk7CiAgICAgICAgaWYoaWRzLnNvbWUoaWQgPT4gIXVzZWQuaGFzKGlkKSkpIHsKICAgICAgICAgIGxldCB7IGNvZGUsIHJhbmdlIH0gPSBpbXBleHA7CiAgICAgICAgICBsZXQgbmV3Q29kZSA9IGltcGV4cC50b0NvZGUoaWQgPT4gdXNlZC5oYXMoaWQpKTsKICAgICAgICAgIGlmKGNvZGUgIT0gbmV3Q29kZSkgewogICAgICAgICAgICBtYXAucmVwbGFjZVJhbmdlKHJhbmdlLCB0b0FycmF5QnVmZmVyKG5ld0NvZGUpKTsKICAgICAgICAgICAgKytudW1SZXBsYWNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGlmKGRlYnVnID49IDEpIGNvbnNvbGUubG9nKGBpbXBvcnRlZCBbICR7c291cmNlfSBdYCwgY29uc29sZS5jb25maWcoeyBjb21wYWN0OiAxIH0pLCBbLi4uaW1wb3J0ZWRdKTsKICAgIHVzZWQgPSBpbnRlcnNlY3Rpb24odXNlZCwgaW1wb3J0ZWQpOwogICAgaWYoZGVidWcgPj0gMSkgY29uc29sZS5sb2coYHVzZWQgICAgIFsgJHtzb3VyY2V9IF1gLCBjb25zb2xlLmNvbmZpZyh7IGNvbXBhY3Q6IDEgfSksIFsuLi51c2VkXSk7CgogICAgbGV0IHVudXNlZCA9IGRpZmZlcmVuY2UoaW1wb3J0ZWQsIHVzZWQpOwoKICAgIGlmKGRlYnVnID49IDEpIGNvbnNvbGUubG9nKGB1bnVzZWQgICBbICR7c291cmNlfSBdYCwgY29uc29sZS5jb25maWcoeyBjb21wYWN0OiAxIH0pLCBbLi4udW51c2VkXSk7CgogICAgaWYobnVtUmVwbGFjZSkgewogICAgICBsZXQgb3V0ID0gRmlsZVJlcGxhY2VyKHNvdXJjZSk7CiAgICAgIGxldCByZXN1bHQgPSBtYXAud3JpdGUob3V0KTsKICAgICAgb3V0LmNsb3NlKCk7CiAgICB9CiAgfSBlbHNlIHsKICAgIGZvcihsZXQgaW1wZXhwIG9mIGFsbEV4cG9ydHNJbXBvcnRzKSB7CiAgICAgIGNvbnN0IHsgdHlwZSwgZmlsZSwgcmFuZ2UsIGNvZGUsIGxvYyB9ID0gaW1wZXhwOwogICAgICBjb25zdCBbc3RhcnQsIGVuZF0gPSByYW5nZTsKICAgICAgLy8gbGV0IGJ5dGVidWYgPSBCdWZmZXJGaWxlKHNvdXJjZSk7CiAgICAgIGxldCBidWZzdHIgPSB0b1N0cmluZyhieXRlYnVmLnNsaWNlKC4uLnJhbmdlKSk7CiAgICAgIGxldCBhcnJidWYgPSB0b0FycmF5QnVmZmVyKGJ1ZnN0cik7CgogICAgICBsZXQgcmVwbGFjZW1lbnQgPSB0eXBlID09IFdoYXQuRVhQT1JUID8gbnVsbCA6IC8qRmlsZU1hcC5mb3IqLyBmaWxlOwogICAgICBsZXQgeyBieXRlT2Zmc2V0IH0gPSBsb2M7CiAgICAgIGxldCBwOwoKICAgICAgaWYoZGVidWcgPiAyKQogICAgICAgIGNvbnNvbGUubG9nKCdpbXBleHAnLCBjb21wYWN0KDIpLCB7CiAgICAgICAgICBjb2RlLAogICAgICAgICAgcmFuZ2U6IG5ldyBOdW1lcmljUmFuZ2UoLi4ucmFuZ2UpLAogICAgICAgICAgcmVwbGFjZW1lbnQsCiAgICAgICAgICBsb2M6IGxvYyArICcnCiAgICAgICAgfSk7CgogICAgICBpZih0eXBlb2YgZmlsZSA9PSAnc3RyaW5nJyAmJiAhcGF0aC5pc0ZpbGUoZmlsZSkpIHsKICAgICAgICBpZihkZWJ1ZyA+IDEpIGNvbnNvbGUubG9nKGBceDFiWzE7MzFtSW5leGlzdGVudFx4MWJbMG0gZmlsZSAnJHtmaWxlfSdgKTsKICAgICAgICBpZihwcmludEZpbGVzKSBzdGQucHV0cyhmaWxlICsgJ1xuJyk7CgogICAgICAgIHJlcGxhY2VtZW50ID0gbnVsbDsKICAgICAgfSBlbHNlIGlmKGZpbGUgJiYgcGF0aC5pc0ZpbGUoZmlsZSkpIHsKICAgICAgICByZXBsYWNlbWVudCA9IGZpbGU7CiAgICAgIH0gZWxzZSBpZigodHlwZW9mIHJlcGxhY2VtZW50ID09ICdzdHJpbmcnICYmICFwYXRoLmlzRmlsZShyZXBsYWNlbWVudCkpIHx8IHR5cGUgPT0gV2hhdC5JTVBPUlQgfHwgdHlwZW9mIGZpbGUgPT0gJ3N0cmluZycpIHsKICAgICAgICByZXBsYWNlbWVudCA9IG51bGw7CiAgICAgIH0gZWxzZSBpZihjb2RlLnN0YXJ0c1dpdGgoJ2V4cG9ydCcpKSB7CiAgICAgICAgaWYoIXJlbW92ZUV4cG9ydHMpIGNvbnRpbnVlOwogICAgICAgIHJlcGxhY2VtZW50ID0gZmlsZTsKICAgICAgfQoKICAgICAgbGV0IGxpc3QgPSB0eXBlID09IFdoYXQuRVhQT1JUID8gZm9vdGVyIDogaGVhZGVyOwogICAgICBsaXN0LnB1c2goaW1wZXhwKTsKCiAgICAgIGlmKGRlYnVnID49IDIpCiAgICAgICAgY29uc29sZS5sb2coJ2ltcGV4cCcsIGNvbXBhY3QoMiksIHsKICAgICAgICAgIGNvZGUsCiAgICAgICAgICByYW5nZTogbmV3IE51bWVyaWNSYW5nZSguLi5yYW5nZSksCiAgICAgICAgICByZXBsYWNlbWVudCwKICAgICAgICAgIGxvYzogbG9jICsgJycKICAgICAgICB9KTsKICAgICAgaWYoZGVidWcgPiAxKQogICAgICAgIGNvbnNvbGUubG9nKCdpbXBleHAnLCBjb21wYWN0KDEpLCB7CiAgICAgICAgICByYW5nZTogbmV3IE51bWVyaWNSYW5nZSguLi5yYW5nZSksCiAgICAgICAgICBsb2M6IGxvYyArICcnCiAgICAgICAgfSk7CgogICAgICBtYXAucmVwbGFjZVJhbmdlKHJhbmdlLCByZXBsYWNlbWVudCk7CiAgICB9CiAgfQoKICAvL2VidWdMb2coJ2NvbW1lbnRzJywgY29tbWVudHMubWFwKCh7Ynl0ZVJhbmdlLCBsZXhlbWV9KT0+W2J5dGVSYW5nZSxsZXhlbWUsdG9TdHJpbmcoYnl0ZWJ1Zi5zbGljZSguLi5ieXRlUmFuZ2UpKV0pKTsKCiAgaWYocmVtb3ZlQ29tbWVudHMgJiYgY29tbWVudHMubGVuZ3RoKSB7CiAgICBpID0gLTE7CiAgICBkZWJ1Z0xvZyhgUmVtb3ZpbmcgJHtjb21tZW50cy5sZW5ndGh9IGNvbW1lbnRzIGZyb20gJyR7c291cmNlfSdgKTsKICAgIGZvcihsZXQgeyBieXRlUmFuZ2UsIGxleGVtZSB9IG9mIGNvbW1lbnRzKSB7CiAgICAgIGxldCBzbCA9IGJ5dGVidWYuc2xpY2UoLi4uYnl0ZVJhbmdlKTsKICAgICAgaWYoZGVidWcgPiAxKQogICAgICAgIGRlYnVnTG9nKGBjb21tZW50WyR7KytpfV1gLCBjb21wYWN0KDIpLCB7CiAgICAgICAgICBieXRlUmFuZ2UsCiAgICAgICAgICBzdHI6IHRvU3RyaW5nKHNsKQogICAgICAgIH0pOwoKICAgICAgbWFwLnJlcGxhY2VSYW5nZShieXRlUmFuZ2UsIG51bGwpOwogICAgfQogIH0KCiAgZW5kID0gRGF0ZS5ub3coKTsKCiAgLy8gY29uc29sZS5sb2coYFN1YnN0aXR1dGluZyAnJHtzb3VyY2UucmVwbGFjZSgvXlwuXC8vLCAnJyl9JyB0b29rICR7ZW5kIC0gc3RhcnR9bXNgKTsKICBwcm9jZXNzZWQuYWRkKHNvdXJjZSk7CgogIGlmKHJlY3Vyc2l2ZSA+IDApIHsKICAgIGZvcihsZXQgaW1wIG9mIGZpbGVJbXBvcnRzKSB7CiAgICAgIGxldCB7IGZpbGUsIHJhbmdlLCB0b2tlbnMgfSA9IGltcDsKICAgICAgaWYoIS9cLi8udGVzdChmaWxlKSkgewogICAgICAgIC8vIGNvbnNvbGUubG9nKGBCdWlsdGluIG1vZHVsZSAnJHtmaWxlfSdgKTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYoIXBhdGguaXNGaWxlKGZpbGUpKSB7CiAgICAgICAgY29uc29sZS5sb2coYFBhdGggbXVzdCBleGlzdCAnJHtmaWxlfSdgKTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgaWYocHJvY2Vzc2VkLmhhcyhmaWxlKSB8fCBmaWxlID09IHNvdXJjZSkgewogICAgICAgIC8vY29uc29sZS5sb2coYEFscmVhZHkgcHJvY2Vzc2VkICcke2ZpbGV9J2ApOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBmaWxlID0gTW9kdWxlTG9hZGVyKE5vcm1hbGl6ZVBhdGgoZmlsZSkpOwoKICAgICAgcHJvY2Vzc2VkLmFkZChmaWxlKTsKCiAgICAgIEFkZERlcChzb3VyY2UsIGZpbGUpOwogICAgICBQcm9jZXNzRmlsZShmaWxlLCBsb2csIHR5cGVvZiByZWN1cnNpdmUgPT0gJ251bWJlcicgPyByZWN1cnNpdmUgLSAxIDogcmVjdXJzaXZlLCBkZXB0aCArIDEpOwogICAgfQogIH0KCiAgc3RkLmdjKCk7CgogIGlmKHNob3dEZXBzKSB7CiAgICBsZXQgZGVwcyA9IFsuLi5EZXBlbmRlbmN5VHJlZShzb3VyY2UsICcgJywgZmFsc2UsIDAsICcgICAgJyldOwogICAgY29uc29sZS5sb2coYERlcGVuZGVuY2llcyBvZiAnJHtzb3VyY2V9JzpcbiR7U3ByZWFkQW5kSm9pbihkZXBzKX1gKTsKICAgIC8vY29uc29sZS5sb2coYGRlcGVuZGVuY3lNYXBgLFsuLi5kZXBlbmRlbmN5TWFwXSk7CiAgfQoKICByZXR1cm4gbWFwOwp9CgpmdW5jdGlvbiBBZGREZXAoc291cmNlLCBmaWxlKSB7CiAgc291cmNlID0gTm9ybWFsaXplUGF0aChzb3VyY2UpOwoKICBpZihkZWJ1ZyA+IDIpIGNvbnNvbGUubG9nKGBBZGQgZGVwZW5kZW5jeSAnJHtmaWxlfScgdG8gJyR7c291cmNlfSdgKTsKICBkZXBlbmRlbmN5VHJlZShzb3VyY2UpLnB1c2goZmlsZSk7Cn0KCmZ1bmN0aW9uIElzV1ModG9rKSB7CiAgcmV0dXJuIHRvay50eXBlID09ICd3aGl0ZXNwYWNlJzsKfQoKZnVuY3Rpb24gTm9uV1ModG9rZW5zKSB7CiAgcmV0dXJuIHRva2Vucy5maWx0ZXIodG9rID0+ICFJc1dTKHRvaykpOwp9CgpmdW5jdGlvbiBUb2tlblNlcXVlbmNlKHRva2VucykgewogIHJldHVybiBkZWZpbmUoCiAgICB0b2tlbnMubWFwKHRvayA9PiB0b2subGV4ZW1lKSwKICAgIHsKICAgICAgdG9TdHJpbmcoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuam9pbignJyk7CiAgICAgIH0KICAgIH0KICApOwp9CgpmdW5jdGlvbiBBZGRXaGl0ZXNwYWNlKHRva2VucykgewogIHJldHVybiB0b2tlbnMucmVkdWNlKChhY2MsIHRvaykgPT4gewogICAgaWYoYWNjLmxlbmd0aCkgewogICAgICBpZih0b2subGV4ZW1lICE9ICcsJykgaWYgKCFJc1dTKGFjY1thY2MubGVuZ3RoIC0gMV0pICYmICFJc1dTKHRvaykpIGFjYy5wdXNoKHsgdHlwZTogJ3doaXRlc3BhY2UnLCBsZXhlbWU6ICcgJyB9KTsKICAgIH0KCiAgICBhY2MucHVzaCh0b2spOwogICAgcmV0dXJuIGFjYzsKICB9LCBbXSk7Cn0KCmZ1bmN0aW9uIFVucXVvdGUobGV4ZW1lKSB7CiAgcmV0dXJuIGxleGVtZS5yZXBsYWNlKC8oXltcJ1wiXGBdfFtcJ1wiXGBdJCkvZywgJycpOwp9CgpmdW5jdGlvbiBMaXRlcmFsU2VxdWVuY2UodG9rZW5zKSB7CiAgcmV0dXJuIHRva2Vucy5yZWR1Y2UoKGFjYywgdG9rKSA9PiBhY2MgKyB0b2subGV4ZW1lLCAnJyk7Cn0KCmZ1bmN0aW9uIFVudGlsRU9MKGlkeCwgdG9rZW5zKSB7CiAgcmV0dXJuIFVudGlsKGlkeCwgdG9rZW5zLCBUb2tJcyhudWxsLCAnOycpKTsKfQoKZnVuY3Rpb24gVW50aWwoaWR4LCB0b2tlbnMsIHByZWQgPSBUb2tJcyhudWxsLCBbJzsnLCAnXG4nXSkpIHsKICBsZXQgaTsKICBmb3IoaSA9IGlkeDsgdG9rZW5zW2ldOyBpKyspIHsKICAgIGlmKHByZWQodG9rZW5zW2ldKSkgYnJlYWs7CiAgfQoKICByZXR1cm4gdG9rZW5zLnNsaWNlKGlkeCwgaSk7Cn0KCmZ1bmN0aW9uIFdob2xlTGluZShpZHgsIHRva2VucykgewogIGxldCBpLCBqOwogIGZvcihpID0gaWR4OyB0b2tlbnNbaV07IGkrKykgewogICAgaWYoWyc7JywgJ1xuJ10uaW5kZXhPZih0b2tlbnNbaV0ubGV4ZW1lKSAhPSAtMSkgYnJlYWs7CiAgfQoKICBmb3IoaiA9IGlkeDsgaiA+IDA7IGotLSkgewogICAgY29uc3QgdG9rID0gdG9rZW5zW2ogLSAxXTsKICAgIGlmKCF0b2sgfHwgWyc7JywgJ1xuJ10uaW5kZXhPZih0b2tlbnNbaiAtIDFdLmxleGVtZSkgIT0gLTEpIGJyZWFrOwogIH0KCiAgcmV0dXJuIHRva2Vucy5zbGljZShqLCBpKTsKfQoKZnVuY3Rpb24gUmFuZ2UoZmlsZSwgc3RhcnQsIGVuZCkgewogIGxldCBidWY7CiAgaWYoKGJ1ZiA9IEJ1ZmZlckZpbGUoZmlsZSkpKSB7CiAgICB0aGlzLmZpbGUgPSBmaWxlOwogICAgdGhpcy5zdGFydCA9IHN0YXJ0ID8/IDA7CiAgICB0aGlzLmVuZCA9IGVuZCA/PyBidWYuYnl0ZUxlbmd0aDsKICAgIHJldHVybiB0aGlzOwogIH0KCiAgcmV0dXJuIG51bGw7Cn0KClJhbmdlLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uKCkgewogIGxldCBidWYgPSBCdWZmZXJGaWxlKHRoaXMuZmlsZSk7CiAgcmV0dXJuIGJ1Zi5zbGljZSh0aGlzLnN0YXJ0LCB0aGlzLmVuZCk7Cn07CgpmdW5jdGlvbiBJblJhbmdlKFtzdGFydCwgZW5kXSwgaSkgewogIGlmKGkgPj0gc3RhcnQgJiYgaSA8IGVuZCkgcmV0dXJuIHRydWU7CiAgcmV0dXJuIGZhbHNlOwp9CgpmdW5jdGlvbiBJc1JhbmdlKG9iaikgewogIHJldHVybiBpc09iamVjdChvYmopICYmICgnbGVuZ3RoJyBpbiBvYmogfHwgJ3N0YXJ0JyBpbiBvYmogfHwgb2JqIGluc3RhbmNlb2YgTnVtZXJpY1JhbmdlKTsKfQoKY2xhc3MgTnVtZXJpY1JhbmdlIGV4dGVuZHMgQXJyYXkgewogIGNvbnN0cnVjdG9yKHN0YXJ0LCBlbmQpIHsKICAgIHN1cGVyKDIpOwogICAgaWYoaXNOYU4oK3N0YXJ0KSkgc3RhcnQgPSAwOwogICAgdGhpc1swXSA9ICtzdGFydDsKICAgIGlmKGlzTmFOKCtlbmQpKSBlbmQgPSB0aGlzWzBdOwogICAgdGhpc1sxXSA9IGVuZDsKICB9CgogIGdldCBzdGFydCgpIHsKICAgIHJldHVybiB0aGlzWzBdOwogIH0KCiAgc2V0IHN0YXJ0KHZhbHVlKSB7CiAgICB0aGlzWzBdID0gK3ZhbHVlOwogIH0KCiAgZ2V0IGVuZCgpIHsKICAgIHJldHVybiB0aGlzWzFdOwogIH0KCiAgc2V0IGVuZCh2YWx1ZSkgewogICAgdGhpc1sxXSA9ICt2YWx1ZTsKICB9CgogIHN0YXRpYyBmcm9tKHJhbmdlKSB7CiAgICBpZihpc09iamVjdChyYW5nZSkgJiYgcmFuZ2UgaW5zdGFuY2VvZiBOdW1lcmljUmFuZ2UpIHJldHVybiByYW5nZTsKCiAgICB0cnkgewogICAgICBsZXQgciA9IG5ldyBOdW1lcmljUmFuZ2UoLi4ucmFuZ2UpOwogICAgICByYW5nZSA9IHI7CiAgICB9IGNhdGNoKGUpIHt9CgogICAgY29uc29sZS5sb2coJ051bWVyaWNSYW5nZS5mcm9tJywgcmFuZ2UpOwogICAgcmV0dXJuIHJhbmdlOwogIH0KCiAgc3RhdGljICpob2xlcyhyYW5nZXMsIG9ubHkgPSBmYWxzZSkgewogICAgbGV0IHByZXYgPSBbMCwgMF07CiAgICBsZXQgaSA9IC0xOwogICAgZm9yKGxldCByYW5nZSBvZiByYW5nZXMpIHsKICAgICAgaWYoSXNSYW5nZShyYW5nZSkpIHsKICAgICAgICByYW5nZSA9IFsuLi5yYW5nZV07CiAgICAgICAgY29uc29sZS5sb2coJ3JhbmdlIycgKyArK2ksIGluc3BlY3QocmFuZ2UpKTsKICAgICAgICBpZihJc1JhbmdlKHByZXYpICYmIElzUmFuZ2UocmFuZ2UpKSB7CiAgICAgICAgICBsZXQgW3N0YXJ0LCBlbmRdID0gcmFuZ2U7CiAgICAgICAgICBpZihzdGFydCA+PSBwcmV2WzFdKSB5aWVsZCBuZXcgTnVtZXJpY1JhbmdlKHByZXZbMV0sIHN0YXJ0KTsKICAgICAgICB9CiAgICAgICAgaWYoIW9ubHkpIHsKICAgICAgICAgIGlmKCEoaXNPYmVjdChyYW5nZSkgJiYgcmFuZ2UgaW5zdGFuY2VvZiBOdW1lcmljUmFuZ2UpKSByYW5nZSA9IG5ldyBOdW1lcmljUmFuZ2UoLi4ucmFuZ2UpOwogICAgICAgICAgeWllbGQgcmFuZ2U7CiAgICAgICAgfQogICAgICB9CiAgICAgIHByZXYgPSByYW5nZTsKICAgIH0KICB9CgogIHN0YXRpYyBiZXR3ZWVuKFtzMSwgZTFdLCBbczIsIGUyXSkgewogICAgaWYoczIgPiBlMSkgcmV0dXJuIFtlMSwgczJdOwogICAgaWYoczEgPiBlMikgcmV0dXJuIFtlMiwgczFdOwogIH0KfQoKZGVmaW5lKE51bWVyaWNSYW5nZS5wcm90b3R5cGUsIHsKICBbU3ltYm9sLnRvU3RyaW5nVGFnXTogJ051bWVyaWNSYW5nZScsCiAgW2luc3BlY3RTeW1ib2xdKGRlcHRoLCBvcHRzKSB7CiAgICBjb25zdCBbc3RhcnQsIGVuZF0gPSB0aGlzOwogICAgbGV0IHMgPSAnJzsKICAgIGNvbnN0IHBhZCA9IHMgPT4gKHMgKyAnJykucGFkRW5kKDUpOwogICAgcyArPSBgXHgxYlsxOzM2bSR7cGFkKHN0YXJ0KX1ceDFiWzBtYDsKICAgIHMgKz0gYCAtIGA7CiAgICBzICs9IGBceDFiWzE7MzZtJHtwYWQoJysnICsgKGVuZCAtIHN0YXJ0KSl9XHgxYlswbWA7CiAgICBzID0gYFsgJHtzfSBdYDsKICAgIHJldHVybiBzOwogIH0KfSk7CgpjbGFzcyBGaWxlTWFwIGV4dGVuZHMgQXJyYXkgewogIGNvbnN0cnVjdG9yKGZpbGUsIGJ1ZikgewogICAgc3VwZXIoKTsKICAgIGlmKHR5cGVvZiBmaWxlICE9ICdudW1iZXInKSB7CiAgICAgIHRoaXMuZmlsZSA9IGZpbGU7CiAgICAgIGJ1ZiA/Pz0gQnVmZmVyRmlsZShmaWxlKTsKICAgICAgaWYoIWJ1ZikgdGhyb3cgbmV3IEVycm9yKGBGaWxlTWFwIGJ1ZiA9PSAke2J1Zn1gKTsKICAgICAgdGhpcy5wdXNoKFtbMCwgYnVmLmJ5dGVMZW5ndGhdLCBidWZdKTsKICAgICAgZmlsZU1hcHMuc2V0KGZpbGUsIHRoaXMpOwogICAgfQogIH0KCiAgc3RhdGljIGVtcHR5KGZpbGUpIHsKICAgIGlmKHR5cGVvZiBmaWxlID09ICdzdHJpbmcnKSBmaWxlID0gRmlsZU1hcC5mb3IoZmlsZSk7CiAgICBpZihpc09iamVjdChmaWxlKSAmJiBmaWxlIGluc3RhbmNlb2YgRmlsZU1hcCkgcmV0dXJuIGZpbGUuaXNFbXB0eSgpOwogIH0KCiAgaXNFbXB0eSgpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIHN0YXRpYyBmb3IoZmlsZSwgYnVmKSB7CiAgICBsZXQgbTsKICAgIGlmKGZpbGUgJiYgKG0gPSBmaWxlTWFwcy5nZXQoZmlsZSkpKSByZXR1cm4gbTsKICAgIGlmKGlzT2JqZWN0KGZpbGUpICYmIGZpbGUgaW5zdGFuY2VvZiBGaWxlTWFwKSByZXR1cm4gZmlsZTsKICAgIGVsc2UgaWYoZmlsZSA9PT0gbnVsbCAmJiAhYnVmKSB7CiAgICAgIGxldCBvYmogPSB7CiAgICAgICAgaXNFbXB0eSgpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0sCiAgICAgICAgdG9TdHJpbmcoKSB7CiAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgfSwKICAgICAgICBbU3ltYm9sLnRvU3RyaW5nVGFnXTogJ0ZpbGVNYXAoZW1wdHkpJwogICAgICB9OwogICAgICByZXR1cm4gT2JqZWN0LnNldFByb3RvdHlwZU9mKG9iaiwgRmlsZU1hcC5wcm90b3R5cGUpOwogICAgfQogICAgaWYoZmlsZU1hcHMuaGFzKGZpbGUpKSByZXR1cm4gZmlsZU1hcHMuZ2V0KGZpbGUpOwogICAgcmV0dXJuIG5ldyBGaWxlTWFwKGZpbGUsIGJ1Zik7CiAgfQoKICBzcGxpdEF0KHBvcykgewogICAgbGV0IGkgPSB0aGlzLmZpbmRJbmRleCgoW3JhbmdlLCBidWZdKSA9PiByYW5nZSAmJiBJblJhbmdlKHJhbmdlLCBwb3MpKTsKICAgIGlmKGkgIT0gLTEpIHsKICAgICAgbGV0IFtyYW5nZSwgYnVmXSA9IHRoaXNbaV07CiAgICAgIGxldCBbc3RhcnQsIGVuZF0gPSByYW5nZTsKICAgICAgdGhpcy5zcGxpY2UoaSArIDEsIDAsIFtbKHJhbmdlWzFdID0gcG9zKSwgZW5kXSwgYnVmXSk7CiAgICAgIHJldHVybiBpICsgMTsKICAgIH0KICB9CgogIHNsaWNlQXQobikgewogICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5maW5kSW5kZXguY2FsbCh0aGlzLCAoW3JhbmdlLCBidWZdKSA9PiAocmFuZ2UgPyBJblJhbmdlKHJhbmdlLCBuKSA6IGZhbHNlKSk7CiAgfQoKICByZXBsYWNlUmFuZ2UocmFuZ2UsIGZpbGUpIHsKICAgIGlmKEFycmF5LmlzQXJyYXkocmFuZ2UpICYmICEocmFuZ2UgaW5zdGFuY2VvZiBOdW1lcmljUmFuZ2UpKSByYW5nZSA9IG5ldyBOdW1lcmljUmFuZ2UoLi4ucmFuZ2UpOwogICAgY29uc3Qgc2xpY2VJbmRleCA9IG4gPT4gewogICAgICBsZXQgcjsKICAgICAgaWYodGhpc1swXSAmJiB0aGlzWzBdWzBdICE9IG51bGwpIHsKICAgICAgICBjb25zdCByYW5nZSA9IG5ldyBOdW1lcmljUmFuZ2UoLi4udGhpc1swXVswXSk7CiAgICAgICAgaWYobiA8IHJhbmdlLnN0YXJ0KSByZXR1cm4gMDsKICAgICAgfQogICAgICBsZXQgaTsKICAgICAgY29uc3QgeyBsZW5ndGggfSA9IHRoaXM7CiAgICAgIGZvcihpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7CiAgICAgICAgY29uc3QgW2l0ZW1dID0gdGhpc1tpXTsKICAgICAgICBpZihpdGVtKSB7CiAgICAgICAgICBjb25zdCBbcywgZV0gPSBpdGVtOwogICAgICAgICAgaWYobiA8IGUpIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gaTsKICAgIH07CiAgICBpZihkZWJ1ZyA+IDIpCiAgICAgIGNvbnNvbGUubG9nKCdGaWxlTWFwLnJlcGxhY2VSYW5nZScsIGNvbXBhY3QoMiwgeyBjdXN0b21JbnNwZWN0OiB0cnVlIH0pLCB7CiAgICAgICAgZmlsZSwKICAgICAgICByYW5nZTogW3JhbmdlWzBdLCByYW5nZVsxXV0KICAgICAgfSk7CiAgICBsZXQgc3RhcnQgPSBzbGljZUluZGV4KHJhbmdlWzBdKTsKICAgIGxldCBlbmQgPSBzbGljZUluZGV4KHJhbmdlWzFdKTsKICAgIGNvbnN0IHsgbGVuZ3RoIH0gPSB0aGlzOwogICAgaWYoZGVidWcgPiAyKQogICAgICBjb25zb2xlLmxvZygnRmlsZU1hcC5yZXBsYWNlUmFuZ2UnLCBjb21wYWN0KDIsIHsgY3VzdG9tSW5zcGVjdDogdHJ1ZSB9KSwgewogICAgICAgIHN0YXJ0LAogICAgICAgIGVuZCwKICAgICAgICBsZW5ndGgsCiAgICAgICAgdGhpczogdGhpcwogICAgICB9KTsKICAgIGlmKHJhbmdlWzBdIDwgdGhpc1tzdGFydF1bMF0pIHJhbmdlWzBdID0gdGhpc1tzdGFydF1bMF07CiAgICBpZighdGhpc1tzdGFydF1bMF0pCiAgICAgIHRocm93IG5ldyBFcnJvcigKICAgICAgICBgcmFuZ2U9JHtyYW5nZX1cbmxlbmd0aD0ke3RoaXMubGVuZ3RofVxuc3RhcnQ9JHtzdGFydH1cbmVuZD0ke2VuZH1cbnRoaXNbJHtzdGFydH1dPSR7aW5zcGVjdCh0aGlzW3N0YXJ0XSl9XG50aGlzWyR7c3RhcnQgLSAxfV09JHtpbnNwZWN0KHRoaXNbc3RhcnQgLSAxXSl9XG50aGlzWyR7c3RhcnQgKyAxfV09JHtpbnNwZWN0KAogICAgICAgICAgdGhpc1tzdGFydCArIDFdCiAgICAgICAgKX1gCiAgICAgICk7CiAgICBpZihyYW5nZVswXSA+IHRoaXNbc3RhcnRdWzBdWzBdKSB7CiAgICAgIGlmKHN0YXJ0ID09IGVuZCkgewogICAgICAgIGxldCBbcmFuZ2UsIGJ1Zl0gPSB0aGlzW3N0YXJ0XTsKICAgICAgICBsZXQgaW5zZXJ0ID0gW25ldyBOdW1lcmljUmFuZ2UoLi4ucmFuZ2UpLCBidWZdOwogICAgICAgIHRoaXMuc3BsaWNlKCsrZW5kLCAwLCBpbnNlcnQpOwogICAgICB9CgogICAgICB0aGlzW3N0YXJ0XVswXVsxXSA9IHJhbmdlWzBdOwogICAgICBpZih0aGlzW2VuZF0gJiYgdGhpc1tlbmRdWzBdKSB0aGlzW2VuZF1bMF1bMF0gPSByYW5nZVsxXTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXNbc3RhcnRdWzBdWzBdID0gcmFuZ2VbMV07CiAgICAgIHRoaXMuc3BsaWNlKHN0YXJ0LCAwLCBbbnVsbCwgZmlsZV0pOwogICAgICBmaWxlID0gbnVsbDsKICAgIH0KCiAgICBpZihmaWxlICE9IG51bGwpIHRoaXMuc3BsaWNlKHN0YXJ0ICsgMSwgMCwgW251bGwsIGZpbGVdKTsKICB9CgogIGR1bXAoKSB7CiAgICBjb25zdCBzb3VyY2UgPSB0aGlzLmZpbGU7CiAgICByZXR1cm4gKAogICAgICBgRmlsZU1hcCB7XG5cdGZpbGU6IFx4MWJbMzg7NTsyMTVtJHtzb3VyY2V9LFxuXHRceDFiWzBtWyBgICsKICAgICAgWy4uLnRoaXNdCiAgICAgICAgLm1hcCgoaXRlbSwgaSkgPT4gaXRlbS5jb25jYXQoW3RoaXMuYXQoaSldKSkKICAgICAgICAucmVkdWNlKChhY2MsIFtyYW5nZSwgYnVmLCBzdHJdLCBpKSA9PiB7CiAgICAgICAgICBsZXQgcyA9IGFjYyArIGBcblx0XHRbIGA7CiAgICAgICAgICBzICs9ICgnJyArIChyYW5nZSA/ICdbJyArIE51bWVyaWNSYW5nZS5mcm9tKHJhbmdlKSArICddJyA6IHJhbmdlKSkucGFkRW5kKDEwKTsKICAgICAgICAgIHMgKz0gJywgJzsKICAgICAgICAgIGlmKGlzT2JqZWN0KGJ1ZikgJiYgJ2J5dGVMZW5ndGgnIGluIGJ1ZikgewogICAgICAgICAgICBsZXQgZmlsZW5hbWUgPSBidWZmZXJSZWYuZ2V0KGJ1Zik7CiAgICAgICAgICAgIGJ1ZiA9IGZpbGVuYW1lID8/IGA8dGhpcz5gOwogICAgICAgICAgfQoKICAgICAgICAgIGlmKHR5cGVvZiBidWYgPT0gJ3N0cmluZycpIGJ1ZiA9IHBhdGgubm9ybWFsaXplKGJ1Zik7CiAgICAgICAgICBzICs9IGluc3BlY3QoYnVmLCB7IG1heEFycmF5TGVuZ3RoOiAzMCB9KTsKICAgICAgICAgIHMgKz0gYCBdLGA7CiAgICAgICAgICByZXR1cm4gczsKICAgICAgICB9LCAnJykgKwogICAgICBgXG5cdF1cbn1gCiAgICApOwogIH0KCiAgYXQoaSkgewogICAgaWYoIXRoaXNbaV0pIHJldHVybiBudWxsOwogICAgY29uc3QgW3JhbmdlLCBidWZdID0gdGhpc1tpXTsKICAgIGlmKHJhbmdlICYmIGlzT2JqZWN0KGJ1ZikpIHsKICAgICAgY29uc3QgW3N0YXJ0LCBlbmRdID0gcmFuZ2U7CiAgICAgIHJldHVybiBidWYuc2xpY2Uoc3RhcnQsIGVuZCk7CiAgICB9CiAgICBpZihyYW5nZSA9PSBudWxsKSB7CiAgICAgIGxldCBmaWxlID0gYnVmOwogICAgICBsZXQgc3RyID0gYnVmOwogICAgICBpZih0eXBlb2Ygc3RyID09ICdzdHJpbmcnKSB7CiAgICAgICAgaWYoIXBhdGguaXNGaWxlKHN0cikpIHRocm93IEVycm9yKGBGaWxlTWFwXHgxYlsxOzM1bTwke3RoaXMuZmlsZX0+XHgxYlswbSBJbmV4aXN0ZW50IGZpbGUgJyR7c3RyfSdgKTsKICAgICAgICBzdHIgPSBGaWxlTWFwLmZvcihzdHIpOwogICAgICB9CiAgICAgIHJldHVybiBzdHI7CiAgICB9CiAgICBpZihidWYgPT09IC0xKSByZXR1cm4gbnVsbDsKICAgIHRocm93IG5ldyBFcnJvcihgYXQoJHtpfSkgYCArIGluc3BlY3QoeyByYW5nZSwgYnVmIH0pKTsKICB9CgogIHRvQXJyYXkoKSB7CiAgICByZXR1cm4gdGhpcy5tYXAoKHMsIGkpID0+IHRoaXMuYXQoaSkpOwogIH0KCiAgaG9sZXMoKSB7CiAgICBsZXQgcmFuZ2VzID0gWy4uLnRoaXMubWFwKChbcmFuZ2VdKSA9PiByYW5nZSldLnNvcnQoQ29tcGFyZVJhbmdlKTsKICAgIGxldCBpdGVyID0gTnVtZXJpY1JhbmdlLmhvbGVzKHJhbmdlcywgdHJ1ZSk7CiAgICBsZXQgaG9sZXMgPSBbLi4uaXRlcl07CiAgICBsZXQgbGVuID0gaG9sZXMubGVuZ3RoOwogICAgZm9yKGxldCBpID0gMDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgIGNvbnN0IGhvbGUgPSBob2xlc1tpXTsKICAgICAgY29uc3QgW3JhbmdlXSA9IHRoaXNbaV07CiAgICAgIGNvbnNvbGUubG9nKCcjJyArIChpICsgMSksIGNvbXBhY3QoMiksIGluc3BlY3QoeyBob2xlLCByYW5nZSB9LCB7IGNvbXBhY3Q6IDIsIGRlcHRoOiBJbmZpbml0eSB9KSk7CiAgICB9CiAgICByZXR1cm4gaG9sZXM7CiAgfQoKICBmaXJzdENodW5rKCkgewogICAgcmV0dXJuIHRoaXMuZmluZEluZGV4KChbcmFuZ2UsIGJ1Zl0sIGkpID0+IHJhbmdlICYmICFJc1doaXRlU3BhY2UodG9TdHJpbmcoYnVmLnNsaWNlKC4uLnJhbmdlKSkpKTsKICB9CgogIGxhc3RDaHVuaygpIHsKICAgIHJldHVybiB0aGlzLmZpbmRMYXN0SW5kZXgoKFtyYW5nZSwgYnVmXSwgaSkgPT4gcmFuZ2UgJiYgIUlzV2hpdGVTcGFjZSh0b1N0cmluZyhidWYuc2xpY2UoLi4ucmFuZ2UpKSkpOwogIH0KCiAgd3JpdGUob3V0LCBkZXB0aCA9IDAsIHNlcmlhbCkgewogICAgaWYoZGVidWcgPiAyKSBkZWJ1Z0xvZyhgRmlsZU1hcFx4MWJbMTszNW08JHt0aGlzLmZpbGV9Plx4MWJbMG0ud3JpdGVgLCBjb21wYWN0KDEpLCB7IG91dCwgZGVwdGgsIHNlcmlhbCB9KTsKICAgIGxldCByLAogICAgICB3cml0dGVuID0gMDsKICAgIGxldCB7IGxlbmd0aCB9ID0gdGhpczsKICAgIHNlcmlhbCA/Pz0gcmFuZEludCgwLCAxMDAwKTsKICAgIGlmKHRoaXMuc2VyaWFsID09PSBzZXJpYWwpIHJldHVybiAwOwogICAgdGhpcy5zZXJpYWwgPSBzZXJpYWw7CiAgICBpZih0eXBlb2Ygb3V0ID09ICdzdHJpbmcnKSBvdXQgPSBGaWxlV3JpdGVyKG91dCk7CiAgICBsZXQgZmlyc3QgPSB0aGlzLmZpcnN0Q2h1bmsoKTsKICAgIGxldCBsYXN0ID0gdGhpcy5sYXN0Q2h1bmsoKTsKCiAgICBpZihkZWJ1ZyA+IDIpCiAgICAgIGRlYnVnTG9nKGBGaWxlTWFwXHgxYlsxOzM1bTwke3RoaXMuZmlsZX0+XHgxYlswbS53cml0ZWAsIGNvbXBhY3QoMiksIHsKICAgICAgICBjaHVua3M6IFt0aGlzLmF0KGZpcnN0KSwgdGhpcy5hdChsYXN0KV0KICAgICAgfSk7CiAgICBmb3IobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgbGV0IHN0ciA9IHRoaXMuYXQoaSk7CiAgICAgIGlmKHN0ciA9PT0gbnVsbCB8fCBzdHIgPT09IHVuZGVmaW5lZCkgY29udGludWU7CiAgICAgIGxldCBsZW4gPSBzdHIuYnl0ZUxlbmd0aCA/PyBzdHIubGVuZ3RoOwogICAgICBpZihpc09iamVjdChzdHIpKSB7CiAgICAgICAgaWYoc3RyIGluc3RhbmNlb2YgRmlsZU1hcCkgewogICAgICAgICAgaWYoc3RyLnNlcmlhbCA9PT0gc2VyaWFsKSB7CiAgICAgICAgICAgIHIgPSAwOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICAgIHIgPSBzdHIud3JpdGUob3V0LCBkZXB0aCArIDEsIHNlcmlhbCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmKGRlcHRoID4gMCAmJiBpID09IGZpcnN0KSBvdXQucHV0cyhGaWxlQmFubmVyQ29tbWVudCh0aGlzLmZpbGUsIDApKTsKICAgICAgICAgIHIgPSBvdXQud3JpdGUoc3RyLCBsZW4pOwogICAgICAgICAgaWYoZGVwdGggPiAwICYmIGkgPT0gbGFzdCkgb3V0LnB1dHMoRmlsZUJhbm5lckNvbW1lbnQodGhpcy5maWxlLCAxKSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGxldCB0eXBlID0gZ2V0VHlwZU5hbWUoc3RyKTsKICAgICAgICBjb25zb2xlLmxvZygnaW52YWxpZCB0eXBlOicsIHR5cGUpOwogICAgICAgIHRocm93IG5ldyBFcnJvcih0eXBlKTsKICAgICAgfQogICAgICBpZihkZWJ1ZyA+PSAyKSBkZWJ1Z0xvZyhgRmlsZU1hcFx4MWJbMTszNW08JHt0aGlzLmZpbGV9Plx4MWJbMG0ud3JpdGVgLCBgWyR7aSArIDF9LyR7bGVuZ3RofV1gLCBgcmVzdWx0PSR7cn1gKTsKICAgICAgaWYociA8IDApIHsKICAgICAgICBsZXQgZXJyID0gZXJyb3IoKTsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2Vycm9yIHdyaXRpbmcgJyArIGxlbiArICcgYnl0ZXM6ICcgKyBpbnNwZWN0KGVycikpOwogICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIHdyaXR0ZW4gKz0gcjsKICAgIH0KCiAgICByZXR1cm4gd3JpdHRlbjsKICB9CgogIHRvU3RyaW5nKGZuID0gRmlsZUJhbm5lckNvbW1lbnQpIHsKICAgIGNvbnN0IG4gPSB0aGlzLmxlbmd0aDsKICAgIGxldCBzID0gJycsCiAgICAgIGk7CiAgICBmb3IoaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgbGV0IHN0cjsKICAgICAgY29uc3QgW3JhbmdlLCBidWZdID0gdGhpc1tpXTsKICAgICAgaWYocmFuZ2UgPT09IG51bGwgJiYgYnVmID09PSBudWxsKSBjb250aW51ZTsKICAgICAgaWYoKHN0ciA9IHRoaXMuYXQoaSkpID09PSBudWxsKSBjb250aW51ZTsKICAgICAgaWYocmFuZ2UgPT09IG51bGwpIGlmICh0eXBlb2YgYnVmID09ICdzdHJpbmcnKSBzdHIgPSBmbihidWYsIDApICsgc3RyICsgZm4oYnVmLCAxKTsKICAgICAgcyArPSBzdHI7CiAgICB9CiAgICByZXR1cm4gczsKICB9Cn0KCkZpbGVNYXAucHJvdG90eXBlW1N5bWJvbC50b1N0cmluZ1RhZ10gPSAnRmlsZU1hcCc7CkZpbGVNYXAucHJvdG90eXBlW2luc3BlY3RTeW1ib2xdID0gZnVuY3Rpb24oZGVwdGgsIG9wdHMpIHsKICBvcHRzID0gewogICAgLi4ub3B0cywKICAgIGNvbXBhY3Q6IDIsCiAgICBtYXhBcnJheUxlbmd0aDogSW5maW5pdHksCiAgICBtYXhTdHJpbmdMZW5ndGg6IDQwLAogICAgc3RyaW5nQnJlYWtOZXdsaW5lOiBmYWxzZSwKICAgIGN1c3RvbUluc3BlY3Q6IHRydWUsCiAgICBkZXB0aDogZGVwdGggKyA0CiAgfTsKCiAgbGV0IGFyciA9IFsuLi50aGlzXS5tYXAoKFtyYW5nZSwgYnVmXSwgaSkgPT4gewogICAgaWYocmFuZ2UpIHsKICAgICAgYnVmID0gYnVmLnNsaWNlKC4uLnJhbmdlKTsKICAgIH0KCiAgICBjb25zdCBpc0J1ZiA9IGlzT2JqZWN0KGJ1ZikgJiYgdHlwZXMuaXNBcnJheUJ1ZmZlcihidWYpOwogICAgcmV0dXJuIFtyYW5nZSwgaXNCdWYgPyB0aGlzLmZpbGUgOiBidWYsIGlzQnVmID8gdG9TdHJpbmcoYnVmKSA6IG51bGxdCiAgICAgIC5tYXAoKGl0ZW0sIGkpID0+CiAgICAgICAgaW5zcGVjdChpdGVtLCB7CiAgICAgICAgICAuLi5vcHRzLAogICAgICAgICAgY29tcGFjdDogMSwKICAgICAgICAgIGN1c3RvbUluc3BlY3Q6IHRydWUKICAgICAgICB9KS5wYWRFbmQoaSA9PSAwID8gMzEgOiAwKQogICAgICApCiAgICAgIC5qb2luKCcsICcpOwogIH0pOwoKICByZXR1cm4gKAogICAgYEZpbGVNYXBceDFiWzE7MzVtPCR7dGhpcy5maWxlfT5ceDFiWzBtIGAgKyBhcnIubWFwKChpdGVtLCBpKSA9PiBgWyAjJHtpfSAke2l0ZW19IF1gKS5qb2luKCcsXG4gICcpID8/CiAgICBpbnNwZWN0KGFyciwgewogICAgICAuLi5vcHRzCiAgICB9KQogICk7Cn07CgpmdW5jdGlvbiBCdWZmZXJGaWxlKGZpbGUsIGJ1ZikgewogIGZpbGUgPSBwYXRoLm5vcm1hbGl6ZShmaWxlKTsKICBpZighYnVmKSBidWYgPSBmaWxlQnVmZmVycy5nZXQoZmlsZSkgPz8gYnVmZmVyc1tmaWxlXTsKICBpZighYnVmKSBidWYgPSBidWZmZXJzW2ZpbGVdID8/IGZzLnJlYWRGaWxlU3luYyhmaWxlLCB7IGZsYWc6ICdyJyB9KTsKICBpZih0eXBlb2YgYnVmID09ICdvYmplY3QnICYmIGJ1ZiAhPT0gbnVsbCkgewogICAgYnVmZmVyUmVmLnNldChidWYsIGZpbGUpOwogICAgZmlsZUJ1ZmZlcnMuc2V0KGZpbGUsIGJ1Zik7CiAgICBidWYuZmlsZSA9IGZpbGU7CiAgfQogIHJldHVybiBidWY7Cn0KCmZ1bmN0aW9uIEJ1ZmZlckxlbmd0aHMoZmlsZSkgewogIHJldHVybiBidWZmZXJzW2ZpbGVdLm1hcChiID0+IGIuYnl0ZUxlbmd0aCk7Cn0KCmZ1bmN0aW9uIEJ1ZmZlck9mZnNldHMoZmlsZSkgewogIHJldHVybiBidWZmZXJzW2ZpbGVdLnJlZHVjZSgoW3BvcywgbGlzdF0sIGIpID0+IFtwb3MgKyBiLmJ5dGVMZW5ndGgsIGxpc3QuY29uY2F0KFtwb3NdKV0sIFswLCBbXV0pWzFdOwp9CgpmdW5jdGlvbiBCdWZmZXJSYW5nZXMoZmlsZSkgewogIHJldHVybiBidWZmZXJzW2ZpbGVdLnJlZHVjZSgoW3BvcywgbGlzdF0sIGIpID0+IFtwb3MgKyBiLmJ5dGVMZW5ndGgsIGxpc3QuY29uY2F0KFtbcG9zLCBiLmJ5dGVMZW5ndGhdXSldLCBbMCwgW11dKVsxXTsKfQoKZnVuY3Rpb24gV3JpdGVGaWxlKGZpbGUsIHRvaykgewogIGxldCBmID0gc3RkLm9wZW4oZmlsZSwgJ3crJyk7CiAgbGV0IHIgPSB0eXBlcy5pc0FycmF5QnVmZmVyKHRvaykgPyBmLndyaXRlKHRvaywgMCwgdG9rLmJ5dGVMZW5ndGgpIDogZi5wdXRzKHRvayk7CiAgY29uc29sZS5sb2coJ1dyb3RlICInICsgZmlsZSArICciOiAnICsgdG9rLmxlbmd0aCArICcgYnl0ZXMnICsgYCAoJHtyfSlgKTsKfQoKZnVuY3Rpb24gRHVtcExleGVyKGxleCkgewogIGNvbnN0IHsgc2l6ZSwgcG9zLCBzdGFydCwgbGluZSwgY29sdW1uLCBsaW5lU3RhcnQsIGxpbmVFbmQsIGNvbHVtbkluZGV4IH0gPSBsZXg7CiAgcmV0dXJuICdMZXhlciAnICsgaW5zcGVjdCh7IHN0YXJ0LCBwb3MsIHNpemUgfSk7Cn0KCmZ1bmN0aW9uIER1bXBUb2tlbih0b2spIHsKICBjb25zdCB7IGxlbmd0aCwgb2Zmc2V0LCBjaGFycywgbG9jIH0gPSB0b2s7CiAgcmV0dXJuIGDimIUgVG9rZW4gJHtpbnNwZWN0KHsgY2hhcnMsIG9mZnNldCwgbGVuZ3RoLCBsb2MgfSwgeyBkZXB0aDogMSB9KX1gOwp9CgpmdW5jdGlvbiogRGVwZW5kZW5jeVRyZWUocm9vdCwgaW5kZW50ID0gJyAnLCBzcGFjaW5nID0gZmFsc2UsIGRlcHRoID0gMCwgcHJlID0gJycsIGZuID0gKG5hbWUsIGRlcHRoKSA9PiBgJHtuYW1lfSAoJHtkZXB0aH0pYCkgewogIGlmKCFBcnJheS5pc0FycmF5KGRlcGVuZGVuY3lUcmVlKHJvb3QpKSkgdGhyb3cgbmV3IEVycm9yKGBObyBzdWNoIGZpbGUgJyR7cm9vdH0nIGluIGRlcGVuZGVuY3kgTWFwIChbJHtbLi4uZGVwZW5kZW5jeU1hcC5rZXlzKCldfV0pYCk7CgogIGlmKGRlcHRoID09IDApIHlpZWxkIHByZSArIHN0cmlwTGVhZGluZ0RvdFNsYXNoKGZuKHJvb3QsIGRlcHRoKSkgKyBgXG5gOwoKICBsZXQgYSA9IGRlcGVuZGVuY3lNYXAuZ2V0KHJvb3QpOwogIGxldCBpID0gMCwKICAgIG4gPSBhLmxlbmd0aDsKCiAgZm9yKGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICBpZihzcGFjaW5nKSB5aWVsZCAocHJlICsgaW5kZW50ICsgYOKUgiAgYCArICdcbicpLnJlcGVhdChOdW1iZXIoc3BhY2luZykpOwoKICAgIHlpZWxkIHByZSArIGluZGVudCArIChuID09IDEgPyBg4pSU4pSAIGAgOiBpIDwgbiAtIDEgPyBg4pSc4pSAIGAgOiBg4pSU4pSAIGApICsgc3RyaXBMZWFkaW5nRG90U2xhc2goZm4oYVtpXSwgZGVwdGggKyAxKSkgKyAnXG4nOwoKICAgIHlpZWxkKiBEZXBlbmRlbmN5VHJlZShhW2ldLCBpbmRlbnQsIHNwYWNpbmcsIGRlcHRoICsgMSwgcHJlICsgaW5kZW50ICsgKG4gPT0gMSA/IGAgICBgIDogaSA8IG4gLSAxID8gYOKUgiAgYCA6IGAgICBgKSk7CiAgfQoKICBmdW5jdGlvbiBzdHJpcExlYWRpbmdEb3RTbGFzaChuKSB7CiAgICBpZihuLnN0YXJ0c1dpdGgoJy4vJykpIG4gPSBuLnNsaWNlKDIpOwogICAgcmV0dXJuIG47CiAgfQp9CgpmdW5jdGlvbiBTcHJlYWRBbmRKb2luKGl0ZXJhdG9yLCBzZXBhcmF0b3IgPSAnJykgewogIHJldHVybiBbLi4uaXRlcmF0b3JdLmpvaW4oc2VwYXJhdG9yKTsKfQoKZnVuY3Rpb24qIFByaW50VXNlcnNjcmlwdEJhbm5lcihmaWVsZHMpIHsKICBjb25zdCBkZWZhdWx0cyA9IHsKICAgIG5hbWU6ICdodHRwczovL2dpdGh1Yi5jb20vcnNlbm4nLAogICAgbmFtZXNwYWNlOiAnaHR0cHM6Ly9naXRodWIuY29tL3JzZW5uJywKICAgIHZlcnNpb246ICcxLjAnLAogICAgZGVzY3JpcHRpb246ICcnLAogICAgYXV0aG9yOiAnUm9tYW4gTC4gU2VubicsCiAgICBtYXRjaDogJ2h0dHAqOi8vKi8qJywKICAgIGljb246ICdkYXRhOmltYWdlL2dpZjtiYXNlNjQsUjBsR09EbGhBUUFCQUFBQUFDSDVCQUVLQUFFQUxBQUFBQUFCQUFFQUFBSUNUQUVBT3c9PScsCiAgICBncmFudDogJ25vbmUnCiAgfTsKCiAgbGV0IGtleXMgPSBPYmplY3Qua2V5cyhkZWZhdWx0cykuY29uY2F0KE9iamVjdC5rZXlzKGZpZWxkcykpLnVuaXF1ZSgpOwogIHlpZWxkIGAvLyA9PVVzZXJTY3JpcHQ9PWA7CiAgZm9yKGxldCBuYW1lIG9mIGtleXMpIHsKICAgIGNvbnN0IHZhbHVlID0gZmllbGRzW25hbWVdID8/IGRlZmF1bHRzW25hbWVdOwoKICAgIHlpZWxkIGAvLyBAJHtuYW1lLnBhZEVuZCgxMil9ICR7dmFsdWV9YDsKICB9CgogIHlpZWxkIGAvLyA9PS9Vc2VyU2NyaXB0PT1gOwp9CgpmdW5jdGlvbiBQcmludEVTNkltcG9ydChpbXApIHsKICByZXR1cm4gewogICAgW0ltcG9ydFR5cGVzLklNUE9SVF9OQU1FU1BBQ0VdOiAoeyBsb2NhbCwgZmlsZSB9KSA9PiBgaW1wb3J0ICogYXMgJHtsb2NhbH0gZnJvbSAnJHtmaWxlfSc7YCwKICAgIFtJbXBvcnRUeXBlcy5JTVBPUlRfREVGQVVMVF06ICh7IGxvY2FsLCBmaWxlIH0pID0+IGBpbXBvcnQgJHtsb2NhbH0gZnJvbSAnJHtmaWxlfSc7YCwKICAgIFtJbXBvcnRUeXBlcy5JTVBPUlRdOiAoeyBsb2NhbCwgZmlsZSB9KSA9PiBgaW1wb3J0IHsgJHtsb2NhbC5qb2luKCcsICcpfSB9IGZyb20gJyR7ZmlsZX0nO2AKICB9W2ltcC50eXBlXShpbXApOwp9CgpmdW5jdGlvbiBQcmludENKU0ltcG9ydCh7IHR5cGUsIGxvY2FsLCBmaWxlIH0pIHsKICByZXR1cm4gewogICAgW0ltcG9ydFR5cGVzLklNUE9SVF9OQU1FU1BBQ0VdOiAoKSA9PiBgY29uc3QgJHtsb2NhbH0gPSByZXF1aXJlKCcke2ZpbGV9Jyk7YCwKICAgIFtJbXBvcnRUeXBlcy5JTVBPUlRfREVGQVVMVF06ICgpID0+IGBjb25zdCAke2xvY2FsfSA9IHJlcXVpcmUoJyR7ZmlsZX0nKTtgLAogICAgW0ltcG9ydFR5cGVzLklNUE9SVF06ICgpID0+IGBjb25zdCB7ICR7bG9jYWwuam9pbignLCAnKX0gfSA9IHJlcXVpcmUoJyR7ZmlsZX0nKTtgCiAgfVt0eXBlXSgpOwp9CgpmdW5jdGlvbiBtYWluKC4uLmFyZ3MpIHsKICBnbG9iYWxUaGlzLmNvbnNvbGUgPSBuZXcgQ29uc29sZShzdGQuZXJyLCB7CiAgICBpbnNwZWN0T3B0aW9uczogewogICAgICBjb2xvcnM6IHRydWUsCiAgICAgIGRlcHRoOiBJbmZpbml0eSwKICAgICAgc3RyaW5nQnJlYWtOZXdsaW5lOiB0cnVlLAogICAgICBtYXhTdHJpbmdMZW5ndGg6IDEwMDAsCiAgICAgIG1heEFycmF5TGVuZ3RoOiAxMDAsCiAgICAgIGNvbXBhY3Q6IDEsCiAgICAgIGhpZGVLZXlzOiBbU3ltYm9sLnRvU3RyaW5nVGFnIC8qLCAnY29kZScqL10KICAgIH0KICB9KTsKCiAgbGV0IG9wdGluZCA9IDAsCiAgICBjb2RlID0gJ2MnLAogICAgZXhwID0gdHJ1ZTsKCiAgbGV0IG91dCA9IEZkV3JpdGVyKDEsICdzdGRvdXQnKTsKICBsZXQgc3RyZWFtID0gZGVmaW5lKAogICAgeyBpbmRlbnQ6IDAgfSwKICAgIHsKICAgICAgbGluZXM6IFtdLAogICAgICB3cml0ZShidWYsIGxlbikgewogICAgICAgIGxldCBzID0gdG9TdHJpbmcoYnVmLCAwLCBsZW4pOwogICAgICAgIHJldHVybiB0aGlzLnB1dHMocyk7CiAgICAgIH0sCiAgICAgIHB1dHMocykgewogICAgICAgIGxldCBwYWQgPSAnICAnLnJlcGVhdCh0aGlzLmluZGVudCk7CiAgICAgICAgdGhpcy5saW5lcy5wdXNoKC4uLnMuc3BsaXQoL1xyP1xuL2cpLm1hcChsaW5lID0+IHBhZCArIGxpbmUpKTsKICAgICAgICByZXR1cm4gcy5sZW5ndGg7CiAgICAgIH0sCiAgICAgIGNsb3NlKCkgewogICAgICAgIGxldCBwcmV2ID0gJyc7CiAgICAgICAgY29uc3QgaXNXUyA9IHMgPT4gcy50cmltKCkgPT0gJyc7CiAgICAgICAgZm9yKGxldCBsaW5lIG9mIHRoaXMubGluZXMpIHsKICAgICAgICAgIGlmKCEoaXNXUyhsaW5lKSAmJiBpc1dTKHByZXYpKSkgewogICAgICAgICAgICBvdXQucHV0cyhsaW5lLnRyaW1FbmQoKSArICdcbicpOwogICAgICAgICAgfQogICAgICAgICAgcHJldiA9IGxpbmU7CiAgICAgICAgfQogICAgICAgIG91dC5jbG9zZSgpOwogICAgICB9CiAgICB9CiAgKTsKCiAgbGV0IG9wdHM7CiAgbGV0IHBhcmFtcyA9IGdldE9wdCgKICAgIChvcHRzID0gewogICAgICBoZWxwOiBbZmFsc2UsIG51bGwsICdoJ10sCiAgICAgIGRlYnVnOiBbZmFsc2UsICgpID0+ICsrZGVidWcsICd4J10sCiAgICAgIGxvZzogW3RydWUsIGZpbGUgPT4gKGxvZ0ZpbGUgPSBGaWxlV3JpdGVyKGZpbGUpKSwgJ3YnXSwKICAgICAgc29ydDogW2ZhbHNlLCBudWxsLCAncyddLAogICAgICAnY2FzZS1zZW5zaXRpdmUnOiBbZmFsc2UsIG51bGwsICdjJ10sCiAgICAgIHF1aWV0OiBbZmFsc2UsIChxdWlldCA9IChxdWlldCB8IDApICsgMSksICdxJ10sCiAgICAgIGV4cG9ydDogW2ZhbHNlLCAoKSA9PiAoZXhwID0gdHJ1ZSksICdlJ10sCiAgICAgIGltcG9ydHM6IFtmYWxzZSwgKCkgPT4gKG9ubHlJbXBvcnRzID0gdHJ1ZSksICdpJ10sCiAgICAgICdyZWxhdGl2ZS10byc6IFt0cnVlLCBhcmcgPT4gKHJlbGF0aXZlVG8gPSBwYXRoLmFic29sdXRlKGFyZykpLCAnUiddLAogICAgICBvdXRwdXQ6IFt0cnVlLCBmaWxlID0+IChvdXRwdXRGaWxlID0gZmlsZSksICdvJ10sCiAgICAgIHJlY3Vyc2l2ZTogW2ZhbHNlLCAoKSA9PiAocmVjdXJzaXZlID0gdHJ1ZSksICdyJ10sCiAgICAgICduby1yZWN1cnNpdmUnOiBbZmFsc2UsICgpID0+IChyZWN1cnNpdmUgPSBmYWxzZSksICdSJ10sCiAgICAgICdyZW1vdmUtZXhwb3J0cyc6IFtmYWxzZSwgKCkgPT4gKHJlbW92ZUV4cG9ydHMgPSB0cnVlKSwgJ0UnXSwKICAgICAgJ3JlbW92ZS1pbXBvcnRzJzogW2ZhbHNlLCAoKSA9PiAocmVtb3ZlSW1wb3J0cyA9IHRydWUpLCAnSSddLAogICAgICAnY2hlY2staW1wb3J0cyc6IFtmYWxzZSwgKCkgPT4gKHNjcmlwdEFyZ3NbMF0gPSAnY2hlY2staW1wb3J0cycpLCBudWxsXSwKICAgICAgJ2xpc3QtaW1wb3J0cyc6IFtmYWxzZSwgKCkgPT4gKHNjcmlwdEFyZ3NbMF0gPSAnbGlzdC1pbXBvcnRzJyksIG51bGxdLAogICAgICAncmVtb3ZlLWNvbW1lbnRzJzogW2ZhbHNlLCAoKSA9PiAocmVtb3ZlQ29tbWVudHMgPSB0cnVlKSwgJ0MnXSwKICAgICAgJ2dsb2JhbC1leHBvcnRzJzogW2ZhbHNlLCAoKSA9PiArK2dsb2JhbEV4cG9ydHMsICdHJ10sCiAgICAgICdzaG93LWRlcGVuZGVuY2llcyc6IFtmYWxzZSwgKCkgPT4gKytzaG93RGVwcywgJ2QnXSwKICAgICAgJ3ByaW50LWZpbGVzJzogW2ZhbHNlLCAoKSA9PiAocHJpbnRGaWxlcyA9IHRydWUpLCAnbCddLAogICAgICAnbm8tcHJpbnQtZmlsZXMnOiBbZmFsc2UsICgpID0+IChwcmludEZpbGVzID0gZmFsc2UpLCAnTCddLAogICAgICAncmVhZC1wYWNrYWdlJzogW2ZhbHNlLCAoKSA9PiAocmVhZFBhY2thZ2UgPSB0cnVlKSwgJ3AnXSwKICAgICAgJ25vLXJlYWQtcGFja2FnZSc6IFtmYWxzZSwgKCkgPT4gKHJlYWRQYWNrYWdlID0gZmFsc2UpLCAnUCddLAogICAgICB1c2Vyc2NyaXB0OiBbZmFsc2UsICgpID0+ICh1c2VyU2NyaXB0ID0gdHJ1ZSksICdVJ10sCiAgICAgIHRpbWU6IFtmYWxzZSwgKCkgPT4gKHNob3dUaW1pbmcgPSB0cnVlKSwgJ3QnXSwKICAgICAgJ0AnOiAnZmlsZXMnCiAgICB9KSwKICAgIGFyZ3MKICApOwoKICBmdW5jdGlvbiBTaG93SGVscCgpIHsKICAgIGxldCBlbnRyaWVzID0gT2JqZWN0LmVudHJpZXMob3B0cyk7CiAgICBsZXQgbWF4bGVuID0gZW50cmllcy5yZWR1Y2UoKGFjYywgW25hbWVdKSA9PiAoYWNjID4gbmFtZS5sZW5ndGggPyBhY2MgOiBuYW1lLmxlbmd0aCksIDApOwoKICAgIGxldCBzID0gT2JqZWN0LmVudHJpZXMob3B0cykucmVkdWNlKAogICAgICAoYWNjLCBbbmFtZSwgW2hhc0FyZywgZm4sIHNob3J0T3B0XV0pID0+CiAgICAgICAgYWNjICsgKGAgICAgJHsoc2hvcnRPcHQgPyAnLScgKyBzaG9ydE9wdCArICcsJyA6ICcnKS5wYWRTdGFydCg0LCAnICcpfSAtLSR7bmFtZS5wYWRFbmQobWF4bGVuLCAnICcpfSBgICsgKGhhc0FyZyA/ICh0eXBlb2YgaGFzQXJnID09ICdib29sZWFuJyA/ICdBUkcnIDogaGFzQXJnKSA6ICcnKSkucGFkRW5kKDQwLCAnICcpICsgJ1xuJywKICAgICAgYFVzYWdlOiAke3BhdGguYmFzZW5hbWUoc2NyaXB0QXJnc1swXSl9IFtPUFRJT05TXSA8RklMRVMuLi4+XG5cbmAKICAgICk7CiAgICBzdGQucHV0cyhzICsgJ1xuJyk7CiAgICBzdGQuZXhpdCgwKTsKICB9CgogIGlmKHBhcmFtcy5oZWxwKSBTaG93SGVscCgpOwoKICBsZXQgZmlsZXMgPSBwYXJhbXNbJ0AnXTsKCiAgaWYoL2NoZWNrLWltcG9ydC8udGVzdChzY3JpcHRBcmdzWzBdKSkgewogICAgaWRlbnRpZmllcnNVc2VkID0gbWVtb2l6ZShhcmcgPT4gbmV3IFNldCgpKTsKICAgIGlmKHByaW50RmlsZXMgPT09IHVuZGVmaW5lZCkgcHJpbnRGaWxlcyA9IGZhbHNlOwogICAgb25seUltcG9ydHMgPSBmYWxzZTsKICAgIG91dHB1dEZpbGUgPSBudWxsOwogICAgb3V0ID0gRHVtbXlXcml0ZXIoJy9kZXYvbnVsbCcpOwogIH0gZWxzZSBpZigvbGlzdC1pbXBvcnQvLnRlc3Qoc2NyaXB0QXJnc1swXSkpIHsKICAgIGlmKHByaW50RmlsZXMgPT09IHVuZGVmaW5lZCkgcHJpbnRGaWxlcyA9IHRydWU7CiAgICBxdWlldCA9IHRydWU7CiAgICBvbmx5SW1wb3J0cyA9IHRydWU7CiAgICBvdXRwdXRGaWxlID0gbnVsbDsKICAgIG91dCA9IER1bW15V3JpdGVyKCcvZGV2L251bGwnKTsKICB9IGVsc2UgewogICAgaWYodHlwZW9mIHJlY3Vyc2l2ZSA9PSAndW5kZWZpbmVkJykgcmVjdXJzaXZlID0gdHJ1ZTsKICB9CgogIGlmKHR5cGVvZiByZWN1cnNpdmUgPT0gJ3VuZGVmaW5lZCcpIHJlY3Vyc2l2ZSA9IGZhbHNlOwoKICBjb25zdCB7IHNvcnQsICdjYXNlLXNlbnNpdGl2ZSc6IGNhc2VTZW5zaXRpdmUgfSA9IHBhcmFtczsKCiAgaWYob3V0cHV0RmlsZSkgb3V0ID0gRmlsZVdyaXRlcihvdXRwdXRGaWxlKTsKCiAgbGV0IGFyZ0xpc3QgPSBbLi4uc2NyaXB0QXJnc107CgogIGxvZ0ZpbGUoYFN0YXJ0IG9mOiAke2FyZ0xpc3Quam9pbignICcpfVxuYCk7CgogIGNvbnN0IFJlbGF0aXZlUGF0aCA9IGZpbGUgPT4gKHBhdGguaXNBYnNvbHV0ZShmaWxlKSA/IGZpbGUgOiBmaWxlLnN0YXJ0c1dpdGgoJy4vJykgPyBmaWxlIDogJy4vJyArIGZpbGUpOwoKICBpZighZmlsZXMubGVuZ3RoKSB0aHJvdyBuZXcgQXJndW1lbnRFcnJvcignRXhwZWN0aW5nIGFyZ3VtZW50IDxmaWxlcy4uLj4nKTsKCiAgbGV0IHJlc3VsdHMgPSBbXTsKCiAgZm9yKGxldCBmaWxlIG9mIGZpbGVzKSB7CiAgICBmaWxlID0gUmVsYXRpdmVQYXRoKGZpbGUpOwogICAgbGV0IGxvZyA9IHF1aWV0ID8gKCkgPT4ge30gOiAoLi4uYXJncykgPT4gY29uc29sZS5sb2coYCR7ZmlsZX06YCwgLi4uYXJncyk7CgogICAgbGV0IHJlc3VsdCA9IFByb2Nlc3NGaWxlKGZpbGUsIGxvZywgcmVjdXJzaXZlLCAwKTsKCiAgICBpZihkZWJ1ZyA+PSAxKSBjb25zb2xlLmxvZygncmVzdWx0JywgY29tcGFjdChmYWxzZSwgeyBkZXB0aDogSW5maW5pdHkgfSksIHJlc3VsdCk7CgogICAgcmVzdWx0cy5wdXNoKHJlc3VsdCk7CiAgfQoKICBpZighcmVtb3ZlSW1wb3J0cykgewogICAgbGV0IGJpbmRpbmdzID0gW10sCiAgICAgIGltcG9ydExpbmVzID0gW107CiAgICBjb25zdCBDb250YWluc0FueSA9IChhcnIsIHRva2VucykgPT4gdG9rZW5zLnNvbWUodG9rID0+IGFyci5pbmRleE9mKHRvaykgIT0gLTEpOwogICAgbGV0IGxpbmVzID0gaGVhZGVyCiAgICAgIC5maWx0ZXIoaW1wZXhwID0+IElzQnVpbHRpbihpbXBleHAuZmlsZSkpCiAgICAgIC5maWx0ZXIoaGRyID0+ICFoZHIuY29kZS5zdGFydHNXaXRoKCdleHBvcnQnKSkKICAgICAgLnJlZHVjZSgKICAgICAgICAoW2FjYywgcHJldl0sIGhkcikgPT4gewogICAgICAgICAgbGV0IHsgY29kZSB9ID0gaGRyOwogICAgICAgICAgbGV0IGRpc2FibGUgPSBDb250YWluc0FueShiaW5kaW5ncywgaGRyLmlkcygpKTsKICAgICAgICAgIGlmKHByZXYgIT0gaGRyLnNvdXJjZSkgewogICAgICAgICAgICBhY2MucHVzaCgnJyk7CiAgICAgICAgICAgIGFjYy5wdXNoKGBgKTsKICAgICAgICAgIH0KCiAgICAgICAgICBsZXQgZHVwbGljYXRlID0gaW1wb3J0TGluZXMuaW5kZXhPZihjb2RlKSAhPSAtMTsKICAgICAgICAgIGltcG9ydExpbmVzLnB1c2goY29kZSk7CiAgICAgICAgICBpZighZHVwbGljYXRlICYmIGRpc2FibGUpIGNvZGUgPSAnJzsKICAgICAgICAgIGlmKCFkdXBsaWNhdGUpIHsKICAgICAgICAgICAgYmluZGluZ3MucHVzaCguLi5oZHIuaWRzKCkpOwogICAgICAgICAgICBhY2MucHVzaChjb2RlKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gW2FjYywgaGRyLnNvdXJjZV07CiAgICAgICAgfSwKICAgICAgICBbW10sIG51bGxdCiAgICAgIClbMF07CiAgICBpZihsaW5lcy5sZW5ndGgpIGxpbmVzID0gW0ZpbGVCYW5uZXJDb21tZW50KCdoZWFkZXInLCAwKSwgLi4ubGluZXMsICcnLCBGaWxlQmFubmVyQ29tbWVudCgnaGVhZGVyJywgMSldOwogICAgaWYoZGVidWcgPiAyKSBjb25zb2xlLmxvZygnbGluZXMnLCBsaW5lcyk7CgogICAgb3V0LnB1dHMobGluZXMucmVkdWNlKChhY2MsIGxpbmUpID0+IGFjYyArIGxpbmUudHJpbSgpICsgJ1xuJywgJycpKTsKICB9CgogIGlmKHVzZXJTY3JpcHQpIHsKICAgIGZvcihsZXQgbGluZSBvZiBQcmludFVzZXJzY3JpcHRCYW5uZXIoewogICAgICBuYW1lOiBvdXQuZmlsZSwKICAgICAgJ3J1bi1hdCc6ICdkb2N1bWVudC1zdGFydCcsCiAgICAgIHZlcnNpb246ICcxLjAnLAogICAgICBkZXNjcmlwdGlvbjogZmlsZXMuam9pbignLCAnKSwKICAgICAgZG93bmxvYWRVUkw6IGBodHRwczovL2xvY2FsaG9zdDo5MDAwLyR7b3V0LmZpbGV9YCwKICAgICAgdXBkYXRlVVJMOiBgaHR0cHM6Ly9sb2NhbGhvc3Q6OTAwMC8ke291dC5maWxlfWAKICAgIH0pKQogICAgICBzdHJlYW0ucHV0cyhsaW5lKTsKCiAgICBzdHJlYW0ucHV0cygiXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcbiIpOwogICAgKytzdHJlYW0uaW5kZW50OwogIH0KCiAgaWYoZGVidWcgPiAwKSBjb25zb2xlLmxvZygnb3V0Jywgb3V0LCBvdXQuZmlsZSk7CgogIGlmKG91dC5maWxlKSB7CiAgICBsZXQgbmJ5dGVzOwogICAgY29uc29sZS5sb2coYHJlc3VsdHNbMF1gLCByZXN1bHRzWzBdKTsKICAgIGNvbnNvbGUubG9nKGBzdHJlYW1gLCBzdHJlYW0pOwogICAgdHJ5IHsKICAgICAgbmJ5dGVzID0gcmVzdWx0c1swXS53cml0ZShzdHJlYW0pOwogICAgfSBjYXRjaChlcnJvcikgewogICAgICBjb25zb2xlLmxvZyhgd3JpdGUgZXJyb3IgKCcke291dC5maWxlfScpOmAsIGVycm9yKTsKICAgICAgc3RkLmV4aXQoMSk7CiAgICB9CgogICAgY29uc29sZS5sb2coYCR7bmJ5dGVzfSBieXRlcyB3cml0dGVuIHRvICcke291dC5maWxlfSdgKTsKICB9CgogIGlmKGdsb2JhbEV4cG9ydHMpIHsKICAgIGxldCBtYXhEZXB0aCA9IGdsb2JhbEV4cG9ydHMgLSAxOwogICAgbGV0IGV4cG9ydGVkTmFtZXMgPSBmb290ZXIuZmlsdGVyKCh7IGRlcHRoIH0pID0+IGRlcHRoIDw9IG1heERlcHRoKTsKICAgIC8vIGNvbnNvbGUubG9nKGBmb290ZXJgLCBleHBvcnRlZE5hbWVzLm1hcChpbXBleHAgPT4gIFtpbXBleHAuZGVwdGgsaW1wZXhwLm5hbWVdKSk7CgogICAgaWYoZGVidWcgPiAzKSBjb25zb2xlLmxvZyhgZXhwb3J0ZWROYW1lc2AsIGV4cG9ydGVkTmFtZXMpOwoKICAgIGV4cG9ydGVkTmFtZXMgPSBleHBvcnRlZE5hbWVzCiAgICAgIC5tYXAoKHsgbmFtZSB9KSA9PiBuYW1lKQogICAgICAudW5pcXVlKCkKICAgICAgLmZpbHRlcihuYW1lID0+IHR5cGVvZiBuYW1lID09ICdzdHJpbmcnKTsKCiAgICBzdHJlYW0ucHV0cyhgXG5PYmplY3QuYXNzaWduKGdsb2JhbFRoaXMsIHsgJHtleHBvcnRlZE5hbWVzLmpvaW4oJywgJyl9IH0pO1xuYCk7CiAgfQoKICBpZih1c2VyU2NyaXB0KSB7CiAgICAtLXN0cmVhbS5pbmRlbnQ7CiAgICBzdHJlYW0ucHV0cygnfSkoKTtcbicpOwogIH0KCiAgc3RyZWFtLmNsb3NlKCk7CgogIGxvZ0ZpbGUoYFByb2Nlc3NlZCBmaWxlczogJHtTcHJlYWRBbmRKb2luKGRlcGVuZGVuY3lNYXAua2V5cygpLCAnICcpfVxuYCk7Cn0KCnRyeSB7CiAgbWFpbiguLi5zY3JpcHRBcmdzLnNsaWNlKDEpKTsKfSBjYXRjaChlcnJvcikgewogIGNvbnNvbGUubG9nKGAke2Vycm9yLmNvbnN0cnVjdG9yLm5hbWV9OiAke2Vycm9yLm1lc3NhZ2V9JHtlcnJvci5zdGFjayA/ICdcbicgKyBlcnJvci5zdGFjayA6ICcnfWApOwogIHN0ZC5leGl0KDEpOwp9CgAAAAAAAAAANrgAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAcSEAAAAAAABxIQAAAAAAAAAAAAAAAPC/"
				],
				[
					107,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAABIuAAAIyEvdXNyL2Jpbi9lbnYgcWpzbQppbXBvcnQgKiBhcyBvcyBmcm9tICdvcyc7CmltcG9ydCAqIGFzIHN0ZCBmcm9tICdzdGQnOwppbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7CmltcG9ydCBpbnNwZWN0IGZyb20gJ2luc3BlY3QnOwppbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnOwppbXBvcnQgeyBMZXhlciwgVG9rZW4gfSBmcm9tICdsZXhlcic7CmltcG9ydCB7IENvbnNvbGUgfSBmcm9tICdjb25zb2xlJzsKaW1wb3J0IEVDTUFTY3JpcHRMZXhlciBmcm9tICdsaWIvbGV4ZXIvZWNtYXNjcmlwdC5qcyc7CmltcG9ydCB7IGludGVyc2VjdGlvbiwgZGlmZmVyZW5jZSwgc3ltbWV0cmljRGlmZmVyZW5jZSwgdW5pb24sIGVycm9yLCBnZXRzZXQsIG1lbW9pemUsIHJhbmRJbnQsIGdldFR5cGVOYW1lLCBnZXRUeXBlU3RyLCBpc09iamVjdCwgc2hvcnRlbiwgdG9TdHJpbmcsIHRvQXJyYXlCdWZmZXIsIGRlZmluZSwgY3VycnksIHVuaXF1ZSwgc3BsaXQsIGV4dGVuZEFycmF5LCBjYW1lbGl6ZSwgZ2V0T3B0LCBxdW90ZSwgZXNjYXBlLCB0eXBlcyB9IGZyb20gJ3V0aWwnOwoKKCd1c2Ugc3RyaWN0Jyk7CigndXNlIG1hdGgnKTsKCmNvbnN0IGluc3BlY3RTeW1ib2wgPSBTeW1ib2wuZm9yKCdxdWlja2pzLmluc3BlY3QuY3VzdG9tJyk7CgpjbGFzcyBBcmd1bWVudEVycm9yIGV4dGVuZHMgRXJyb3IgewogIGNvbnN0cnVjdG9yKC4uLmFyZ3MpIHsKICAgIHN1cGVyKC4uLmFyZ3MpOwogICAgdGhpcy5zdGFjayA9IG51bGw7CiAgfQp9CgpsZXQgYnVmZmVycyA9IHt9LAogIG1vZHVsZXMgPSB7fSwKICBzaG93VGltaW5nLAogIHJlbW92ZUV4cG9ydHMgPSBmYWxzZSwKICBvbmx5SW1wb3J0cyA9IGZhbHNlLAogIGdsb2JhbEV4cG9ydHMgPSAwLAogIHNob3dEZXBzID0gMCwKICByZW1vdmVJbXBvcnRzID0gZmFsc2UsCiAgcmVtb3ZlQ29tbWVudHMgPSBmYWxzZSwKICByZWFkUGFja2FnZSA9IGZhbHNlLAogIHVzZXJTY3JpcHQgPSBmYWxzZSwKICByZWxhdGl2ZVRvLAogIG91dHB1dEZpbGUsCiAgcmVjdXJzaXZlLAogIGRlYnVnID0gMCwKICBoZWFkZXIgPSBbXSwKICBmb290ZXIgPSBbXSwKICBwcm9jZXNzZWQgPSBuZXcgU2V0KCksCiAgYnVmZmVyUmVmID0gbmV3IFdlYWtNYXAoKSwKICBmaWxlQnVmZmVycyA9IG5ldyBNYXAoKSwKICBmaWxlTWFwcyA9IG5ldyBNYXAoKSwKICBkZXBlbmRlbmN5TWFwID0gbmV3IE1hcCgpLAogIHByaW50RmlsZXMsCiAgcXVpZXQgPSBmYWxzZSwKICBsb2dGaWxlID0gKCkgPT4ge307CgpsZXQgZGVwZW5kZW5jeVRyZWUgPSBtZW1vaXplKGFyZyA9PiBbXSwgZGVwZW5kZW5jeU1hcCk7CmxldCBidWZmZXJNYXAgPSBnZXRzZXQoYnVmZmVyUmVmKTsKbGV0IGlkZW50aWZpZXJzVXNlZDsKCmZ1bmN0aW9uIFJlYWRKU09OKGZpbGVuYW1lKSB7CiAgbGV0IGRhdGEgPSBmcy5yZWFkRmlsZVN5bmMoZmlsZW5hbWUsICd1dGYtOCcpOwogIHJldHVybiBkYXRhID8gSlNPTi5wYXJzZShkYXRhKSA6IG51bGw7Cn0KCmNvbnN0IFJlYWRQYWNrYWdlSlNPTiA9IG1lbW9pemUoKCkgPT4gUmVhZEpTT04oJ3BhY2thZ2UuanNvbicpID8/IHsgX21vZHVsZUFsaWFzZXM6IHt9IH0pOwoKZnVuY3Rpb24gUmVzb2x2ZUFsaWFzKGZpbGVuYW1lKSB7CiAgbGV0IHsgX21vZHVsZUFsaWFzZXMgfSA9IFJlYWRQYWNrYWdlSlNPTigpOwoKICBpZihmaWxlbmFtZSBpbiBfbW9kdWxlQWxpYXNlcykgcmV0dXJuIF9tb2R1bGVBbGlhc2VzW2ZpbGVuYW1lXTsKICByZXR1cm4gZmlsZW5hbWU7Cn0KCmZ1bmN0aW9uIE5vcm1hbGl6ZVBhdGgocCkgewogIHAgPSBwYXRoLmFic29sdXRlKHApOwogIHAgPSBwYXRoLnJlbGF0aXZlKHAsIHBhdGguZ2V0Y3dkKCkpOwogIHAgPSBwYXRoLm5vcm1hbGl6ZShwKTsKICBpZighcGF0aC5pc0Fic29sdXRlKHApKSBpZiAoIXAuc3RhcnRzV2l0aCgnLi8nKSAmJiAhcC5zdGFydHNXaXRoKCcuLi8nKSAmJiBwICE9ICcuLicpIHAgPSAnLi8nICsgcDsKICByZXR1cm4gcDsKfQoKY29uc3QgRmlsZUJhbm5lckNvbW1lbnQgPSAoZmlsZW5hbWUsIGkpID0+IHsKICBsZXQgcyA9ICcnOwogIHMgKz0gYCAke2kgPyAnZW5kJyA6ICdzdGFydCd9IG9mICckey8qcGF0aC5iYXNlbmFtZSovIGZpbGVuYW1lfScgYDsKICBsZXQgbiA9IE1hdGgubWF4KDAsIE1hdGguZmxvb3IoKDgwIC0gNiAtIHMubGVuZ3RoKSAvIDIpKTsKICBzID0gJy8qICcgKyAnLScucmVwZWF0KG4pICsgczsKICBzICs9ICctJy5yZXBlYXQoTWF0aC5tYXgoMCwgODAgLSAzIC0gcy5sZW5ndGgpKSArICcgKi8nOwogIGlmKGkgPT0gMCkgcyA9ICdcbicgKyBzICsgJ1xuJzsKICBlbHNlIHMgPSBzICsgJ1xuJzsKICByZXR1cm4gczsKfTsKCmV4dGVuZEFycmF5KEFycmF5LnByb3RvdHlwZSk7Cgpjb25zdCBJc0J1aWx0aW4gPSBtb2R1bGVOYW1lID0+IC9eW15cLy5dKyQvLnRlc3QobW9kdWxlTmFtZSk7CmNvbnN0IGNvbXBhY3QgPSAobiwgbW9yZSA9IHt9KSA9PgogIGNvbnNvbGUuY29uZmlnKHsKICAgIGNvbXBhY3Q6IG4sCiAgICBtYXhBcnJheUxlbmd0aDogMTAwLAogICAgLi4ubW9yZQogIH0pOwpjb25zdCBBZGRVbmlxdWUgPSAoYXJyLCBpdGVtKSA9PiAoYXJyLmluZGV4T2YoaXRlbSkgPT0gLTEgPyBhcnIucHVzaChpdGVtKSA6IG51bGwpOwpjb25zdCBJbnRUb0RXb3JkID0gaXZhbCA9PiAoaXNOYU4oaXZhbCkgPT09IGZhbHNlICYmIGl2YWwgPCAwID8gaXZhbCArIDQyOTQ5NjcyOTYgOiBpdmFsKTsKY29uc3QgSW50VG9CaW5hcnkgPSBpID0+IChpID09IC0xIHx8IHR5cGVvZiBpICE9ICdudW1iZXInID8gaSA6ICcwYicgKyBJbnRUb0RXb3JkKGkpLnRvU3RyaW5nKDIpKTsKCmNvbnN0IFdoYXQgPSB7CiAgSU1QT1JUOiBTeW1ib2wuZm9yKCdpbXBvcnQnKSwKICBFWFBPUlQ6IFN5bWJvbC5mb3IoJ2V4cG9ydCcpCn07Cgpjb25zdCBJbXBvcnRUeXBlcyA9IHsKICBJTVBPUlQ6IDAsCiAgSU1QT1JUX0RFRkFVTFQ6IDEsCiAgSU1QT1JUX05BTUVTUEFDRTogMgp9OwoKY29uc3QgSXNPbmVPZiA9IGN1cnJ5KChuLCB2YWx1ZSkgPT4gKEFycmF5LmlzQXJyYXkobikgPyBuLnNvbWUobnVtID0+IG51bSA9PT0gdmFsdWUpIDogbiA9PT0gdmFsdWUpKTsKY29uc3QgVG9rSXMgPSBjdXJyeSgodHlwZSwgbGV4ZW1lLCB0b2spID0+IHsKICBpZih0b2sgIT0gdW5kZWZpbmVkKSB7CiAgICBpZihsZXhlbWUgIT0gdW5kZWZpbmVkKSBpZiAodHlwZW9mIGxleGVtZSA9PSAnc3RyaW5nJyAmJiAhSXNPbmVPZihsZXhlbWUsIHRvay5sZXhlbWUpKSByZXR1cm4gZmFsc2U7CiAgICBpZih0eXBlICE9IHVuZGVmaW5lZCkgewogICAgICBpZih0eXBlb2YgdHlwZSA9PSAnc3RyaW5nJyAmJiAhSXNPbmVPZih0eXBlLCB0b2sudHlwZSkpIHJldHVybiBmYWxzZTsKICAgICAgaWYodHlwZW9mIHR5cGUgPT0gJ251bWJlcicgJiYgIUlzT25lT2YodHlwZSwgdG9rLmlkKSkgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHJldHVybiB0cnVlOwogIH0KfSk7CmNvbnN0IENvbXBhcmVSYW5nZSA9IChhLCBiKSA9PgogIGEgPT09IG51bGwgfHwgYiA9PT0gbnVsbAogICAgPyAwCiAgICA6IHR5cGVvZiBhWzBdID09ICdudW1iZXInICYmIHR5cGVvZiBiWzBdID09ICdudW1iZXInICYmIGFbMF0gIT0gYlswXQogICAgPyBhWzBdIC0gYlswXQogICAgOiBhWzFdIC0gYlsxXTsKCmNvbnN0IElzS2V5d29yZCA9IFRva0lzKCdrZXl3b3JkJyk7CmNvbnN0IElzUHVuY3R1YXRvciA9IFRva0lzKCdwdW5jdHVhdG9yJyk7CmNvbnN0IElzSWRlbnRpZmllciA9IFRva0lzKCdpZGVudGlmaWVyJyk7CmNvbnN0IElzU3RyaW5nTGl0ZXJhbCA9IFRva0lzKCdzdHJpbmdMaXRlcmFsJyk7CmNvbnN0IFB1dHNGdW5jdGlvbiA9IG91dEZuID0+IHN0ciA9PiB7CiAgbGV0IGIgPSB0eXBlcy5pc0FycmF5QnVmZmVyKHN0cikgPyBzdHIgOiB0b0FycmF5QnVmZmVyKHN0cik7CiAgcmV0dXJuIG91dEZuKGIsIGIuYnl0ZUxlbmd0aCk7Cn07Cgpjb25zdCBJc1doaXRlU3BhY2UgPSBzdHIgPT4gL15ccyokLy50ZXN0KHN0cikgfHwgc3RyLnRyaW0oKSA9PSAnJzsKCmNvbnN0IGRlYnVnTG9nID0gKHN0ciwgLi4uYXJncykgPT4gewogIGNvbnN0IHByZWQgPSBhcmcgPT4gaXNPYmplY3QoYXJnKSAmJiAnY29tcGFjdCcgaW4gYXJnOwogIGxldCBvcHRzID0gYXJncy5maWx0ZXIocHJlZCk7CgogIG9wdHMgPSBvcHRzLnJlZHVjZSgoYWNjLCBvcHQpID0+IGRlZmluZShhY2MsIG9wdCksIG9wdHMuc2hpZnQoKSA/PyB7fSk7CgogIGlmKG9wdHMuY29tcGFjdCA9PT0gdW5kZWZpbmVkKSBkZWZpbmUob3B0cywgY29tcGFjdCgxKSk7CiAgaWYob3B0cy5tYXhBcnJheUxlbmd0aCA9PT0gdW5kZWZpbmVkKSBkZWZpbmUob3B0cywgeyBtYXhBcnJheUxlbmd0aDogMTAgfSk7CiAgaWYob3B0cy5kZXB0aCA9PT0gdW5kZWZpbmVkKSBkZWZpbmUob3B0cywgeyBkZXB0aDogSW5maW5pdHkgfSk7CgogIGFyZ3MgPSBhcmdzLmZpbHRlcihhcmcgPT4gIXByZWQoYXJnKSk7CgogIG9wdHMuY29tcGFjdCA9IGZhbHNlOwoKICBjb25zb2xlLmxvZyhzdHIsIG9wdHMsIC4uLmFyZ3MpOwp9OwoKZnVuY3Rpb24gRmlsZVdyaXRlcihmaWxlKSB7CiAgbGV0IGZkID0gb3Mub3BlbihmaWxlLCBvcy5PX1dST05MWSB8IG9zLk9fQ1JFQVQgfCBvcy5PX1RSVU5DLCAwbzY0NCk7CiAgcmV0dXJuIGRlZmluZShGZFdyaXRlcihmZCwgZmlsZSksIHsKICAgIGNsb3NlOiAoKSA9PiBvcy5jbG9zZShmZCkKICB9KTsKfQoKZnVuY3Rpb24gRmlsZVJlcGxhY2VyKGZpbGUpIHsKICBsZXQgZmQgPSBvcy5vcGVuKGZpbGUgKyAnLm5ldycsIG9zLk9fV1JPTkxZIHwgb3MuT19DUkVBVCB8IG9zLk9fVFJVTkMsIDBvNjQ0KTsKICByZXR1cm4gZGVmaW5lKEZkV3JpdGVyKGZkLCBmaWxlKSwgewogICAgY2xvc2U6ICgpID0+IHsKICAgICAgLy9jb25zb2xlLmxvZygnRmlsZVJlcGxhY2VyLmNsb3NlJywgZmQpOwogICAgICBsZXQgc2l6ZSA9IGZzLnNpemVTeW5jKGZkKTsKICAgICAgb3MuY2xvc2UoZmQpOwogICAgICBsZXQgZXJyID0gb3MucmVuYW1lKGZpbGUsIGZpbGUgKyAnLm9sZCcpOwogICAgICBlcnIgPSBvcy5yZW5hbWUoZmlsZSArICcubmV3JywgZmlsZSk7CiAgICAgIC8vY29uc29sZS5sb2coJ29zLnJlbmFtZSgpID0nLCBlcnIpOwogICAgICBpZihlcnIpIHRocm93IG5ldyBFcnJvcihgRmlsZVJlcGxhY2VyIHJlbmFtZSgpIGVycm9yOiAke3N0ZC5zdHJlcnJvcigtZXJyKX1gKTsKICAgICAgY29uc29sZS5sb2coYCR7ZmlsZX0gd3JpdHRlbiAoJHtzaXplfSBieXRlcylgKTsKICAgIH0KICB9KTsKfQoKZnVuY3Rpb24gRmRXcml0ZXIoZmQsIGZpbGUpIHsKICBsZXQgZm47CiAgZm4gPSAoYnVmLCBsZW4pID0+IHsKICAgIGlmKCF0eXBlcy5pc0FycmF5QnVmZmVyKGJ1ZikpIGJ1ZiA9IHRvQXJyYXlCdWZmZXIoYnVmKTsKICAgIGxlbiA/Pz0gYnVmLmJ5dGVMZW5ndGg7CiAgICBsZXQgcmVzdWx0ID0gb3Mud3JpdGUoZmQsIGJ1ZiwgMCwgbGVuKTsKICAgIHJldHVybiByZXN1bHQ7CiAgfTsKCiAgZGVmaW5lKGZuLCB7CiAgICBmZCwKICAgIGZpbGUsCiAgICBwdXRzOiBQdXRzRnVuY3Rpb24oZm4pLAogICAgd3JpdGU6IGZuLAogICAgY2xvc2U6ICgpID0+IHt9LAogICAgc2VlazogKHdoZW5jZSwgb2Zmc2V0KSA9PiBvcy5zZWVrKGZkLCB3aGVuY2UsIG9mZnNldCksCiAgICBbU3ltYm9sLnRvU3RyaW5nVGFnXTogYEZpbGVXcml0ZXI8ICR7ZmR9ID5gLAogICAgaW5zcGVjdCgpIHsKICAgICAgcmV0dXJuIGluc3BlY3QoeyBmZCB9KSA/PyB0aGlzW1N5bWJvbC50b1N0cmluZ1RhZ107CiAgICB9CiAgfSk7CiAgcmV0dXJuIGZuOwp9CgpmdW5jdGlvbiBEdW1teVdyaXRlcihuYW1lKSB7CiAgbGV0IGZuID0gKGJ1ZiwgbGVuKSA9PiBsZW47CiAgZGVmaW5lKGZuLCB7CiAgICBuYW1lLAogICAgcHV0czogUHV0c0Z1bmN0aW9uKGZuKSwKICAgIHdyaXRlOiBmbiwKICAgIGNsb3NlOiAoKSA9PiB7fSwKICAgIHNlZWs6ICgpID0+IHt9LAogICAgW1N5bWJvbC50b1N0cmluZ1RhZ106IGBEdW1teVdyaXRlcjwgJHtuYW1lfSA+YCwKICAgIGluc3BlY3QoKSB7CiAgICAgIHJldHVybiBpbnNwZWN0KHsgZmQgfSkgPz8gdGhpc1tTeW1ib2wudG9TdHJpbmdUYWddOwogICAgfQogIH0pOwogIHJldHVybiBmbjsKfQoKZnVuY3Rpb24gSW1wb3J0SWRzKHNlcSkgewogIHJldHVybiBzZXEuZmlsdGVyKHRvayA9PiBJc0lkZW50aWZpZXIobnVsbCwgdG9rKSk7Cn0KCmZ1bmN0aW9uIEltcEV4cFR5cGUoc2VxKSB7CiAgaWYoc2VxLnNvbWUodG9rID0+IElzS2V5d29yZCgnaW1wb3J0JywgdG9rKSkpIHJldHVybiBXaGF0LklNUE9SVDsKICBpZihzZXEuc29tZSh0b2sgPT4gSXNLZXl3b3JkKCdleHBvcnQnLCB0b2spKSkgcmV0dXJuIFdoYXQuRVhQT1JUOwp9CgpmdW5jdGlvbiBJbXBvcnRUeXBlKHNlcSkgewogIGlmKElzS2V5d29yZChbJ2ltcG9ydCcsICdleHBvcnQnXSwgc2VxWzBdKSkgc2VxLnNoaWZ0KCk7CiAgaWYoSXNQdW5jdHVhdG9yKCcqJywgc2VxWzBdKSkgewogICAgaWYoSXNLZXl3b3JkKCdhcycsIHNlcVsxXSkpIHJldHVybiBJbXBvcnRUeXBlcy5JTVBPUlRfTkFNRVNQQUNFOwogIH0gZWxzZSBpZihJc0lkZW50aWZpZXIodW5kZWZpbmVkLCBzZXFbMF0pKSB7CiAgICBpZihJc0tleXdvcmQoJ2Zyb20nLCBzZXFbMV0pKSByZXR1cm4gSW1wb3J0VHlwZXMuSU1QT1JUX0RFRkFVTFQ7CiAgfQoKICByZXR1cm4gSW1wb3J0VHlwZXMuSU1QT1JUOwp9CgpmdW5jdGlvbiBJbXBvcnRGaWxlKHNlcSkgewogIHNlcSA9IE5vbldTKHNlcSk7CiAgbGV0IGlkeCA9IHNlcS5maW5kSW5kZXgodG9rID0+IElzS2V5d29yZCgnZnJvbScsIHRvaykpOwogIHdoaWxlKHNlcVtpZHhdICYmIHNlcVtpZHhdLnR5cGUgIT0gJ3N0cmluZ0xpdGVyYWwnKSArK2lkeDsKICBpZihzZXFbaWR4XSkKICAgIGlmKHNlcVtpZHhdLnR5cGUgPT0gJ3N0cmluZ0xpdGVyYWwnKSB7CiAgICAgIGxldCBmID0gc2VxW2lkeF0ubGV4ZW1lLnJlcGxhY2UoL15bXCdcIlxgXSguKilbXCdcIlxgXSQvZywgJyQxJyk7CiAgICAgIHJldHVybiBmOwogICAgfQp9CgpmdW5jdGlvbiBFeHBvcnROYW1lKHNlcSkgewogIGxldCBpZHggPSBzZXEuZmluZEluZGV4KHRvayA9PiBJc0lkZW50aWZpZXIodW5kZWZpbmVkLCB0b2spIHx8IElzS2V5d29yZCgnZGVmYXVsdCcsIHRvaykpOwoKICB3aGlsZShzZXFbaWR4XSAmJiBzZXFbaWR4XS50eXBlICE9ICdpZGVudGlmaWVyJykgaWR4Kys7CgogIHJldHVybiBzZXFbaWR4XT8ubGV4ZW1lOwp9CgpmdW5jdGlvbiBCeXRlU2VxdWVuY2UodG9rZW5zKSB7CiAgaWYodG9rZW5zLmxlbmd0aCkgewogICAgbGV0IHsgbG9jIH0gPSB0b2tlbnNbMF07CiAgICBsZXQgc3RhcnQgPSBsb2MuYnl0ZU9mZnNldDsKICAgIGxldCB0b3RhbCA9IHRva2Vucy5yZWR1Y2UoKG4sIHQpID0+IG4gKyB0LmJ5dGVMZW5ndGgsIDApOwogICAgbGV0IGVuZCA9IHN0YXJ0ICsgdG90YWw7CiAgICAvL2xldCBsaW5lID0gdG9TdHJpbmcoQnVmZmVyRmlsZShsb2MuZmlsZSkuc2xpY2Uoc3RhcnQsIGVuZCkpOwogICAgcmV0dXJuIFtzdGFydCwgZW5kXTsKICB9Cn0KCmZ1bmN0aW9uIE1vZHVsZUxvYWRlcihtb2R1bGUpIHsKICBsZXQgZmlsZTsKCiAgaWYocGF0aC5pc0RpcmVjdG9yeShtb2R1bGUpKSB7CiAgICBmaWxlID0gTW9kdWxlTG9hZGVyKHBhdGguam9pbihtb2R1bGUsICdpbmRleC5qcycpKTsKICB9IGVsc2UgaWYocGF0aC5pc0ZpbGUobW9kdWxlKSkgewogICAgZmlsZSA9IG1vZHVsZTsKICB9IGVsc2UgaWYoIS9cLmpzJC8udGVzdChtb2R1bGUpKSB7CiAgICBmaWxlID0gTW9kdWxlTG9hZGVyKG1vZHVsZSArICcuanMnKTsKICB9CgogIHJldHVybiBmaWxlOwp9CgpmdW5jdGlvbiBQcm9jZXNzRmlsZShzb3VyY2UsIGxvZyA9ICgpID0+IHt9LCByZWN1cnNpdmUsIGRlcHRoID0gMCkgewogIHNvdXJjZSA9IHBhdGgubm9ybWFsaXplKHNvdXJjZSk7CgogIGlmKHByaW50RmlsZXMpIHN0ZC5wdXRzKHNvdXJjZSArICdcbicpOwoKICBpZihyZWFkUGFja2FnZSkgc291cmNlID0gUmVzb2x2ZUFsaWFzKHNvdXJjZSk7CgogIGxvZyhgUHJvY2Vzc2luZyAke3NvdXJjZX1gKTsKCiAgbGV0IHN0YXJ0ID0gRGF0ZS5ub3coKTsKICBjb25zdCBkaXIgPSBwYXRoLmRpcm5hbWUoc291cmNlKTsKCiAgaWYoZGVidWcgPj0gMikgY29uc29sZS5sb2coJ1Byb2Nlc3NGaWxlJywgeyBzb3VyY2UgfSk7CgogIGxldCBieXRlYnVmID0gQnVmZmVyRmlsZShzb3VyY2UpOwoKICBsZXQgbGVuID0gYnl0ZWJ1Zi5ieXRlTGVuZ3RoLAogICAgdHlwZSA9IHBhdGguZXh0bmFtZShzb3VyY2UpLnN1YnN0cmluZygxKSwKICAgIGJhc2UgPSBjYW1lbGl6ZShwYXRoLmJhc2VuYW1lKHNvdXJjZSwgJy4nICsgdHlwZSkucmVwbGFjZSgvW14wLTlBLVphLXpfXS9nLCAnXycpKTsKCiAgbGV0IGxleCA9IHsKICAgIGpzOiBuZXcgRUNNQVNjcmlwdExleGVyKGJ5dGVidWYsIHNvdXJjZSkKICB9OwoKICBsZXgubWpzID0gbGV4LmpzOwogIGxleC5janMgPSBsZXguanM7CiAgbGV4Lmpzb24gPSBsZXguanM7CgogIGNvbnN0IGxleGVyID0gbGV4W3R5cGVdOwogIGlmKGRlYnVnID49IDEpIGNvbnNvbGUubG9nKCdsZXhlcicsIGxleGVyKTsKCiAgLy8gVCA9IGxleGVyLnRva2Vucy5yZWR1Y2UoKGFjYywgbmFtZSwgaWQpID0+ICh7IC4uLmFjYywgW25hbWVdOiBpZCB9KSwge30pOwoKICBsZXQgZSA9IG5ldyBTeW50YXhFcnJvcigpOwoKICBpZighbGV4ZXIpIHRocm93IG5ldyBFcnJvcihgRXJyb3IgbGV4aW5nOiAke3NvdXJjZX1gKTsKCiAgbGV4ZXIuaGFuZGxlciA9IGxleCA9PiB7CiAgICBjb25zdCB7IGxvYywgbW9kZSwgcG9zLCBzdGFydCwgYnl0ZUxlbmd0aCwgc3RhdGUgfSA9IGxleDsKICAgIGxvZygnICcucmVwZWF0KGxvYy5jb2x1bW4gLSAxKSArICdeJyk7CiAgfTsKCiAgbGV0IHRva2VuTGlzdCA9IFtdLAogICAgZGVjbGFyYXRpb25zID0gW107CiAgY29uc3QgY29sU2l6ZXMgPSBbMTIsIDgsIDQsIDIwLCAzMiwgMTAsIDBdOwoKICBsZXQgdG9rLAogICAgaSA9IDAsCiAgICBtYXNrID0gSW50VG9CaW5hcnkobGV4ZXIubWFzayksCiAgICBzdGF0ZSA9IGxleGVyLnRvcFN0YXRlKCk7CiAgbGV4ZXIuYmVnaW5Db2RlID0gKCkgPT4gKGNvZGUgPT0gJ2pzJyA/IDBiMTAwMCA6IDBiMDEwMCk7CiAgY29uc3QgYmFsYW5jZXIgPSAoKSA9PiB7CiAgICBsZXQgc2VsZjsKICAgIGxldCBzdGFjayA9IFtdOwogICAgY29uc3QgdGFibGUgPSB7ICd9JzogJ3snLCAnXSc6ICdbJywgJyknOiAnKCcgfTsKCiAgICBzZWxmID0gZnVuY3Rpb24gUGFyZW50aGVzZUJhbGFuY2VyKHRvaykgewogICAgICBzd2l0Y2ggKHRvaz8ubGV4ZW1lKSB7CiAgICAgICAgY2FzZSAneyc6CiAgICAgICAgY2FzZSAnWyc6CiAgICAgICAgY2FzZSAnKCc6IHsKICAgICAgICAgIHN0YWNrLnB1c2godG9rLmxleGVtZSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGNhc2UgJ30nOgogICAgICAgIGNhc2UgJ10nOgogICAgICAgIGNhc2UgJyknOiB7CiAgICAgICAgICBpZihzdGFjay5sYXN0ICE9IHRhYmxlW3Rvay5sZXhlbWVdKQogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYHRvcCAnJHtzdGFjay5sYXN0fScgIT0gJyR7dG9rLmxleGVtZX0nIFsgJHtzdGFjay5tYXAocyA9PiBgJyR7c30nYCkuam9pbignLCAnKX0gXWApOwoKICAgICAgICAgIHN0YWNrLnBvcCgpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIE9iamVjdC5hc3NpZ24oc2VsZiwgewogICAgICBzdGFjaywKICAgICAgcmVzZXQoKSB7CiAgICAgICAgc3RhY2suY2xlYXIoKTsKICAgICAgfSwKICAgICAgLyogcHJldHRpZXItaWdub3JlICovIGdldCBkZXB0aCgpIHsKICAgICAgICByZXR1cm4gc3RhY2subGVuZ3RoOwogICAgICB9CiAgICB9KTsKCiAgICByZXR1cm4gc2VsZjsKICB9OwoKICBsZXQgYmFsYW5jZXJzID0gW2JhbGFuY2VyKCldLAogICAgaW1wb3J0cyA9IFtdLAogICAgZXhwb3J0cyA9IFtdLAogICAgY29tbWVudHMgPSBbXSwKICAgIGltcGV4cCwKICAgIGNvbmQsCiAgICBpbXAgPSBbXSwKICAgIHNob3dUb2tlbiA9IHRvayA9PiB7CiAgICAgIGlmKAogICAgICAgIChsZXhlci5jb25zdHJ1Y3RvciAhPSBFQ01BU2NyaXB0TGV4ZXIgJiYgdG9rLnR5cGUgIT0gJ3doaXRlc3BhY2UnKSB8fAogICAgICAgIC9eKChpbXxleClwb3J0fGZyb218YXMpJC8udGVzdCh0b2subGV4ZW1lKQogICAgICApIHsKICAgICAgICBsZXQgYSA9IFsvKihmaWxlICsgJzonICsgdG9rLmxvYykucGFkRW5kKGZpbGUubGVuZ3RoKzEwKSwqLyB0b2sudHlwZS5wYWRFbmQoMjAsICcgJyksIGVzY2FwZSh0b2subGV4ZW1lKV07CiAgICAgICAgc3RkLnB1dHMoYS5qb2luKCcnKSArICdcbicpOwogICAgICB9CiAgICB9OwoKICBjb25zdCBQYXRoQWRqdXN0ID0gcyA9PiB7CiAgICBsZXQgaiA9IHBhdGguam9pbihkaXIsIHMpOwogICAgaiA9IHBhdGguY29sbGFwc2Uoaik7CiAgICBqID0gcGF0aC5ub3JtYWxpemUoaik7CiAgICBpZihwYXRoLmlzUmVsYXRpdmUoaikpIGogPSAnLi8nICsgajsKICAgIHJldHVybiBNb2R1bGVMb2FkZXIoaik7CiAgfTsKCiAgbGV0IHByZXZUb2tlbiwKICAgIGRvbmVJbXBvcnRzLAogICAgdXNlZCA9IGlkZW50aWZpZXJzVXNlZCA/IGlkZW50aWZpZXJzVXNlZChzb3VyY2UpIDogbnVsbDsKICBmb3IoOzspIHsKICAgIGxldCB7IHN0YXRlRGVwdGggfSA9IGxleGVyOwogICAgbGV0IHZhbHVlID0gbGV4ZXIubmV4dCgpOwogICAgbGV0IGRvbmUgPSB2YWx1ZSA9PT0gdW5kZWZpbmVkOwogICAgaWYoZG9uZSkgYnJlYWs7CiAgICBsZXQgbmV3U3RhdGUgPSBsZXhlci50b3BTdGF0ZSgpOwogICAgaWYobmV3U3RhdGUgIT0gc3RhdGUpIHsKICAgICAgaWYoc3RhdGUgPT0gJ1RFTVBMQVRFJyAmJiBsZXhlci5zdGF0ZURlcHRoID4gc3RhdGVEZXB0aCkgYmFsYW5jZXJzLnB1c2goYmFsYW5jZXIoKSk7CiAgICAgIGlmKG5ld1N0YXRlID09ICdURU1QTEFURScgJiYgbGV4ZXIuc3RhdGVEZXB0aCA8IHN0YXRlRGVwdGgpIGJhbGFuY2Vycy5wb3AoKTsKICAgIH0KCiAgICBsZXQgbiA9IGJhbGFuY2Vycy5sYXN0LmRlcHRoOwogICAgY29uc3QgeyB0b2tlbiB9ID0gbGV4ZXI7CiAgICBpZighdG9rZW4pIGJyZWFrOwogICAgY29uc3QgeyBsZW5ndGgsIHNlcSB9ID0gdG9rZW47CgogICAgaWYodG9rZW4udHlwZSA9PSAnaWRlbnRpZmllcicpIHsKICAgICAgaWYoZG9uZUltcG9ydHMpIHsKICAgICAgICBpZih1c2VkKSB7CiAgICAgICAgICBsZXQgeyBzaXplIH0gPSB1c2VkOwogICAgICAgICAgdXNlZC5hZGQodG9rZW4ubGV4ZW1lKTsKICAgICAgICAgIGlmKGRlYnVnID49IDIpIGNvbnNvbGUubG9nKGBhZGRlZFske3NpemV9XWAsIHNvdXJjZSwgdG9rZW4ubGV4ZW1lKTsKICAgICAgICB9CiAgICAgIH0gLyplbHNlIHsKICAgICAgICBpbXBvcnRlZC5hZGQodG9rZW4ubGV4ZW1lKTsKICAgICAgfSovCiAgICB9CgogICAgaWYoZGVidWcgPj0gMikgY29uc29sZS5sb2coJ3Rva2VuJywgdG9rZW4pOwogICAgLyogICBpZihkZWJ1ZyA+PSAxKSBjb25zb2xlLmxvZygnbGV4ZXIubW9kZScsIGxleGVyLm1vZGUpOwogICAgICovCiAgICBpZihuID09IDAgJiYgdG9rZW4ubGV4ZW1lID09ICd9JyAmJiBsZXhlci5zdGF0ZURlcHRoID4gMCkgewogICAgICBsZXhlci5wb3BTdGF0ZSgpOwogICAgfSBlbHNlIHsKICAgICAgYmFsYW5jZXIodG9rZW4pOwogICAgICBpZihuID4gMCAmJiBiYWxhbmNlcnMubGFzdC5kZXB0aCA9PSAwKSBsb2coJ2JhbGFuY2VyJyk7CiAgICAgIGlmKC9jb21tZW50L2kudGVzdCh0b2tlbi50eXBlKSkgewogICAgICAgIGNvbW1lbnRzLnB1c2godG9rZW4pOwogICAgICB9CgogICAgICBpZihbJ2ltcG9ydCcsICdleHBvcnQnXS5pbmRleE9mKHRva2VuLmxleGVtZSkgPj0gMCkgewogICAgICAgIGltcGV4cCA9IFdoYXRbdG9rZW4ubGV4ZW1lLnRvVXBwZXJDYXNlKCldOwogICAgICAgIGNvbmQgPSB0cnVlOwogICAgICAgIGltcCA9IHRva2VuLmxleGVtZSA9PSAnZXhwb3J0JyA/IFt0b2tlbl0gOiBbXTsKICAgICAgfQoKICAgICAgaWYoZGVidWcgPj0gMykKICAgICAgICBjb25zb2xlLmxvZyhgdG9rZW5bJHtpbXAubGVuZ3RofV1gLCB0b2tlbi5sb2MgKyAnJywgY29uc29sZS5jb25maWcoeyBicmVha0xlbmd0aDogODAsIGNvbXBhY3Q6IDAgfSksIHRva2VuKTsKCiAgICAgIGlmKHRva2VuLmxleGVtZSA9PSAnOycgJiYgY29uZCAhPT0gdHJ1ZSkgZG9uZUltcG9ydHMgPSB0cnVlOwoKICAgICAgaWYob25seUltcG9ydHMgJiYgZG9uZUltcG9ydHMpIGJyZWFrOwoKICAgICAgaWYoY29uZCA9PSB0cnVlKSB7CiAgICAgICAgaWYoaW1wLmluZGV4T2YodG9rZW4pID09IC0xKSBpbXAucHVzaCh0b2tlbik7CiAgICAgICAgLy9jb25zb2xlLmxvZyggaW1wWzBdLmxvYysnJyxjb25zb2xlLmNvbmZpZyh7YnJlYWtMZW5ndGg6ODAsIGNvbXBhY3Q6IDB9KSwgTm9uV1MoaW1wKSk7CiAgICAgICAgaWYoaW1wLmxhc3QubGV4ZW1lID09ICc7JykgewogICAgICAgICAgaWYoZGVidWcgPiAyKQogICAgICAgICAgICBjb25zb2xlLmxvZygKICAgICAgICAgICAgICAnaW1wJywKICAgICAgICAgICAgICBpbXBbMF0ubG9jICsgJycsCiAgICAgICAgICAgICAgY29uc29sZS5jb25maWcoewogICAgICAgICAgICAgICAgYnJlYWtMZW5ndGg6IDgwLAogICAgICAgICAgICAgICAgY29tcGFjdDogMAogICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgIFRva2VuU2VxdWVuY2UoaW1wKSArICcnCiAgICAgICAgICAgICk7CiAgICAgICAgICBjb25kID0gZmFsc2U7CiAgICAgICAgICBpZihpbXBleHAgPT0gV2hhdC5JTVBPUlQgfHwgaW1wLnNvbWUoaSA9PiBJc0tleXdvcmQoJ2Zyb20nLCBpKSkpIHsKICAgICAgICAgICAgaWYoaW1wWzFdLmxleGVtZSAhPSAnKCcpIHsKICAgICAgICAgICAgICBsZXQgb2JqID0gbmV3IEltcG9ydChpbXAsIFBhdGhBZGp1c3QsIGRlcHRoKTsKICAgICAgICAgICAgICBpZihvYmopIHsKICAgICAgICAgICAgICAgIG9iai5zb3VyY2UgPSBzb3VyY2U7CiAgICAgICAgICAgICAgICBpbXBvcnRzLnB1c2gob2JqKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGxldCBvYmogPSBuZXcgRXhwb3J0KGltcCwgUGF0aEFkanVzdCwgZGVwdGgpOwogICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdvYmonLGNvbnNvbGUuY29uZmlnKHticmVha0xlbmd0aDo4MCwgY29tcGFjdDogMX0pLCBvYmosIG9iai5sb2MrJycpOwogICAgICAgICAgICBpZihvYmopIHsKICAgICAgICAgICAgICBvYmouc291cmNlID0gc291cmNlOwoKICAgICAgICAgICAgICBleHBvcnRzLnB1c2gob2JqKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQoKICAgICAgcHJldlRva2VuID0gdG9rZW47CiAgICB9CgogICAgc3RhdGUgPSBuZXdTdGF0ZTsKICB9CgogIGZ1bmN0aW9uIEV4cG9ydCh0b2tlbnMsIHJlbGF0aXZlUGF0aCA9IHMgPT4gcykgewogICAgaWYodG9rZW5zWzBdLnNlcSA9PSB0b2tlbnNbMV0uc2VxKSB0b2tlbnMuc2hpZnQoKTsKICAgIGNvbnN0IHsgbG9jLCBzZXEgfSA9IHRva2Vuc1swXTsKICAgIGlmKCEvXihpbXxleClwb3J0JC9pLnRlc3QodG9rZW5zWzBdLmxleGVtZSkpCiAgICAgIHRocm93IG5ldyBFcnJvcihgQWRkRXhwb3J0IHRva2VuczogYCArIGluc3BlY3QodG9rZW5zLCB7IGNvbXBhY3Q6IGZhbHNlIH0pKTsKICAgIGxldCBkZWYgPSB0b2tlbnMuZmluZEluZGV4KHRvayA9PiBJc0tleXdvcmQoJ2RlZmF1bHQnLCB0b2spKTsKICAgIGxldCBrID0gMTsKICAgIHdoaWxlKHRva2Vuc1trXS50eXBlID09ICd3aGl0ZXNwYWNlJyB8fCBJc0tleXdvcmQoWydsZXQnLCAnY2xhc3MnLCAnZnVuY3Rpb24nLCAnY29uc3QnXSwgdG9rZW5zW2tdKSkgaysrOwogICAgd2hpbGUodG9rZW5zW2tdICYmIHRva2Vuc1trXS50eXBlICE9ICdpZGVudGlmaWVyJykgaysrOwogICAgbGV0IG5hbWUgPSBFeHBvcnROYW1lKHRva2Vucyk7CiAgICBsZXQgZXhwb3J0ZWQgPSBkZWYgIT0gLTEgPyAnZGVmYXVsdCcgOiBuYW1lOwogICAgbGV0IGZpbGUgPSBJbXBvcnRGaWxlKHRva2Vucyk7CiAgICBpZihmaWxlID09ICcgJykgdGhyb3cgbmV3IEVycm9yKCdYWFggJyArIGluc3BlY3QodG9rZW5zLCB7IGNvbXBhY3Q6IGZhbHNlIH0pKTsKICAgIGNvbnN0IGlkeCA9CiAgICAgIGRlZiAhPSAtMQogICAgICAgID8gZGVmCiAgICAgICAgOiBmaWxlCiAgICAgICAgPyB0b2tlbnMuZmluZEluZGV4KHRvayA9PiB0b2subGV4ZW1lID09ICc7JykKICAgICAgICA6IHRva2Vucy5zbGljZSgxKS5maW5kSW5kZXgodG9rID0+IHRvay50eXBlICE9ICd3aGl0ZXNwYWNlJyk7CiAgICBjb25zdCBvID0gTm9uV1ModG9rZW5zKVsxXS5sZXhlbWUgPT0gJ3snOwogICAgY29uc3QgcmVtb3ZlID0gbyB8fCBkZWYgIT0gLTEgPyB0b2tlbnMuc2xpY2UoKSA6IHRva2Vucy5zbGljZSgwLCBkZWYgPT0gaWR4ID8gaWR4ICsgMiA6IGlkeCArIDEpOwogICAgaWYocmVtb3ZlWzBdKQogICAgICBpZihyZW1vdmVbMF0ubGV4ZW1lICE9ICdleHBvcnQnKSB0aHJvdyBuZXcgRXJyb3IoYEFkZEV4cG9ydCB0b2tlbnM6IGAgKyBpbnNwZWN0KHRva2VucywgeyBjb21wYWN0OiBmYWxzZSB9KSk7CiAgICBjb25zdCByYW5nZSA9IEJ5dGVTZXF1ZW5jZShyZW1vdmUpID8/IEJ5dGVTZXF1ZW5jZSh0b2tlbnMpOwogICAgbGV0IHNvdXJjZSA9IGxvYy5maWxlOwogICAgbGV0IHR5cGUgPSBJbXBFeHBUeXBlKHRva2Vucyk7CiAgICBsZXQgY29kZSA9IFRva2VuU2VxdWVuY2UodG9rZW5zKS50b1N0cmluZygpOyAvLyB0b1N0cmluZyhCdWZmZXJGaWxlKHNvdXJjZSkuc2xpY2UoLi4ucmFuZ2UpKTsKICAgIGlmKGRlZiAhPSAtMSkKICAgICAgaWYoZGVidWcgPj0gMikKICAgICAgICBjb25zb2xlLmxvZygnQWRkRXhwb3J0JywgewogICAgICAgICAgc291cmNlLAogICAgICAgICAgZmlsZSwKICAgICAgICAgIGNvZGUsCiAgICAgICAgICByYW5nZSwKICAgICAgICAgIGxvYywKICAgICAgICAgIHRva2VucwogICAgICAgIH0pOwogICAgbGV0IGxlbiA9IHRva2Vucy5sZW5ndGg7CiAgICBpZihvKSB7CiAgICAgIGV4cG9ydGVkID0gdG9rZW5zLmZpbHRlcih0b2sgPT4gdG9rLnR5cGUgPT0gJ2lkZW50aWZpZXInKS5tYXAodG9rID0+IHRvay5sZXhlbWUpOwogICAgfQoKICAgIGlmKE5vbldTKHRva2VucylbMV0ubGV4ZW1lICE9ICd7JykKICAgICAgbGVuID0gdG9rZW5zLmZpbmRJbmRleCh0b2sgPT4gSXNJZGVudGlmaWVyKHVuZGVmaW5lZCwgdG9rKSB8fCBJc0tleXdvcmQoJ2RlZmF1bHQnLCB0b2spKSArIDE7CiAgICB0b2tlbnMgPSB0b2tlbnMuc2xpY2UoMCwgbGVuKTsKICAgIGxldCBleHAgPSBkZWZpbmUoCiAgICAgIHsKICAgICAgICB0eXBlOiBXaGF0LkVYUE9SVCwKICAgICAgICBmaWxlOiBmaWxlICYmIC9cLi8udGVzdChmaWxlKSA/IHJlbGF0aXZlUGF0aChmaWxlKSA6IGZpbGUsCiAgICAgICAgdG9rZW5zLAogICAgICAgIGV4cG9ydGVkLAogICAgICAgIG5hbWUsCiAgICAgICAgcmFuZ2UKICAgICAgfSwKICAgICAgewogICAgICAgIGNvZGUsCiAgICAgICAgbG9jLAogICAgICAgIGRlcHRoLAogICAgICAgIHBhdGgoKSB7CiAgICAgICAgICBjb25zdCB7IGZpbGUgfSA9IHRoaXM7CiAgICAgICAgICBpZih0eXBlb2YgZmlsZSA9PSAnc3RyaW5nJykgcmV0dXJuIHJlbGF0aXZlUGF0aChmaWxlKTsKICAgICAgICB9CiAgICAgIH0KICAgICk7CiAgICByZXR1cm4gT2JqZWN0LnNldFByb3RvdHlwZU9mKGV4cCwgRXhwb3J0LnByb3RvdHlwZSk7CiAgfQoKICBkZWZpbmUoRXhwb3J0LnByb3RvdHlwZSwgewogICAgaWRzKCkgewogICAgICByZXR1cm4gSW1wb3J0SWRzKHRoaXMudG9rZW5zKS5tYXAoKHsgbGV4ZW1lIH0pID0+IGxleGVtZSk7CiAgICB9CiAgfSk7CgogIGZ1bmN0aW9uIEltcG9ydCh0b2tlbnMsIHJlbGF0aXZlUGF0aCA9IHMgPT4gcywgZGVwdGgpIHsKICAgIHRva2VucyA9IHRva2Vuc1swXS5zZXEgPT09IHRva2Vuc1sxXS5zZXEgPyB0b2tlbnMuc2xpY2UoMSkgOiB0b2tlbnMuc2xpY2UoKTsKICAgIGlmKCEvXihpbXxleClwb3J0JC9pLnRlc3QodG9rZW5zWzBdLmxleGVtZSkpCiAgICAgIHRocm93IG5ldyBFcnJvcihgQWRkSW1wb3J0IHRva2VuczogYCArIGluc3BlY3QodG9rZW5zLCB7IGNvbXBhY3Q6IGZhbHNlIH0pKTsKICAgIGNvbnN0IHRvayA9IHRva2Vuc1swXTsKICAgIGNvbnN0IHsgbG9jLCBzZXEgfSA9IHRvazsKICAgIGxldCBzb3VyY2UgPSBsb2MuZmlsZTsKICAgIGxldCB0eXBlID0gSW1wRXhwVHlwZSh0b2tlbnMuc2xpY2UoKSksCiAgICAgIGZpbGUgPSBJbXBvcnRGaWxlKHRva2Vucy5zbGljZSgpKTsKICAgIGNvbnN0IHJhbmdlID0gQnl0ZVNlcXVlbmNlKHRva2Vucy5zbGljZSgpKTsKICAgIHJhbmdlWzBdID0gbG9jLmJ5dGVPZmZzZXQ7CiAgICBsZXQgY29kZSA9IHRvU3RyaW5nKEJ1ZmZlckZpbGUoc291cmNlKS5zbGljZSguLi5yYW5nZSkpOwogICAgaWYoZGVidWcgPj0gMikKICAgICAgY29uc29sZS5sb2coJ0FkZEltcG9ydCcsIGNvbXBhY3QoMSksIHsKICAgICAgICBzb3VyY2UsCiAgICAgICAgZmlsZSwKICAgICAgICBjb2RlLAogICAgICAgIGxvYywKICAgICAgICByYW5nZQogICAgICB9KTsKICAgIGxldCBpbXAgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YoCiAgICAgIGRlZmluZSgKICAgICAgICB7CiAgICAgICAgICB0eXBlLAogICAgICAgICAgZmlsZTogZmlsZSAmJiAvXC4vLnRlc3QoZmlsZSkgPyByZWxhdGl2ZVBhdGgoZmlsZSkgOiBmaWxlLAogICAgICAgICAgcmFuZ2UKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIHRva2VuczogdG9rZW5zLnNsaWNlKCksCiAgICAgICAgICBjb2RlLAogICAgICAgICAgbG9jLAogICAgICAgICAgZGVwdGgsCiAgICAgICAgICBwYXRoKCkgewogICAgICAgICAgICBjb25zdCB7IGZpbGUgfSA9IHRoaXM7CiAgICAgICAgICAgIGlmKHR5cGVvZiBmaWxlID09ICdzdHJpbmcnKSByZXR1cm4gcmVsYXRpdmVQYXRoKGZpbGUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgKSwKICAgICAgSW1wb3J0LnByb3RvdHlwZQogICAgKTsKICAgIGxldCBmbiA9IHsKICAgICAgW0ltcG9ydFR5cGVzLklNUE9SVF9OQU1FU1BBQ0VdKCkgewogICAgICAgIHJldHVybiB0aGlzLnRva2Vuc1t0aGlzLnRva2Vucy5maW5kSW5kZXgodG9rID0+IElzS2V5d29yZCgnYXMnLCB0b2spKSArIDFdLmxleGVtZTsKICAgICAgfSwKICAgICAgW0ltcG9ydFR5cGVzLklNUE9SVF9ERUZBVUxUXSgpIHsKICAgICAgICBjb25zdCB7IHRva2VucyB9ID0gdGhpczsKICAgICAgICByZXR1cm4gdG9rZW5zW3Rva2Vucy5maW5kSW5kZXgodG9rID0+IElzS2V5d29yZCgnaW1wb3J0JywgdG9rKSkgKyAxXS5sZXhlbWU7CiAgICAgIH0sCiAgICAgIFtJbXBvcnRUeXBlcy5JTVBPUlRdKCkgewogICAgICAgIGNvbnN0IHsgdG9rZW5zIH0gPSB0aGlzOwogICAgICAgIGxldCBpID0gMCwKICAgICAgICAgIHMgPSBbXSwKICAgICAgICAgIGEgPSBbXTsKICAgICAgICBpZihJc0tleXdvcmQoWydpbXBvcnQnLCAnZXhwb3J0J10sIHRva2Vuc1tpXSkpICsraTsKICAgICAgICBpZihJc1B1bmN0dWF0b3IoJ3snLCB0b2tlbnNbaV0pKSArK2k7CiAgICAgICAgZm9yKDsgdG9rZW5zW2ldICYmICFJc0tleXdvcmQoJ2Zyb20nLCB0b2tlbnNbaV0pOyArK2kpIHsKICAgICAgICAgIGlmKElzUHVuY3R1YXRvcihbJywnLCAnfSddLCB0b2tlbnNbaV0pKSB7CiAgICAgICAgICAgIGlmKHMubGVuZ3RoKSBhLnB1c2gocyk7CiAgICAgICAgICAgIHMgPSBbXTsKICAgICAgICAgIH0gZWxzZSBpZihJc0lkZW50aWZpZXIodG9rZW5zW2ldKSkgewogICAgICAgICAgICBzLnB1c2godG9rZW5zW2ldKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgYSA9IGEuZmxhdCgpLmZpbHRlcih0b2sgPT4gdG9rLnR5cGUgPT0gJ2lkZW50aWZpZXInKTsKICAgICAgICByZXR1cm4gYS5tYXAodG9rID0+IHRvay5sZXhlbWUpOwogICAgICB9CiAgICB9W3R5cGVdOwogICAgaWYodHlwZW9mIGZuID09ICdmdW5jdGlvbicpIHsKICAgICAgbGV0IGxvY2FsID0gZm4uY2FsbChpbXApOwogICAgICBkZWZpbmUoaW1wLCB7IGxvY2FsIH0pOwogICAgfQoKICAgIHJldHVybiBpbXA7CiAgfQoKICBkZWZpbmUoSW1wb3J0LnByb3RvdHlwZSwgewogICAgaWRzKCkgewogICAgICByZXR1cm4gSW1wb3J0SWRzKHRoaXMudG9rZW5zLnNsaWNlKCkpLm1hcCgoeyBsZXhlbWUgfSkgPT4gbGV4ZW1lKTsKICAgIH0sCiAgICB0b0NvZGUoZmlsdGVySWRzID0gaWQgPT4gdHJ1ZSkgewogICAgICBpZih0aGlzLmlkcygpLmZpbHRlcihmaWx0ZXJJZHMpLmxlbmd0aCA9PSAwKSByZXR1cm4gJyc7CiAgICAgIGxldCB0b2tlbnMgPSB0aGlzLnRva2Vucy5maWx0ZXIodG9rID0+ICh0b2sudHlwZSA9PSAnaWRlbnRpZmllcicgPyBmaWx0ZXJJZHModG9rLmxleGVtZSkgOiB0cnVlKSk7CiAgICAgIGxldCBwcmV2LCBwbndzOwogICAgICB0b2tlbnMgPSB0b2tlbnMucmVkdWNlKChhY2MsIHRvaywgaSkgPT4gewogICAgICAgIGlmKHByZXYgJiYgcHJldi50eXBlID09ICd3aGl0ZXNwYWNlJyAmJiB0b2sudHlwZSA9PSAnd2hpdGVzcGFjZScpIHJldHVybiBhY2M7CiAgICAgICAgaWYocG53cyAhPT0gdW5kZWZpbmVkICYmIFsnLCcsICd7J10uaW5kZXhPZihhY2NbcG53c10ubGV4ZW1lKSAhPSAtMSAmJiBbJywnLCAnfSddLmluZGV4T2YodG9rLmxleGVtZSkgIT0gLTEpIHsKICAgICAgICAgIGlmKHRvay5sZXhlbWUgPT0gJ30nKSBhY2Muc3BsaWNlKHBud3MsIDEpOwogICAgICAgICAgaWYodG9rLmxleGVtZSA9PSAnfScpIHsKICAgICAgICAgICAgcG53cyA9IGFjYy5sZW5ndGg7CiAgICAgICAgICAgIGFjYy5wdXNoKHRvayk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gYWNjOwogICAgICAgIH0KICAgICAgICBpZih0b2sudHlwZSAhPSAnd2hpdGVzcGFjZScpIHBud3MgPSBhY2MubGVuZ3RoOwogICAgICAgIHByZXYgPSB0b2s7CiAgICAgICAgYWNjLnB1c2godG9rKTsKICAgICAgICByZXR1cm4gYWNjOwogICAgICB9LCBbXSk7CiAgICAgIHRva2VucyA9IEFkZFdoaXRlc3BhY2UodG9rZW5zKTsKICAgICAgY29uc29sZS5sb2coJ3Rva2VucycsIHRva2Vucyk7CiAgICAgIHJldHVybiBUb2tlblNlcXVlbmNlKHRva2VucykudG9TdHJpbmcoKTsKICAgIH0KICB9KTsKCiAgbGV0IGVuZCA9IERhdGUubm93KCk7CgogIGlmKHNob3dUaW1pbmcpIGNvbnNvbGUubG9nKGBMZXhpbmcgJyR7c291cmNlLnJlcGxhY2UoL15cLlwvLywgJycpfScgdG9vayAke2VuZCAtIHN0YXJ0fW1zYCk7CiAgc3RhcnQgPSBEYXRlLm5vdygpOwoKICBsZXQgZXhwb3J0c0Zyb20gPSBleHBvcnRzLmZpbHRlcihleHAgPT4gZXhwLnRva2VucykuZmlsdGVyKGV4cCA9PiBleHAudG9rZW5zLnNvbWUodG9rID0+IHRvay5sZXhlbWUgPT0gJ2Zyb20nKSk7CgogIGlmKHBhdGguaXNSZWxhdGl2ZShzb3VyY2UpICYmICEvXihcLnxcLlwuKVwvLy50ZXN0KHNvdXJjZSkpIHNvdXJjZSA9ICcuLycgKyBzb3VyY2U7CgogIG1vZHVsZXNbc291cmNlXSA9IHsgaW1wb3J0cywgZXhwb3J0cyB9OwoKICBsZXQgYWxsRXhwb3J0c0ltcG9ydHMgPSBleHBvcnRzLmNvbmNhdChpbXBvcnRzKS5zb3J0KChhLCBiKSA9PiBhLnJhbmdlWzBdIC0gYi5yYW5nZVswXSk7CiAgbGV0IGZpbGVJbXBvcnRzID0gYWxsRXhwb3J0c0ltcG9ydHMuZmlsdGVyKGltcCA9PiB0eXBlb2YgaW1wLmZpbGUgPT0gJ3N0cmluZycpOwogIGxldCBzcGxpdFBvaW50cyA9IHVuaXF1ZShmaWxlSW1wb3J0cy5yZWR1Y2UoKGFjYywgaW1wKSA9PiBbLi4uYWNjLCAuLi5pbXAucmFuZ2VdLCBbXSkpOwogIGJ1ZmZlcnNbc291cmNlXSA9IFsuLi5zcGxpdChCdWZmZXJGaWxlKHNvdXJjZSksIC4uLnNwbGl0UG9pbnRzKV0ubWFwKGIgPT4gYiA/PyB0b1N0cmluZyhiLCAwLCBiLmJ5dGVMZW5ndGgpKTsKCiAgbGV0IG1hcCA9IEZpbGVNYXAuZm9yKHNvdXJjZSk7CiAgbGV0IGltcG9ydGVkID0gdXNlZCAmJiBuZXcgU2V0KCk7CgogIGlmKHVzZWQpIHsKICAgIGZvcihsZXQgaW1wZXhwIG9mIGFsbEV4cG9ydHNJbXBvcnRzKSB7CiAgICAgIGlmKGltcGV4cC50eXBlID09IFdoYXQuSU1QT1JUKSB7CiAgICAgICAgbGV0IGlkcyA9IGltcGV4cC5pZHMoKTsKICAgICAgICBmb3IobGV0IGlkIG9mIGlkcykgaW1wb3J0ZWQuYWRkKGlkKTsKICAgICAgfQogICAgfQoKICAgIGxldCBudW1SZXBsYWNlID0gMDsKICAgIGZvcihsZXQgaW1wZXhwIG9mIGFsbEV4cG9ydHNJbXBvcnRzKSB7CiAgICAgIGlmKGltcGV4cC50eXBlID09IFdoYXQuSU1QT1JUKSB7CiAgICAgICAgbGV0IGlkcyA9IGltcGV4cC5pZHMoKTsKICAgICAgICBpZihpZHMuc29tZShpZCA9PiAhdXNlZC5oYXMoaWQpKSkgewogICAgICAgICAgbGV0IHsgY29kZSwgcmFuZ2UgfSA9IGltcGV4cDsKICAgICAgICAgIGxldCBuZXdDb2RlID0gaW1wZXhwLnRvQ29kZShpZCA9PiB1c2VkLmhhcyhpZCkpOwogICAgICAgICAgaWYoY29kZSAhPSBuZXdDb2RlKSB7CiAgICAgICAgICAgIG1hcC5yZXBsYWNlUmFuZ2UocmFuZ2UsIHRvQXJyYXlCdWZmZXIobmV3Q29kZSkpOwogICAgICAgICAgICArK251bVJlcGxhY2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaWYoZGVidWcgPj0gMSkgY29uc29sZS5sb2coYGltcG9ydGVkIFsgJHtzb3VyY2V9IF1gLCBjb25zb2xlLmNvbmZpZyh7IGNvbXBhY3Q6IDEgfSksIFsuLi5pbXBvcnRlZF0pOwogICAgdXNlZCA9IGludGVyc2VjdGlvbih1c2VkLCBpbXBvcnRlZCk7CiAgICBpZihkZWJ1ZyA+PSAxKSBjb25zb2xlLmxvZyhgdXNlZCAgICAgWyAke3NvdXJjZX0gXWAsIGNvbnNvbGUuY29uZmlnKHsgY29tcGFjdDogMSB9KSwgWy4uLnVzZWRdKTsKCiAgICBsZXQgdW51c2VkID0gZGlmZmVyZW5jZShpbXBvcnRlZCwgdXNlZCk7CgogICAgaWYoZGVidWcgPj0gMSkgY29uc29sZS5sb2coYHVudXNlZCAgIFsgJHtzb3VyY2V9IF1gLCBjb25zb2xlLmNvbmZpZyh7IGNvbXBhY3Q6IDEgfSksIFsuLi51bnVzZWRdKTsKCiAgICBpZihudW1SZXBsYWNlKSB7CiAgICAgIGxldCBvdXQgPSBGaWxlUmVwbGFjZXIoc291cmNlKTsKICAgICAgbGV0IHJlc3VsdCA9IG1hcC53cml0ZShvdXQpOwogICAgICBvdXQuY2xvc2UoKTsKICAgIH0KICB9IGVsc2UgewogICAgZm9yKGxldCBpbXBleHAgb2YgYWxsRXhwb3J0c0ltcG9ydHMpIHsKICAgICAgY29uc3QgeyB0eXBlLCBmaWxlLCByYW5nZSwgY29kZSwgbG9jIH0gPSBpbXBleHA7CiAgICAgIGNvbnN0IFtzdGFydCwgZW5kXSA9IHJhbmdlOwogICAgICAvLyBsZXQgYnl0ZWJ1ZiA9IEJ1ZmZlckZpbGUoc291cmNlKTsKICAgICAgbGV0IGJ1ZnN0ciA9IHRvU3RyaW5nKGJ5dGVidWYuc2xpY2UoLi4ucmFuZ2UpKTsKICAgICAgbGV0IGFycmJ1ZiA9IHRvQXJyYXlCdWZmZXIoYnVmc3RyKTsKCiAgICAgIGxldCByZXBsYWNlbWVudCA9IHR5cGUgPT0gV2hhdC5FWFBPUlQgPyBudWxsIDogLypGaWxlTWFwLmZvciovIGZpbGU7CiAgICAgIGxldCB7IGJ5dGVPZmZzZXQgfSA9IGxvYzsKICAgICAgbGV0IHA7CgogICAgICBpZihkZWJ1ZyA+IDIpCiAgICAgICAgY29uc29sZS5sb2coJ2ltcGV4cCcsIGNvbXBhY3QoMiksIHsKICAgICAgICAgIGNvZGUsCiAgICAgICAgICByYW5nZTogbmV3IE51bWVyaWNSYW5nZSguLi5yYW5nZSksCiAgICAgICAgICByZXBsYWNlbWVudCwKICAgICAgICAgIGxvYzogbG9jICsgJycKICAgICAgICB9KTsKCiAgICAgIGlmKHR5cGVvZiBmaWxlID09ICdzdHJpbmcnICYmICFwYXRoLmlzRmlsZShmaWxlKSkgewogICAgICAgIGlmKGRlYnVnID4gMSkgY29uc29sZS5sb2coYFx4MWJbMTszMW1JbmV4aXN0ZW50XHgxYlswbSBmaWxlICcke2ZpbGV9J2ApOwogICAgICAgIGlmKHByaW50RmlsZXMpIHN0ZC5wdXRzKGZpbGUgKyAnXG4nKTsKCiAgICAgICAgcmVwbGFjZW1lbnQgPSBudWxsOwogICAgICB9IGVsc2UgaWYoZmlsZSAmJiBwYXRoLmlzRmlsZShmaWxlKSkgewogICAgICAgIHJlcGxhY2VtZW50ID0gZmlsZTsKICAgICAgfSBlbHNlIGlmKAogICAgICAgICh0eXBlb2YgcmVwbGFjZW1lbnQgPT0gJ3N0cmluZycgJiYgIXBhdGguaXNGaWxlKHJlcGxhY2VtZW50KSkgfHwKICAgICAgICB0eXBlID09IFdoYXQuSU1QT1JUIHx8CiAgICAgICAgdHlwZW9mIGZpbGUgPT0gJ3N0cmluZycKICAgICAgKSB7CiAgICAgICAgcmVwbGFjZW1lbnQgPSBudWxsOwogICAgICB9IGVsc2UgaWYoY29kZS5zdGFydHNXaXRoKCdleHBvcnQnKSkgewogICAgICAgIGlmKCFyZW1vdmVFeHBvcnRzKSBjb250aW51ZTsKICAgICAgICByZXBsYWNlbWVudCA9IGZpbGU7CiAgICAgIH0KCiAgICAgIGxldCBsaXN0ID0gdHlwZSA9PSBXaGF0LkVYUE9SVCA/IGZvb3RlciA6IGhlYWRlcjsKICAgICAgbGlzdC5wdXNoKGltcGV4cCk7CgogICAgICBpZihkZWJ1ZyA+PSAyKQogICAgICAgIGNvbnNvbGUubG9nKCdpbXBleHAnLCBjb21wYWN0KDIpLCB7CiAgICAgICAgICBjb2RlLAogICAgICAgICAgcmFuZ2U6IG5ldyBOdW1lcmljUmFuZ2UoLi4ucmFuZ2UpLAogICAgICAgICAgcmVwbGFjZW1lbnQsCiAgICAgICAgICBsb2M6IGxvYyArICcnCiAgICAgICAgfSk7CiAgICAgIGlmKGRlYnVnID4gMSkKICAgICAgICBjb25zb2xlLmxvZygnaW1wZXhwJywgY29tcGFjdCgxKSwgewogICAgICAgICAgcmFuZ2U6IG5ldyBOdW1lcmljUmFuZ2UoLi4ucmFuZ2UpLAogICAgICAgICAgbG9jOiBsb2MgKyAnJwogICAgICAgIH0pOwoKICAgICAgbWFwLnJlcGxhY2VSYW5nZShyYW5nZSwgcmVwbGFjZW1lbnQpOwogICAgfQogIH0KCiAgLy9lYnVnTG9nKCdjb21tZW50cycsIGNvbW1lbnRzLm1hcCgoe2J5dGVSYW5nZSwgbGV4ZW1lfSk9PltieXRlUmFuZ2UsbGV4ZW1lLHRvU3RyaW5nKGJ5dGVidWYuc2xpY2UoLi4uYnl0ZVJhbmdlKSldKSk7CgogIGlmKHJlbW92ZUNvbW1lbnRzICYmIGNvbW1lbnRzLmxlbmd0aCkgewogICAgaSA9IC0xOwogICAgZGVidWdMb2coYFJlbW92aW5nICR7Y29tbWVudHMubGVuZ3RofSBjb21tZW50cyBmcm9tICcke3NvdXJjZX0nYCk7CiAgICBmb3IobGV0IHsgYnl0ZVJhbmdlLCBsZXhlbWUgfSBvZiBjb21tZW50cykgewogICAgICBsZXQgc2wgPSBieXRlYnVmLnNsaWNlKC4uLmJ5dGVSYW5nZSk7CiAgICAgIGlmKGRlYnVnID4gMSkKICAgICAgICBkZWJ1Z0xvZyhgY29tbWVudFskeysraX1dYCwgY29tcGFjdCgyKSwgewogICAgICAgICAgYnl0ZVJhbmdlLAogICAgICAgICAgc3RyOiB0b1N0cmluZyhzbCkKICAgICAgICB9KTsKCiAgICAgIG1hcC5yZXBsYWNlUmFuZ2UoYnl0ZVJhbmdlLCBudWxsKTsKICAgIH0KICB9CgogIGVuZCA9IERhdGUubm93KCk7CgogIC8vIGNvbnNvbGUubG9nKGBTdWJzdGl0dXRpbmcgJyR7c291cmNlLnJlcGxhY2UoL15cLlwvLywgJycpfScgdG9vayAke2VuZCAtIHN0YXJ0fW1zYCk7CiAgcHJvY2Vzc2VkLmFkZChzb3VyY2UpOwoKICBpZihyZWN1cnNpdmUgPiAwKSB7CiAgICBmb3IobGV0IGltcCBvZiBmaWxlSW1wb3J0cykgewogICAgICBsZXQgeyBmaWxlLCByYW5nZSwgdG9rZW5zIH0gPSBpbXA7CiAgICAgIGlmKCEvXC4vLnRlc3QoZmlsZSkpIHsKICAgICAgICAvLyBjb25zb2xlLmxvZyhgQnVpbHRpbiBtb2R1bGUgJyR7ZmlsZX0nYCk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmKCFwYXRoLmlzRmlsZShmaWxlKSkgewogICAgICAgIGNvbnNvbGUubG9nKGBQYXRoIG11c3QgZXhpc3QgJyR7ZmlsZX0nYCk7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGlmKHByb2Nlc3NlZC5oYXMoZmlsZSkgfHwgZmlsZSA9PSBzb3VyY2UpIHsKICAgICAgICAvL2NvbnNvbGUubG9nKGBBbHJlYWR5IHByb2Nlc3NlZCAnJHtmaWxlfSdgKTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgZmlsZSA9IE1vZHVsZUxvYWRlcihOb3JtYWxpemVQYXRoKGZpbGUpKTsKCiAgICAgIHByb2Nlc3NlZC5hZGQoZmlsZSk7CgogICAgICBBZGREZXAoc291cmNlLCBmaWxlKTsKICAgICAgUHJvY2Vzc0ZpbGUoZmlsZSwgbG9nLCB0eXBlb2YgcmVjdXJzaXZlID09ICdudW1iZXInID8gcmVjdXJzaXZlIC0gMSA6IHJlY3Vyc2l2ZSwgZGVwdGggKyAxKTsKICAgIH0KICB9CgogIHN0ZC5nYygpOwoKICBpZihzaG93RGVwcykgewogICAgbGV0IGRlcHMgPSBbLi4uRGVwZW5kZW5jeVRyZWUoc291cmNlLCAnICcsIGZhbHNlLCAwLCAnICAgICcpXTsKICAgIGNvbnNvbGUubG9nKGBEZXBlbmRlbmNpZXMgb2YgJyR7c291cmNlfSc6XG4ke1NwcmVhZEFuZEpvaW4oZGVwcyl9YCk7CiAgICAvL2NvbnNvbGUubG9nKGBkZXBlbmRlbmN5TWFwYCxbLi4uZGVwZW5kZW5jeU1hcF0pOwogIH0KCiAgcmV0dXJuIG1hcDsKfQoKZnVuY3Rpb24gQWRkRGVwKHNvdXJjZSwgZmlsZSkgewogIHNvdXJjZSA9IE5vcm1hbGl6ZVBhdGgoc291cmNlKTsKCiAgaWYoZGVidWcgPiAyKSBjb25zb2xlLmxvZyhgQWRkIGRlcGVuZGVuY3kgJyR7ZmlsZX0nIHRvICcke3NvdXJjZX0nYCk7CiAgZGVwZW5kZW5jeVRyZWUoc291cmNlKS5wdXNoKGZpbGUpOwp9CgpmdW5jdGlvbiBJc1dTKHRvaykgewogIHJldHVybiB0b2sudHlwZSA9PSAnd2hpdGVzcGFjZSc7Cn0KCmZ1bmN0aW9uIE5vbldTKHRva2VucykgewogIHJldHVybiB0b2tlbnMuZmlsdGVyKHRvayA9PiAhSXNXUyh0b2spKTsKfQoKZnVuY3Rpb24gVG9rZW5TZXF1ZW5jZSh0b2tlbnMpIHsKICByZXR1cm4gZGVmaW5lKAogICAgdG9rZW5zLm1hcCh0b2sgPT4gdG9rLmxleGVtZSksCiAgICB7CiAgICAgIHRvU3RyaW5nKCkgewogICAgICAgIHJldHVybiB0aGlzLmpvaW4oJycpOwogICAgICB9CiAgICB9CiAgKTsKfQoKZnVuY3Rpb24gQWRkV2hpdGVzcGFjZSh0b2tlbnMpIHsKICByZXR1cm4gdG9rZW5zLnJlZHVjZSgoYWNjLCB0b2spID0+IHsKICAgIGlmKGFjYy5sZW5ndGgpIHsKICAgICAgaWYodG9rLmxleGVtZSAhPSAnLCcpCiAgICAgICAgaWYoIUlzV1MoYWNjW2FjYy5sZW5ndGggLSAxXSkgJiYgIUlzV1ModG9rKSkgYWNjLnB1c2goeyB0eXBlOiAnd2hpdGVzcGFjZScsIGxleGVtZTogJyAnIH0pOwogICAgfQoKICAgIGFjYy5wdXNoKHRvayk7CiAgICByZXR1cm4gYWNjOwogIH0sIFtdKTsKfQoKZnVuY3Rpb24gVW5xdW90ZShsZXhlbWUpIHsKICByZXR1cm4gbGV4ZW1lLnJlcGxhY2UoLyheW1wnXCJcYF18W1wnXCJcYF0kKS9nLCAnJyk7Cn0KCmZ1bmN0aW9uIExpdGVyYWxTZXF1ZW5jZSh0b2tlbnMpIHsKICByZXR1cm4gdG9rZW5zLnJlZHVjZSgoYWNjLCB0b2spID0+IGFjYyArIHRvay5sZXhlbWUsICcnKTsKfQoKZnVuY3Rpb24gVW50aWxFT0woaWR4LCB0b2tlbnMpIHsKICByZXR1cm4gVW50aWwoaWR4LCB0b2tlbnMsIFRva0lzKG51bGwsICc7JykpOwp9CgpmdW5jdGlvbiBVbnRpbChpZHgsIHRva2VucywgcHJlZCA9IFRva0lzKG51bGwsIFsnOycsICdcbiddKSkgewogIGxldCBpOwogIGZvcihpID0gaWR4OyB0b2tlbnNbaV07IGkrKykgewogICAgaWYocHJlZCh0b2tlbnNbaV0pKSBicmVhazsKICB9CgogIHJldHVybiB0b2tlbnMuc2xpY2UoaWR4LCBpKTsKfQoKZnVuY3Rpb24gV2hvbGVMaW5lKGlkeCwgdG9rZW5zKSB7CiAgbGV0IGksIGo7CiAgZm9yKGkgPSBpZHg7IHRva2Vuc1tpXTsgaSsrKSB7CiAgICBpZihbJzsnLCAnXG4nXS5pbmRleE9mKHRva2Vuc1tpXS5sZXhlbWUpICE9IC0xKSBicmVhazsKICB9CgogIGZvcihqID0gaWR4OyBqID4gMDsgai0tKSB7CiAgICBjb25zdCB0b2sgPSB0b2tlbnNbaiAtIDFdOwogICAgaWYoIXRvayB8fCBbJzsnLCAnXG4nXS5pbmRleE9mKHRva2Vuc1tqIC0gMV0ubGV4ZW1lKSAhPSAtMSkgYnJlYWs7CiAgfQoKICByZXR1cm4gdG9rZW5zLnNsaWNlKGosIGkpOwp9CgpmdW5jdGlvbiBSYW5nZShmaWxlLCBzdGFydCwgZW5kKSB7CiAgbGV0IGJ1ZjsKICBpZigoYnVmID0gQnVmZmVyRmlsZShmaWxlKSkpIHsKICAgIHRoaXMuZmlsZSA9IGZpbGU7CiAgICB0aGlzLnN0YXJ0ID0gc3RhcnQgPz8gMDsKICAgIHRoaXMuZW5kID0gZW5kID8/IGJ1Zi5ieXRlTGVuZ3RoOwogICAgcmV0dXJuIHRoaXM7CiAgfQoKICByZXR1cm4gbnVsbDsKfQoKUmFuZ2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24oKSB7CiAgbGV0IGJ1ZiA9IEJ1ZmZlckZpbGUodGhpcy5maWxlKTsKICByZXR1cm4gYnVmLnNsaWNlKHRoaXMuc3RhcnQsIHRoaXMuZW5kKTsKfTsKCmZ1bmN0aW9uIEluUmFuZ2UoW3N0YXJ0LCBlbmRdLCBpKSB7CiAgaWYoaSA+PSBzdGFydCAmJiBpIDwgZW5kKSByZXR1cm4gdHJ1ZTsKICByZXR1cm4gZmFsc2U7Cn0KCmZ1bmN0aW9uIElzUmFuZ2Uob2JqKSB7CiAgcmV0dXJuIGlzT2JqZWN0KG9iaikgJiYgKCdsZW5ndGgnIGluIG9iaiB8fCAnc3RhcnQnIGluIG9iaiB8fCBvYmogaW5zdGFuY2VvZiBOdW1lcmljUmFuZ2UpOwp9CgpjbGFzcyBOdW1lcmljUmFuZ2UgZXh0ZW5kcyBBcnJheSB7CiAgY29uc3RydWN0b3Ioc3RhcnQsIGVuZCkgewogICAgc3VwZXIoMik7CiAgICBpZihpc05hTigrc3RhcnQpKSBzdGFydCA9IDA7CiAgICB0aGlzWzBdID0gK3N0YXJ0OwogICAgaWYoaXNOYU4oK2VuZCkpIGVuZCA9IHRoaXNbMF07CiAgICB0aGlzWzFdID0gZW5kOwogIH0KCiAgZ2V0IHN0YXJ0KCkgewogICAgcmV0dXJuIHRoaXNbMF07CiAgfQoKICBzZXQgc3RhcnQodmFsdWUpIHsKICAgIHRoaXNbMF0gPSArdmFsdWU7CiAgfQoKICBnZXQgZW5kKCkgewogICAgcmV0dXJuIHRoaXNbMV07CiAgfQoKICBzZXQgZW5kKHZhbHVlKSB7CiAgICB0aGlzWzFdID0gK3ZhbHVlOwogIH0KCiAgc3RhdGljIGZyb20ocmFuZ2UpIHsKICAgIGlmKGlzT2JqZWN0KHJhbmdlKSAmJiByYW5nZSBpbnN0YW5jZW9mIE51bWVyaWNSYW5nZSkgcmV0dXJuIHJhbmdlOwoKICAgIHRyeSB7CiAgICAgIGxldCByID0gbmV3IE51bWVyaWNSYW5nZSguLi5yYW5nZSk7CiAgICAgIHJhbmdlID0gcjsKICAgIH0gY2F0Y2goZSkge30KCiAgICBjb25zb2xlLmxvZygnTnVtZXJpY1JhbmdlLmZyb20nLCByYW5nZSk7CiAgICByZXR1cm4gcmFuZ2U7CiAgfQoKICBzdGF0aWMgKmhvbGVzKHJhbmdlcywgb25seSA9IGZhbHNlKSB7CiAgICBsZXQgcHJldiA9IFswLCAwXTsKICAgIGxldCBpID0gLTE7CiAgICBmb3IobGV0IHJhbmdlIG9mIHJhbmdlcykgewogICAgICBpZihJc1JhbmdlKHJhbmdlKSkgewogICAgICAgIHJhbmdlID0gWy4uLnJhbmdlXTsKICAgICAgICBjb25zb2xlLmxvZygncmFuZ2UjJyArICsraSwgaW5zcGVjdChyYW5nZSkpOwogICAgICAgIGlmKElzUmFuZ2UocHJldikgJiYgSXNSYW5nZShyYW5nZSkpIHsKICAgICAgICAgIGxldCBbc3RhcnQsIGVuZF0gPSByYW5nZTsKICAgICAgICAgIGlmKHN0YXJ0ID49IHByZXZbMV0pIHlpZWxkIG5ldyBOdW1lcmljUmFuZ2UocHJldlsxXSwgc3RhcnQpOwogICAgICAgIH0KICAgICAgICBpZighb25seSkgewogICAgICAgICAgaWYoIShpc09iZWN0KHJhbmdlKSAmJiByYW5nZSBpbnN0YW5jZW9mIE51bWVyaWNSYW5nZSkpIHJhbmdlID0gbmV3IE51bWVyaWNSYW5nZSguLi5yYW5nZSk7CiAgICAgICAgICB5aWVsZCByYW5nZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcHJldiA9IHJhbmdlOwogICAgfQogIH0KCiAgc3RhdGljIGJldHdlZW4oW3MxLCBlMV0sIFtzMiwgZTJdKSB7CiAgICBpZihzMiA+IGUxKSByZXR1cm4gW2UxLCBzMl07CiAgICBpZihzMSA+IGUyKSByZXR1cm4gW2UyLCBzMV07CiAgfQp9CgpkZWZpbmUoTnVtZXJpY1JhbmdlLnByb3RvdHlwZSwgewogIFtTeW1ib2wudG9TdHJpbmdUYWddOiAnTnVtZXJpY1JhbmdlJywKICBbaW5zcGVjdFN5bWJvbF0oZGVwdGgsIG9wdHMpIHsKICAgIGNvbnN0IFtzdGFydCwgZW5kXSA9IHRoaXM7CiAgICBsZXQgcyA9ICcnOwogICAgY29uc3QgcGFkID0gcyA9PiAocyArICcnKS5wYWRFbmQoNSk7CiAgICBzICs9IGBceDFiWzE7MzZtJHtwYWQoc3RhcnQpfVx4MWJbMG1gOwogICAgcyArPSBgIC0gYDsKICAgIHMgKz0gYFx4MWJbMTszNm0ke3BhZCgnKycgKyAoZW5kIC0gc3RhcnQpKX1ceDFiWzBtYDsKICAgIHMgPSBgWyAke3N9IF1gOwogICAgcmV0dXJuIHM7CiAgfQp9KTsKCmNsYXNzIEZpbGVNYXAgZXh0ZW5kcyBBcnJheSB7CiAgY29uc3RydWN0b3IoZmlsZSwgYnVmKSB7CiAgICBzdXBlcigpOwogICAgaWYodHlwZW9mIGZpbGUgIT0gJ251bWJlcicpIHsKICAgICAgdGhpcy5maWxlID0gZmlsZTsKICAgICAgYnVmID8/PSBCdWZmZXJGaWxlKGZpbGUpOwogICAgICBpZighYnVmKSB0aHJvdyBuZXcgRXJyb3IoYEZpbGVNYXAgYnVmID09ICR7YnVmfWApOwogICAgICB0aGlzLnB1c2goW1swLCBidWYuYnl0ZUxlbmd0aF0sIGJ1Zl0pOwogICAgICBmaWxlTWFwcy5zZXQoZmlsZSwgdGhpcyk7CiAgICB9CiAgfQoKICBzdGF0aWMgZW1wdHkoZmlsZSkgewogICAgaWYodHlwZW9mIGZpbGUgPT0gJ3N0cmluZycpIGZpbGUgPSBGaWxlTWFwLmZvcihmaWxlKTsKICAgIGlmKGlzT2JqZWN0KGZpbGUpICYmIGZpbGUgaW5zdGFuY2VvZiBGaWxlTWFwKSByZXR1cm4gZmlsZS5pc0VtcHR5KCk7CiAgfQoKICBpc0VtcHR5KCkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgc3RhdGljIGZvcihmaWxlLCBidWYpIHsKICAgIGxldCBtOwogICAgaWYoZmlsZSAmJiAobSA9IGZpbGVNYXBzLmdldChmaWxlKSkpIHJldHVybiBtOwogICAgaWYoaXNPYmplY3QoZmlsZSkgJiYgZmlsZSBpbnN0YW5jZW9mIEZpbGVNYXApIHJldHVybiBmaWxlOwogICAgZWxzZSBpZihmaWxlID09PSBudWxsICYmICFidWYpIHsKICAgICAgbGV0IG9iaiA9IHsKICAgICAgICBpc0VtcHR5KCkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfSwKICAgICAgICB0b1N0cmluZygpIHsKICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICB9LAogICAgICAgIFtTeW1ib2wudG9TdHJpbmdUYWddOiAnRmlsZU1hcChlbXB0eSknCiAgICAgIH07CiAgICAgIHJldHVybiBPYmplY3Quc2V0UHJvdG90eXBlT2Yob2JqLCBGaWxlTWFwLnByb3RvdHlwZSk7CiAgICB9CiAgICBpZihmaWxlTWFwcy5oYXMoZmlsZSkpIHJldHVybiBmaWxlTWFwcy5nZXQoZmlsZSk7CiAgICByZXR1cm4gbmV3IEZpbGVNYXAoZmlsZSwgYnVmKTsKICB9CgogIHNwbGl0QXQocG9zKSB7CiAgICBsZXQgaSA9IHRoaXMuZmluZEluZGV4KChbcmFuZ2UsIGJ1Zl0pID0+IHJhbmdlICYmIEluUmFuZ2UocmFuZ2UsIHBvcykpOwogICAgaWYoaSAhPSAtMSkgewogICAgICBsZXQgW3JhbmdlLCBidWZdID0gdGhpc1tpXTsKICAgICAgbGV0IFtzdGFydCwgZW5kXSA9IHJhbmdlOwogICAgICB0aGlzLnNwbGljZShpICsgMSwgMCwgW1socmFuZ2VbMV0gPSBwb3MpLCBlbmRdLCBidWZdKTsKICAgICAgcmV0dXJuIGkgKyAxOwogICAgfQogIH0KCiAgc2xpY2VBdChuKSB7CiAgICByZXR1cm4gQXJyYXkucHJvdG90eXBlLmZpbmRJbmRleC5jYWxsKHRoaXMsIChbcmFuZ2UsIGJ1Zl0pID0+IChyYW5nZSA/IEluUmFuZ2UocmFuZ2UsIG4pIDogZmFsc2UpKTsKICB9CgogIHJlcGxhY2VSYW5nZShyYW5nZSwgZmlsZSkgewogICAgaWYoQXJyYXkuaXNBcnJheShyYW5nZSkgJiYgIShyYW5nZSBpbnN0YW5jZW9mIE51bWVyaWNSYW5nZSkpIHJhbmdlID0gbmV3IE51bWVyaWNSYW5nZSguLi5yYW5nZSk7CiAgICBjb25zdCBzbGljZUluZGV4ID0gbiA9PiB7CiAgICAgIGxldCByOwogICAgICBpZih0aGlzWzBdICYmIHRoaXNbMF1bMF0gIT0gbnVsbCkgewogICAgICAgIGNvbnN0IHJhbmdlID0gbmV3IE51bWVyaWNSYW5nZSguLi50aGlzWzBdWzBdKTsKICAgICAgICBpZihuIDwgcmFuZ2Uuc3RhcnQpIHJldHVybiAwOwogICAgICB9CiAgICAgIGxldCBpOwogICAgICBjb25zdCB7IGxlbmd0aCB9ID0gdGhpczsKICAgICAgZm9yKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICBjb25zdCBbaXRlbV0gPSB0aGlzW2ldOwogICAgICAgIGlmKGl0ZW0pIHsKICAgICAgICAgIGNvbnN0IFtzLCBlXSA9IGl0ZW07CiAgICAgICAgICBpZihuIDwgZSkgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBpOwogICAgfTsKICAgIGlmKGRlYnVnID4gMikKICAgICAgY29uc29sZS5sb2coJ0ZpbGVNYXAucmVwbGFjZVJhbmdlJywgY29tcGFjdCgyLCB7IGN1c3RvbUluc3BlY3Q6IHRydWUgfSksIHsKICAgICAgICBmaWxlLAogICAgICAgIHJhbmdlOiBbcmFuZ2VbMF0sIHJhbmdlWzFdXQogICAgICB9KTsKICAgIGxldCBzdGFydCA9IHNsaWNlSW5kZXgocmFuZ2VbMF0pOwogICAgbGV0IGVuZCA9IHNsaWNlSW5kZXgocmFuZ2VbMV0pOwogICAgY29uc3QgeyBsZW5ndGggfSA9IHRoaXM7CiAgICBpZihkZWJ1ZyA+IDIpCiAgICAgIGNvbnNvbGUubG9nKCdGaWxlTWFwLnJlcGxhY2VSYW5nZScsIGNvbXBhY3QoMiwgeyBjdXN0b21JbnNwZWN0OiB0cnVlIH0pLCB7CiAgICAgICAgc3RhcnQsCiAgICAgICAgZW5kLAogICAgICAgIGxlbmd0aCwKICAgICAgICB0aGlzOiB0aGlzCiAgICAgIH0pOwogICAgaWYocmFuZ2VbMF0gPCB0aGlzW3N0YXJ0XVswXSkgcmFuZ2VbMF0gPSB0aGlzW3N0YXJ0XVswXTsKICAgIGlmKCF0aGlzW3N0YXJ0XVswXSkKICAgICAgdGhyb3cgbmV3IEVycm9yKAogICAgICAgIGByYW5nZT0ke3JhbmdlfVxubGVuZ3RoPSR7dGhpcy5sZW5ndGh9XG5zdGFydD0ke3N0YXJ0fVxuZW5kPSR7ZW5kfVxudGhpc1ske3N0YXJ0fV09JHtpbnNwZWN0KAogICAgICAgICAgdGhpc1tzdGFydF0KICAgICAgICApfVxudGhpc1ske3N0YXJ0IC0gMX1dPSR7aW5zcGVjdCh0aGlzW3N0YXJ0IC0gMV0pfVxudGhpc1ske3N0YXJ0ICsgMX1dPSR7aW5zcGVjdCh0aGlzW3N0YXJ0ICsgMV0pfWAKICAgICAgKTsKICAgIGlmKHJhbmdlWzBdID4gdGhpc1tzdGFydF1bMF1bMF0pIHsKICAgICAgaWYoc3RhcnQgPT0gZW5kKSB7CiAgICAgICAgbGV0IFtyYW5nZSwgYnVmXSA9IHRoaXNbc3RhcnRdOwogICAgICAgIGxldCBpbnNlcnQgPSBbbmV3IE51bWVyaWNSYW5nZSguLi5yYW5nZSksIGJ1Zl07CiAgICAgICAgdGhpcy5zcGxpY2UoKytlbmQsIDAsIGluc2VydCk7CiAgICAgIH0KCiAgICAgIHRoaXNbc3RhcnRdWzBdWzFdID0gcmFuZ2VbMF07CiAgICAgIGlmKHRoaXNbZW5kXSAmJiB0aGlzW2VuZF1bMF0pIHRoaXNbZW5kXVswXVswXSA9IHJhbmdlWzFdOwogICAgfSBlbHNlIHsKICAgICAgdGhpc1tzdGFydF1bMF1bMF0gPSByYW5nZVsxXTsKICAgICAgdGhpcy5zcGxpY2Uoc3RhcnQsIDAsIFtudWxsLCBmaWxlXSk7CiAgICAgIGZpbGUgPSBudWxsOwogICAgfQoKICAgIGlmKGZpbGUgIT0gbnVsbCkgdGhpcy5zcGxpY2Uoc3RhcnQgKyAxLCAwLCBbbnVsbCwgZmlsZV0pOwogIH0KCiAgZHVtcCgpIHsKICAgIGNvbnN0IHNvdXJjZSA9IHRoaXMuZmlsZTsKICAgIHJldHVybiAoCiAgICAgIGBGaWxlTWFwIHtcblx0ZmlsZTogXHgxYlszODs1OzIxNW0ke3NvdXJjZX0sXG5cdFx4MWJbMG1bIGAgKwogICAgICBbLi4udGhpc10KICAgICAgICAubWFwKChpdGVtLCBpKSA9PiBpdGVtLmNvbmNhdChbdGhpcy5hdChpKV0pKQogICAgICAgIC5yZWR1Y2UoKGFjYywgW3JhbmdlLCBidWYsIHN0cl0sIGkpID0+IHsKICAgICAgICAgIGxldCBzID0gYWNjICsgYFxuXHRcdFsgYDsKICAgICAgICAgIHMgKz0gKCcnICsgKHJhbmdlID8gJ1snICsgTnVtZXJpY1JhbmdlLmZyb20ocmFuZ2UpICsgJ10nIDogcmFuZ2UpKS5wYWRFbmQoMTApOwogICAgICAgICAgcyArPSAnLCAnOwogICAgICAgICAgaWYoaXNPYmplY3QoYnVmKSAmJiAnYnl0ZUxlbmd0aCcgaW4gYnVmKSB7CiAgICAgICAgICAgIGxldCBmaWxlbmFtZSA9IGJ1ZmZlclJlZi5nZXQoYnVmKTsKICAgICAgICAgICAgYnVmID0gZmlsZW5hbWUgPz8gYDx0aGlzPmA7CiAgICAgICAgICB9CgogICAgICAgICAgaWYodHlwZW9mIGJ1ZiA9PSAnc3RyaW5nJykgYnVmID0gcGF0aC5ub3JtYWxpemUoYnVmKTsKICAgICAgICAgIHMgKz0gaW5zcGVjdChidWYsIHsgbWF4QXJyYXlMZW5ndGg6IDMwIH0pOwogICAgICAgICAgcyArPSBgIF0sYDsKICAgICAgICAgIHJldHVybiBzOwogICAgICAgIH0sICcnKSArCiAgICAgIGBcblx0XVxufWAKICAgICk7CiAgfQoKICBhdChpKSB7CiAgICBpZighdGhpc1tpXSkgcmV0dXJuIG51bGw7CiAgICBjb25zdCBbcmFuZ2UsIGJ1Zl0gPSB0aGlzW2ldOwogICAgaWYocmFuZ2UgJiYgaXNPYmplY3QoYnVmKSkgewogICAgICBjb25zdCBbc3RhcnQsIGVuZF0gPSByYW5nZTsKICAgICAgcmV0dXJuIGJ1Zi5zbGljZShzdGFydCwgZW5kKTsKICAgIH0KICAgIGlmKHJhbmdlID09IG51bGwpIHsKICAgICAgbGV0IGZpbGUgPSBidWY7CiAgICAgIGxldCBzdHIgPSBidWY7CiAgICAgIGlmKHR5cGVvZiBzdHIgPT0gJ3N0cmluZycpIHsKICAgICAgICBpZighcGF0aC5pc0ZpbGUoc3RyKSkgdGhyb3cgRXJyb3IoYEZpbGVNYXBceDFiWzE7MzVtPCR7dGhpcy5maWxlfT5ceDFiWzBtIEluZXhpc3RlbnQgZmlsZSAnJHtzdHJ9J2ApOwogICAgICAgIHN0ciA9IEZpbGVNYXAuZm9yKHN0cik7CiAgICAgIH0KICAgICAgcmV0dXJuIHN0cjsKICAgIH0KICAgIGlmKGJ1ZiA9PT0gLTEpIHJldHVybiBudWxsOwogICAgdGhyb3cgbmV3IEVycm9yKGBhdCgke2l9KSBgICsgaW5zcGVjdCh7IHJhbmdlLCBidWYgfSkpOwogIH0KCiAgdG9BcnJheSgpIHsKICAgIHJldHVybiB0aGlzLm1hcCgocywgaSkgPT4gdGhpcy5hdChpKSk7CiAgfQoKICBob2xlcygpIHsKICAgIGxldCByYW5nZXMgPSBbLi4udGhpcy5tYXAoKFtyYW5nZV0pID0+IHJhbmdlKV0uc29ydChDb21wYXJlUmFuZ2UpOwogICAgbGV0IGl0ZXIgPSBOdW1lcmljUmFuZ2UuaG9sZXMocmFuZ2VzLCB0cnVlKTsKICAgIGxldCBob2xlcyA9IFsuLi5pdGVyXTsKICAgIGxldCBsZW4gPSBob2xlcy5sZW5ndGg7CiAgICBmb3IobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgICAgY29uc3QgaG9sZSA9IGhvbGVzW2ldOwogICAgICBjb25zdCBbcmFuZ2VdID0gdGhpc1tpXTsKICAgICAgY29uc29sZS5sb2coJyMnICsgKGkgKyAxKSwgY29tcGFjdCgyKSwgaW5zcGVjdCh7IGhvbGUsIHJhbmdlIH0sIHsgY29tcGFjdDogMiwgZGVwdGg6IEluZmluaXR5IH0pKTsKICAgIH0KICAgIHJldHVybiBob2xlczsKICB9CgogIGZpcnN0Q2h1bmsoKSB7CiAgICByZXR1cm4gdGhpcy5maW5kSW5kZXgoKFtyYW5nZSwgYnVmXSwgaSkgPT4gcmFuZ2UgJiYgIUlzV2hpdGVTcGFjZSh0b1N0cmluZyhidWYuc2xpY2UoLi4ucmFuZ2UpKSkpOwogIH0KCiAgbGFzdENodW5rKCkgewogICAgcmV0dXJuIHRoaXMuZmluZExhc3RJbmRleCgoW3JhbmdlLCBidWZdLCBpKSA9PiByYW5nZSAmJiAhSXNXaGl0ZVNwYWNlKHRvU3RyaW5nKGJ1Zi5zbGljZSguLi5yYW5nZSkpKSk7CiAgfQoKICB3cml0ZShvdXQsIGRlcHRoID0gMCwgc2VyaWFsKSB7CiAgICBpZihkZWJ1ZyA+IDIpIGRlYnVnTG9nKGBGaWxlTWFwXHgxYlsxOzM1bTwke3RoaXMuZmlsZX0+XHgxYlswbS53cml0ZWAsIGNvbXBhY3QoMSksIHsgb3V0LCBkZXB0aCwgc2VyaWFsIH0pOwogICAgbGV0IHIsCiAgICAgIHdyaXR0ZW4gPSAwOwogICAgbGV0IHsgbGVuZ3RoIH0gPSB0aGlzOwogICAgc2VyaWFsID8/PSByYW5kSW50KDAsIDEwMDApOwogICAgaWYodGhpcy5zZXJpYWwgPT09IHNlcmlhbCkgcmV0dXJuIDA7CiAgICB0aGlzLnNlcmlhbCA9IHNlcmlhbDsKICAgIGlmKHR5cGVvZiBvdXQgPT0gJ3N0cmluZycpIG91dCA9IEZpbGVXcml0ZXIob3V0KTsKICAgIGxldCBmaXJzdCA9IHRoaXMuZmlyc3RDaHVuaygpOwogICAgbGV0IGxhc3QgPSB0aGlzLmxhc3RDaHVuaygpOwoKICAgIGlmKGRlYnVnID4gMikKICAgICAgZGVidWdMb2coYEZpbGVNYXBceDFiWzE7MzVtPCR7dGhpcy5maWxlfT5ceDFiWzBtLndyaXRlYCwgY29tcGFjdCgyKSwgewogICAgICAgIGNodW5rczogW3RoaXMuYXQoZmlyc3QpLCB0aGlzLmF0KGxhc3QpXQogICAgICB9KTsKICAgIGZvcihsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewogICAgICBsZXQgc3RyID0gdGhpcy5hdChpKTsKICAgICAgaWYoc3RyID09PSBudWxsIHx8IHN0ciA9PT0gdW5kZWZpbmVkKSBjb250aW51ZTsKICAgICAgbGV0IGxlbiA9IHN0ci5ieXRlTGVuZ3RoID8/IHN0ci5sZW5ndGg7CiAgICAgIGlmKGlzT2JqZWN0KHN0cikpIHsKICAgICAgICBpZihzdHIgaW5zdGFuY2VvZiBGaWxlTWFwKSB7CiAgICAgICAgICBpZihzdHIuc2VyaWFsID09PSBzZXJpYWwpIHsKICAgICAgICAgICAgciA9IDA7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgfQogICAgICAgICAgciA9IHN0ci53cml0ZShvdXQsIGRlcHRoICsgMSwgc2VyaWFsKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYoZGVwdGggPiAwICYmIGkgPT0gZmlyc3QpIG91dC5wdXRzKEZpbGVCYW5uZXJDb21tZW50KHRoaXMuZmlsZSwgMCkpOwogICAgICAgICAgciA9IG91dC53cml0ZShzdHIsIGxlbik7CiAgICAgICAgICBpZihkZXB0aCA+IDAgJiYgaSA9PSBsYXN0KSBvdXQucHV0cyhGaWxlQmFubmVyQ29tbWVudCh0aGlzLmZpbGUsIDEpKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbGV0IHR5cGUgPSBnZXRUeXBlTmFtZShzdHIpOwogICAgICAgIGNvbnNvbGUubG9nKCdpbnZhbGlkIHR5cGU6JywgdHlwZSk7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKHR5cGUpOwogICAgICB9CiAgICAgIGlmKGRlYnVnID49IDIpIGRlYnVnTG9nKGBGaWxlTWFwXHgxYlsxOzM1bTwke3RoaXMuZmlsZX0+XHgxYlswbS53cml0ZWAsIGBbJHtpICsgMX0vJHtsZW5ndGh9XWAsIGByZXN1bHQ9JHtyfWApOwogICAgICBpZihyIDwgMCkgewogICAgICAgIGxldCBlcnIgPSBlcnJvcigpOwogICAgICAgIHRocm93IG5ldyBFcnJvcignZXJyb3Igd3JpdGluZyAnICsgbGVuICsgJyBieXRlczogJyArIGluc3BlY3QoZXJyKSk7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgd3JpdHRlbiArPSByOwogICAgfQoKICAgIHJldHVybiB3cml0dGVuOwogIH0KCiAgdG9TdHJpbmcoZm4gPSBGaWxlQmFubmVyQ29tbWVudCkgewogICAgY29uc3QgbiA9IHRoaXMubGVuZ3RoOwogICAgbGV0IHMgPSAnJywKICAgICAgaTsKICAgIGZvcihpID0gMDsgaSA8IG47IGkrKykgewogICAgICBsZXQgc3RyOwogICAgICBjb25zdCBbcmFuZ2UsIGJ1Zl0gPSB0aGlzW2ldOwogICAgICBpZihyYW5nZSA9PT0gbnVsbCAmJiBidWYgPT09IG51bGwpIGNvbnRpbnVlOwogICAgICBpZigoc3RyID0gdGhpcy5hdChpKSkgPT09IG51bGwpIGNvbnRpbnVlOwogICAgICBpZihyYW5nZSA9PT0gbnVsbCkgaWYgKHR5cGVvZiBidWYgPT0gJ3N0cmluZycpIHN0ciA9IGZuKGJ1ZiwgMCkgKyBzdHIgKyBmbihidWYsIDEpOwogICAgICBzICs9IHN0cjsKICAgIH0KICAgIHJldHVybiBzOwogIH0KfQoKRmlsZU1hcC5wcm90b3R5cGVbU3ltYm9sLnRvU3RyaW5nVGFnXSA9ICdGaWxlTWFwJzsKRmlsZU1hcC5wcm90b3R5cGVbaW5zcGVjdFN5bWJvbF0gPSBmdW5jdGlvbihkZXB0aCwgb3B0cykgewogIG9wdHMgPSB7CiAgICAuLi5vcHRzLAogICAgY29tcGFjdDogMiwKICAgIG1heEFycmF5TGVuZ3RoOiBJbmZpbml0eSwKICAgIG1heFN0cmluZ0xlbmd0aDogNDAsCiAgICBzdHJpbmdCcmVha05ld2xpbmU6IGZhbHNlLAogICAgY3VzdG9tSW5zcGVjdDogdHJ1ZSwKICAgIGRlcHRoOiBkZXB0aCArIDQKICB9OwoKICBsZXQgYXJyID0gWy4uLnRoaXNdLm1hcCgoW3JhbmdlLCBidWZdLCBpKSA9PiB7CiAgICBpZihyYW5nZSkgewogICAgICBidWYgPSBidWYuc2xpY2UoLi4ucmFuZ2UpOwogICAgfQoKICAgIGNvbnN0IGlzQnVmID0gaXNPYmplY3QoYnVmKSAmJiB0eXBlcy5pc0FycmF5QnVmZmVyKGJ1Zik7CiAgICByZXR1cm4gW3JhbmdlLCBpc0J1ZiA/IHRoaXMuZmlsZSA6IGJ1ZiwgaXNCdWYgPyB0b1N0cmluZyhidWYpIDogbnVsbF0KICAgICAgLm1hcCgoaXRlbSwgaSkgPT4KICAgICAgICBpbnNwZWN0KGl0ZW0sIHsKICAgICAgICAgIC4uLm9wdHMsCiAgICAgICAgICBjb21wYWN0OiAxLAogICAgICAgICAgY3VzdG9tSW5zcGVjdDogdHJ1ZQogICAgICAgIH0pLnBhZEVuZChpID09IDAgPyAzMSA6IDApCiAgICAgICkKICAgICAgLmpvaW4oJywgJyk7CiAgfSk7CgogIHJldHVybiAoCiAgICBgRmlsZU1hcFx4MWJbMTszNW08JHt0aGlzLmZpbGV9Plx4MWJbMG0gYCArIGFyci5tYXAoKGl0ZW0sIGkpID0+IGBbICMke2l9ICR7aXRlbX0gXWApLmpvaW4oJyxcbiAgJykgPz8KICAgIGluc3BlY3QoYXJyLCB7CiAgICAgIC4uLm9wdHMKICAgIH0pCiAgKTsKfTsKCmZ1bmN0aW9uIEJ1ZmZlckZpbGUoZmlsZSwgYnVmKSB7CiAgZmlsZSA9IHBhdGgubm9ybWFsaXplKGZpbGUpOwogIGlmKCFidWYpIGJ1ZiA9IGZpbGVCdWZmZXJzLmdldChmaWxlKSA/PyBidWZmZXJzW2ZpbGVdOwogIGlmKCFidWYpIGJ1ZiA9IGJ1ZmZlcnNbZmlsZV0gPz8gZnMucmVhZEZpbGVTeW5jKGZpbGUsIHsgZmxhZzogJ3InIH0pOwogIGlmKHR5cGVvZiBidWYgPT0gJ29iamVjdCcgJiYgYnVmICE9PSBudWxsKSB7CiAgICBidWZmZXJSZWYuc2V0KGJ1ZiwgZmlsZSk7CiAgICBmaWxlQnVmZmVycy5zZXQoZmlsZSwgYnVmKTsKICAgIGJ1Zi5maWxlID0gZmlsZTsKICB9CiAgcmV0dXJuIGJ1ZjsKfQoKZnVuY3Rpb24gQnVmZmVyTGVuZ3RocyhmaWxlKSB7CiAgcmV0dXJuIGJ1ZmZlcnNbZmlsZV0ubWFwKGIgPT4gYi5ieXRlTGVuZ3RoKTsKfQoKZnVuY3Rpb24gQnVmZmVyT2Zmc2V0cyhmaWxlKSB7CiAgcmV0dXJuIGJ1ZmZlcnNbZmlsZV0ucmVkdWNlKChbcG9zLCBsaXN0XSwgYikgPT4gW3BvcyArIGIuYnl0ZUxlbmd0aCwgbGlzdC5jb25jYXQoW3Bvc10pXSwgWzAsIFtdXSlbMV07Cn0KCmZ1bmN0aW9uIEJ1ZmZlclJhbmdlcyhmaWxlKSB7CiAgcmV0dXJuIGJ1ZmZlcnNbZmlsZV0ucmVkdWNlKChbcG9zLCBsaXN0XSwgYikgPT4gW3BvcyArIGIuYnl0ZUxlbmd0aCwgbGlzdC5jb25jYXQoW1twb3MsIGIuYnl0ZUxlbmd0aF1dKV0sIFswLCBbXV0pWzFdOwp9CgpmdW5jdGlvbiBXcml0ZUZpbGUoZmlsZSwgdG9rKSB7CiAgbGV0IGYgPSBzdGQub3BlbihmaWxlLCAndysnKTsKICBsZXQgciA9IHR5cGVzLmlzQXJyYXlCdWZmZXIodG9rKSA/IGYud3JpdGUodG9rLCAwLCB0b2suYnl0ZUxlbmd0aCkgOiBmLnB1dHModG9rKTsKICBjb25zb2xlLmxvZygnV3JvdGUgIicgKyBmaWxlICsgJyI6ICcgKyB0b2subGVuZ3RoICsgJyBieXRlcycgKyBgICgke3J9KWApOwp9CgpmdW5jdGlvbiBEdW1wTGV4ZXIobGV4KSB7CiAgY29uc3QgeyBzaXplLCBwb3MsIHN0YXJ0LCBsaW5lLCBjb2x1bW4sIGxpbmVTdGFydCwgbGluZUVuZCwgY29sdW1uSW5kZXggfSA9IGxleDsKICByZXR1cm4gJ0xleGVyICcgKyBpbnNwZWN0KHsgc3RhcnQsIHBvcywgc2l6ZSB9KTsKfQoKZnVuY3Rpb24gRHVtcFRva2VuKHRvaykgewogIGNvbnN0IHsgbGVuZ3RoLCBvZmZzZXQsIGNoYXJzLCBsb2MgfSA9IHRvazsKICByZXR1cm4gYOKYhSBUb2tlbiAke2luc3BlY3QoeyBjaGFycywgb2Zmc2V0LCBsZW5ndGgsIGxvYyB9LCB7IGRlcHRoOiAxIH0pfWA7Cn0KCmZ1bmN0aW9uKiBEZXBlbmRlbmN5VHJlZSgKICByb290LAogIGluZGVudCA9ICcgJywKICBzcGFjaW5nID0gZmFsc2UsCiAgZGVwdGggPSAwLAogIHByZSA9ICcnLAogIGZuID0gKG5hbWUsIGRlcHRoKSA9PiBgJHtuYW1lfSAoJHtkZXB0aH0pYAopIHsKICBpZighQXJyYXkuaXNBcnJheShkZXBlbmRlbmN5VHJlZShyb290KSkpCiAgICB0aHJvdyBuZXcgRXJyb3IoYE5vIHN1Y2ggZmlsZSAnJHtyb290fScgaW4gZGVwZW5kZW5jeSBNYXAgKFske1suLi5kZXBlbmRlbmN5TWFwLmtleXMoKV19XSlgKTsKCiAgaWYoZGVwdGggPT0gMCkgeWllbGQgcHJlICsgc3RyaXBMZWFkaW5nRG90U2xhc2goZm4ocm9vdCwgZGVwdGgpKSArIGBcbmA7CgogIGxldCBhID0gZGVwZW5kZW5jeU1hcC5nZXQocm9vdCk7CiAgbGV0IGkgPSAwLAogICAgbiA9IGEubGVuZ3RoOwoKICBmb3IoaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgIGlmKHNwYWNpbmcpIHlpZWxkIChwcmUgKyBpbmRlbnQgKyBg4pSCICBgICsgJ1xuJykucmVwZWF0KE51bWJlcihzcGFjaW5nKSk7CgogICAgeWllbGQgcHJlICsKICAgICAgaW5kZW50ICsKICAgICAgKG4gPT0gMSA/IGDilJTilIAgYCA6IGkgPCBuIC0gMSA/IGDilJzilIAgYCA6IGDilJTilIAgYCkgKwogICAgICBzdHJpcExlYWRpbmdEb3RTbGFzaChmbihhW2ldLCBkZXB0aCArIDEpKSArCiAgICAgICdcbic7CgogICAgeWllbGQqIERlcGVuZGVuY3lUcmVlKAogICAgICBhW2ldLAogICAgICBpbmRlbnQsCiAgICAgIHNwYWNpbmcsCiAgICAgIGRlcHRoICsgMSwKICAgICAgcHJlICsgaW5kZW50ICsgKG4gPT0gMSA/IGAgICBgIDogaSA8IG4gLSAxID8gYOKUgiAgYCA6IGAgICBgKQogICAgKTsKICB9CgogIGZ1bmN0aW9uIHN0cmlwTGVhZGluZ0RvdFNsYXNoKG4pIHsKICAgIGlmKG4uc3RhcnRzV2l0aCgnLi8nKSkgbiA9IG4uc2xpY2UoMik7CiAgICByZXR1cm4gbjsKICB9Cn0KCmZ1bmN0aW9uIFNwcmVhZEFuZEpvaW4oaXRlcmF0b3IsIHNlcGFyYXRvciA9ICcnKSB7CiAgcmV0dXJuIFsuLi5pdGVyYXRvcl0uam9pbihzZXBhcmF0b3IpOwp9CgpmdW5jdGlvbiogUHJpbnRVc2Vyc2NyaXB0QmFubmVyKGZpZWxkcykgewogIGNvbnN0IGRlZmF1bHRzID0gewogICAgbmFtZTogJ2h0dHBzOi8vZ2l0aHViLmNvbS9yc2VubicsCiAgICBuYW1lc3BhY2U6ICdodHRwczovL2dpdGh1Yi5jb20vcnNlbm4nLAogICAgdmVyc2lvbjogJzEuMCcsCiAgICBkZXNjcmlwdGlvbjogJycsCiAgICBhdXRob3I6ICdSb21hbiBMLiBTZW5uJywKICAgIG1hdGNoOiAnaHR0cCo6Ly8qLyonLAogICAgaWNvbjogJ2RhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEFRQUJBQUFBQUNINUJBRUtBQUVBTEFBQUFBQUJBQUVBQUFJQ1RBRUFPdz09JywKICAgIGdyYW50OiAnbm9uZScKICB9OwoKICBsZXQga2V5cyA9IE9iamVjdC5rZXlzKGRlZmF1bHRzKS5jb25jYXQoT2JqZWN0LmtleXMoZmllbGRzKSkudW5pcXVlKCk7CiAgeWllbGQgYC8vID09VXNlclNjcmlwdD09YDsKICBmb3IobGV0IG5hbWUgb2Yga2V5cykgewogICAgY29uc3QgdmFsdWUgPSBmaWVsZHNbbmFtZV0gPz8gZGVmYXVsdHNbbmFtZV07CgogICAgeWllbGQgYC8vIEAke25hbWUucGFkRW5kKDEyKX0gJHt2YWx1ZX1gOwogIH0KCiAgeWllbGQgYC8vID09L1VzZXJTY3JpcHQ9PWA7Cn0KCmZ1bmN0aW9uIFByaW50RVM2SW1wb3J0KGltcCkgewogIHJldHVybiB7CiAgICBbSW1wb3J0VHlwZXMuSU1QT1JUX05BTUVTUEFDRV06ICh7IGxvY2FsLCBmaWxlIH0pID0+IGBpbXBvcnQgKiBhcyAke2xvY2FsfSBmcm9tICcke2ZpbGV9JztgLAogICAgW0ltcG9ydFR5cGVzLklNUE9SVF9ERUZBVUxUXTogKHsgbG9jYWwsIGZpbGUgfSkgPT4gYGltcG9ydCAke2xvY2FsfSBmcm9tICcke2ZpbGV9JztgLAogICAgW0ltcG9ydFR5cGVzLklNUE9SVF06ICh7IGxvY2FsLCBmaWxlIH0pID0+IGBpbXBvcnQgeyAke2xvY2FsLmpvaW4oJywgJyl9IH0gZnJvbSAnJHtmaWxlfSc7YAogIH1baW1wLnR5cGVdKGltcCk7Cn0KCmZ1bmN0aW9uIFByaW50Q0pTSW1wb3J0KHsgdHlwZSwgbG9jYWwsIGZpbGUgfSkgewogIHJldHVybiB7CiAgICBbSW1wb3J0VHlwZXMuSU1QT1JUX05BTUVTUEFDRV06ICgpID0+IGBjb25zdCAke2xvY2FsfSA9IHJlcXVpcmUoJyR7ZmlsZX0nKTtgLAogICAgW0ltcG9ydFR5cGVzLklNUE9SVF9ERUZBVUxUXTogKCkgPT4gYGNvbnN0ICR7bG9jYWx9ID0gcmVxdWlyZSgnJHtmaWxlfScpO2AsCiAgICBbSW1wb3J0VHlwZXMuSU1QT1JUXTogKCkgPT4gYGNvbnN0IHsgJHtsb2NhbC5qb2luKCcsICcpfSB9ID0gcmVxdWlyZSgnJHtmaWxlfScpO2AKICB9W3R5cGVdKCk7Cn0KCmZ1bmN0aW9uIG1haW4oLi4uYXJncykgewogIGdsb2JhbFRoaXMuY29uc29sZSA9IG5ldyBDb25zb2xlKHN0ZC5lcnIsIHsKICAgIGluc3BlY3RPcHRpb25zOiB7CiAgICAgIGNvbG9yczogdHJ1ZSwKICAgICAgZGVwdGg6IEluZmluaXR5LAogICAgICBzdHJpbmdCcmVha05ld2xpbmU6IHRydWUsCiAgICAgIG1heFN0cmluZ0xlbmd0aDogMTAwMCwKICAgICAgbWF4QXJyYXlMZW5ndGg6IDEwMCwKICAgICAgY29tcGFjdDogMSwKICAgICAgaGlkZUtleXM6IFtTeW1ib2wudG9TdHJpbmdUYWcgLyosICdjb2RlJyovXQogICAgfQogIH0pOwoKICBsZXQgb3B0aW5kID0gMCwKICAgIGNvZGUgPSAnYycsCiAgICBleHAgPSB0cnVlOwoKICBsZXQgb3V0ID0gRmRXcml0ZXIoMSwgJ3N0ZG91dCcpOwogIGxldCBzdHJlYW0gPSBkZWZpbmUoCiAgICB7IGluZGVudDogMCB9LAogICAgewogICAgICBsaW5lczogW10sCiAgICAgIHdyaXRlKGJ1ZiwgbGVuKSB7CiAgICAgICAgbGV0IHMgPSB0b1N0cmluZyhidWYsIDAsIGxlbik7CiAgICAgICAgcmV0dXJuIHRoaXMucHV0cyhzKTsKICAgICAgfSwKICAgICAgcHV0cyhzKSB7CiAgICAgICAgbGV0IHBhZCA9ICcgICcucmVwZWF0KHRoaXMuaW5kZW50KTsKICAgICAgICB0aGlzLmxpbmVzLnB1c2goLi4ucy5zcGxpdCgvXHI/XG4vZykubWFwKGxpbmUgPT4gcGFkICsgbGluZSkpOwogICAgICAgIHJldHVybiBzLmxlbmd0aDsKICAgICAgfSwKICAgICAgY2xvc2UoKSB7CiAgICAgICAgbGV0IHByZXYgPSAnJzsKICAgICAgICBjb25zdCBpc1dTID0gcyA9PiBzLnRyaW0oKSA9PSAnJzsKICAgICAgICBmb3IobGV0IGxpbmUgb2YgdGhpcy5saW5lcykgewogICAgICAgICAgaWYoIShpc1dTKGxpbmUpICYmIGlzV1MocHJldikpKSB7CiAgICAgICAgICAgIG91dC5wdXRzKGxpbmUudHJpbUVuZCgpICsgJ1xuJyk7CiAgICAgICAgICB9CiAgICAgICAgICBwcmV2ID0gbGluZTsKICAgICAgICB9CiAgICAgICAgb3V0LmNsb3NlKCk7CiAgICAgIH0KICAgIH0KICApOwoKICBsZXQgb3B0czsKICBsZXQgcGFyYW1zID0gZ2V0T3B0KAogICAgKG9wdHMgPSB7CiAgICAgIGhlbHA6IFtmYWxzZSwgbnVsbCwgJ2gnXSwKICAgICAgZGVidWc6IFtmYWxzZSwgKCkgPT4gKytkZWJ1ZywgJ3gnXSwKICAgICAgbG9nOiBbdHJ1ZSwgZmlsZSA9PiAobG9nRmlsZSA9IEZpbGVXcml0ZXIoZmlsZSkpLCAndiddLAogICAgICBzb3J0OiBbZmFsc2UsIG51bGwsICdzJ10sCiAgICAgICdjYXNlLXNlbnNpdGl2ZSc6IFtmYWxzZSwgbnVsbCwgJ2MnXSwKICAgICAgcXVpZXQ6IFtmYWxzZSwgKHF1aWV0ID0gKHF1aWV0IHwgMCkgKyAxKSwgJ3EnXSwKICAgICAgZXhwb3J0OiBbZmFsc2UsICgpID0+IChleHAgPSB0cnVlKSwgJ2UnXSwKICAgICAgaW1wb3J0czogW2ZhbHNlLCAoKSA9PiAob25seUltcG9ydHMgPSB0cnVlKSwgJ2knXSwKICAgICAgJ3JlbGF0aXZlLXRvJzogW3RydWUsIGFyZyA9PiAocmVsYXRpdmVUbyA9IHBhdGguYWJzb2x1dGUoYXJnKSksICdSJ10sCiAgICAgIG91dHB1dDogW3RydWUsIGZpbGUgPT4gKG91dHB1dEZpbGUgPSBmaWxlKSwgJ28nXSwKICAgICAgcmVjdXJzaXZlOiBbZmFsc2UsICgpID0+IChyZWN1cnNpdmUgPSB0cnVlKSwgJ3InXSwKICAgICAgJ25vLXJlY3Vyc2l2ZSc6IFtmYWxzZSwgKCkgPT4gKHJlY3Vyc2l2ZSA9IGZhbHNlKSwgJ1InXSwKICAgICAgJ3JlbW92ZS1leHBvcnRzJzogW2ZhbHNlLCAoKSA9PiAocmVtb3ZlRXhwb3J0cyA9IHRydWUpLCAnRSddLAogICAgICAncmVtb3ZlLWltcG9ydHMnOiBbZmFsc2UsICgpID0+IChyZW1vdmVJbXBvcnRzID0gdHJ1ZSksICdJJ10sCiAgICAgICdjaGVjay1pbXBvcnRzJzogW2ZhbHNlLCAoKSA9PiAoc2NyaXB0QXJnc1swXSA9ICdjaGVjay1pbXBvcnRzJyksIG51bGxdLAogICAgICAnbGlzdC1pbXBvcnRzJzogW2ZhbHNlLCAoKSA9PiAoc2NyaXB0QXJnc1swXSA9ICdsaXN0LWltcG9ydHMnKSwgbnVsbF0sCiAgICAgICdyZW1vdmUtY29tbWVudHMnOiBbZmFsc2UsICgpID0+IChyZW1vdmVDb21tZW50cyA9IHRydWUpLCAnQyddLAogICAgICAnZ2xvYmFsLWV4cG9ydHMnOiBbZmFsc2UsICgpID0+ICsrZ2xvYmFsRXhwb3J0cywgJ0cnXSwKICAgICAgJ3Nob3ctZGVwZW5kZW5jaWVzJzogW2ZhbHNlLCAoKSA9PiArK3Nob3dEZXBzLCAnZCddLAogICAgICAncHJpbnQtZmlsZXMnOiBbZmFsc2UsICgpID0+IChwcmludEZpbGVzID0gdHJ1ZSksICdsJ10sCiAgICAgICduby1wcmludC1maWxlcyc6IFtmYWxzZSwgKCkgPT4gKHByaW50RmlsZXMgPSBmYWxzZSksICdMJ10sCiAgICAgICdyZWFkLXBhY2thZ2UnOiBbZmFsc2UsICgpID0+IChyZWFkUGFja2FnZSA9IHRydWUpLCAncCddLAogICAgICAnbm8tcmVhZC1wYWNrYWdlJzogW2ZhbHNlLCAoKSA9PiAocmVhZFBhY2thZ2UgPSBmYWxzZSksICdQJ10sCiAgICAgIHVzZXJzY3JpcHQ6IFtmYWxzZSwgKCkgPT4gKHVzZXJTY3JpcHQgPSB0cnVlKSwgJ1UnXSwKICAgICAgdGltZTogW2ZhbHNlLCAoKSA9PiAoc2hvd1RpbWluZyA9IHRydWUpLCAndCddLAogICAgICAnQCc6ICdmaWxlcycKICAgIH0pLAogICAgYXJncwogICk7CgogIGZ1bmN0aW9uIFNob3dIZWxwKCkgewogICAgbGV0IGVudHJpZXMgPSBPYmplY3QuZW50cmllcyhvcHRzKTsKICAgIGxldCBtYXhsZW4gPSBlbnRyaWVzLnJlZHVjZSgoYWNjLCBbbmFtZV0pID0+IChhY2MgPiBuYW1lLmxlbmd0aCA/IGFjYyA6IG5hbWUubGVuZ3RoKSwgMCk7CgogICAgbGV0IHMgPSBPYmplY3QuZW50cmllcyhvcHRzKS5yZWR1Y2UoCiAgICAgIChhY2MsIFtuYW1lLCBbaGFzQXJnLCBmbiwgc2hvcnRPcHRdXSkgPT4KICAgICAgICBhY2MgKwogICAgICAgICgKICAgICAgICAgIGAgICAgJHsoc2hvcnRPcHQgPyAnLScgKyBzaG9ydE9wdCArICcsJyA6ICcnKS5wYWRTdGFydCg0LCAnICcpfSAtLSR7bmFtZS5wYWRFbmQobWF4bGVuLCAnICcpfSBgICsKICAgICAgICAgIChoYXNBcmcgPyAodHlwZW9mIGhhc0FyZyA9PSAnYm9vbGVhbicgPyAnQVJHJyA6IGhhc0FyZykgOiAnJykKICAgICAgICApLnBhZEVuZCg0MCwgJyAnKSArCiAgICAgICAgJ1xuJywKICAgICAgYFVzYWdlOiAke3BhdGguYmFzZW5hbWUoc2NyaXB0QXJnc1swXSl9IFtPUFRJT05TXSA8RklMRVMuLi4+XG5cbmAKICAgICk7CiAgICBzdGQucHV0cyhzICsgJ1xuJyk7CiAgICBzdGQuZXhpdCgwKTsKICB9CgogIGlmKHBhcmFtcy5oZWxwKSBTaG93SGVscCgpOwoKICBsZXQgZmlsZXMgPSBwYXJhbXNbJ0AnXTsKCiAgaWYoL2NoZWNrLWltcG9ydC8udGVzdChzY3JpcHRBcmdzWzBdKSkgewogICAgaWRlbnRpZmllcnNVc2VkID0gbWVtb2l6ZShhcmcgPT4gbmV3IFNldCgpKTsKICAgIGlmKHByaW50RmlsZXMgPT09IHVuZGVmaW5lZCkgcHJpbnRGaWxlcyA9IGZhbHNlOwogICAgb25seUltcG9ydHMgPSBmYWxzZTsKICAgIG91dHB1dEZpbGUgPSBudWxsOwogICAgb3V0ID0gRHVtbXlXcml0ZXIoJy9kZXYvbnVsbCcpOwogIH0gZWxzZSBpZigvbGlzdC1pbXBvcnQvLnRlc3Qoc2NyaXB0QXJnc1swXSkpIHsKICAgIGlmKHByaW50RmlsZXMgPT09IHVuZGVmaW5lZCkgcHJpbnRGaWxlcyA9IHRydWU7CiAgICBxdWlldCA9IHRydWU7CiAgICBvbmx5SW1wb3J0cyA9IHRydWU7CiAgICBvdXRwdXRGaWxlID0gbnVsbDsKICAgIG91dCA9IER1bW15V3JpdGVyKCcvZGV2L251bGwnKTsKICB9IGVsc2UgewogICAgaWYodHlwZW9mIHJlY3Vyc2l2ZSA9PSAndW5kZWZpbmVkJykgcmVjdXJzaXZlID0gdHJ1ZTsKICB9CgogIGlmKHR5cGVvZiByZWN1cnNpdmUgPT0gJ3VuZGVmaW5lZCcpIHJlY3Vyc2l2ZSA9IGZhbHNlOwoKICBjb25zdCB7IHNvcnQsICdjYXNlLXNlbnNpdGl2ZSc6IGNhc2VTZW5zaXRpdmUgfSA9IHBhcmFtczsKCiAgaWYob3V0cHV0RmlsZSkgb3V0ID0gRmlsZVdyaXRlcihvdXRwdXRGaWxlKTsKCiAgbGV0IGFyZ0xpc3QgPSBbLi4uc2NyaXB0QXJnc107CgogIGxvZ0ZpbGUoYFN0YXJ0IG9mOiAke2FyZ0xpc3Quam9pbignICcpfVxuYCk7CgogIGNvbnN0IFJlbGF0aXZlUGF0aCA9IGZpbGUgPT4gKHBhdGguaXNBYnNvbHV0ZShmaWxlKSA/IGZpbGUgOiBmaWxlLnN0YXJ0c1dpdGgoJy4vJykgPyBmaWxlIDogJy4vJyArIGZpbGUpOwoKICBpZighZmlsZXMubGVuZ3RoKSB0aHJvdyBuZXcgQXJndW1lbnRFcnJvcignRXhwZWN0aW5nIGFyZ3VtZW50IDxmaWxlcy4uLj4nKTsKCiAgbGV0IHJlc3VsdHMgPSBbXTsKCiAgZm9yKGxldCBmaWxlIG9mIGZpbGVzKSB7CiAgICBmaWxlID0gUmVsYXRpdmVQYXRoKGZpbGUpOwogICAgbGV0IGxvZyA9IHF1aWV0ID8gKCkgPT4ge30gOiAoLi4uYXJncykgPT4gY29uc29sZS5sb2coYCR7ZmlsZX06YCwgLi4uYXJncyk7CgogICAgbGV0IHJlc3VsdCA9IFByb2Nlc3NGaWxlKGZpbGUsIGxvZywgcmVjdXJzaXZlLCAwKTsKCiAgICBpZihkZWJ1ZyA+PSAxKSBjb25zb2xlLmxvZygncmVzdWx0JywgY29tcGFjdChmYWxzZSwgeyBkZXB0aDogSW5maW5pdHkgfSksIHJlc3VsdCk7CgogICAgcmVzdWx0cy5wdXNoKHJlc3VsdCk7CiAgfQoKICBpZighcmVtb3ZlSW1wb3J0cykgewogICAgbGV0IGJpbmRpbmdzID0gW10sCiAgICAgIGltcG9ydExpbmVzID0gW107CiAgICBjb25zdCBDb250YWluc0FueSA9IChhcnIsIHRva2VucykgPT4gdG9rZW5zLnNvbWUodG9rID0+IGFyci5pbmRleE9mKHRvaykgIT0gLTEpOwogICAgbGV0IGxpbmVzID0gaGVhZGVyCiAgICAgIC5maWx0ZXIoaW1wZXhwID0+IElzQnVpbHRpbihpbXBleHAuZmlsZSkpCiAgICAgIC5maWx0ZXIoaGRyID0+ICFoZHIuY29kZS5zdGFydHNXaXRoKCdleHBvcnQnKSkKICAgICAgLnJlZHVjZSgKICAgICAgICAoW2FjYywgcHJldl0sIGhkcikgPT4gewogICAgICAgICAgbGV0IHsgY29kZSB9ID0gaGRyOwogICAgICAgICAgbGV0IGRpc2FibGUgPSBDb250YWluc0FueShiaW5kaW5ncywgaGRyLmlkcygpKTsKICAgICAgICAgIGlmKHByZXYgIT0gaGRyLnNvdXJjZSkgewogICAgICAgICAgICBhY2MucHVzaCgnJyk7CiAgICAgICAgICAgIGFjYy5wdXNoKGBgKTsKICAgICAgICAgIH0KCiAgICAgICAgICBsZXQgZHVwbGljYXRlID0gaW1wb3J0TGluZXMuaW5kZXhPZihjb2RlKSAhPSAtMTsKICAgICAgICAgIGltcG9ydExpbmVzLnB1c2goY29kZSk7CiAgICAgICAgICBpZighZHVwbGljYXRlICYmIGRpc2FibGUpIGNvZGUgPSAnJzsKICAgICAgICAgIGlmKCFkdXBsaWNhdGUpIHsKICAgICAgICAgICAgYmluZGluZ3MucHVzaCguLi5oZHIuaWRzKCkpOwogICAgICAgICAgICBhY2MucHVzaChjb2RlKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gW2FjYywgaGRyLnNvdXJjZV07CiAgICAgICAgfSwKICAgICAgICBbW10sIG51bGxdCiAgICAgIClbMF07CiAgICBpZihsaW5lcy5sZW5ndGgpIGxpbmVzID0gW0ZpbGVCYW5uZXJDb21tZW50KCdoZWFkZXInLCAwKSwgLi4ubGluZXMsICcnLCBGaWxlQmFubmVyQ29tbWVudCgnaGVhZGVyJywgMSldOwogICAgaWYoZGVidWcgPiAyKSBjb25zb2xlLmxvZygnbGluZXMnLCBsaW5lcyk7CgogICAgb3V0LnB1dHMobGluZXMucmVkdWNlKChhY2MsIGxpbmUpID0+IGFjYyArIGxpbmUudHJpbSgpICsgJ1xuJywgJycpKTsKICB9CgogIGlmKHVzZXJTY3JpcHQpIHsKICAgIGZvcihsZXQgbGluZSBvZiBQcmludFVzZXJzY3JpcHRCYW5uZXIoewogICAgICBuYW1lOiBvdXQuZmlsZSwKICAgICAgJ3J1bi1hdCc6ICdkb2N1bWVudC1zdGFydCcsCiAgICAgIHZlcnNpb246ICcxLjAnLAogICAgICBkZXNjcmlwdGlvbjogZmlsZXMuam9pbignLCAnKSwKICAgICAgZG93bmxvYWRVUkw6IGBodHRwczovL2xvY2FsaG9zdDo5MDAwLyR7b3V0LmZpbGV9YCwKICAgICAgdXBkYXRlVVJMOiBgaHR0cHM6Ly9sb2NhbGhvc3Q6OTAwMC8ke291dC5maWxlfWAKICAgIH0pKQogICAgICBzdHJlYW0ucHV0cyhsaW5lKTsKCiAgICBzdHJlYW0ucHV0cygiXG4oZnVuY3Rpb24oKSB7XG4gICd1c2Ugc3RyaWN0JztcbiIpOwogICAgKytzdHJlYW0uaW5kZW50OwogIH0KCiAgaWYoZGVidWcgPiAwKSBjb25zb2xlLmxvZygnb3V0Jywgb3V0LCBvdXQuZmlsZSk7CgogIGlmKG91dC5maWxlKSB7CiAgICBsZXQgbmJ5dGVzOwogICAgY29uc29sZS5sb2coYHJlc3VsdHNbMF1gLCByZXN1bHRzWzBdKTsKICAgIGNvbnNvbGUubG9nKGBzdHJlYW1gLCBzdHJlYW0pOwogICAgdHJ5IHsKICAgICAgbmJ5dGVzID0gcmVzdWx0c1swXS53cml0ZShzdHJlYW0pOwogICAgfSBjYXRjaChlcnJvcikgewogICAgICBjb25zb2xlLmxvZyhgd3JpdGUgZXJyb3IgKCcke291dC5maWxlfScpOmAsIGVycm9yKTsKICAgICAgc3RkLmV4aXQoMSk7CiAgICB9CgogICAgY29uc29sZS5sb2coYCR7bmJ5dGVzfSBieXRlcyB3cml0dGVuIHRvICcke291dC5maWxlfSdgKTsKICB9CgogIGlmKGdsb2JhbEV4cG9ydHMpIHsKICAgIGxldCBtYXhEZXB0aCA9IGdsb2JhbEV4cG9ydHMgLSAxOwogICAgbGV0IGV4cG9ydGVkTmFtZXMgPSBmb290ZXIuZmlsdGVyKCh7IGRlcHRoIH0pID0+IGRlcHRoIDw9IG1heERlcHRoKTsKICAgIC8vIGNvbnNvbGUubG9nKGBmb290ZXJgLCBleHBvcnRlZE5hbWVzLm1hcChpbXBleHAgPT4gIFtpbXBleHAuZGVwdGgsaW1wZXhwLm5hbWVdKSk7CgogICAgaWYoZGVidWcgPiAzKSBjb25zb2xlLmxvZyhgZXhwb3J0ZWROYW1lc2AsIGV4cG9ydGVkTmFtZXMpOwoKICAgIGV4cG9ydGVkTmFtZXMgPSBleHBvcnRlZE5hbWVzCiAgICAgIC5tYXAoKHsgbmFtZSB9KSA9PiBuYW1lKQogICAgICAudW5pcXVlKCkKICAgICAgLmZpbHRlcihuYW1lID0+IHR5cGVvZiBuYW1lID09ICdzdHJpbmcnKTsKCiAgICBzdHJlYW0ucHV0cyhgXG5PYmplY3QuYXNzaWduKGdsb2JhbFRoaXMsIHsgJHtleHBvcnRlZE5hbWVzLmpvaW4oJywgJyl9IH0pO1xuYCk7CiAgfQoKICBpZih1c2VyU2NyaXB0KSB7CiAgICAtLXN0cmVhbS5pbmRlbnQ7CiAgICBzdHJlYW0ucHV0cygnfSkoKTtcbicpOwogIH0KCiAgc3RyZWFtLmNsb3NlKCk7CgogIGxvZ0ZpbGUoYFByb2Nlc3NlZCBmaWxlczogJHtTcHJlYWRBbmRKb2luKGRlcGVuZGVuY3lNYXAua2V5cygpLCAnICcpfVxuYCk7Cn0KCnRyeSB7CiAgbWFpbiguLi5zY3JpcHRBcmdzLnNsaWNlKDEpKTsKfSBjYXRjaChlcnJvcikgewogIGNvbnNvbGUubG9nKGAke2Vycm9yLmNvbnN0cnVjdG9yLm5hbWV9OiAke2Vycm9yLm1lc3NhZ2V9JHtlcnJvci5zdGFjayA/ICdcbicgKyBlcnJvci5zdGFjayA6ICcnfWApOwogIHN0ZC5leGl0KDEpOwp9CgAAAAAAAAAAGrcAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAcSEAAAAAAABxIQAAAAAAAAAAAAAAAPC/"
				]
			]
		},
		{
			"file": "quickjs/qjs-modules/quickjs-lexer.c",
			"settings":
			{
				"buffer_size": 43795,
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					118,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAAAKqwAAI2luY2x1ZGUgImRlZmluZXMuaCIKI2luY2x1ZGUgPHF1aWNranMuaD4KI2luY2x1ZGUgPGxpYnJlZ2V4cC5oPgojaW5jbHVkZSAicXVpY2tqcy1sZXhlci5oIgojaW5jbHVkZSAicXVpY2tqcy1sb2NhdGlvbi5oIgojaW5jbHVkZSAidmVjdG9yLmgiCiNpbmNsdWRlIDxzdHJpbmcuaD4KI2luY2x1ZGUgPGN0eXBlLmg+CiNpbmNsdWRlIDxzdGRpbnQuaD4KI2luY2x1ZGUgImJ1ZmZlci11dGlscy5oIgojaW5jbHVkZSAiZGVidWcuaCIKI2luY2x1ZGUgInRva2VuLmgiCgovKioKICogXGFkZHRvZ3JvdXAgcXVpY2tqcy1sZXhlcgogKiBAewogKi8KdHlwZWRlZiBzdHJ1Y3QgewogIEpTVmFsdWUgYWN0aW9uOwogIEJPT0wgc2tpcDsKfSBKU0xleGVyUnVsZTsKCnRocmVhZF9sb2NhbCBWSVNJQkxFIEpTQ2xhc3NJRCBqc190b2tlbl9jbGFzc19pZCA9IDAsIGpzX2xleGVyX2NsYXNzX2lkID0gMDsKdGhyZWFkX2xvY2FsIEpTVmFsdWUgdG9rZW5fcHJvdG8gPSB7e0pTX1RBR19VTkRFRklORUR9fSwgdG9rZW5fY3RvciA9IHt7SlNfVEFHX1VOREVGSU5FRH19Owp0aHJlYWRfbG9jYWwgSlNWYWx1ZSBsZXhlcl9wcm90byA9IHt7SlNfVEFHX1VOREVGSU5FRH19LCBsZXhlcl9jdG9yID0ge3tKU19UQUdfVU5ERUZJTkVEfX07CgpzdGF0aWMgSlNWYWx1ZQpvZmZzZXRfdG9hcnJheShPZmZzZXRMZW5ndGggb2Zmc19sZW4sIEpTQ29udGV4dCogY3R4KSB7CiAgSlNWYWx1ZSByZXQgPSBKU19OZXdBcnJheShjdHgpOwogIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgcmV0LCAwLCBKU19OZXdJbnQ2NChjdHgsIG9mZnNfbGVuLm9mZnNldCkpOwogIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgcmV0LCAxLCBKU19OZXdJbnQ2NChjdHgsIG9mZnNfbGVuLm9mZnNldCArIG9mZnNfbGVuLmxlbmd0aCkpOwogIHJldHVybiByZXQ7Cn0KCnN0YXRpYyBKU1ZhbHVlCmpzX2xleGVyX3J1bGVfbmV3KEpTQ29udGV4dCogY3R4LCBMZXhlciogbGV4LCBMZXhlclJ1bGUqIHJ1bGUpIHsKICBKU1ZhbHVlIHJldCwgc3RhdGVzOwogIER5bkJ1ZiBkYnVmOwogIHNpemVfdCBpLCBqOwogIGpzX2RidWZfaW5pdChjdHgsICZkYnVmKTsKICBsZXhlcl9ydWxlX2R1bXAobGV4LCBydWxlLCAmZGJ1Zik7CiAgZGJ1Zl8wKCZkYnVmKTsKCiAgaWYocnVsZS0+ZXhwclswXSA9PSAnPCcpIHsKICAgIGFzc2VydCghc3RybmNtcChydWxlLT5leHByLCAoY29uc3QgY2hhciopZGJ1Zi5idWYsIHN0cl9jaHIocnVsZS0+ZXhwciwgJz4nKSkpOwogIH0KCiAgcmV0ID0gSlNfTmV3QXJyYXkoY3R4KTsKICBqc19zZXRfcHJvcGVydHlpbnRfc3RyaW5nKGN0eCwgcmV0LCAwLCBydWxlLT5uYW1lKTsKICBqc19zZXRfcHJvcGVydHlpbnRfc3RyaW5nKGN0eCwgcmV0LCAxLCBsZXhlcl9zdGF0ZXNfc2tpcCgoY2hhciopZGJ1Zi5idWYpKTsKCiAgc3RhdGVzID0gSlNfTmV3QXJyYXkoY3R4KTsKCiAgZm9yKGkgPSAwLCBqID0gMDsgaSA8IDMyOyBpKyspIHsKICAgIGlmKHJ1bGUtPm1hc2sgJiAoMSA8PCBpKSkgewogICAgICBjaGFyKiBuYW1lID0gbGV4ZXJfc3RhdGVfbmFtZShsZXgsIGkpOwoKICAgICAgaWYobmFtZSkKICAgICAgICBKU19TZXRQcm9wZXJ0eVVpbnQzMihjdHgsIHN0YXRlcywgaisrLCBKU19OZXdTdHJpbmcoY3R4LCBuYW1lKSk7CiAgICB9CiAgfQoKICBKU19TZXRQcm9wZXJ0eVVpbnQzMihjdHgsIHJldCwgMiwgc3RhdGVzKTsKICBpZihydWxlLT5vcGFxdWUpIHsKICAgIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgcmV0LCAzLCBKU19EdXBWYWx1ZShjdHgsICgoSlNMZXhlclJ1bGUqKXJ1bGUtPm9wYXF1ZSktPmFjdGlvbikpOwogICAgSlNfU2V0UHJvcGVydHlVaW50MzIoY3R4LCByZXQsIDQsIEpTX05ld0Jvb2woY3R4LCAoKEpTTGV4ZXJSdWxlKilydWxlLT5vcGFxdWUpLT5za2lwKSk7CiAgfQogIC8vIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgcmV0LCAzLCBKU19OZXdJbnQ2NChjdHgsIHJ1bGUtPm1hc2spKTsKCiAgZGJ1Zl9mcmVlKCZkYnVmKTsKICByZXR1cm4gcmV0Owp9CgplbnVtIHRva2VuX21ldGhvZHMgewogIFRPX1NUUklORyA9IDAsCn07CgplbnVtIHRva2VuX2dldHRlcnMgewogIFRPS0VOX1BST1BfQllURUxFTkdUSCA9IDAsCiAgVE9LRU5fUFJPUF9CWVRFT0ZGU0VULAogIFRPS0VOX1BST1BfQ0hBUkxFTkdUSCwKICBUT0tFTl9QUk9QX1NUQVJULAogIFRPS0VOX1BST1BfRU5ELAogIFRPS0VOX1BST1BfQllURVJBTkdFLAogIFRPS0VOX1BST1BfQ0hBUlJBTkdFLAogIFRPS0VOX1BST1BfTEVYRU1FLAogIFRPS0VOX1BST1BfTE9DLAogIFRPS0VOX1BST1BfSUQsCiAgVE9LRU5fUFJPUF9TRVEsCiAgVE9LRU5fUFJPUF9UWVBFLAogIFRPS0VOX1BST1BfUlVMRSwKfTsKClRva2VuKgpqc190b2tlbl9uZXcoSlNDb250ZXh0KiBjdHgsIGludCBpZCwgY29uc3QgY2hhciogbGV4ZW1lLCBMb2NhdGlvbiogbG9jLCB1aW50NjRfdCBieXRlX29mZnNldCkgewogIFRva2VuKiB0b2s7CgogIGlmKCEodG9rID0ganNfbWFsbG9jeihjdHgsIHNpemVvZihUb2tlbikpKSkKICAgIHJldHVybiAwOwoKICB0b2stPmlkID0gaWQ7CiAgdG9rLT5sZXhlbWUgPSAodWludDhfdCopanNfc3RyZHVwKGN0eCwgbGV4ZW1lKTsKICB0b2stPmxvYyA9IGxvY2F0aW9uX2R1cChsb2MpOwogIC8vIHRvay0+bG9jX3ZhbCA9IEpTX1VOREVGSU5FRDsKICAvLyAgIHRvay0+Ynl0ZV9vZmZzZXQgPSBieXRlX29mZnNldDsKCiAgcmV0dXJuIHRvazsKfQoKSlNWYWx1ZQpqc190b2tlbl93cmFwKEpTQ29udGV4dCogY3R4LCBUb2tlbiogdG9rKSB7CiAgSlNWYWx1ZSBvYmogPSBKU19VTkRFRklORUQ7CgogIG9iaiA9IEpTX05ld09iamVjdFByb3RvQ2xhc3MoY3R4LCB0b2tlbl9wcm90bywganNfdG9rZW5fY2xhc3NfaWQpOwogIEpTX1NldE9wYXF1ZShvYmosIHRvayk7CiAgcmV0dXJuIG9iajsKfQoKSlNWYWx1ZQpqc190b2tlbl9jb25zdHJ1Y3RvcihKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IG5ld190YXJnZXQsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdKSB7CiAgTGV4ZXIqIGxleCA9IDA7CiAgVG9rZW4qIHRvazsKICBKU1ZhbHVlIG9iaiA9IEpTX1VOREVGSU5FRDsKICBKU1ZhbHVlIHByb3RvOwoKICBpZighKHRvayA9IGpzX21hbGxvY3ooY3R4LCBzaXplb2YoVG9rZW4pKSkpCiAgICByZXR1cm4gSlNfRVhDRVBUSU9OOwoKICAvKiB1c2luZyBuZXdfdGFyZ2V0IHRvIGdldCB0aGUgcHJvdG90eXBlIGlzIG5lY2Vzc2FyeSB3aGVuIHRoZQogICAgIGNsYXNzIGlzIGV4dGVuZGVkLiAqLwogIHByb3RvID0gSlNfR2V0UHJvcGVydHlTdHIoY3R4LCBuZXdfdGFyZ2V0LCAicHJvdG90eXBlIik7CiAgaWYoSlNfSXNFeGNlcHRpb24ocHJvdG8pKQogICAgZ290byBmYWlsOwogIG9iaiA9IEpTX05ld09iamVjdFByb3RvQ2xhc3MoY3R4LCBwcm90bywganNfdG9rZW5fY2xhc3NfaWQpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIHByb3RvKTsKICBpZihKU19Jc0V4Y2VwdGlvbihvYmopKQogICAgZ290byBmYWlsOwoKICBKU19TZXRPcGFxdWUob2JqLCB0b2spOwoKICAvLyB0b2stPmxvY192YWwgPSBKU19VTkRFRklORUQ7CgogIC8vCiAgLy8KICBpZihhcmdjID49IDEgJiYgKGxleCA9IGpzX2xleGVyX2RhdGEoYXJndlswXSkpKSB7CiAgICBhcmdjLS07CiAgICBhcmd2Kys7CiAgfQoKICBpZihhcmdjID4gMCkgewogICAgaWYoSlNfSXNOdW1iZXIoYXJndlswXSkpIHsKICAgICAgSlNfVG9JbnQzMihjdHgsICZ0b2stPmlkLCBhcmd2WzBdKTsKICAgIH0gZWxzZSBpZihKU19Jc1N0cmluZyhhcmd2WzBdKSkgewogICAgfQogIH0KICBpZihhcmdjID4gMSkKICAgIHRvay0+bGV4ZW1lID0gKHVpbnQ4X3QqKWpzX3Rvc3RyaW5nKGN0eCwgYXJndlsxXSk7CiAgaWYoYXJnYyA+IDIpIHsKICAgIExvY2F0aW9uKiBsb2M7CgogICAgaWYoKGxvYyA9IGpzX2xvY2F0aW9uX2RhdGEyKGN0eCwgYXJndlsyXSkpKQogICAgICB0b2stPmxvYyA9IGxvY2F0aW9uX2R1cChsb2MpOwogICAgZWxzZQogICAgICB0b2stPmxvYyA9IGpzX2xvY2F0aW9uX2Zyb20oY3R4LCBhcmd2WzJdKTsKICB9CiAgaWYoYXJnYyA+IDMpCiAgICBKU19Ub0ludDY0KGN0eCwgJnRvay0+bG9jLT5jaGFyX29mZnNldCwgYXJndlszXSk7CgogIHJldHVybiBvYmo7CmZhaWw6CiAganNfZnJlZShjdHgsIHRvayk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgb2JqKTsKICByZXR1cm4gSlNfRVhDRVBUSU9OOwp9CgpKU1ZhbHVlCmpzX3Rva2VuX3Rvc3RyaW5nKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdKSB7CiAgVG9rZW4qIHRvazsKICBpZighKHRvayA9IGpzX3Rva2VuX2RhdGEyKGN0eCwgdGhpc192YWwpKSkKICAgIHJldHVybiBKU19FWENFUFRJT047CiAgcmV0dXJuIEpTX05ld1N0cmluZ0xlbihjdHgsIChjb25zdCBjaGFyKil0b2stPmxleGVtZSwgdG9rLT5ieXRlX2xlbmd0aCk7Cn0KCkpTVmFsdWUKanNfdG9rZW5fdG9wcmltaXRpdmUoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB0aGlzX3ZhbCwgaW50IGFyZ2MsIEpTVmFsdWVDb25zdCBhcmd2W10pIHsKICBUb2tlbiogdG9rOwogIGNvbnN0IGNoYXIqIGhpbnQ7CiAgSlNWYWx1ZSByZXQ7CiAgaWYoISh0b2sgPSBqc190b2tlbl9kYXRhMihjdHgsIHRoaXNfdmFsKSkpCiAgICByZXR1cm4gSlNfRVhDRVBUSU9OOwogIGhpbnQgPSBhcmdjID4gMCA/IEpTX1RvQ1N0cmluZyhjdHgsIGFyZ3ZbMF0pIDogMDsKCiAgaWYoaGludCAmJiAhc3RyY21wKGhpbnQsICJudW1iZXIiKSkKICAgIHJldCA9IEpTX05ld0ludDMyKGN0eCwgdG9rLT5pZCk7CiAgZWxzZQogICAgcmV0ID0gSlNfTmV3U3RyaW5nTGVuKGN0eCwgKGNvbnN0IGNoYXIqKXRvay0+bGV4ZW1lLCB0b2stPmJ5dGVfbGVuZ3RoKTsKCiAgaWYoaGludCkKICAgIGpzX2NzdHJpbmdfZnJlZShjdHgsIGhpbnQpOwogIHJldHVybiByZXQ7Cn0KCnN0YXRpYyBjb25zdCBKU0NGdW5jdGlvbkxpc3RFbnRyeSBqc190b2tlbl9pbnNwZWN0X2Z1bmNzWzFdID0gewogICAgSlNfUFJPUF9TVFJJTkdfREVGKCJbU3ltYm9sLnRvU3RyaW5nVGFnXSIsICJUb2tlbiIsIEpTX1BST1BfQ09ORklHVVJBQkxFKSwKfTsKCkpTVmFsdWUKanNfdG9rZW5faW5zcGVjdChKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsLCBpbnQgYXJnYywgSlNWYWx1ZUNvbnN0IGFyZ3ZbXSkgewogIFRva2VuKiB0b2s7CiAgTGV4ZXJSdWxlKiBydWxlOwogIGludCBhcmdpID0gMDsKICBpbnQzMl90IGQgPSAwOwoKICBpZighKHRvayA9IGpzX3Rva2VuX2RhdGEyKGN0eCwgdGhpc192YWwpKSkKICAgIHJldHVybiBKU19FWENFUFRJT047CgogIGlmKGFyZ2kgPCBhcmdjICYmIEpTX0lzTnVtYmVyKGFyZ3ZbYXJnaV0pKQogICAgSlNfVG9JbnQzMihjdHgsICZkLCBhcmd2W2FyZ2krK10pOwoKICAvLyBwcmludGYoIiVzIGQ9JWlcbiIsIF9fZnVuY19fLCAoaW50KWQpOwoKICBKU1ZhbHVlIG9iaiA9IEpTX05ld09iamVjdFByb3RvQ2xhc3MoY3R4LCB0b2tlbl9wcm90bywganNfdG9rZW5fY2xhc3NfaWQpOwogIHJ1bGUgPSBsZXhlcl9ydWxlX2F0KHRvay0+bGV4ZXIsIHRvay0+aWQpOwoKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAiaWQiLCBKU19OZXdVaW50MzIoY3R4LCB0b2stPmlkKSwgSlNfUFJPUF9FTlVNRVJBQkxFKTsKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAic2VxIiwgSlNfTmV3VWludDMyKGN0eCwgdG9rLT5zZXEpLCBKU19QUk9QX0VOVU1FUkFCTEUpOwoKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAidHlwZSIsIHJ1bGUgPyBKU19OZXdTdHJpbmcoY3R4LCBydWxlLT5uYW1lKSA6IEpTX05VTEwsIEpTX1BST1BfRU5VTUVSQUJMRSk7CiAgSlNfRGVmaW5lUHJvcGVydHlWYWx1ZVN0cihjdHgsIG9iaiwgImxleGVtZSIsIEpTX05ld1N0cmluZyhjdHgsIChjb25zdCBjaGFyKil0b2stPmxleGVtZSksIEpTX1BST1BfRU5VTUVSQUJMRSk7CgogIGlmKHRvay0+bG9jKQogICAgSlNfRGVmaW5lUHJvcGVydHlWYWx1ZVN0cihjdHgsIG9iaiwgImNoYXJPZmZzZXQiLCBKU19OZXdVaW50MzIoY3R4LCB0b2stPmxvYy0+Y2hhcl9vZmZzZXQpLCBKU19QUk9QX0VOVU1FUkFCTEUpOwoKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAiY2hhckxlbmd0aCIsIEpTX05ld1VpbnQzMihjdHgsIHRvay0+Y2hhcl9sZW5ndGgpLCBKU19QUk9QX0VOVU1FUkFCTEUpOwoKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAiY2hhclJhbmdlIiwgb2Zmc2V0X3RvYXJyYXkodG9rZW5fY2hhcl9yYW5nZSh0b2spLCBjdHgpLCAwKTsKCiAgaWYodG9rLT5sb2MpCiAgICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAibG9jIiwganNfbG9jYXRpb25fd3JhcChjdHgsIHRvay0+bG9jKSwgMCk7CiAgcmV0dXJuIG9iajsKfQoKSlNWYWx1ZQpqc190b2tlbl9nZXQoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB0aGlzX3ZhbCwgaW50IG1hZ2ljKSB7CiAgVG9rZW4qIHRvazsKICBKU1ZhbHVlIHJldCA9IEpTX1VOREVGSU5FRDsKCiAgaWYoISh0b2sgPSBqc190b2tlbl9kYXRhKHRoaXNfdmFsKSkpCiAgICByZXR1cm4gcmV0OwoKICBzd2l0Y2gobWFnaWMpIHsKICAgIGNhc2UgVE9LRU5fUFJPUF9CWVRFTEVOR1RIOiB7CiAgICAgIHJldCA9IEpTX05ld0ludDY0KGN0eCwgdG9rLT5ieXRlX2xlbmd0aCk7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBUT0tFTl9QUk9QX0NIQVJMRU5HVEg6IHsKICAgICAgcmV0ID0gSlNfTmV3SW50NjQoY3R4LCB0b2stPmNoYXJfbGVuZ3RoKTsKICAgICAgYnJlYWs7CiAgICB9CiAgICAgIC8qICAgICAgY2FzZSBUT0tFTl9QUk9QX0JZVEVPRkZTRVQ6IHsKICAgICAgICAgICAgcmV0ID0gSlNfTmV3SW50NjQoY3R4LCB0b2stPmJ5dGVfb2Zmc2V0KTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgY2FzZSBUT0tFTl9QUk9QX1NUQVJUOiB7CiAgICAgICAgICAgIHJldCA9IEpTX05ld0ludDY0KGN0eCwgdG9rLT5sb2MuY2hhcl9vZmZzZXQpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIGNhc2UgVE9LRU5fUFJPUF9FTkQ6IHsKICAgICAgICAgICAgcmV0ID0gSlNfTmV3SW50NjQoY3R4LCB0b2stPmxvYy5jaGFyX29mZnNldCArIHRvay0+Y2hhcl9sZW5ndGgpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICovCiAgICBjYXNlIFRPS0VOX1BST1BfQllURVJBTkdFOiB7CiAgICAgIExvY2F0aW9uKiBsb2M7CiAgICAgIGlmKChsb2MgPSB0b2stPmxvYykpCiAgICAgICAgcmV0ID0gb2Zmc2V0X3RvYXJyYXkodG9rZW5fYnl0ZV9yYW5nZSh0b2spLCBjdHgpOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgVE9LRU5fUFJPUF9DSEFSUkFOR0U6IHsKICAgICAgTG9jYXRpb24qIGxvYzsKICAgICAgaWYoKGxvYyA9IHRvay0+bG9jKSkKICAgICAgICByZXQgPSBvZmZzZXRfdG9hcnJheSh0b2tlbl9jaGFyX3JhbmdlKHRvayksIGN0eCk7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBUT0tFTl9QUk9QX0xFWEVNRTogewogICAgICByZXQgPSBKU19OZXdTdHJpbmdMZW4oY3R4LCAoY29uc3QgY2hhciopdG9rLT5sZXhlbWUsIHRvay0+Ynl0ZV9sZW5ndGgpOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgVE9LRU5fUFJPUF9MT0M6IHsKICAgICAgTG9jYXRpb24qIGxvYzsKCiAgICAgIGlmKChsb2MgPSBsb2NhdGlvbl9kdXAodG9rLT5sb2MpKSkKICAgICAgICByZXQgPSBqc19sb2NhdGlvbl93cmFwKGN0eCwgbG9jKTsKCiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBUT0tFTl9QUk9QX0lEOiB7CiAgICAgIHJldCA9IEpTX05ld0ludDMyKGN0eCwgdG9rLT5pZCk7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBUT0tFTl9QUk9QX1NFUTogewogICAgICByZXQgPSBKU19OZXdVaW50MzIoY3R4LCB0b2stPnNlcSk7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBUT0tFTl9QUk9QX1JVTEU6IHsKICAgICAgTGV4ZXJSdWxlKiBydWxlID0gbGV4ZXJfcnVsZV9hdCh0b2stPmxleGVyLCB0b2stPmlkKTsKICAgICAgcmV0ID0gcnVsZSA/IGpzX2xleGVyX3J1bGVfbmV3KGN0eCwgdG9rLT5sZXhlciwgcnVsZSkgOiBKU19OVUxMOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgVE9LRU5fUFJPUF9UWVBFOiB7CiAgICAgIExleGVyUnVsZSogcnVsZSA9IGxleGVyX3J1bGVfYXQodG9rLT5sZXhlciwgdG9rLT5pZCk7CiAgICAgIHJldCA9IHJ1bGUgPyBKU19OZXdTdHJpbmcoY3R4LCBydWxlLT5uYW1lKSA6IEpTX05VTEw7CiAgICAgIGJyZWFrOwogICAgfQogIH0KICByZXR1cm4gcmV0Owp9Cgp2b2lkCmpzX3Rva2VuX2ZpbmFsaXplcihKU1J1bnRpbWUqIHJ0LCBKU1ZhbHVlIHZhbCkgewogIFRva2VuKiB0b2s7CiAgaWYoKHRvayA9IGpzX3Rva2VuX2RhdGEodmFsKSkpIHsKICAgIHRva2VuX2ZyZWVfcnQodG9rLCBydCk7CiAgICBKU19TZXRPcGFxdWUodmFsLCAwKTsKICB9CiAgLy8gSlNfRnJlZVZhbHVlUlQocnQsIHZhbCk7Cn0KCnN0YXRpYyBKU0NsYXNzRGVmIGpzX3Rva2VuX2NsYXNzID0gewogICAgLmNsYXNzX25hbWUgPSAiVG9rZW4iLAogICAgLmZpbmFsaXplciA9IGpzX3Rva2VuX2ZpbmFsaXplciwKfTsKCnN0YXRpYyBjb25zdCBKU0NGdW5jdGlvbkxpc3RFbnRyeSBqc190b2tlbl9wcm90b19mdW5jc1tdID0gewogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoImNoYXJMZW5ndGgiLCBqc190b2tlbl9nZXQsIE5VTEwsIFRPS0VOX1BST1BfQ0hBUkxFTkdUSCksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigiYnl0ZUxlbmd0aCIsIGpzX3Rva2VuX2dldCwgTlVMTCwgVE9LRU5fUFJPUF9CWVRFTEVOR1RIKSwKICAgIC8qICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJieXRlT2Zmc2V0IiwganNfdG9rZW5fZ2V0LCBOVUxMLCBUT0tFTl9QUk9QX0JZVEVPRkZTRVQpLAogICAgICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJzdGFydCIsIGpzX3Rva2VuX2dldCwgTlVMTCwgVE9LRU5fUFJPUF9TVEFSVCksCiAgICAgICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoImVuZCIsIGpzX3Rva2VuX2dldCwgTlVMTCwgVE9LRU5fUFJPUF9FTkQpLCovCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigiY2hhclJhbmdlIiwganNfdG9rZW5fZ2V0LCBOVUxMLCBUT0tFTl9QUk9QX0NIQVJSQU5HRSksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigiYnl0ZVJhbmdlIiwganNfdG9rZW5fZ2V0LCBOVUxMLCBUT0tFTl9QUk9QX0JZVEVSQU5HRSksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigibG9jIiwganNfdG9rZW5fZ2V0LCBOVUxMLCBUT0tFTl9QUk9QX0xPQyksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigiaWQiLCBqc190b2tlbl9nZXQsIE5VTEwsIFRPS0VOX1BST1BfSUQpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoInNlcSIsIGpzX3Rva2VuX2dldCwgTlVMTCwgVE9LRU5fUFJPUF9TRVEpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoInR5cGUiLCBqc190b2tlbl9nZXQsIE5VTEwsIFRPS0VOX1BST1BfVFlQRSksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigicnVsZSIsIGpzX3Rva2VuX2dldCwgTlVMTCwgVE9LRU5fUFJPUF9SVUxFKSwKICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJsZXhlbWUiLCBqc190b2tlbl9nZXQsIE5VTEwsIFRPS0VOX1BST1BfTEVYRU1FKSwKICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJ2YWx1ZSIsIGpzX3Rva2VuX2dldCwgTlVMTCwgVE9LRU5fUFJPUF9MRVhFTUUpLAogICAgLy8gSlNfQ0ZVTkNfREVGKCJ0b1N0cmluZyIsIDAsIGpzX3Rva2VuX3Rvc3RyaW5nKSwKICAgIC8vIEpTX0NGVU5DX0RFRigiW1N5bWJvbC50b1ByaW1pdGl2ZV0iLCAxLCBqc190b2tlbl90b3ByaW1pdGl2ZSksCiAgICBKU19BTElBU19ERUYoInBvc2l0aW9uIiwgImxvYyIpLAogICAgSlNfQUxJQVNfREVGKCJsZW5ndGgiLCAiY2hhckxlbmd0aCIpLAogICAgSlNfQUxJQVNfREVGKCJyYW5nZSIsICJjaGFyUmFuZ2UiKSwKICAgIEpTX1BST1BfU1RSSU5HX0RFRigiW1N5bWJvbC50b1N0cmluZ1RhZ10iLCAiVG9rZW4iLCBKU19QUk9QX0NPTkZJR1VSQUJMRSksCn07CnN0YXRpYyBjb25zdCBKU0NGdW5jdGlvbkxpc3RFbnRyeSBqc190b2tlbl9zdGF0aWNfZnVuY3NbXSA9IHsKICAgIEpTX1BST1BfSU5UMzJfREVGKCJFT0YiLCBMRVhFUl9FT0YsIEpTX1BST1BfRU5VTUVSQUJMRSksCn07CgpzdGF0aWMgSlNWYWx1ZQpsZXhlcl9jb250aW51ZShKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsLCBpbnQgYXJnYywgSlNWYWx1ZUNvbnN0IGFyZ3ZbXSwgaW50IG1hZ2ljLCBKU1ZhbHVlIGRhdGFbXSkgewogIEpTVmFsdWUgdmFsID0gYXJnYyA+PSAxID8gSlNfRHVwVmFsdWUoY3R4LCBhcmd2WzBdKSA6IEpTX05ld0Jvb2woY3R4LCBUUlVFKTsKCiAgSlNfU2V0UHJvcGVydHlVaW50MzIoY3R4LCBkYXRhWzBdLCAwLCB2YWwpOwoKICByZXR1cm4gSlNfVU5ERUZJTkVEOwp9CgpzdGF0aWMgaW50MzJfdApsZXhlcl90b19zdGF0ZShMZXhlciogbGV4LCBKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHZhbHVlKSB7CiAgaW50MzJfdCBudW07CiAgaWYoSlNfSXNOdW1iZXIodmFsdWUpKSB7CiAgICBKU19Ub0ludDMyKGN0eCwgJm51bSwgdmFsdWUpOwogIH0gZWxzZSB7CiAgICBjb25zdCBjaGFyKiBzdHIgPSBKU19Ub0NTdHJpbmcoY3R4LCB2YWx1ZSk7CiAgICBudW0gPSBsZXhlcl9zdGF0ZV9maW5kKGxleCwgc3RyKTsKICB9CiAgaWYobnVtID49IDAgJiYgKHNpemVfdCludW0gPCBsZXhlcl9udW1fc3RhdGVzKGxleCkpCiAgICByZXR1cm4gbnVtOwogIHJldHVybiAtMTsKfQoKc3RhdGljIEJPT0wKbGV4ZXJfaGFuZGxlKExleGVyKiBsZXgsIEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIEpTVmFsdWVDb25zdCBoYW5kbGVyKSB7CiAgQk9PTCByZXN1bHQgPSBGQUxTRTsKICBKU1ZhbHVlIGRhdGFbMV0gPSB7SlNfTmV3QXJyYXkoY3R4KX07CiAgSlNWYWx1ZSBhcmdzW10gPSB7CiAgICAgIEpTX0R1cFZhbHVlKGN0eCwgdGhpc192YWwpLAogICAgICBKU19OZXdDRnVuY3Rpb25EYXRhKGN0eCwgbGV4ZXJfY29udGludWUsIDAsIDAsIDEsIGRhdGEpLAogIH07CiAgSlNWYWx1ZSByZXQsIGRvX3Jlc3VtZSA9IEpTX0ZBTFNFOwoKICByZXQgPSBKU19DYWxsKGN0eCwgaGFuZGxlciwgdGhpc192YWwsIGNvdW50b2YoYXJncyksIGFyZ3MpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIHJldCk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgYXJnc1swXSk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgYXJnc1sxXSk7CgogIGRvX3Jlc3VtZSA9IEpTX0dldFByb3BlcnR5VWludDMyKGN0eCwgZGF0YVswXSwgMCk7CgogIGlmKEpTX0lzQm9vbChkb19yZXN1bWUpKQogICAgcmVzdWx0ID0gSlNfVG9Cb29sKGN0eCwgZG9fcmVzdW1lKTsKCiAgSlNfRnJlZVZhbHVlKGN0eCwgZGF0YVswXSk7CgogIHJldHVybiByZXN1bHQ7Cn0KCnN0YXRpYyBpbnQKbGV4ZXJfbGV4KExleGVyKiBsZXgsIEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdKSB7CiAgaW50IGlkID0gMDsKICBpbnQ2NF90IGZsYWdzID0gMDsKICBKU1ZhbHVlIGNhbGxiYWNrID0gSlNfVU5ERUZJTkVEOwoKICBpZihhcmdjID49IDEgJiYgKGZsYWdzID0gbGV4ZXJfdG9fc3RhdGUobGV4LCBjdHgsIGFyZ3ZbMF0pKSkge30KCiAgY2FsbGJhY2sgPSBKU19HZXRQcm9wZXJ0eVN0cihjdHgsIHRoaXNfdmFsLCAiY2FsbGJhY2siKTsKCiAgaWYobGV4LT5ieXRlX2xlbmd0aCA+IDAgJiYgbGV4LT50b2tlbl9pZCAhPSAtMSkKICAgIGxleGVyX3NraXAobGV4KTsKCiAgZm9yKDs7KSB7CiAgICBpZigoaWQgPSBsZXhlcl9wZWVrKGxleCwgaWQsIGN0eCkpID49IDApIHsKICAgICAgTGV4ZXJSdWxlKiBydWxlID0gbGV4ZXJfcnVsZV9hdChsZXgsIGlkKTsKCiAgICAgIC8vICBwcmludGYoInN0YXRlICVpIHJ1bGUgJXNcbiIsIGxleC0+c3RhdGUsIHJ1bGUtPm5hbWUpOwoKICAgICAgSlNMZXhlclJ1bGUqIGpzcnVsZSA9IHJ1bGUtPm9wYXF1ZTsKCiAgICAgIGlmKChydWxlLT5tYXNrICYgZmxhZ3MpKSB7CiAgICAgICAgbGV4ZXJfc2tpcChsZXgpOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZihqc3J1bGUpIHsKICAgICAgICBCT09MIHNraXAgPSBGQUxTRTsKCiAgICAgICAgaWYoSlNfSXNGdW5jdGlvbihjdHgsIGpzcnVsZS0+YWN0aW9uKSkKICAgICAgICAgIHNraXAgPSBsZXhlcl9oYW5kbGUobGV4LCBjdHgsIHRoaXNfdmFsLCBqc3J1bGUtPmFjdGlvbik7CgogICAgICAgIGlmKHNraXAgfHwganNydWxlLT5za2lwKSB7CiAgICAgICAgICBsZXhlcl9za2lwKGxleCk7CiAgICAgICAgICBpZCA9IDA7IC8vKytpZDsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgLyogaWYoSlNfSXNGdW5jdGlvbihjdHgsIGNhbGxiYWNrKSkgewogICAgICAgICBsZXhlcl9oYW5kbGUobGV4LCBjdHgsIHRoaXNfdmFsLCBjYWxsYmFjayk7CiAgICAgICB9Ki8KCiAgICB9IGVsc2UgaWYoaWQgPT0gTEVYRVJfRVJST1JfTk9NQVRDSCkgewogICAgICBKU1ZhbHVlIGhhbmRsZXIgPSBKU19HZXRQcm9wZXJ0eVN0cihjdHgsIHRoaXNfdmFsLCAiaGFuZGxlciIpOwoKICAgICAgaWYoSlNfSXNGdW5jdGlvbihjdHgsIGhhbmRsZXIpKSB7CiAgICAgICAgaWYobGV4ZXJfaGFuZGxlKGxleCwgY3R4LCB0aGlzX3ZhbCwgaGFuZGxlcikgPT0gVFJVRSkKICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICBpZCA9IExFWEVSX0VSUk9SX05PTUFUQ0g7CiAgICAgIH0KICAgIH0KCiAgICBicmVhazsKICB9CgogIHJldHVybiBpZDsKfQoKc3RhdGljIEJPT0wKbGV4ZXJfZXNjYXBlX3ByZWQoaW50IGMpIHsKICBzd2l0Y2goYykgewogICAgY2FzZSAnKic6CiAgICBjYXNlICc/JzoKICAgIGNhc2UgJysnOgogICAgY2FzZSAnWyc6CiAgICBjYXNlICddJzoKICAgIGNhc2UgJygnOgogICAgY2FzZSAnKSc6CiAgICBjYXNlICcuJzoKICAgIGNhc2UgJ14nOgogICAgY2FzZSAnJCc6CiAgICBjYXNlICd8JzoKICAgIGNhc2UgJ1xyJzoKICAgIGNhc2UgJ1xuJzoKICAgIGNhc2UgJ1x0JzoKICAgIGNhc2UgJ1x2JzoKICAgIGNhc2UgJ1xmJzoKICAgIGNhc2UgJ1xcJzogcmV0dXJuIFRSVUU7CiAgfQogIHJldHVybiBGQUxTRTsKfQpzdGF0aWMgQk9PTApsZXhlcl91bmVzY2FwZV9wcmVkKGludCBjKSB7CiAgc3dpdGNoKGMpIHsKICAgIGNhc2UgJ3InOiByZXR1cm4gJ1xyJzsKICAgIGNhc2UgJ24nOiByZXR1cm4gJ1xuJzsKICAgIGNhc2UgJ3QnOiByZXR1cm4gJ1x0JzsKICAgIGNhc2UgJ3YnOiByZXR1cm4gJ1x2JzsKICAgIGNhc2UgJ2YnOiByZXR1cm4gJ1xmJzsKICAgIGNhc2UgJy8nOgogICAgICByZXR1cm4gJy8nOwogICAgICAvLyBjYXNlICdcXCc6IHJldHVybiAnXFwnOwogIH0KICByZXR1cm4gMDsKfQoKc3RhdGljIGNoYXIqCmxleGVyX2N1cnJlbnRfbGluZShMZXhlciogbGV4LCBKU0NvbnRleHQqIGN0eCkgewogIHNpemVfdCBzdGFydCwgc2l6ZTsKICBzdGFydCA9IGxleC0+cG9zOwogIC8vIGVuZCA9IHN0YXJ0ICsgbGV4LT5ieXRlX2xlbmd0aDsKICB3aGlsZShzdGFydCA+IDAgJiYgbGV4LT5kYXRhW3N0YXJ0IC0gMV0gIT0gJ1xuJykgc3RhcnQtLTsKICBzaXplID0gYnl0ZV9jaHIoKGNvbnN0IGNoYXIqKSZsZXgtPmRhdGFbc3RhcnRdLCBsZXgtPnNpemUgLSBzdGFydCwgJ1xuJyk7CiAgLy8gd2hpbGUoZW5kIDwgbGV4LT5zaXplICYmIGxleC0+ZGF0YVtlbmRdICE9ICdcbicpIGVuZCsrOwogIHJldHVybiBqc19zdHJuZHVwKGN0eCwgKGNvbnN0IGNoYXIqKSZsZXgtPmRhdGFbc3RhcnRdLCBzaXplKTsKfQoKc3RhdGljIGNoYXIqCmxleGVyX2xleGVtZV9zKExleGVyKiBsZXgsIEpTQ29udGV4dCogY3R4KSB7CiAgc2l6ZV90IGxlbjsKICBjaGFyKiBzOwogIER5bkJ1ZiBvdXRwdXQ7CiAganNfZGJ1Zl9pbml0KGN0eCwgJm91dHB1dCk7CgogIHMgPSBsZXhlcl9sZXhlbWUobGV4LCAmbGVuKTsKCiAgZGJ1Zl9wdXRfZXNjYXBlZF9wcmVkKCZvdXRwdXQsIHMsIGxlbiwgbGV4ZXJfZXNjYXBlX3ByZWQpOwogIGRidWZfMCgmb3V0cHV0KTsKCiAgcmV0dXJuIChjaGFyKilvdXRwdXQuYnVmOwp9CgpzdGF0aWMgVG9rZW4qCmxleGVyX3Rva2VuKExleGVyKiBsZXgsIGludDMyX3QgaWQsIEpTQ29udGV4dCogY3R4KSB7CiAgc2l6ZV90IGxlbjsKICBjb25zdCBjaGFyKiBsZXhlbWU7CiAgVG9rZW4qIHRvazsKCiAgaWYoIShsZXhlbWUgPSBsZXhlcl9sZXhlbWUobGV4LCAmbGVuKSkpCiAgICByZXR1cm4gMDsKCiAgaWYoISh0b2sgPSB0b2tlbl9jcmVhdGUoaWQsIGxvY2F0aW9uX2Nsb25lKCZsZXgtPmxvYywgY3R4KSwgbGV4ZW1lLCBsZW4sIGN0eCkpKQogICAgcmV0dXJuIDA7CgogIHRvay0+bGV4ZXIgPSBsZXhlcl9kdXAobGV4KTsKICB0b2stPnNlcSA9IGxleC0+c2VxOwoKICByZXR1cm4gdG9rOwp9CgpKU1ZhbHVlCmpzX2xleGVyX25ldyhKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHByb3RvLCBKU1ZhbHVlQ29uc3QgdmlucHV0LCBKU1ZhbHVlQ29uc3Qgdm1vZGUpIHsKICBMZXhlciogbGV4OwogIGludDMyX3QgbW9kZSA9IDA7CiAgSlNWYWx1ZSBvYmogPSBKU19VTkRFRklORUQ7CiAgaWYoIShsZXggPSBqc19tYWxsb2N6KGN0eCwgc2l6ZW9mKExleGVyKSkpKQogICAgcmV0dXJuIEpTX0VYQ0VQVElPTjsKCiAgaWYoSlNfSXNOdW1iZXIodm1vZGUpKQogICAgSlNfVG9JbnQzMihjdHgsICZtb2RlLCB2bW9kZSk7CiAgbGV4ZXJfaW5pdChsZXgsIG1vZGUsIGN0eCk7CgogIG9iaiA9IEpTX05ld09iamVjdFByb3RvQ2xhc3MoY3R4LCBwcm90bywganNfbGV4ZXJfY2xhc3NfaWQpOwoKICBpZihKU19Jc0V4Y2VwdGlvbihvYmopKQogICAgZ290byBmYWlsOwogIEpTX1NldE9wYXF1ZShvYmosIGxleCk7CgogIGxleC0+aW5wdXQgPSBqc19pbnB1dF9jaGFycyhjdHgsIHZpbnB1dCk7CgogIHJldHVybiBvYmo7CmZhaWw6CiAganNfZnJlZShjdHgsIGxleCk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgb2JqKTsKICByZXR1cm4gSlNfRVhDRVBUSU9OOwp9CgpKU1ZhbHVlCmpzX2xleGVyX3dyYXAoSlNDb250ZXh0KiBjdHgsIExleGVyKiBsZXgpIHsKICBKU1ZhbHVlIG9iajsKCiAgb2JqID0gSlNfTmV3T2JqZWN0UHJvdG9DbGFzcyhjdHgsIGxleGVyX3Byb3RvLCBqc19sZXhlcl9jbGFzc19pZCk7CiAgSlNfU2V0T3BhcXVlKG9iaiwgbGV4KTsKICByZXR1cm4gb2JqOwp9CgpKU1ZhbHVlCmpzX2xleGVyX2FkZF9ydWxlKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdLCBpbnQgbWFnaWMpIHsKICBMZXhlciogbGV4OwogIGNoYXIqIG5hbWU7CiAgaW50NjRfdCBtYXNrID0gLTEsIHNraXAgPSAwOwogIFJlZ0V4cCBleHByOwogIEpTTGV4ZXJSdWxlKiBqc3J1bGUgPSAwOwoKICBpZighKGxleCA9IGpzX2xleGVyX2RhdGEyKGN0eCwgdGhpc192YWwpKSkKICAgIHJldHVybiBKU19FWENFUFRJT047CgogIG5hbWUgPSAobWFnaWMgfHwgSlNfSXNTdHJpbmcoYXJndlswXSkpID8ganNfdG9zdHJpbmcoY3R4LCBhcmd2WzBdKSA6IDA7CiAgZXhwciA9IHJlZ2V4cF9mcm9tX2FyZ3YoYXJnYyAtIDEsICZhcmd2WzFdLCBjdHgpOwoKICBpZihhcmdjID49IDMgJiYgSlNfSXNOdW1iZXIoYXJndlsyXSkpCiAgICBKU19Ub0ludDY0KGN0eCwgJm1hc2ssIGFyZ3ZbMl0pOwoKICBKU1ZhbHVlIHNraXB2ID0gSlNfR2V0UHJvcGVydHlTdHIoY3R4LCB0aGlzX3ZhbCwgInNraXAiKTsKICBpZihKU19Jc051bWJlcihza2lwdikpCiAgICBKU19Ub0ludDY0KGN0eCwgJnNraXAsIHNraXB2KTsKICBKU19GcmVlVmFsdWUoY3R4LCBza2lwdik7CgogIGlmKGFyZ2MgPiAzIHx8IEpTX0lzRnVuY3Rpb24oY3R4LCBhcmd2W2FyZ2MgLSAxXSkpIHsKICAgIGpzcnVsZSA9IGpzX21hbGxvYyhjdHgsIHNpemVvZihKU0xleGVyUnVsZSkpOwoKICAgIGpzcnVsZS0+YWN0aW9uID0gSlNfRHVwVmFsdWUoY3R4LCBhcmd2W2FyZ2MgLSAxXSk7CiAgICBqc3J1bGUtPnNraXAgPSAhIShtYXNrICYgc2tpcCk7CiAgfQoKICBpZihtYWdpYykgewogICAgaW50IGluZGV4OwogICAgTGV4ZXJSdWxlKiBydWxlOwoKICAgIGlmKChpbmRleCA9IGxleGVyX3J1bGVfYWRkKGxleCwgbmFtZSwgZXhwci5zb3VyY2UpKSA9PSAtMSkKICAgICAgcmV0dXJuIEpTX1Rocm93SW50ZXJuYWxFcnJvcihjdHgsICJMZXhlciBydWxlICclcycgbm90IHVuaXF1ZSIsIG5hbWUpOwoKICAgIHJ1bGUgPSBsZXhlcl9ydWxlX2F0KGxleCwgaW5kZXgpOwogICAgcnVsZS0+b3BhcXVlID0ganNydWxlOwoKICAgIHJldHVybiBKU19OZXdJbnQzMihjdHgsIGluZGV4KTsKICB9IGVsc2UgewogICAgbGV4ZXJfZGVmaW5lKGxleCwgbmFtZSwgZXhwci5zb3VyY2UpOwogIH0KCiAgcmV0dXJuIEpTX1VOREVGSU5FRDsKfQoKSlNWYWx1ZQpqc19sZXhlcl9jb25zdHJ1Y3RvcihKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IG5ld190YXJnZXQsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdKSB7CiAgSlNWYWx1ZSBwcm90bywgcmV0OwogIExleGVyKiBsZXg7CiAgaW50NjRfdCBtYXNrID0gTUFTS19BTEw7CiAgLyogdXNpbmcgbmV3X3RhcmdldCB0byBnZXQgdGhlIHByb3RvdHlwZSBpcyBuZWNlc3Nhcnkgd2hlbiB0aGUKICAgICAgY2xhc3MgaXMgZXh0ZW5kZWQuICovCiAgcHJvdG8gPSBKU19HZXRQcm9wZXJ0eVN0cihjdHgsIG5ld190YXJnZXQsICJwcm90b3R5cGUiKTsKICBpZihKU19Jc0V4Y2VwdGlvbihwcm90bykpCiAgICBwcm90byA9IGxleGVyX3Byb3RvOyAvLyBKU19EdXBWYWx1ZShjdHgsIGxleGVyX3Byb3RvKTsKCiAgcmV0ID0ganNfbGV4ZXJfbmV3KGN0eCwgcHJvdG8sIGFyZ2MgPiAwID8gYXJndlswXSA6IEpTX1VOREVGSU5FRCwgYXJnYyA+IDEgPyBhcmd2WzFdIDogSlNfVU5ERUZJTkVEKTsKCiAgaWYoKGxleCA9IEpTX0dldE9wYXF1ZShyZXQsIGpzX2xleGVyX2NsYXNzX2lkKSkpIHsKICAgIGludCBpID0gMjsKCiAgICBpZihsZXgtPmxvYy5maWxlID09IC0xICYmIGkgPCBhcmdjICYmIEpTX0lzU3RyaW5nKGFyZ3ZbaV0pKQogICAgICBsZXgtPmxvYy5maWxlID0gSlNfVmFsdWVUb0F0b20oY3R4LCBhcmd2W2krK10pOwoKICAgIGlmKGkgPCBhcmdjICYmIEpTX0lzTnVtYmVyKGFyZ3ZbaV0pKSB7CiAgICAgIHVpbnQzMl90IG1vZGUgPSAwOwogICAgICBKU19Ub1VpbnQzMihjdHgsICZtb2RlLCBhcmd2W2krK10pOwogICAgICBsZXgtPm1vZGUgfD0gbW9kZTsKICAgIH0KICAgIGlmKGkgPCBhcmdjICYmIEpTX0lzTnVtYmVyKGFyZ3ZbaV0pKQogICAgICBKU19Ub0ludDY0KGN0eCwgJm1hc2ssIGFyZ3ZbaSsrXSk7CiAgfQogIEpTX1NldFByb3BlcnR5U3RyKGN0eCwgcmV0LCAibWFzayIsIEpTX05ld0ludDY0KGN0eCwgbWFzaykpOwoKICByZXR1cm4gcmV0Owp9CgplbnVtIHsKICBNRVRIT0RfU0VUX0lOUFVUID0gMCwKICBNRVRIT0RfU0tJUF9CWVRFUywKICBNRVRIT0RfU0tJUF9UT0tFTiwKICBNRVRIT0RfQkFDSywKICBNRVRIT0RfUEVFS0MsCiAgTUVUSE9EX0dFVEMsCiAgTUVUSE9EX1NLSVBfQ0hBUlMsCiAgTUVUSE9EX0dFVF9SQU5HRSwKICBNRVRIT0RfQ1VSUkVOVF9MSU5FLAogIE1FVEhPRF9UT0tFTl9DTEFTUywKICBNRVRIT0RfR0VUX1JVTEUsCiAgTUVUSE9EX1NLSVBfVU5USUwsCiAgTUVUSE9EX0VSUk9SLAogIE1FVEhPRF9QVVNIX1NUQVRFLAogIE1FVEhPRF9QT1BfU1RBVEUsCiAgTUVUSE9EX1RPUF9TVEFURSwKfTsKCkpTVmFsdWUKanNfbGV4ZXJfbWV0aG9kKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdLCBpbnQgbWFnaWMpIHsKICBMZXhlciogbGV4OwogIEpTVmFsdWUgcmV0ID0gSlNfVU5ERUZJTkVEOwoKICBpZighKGxleCA9IGpzX2xleGVyX2RhdGEyKGN0eCwgdGhpc192YWwpKSkKICAgIHJldHVybiBKU19FWENFUFRJT047CgogIHN3aXRjaChtYWdpYykgewogICAgY2FzZSBNRVRIT0RfU0VUX0lOUFVUOiB7CiAgICAgIExleGVyKiBvdGhlcjsKICAgICAgSW5wdXRCdWZmZXIgaW5wdXQ7CiAgICAgIExvY2F0aW9uIGxvYyA9IHswLCAwLCAwLCAtMSwgMH07CgogICAgICBpZigob3RoZXIgPSBKU19HZXRPcGFxdWUoYXJndlswXSwganNfbGV4ZXJfY2xhc3NfaWQpKSkgewogICAgICAgIGlucHV0ID0gaW5wdXRfYnVmZmVyX2Nsb25lKCZvdGhlci0+aW5wdXQsIGN0eCk7CiAgICAgICAgbG9jID0gb3RoZXItPmxvYzsKICAgICAgICAvLyBsZXgtPnN0YXJ0ID0gb3RoZXItPnN0YXJ0OwogICAgICB9IGVsc2UgewogICAgICAgIGlucHV0ID0ganNfaW5wdXRfY2hhcnMoY3R4LCBhcmd2WzBdKTsKICAgICAgfQoKICAgICAgaW5wdXRfYnVmZmVyX2ZyZWUoJmxleC0+aW5wdXQsIGN0eCk7CiAgICAgIGxleC0+aW5wdXQgPSBpbnB1dDsKICAgICAgbG9jYXRpb25fcmVsZWFzZV9ydCgmbGV4LT5sb2MsIEpTX0dldFJ1bnRpbWUoY3R4KSk7CiAgICAgIGxleC0+bG9jID0gbG9jOwoKICAgICAgaWYoYXJnYyA+IDEgJiYgSlNfSXNTdHJpbmcoYXJndlsxXSkpIHsKICAgICAgICBpZihsZXgtPmxvYy5maWxlID4gLTEpCiAgICAgICAgICBKU19GcmVlQXRvbShjdHgsIGxleC0+bG9jLmZpbGUpOwogICAgICAgIGxleC0+bG9jLmZpbGUgPSBKU19WYWx1ZVRvQXRvbShjdHgsIGFyZ3ZbMV0pOwogICAgICB9CgogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIE1FVEhPRF9TS0lQX0JZVEVTOiB7CiAgICAgIHVpbnQzMl90IG4gPSAwOwogICAgICBKU19Ub1VpbnQzMihjdHgsICZuLCBhcmd2WzBdKTsKCiAgICAgIGlmKG4gPiBsZXgtPmJ5dGVfbGVuZ3RoKQogICAgICAgIHJldCA9IEpTX1Rocm93SW50ZXJuYWxFcnJvcihjdHgsICJza2lwQnl0ZXMoKTogY291bnQgbiA+ICV6dSIsIGxleC0+Ynl0ZV9sZW5ndGgpOwogICAgICBlbHNlCiAgICAgICAgcmV0ID0gSlNfTmV3VWludDMyKGN0eCwgbGV4ZXJfc2tpcF9uKGxleCwgbikpOwogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIE1FVEhPRF9TS0lQX1RPS0VOOiB7CiAgICAgIGlmKGxleC0+dG9rZW5faWQgPT0gLTEpCiAgICAgICAgcmV0ID0gSlNfVGhyb3dJbnRlcm5hbEVycm9yKGN0eCwgInNraXBUb2tlbigpOiBsZXhlciB0b2tlbiBpZCBpcyAtMSIpOwogICAgICBlbHNlIGlmKGxleC0+Ynl0ZV9sZW5ndGggPT0gMCkKICAgICAgICByZXQgPSBKU19UaHJvd0ludGVybmFsRXJyb3IoY3R4LCAic2tpcFRva2VuKCk6IGxleGVyIHRva2VuIGxlbmd0aCBpcyAwIik7CiAgICAgIGVsc2UKICAgICAgICByZXQgPSBKU19OZXdVaW50MzIoY3R4LCBsZXhlcl9za2lwKGxleCkpOwogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIE1FVEhPRF9CQUNLOiB7CiAgICAgIGludCBpOwogICAgICBmb3IoaSA9IDA7IGkgPCBhcmdjOyBpKyspIHsKICAgICAgICBUb2tlbiogdG9rOwogICAgICAgIExvY2F0aW9uKiBsb2M7CiAgICAgICAgaWYoKGxvYyA9IGpzX2xvY2F0aW9uX2RhdGEyKGN0eCwgYXJndltpXSkpKSB7CiAgICAgICAgICBsZXhlcl9zZXRfbG9jYXRpb24obGV4LCBsb2MsIGN0eCk7CiAgICAgICAgICBpZihsZXgtPmJ5dGVfbGVuZ3RoID4gMCAmJiBsZXgtPnRva2VuX2lkICE9IC0xKQogICAgICAgICAgICBsZXhlcl9jbGVhcl90b2tlbihsZXgpOwogICAgICAgICAgcmV0ID0gSlNfTmV3SW50MzIoY3R4LCBsZXhlcl9wZWVrKGxleCwgLyoxIDw8IGxleC0+c3RhdGUsKi8gMCwgY3R4KSk7CiAgICAgICAgfSBlbHNlIGlmKCh0b2sgPSBqc190b2tlbl9kYXRhKGFyZ3ZbaV0pKSkgewogICAgICAgICAgbGV4ZXJfc2V0X2xvY2F0aW9uKGxleCwgdG9rLT5sb2MsIGN0eCk7CiAgICAgICAgICBsZXgtPmJ5dGVfbGVuZ3RoID0gdG9rLT5ieXRlX2xlbmd0aDsKICAgICAgICAgIGxleC0+c2VxID0gdG9rLT5zZXE7CiAgICAgICAgICByZXQgPSBKU19OZXdJbnQzMihjdHgsIHRvay0+aWQpOwogICAgICAgIH0gLyplbHNlIGlmKEpTX0lzU3RyaW5nKGFyZ3ZbaV0pKSB7CiAgICAgICAgICBzaXplX3QgbGVuOwogICAgICAgICAgY29uc3QgY2hhciogc3RyID0gSlNfVG9DU3RyaW5nTGVuKGN0eCwgJmxlbiwgYXJndltpXSk7CiAgICAgICAgICBpZihsZXgtPnBvcyA+PSBsZW4gJiYgIW1lbWNtcCgmbGV4LT5kYXRhW2xleC0+cG9zIC0gbGVuXSwgc3RyLCBsZW4pKSB7CiAgICAgICAgICAgIExvY2F0aW9uIGRpZmY7CiAgICAgICAgICAgIGxvY2F0aW9uX3plcm8oJmRpZmYpOwogICAgICAgICAgICBsb2NhdGlvbl9jb3VudCgmZGlmZiwgKGNvbnN0IHVpbnQ4X3QqKSZsZXgtPmRhdGFbbGV4LT5wb3MgLSBsZW5dLCBsZW4pOwogICAgICAgICAgICBsb2NhdGlvbl9zdWIoJmxleC0+bG9jLCAmZGlmZik7CiAgICAgICAgICAgIHJldCA9IEpTX05ld0ludDMyKGN0eCwgbGV4ZXJfcGVlayhsZXgsIDEgPDwgbGV4LT5zdGF0ZSwgMCwgY3R4KSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjaGFyKiBidWYgPSBieXRlX2VzY2FwZSgoY29uc3QgY2hhciopJmxleC0+ZGF0YVtsZXgtPnBvcyAtIGxlbl0sIGxlbik7CiAgICAgICAgICAgIHJldCA9IEpTX1Rocm93SW50ZXJuYWxFcnJvcihjdHgsICJMZXhlci5wcm90b3R5cGUuYmFjaygnJXMnKSBgJXNgIC4uLiIsIHN0ciwgYnVmKTsKICAgICAgICAgICAgZnJlZShidWYpOwogICAgICAgICAgfQogICAgICAgICAgSlNfRnJlZUNTdHJpbmcoY3R4LCBzdHIpOwogICAgICAgIH0qLwogICAgICAgIGVsc2UgewogICAgICAgICAgcmV0ID0gSlNfVGhyb3dUeXBlRXJyb3IoY3R4LCAiTGV4ZXIucHJvdG90eXBlLmJhY2soKSBuZWVkcyB0b2tlbiBvciBsb2NhdGlvbiIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgYnJlYWs7CiAgICB9CgogICAgY2FzZSBNRVRIT0RfUEVFS0M6IHsKICAgICAgaWYoIWlucHV0X2J1ZmZlcl9lb2YoJmxleC0+aW5wdXQpKSB7CiAgICAgICAgc2l6ZV90IGxlbjsKICAgICAgICBjb25zdCB1aW50OF90KiBidWYgPSBpbnB1dF9idWZmZXJfcGVlaygmbGV4LT5pbnB1dCwgJmxlbik7CiAgICAgICAgcmV0ID0gSlNfTmV3U3RyaW5nTGVuKGN0eCwgKGNvbnN0IGNoYXIqKWJ1ZiwgbGVuKTsKICAgICAgfQogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIE1FVEhPRF9HRVRDOiB7CiAgICAgIGlmKCFpbnB1dF9idWZmZXJfZW9mKCZsZXgtPmlucHV0KSkgewogICAgICAgIHNpemVfdCBsZW47CiAgICAgICAgY29uc3QgdWludDhfdCogYnVmID0gaW5wdXRfYnVmZmVyX2dldCgmbGV4LT5pbnB1dCwgJmxlbik7CiAgICAgICAgcmV0ID0gSlNfTmV3U3RyaW5nTGVuKGN0eCwgKGNvbnN0IGNoYXIqKWJ1ZiwgbGVuKTsKICAgICAgfQogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIE1FVEhPRF9TS0lQX0NIQVJTOiB7CiAgICAgIGlmKCFpbnB1dF9idWZmZXJfZW9mKCZsZXgtPmlucHV0KSkgewogICAgICAgIGludDMyX3QgbnRpbWVzID0gMTsKICAgICAgICBjb25zdCB1aW50OF90KiBwID0gMDsKICAgICAgICBzaXplX3QgbjsKICAgICAgICBpZihhcmdjID4gMCkKICAgICAgICAgIEpTX1RvSW50MzIoY3R4LCAmbnRpbWVzLCBhcmd2WzBdKTsKICAgICAgICB3aGlsZShudGltZXMtLSA+IDApIHsgcCA9IGlucHV0X2J1ZmZlcl9nZXQoJmxleC0+aW5wdXQsICZuKTsgfQogICAgICAgIGlmKHApCiAgICAgICAgICByZXQgPSBKU19OZXdTdHJpbmdMZW4oY3R4LCAoY29uc3QgY2hhciopcCwgbik7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICB9CgogICAgY2FzZSBNRVRIT0RfU0tJUF9VTlRJTDogewogICAgICBpZighaW5wdXRfYnVmZmVyX2VvZigmbGV4LT5pbnB1dCkpIHsKICAgICAgICBKU1ZhbHVlQ29uc3QgcHJlZDsKICAgICAgICBpZighSlNfSXNGdW5jdGlvbihjdHgsIGFyZ3ZbMF0pKQogICAgICAgICAgcmV0dXJuIEpTX1Rocm93VHlwZUVycm9yKGN0eCwgImFyZ3VtZW50IDEgaXMgbm90IGEgZnVuY3Rpb24iKTsKICAgICAgICBwcmVkID0gYXJndlswXTsKICAgICAgICB3aGlsZShsZXgtPnBvcyA8IGxleC0+c2l6ZSkgewogICAgICAgICAgc2l6ZV90IG47CiAgICAgICAgICBjb25zdCB1aW50OF90KiBwID0gaW5wdXRfYnVmZmVyX3BlZWsoJmxleC0+aW5wdXQsICZuKTsKICAgICAgICAgIEpTVmFsdWUgc3RyID0gSlNfTmV3U3RyaW5nTGVuKGN0eCwgKGNvbnN0IGNoYXIqKXAsIG4pOwogICAgICAgICAgSlNWYWx1ZSByZXQgPSBKU19DYWxsKGN0eCwgcHJlZCwgdGhpc192YWwsIDEsICZzdHIpOwogICAgICAgICAgQk9PTCBiID0gSlNfVG9Cb29sKGN0eCwgcmV0KTsKICAgICAgICAgIEpTX0ZyZWVWYWx1ZShjdHgsIHJldCk7CiAgICAgICAgICBpZihiKSB7CiAgICAgICAgICAgIHJldCA9IHN0cjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgICBKU19GcmVlVmFsdWUoY3R4LCBzdHIpOwogICAgICAgICAgaW5wdXRfYnVmZmVyX2dldGMoJmxleC0+aW5wdXQpOwogICAgICAgICAgLy8gbGV4LT5zdGFydCA9IGxleC0+cG9zOwogICAgICAgIH0KICAgICAgfQogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIE1FVEhPRF9HRVRfUkFOR0U6IHsKICAgICAgc2l6ZV90IHN0YXJ0LCBlbmQ7CiAgICAgIHN0YXJ0ID0gbGV4LT5wb3M7CiAgICAgIGVuZCA9IHN0YXJ0ICsgbGV4LT5ieXRlX2xlbmd0aDsKICAgICAgaWYoYXJnYyA+IDApIHsKICAgICAgICBqc192YWx1ZV90b3NpemUoY3R4LCAmc3RhcnQsIGFyZ3ZbMF0pOwogICAgICAgIGlmKGFyZ2MgPiAxKQogICAgICAgICAganNfdmFsdWVfdG9zaXplKGN0eCwgJmVuZCwgYXJndlsxXSk7CiAgICAgIH0KICAgICAgcmV0ID0gSlNfTmV3U3RyaW5nTGVuKGN0eCwgKGNvbnN0IGNoYXIqKSZsZXgtPmRhdGFbc3RhcnRdLCBlbmQgLSBzdGFydCk7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgTUVUSE9EX0NVUlJFTlRfTElORTogewogICAgICByZXQgPSBKU19OZXdTdHJpbmcoY3R4LCBsZXhlcl9jdXJyZW50X2xpbmUobGV4LCBjdHgpKTsKICAgICAgYnJlYWs7CiAgICB9CgogICAgY2FzZSBNRVRIT0RfVE9LRU5fQ0xBU1M6IHsKICAgICAgVG9rZW4qIHRvazsKICAgICAgTGV4ZXJSdWxlKiBydWxlOwogICAgICBpbnQzMl90IGlkID0gLTE7CgogICAgICBpZigodG9rID0gSlNfR2V0T3BhcXVlKGFyZ3ZbMF0sIGpzX3Rva2VuX2NsYXNzX2lkKSkpCiAgICAgICAgaWQgPSB0b2stPmlkOwogICAgICBlbHNlCiAgICAgICAgSlNfVG9JbnQzMihjdHgsICZpZCwgYXJndlswXSk7CgogICAgICBpZigocnVsZSA9IGxleGVyX3J1bGVfYXQobGV4LCBpZCkpKQogICAgICAgIHJldCA9IEpTX05ld1N0cmluZyhjdHgsIHJ1bGUtPm5hbWUpOwogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIE1FVEhPRF9HRVRfUlVMRTogewogICAgICBMZXhlclJ1bGUqIHJ1bGU7CgogICAgICBpZihKU19Jc1N0cmluZyhhcmd2WzBdKSkgewogICAgICAgIHNpemVfdCBsZW47CiAgICAgICAgY29uc3QgY2hhciogbmFtZSA9IEpTX1RvQ1N0cmluZ0xlbihjdHgsICZsZW4sIGFyZ3ZbMF0pOwogICAgICAgIGlmKCEocnVsZSA9IGxleGVyX3J1bGVfZmluZChsZXgsIG5hbWUpKSkKICAgICAgICAgIHJ1bGUgPSBsZXhlcl9maW5kX2RlZmluaXRpb24obGV4LCBuYW1lLCBsZW4pOwogICAgICAgIEpTX0ZyZWVDU3RyaW5nKGN0eCwgbmFtZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaW50MzJfdCBpZCA9IC0xOwogICAgICAgIEpTX1RvSW50MzIoY3R4LCAmaWQsIGFyZ3ZbMF0pOwogICAgICAgIHJ1bGUgPSBsZXhlcl9ydWxlX2F0KGxleCwgaWQpOwogICAgICB9CgogICAgICBpZihydWxlKSB7CiAgICAgICAgcmV0ID0ganNfbGV4ZXJfcnVsZV9uZXcoY3R4LCBsZXgsIHJ1bGUpOwogICAgICB9CgogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIE1FVEhPRF9FUlJPUjogewogICAgICBjb25zdCBjaGFyKiBtZXNzYWdlID0gSlNfVG9DU3RyaW5nKGN0eCwgYXJndlswXSk7CiAgICAgIGNoYXIqIGxvY2F0aW9uID0gbG9jYXRpb25fdG9zdHJpbmcoJmxleC0+bG9jLCBjdHgpOwoKICAgICAgcmV0ID0gSlNfVGhyb3dTeW50YXhFcnJvcihjdHgsICIlcyBhdCAlcyIsIG1lc3NhZ2UsIGxvY2F0aW9uKTsKCiAgICAgIEpTX0ZyZWVDU3RyaW5nKGN0eCwgbWVzc2FnZSk7CiAgICAgIGpzX2ZyZWUoY3R4LCBsb2NhdGlvbik7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgTUVUSE9EX1BVU0hfU1RBVEU6IHsKICAgICAgY29uc3QgY2hhciogc3RhdGUgPSBKU19Ub0NTdHJpbmcoY3R4LCBhcmd2WzBdKTsKICAgICAgaW50IGlkOwoKICAgICAgaWQgPSBsZXhlcl9zdGF0ZV9wdXNoKGxleCwgc3RhdGUpOwogICAgICAvLyBwcmludGYoIlslenVdIHB1c2hTdGF0ZSgnJXMnKVxuIiwgbGV4ZXJfc3RhdGVfZGVwdGgobGV4KSwgc3RhdGUpOwogICAgICByZXQgPSBKU19OZXdJbnQzMihjdHgsIGlkKTsKICAgICAgSlNfRnJlZUNTdHJpbmcoY3R4LCBzdGF0ZSk7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgTUVUSE9EX1BPUF9TVEFURTogewogICAgICBpbnQgaWQ7CiAgICAgIGlmKGxleGVyX3N0YXRlX2RlcHRoKGxleCkgPiAwKSB7CiAgICAgICAgaWQgPSBsZXhlcl9zdGF0ZV9wb3AobGV4KTsKICAgICAgICAvLyBwcmludGYoIlslenVdIHBvcFN0YXRlKCkgPSAnJXMnXG4iLCBsZXhlcl9zdGF0ZV9kZXB0aChsZXgpLAogICAgICAgIC8vIGxleGVyX3N0YXRlX25hbWUobGV4LCBpZCkpOwogICAgICAgIHJldCA9IEpTX05ld0ludDMyKGN0eCwgaWQpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldCA9IEpTX1Rocm93SW50ZXJuYWxFcnJvcihjdHgsICJsZXhlciAoJXMpIGRlcHRoICV6dSIsIGxleGVyX3N0YXRlX3RvcG5hbWUobGV4KSwgbGV4ZXJfc3RhdGVfZGVwdGgobGV4KSk7CiAgICAgIH0KCiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgTUVUSE9EX1RPUF9TVEFURTogewogICAgICBpbnQzMl90IGluZGV4ID0gMCwgaWQ7CiAgICAgIGlmKGFyZ2MgPiAwICYmIEpTX0lzTnVtYmVyKGFyZ3ZbMF0pKQogICAgICAgIEpTX1RvSW50MzIoY3R4LCAmaW5kZXgsIGFyZ3ZbMF0pOwoKICAgICAgaWYoKGlkID0gaW5kZXggPiAwID8gbGV4ZXJfc3RhdGVfdG9wKGxleCwgaW5kZXgpIDogbGV4LT5zdGF0ZSkgPj0gMCkKICAgICAgICByZXQgPSBKU19OZXdTdHJpbmcoY3R4LCBsZXhlcl9zdGF0ZV9uYW1lKGxleCwgaWQpKTsKICAgICAgYnJlYWs7CiAgICB9CiAgfQogIHJldHVybiByZXQ7Cn0KCmVudW0gewogIFBST1BfU0laRSA9IDAsCiAgUFJPUF9QT1MsCiAgUFJPUF9FT0YsCiAgUFJPUF9GSUxFTkFNRSwKICBQUk9QX0xPQywKICBQUk9QX1JVTEVOQU1FUywKICBQUk9QX1JVTEVTLAogIFBST1BfTU9ERSwKICBQUk9QX1NFUSwKICBQUk9QX0JZVEVfTEVOR1RILAogIFBST1BfQ0hBUl9MRU5HVEgsCiAgUFJPUF9TVEFURSwKICBQUk9QX1NUQVRFUywKICBQUk9QX1NUQVRFX0RFUFRILAogIFBST1BfU1RBVEVfU1RBQ0ssCiAgUFJPUF9TT1VSQ0UsCiAgUFJPUF9MRVhFTUUsCiAgUFJPUF9UT0tFTiwKfTsKCkpTVmFsdWUKanNfbGV4ZXJfZ2V0KEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBtYWdpYykgewogIExleGVyKiBsZXg7CiAgSlNWYWx1ZSByZXQgPSBKU19VTkRFRklORUQ7CgogIGlmKCEobGV4ID0ganNfbGV4ZXJfZGF0YTIoY3R4LCB0aGlzX3ZhbCkpKQogICAgcmV0dXJuIEpTX0VYQ0VQVElPTjsKCiAgc3dpdGNoKG1hZ2ljKSB7CiAgICBjYXNlIFBST1BfUE9TOiB7CiAgICAgIHJldCA9IEpTX05ld0ludDY0KGN0eCwgbGV4LT5wb3MpOwogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIFBST1BfU0laRTogewogICAgICByZXQgPSBKU19OZXdJbnQ2NChjdHgsIGxleC0+c2l6ZSk7CiAgICAgIGJyZWFrOwogICAgfQoKICAgICAgLyogICAgY2FzZSBQUk9QX1NUQVJUOiB7CiAgICAgICAgICAgIHJldCA9IEpTX05ld0ludDY0KGN0eCwgbGV4LT5zdGFydCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfSovCgogICAgY2FzZSBQUk9QX0VPRjogewogICAgICByZXQgPSBKU19OZXdCb29sKGN0eCwgaW5wdXRfYnVmZmVyX2VvZigmbGV4LT5pbnB1dCkpOwogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIFBST1BfRklMRU5BTUU6IHsKICAgICAgcmV0ID0gbGV4LT5sb2MuZmlsZSA+IC0xID8gSlNfQXRvbVRvVmFsdWUoY3R4LCBsZXgtPmxvYy5maWxlKSA6IEpTX1VOREVGSU5FRDsKICAgICAgYnJlYWs7CiAgICB9CgogICAgY2FzZSBQUk9QX0xPQzogewogICAgICBMb2NhdGlvbiogbG9jOwoKICAgICAgaWYoKGxvYyA9IGxvY2F0aW9uX25ldyhjdHgpKSkgewogICAgICAgIGxvY2F0aW9uX2NvcHkobG9jLCAmbGV4LT5sb2MsIGN0eCk7CiAgICAgICAgcmV0ID0ganNfbG9jYXRpb25fd3JhcChjdHgsIGxvYyk7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICB9CgogICAgY2FzZSBQUk9QX1JVTEVOQU1FUzogewogICAgICBMZXhlclJ1bGUqIHJ1bGU7CiAgICAgIHVpbnQzMl90IGkgPSAwOwogICAgICByZXQgPSBKU19OZXdBcnJheShjdHgpOwoKICAgICAgdmVjdG9yX2ZvcmVhY2hfdCgmbGV4LT5ydWxlcywgcnVsZSkgeyBKU19TZXRQcm9wZXJ0eVVpbnQzMihjdHgsIHJldCwgaSsrLCBKU19OZXdTdHJpbmcoY3R4LCBydWxlLT5uYW1lKSk7IH0KICAgICAgYnJlYWs7CiAgICB9CgogICAgY2FzZSBQUk9QX1JVTEVTOiB7CiAgICAgIExleGVyUnVsZSogcnVsZTsKICAgICAgdWludDMyX3QgaSA9IDA7CiAgICAgIHJldCA9IEpTX05ld09iamVjdChjdHgpOwoKICAgICAgdmVjdG9yX2ZvcmVhY2hfdCgmbGV4LT5ydWxlcywgcnVsZSkgewogICAgICAgIC8vIHByaW50ZigicnVsZSAjJSIgUFJJdTMyICIgJyVzJyAnJXMnXG4iLCBpLCBydWxlLT5uYW1lLCBydWxlLT5leHByKTsKICAgICAgICBKU19TZXRQcm9wZXJ0eVN0cihjdHgsIHJldCwgcnVsZS0+bmFtZSwgSlNfTmV3VWludDMyKGN0eCwgaSkpOwogICAgICAgIGkrKzsKICAgICAgfQogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIFBST1BfTU9ERTogewogICAgICByZXQgPSBKU19OZXdJbnQzMihjdHgsIGxleC0+bW9kZSk7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgUFJPUF9TRVE6IHsKICAgICAgcmV0ID0gSlNfTmV3SW50NjQoY3R4LCBsZXgtPnNlcSk7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgUFJPUF9CWVRFX0xFTkdUSDogewogICAgICByZXQgPSBKU19OZXdVaW50MzIoY3R4LCBsZXgtPmJ5dGVfbGVuZ3RoKTsKICAgICAgYnJlYWs7CiAgICB9CgogICAgY2FzZSBQUk9QX0NIQVJfTEVOR1RIOiB7CiAgICAgIHJldCA9IEpTX05ld1VpbnQzMihjdHgsIGxleGVyX2NoYXJsZW4obGV4KSk7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgUFJPUF9TVEFURTogewogICAgICByZXQgPSBKU19OZXdJbnQzMihjdHgsIGxleC0+c3RhdGUpOwogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIFBST1BfU1RBVEVTOiB7CiAgICAgIHNpemVfdCBpID0gMDsKICAgICAgcmV0ID0gSlNfTmV3QXJyYXkoY3R4KTsKICAgICAgZm9yKDs7KSB7CiAgICAgICAgY2hhciogbmFtZTsKICAgICAgICBpZigobmFtZSA9IGxleGVyX3N0YXRlX25hbWUobGV4LCBpKSkgPT0gMCkKICAgICAgICAgIGJyZWFrOwogICAgICAgIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgcmV0LCBpKyssIEpTX05ld1N0cmluZyhjdHgsIG5hbWUpKTsKICAgICAgfQogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIFBST1BfU1RBVEVfREVQVEg6IHsKICAgICAgcmV0ID0gSlNfTmV3VWludDMyKGN0eCwgbGV4ZXJfc3RhdGVfZGVwdGgobGV4KSk7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgUFJPUF9TVEFURV9TVEFDSzogewogICAgICBzaXplX3QgaSA9IDAsIG4gPSB2ZWN0b3Jfc2l6ZSgmbGV4LT5zdGF0ZV9zdGFjaywgc2l6ZW9mKGludDMyX3QpKTsKICAgICAgcmV0ID0gSlNfTmV3QXJyYXkoY3R4KTsKICAgICAgZm9yKDsgaSA8IG47IGkrKykgewogICAgICAgIGludDMyX3Qgc3RhdGUgPSAqKGludDMyX3QqKXZlY3Rvcl9hdCgmbGV4LT5zdGF0ZV9zdGFjaywgc2l6ZW9mKGludDMyX3QpLCBpKTsKICAgICAgICBjaGFyKiBuYW1lOwogICAgICAgIGlmKChuYW1lID0gbGV4ZXJfc3RhdGVfbmFtZShsZXgsIHN0YXRlKSkgPT0gMCkKICAgICAgICAgIGJyZWFrOwogICAgICAgIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgcmV0LCBpLCBKU19OZXdTdHJpbmcoY3R4LCBuYW1lKSk7CiAgICAgIH0KICAgICAgSlNfU2V0UHJvcGVydHlVaW50MzIoY3R4LCByZXQsIGksIEpTX05ld1N0cmluZyhjdHgsIGxleGVyX3N0YXRlX25hbWUobGV4LCBsZXgtPnN0YXRlKSkpOwogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIFBST1BfU09VUkNFOiB7CiAgICAgIHJldCA9IEpTX05ld1N0cmluZ0xlbihjdHgsIChjb25zdCBjaGFyKilsZXgtPmRhdGEsIGxleC0+c2l6ZSk7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBQUk9QX0xFWEVNRTogewogICAgICByZXQgPSBKU19OZXdTdHJpbmdMZW4oY3R4LCAoY29uc3QgY2hhciopbGV4LT5kYXRhICsgbGV4LT5wb3MsIGxleC0+Ynl0ZV9sZW5ndGgpOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgUFJPUF9UT0tFTjogewogICAgICBUb2tlbiogdG9rOwoKICAgICAgaWYobGV4LT50b2tlbl9pZCA8IDApCiAgICAgICAgcmV0ID0gSlNfTlVMTDsKICAgICAgZWxzZSBpZigodG9rID0gbGV4ZXJfdG9rZW4obGV4LCBsZXgtPnRva2VuX2lkLCBjdHgpKSkKICAgICAgICByZXQgPSBqc190b2tlbl93cmFwKGN0eCwgdG9rKTsKCiAgICAgIGJyZWFrOwogICAgfQogIH0KICByZXR1cm4gcmV0Owp9CgpKU1ZhbHVlCmpzX2xleGVyX3NldChKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsLCBKU1ZhbHVlQ29uc3QgdmFsdWUsIGludCBtYWdpYykgewogIExleGVyKiBsZXg7CgogIGlmKCEobGV4ID0ganNfbGV4ZXJfZGF0YTIoY3R4LCB0aGlzX3ZhbCkpKQogICAgcmV0dXJuIEpTX0VYQ0VQVElPTjsKCiAgc3dpdGNoKG1hZ2ljKSB7CiAgICBjYXNlIFBST1BfUE9TOiB7CiAgICAgIFRva2VuKiB0b2s7CgogICAgICBpZigodG9rID0ganNfdG9rZW5fZGF0YSh2YWx1ZSkpKSB7CiAgICAgICAgbGV4LT5wb3MgPSB0b2stPmxvYy0+Y2hhcl9vZmZzZXQ7CgogICAgICAgIGxvY2F0aW9uX3JlbGVhc2UoJmxleC0+bG9jLCBjdHgpOwogICAgICAgIGxvY2F0aW9uX2NvcHkoJmxleC0+bG9jLCB0b2stPmxvYywgY3R4KTsKICAgICAgICAvLyAgICAgICAgbGV4LT5sb2MgPSB0b2stPmxvYzsKICAgICAgfSAvKiBlbHNlIGlmKEpTX0lzTnVtYmVyKHZhbHVlKSkgewogICAgICAgICB1aW50NjRfdCBuZXdwb3MgPSBsZXgtPnBvczsKICAgICAgICAgSlNfVG9JbmRleChjdHgsICZuZXdwb3MsIHZhbHVlKTsKICAgICAgICAgbGV4LT5wb3MgPSBuZXdwb3M7CiAgICAgICB9ICovCiAgICAgIGVsc2UgewogICAgICAgIHJldHVybiBKU19UaHJvd1R5cGVFcnJvcihjdHgsICJsZXhlci5wb3MgbXVzdCBiZSBhIExvY2F0aW9uIG9iamVjdCIpOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgUFJPUF9CWVRFX0xFTkdUSDogewogICAgICBUb2tlbiogdG9rOwogICAgICBpZihKU19Jc051bWJlcih2YWx1ZSkpIHsKICAgICAgICBqc192YWx1ZV90b3NpemUoY3R4LCAmbGV4LT5ieXRlX2xlbmd0aCwgdmFsdWUpOwogICAgICB9IGVsc2UgaWYoKHRvayA9IGpzX3Rva2VuX2RhdGEodmFsdWUpKSkgewogICAgICAgIGxleC0+Ynl0ZV9sZW5ndGggPSB0b2stPmJ5dGVfbGVuZ3RoOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgUFJPUF9GSUxFTkFNRTogewogICAgICBpZihsZXgtPmxvYy5maWxlID4gLTEpCiAgICAgICAgSlNfRnJlZUF0b20oY3R4LCBsZXgtPmxvYy5maWxlKTsKICAgICAgbGV4LT5sb2MuZmlsZSA9IEpTX1ZhbHVlVG9BdG9tKGN0eCwgdmFsdWUpOwogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIFBST1BfTU9ERTogewogICAgICBpbnQzMl90IG07CiAgICAgIEpTX1RvSW50MzIoY3R4LCAmbSwgdmFsdWUpOwogICAgICBsZXgtPm1vZGUgPSBtOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgUFJPUF9TRVE6IHsKICAgICAgdWludDY0X3QgczsKICAgICAgSlNfVG9JbmRleChjdHgsICZzLCB2YWx1ZSk7CiAgICAgIGxleC0+c2VxID0gczsKICAgICAgYnJlYWs7CiAgICB9CiAgfQogIHJldHVybiBKU19VTkRFRklORUQ7Cn0KCkpTVmFsdWUKanNfbGV4ZXJfdG9rZW5zKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwpIHsKICBMZXhlciogbGV4OwogIExleGVyUnVsZSogcnVsZTsKICBpbnQgaSA9IDA7CiAgSlNWYWx1ZSByZXQgPSBKU19VTkRFRklORUQ7CgogIGlmKCEobGV4ID0ganNfbGV4ZXJfZGF0YTIoY3R4LCB0aGlzX3ZhbCkpKQogICAgcmV0dXJuIEpTX0VYQ0VQVElPTjsKCiAgcmV0ID0gSlNfTmV3QXJyYXkoY3R4KTsKCiAgdmVjdG9yX2ZvcmVhY2hfdCgmbGV4LT5ydWxlcywgcnVsZSkgewogICAgY29uc3QgY2hhciogbmFtZSA9IHJ1bGUtPm5hbWU7CgogICAgSlNfU2V0UHJvcGVydHlVaW50MzIoY3R4LCByZXQsIGkrKywgSlNfTmV3U3RyaW5nKGN0eCwgbmFtZSkpOwogIH0KICByZXR1cm4gcmV0Owp9CgpKU1ZhbHVlCmpzX2xleGVyX3N0YXRlcyhKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsKSB7CiAgTGV4ZXIqIGxleDsKICBjaGFyKiogY29uZDsKICB1aW50MzJfdCBpID0gMDsKICBKU1ZhbHVlIHJldCA9IEpTX1VOREVGSU5FRDsKCiAgaWYoIShsZXggPSBqc19sZXhlcl9kYXRhMihjdHgsIHRoaXNfdmFsKSkpCiAgICByZXR1cm4gSlNfRVhDRVBUSU9OOwoKICByZXQgPSBKU19OZXdBcnJheShjdHgpOwoKICB2ZWN0b3JfZm9yZWFjaF90KCZsZXgtPnN0YXRlcywgY29uZCkgeyBKU19TZXRQcm9wZXJ0eVVpbnQzMihjdHgsIHJldCwgaSsrLCBKU19OZXdTdHJpbmcoY3R4LCAqY29uZCkpOyB9CgogIHJldHVybiByZXQ7Cn0KCkpTVmFsdWUKanNfbGV4ZXJfc3RhdGVzdGFjayhKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsKSB7CiAgTGV4ZXIqIGxleDsKICBpbnQzMl90KiBzdGFjazsKICBzaXplX3Qgc2l6ZTsKICBKU1ZhbHVlIGN0b3IsIGJ1ZiwgcmV0ID0gSlNfVU5ERUZJTkVEOwoKICBpZighKGxleCA9IGpzX2xleGVyX2RhdGEyKGN0eCwgdGhpc192YWwpKSkKICAgIHJldHVybiBKU19FWENFUFRJT047CgogIHNpemUgPSB2ZWN0b3Jfc2l6ZSgmbGV4LT5zdGF0ZV9zdGFjaywgc2l6ZW9mKGludDMyX3QpKSArIDE7CiAgc3RhY2sgPSBqc19tYWxsb2NfcnQoSlNfR2V0UnVudGltZShjdHgpLCBzaXplb2YoaW50MzJfdCkgKiBzaXplKTsKCiAgbWVtY3B5KHN0YWNrLCB2ZWN0b3JfYmVnaW4oJmxleC0+c3RhdGVfc3RhY2spLCBzaXplb2YoaW50MzJfdCkgKiAoc2l6ZSAtIDEpKTsKCiAgc3RhY2tbc2l6ZSAtIDFdID0gbGV4LT5zdGF0ZTsKCiAgYnVmID0gSlNfTmV3QXJyYXlCdWZmZXIoY3R4LCAodm9pZCopc3RhY2ssIHNpemVvZihpbnQzMl90KSAqIHNpemUsIChKU0ZyZWVBcnJheUJ1ZmZlckRhdGFGdW5jKikmanNfZnJlZV9ydCwgc3RhY2ssIEZBTFNFKTsKCiAgY3RvciA9IGpzX2dsb2JhbF9nZXRfc3RyKGN0eCwgIkludDMyQXJyYXkiKTsKCiAgcmV0ID0gSlNfQ2FsbENvbnN0cnVjdG9yKGN0eCwgY3RvciwgMSwgJmJ1Zik7CgogIEpTX0ZyZWVWYWx1ZShjdHgsIGN0b3IpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIGJ1Zik7CgogIHJldHVybiByZXQ7Cn0KCkpTVmFsdWUKanNfbGV4ZXJfZXNjYXBlKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdLCBpbnQgbWFnaWMpIHsKICBJbnB1dEJ1ZmZlciBpbnB1dCA9IGpzX2lucHV0X2NoYXJzKGN0eCwgYXJndlswXSk7CiAgRHluQnVmIG91dHB1dDsKICBqc19kYnVmX2luaXQoY3R4LCAmb3V0cHV0KTsKCiAgbWFnaWMgPyBkYnVmX3B1dF91bmVzY2FwZWRfcHJlZCgmb3V0cHV0LCAoY29uc3QgY2hhciopaW5wdXQuZGF0YSwgaW5wdXQuc2l6ZSwgbGV4ZXJfdW5lc2NhcGVfcHJlZCkKICAgICAgICA6IGRidWZfcHV0X2VzY2FwZWRfcHJlZCgmb3V0cHV0LCAoY29uc3QgY2hhciopaW5wdXQuZGF0YSwgaW5wdXQuc2l6ZSwgbGV4ZXJfZXNjYXBlX3ByZWQpOwoKICByZXR1cm4gZGJ1Zl90b3N0cmluZ19mcmVlKCZvdXRwdXQsIGN0eCk7Cn0KCkpTVmFsdWUKanNfbGV4ZXJfdG9zdHJpbmcoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB0aGlzX3ZhbCwgaW50IGFyZ2MsIEpTVmFsdWVDb25zdCBhcmd2W10pIHsKICBKU1ZhbHVlIHJldCA9IEpTX1VOREVGSU5FRDsKCiAgaWYoanNfaXNfcmVnZXhwKGN0eCwgYXJndlswXSkgfHwgSlNfSXNTdHJpbmcoYXJndlswXSkpIHsKICAgIFJlZ0V4cCByZTsKICAgIHJlID0gcmVnZXhwX2Zyb21fYXJndihhcmdjLCBhcmd2LCBjdHgpOwogICAgcmV0ID0gSlNfTmV3U3RyaW5nKGN0eCwgcmUuc291cmNlKTsKICB9IGVsc2UgewogICAgSW5wdXRCdWZmZXIgaW5wdXQ7CiAgICBpbnB1dCA9IGpzX2lucHV0X2NoYXJzKGN0eCwgYXJndlswXSk7CiAgICByZXQgPSBKU19OZXdTdHJpbmdMZW4oY3R4LCAoY29uc3QgY2hhciopaW5wdXQuZGF0YSwgaW5wdXQuc2l6ZSk7CiAgICBpbnB1dF9idWZmZXJfZnJlZSgmaW5wdXQsIGN0eCk7CiAgfQogIHJldHVybiByZXQ7Cn0KCkpTVmFsdWUKanNfbGV4ZXJfbGV4KEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdKSB7CiAgSlNWYWx1ZSByZXQgPSBKU19VTkRFRklORUQ7CiAgTGV4ZXIqIGxleDsKICBpbnQgaWQsIHN0YXRlID0gLTE7CgogIGlmKCEobGV4ID0ganNfbGV4ZXJfZGF0YTIoY3R4LCB0aGlzX3ZhbCkpKQogICAgcmV0dXJuIEpTX0VYQ0VQVElPTjsKCiAgaWYoYXJnYyA+IDAgJiYgSlNfSXNTdHJpbmcoYXJndlswXSkpIHsKICAgIGNvbnN0IGNoYXIqIG5hbWUgPSBKU19Ub0NTdHJpbmcoY3R4LCBhcmd2WzBdKTsKICAgIHN0YXRlID0gbGV4ZXJfc3RhdGVfcHVzaChsZXgsIG5hbWUpOwogICAgSlNfRnJlZUNTdHJpbmcoY3R4LCBuYW1lKTsKICB9CgogIGlkID0gbGV4ZXJfbGV4KGxleCwgY3R4LCB0aGlzX3ZhbCwgYXJnYywgYXJndik7CgogIGlmKHN0YXRlID4gLTEpCiAgICBsZXhlcl9zdGF0ZV9wb3AobGV4KTsKCiAgc3dpdGNoKGlkKSB7CiAgICBjYXNlIExFWEVSX0VSUk9SX05PTUFUQ0g6IHsKICAgICAgY2hhciogbGV4ZW1lID0gbGV4ZXJfbGV4ZW1lX3MobGV4LCBjdHgpOwogICAgICBjaGFyKiBmaWxlID0gbG9jYXRpb25fZmlsZSgmbGV4LT5sb2MsIGN0eCk7CgogICAgICByZXQgPSBKU19UaHJvd0ludGVybmFsRXJyb3IoY3R4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiVzOiUiIFBSSXUzMiAiOiUiIFBSSXUzMiAiOiBObyBtYXRjaGluZyB0b2tlbiAoJWQ6ICVzKVxuJS4qc1xuJSpzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXgtPmxvYy5saW5lICsgMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxleC0+bG9jLmNvbHVtbiArIDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXhlcl9zdGF0ZV90b3AobGV4LCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxleGVyX3N0YXRlX25hbWUobGV4LCBsZXhlcl9zdGF0ZV90b3AobGV4LCAwKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiAgIGxleGVtZSwqLwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGludCkoYnl0ZV9jaHIoKGNvbnN0IGNoYXIqKSZsZXgtPmRhdGFbbGV4LT5wb3NdLCBsZXgtPnNpemUgLSBsZXgtPnBvcywgJ1xuJykgKyBsZXgtPmxvYy5jb2x1bW4pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmxleC0+ZGF0YVtsZXgtPnBvcyAtIGxleC0+bG9jLmNvbHVtbl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXgtPmxvYy5jb2x1bW4gKyAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl4iKTsKICAgICAgaWYoZmlsZSkKICAgICAgICBqc19mcmVlKGN0eCwgZmlsZSk7CiAgICAgIGpzX2ZyZWUoY3R4LCBsZXhlbWUpOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgTEVYRVJfRU9GOiB7CiAgICAgIHJldCA9IEpTX05VTEw7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBMRVhFUl9FWENFUFRJT046IHsKICAgICAgcmV0ID0gSlNfRVhDRVBUSU9OOwogICAgICBicmVhazsKICAgIH0KICAgIGRlZmF1bHQ6IHsKICAgICAgcmV0ID0gSlNfTmV3SW50MzIoY3R4LCBpZCk7CiAgICAgIGJyZWFrOwogICAgfQogIH0KCiAgcmV0dXJuIHJldDsKfQoKZW51bSB7CiAgWUlFTERfSUQgPSAwLAogIFlJRUxEX09CSiA9IDEsCiAgWUlFTERfRE9ORV9WQUxVRSA9IDIsCn07CgpKU1ZhbHVlCmpzX2xleGVyX25leHRmbihKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsLCBpbnQgYXJnYywgSlNWYWx1ZUNvbnN0IGFyZ3ZbXSwgaW50IG1hZ2ljKSB7CiAgSlNWYWx1ZSByZXQsIHZhbHVlID0gSlNfVU5ERUZJTkVEOwogIExleGVyKiBsZXg7CgogIGlmKCEobGV4ID0ganNfbGV4ZXJfZGF0YTIoY3R4LCB0aGlzX3ZhbCkpKQogICAgcmV0dXJuIEpTX0VYQ0VQVElPTjsKCiAgcmV0ID0ganNfbGV4ZXJfbGV4KGN0eCwgdGhpc192YWwsIGFyZ2MsIGFyZ3YpOwoKICBpZihKU19Jc051bWJlcihyZXQpKSB7CiAgICBpbnQzMl90IGlkOwoKICAgIEpTX1RvSW50MzIoY3R4LCAmaWQsIHJldCk7CgogICAgaWYobWFnaWMgJiBZSUVMRF9PQkopIHsKICAgICAgVG9rZW4qIHRvayA9IGxleGVyX3Rva2VuKGxleCwgaWQsIGN0eCk7CiAgICAgIHZhbHVlID0ganNfdG9rZW5fd3JhcChjdHgsIHRvayk7CiAgICB9IGVsc2UgewogICAgICB2YWx1ZSA9IEpTX05ld0ludDMyKGN0eCwgaWQpOwogICAgfQogIH0gZWxzZSB7CiAgICB2YWx1ZSA9IEpTX0R1cFZhbHVlKGN0eCwgcmV0KTsKICB9CiAgSlNfRnJlZVZhbHVlKGN0eCwgcmV0KTsKCiAgaWYobWFnaWMgJiBZSUVMRF9ET05FX1ZBTFVFKSB7CiAgICBKU1ZhbHVlIHJldCA9IEpTX05ld09iamVjdChjdHgpOwogICAgSlNfU2V0UHJvcGVydHlTdHIoY3R4LCByZXQsICJ2YWx1ZSIsIHZhbHVlKTsKICAgIEpTX1NldFByb3BlcnR5U3RyKGN0eCwgcmV0LCAiZG9uZSIsIEpTX05ld0Jvb2woY3R4LCBKU19Jc1VuZGVmaW5lZCh2YWx1ZSkpKTsKICAgIHJldHVybiByZXQ7CiAgfQoKICByZXR1cm4gdmFsdWU7Cn0KCkpTVmFsdWUKanNfbGV4ZXJfbmV4dChKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsLCBpbnQgYXJnYywgSlNWYWx1ZUNvbnN0IGFyZ3ZbXSwgQk9PTCogcGRvbmUsIGludCBtYWdpYykgewogIEpTVmFsdWUgcmV0ID0ganNfbGV4ZXJfbmV4dGZuKGN0eCwgdGhpc192YWwsIGFyZ2MsIGFyZ3YsIG1hZ2ljKTsKCiAgKnBkb25lID0gSlNfSXNVbmRlZmluZWQocmV0KTsKCiAgcmV0dXJuIHJldDsKfQoKSlNWYWx1ZQpqc19sZXhlcl9jYWxsKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgZnVuY19vYmosIEpTVmFsdWVDb25zdCB0aGlzX3ZhbCwgaW50IGFyZ2MsIEpTVmFsdWVDb25zdCBhcmd2W10sIGludCBmbGFncykgewogIExleGVyKiBsZXg7CiAgaW50MzJfdCByZXN1bHQ7CiAgSlNWYWx1ZSByZXQgPSBKU19VTkRFRklORUQ7CiAgSlNWYWx1ZUNvbnN0IGFyZyA9IGFyZ2MgPiAwID8gYXJndlswXSA6IEpTX1VOREVGSU5FRDsKCiAgaWYoIShsZXggPSBKU19HZXRPcGFxdWUyKGN0eCwgZnVuY19vYmosIGpzX2xleGVyX2NsYXNzX2lkKSkpCiAgICByZXR1cm4gSlNfRVhDRVBUSU9OOwoKICBpZihhcmdjID4gMCAmJiBKU19Jc051bWJlcihhcmd2WzBdKSkgewogICAgSlNfU2V0UHJvcGVydHlTdHIoY3R4LCBmdW5jX29iaiwgIm1hc2siLCBKU19EdXBWYWx1ZShjdHgsIGFyZ3ZbMF0pKTsKICB9CgogIC8qaWYoYXJnYyA+IDEgJiYgSlNfSXNOdW1iZXIoYXJndlsxXSkpIHsKICAgIEpTX1NldFByb3BlcnR5U3RyKGN0eCwgZnVuY19vYmosICJza2lwIiwgSlNfRHVwVmFsdWUoY3R4LCBhcmd2WzFdKSk7CiAgfSovCgogIHJldHVybiBKU19EdXBWYWx1ZShjdHgsIGZ1bmNfb2JqKTsKfQoKSlNWYWx1ZQpqc19sZXhlcl9pdGVyYXRvcihKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsLCBpbnQgYXJnYywgSlNWYWx1ZUNvbnN0IGFyZ3ZbXSkgewogIEpTVmFsdWUgbmV4dCwgcmV0ID0gSlNfTmV3T2JqZWN0KGN0eCk7CgogIG5leHQgPSBKU19OZXdDRnVuY3Rpb24yKGN0eCwgKEpTQ0Z1bmN0aW9uKikmanNfbGV4ZXJfbmV4dGZuLCAibmV4dCIsIDAsIEpTX0NGVU5DX2dlbmVyaWNfbWFnaWMsIFlJRUxEX0lEIHwgWUlFTERfRE9ORV9WQUxVRSk7CgogIEpTX1NldFByb3BlcnR5U3RyKGN0eCwgcmV0LCAibmV4dCIsIGpzX2Z1bmN0aW9uX2JpbmRfdGhpcyhjdHgsIG5leHQsIHRoaXNfdmFsKSk7CiAgcmV0dXJuIHJldDsKCiAgcmV0dXJuIEpTX0R1cFZhbHVlKGN0eCwgdGhpc192YWwpOwp9CgpzdGF0aWMgSlNWYWx1ZQpqc19sZXhlcl9pbnNwZWN0KEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdKSB7CiAgTGV4ZXIqIGxleDsKCiAgaWYoIShsZXggPSBqc19sZXhlcl9kYXRhMihjdHgsIHRoaXNfdmFsKSkpCiAgICByZXR1cm4gSlNfRVhDRVBUSU9OOwoKICBKU1ZhbHVlIG9iaiA9IEpTX05ld09iamVjdENsYXNzKGN0eCwganNfbGV4ZXJfY2xhc3NfaWQpOwoKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAiYnl0ZWxlbiIsIEpTX05ld1VpbnQzMihjdHgsIGxleC0+Ynl0ZV9sZW5ndGgpLCBKU19QUk9QX0VOVU1FUkFCTEUpOwogIEpTX0RlZmluZVByb3BlcnR5VmFsdWVTdHIoY3R4LCBvYmosICJ0b2tpZCIsIEpTX05ld0ludDMyKGN0eCwgbGV4LT50b2tlbl9pZCksIEpTX1BST1BfRU5VTUVSQUJMRSk7CiAgSlNfRGVmaW5lUHJvcGVydHlWYWx1ZVN0cihjdHgsIG9iaiwgInN0YXRlIiwgSlNfTmV3SW50MzIoY3R4LCBsZXgtPnN0YXRlKSwgSlNfUFJPUF9FTlVNRVJBQkxFKTsKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAiZW9mIiwgSlNfTmV3Qm9vbChjdHgsIGlucHV0X2J1ZmZlcl9lb2YoJmxleC0+aW5wdXQpKSwgSlNfUFJPUF9FTlVNRVJBQkxFKTsKICAvLyBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAibG9jIiwganNfbG9jYXRpb25fbmV3KGN0eCwgJmxleC0+bG9jKSwgSlNfUFJPUF9FTlVNRVJBQkxFKTsKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAicG9zIiwgSlNfTmV3VWludDMyKGN0eCwgbGV4LT5wb3MpLCBKU19QUk9QX0VOVU1FUkFCTEUpOwogIEpTX0RlZmluZVByb3BlcnR5VmFsdWVTdHIoY3R4LCBvYmosICJzaXplIiwgSlNfTmV3VWludDMyKGN0eCwgbGV4LT5zaXplKSwgSlNfUFJPUF9FTlVNRVJBQkxFKTsKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAic2VxIiwgSlNfTmV3SW50NjQoY3R4LCBsZXgtPnNlcSksIEpTX1BST1BfRU5VTUVSQUJMRSk7CgogIHJldHVybiBvYmo7Cn0KCnZvaWQKanNfbGV4ZXJfZmluYWxpemVyKEpTUnVudGltZSogcnQsIEpTVmFsdWUgdmFsKSB7CiAgTGV4ZXIqIGxleDsKCiAgaWYoKGxleCA9IEpTX0dldE9wYXF1ZSh2YWwsIGpzX2xleGVyX2NsYXNzX2lkKSkpIHsKICAgIGlmKC0tbGV4LT5yZWZfY291bnQgPT0gMCkKICAgICAgbG9jYXRpb25fcmVsZWFzZV9ydCgmbGV4LT5sb2MsIHJ0KTsKICAgIGxleGVyX3JlbGVhc2VfcnQobGV4LCBydCk7CgogICAgaWYobGV4LT5yZWZfY291bnQgPT0gMCkKICAgICAganNfZnJlZV9ydChydCwgbGV4KTsKICB9CiAgLy8gSlNfRnJlZVZhbHVlUlQocnQsIHZhbCk7Cn0KCnN0YXRpYyBKU0NsYXNzRGVmIGpzX2xleGVyX2NsYXNzID0gewogICAgLmNsYXNzX25hbWUgPSAiTGV4ZXIiLAogICAgLmZpbmFsaXplciA9IGpzX2xleGVyX2ZpbmFsaXplciwKICAgIC5jYWxsID0ganNfbGV4ZXJfY2FsbCwKfTsKCnN0YXRpYyBjb25zdCBKU0NGdW5jdGlvbkxpc3RFbnRyeSBqc19sZXhlcl9wcm90b19mdW5jc1tdID0gewogICAgLy8gSlNfSVRFUkFUT1JfTkVYVF9ERUYoIm5leHQiLCAwLCBqc19sZXhlcl9uZXh0LCBZSUVMRF9PQkopLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJuZXh0IiwgMCwganNfbGV4ZXJfbmV4dGZuLCBZSUVMRF9JRCksCiAgICBKU19DRlVOQ19NQUdJQ19ERUYoIm5leHRUb2tlbiIsIDAsIGpzX2xleGVyX25leHRmbiwgWUlFTERfT0JKKSwKICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJzaXplIiwganNfbGV4ZXJfZ2V0LCBqc19sZXhlcl9zZXQsIFBST1BfU0laRSksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigicG9zIiwganNfbGV4ZXJfZ2V0LCBqc19sZXhlcl9zZXQsIFBST1BfUE9TKSwKICAgIC8vIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJzdGFydCIsIGpzX2xleGVyX2dldCwgMCwgUFJPUF9TVEFSVCksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigibG9jIiwganNfbGV4ZXJfZ2V0LCAwLCBQUk9QX0xPQyksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigiZW9mIiwganNfbGV4ZXJfZ2V0LCAwLCBQUk9QX0VPRiksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigibW9kZSIsIGpzX2xleGVyX2dldCwganNfbGV4ZXJfc2V0LCBQUk9QX01PREUpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoInNlcSIsIGpzX2xleGVyX2dldCwganNfbGV4ZXJfc2V0LCBQUk9QX1NFUSksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigiYnl0ZUxlbmd0aCIsIGpzX2xleGVyX2dldCwgMCwgUFJPUF9CWVRFX0xFTkdUSCksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigiY2hhckxlbmd0aCIsIGpzX2xleGVyX2dldCwgMCwgUFJPUF9DSEFSX0xFTkdUSCksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigic3RhdGUiLCBqc19sZXhlcl9nZXQsIDAsIFBST1BfU1RBVEUpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoInN0YXRlcyIsIGpzX2xleGVyX2dldCwgMCwgUFJPUF9TVEFURVMpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoInN0YXRlRGVwdGgiLCBqc19sZXhlcl9nZXQsIDAsIFBST1BfU1RBVEVfREVQVEgpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoInN0YXRlU3RhY2siLCBqc19sZXhlcl9nZXQsIDAsIFBST1BfU1RBVEVfU1RBQ0spLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoInNvdXJjZSIsIGpzX2xleGVyX2dldCwgMCwgUFJPUF9TT1VSQ0UpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoImxleGVtZSIsIGpzX2xleGVyX2dldCwgMCwgUFJPUF9MRVhFTUUpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoInRva2VuIiwganNfbGV4ZXJfZ2V0LCAwLCBQUk9QX1RPS0VOKSwKICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJmaWxlTmFtZSIsIGpzX2xleGVyX2dldCwganNfbGV4ZXJfc2V0LCBQUk9QX0ZJTEVOQU1FKSwKICAgIEpTX0NGVU5DX01BR0lDX0RFRigic2V0SW5wdXQiLCAxLCBqc19sZXhlcl9tZXRob2QsIE1FVEhPRF9TRVRfSU5QVVQpLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJza2lwQnl0ZXMiLCAwLCBqc19sZXhlcl9tZXRob2QsIE1FVEhPRF9TS0lQX0JZVEVTKSwKICAgIEpTX0NGVU5DX01BR0lDX0RFRigic2tpcFRva2VuIiwgMCwganNfbGV4ZXJfbWV0aG9kLCBNRVRIT0RfU0tJUF9UT0tFTiksCiAgICBKU19DRlVOQ19NQUdJQ19ERUYoInNraXBDaGFycyIsIDAsIGpzX2xleGVyX21ldGhvZCwgTUVUSE9EX1NLSVBfQ0hBUlMpLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJza2lwVW50aWwiLCAxLCBqc19sZXhlcl9tZXRob2QsIE1FVEhPRF9TS0lQX1VOVElMKSwKICAgIEpTX0NGVU5DX01BR0lDX0RFRigidG9rZW5DbGFzcyIsIDEsIGpzX2xleGVyX21ldGhvZCwgTUVUSE9EX1RPS0VOX0NMQVNTKSwKICAgIEpTX0NGVU5DX01BR0lDX0RFRigiZGVmaW5lIiwgMiwganNfbGV4ZXJfYWRkX3J1bGUsIDApLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJhZGRSdWxlIiwgMiwganNfbGV4ZXJfYWRkX3J1bGUsIDEpLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJnZXRSdWxlIiwgMSwganNfbGV4ZXJfbWV0aG9kLCBNRVRIT0RfR0VUX1JVTEUpLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJwdXNoU3RhdGUiLCAxLCBqc19sZXhlcl9tZXRob2QsIE1FVEhPRF9QVVNIX1NUQVRFKSwKICAgIEpTX0FMSUFTX0RFRigiYmVnaW4iLCAicHVzaFN0YXRlIiksCiAgICBKU19DRlVOQ19NQUdJQ19ERUYoInBvcFN0YXRlIiwgMCwganNfbGV4ZXJfbWV0aG9kLCBNRVRIT0RfUE9QX1NUQVRFKSwKICAgIEpTX0NGVU5DX01BR0lDX0RFRigidG9wU3RhdGUiLCAwLCBqc19sZXhlcl9tZXRob2QsIE1FVEhPRF9UT1BfU1RBVEUpLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJjdXJyZW50TGluZSIsIDAsIGpzX2xleGVyX21ldGhvZCwgTUVUSE9EX0NVUlJFTlRfTElORSksCiAgICBKU19DRlVOQ19NQUdJQ19ERUYoImJhY2siLCAwLCBqc19sZXhlcl9tZXRob2QsIE1FVEhPRF9CQUNLKSwKICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJydWxlTmFtZXMiLCBqc19sZXhlcl9nZXQsIDAsIFBST1BfUlVMRU5BTUVTKSwKICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJydWxlcyIsIGpzX2xleGVyX2dldCwgMCwgUFJPUF9SVUxFUyksCiAgICBKU19DRlVOQ19ERUYoImxleCIsIDAsIGpzX2xleGVyX2xleCksCiAgICBKU19DRlVOQ19ERUYoImluc3BlY3QiLCAwLCBqc19sZXhlcl9pbnNwZWN0KSwKICAgIEpTX0NHRVRTRVRfREVGKCJ0b2tlbnMiLCBqc19sZXhlcl90b2tlbnMsIDApLAogICAgSlNfQ0dFVFNFVF9ERUYoInN0YXRlcyIsIGpzX2xleGVyX3N0YXRlcywgMCksCiAgICAvLyBKU19DR0VUU0VUX0RFRigic3RhdGVTdGFjayIsIGpzX2xleGVyX3N0YXRlc3RhY2ssIDApLAogICAgLy8gSlNfQUxJQVNfREVGKCJwb3NpdGlvbiIsICJsb2MiKSwKICAgIEpTX0NGVU5DX0RFRigiW1N5bWJvbC5pdGVyYXRvcl0iLCAwLCBqc19sZXhlcl9pdGVyYXRvciksCiAgICBKU19QUk9QX1NUUklOR19ERUYoIltTeW1ib2wudG9TdHJpbmdUYWddIiwgIkxleGVyIiwgSlNfUFJPUF9DT05GSUdVUkFCTEUpLAp9OwoKc3RhdGljIGNvbnN0IEpTQ0Z1bmN0aW9uTGlzdEVudHJ5IGpzX2xleGVyX3N0YXRpY19mdW5jc1tdID0gewogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJlc2NhcGUiLCAxLCBqc19sZXhlcl9lc2NhcGUsIDApLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJ1bmVzY2FwZSIsIDEsIGpzX2xleGVyX2VzY2FwZSwgMSksCiAgICBKU19DRlVOQ19ERUYoInRvU3RyaW5nIiwgMSwganNfbGV4ZXJfdG9zdHJpbmcpLAogICAgSlNfUFJPUF9JTlQzMl9ERUYoIkZJUlNUIiwgTEVYRVJfRklSU1QsIEpTX1BST1BfRU5VTUVSQUJMRSksCiAgICBKU19QUk9QX0lOVDMyX0RFRigiTE9OR0VTVCIsIExFWEVSX0xPTkdFU1QsIEpTX1BST1BfRU5VTUVSQUJMRSksCiAgICBKU19QUk9QX0lOVDMyX0RFRigiTEFTVCIsIExFWEVSX0xBU1QsIEpTX1BST1BfRU5VTUVSQUJMRSksCiAgICBKU19QUk9QX0lOVDMyX0RFRigiWUlFTERfSUQiLCBZSUVMRF9JRCwgSlNfUFJPUF9FTlVNRVJBQkxFKSwKICAgIEpTX1BST1BfSU5UMzJfREVGKCJZSUVMRF9PQkoiLCBZSUVMRF9PQkosIEpTX1BST1BfRU5VTUVSQUJMRSksCn07CgppbnQKanNfbGV4ZXJfaW5pdChKU0NvbnRleHQqIGN0eCwgSlNNb2R1bGVEZWYqIG0pIHsKCiAganNfbG9jYXRpb25faW5pdChjdHgsIG0pOwoKICBKU19OZXdDbGFzc0lEKCZqc190b2tlbl9jbGFzc19pZCk7CiAgSlNfTmV3Q2xhc3MoSlNfR2V0UnVudGltZShjdHgpLCBqc190b2tlbl9jbGFzc19pZCwgJmpzX3Rva2VuX2NsYXNzKTsKCiAgdG9rZW5fcHJvdG8gPSBKU19OZXdPYmplY3QoY3R4KTsKICBKU19TZXRQcm9wZXJ0eUZ1bmN0aW9uTGlzdChjdHgsIHRva2VuX3Byb3RvLCBqc190b2tlbl9wcm90b19mdW5jcywgY291bnRvZihqc190b2tlbl9wcm90b19mdW5jcykpOwogIEpTX1NldENsYXNzUHJvdG8oY3R4LCBqc190b2tlbl9jbGFzc19pZCwgdG9rZW5fcHJvdG8pOwoKICB0b2tlbl9jdG9yID0gSlNfTmV3Q0Z1bmN0aW9uMihjdHgsIGpzX3Rva2VuX2NvbnN0cnVjdG9yLCAiVG9rZW4iLCAxLCBKU19DRlVOQ19jb25zdHJ1Y3RvciwgMCk7CgogIEpTX1NldENvbnN0cnVjdG9yKGN0eCwgdG9rZW5fY3RvciwgdG9rZW5fcHJvdG8pOwogIEpTX1NldFByb3BlcnR5RnVuY3Rpb25MaXN0KGN0eCwgdG9rZW5fY3RvciwganNfdG9rZW5fc3RhdGljX2Z1bmNzLCBjb3VudG9mKGpzX3Rva2VuX3N0YXRpY19mdW5jcykpOwoKICBqc19zZXRfaW5zcGVjdF9tZXRob2QoY3R4LCB0b2tlbl9wcm90bywganNfdG9rZW5faW5zcGVjdCk7CgogIEpTX05ld0NsYXNzSUQoJmpzX2xleGVyX2NsYXNzX2lkKTsKICBKU19OZXdDbGFzcyhKU19HZXRSdW50aW1lKGN0eCksIGpzX2xleGVyX2NsYXNzX2lkLCAmanNfbGV4ZXJfY2xhc3MpOwoKICBsZXhlcl9wcm90byA9IEpTX05ld09iamVjdChjdHgpOwogIEpTX1NldFByb3BlcnR5RnVuY3Rpb25MaXN0KGN0eCwgbGV4ZXJfcHJvdG8sIGpzX2xleGVyX3Byb3RvX2Z1bmNzLCBjb3VudG9mKGpzX2xleGVyX3Byb3RvX2Z1bmNzKSk7CiAgSlNfU2V0Q2xhc3NQcm90byhjdHgsIGpzX2xleGVyX2NsYXNzX2lkLCBsZXhlcl9wcm90byk7CgogIGpzX3NldF9pbnNwZWN0X21ldGhvZChjdHgsIGxleGVyX3Byb3RvLCBqc19sZXhlcl9pbnNwZWN0KTsKCiAgbGV4ZXJfY3RvciA9IEpTX05ld0NGdW5jdGlvbjIoY3R4LCBqc19sZXhlcl9jb25zdHJ1Y3RvciwgIkxleGVyIiwgMSwgSlNfQ0ZVTkNfY29uc3RydWN0b3IsIDApOwoKICBKU19TZXRDb25zdHJ1Y3RvcihjdHgsIGxleGVyX2N0b3IsIGxleGVyX3Byb3RvKTsKICBKU19TZXRQcm9wZXJ0eUZ1bmN0aW9uTGlzdChjdHgsIGxleGVyX2N0b3IsIGpzX2xleGVyX3N0YXRpY19mdW5jcywgY291bnRvZihqc19sZXhlcl9zdGF0aWNfZnVuY3MpKTsKCiAgaWYobSkgewogICAgSlNfU2V0TW9kdWxlRXhwb3J0KGN0eCwgbSwgIlRva2VuIiwgdG9rZW5fY3Rvcik7CiAgICBKU19TZXRNb2R1bGVFeHBvcnQoY3R4LCBtLCAiTGV4ZXIiLCBsZXhlcl9jdG9yKTsKICB9CgogIHJldHVybiAwOwp9CgojaWZkZWYgSlNfU0hBUkVEX0xJQlJBUlkKI2RlZmluZSBKU19JTklUX01PRFVMRSBqc19pbml0X21vZHVsZQojZWxzZQojZGVmaW5lIEpTX0lOSVRfTU9EVUxFIGpzX2luaXRfbW9kdWxlX2xleGVyCiNlbmRpZgoKVklTSUJMRSBKU01vZHVsZURlZioKSlNfSU5JVF9NT0RVTEUoSlNDb250ZXh0KiBjdHgsIGNvbnN0IGNoYXIqIG1vZHVsZV9uYW1lKSB7CiAgSlNNb2R1bGVEZWYqIG07CiAgaWYoIShtID0gSlNfTmV3Q01vZHVsZShjdHgsIG1vZHVsZV9uYW1lLCAmanNfbGV4ZXJfaW5pdCkpKQogICAgcmV0dXJuIG07CgogIEpTX0FkZE1vZHVsZUV4cG9ydChjdHgsIG0sICJMb2NhdGlvbiIpOwogIEpTX0FkZE1vZHVsZUV4cG9ydChjdHgsIG0sICJUb2tlbiIpOwogIEpTX0FkZE1vZHVsZUV4cG9ydChjdHgsIG0sICJMZXhlciIpOwogIHJldHVybiBtOwp9CgovKioKICogQH0KICovCgAAAAAAAAAACqsAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAiz8AAAAAAACTPwAAAAAAAAAAAAAAAPC/"
				],
				[
					194,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAAAKqwAAI2luY2x1ZGUgImRlZmluZXMuaCIKI2luY2x1ZGUgPHF1aWNranMuaD4KI2luY2x1ZGUgPGxpYnJlZ2V4cC5oPgojaW5jbHVkZSAicXVpY2tqcy1sZXhlci5oIgojaW5jbHVkZSAicXVpY2tqcy1sb2NhdGlvbi5oIgojaW5jbHVkZSAidmVjdG9yLmgiCiNpbmNsdWRlIDxzdHJpbmcuaD4KI2luY2x1ZGUgPGN0eXBlLmg+CiNpbmNsdWRlIDxzdGRpbnQuaD4KI2luY2x1ZGUgImJ1ZmZlci11dGlscy5oIgojaW5jbHVkZSAiZGVidWcuaCIKI2luY2x1ZGUgInRva2VuLmgiCgovKioKICogXGFkZHRvZ3JvdXAgcXVpY2tqcy1sZXhlcgogKiBAewogKi8KdHlwZWRlZiBzdHJ1Y3QgewogIEpTVmFsdWUgYWN0aW9uOwogIEJPT0wgc2tpcDsKfSBKU0xleGVyUnVsZTsKCnRocmVhZF9sb2NhbCBWSVNJQkxFIEpTQ2xhc3NJRCBqc190b2tlbl9jbGFzc19pZCA9IDAsIGpzX2xleGVyX2NsYXNzX2lkID0gMDsKdGhyZWFkX2xvY2FsIEpTVmFsdWUgdG9rZW5fcHJvdG8gPSB7e0pTX1RBR19VTkRFRklORUR9fSwgdG9rZW5fY3RvciA9IHt7SlNfVEFHX1VOREVGSU5FRH19Owp0aHJlYWRfbG9jYWwgSlNWYWx1ZSBsZXhlcl9wcm90byA9IHt7SlNfVEFHX1VOREVGSU5FRH19LCBsZXhlcl9jdG9yID0ge3tKU19UQUdfVU5ERUZJTkVEfX07CgpzdGF0aWMgSlNWYWx1ZQpvZmZzZXRfdG9hcnJheShPZmZzZXRMZW5ndGggb2Zmc19sZW4sIEpTQ29udGV4dCogY3R4KSB7CiAgSlNWYWx1ZSByZXQgPSBKU19OZXdBcnJheShjdHgpOwogIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgcmV0LCAwLCBKU19OZXdJbnQ2NChjdHgsIG9mZnNfbGVuLm9mZnNldCkpOwogIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgcmV0LCAxLCBKU19OZXdJbnQ2NChjdHgsIG9mZnNfbGVuLm9mZnNldCArIG9mZnNfbGVuLmxlbmd0aCkpOwogIHJldHVybiByZXQ7Cn0KCnN0YXRpYyBKU1ZhbHVlCmpzX2xleGVyX3J1bGVfbmV3KEpTQ29udGV4dCogY3R4LCBMZXhlciogbGV4LCBMZXhlclJ1bGUqIHJ1bGUpIHsKICBKU1ZhbHVlIHJldCwgc3RhdGVzOwogIER5bkJ1ZiBkYnVmOwogIHNpemVfdCBpLCBqOwogIGpzX2RidWZfaW5pdChjdHgsICZkYnVmKTsKICBsZXhlcl9ydWxlX2R1bXAobGV4LCBydWxlLCAmZGJ1Zik7CiAgZGJ1Zl8wKCZkYnVmKTsKCiAgaWYocnVsZS0+ZXhwclswXSA9PSAnPCcpIHsKICAgIGFzc2VydCghc3RybmNtcChydWxlLT5leHByLCAoY29uc3QgY2hhciopZGJ1Zi5idWYsIHN0cl9jaHIocnVsZS0+ZXhwciwgJz4nKSkpOwogIH0KCiAgcmV0ID0gSlNfTmV3QXJyYXkoY3R4KTsKICBqc19zZXRfcHJvcGVydHlpbnRfc3RyaW5nKGN0eCwgcmV0LCAwLCBydWxlLT5uYW1lKTsKICBqc19zZXRfcHJvcGVydHlpbnRfc3RyaW5nKGN0eCwgcmV0LCAxLCBsZXhlcl9zdGF0ZXNfc2tpcCgoY2hhciopZGJ1Zi5idWYpKTsKCiAgc3RhdGVzID0gSlNfTmV3QXJyYXkoY3R4KTsKCiAgZm9yKGkgPSAwLCBqID0gMDsgaSA8IDMyOyBpKyspIHsKICAgIGlmKHJ1bGUtPm1hc2sgJiAoMSA8PCBpKSkgewogICAgICBjaGFyKiBuYW1lID0gbGV4ZXJfc3RhdGVfbmFtZShsZXgsIGkpOwoKICAgICAgaWYobmFtZSkKICAgICAgICBKU19TZXRQcm9wZXJ0eVVpbnQzMihjdHgsIHN0YXRlcywgaisrLCBKU19OZXdTdHJpbmcoY3R4LCBuYW1lKSk7CiAgICB9CiAgfQoKICBKU19TZXRQcm9wZXJ0eVVpbnQzMihjdHgsIHJldCwgMiwgc3RhdGVzKTsKICBpZihydWxlLT5vcGFxdWUpIHsKICAgIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgcmV0LCAzLCBKU19EdXBWYWx1ZShjdHgsICgoSlNMZXhlclJ1bGUqKXJ1bGUtPm9wYXF1ZSktPmFjdGlvbikpOwogICAgSlNfU2V0UHJvcGVydHlVaW50MzIoY3R4LCByZXQsIDQsIEpTX05ld0Jvb2woY3R4LCAoKEpTTGV4ZXJSdWxlKilydWxlLT5vcGFxdWUpLT5za2lwKSk7CiAgfQogIC8vIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgcmV0LCAzLCBKU19OZXdJbnQ2NChjdHgsIHJ1bGUtPm1hc2spKTsKCiAgZGJ1Zl9mcmVlKCZkYnVmKTsKICByZXR1cm4gcmV0Owp9CgplbnVtIHRva2VuX21ldGhvZHMgewogIFRPX1NUUklORyA9IDAsCn07CgplbnVtIHRva2VuX2dldHRlcnMgewogIFRPS0VOX1BST1BfQllURUxFTkdUSCA9IDAsCiAgVE9LRU5fUFJPUF9CWVRFT0ZGU0VULAogIFRPS0VOX1BST1BfQ0hBUkxFTkdUSCwKICBUT0tFTl9QUk9QX1NUQVJULAogIFRPS0VOX1BST1BfRU5ELAogIFRPS0VOX1BST1BfQllURVJBTkdFLAogIFRPS0VOX1BST1BfQ0hBUlJBTkdFLAogIFRPS0VOX1BST1BfTEVYRU1FLAogIFRPS0VOX1BST1BfTE9DLAogIFRPS0VOX1BST1BfSUQsCiAgVE9LRU5fUFJPUF9TRVEsCiAgVE9LRU5fUFJPUF9UWVBFLAogIFRPS0VOX1BST1BfUlVMRSwKfTsKClRva2VuKgpqc190b2tlbl9uZXcoSlNDb250ZXh0KiBjdHgsIGludCBpZCwgY29uc3QgY2hhciogbGV4ZW1lLCBMb2NhdGlvbiogbG9jLCB1aW50NjRfdCBieXRlX29mZnNldCkgewogIFRva2VuKiB0b2s7CgogIGlmKCEodG9rID0ganNfbWFsbG9jeihjdHgsIHNpemVvZihUb2tlbikpKSkKICAgIHJldHVybiAwOwoKICB0b2stPmlkID0gaWQ7CiAgdG9rLT5sZXhlbWUgPSAodWludDhfdCopanNfc3RyZHVwKGN0eCwgbGV4ZW1lKTsKICB0b2stPmxvYyA9IGxvY2F0aW9uX2R1cChsb2MpOwogIC8vIHRvay0+bG9jX3ZhbCA9IEpTX1VOREVGSU5FRDsKICAvLyAgIHRvay0+Ynl0ZV9vZmZzZXQgPSBieXRlX29mZnNldDsKCiAgcmV0dXJuIHRvazsKfQoKSlNWYWx1ZQpqc190b2tlbl93cmFwKEpTQ29udGV4dCogY3R4LCBUb2tlbiogdG9rKSB7CiAgSlNWYWx1ZSBvYmogPSBKU19VTkRFRklORUQ7CgogIG9iaiA9IEpTX05ld09iamVjdFByb3RvQ2xhc3MoY3R4LCB0b2tlbl9wcm90bywganNfdG9rZW5fY2xhc3NfaWQpOwogIEpTX1NldE9wYXF1ZShvYmosIHRvayk7CiAgcmV0dXJuIG9iajsKfQoKSlNWYWx1ZQpqc190b2tlbl9jb25zdHJ1Y3RvcihKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IG5ld190YXJnZXQsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdKSB7CiAgTGV4ZXIqIGxleCA9IDA7CiAgVG9rZW4qIHRvazsKICBKU1ZhbHVlIG9iaiA9IEpTX1VOREVGSU5FRDsKICBKU1ZhbHVlIHByb3RvOwoKICBpZighKHRvayA9IGpzX21hbGxvY3ooY3R4LCBzaXplb2YoVG9rZW4pKSkpCiAgICByZXR1cm4gSlNfRVhDRVBUSU9OOwoKICAvKiB1c2luZyBuZXdfdGFyZ2V0IHRvIGdldCB0aGUgcHJvdG90eXBlIGlzIG5lY2Vzc2FyeSB3aGVuIHRoZQogICAgIGNsYXNzIGlzIGV4dGVuZGVkLiAqLwogIHByb3RvID0gSlNfR2V0UHJvcGVydHlTdHIoY3R4LCBuZXdfdGFyZ2V0LCAicHJvdG90eXBlIik7CiAgaWYoSlNfSXNFeGNlcHRpb24ocHJvdG8pKQogICAgZ290byBmYWlsOwogIG9iaiA9IEpTX05ld09iamVjdFByb3RvQ2xhc3MoY3R4LCBwcm90bywganNfdG9rZW5fY2xhc3NfaWQpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIHByb3RvKTsKICBpZihKU19Jc0V4Y2VwdGlvbihvYmopKQogICAgZ290byBmYWlsOwoKICBKU19TZXRPcGFxdWUob2JqLCB0b2spOwoKICAvLyB0b2stPmxvY192YWwgPSBKU19VTkRFRklORUQ7CgogIC8vCiAgLy8KICBpZihhcmdjID49IDEgJiYgKGxleCA9IGpzX2xleGVyX2RhdGEoYXJndlswXSkpKSB7CiAgICBhcmdjLS07CiAgICBhcmd2Kys7CiAgfQoKICBpZihhcmdjID4gMCkgewogICAgaWYoSlNfSXNOdW1iZXIoYXJndlswXSkpIHsKICAgICAgSlNfVG9JbnQzMihjdHgsICZ0b2stPmlkLCBhcmd2WzBdKTsKICAgIH0gZWxzZSBpZihKU19Jc1N0cmluZyhhcmd2WzBdKSkgewogICAgfQogIH0KICBpZihhcmdjID4gMSkKICAgIHRvay0+bGV4ZW1lID0gKHVpbnQ4X3QqKWpzX3Rvc3RyaW5nKGN0eCwgYXJndlsxXSk7CiAgaWYoYXJnYyA+IDIpIHsKICAgIExvY2F0aW9uKiBsb2M7CgogICAgaWYoKGxvYyA9IGpzX2xvY2F0aW9uX2RhdGEyKGN0eCwgYXJndlsyXSkpKQogICAgICB0b2stPmxvYyA9IGxvY2F0aW9uX2R1cChsb2MpOwogICAgZWxzZQogICAgICB0b2stPmxvYyA9IGpzX2xvY2F0aW9uX2Zyb20oY3R4LCBhcmd2WzJdKTsKICB9CiAgaWYoYXJnYyA+IDMpCiAgICBKU19Ub0ludDY0KGN0eCwgJnRvay0+bG9jLT5jaGFyX29mZnNldCwgYXJndlszXSk7CgogIHJldHVybiBvYmo7CmZhaWw6CiAganNfZnJlZShjdHgsIHRvayk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgb2JqKTsKICByZXR1cm4gSlNfRVhDRVBUSU9OOwp9CgpKU1ZhbHVlCmpzX3Rva2VuX3Rvc3RyaW5nKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdKSB7CiAgVG9rZW4qIHRvazsKICBpZighKHRvayA9IGpzX3Rva2VuX2RhdGEyKGN0eCwgdGhpc192YWwpKSkKICAgIHJldHVybiBKU19FWENFUFRJT047CiAgcmV0dXJuIEpTX05ld1N0cmluZ0xlbihjdHgsIChjb25zdCBjaGFyKil0b2stPmxleGVtZSwgdG9rLT5ieXRlX2xlbmd0aCk7Cn0KCkpTVmFsdWUKanNfdG9rZW5fdG9wcmltaXRpdmUoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB0aGlzX3ZhbCwgaW50IGFyZ2MsIEpTVmFsdWVDb25zdCBhcmd2W10pIHsKICBUb2tlbiogdG9rOwogIGNvbnN0IGNoYXIqIGhpbnQ7CiAgSlNWYWx1ZSByZXQ7CiAgaWYoISh0b2sgPSBqc190b2tlbl9kYXRhMihjdHgsIHRoaXNfdmFsKSkpCiAgICByZXR1cm4gSlNfRVhDRVBUSU9OOwogIGhpbnQgPSBhcmdjID4gMCA/IEpTX1RvQ1N0cmluZyhjdHgsIGFyZ3ZbMF0pIDogMDsKCiAgaWYoaGludCAmJiAhc3RyY21wKGhpbnQsICJudW1iZXIiKSkKICAgIHJldCA9IEpTX05ld0ludDMyKGN0eCwgdG9rLT5pZCk7CiAgZWxzZQogICAgcmV0ID0gSlNfTmV3U3RyaW5nTGVuKGN0eCwgKGNvbnN0IGNoYXIqKXRvay0+bGV4ZW1lLCB0b2stPmJ5dGVfbGVuZ3RoKTsKCiAgaWYoaGludCkKICAgIGpzX2NzdHJpbmdfZnJlZShjdHgsIGhpbnQpOwogIHJldHVybiByZXQ7Cn0KCnN0YXRpYyBjb25zdCBKU0NGdW5jdGlvbkxpc3RFbnRyeSBqc190b2tlbl9pbnNwZWN0X2Z1bmNzWzFdID0gewogICAgSlNfUFJPUF9TVFJJTkdfREVGKCJbU3ltYm9sLnRvU3RyaW5nVGFnXSIsICJUb2tlbiIsIEpTX1BST1BfQ09ORklHVVJBQkxFKSwKfTsKCkpTVmFsdWUKanNfdG9rZW5faW5zcGVjdChKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsLCBpbnQgYXJnYywgSlNWYWx1ZUNvbnN0IGFyZ3ZbXSkgewogIFRva2VuKiB0b2s7CiAgTGV4ZXJSdWxlKiBydWxlOwogIGludCBhcmdpID0gMDsKICBpbnQzMl90IGQgPSAwOwoKICBpZighKHRvayA9IGpzX3Rva2VuX2RhdGEyKGN0eCwgdGhpc192YWwpKSkKICAgIHJldHVybiBKU19FWENFUFRJT047CgogIGlmKGFyZ2kgPCBhcmdjICYmIEpTX0lzTnVtYmVyKGFyZ3ZbYXJnaV0pKQogICAgSlNfVG9JbnQzMihjdHgsICZkLCBhcmd2W2FyZ2krK10pOwoKICAvLyBwcmludGYoIiVzIGQ9JWlcbiIsIF9fZnVuY19fLCAoaW50KWQpOwoKICBKU1ZhbHVlIG9iaiA9IEpTX05ld09iamVjdFByb3RvQ2xhc3MoY3R4LCB0b2tlbl9wcm90bywganNfdG9rZW5fY2xhc3NfaWQpOwogIHJ1bGUgPSBsZXhlcl9ydWxlX2F0KHRvay0+bGV4ZXIsIHRvay0+aWQpOwoKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAiaWQiLCBKU19OZXdVaW50MzIoY3R4LCB0b2stPmlkKSwgSlNfUFJPUF9FTlVNRVJBQkxFKTsKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAic2VxIiwgSlNfTmV3VWludDMyKGN0eCwgdG9rLT5zZXEpLCBKU19QUk9QX0VOVU1FUkFCTEUpOwoKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAidHlwZSIsIHJ1bGUgPyBKU19OZXdTdHJpbmcoY3R4LCBydWxlLT5uYW1lKSA6IEpTX05VTEwsIEpTX1BST1BfRU5VTUVSQUJMRSk7CiAgSlNfRGVmaW5lUHJvcGVydHlWYWx1ZVN0cihjdHgsIG9iaiwgImxleGVtZSIsIEpTX05ld1N0cmluZyhjdHgsIChjb25zdCBjaGFyKil0b2stPmxleGVtZSksIEpTX1BST1BfRU5VTUVSQUJMRSk7CgogIGlmKHRvay0+bG9jKQogICAgSlNfRGVmaW5lUHJvcGVydHlWYWx1ZVN0cihjdHgsIG9iaiwgImNoYXJPZmZzZXQiLCBKU19OZXdVaW50MzIoY3R4LCB0b2stPmxvYy0+Y2hhcl9vZmZzZXQpLCBKU19QUk9QX0VOVU1FUkFCTEUpOwoKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAiY2hhckxlbmd0aCIsIEpTX05ld1VpbnQzMihjdHgsIHRvay0+Y2hhcl9sZW5ndGgpLCBKU19QUk9QX0VOVU1FUkFCTEUpOwoKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAiY2hhclJhbmdlIiwgb2Zmc2V0X3RvYXJyYXkodG9rZW5fY2hhcl9yYW5nZSh0b2spLCBjdHgpLCAwKTsKCiAgaWYodG9rLT5sb2MpCiAgICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAibG9jIiwganNfbG9jYXRpb25fd3JhcChjdHgsIHRvay0+bG9jKSwgMCk7CiAgcmV0dXJuIG9iajsKfQoKSlNWYWx1ZQpqc190b2tlbl9nZXQoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB0aGlzX3ZhbCwgaW50IG1hZ2ljKSB7CiAgVG9rZW4qIHRvazsKICBKU1ZhbHVlIHJldCA9IEpTX1VOREVGSU5FRDsKCiAgaWYoISh0b2sgPSBqc190b2tlbl9kYXRhKHRoaXNfdmFsKSkpCiAgICByZXR1cm4gcmV0OwoKICBzd2l0Y2gobWFnaWMpIHsKICAgIGNhc2UgVE9LRU5fUFJPUF9CWVRFTEVOR1RIOiB7CiAgICAgIHJldCA9IEpTX05ld0ludDY0KGN0eCwgdG9rLT5ieXRlX2xlbmd0aCk7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBUT0tFTl9QUk9QX0NIQVJMRU5HVEg6IHsKICAgICAgcmV0ID0gSlNfTmV3SW50NjQoY3R4LCB0b2stPmNoYXJfbGVuZ3RoKTsKICAgICAgYnJlYWs7CiAgICB9CiAgICAgIC8qICAgICAgY2FzZSBUT0tFTl9QUk9QX0JZVEVPRkZTRVQ6IHsKICAgICAgICAgICAgcmV0ID0gSlNfTmV3SW50NjQoY3R4LCB0b2stPmJ5dGVfb2Zmc2V0KTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgY2FzZSBUT0tFTl9QUk9QX1NUQVJUOiB7CiAgICAgICAgICAgIHJldCA9IEpTX05ld0ludDY0KGN0eCwgdG9rLT5sb2MuY2hhcl9vZmZzZXQpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICAgIGNhc2UgVE9LRU5fUFJPUF9FTkQ6IHsKICAgICAgICAgICAgcmV0ID0gSlNfTmV3SW50NjQoY3R4LCB0b2stPmxvYy5jaGFyX29mZnNldCArIHRvay0+Y2hhcl9sZW5ndGgpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICovCiAgICBjYXNlIFRPS0VOX1BST1BfQllURVJBTkdFOiB7CiAgICAgIExvY2F0aW9uKiBsb2M7CiAgICAgIGlmKChsb2MgPSB0b2stPmxvYykpCiAgICAgICAgcmV0ID0gb2Zmc2V0X3RvYXJyYXkodG9rZW5fYnl0ZV9yYW5nZSh0b2spLCBjdHgpOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgVE9LRU5fUFJPUF9DSEFSUkFOR0U6IHsKICAgICAgTG9jYXRpb24qIGxvYzsKICAgICAgaWYoKGxvYyA9IHRvay0+bG9jKSkKICAgICAgICByZXQgPSBvZmZzZXRfdG9hcnJheSh0b2tlbl9jaGFyX3JhbmdlKHRvayksIGN0eCk7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBUT0tFTl9QUk9QX0xFWEVNRTogewogICAgICByZXQgPSBKU19OZXdTdHJpbmdMZW4oY3R4LCAoY29uc3QgY2hhciopdG9rLT5sZXhlbWUsIHRvay0+Ynl0ZV9sZW5ndGgpOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgVE9LRU5fUFJPUF9MT0M6IHsKICAgICAgTG9jYXRpb24qIGxvYzsKCiAgICAgIGlmKChsb2MgPSBsb2NhdGlvbl9kdXAodG9rLT5sb2MpKSkKICAgICAgICByZXQgPSBqc19sb2NhdGlvbl93cmFwKGN0eCwgbG9jKTsKCiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBUT0tFTl9QUk9QX0lEOiB7CiAgICAgIHJldCA9IEpTX05ld0ludDMyKGN0eCwgdG9rLT5pZCk7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBUT0tFTl9QUk9QX1NFUTogewogICAgICByZXQgPSBKU19OZXdVaW50MzIoY3R4LCB0b2stPnNlcSk7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBUT0tFTl9QUk9QX1JVTEU6IHsKICAgICAgTGV4ZXJSdWxlKiBydWxlID0gbGV4ZXJfcnVsZV9hdCh0b2stPmxleGVyLCB0b2stPmlkKTsKICAgICAgcmV0ID0gcnVsZSA/IGpzX2xleGVyX3J1bGVfbmV3KGN0eCwgdG9rLT5sZXhlciwgcnVsZSkgOiBKU19OVUxMOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgVE9LRU5fUFJPUF9UWVBFOiB7CiAgICAgIExleGVyUnVsZSogcnVsZSA9IGxleGVyX3J1bGVfYXQodG9rLT5sZXhlciwgdG9rLT5pZCk7CiAgICAgIHJldCA9IHJ1bGUgPyBKU19OZXdTdHJpbmcoY3R4LCBydWxlLT5uYW1lKSA6IEpTX05VTEw7CiAgICAgIGJyZWFrOwogICAgfQogIH0KICByZXR1cm4gcmV0Owp9Cgp2b2lkCmpzX3Rva2VuX2ZpbmFsaXplcihKU1J1bnRpbWUqIHJ0LCBKU1ZhbHVlIHZhbCkgewogIFRva2VuKiB0b2s7CiAgaWYoKHRvayA9IGpzX3Rva2VuX2RhdGEodmFsKSkpIHsKICAgIHRva2VuX2ZyZWVfcnQodG9rLCBydCk7CiAgICBKU19TZXRPcGFxdWUodmFsLCAwKTsKICB9CiAgLy8gSlNfRnJlZVZhbHVlUlQocnQsIHZhbCk7Cn0KCnN0YXRpYyBKU0NsYXNzRGVmIGpzX3Rva2VuX2NsYXNzID0gewogICAgLmNsYXNzX25hbWUgPSAiVG9rZW4iLAogICAgLmZpbmFsaXplciA9IGpzX3Rva2VuX2ZpbmFsaXplciwKfTsKCnN0YXRpYyBjb25zdCBKU0NGdW5jdGlvbkxpc3RFbnRyeSBqc190b2tlbl9wcm90b19mdW5jc1tdID0gewogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoImNoYXJMZW5ndGgiLCBqc190b2tlbl9nZXQsIE5VTEwsIFRPS0VOX1BST1BfQ0hBUkxFTkdUSCksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigiYnl0ZUxlbmd0aCIsIGpzX3Rva2VuX2dldCwgTlVMTCwgVE9LRU5fUFJPUF9CWVRFTEVOR1RIKSwKICAgIC8qICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJieXRlT2Zmc2V0IiwganNfdG9rZW5fZ2V0LCBOVUxMLCBUT0tFTl9QUk9QX0JZVEVPRkZTRVQpLAogICAgICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJzdGFydCIsIGpzX3Rva2VuX2dldCwgTlVMTCwgVE9LRU5fUFJPUF9TVEFSVCksCiAgICAgICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoImVuZCIsIGpzX3Rva2VuX2dldCwgTlVMTCwgVE9LRU5fUFJPUF9FTkQpLCovCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigiY2hhclJhbmdlIiwganNfdG9rZW5fZ2V0LCBOVUxMLCBUT0tFTl9QUk9QX0NIQVJSQU5HRSksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigiYnl0ZVJhbmdlIiwganNfdG9rZW5fZ2V0LCBOVUxMLCBUT0tFTl9QUk9QX0JZVEVSQU5HRSksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigibG9jIiwganNfdG9rZW5fZ2V0LCBOVUxMLCBUT0tFTl9QUk9QX0xPQyksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigiaWQiLCBqc190b2tlbl9nZXQsIE5VTEwsIFRPS0VOX1BST1BfSUQpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoInNlcSIsIGpzX3Rva2VuX2dldCwgTlVMTCwgVE9LRU5fUFJPUF9TRVEpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoInR5cGUiLCBqc190b2tlbl9nZXQsIE5VTEwsIFRPS0VOX1BST1BfVFlQRSksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigicnVsZSIsIGpzX3Rva2VuX2dldCwgTlVMTCwgVE9LRU5fUFJPUF9SVUxFKSwKICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJsZXhlbWUiLCBqc190b2tlbl9nZXQsIE5VTEwsIFRPS0VOX1BST1BfTEVYRU1FKSwKICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJ2YWx1ZSIsIGpzX3Rva2VuX2dldCwgTlVMTCwgVE9LRU5fUFJPUF9MRVhFTUUpLAogICAgLy8gSlNfQ0ZVTkNfREVGKCJ0b1N0cmluZyIsIDAsIGpzX3Rva2VuX3Rvc3RyaW5nKSwKICAgIC8vIEpTX0NGVU5DX0RFRigiW1N5bWJvbC50b1ByaW1pdGl2ZV0iLCAxLCBqc190b2tlbl90b3ByaW1pdGl2ZSksCiAgICBKU19BTElBU19ERUYoInBvc2l0aW9uIiwgImxvYyIpLAogICAgSlNfQUxJQVNfREVGKCJsZW5ndGgiLCAiY2hhckxlbmd0aCIpLAogICAgSlNfQUxJQVNfREVGKCJyYW5nZSIsICJjaGFyUmFuZ2UiKSwKICAgIEpTX1BST1BfU1RSSU5HX0RFRigiW1N5bWJvbC50b1N0cmluZ1RhZ10iLCAiVG9rZW4iLCBKU19QUk9QX0NPTkZJR1VSQUJMRSksCn07CnN0YXRpYyBjb25zdCBKU0NGdW5jdGlvbkxpc3RFbnRyeSBqc190b2tlbl9zdGF0aWNfZnVuY3NbXSA9IHsKICAgIEpTX1BST1BfSU5UMzJfREVGKCJFT0YiLCBMRVhFUl9FT0YsIEpTX1BST1BfRU5VTUVSQUJMRSksCn07CgpzdGF0aWMgSlNWYWx1ZQpsZXhlcl9jb250aW51ZShKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsLCBpbnQgYXJnYywgSlNWYWx1ZUNvbnN0IGFyZ3ZbXSwgaW50IG1hZ2ljLCBKU1ZhbHVlIGRhdGFbXSkgewogIEpTVmFsdWUgdmFsID0gYXJnYyA+PSAxID8gSlNfRHVwVmFsdWUoY3R4LCBhcmd2WzBdKSA6IEpTX05ld0Jvb2woY3R4LCBUUlVFKTsKCiAgSlNfU2V0UHJvcGVydHlVaW50MzIoY3R4LCBkYXRhWzBdLCAwLCB2YWwpOwoKICByZXR1cm4gSlNfVU5ERUZJTkVEOwp9CgpzdGF0aWMgaW50MzJfdApsZXhlcl90b19zdGF0ZShMZXhlciogbGV4LCBKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHZhbHVlKSB7CiAgaW50MzJfdCBudW07CiAgaWYoSlNfSXNOdW1iZXIodmFsdWUpKSB7CiAgICBKU19Ub0ludDMyKGN0eCwgJm51bSwgdmFsdWUpOwogIH0gZWxzZSB7CiAgICBjb25zdCBjaGFyKiBzdHIgPSBKU19Ub0NTdHJpbmcoY3R4LCB2YWx1ZSk7CiAgICBudW0gPSBsZXhlcl9zdGF0ZV9maW5kKGxleCwgc3RyKTsKICB9CiAgaWYobnVtID49IDAgJiYgKHNpemVfdCludW0gPCBsZXhlcl9udW1fc3RhdGVzKGxleCkpCiAgICByZXR1cm4gbnVtOwogIHJldHVybiAtMTsKfQoKc3RhdGljIEJPT0wKbGV4ZXJfaGFuZGxlKExleGVyKiBsZXgsIEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIEpTVmFsdWVDb25zdCBoYW5kbGVyKSB7CiAgQk9PTCByZXN1bHQgPSBGQUxTRTsKICBKU1ZhbHVlIGRhdGFbMV0gPSB7SlNfTmV3QXJyYXkoY3R4KX07CiAgSlNWYWx1ZSBhcmdzW10gPSB7CiAgICAgIEpTX0R1cFZhbHVlKGN0eCwgdGhpc192YWwpLAogICAgICBKU19OZXdDRnVuY3Rpb25EYXRhKGN0eCwgbGV4ZXJfY29udGludWUsIDAsIDAsIDEsIGRhdGEpLAogIH07CiAgSlNWYWx1ZSByZXQsIGRvX3Jlc3VtZSA9IEpTX0ZBTFNFOwoKICByZXQgPSBKU19DYWxsKGN0eCwgaGFuZGxlciwgdGhpc192YWwsIGNvdW50b2YoYXJncyksIGFyZ3MpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIHJldCk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgYXJnc1swXSk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgYXJnc1sxXSk7CgogIGRvX3Jlc3VtZSA9IEpTX0dldFByb3BlcnR5VWludDMyKGN0eCwgZGF0YVswXSwgMCk7CgogIGlmKEpTX0lzQm9vbChkb19yZXN1bWUpKQogICAgcmVzdWx0ID0gSlNfVG9Cb29sKGN0eCwgZG9fcmVzdW1lKTsKCiAgSlNfRnJlZVZhbHVlKGN0eCwgZGF0YVswXSk7CgogIHJldHVybiByZXN1bHQ7Cn0KCnN0YXRpYyBpbnQKbGV4ZXJfbGV4KExleGVyKiBsZXgsIEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdKSB7CiAgaW50IGlkID0gMDsKICBpbnQ2NF90IGZsYWdzID0gMDsKICBKU1ZhbHVlIGNhbGxiYWNrID0gSlNfVU5ERUZJTkVEOwoKICBpZihhcmdjID49IDEgJiYgKGZsYWdzID0gbGV4ZXJfdG9fc3RhdGUobGV4LCBjdHgsIGFyZ3ZbMF0pKSkge30KCiAgY2FsbGJhY2sgPSBKU19HZXRQcm9wZXJ0eVN0cihjdHgsIHRoaXNfdmFsLCAiY2FsbGJhY2siKTsKCiAgaWYobGV4LT5ieXRlX2xlbmd0aCA+IDAgJiYgbGV4LT50b2tlbl9pZCAhPSAtMSkKICAgIGxleGVyX3NraXAobGV4KTsKCiAgZm9yKDs7KSB7CiAgICBpZigoaWQgPSBsZXhlcl9wZWVrKGxleCwgaWQsIGN0eCkpID49IDApIHsKICAgICAgTGV4ZXJSdWxlKiBydWxlID0gbGV4ZXJfcnVsZV9hdChsZXgsIGlkKTsKCiAgICAgIC8vICBwcmludGYoInN0YXRlICVpIHJ1bGUgJXNcbiIsIGxleC0+c3RhdGUsIHJ1bGUtPm5hbWUpOwoKICAgICAgSlNMZXhlclJ1bGUqIGpzcnVsZSA9IHJ1bGUtPm9wYXF1ZTsKCiAgICAgIGlmKChydWxlLT5tYXNrICYgZmxhZ3MpKSB7CiAgICAgICAgbGV4ZXJfc2tpcChsZXgpOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBpZihqc3J1bGUpIHsKICAgICAgICBCT09MIHNraXAgPSBGQUxTRTsKCiAgICAgICAgaWYoSlNfSXNGdW5jdGlvbihjdHgsIGpzcnVsZS0+YWN0aW9uKSkKICAgICAgICAgIHNraXAgPSBsZXhlcl9oYW5kbGUobGV4LCBjdHgsIHRoaXNfdmFsLCBqc3J1bGUtPmFjdGlvbik7CgogICAgICAgIGlmKHNraXAgfHwganNydWxlLT5za2lwKSB7CiAgICAgICAgICBsZXhlcl9za2lwKGxleCk7CiAgICAgICAgICBpZCA9IDA7IC8vKytpZDsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgfQoKICAgICAgLyogaWYoSlNfSXNGdW5jdGlvbihjdHgsIGNhbGxiYWNrKSkgewogICAgICAgICBsZXhlcl9oYW5kbGUobGV4LCBjdHgsIHRoaXNfdmFsLCBjYWxsYmFjayk7CiAgICAgICB9Ki8KCiAgICB9IGVsc2UgaWYoaWQgPT0gTEVYRVJfRVJST1JfTk9NQVRDSCkgewogICAgICBKU1ZhbHVlIGhhbmRsZXIgPSBKU19HZXRQcm9wZXJ0eVN0cihjdHgsIHRoaXNfdmFsLCAiaGFuZGxlciIpOwoKICAgICAgaWYoSlNfSXNGdW5jdGlvbihjdHgsIGhhbmRsZXIpKSB7CiAgICAgICAgaWYobGV4ZXJfaGFuZGxlKGxleCwgY3R4LCB0aGlzX3ZhbCwgaGFuZGxlcikgPT0gVFJVRSkKICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICBpZCA9IExFWEVSX0VSUk9SX05PTUFUQ0g7CiAgICAgIH0KICAgIH0KCiAgICBicmVhazsKICB9CgogIHJldHVybiBpZDsKfQoKc3RhdGljIEJPT0wKbGV4ZXJfZXNjYXBlX3ByZWQoaW50IGMpIHsKICBzd2l0Y2goYykgewogICAgY2FzZSAnKic6CiAgICBjYXNlICc/JzoKICAgIGNhc2UgJysnOgogICAgY2FzZSAnWyc6CiAgICBjYXNlICddJzoKICAgIGNhc2UgJygnOgogICAgY2FzZSAnKSc6CiAgICBjYXNlICcuJzoKICAgIGNhc2UgJ14nOgogICAgY2FzZSAnJCc6CiAgICBjYXNlICd8JzoKICAgIGNhc2UgJ1xyJzoKICAgIGNhc2UgJ1xuJzoKICAgIGNhc2UgJ1x0JzoKICAgIGNhc2UgJ1x2JzoKICAgIGNhc2UgJ1xmJzoKICAgIGNhc2UgJ1xcJzogcmV0dXJuIFRSVUU7CiAgfQogIHJldHVybiBGQUxTRTsKfQpzdGF0aWMgQk9PTApsZXhlcl91bmVzY2FwZV9wcmVkKGludCBjKSB7CiAgc3dpdGNoKGMpIHsKICAgIGNhc2UgJ3InOiByZXR1cm4gJ1xyJzsKICAgIGNhc2UgJ24nOiByZXR1cm4gJ1xuJzsKICAgIGNhc2UgJ3QnOiByZXR1cm4gJ1x0JzsKICAgIGNhc2UgJ3YnOiByZXR1cm4gJ1x2JzsKICAgIGNhc2UgJ2YnOiByZXR1cm4gJ1xmJzsKICAgIGNhc2UgJy8nOgogICAgICByZXR1cm4gJy8nOwogICAgICAvLyBjYXNlICdcXCc6IHJldHVybiAnXFwnOwogIH0KICByZXR1cm4gMDsKfQoKc3RhdGljIGNoYXIqCmxleGVyX2N1cnJlbnRfbGluZShMZXhlciogbGV4LCBKU0NvbnRleHQqIGN0eCkgewogIHNpemVfdCBzdGFydCwgc2l6ZTsKICBzdGFydCA9IGxleC0+cG9zOwogIC8vIGVuZCA9IHN0YXJ0ICsgbGV4LT5ieXRlX2xlbmd0aDsKICB3aGlsZShzdGFydCA+IDAgJiYgbGV4LT5kYXRhW3N0YXJ0IC0gMV0gIT0gJ1xuJykgc3RhcnQtLTsKICBzaXplID0gYnl0ZV9jaHIoKGNvbnN0IGNoYXIqKSZsZXgtPmRhdGFbc3RhcnRdLCBsZXgtPnNpemUgLSBzdGFydCwgJ1xuJyk7CiAgLy8gd2hpbGUoZW5kIDwgbGV4LT5zaXplICYmIGxleC0+ZGF0YVtlbmRdICE9ICdcbicpIGVuZCsrOwogIHJldHVybiBqc19zdHJuZHVwKGN0eCwgKGNvbnN0IGNoYXIqKSZsZXgtPmRhdGFbc3RhcnRdLCBzaXplKTsKfQoKc3RhdGljIGNoYXIqCmxleGVyX2xleGVtZV9zKExleGVyKiBsZXgsIEpTQ29udGV4dCogY3R4KSB7CiAgc2l6ZV90IGxlbjsKICBjaGFyKiBzOwogIER5bkJ1ZiBvdXRwdXQ7CiAganNfZGJ1Zl9pbml0KGN0eCwgJm91dHB1dCk7CgogIHMgPSBsZXhlcl9sZXhlbWUobGV4LCAmbGVuKTsKCiAgZGJ1Zl9wdXRfZXNjYXBlZF9wcmVkKCZvdXRwdXQsIHMsIGxlbiwgbGV4ZXJfZXNjYXBlX3ByZWQpOwogIGRidWZfMCgmb3V0cHV0KTsKCiAgcmV0dXJuIChjaGFyKilvdXRwdXQuYnVmOwp9CgpzdGF0aWMgVG9rZW4qCmxleGVyX3Rva2VuKExleGVyKiBsZXgsIGludDMyX3QgaWQsIEpTQ29udGV4dCogY3R4KSB7CiAgc2l6ZV90IGxlbjsKICBjb25zdCBjaGFyKiBsZXhlbWU7CiAgVG9rZW4qIHRvazsKCiAgaWYoIShsZXhlbWUgPSBsZXhlcl9sZXhlbWUobGV4LCAmbGVuKSkpCiAgICByZXR1cm4gMDsKCiAgaWYoISh0b2sgPSB0b2tlbl9jcmVhdGUoaWQsIGxvY2F0aW9uX2Nsb25lKCZsZXgtPmxvYywgY3R4KSwgbGV4ZW1lLCBsZW4sIGN0eCkpKQogICAgcmV0dXJuIDA7CgogIHRvay0+bGV4ZXIgPSBsZXhlcl9kdXAobGV4KTsKICB0b2stPnNlcSA9IGxleC0+c2VxOwoKICByZXR1cm4gdG9rOwp9CgpKU1ZhbHVlCmpzX2xleGVyX25ldyhKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHByb3RvLCBKU1ZhbHVlQ29uc3QgdmlucHV0LCBKU1ZhbHVlQ29uc3Qgdm1vZGUpIHsKICBMZXhlciogbGV4OwogIGludDMyX3QgbW9kZSA9IDA7CiAgSlNWYWx1ZSBvYmogPSBKU19VTkRFRklORUQ7CiAgaWYoIShsZXggPSBqc19tYWxsb2N6KGN0eCwgc2l6ZW9mKExleGVyKSkpKQogICAgcmV0dXJuIEpTX0VYQ0VQVElPTjsKCiAgaWYoSlNfSXNOdW1iZXIodm1vZGUpKQogICAgSlNfVG9JbnQzMihjdHgsICZtb2RlLCB2bW9kZSk7CiAgbGV4ZXJfaW5pdChsZXgsIG1vZGUsIGN0eCk7CgogIG9iaiA9IEpTX05ld09iamVjdFByb3RvQ2xhc3MoY3R4LCBwcm90bywganNfbGV4ZXJfY2xhc3NfaWQpOwoKICBpZihKU19Jc0V4Y2VwdGlvbihvYmopKQogICAgZ290byBmYWlsOwogIEpTX1NldE9wYXF1ZShvYmosIGxleCk7CgogIGxleC0+aW5wdXQgPSBqc19pbnB1dF9jaGFycyhjdHgsIHZpbnB1dCk7CgogIHJldHVybiBvYmo7CmZhaWw6CiAganNfZnJlZShjdHgsIGxleCk7CiAgSlNfRnJlZVZhbHVlKGN0eCwgb2JqKTsKICByZXR1cm4gSlNfRVhDRVBUSU9OOwp9CgpKU1ZhbHVlCmpzX2xleGVyX3dyYXAoSlNDb250ZXh0KiBjdHgsIExleGVyKiBsZXgpIHsKICBKU1ZhbHVlIG9iajsKCiAgb2JqID0gSlNfTmV3T2JqZWN0UHJvdG9DbGFzcyhjdHgsIGxleGVyX3Byb3RvLCBqc19sZXhlcl9jbGFzc19pZCk7CiAgSlNfU2V0T3BhcXVlKG9iaiwgbGV4KTsKICByZXR1cm4gb2JqOwp9CgpKU1ZhbHVlCmpzX2xleGVyX2FkZF9ydWxlKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdLCBpbnQgbWFnaWMpIHsKICBMZXhlciogbGV4OwogIGNoYXIqIG5hbWU7CiAgaW50NjRfdCBtYXNrID0gLTEsIHNraXAgPSAwOwogIFJlZ0V4cCBleHByOwogIEpTTGV4ZXJSdWxlKiBqc3J1bGUgPSAwOwoKICBpZighKGxleCA9IGpzX2xleGVyX2RhdGEyKGN0eCwgdGhpc192YWwpKSkKICAgIHJldHVybiBKU19FWENFUFRJT047CgogIG5hbWUgPSAobWFnaWMgfHwgSlNfSXNTdHJpbmcoYXJndlswXSkpID8ganNfdG9zdHJpbmcoY3R4LCBhcmd2WzBdKSA6IDA7CiAgZXhwciA9IHJlZ2V4cF9mcm9tX2FyZ3YoYXJnYyAtIDEsICZhcmd2WzFdLCBjdHgpOwoKICBpZihhcmdjID49IDMgJiYgSlNfSXNOdW1iZXIoYXJndlsyXSkpCiAgICBKU19Ub0ludDY0KGN0eCwgJm1hc2ssIGFyZ3ZbMl0pOwoKICBKU1ZhbHVlIHNraXB2ID0gSlNfR2V0UHJvcGVydHlTdHIoY3R4LCB0aGlzX3ZhbCwgInNraXAiKTsKICBpZihKU19Jc051bWJlcihza2lwdikpCiAgICBKU19Ub0ludDY0KGN0eCwgJnNraXAsIHNraXB2KTsKICBKU19GcmVlVmFsdWUoY3R4LCBza2lwdik7CgogIGlmKGFyZ2MgPiAzIHx8IEpTX0lzRnVuY3Rpb24oY3R4LCBhcmd2W2FyZ2MgLSAxXSkpIHsKICAgIGpzcnVsZSA9IGpzX21hbGxvYyhjdHgsIHNpemVvZihKU0xleGVyUnVsZSkpOwoKICAgIGpzcnVsZS0+YWN0aW9uID0gSlNfRHVwVmFsdWUoY3R4LCBhcmd2W2FyZ2MgLSAxXSk7CiAgICBqc3J1bGUtPnNraXAgPSAhIShtYXNrICYgc2tpcCk7CiAgfQoKICBpZihtYWdpYykgewogICAgaW50IGluZGV4OwogICAgTGV4ZXJSdWxlKiBydWxlOwoKICAgIGlmKChpbmRleCA9IGxleGVyX3J1bGVfYWRkKGxleCwgbmFtZSwgZXhwci5zb3VyY2UpKSA9PSAtMSkKICAgICAgcmV0dXJuIEpTX1Rocm93SW50ZXJuYWxFcnJvcihjdHgsICJMZXhlciBydWxlICclcycgbm90IHVuaXF1ZSIsIG5hbWUpOwoKICAgIHJ1bGUgPSBsZXhlcl9ydWxlX2F0KGxleCwgaW5kZXgpOwogICAgcnVsZS0+b3BhcXVlID0ganNydWxlOwoKICAgIHJldHVybiBKU19OZXdJbnQzMihjdHgsIGluZGV4KTsKICB9IGVsc2UgewogICAgbGV4ZXJfZGVmaW5lKGxleCwgbmFtZSwgZXhwci5zb3VyY2UpOwogIH0KCiAgcmV0dXJuIEpTX1VOREVGSU5FRDsKfQoKSlNWYWx1ZQpqc19sZXhlcl9jb25zdHJ1Y3RvcihKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IG5ld190YXJnZXQsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdKSB7CiAgSlNWYWx1ZSBwcm90bywgcmV0OwogIExleGVyKiBsZXg7CiAgaW50NjRfdCBtYXNrID0gTUFTS19BTEw7CiAgLyogdXNpbmcgbmV3X3RhcmdldCB0byBnZXQgdGhlIHByb3RvdHlwZSBpcyBuZWNlc3Nhcnkgd2hlbiB0aGUKICAgICAgY2xhc3MgaXMgZXh0ZW5kZWQuICovCiAgcHJvdG8gPSBKU19HZXRQcm9wZXJ0eVN0cihjdHgsIG5ld190YXJnZXQsICJwcm90b3R5cGUiKTsKICBpZihKU19Jc0V4Y2VwdGlvbihwcm90bykpCiAgICBwcm90byA9IGxleGVyX3Byb3RvOyAvLyBKU19EdXBWYWx1ZShjdHgsIGxleGVyX3Byb3RvKTsKCiAgcmV0ID0ganNfbGV4ZXJfbmV3KGN0eCwgcHJvdG8sIGFyZ2MgPiAwID8gYXJndlswXSA6IEpTX1VOREVGSU5FRCwgYXJnYyA+IDEgPyBhcmd2WzFdIDogSlNfVU5ERUZJTkVEKTsKCiAgaWYoKGxleCA9IEpTX0dldE9wYXF1ZShyZXQsIGpzX2xleGVyX2NsYXNzX2lkKSkpIHsKICAgIGludCBpID0gMjsKCiAgICBpZihsZXgtPmxvYy5maWxlID09IC0xICYmIGkgPCBhcmdjICYmIEpTX0lzU3RyaW5nKGFyZ3ZbaV0pKQogICAgICBsZXgtPmxvYy5maWxlID0gSlNfVmFsdWVUb0F0b20oY3R4LCBhcmd2W2krK10pOwoKICAgIGlmKGkgPCBhcmdjICYmIEpTX0lzTnVtYmVyKGFyZ3ZbaV0pKSB7CiAgICAgIHVpbnQzMl90IG1vZGUgPSAwOwogICAgICBKU19Ub1VpbnQzMihjdHgsICZtb2RlLCBhcmd2W2krK10pOwogICAgICBsZXgtPm1vZGUgfD0gbW9kZTsKICAgIH0KICAgIGlmKGkgPCBhcmdjICYmIEpTX0lzTnVtYmVyKGFyZ3ZbaV0pKQogICAgICBKU19Ub0ludDY0KGN0eCwgJm1hc2ssIGFyZ3ZbaSsrXSk7CiAgfQogIEpTX1NldFByb3BlcnR5U3RyKGN0eCwgcmV0LCAibWFzayIsIEpTX05ld0ludDY0KGN0eCwgbWFzaykpOwoKICByZXR1cm4gcmV0Owp9CgplbnVtIHsKICBNRVRIT0RfU0VUX0lOUFVUID0gMCwKICBNRVRIT0RfU0tJUF9CWVRFUywKICBNRVRIT0RfU0tJUF9UT0tFTiwKICBNRVRIT0RfQkFDSywKICBNRVRIT0RfUEVFS0MsCiAgTUVUSE9EX0dFVEMsCiAgTUVUSE9EX1NLSVBfQ0hBUlMsCiAgTUVUSE9EX0dFVF9SQU5HRSwKICBNRVRIT0RfQ1VSUkVOVF9MSU5FLAogIE1FVEhPRF9UT0tFTl9DTEFTUywKICBNRVRIT0RfR0VUX1JVTEUsCiAgTUVUSE9EX1NLSVBfVU5USUwsCiAgTUVUSE9EX0VSUk9SLAogIE1FVEhPRF9QVVNIX1NUQVRFLAogIE1FVEhPRF9QT1BfU1RBVEUsCiAgTUVUSE9EX1RPUF9TVEFURSwKfTsKCkpTVmFsdWUKanNfbGV4ZXJfbWV0aG9kKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdLCBpbnQgbWFnaWMpIHsKICBMZXhlciogbGV4OwogIEpTVmFsdWUgcmV0ID0gSlNfVU5ERUZJTkVEOwoKICBpZighKGxleCA9IGpzX2xleGVyX2RhdGEyKGN0eCwgdGhpc192YWwpKSkKICAgIHJldHVybiBKU19FWENFUFRJT047CgogIHN3aXRjaChtYWdpYykgewogICAgY2FzZSBNRVRIT0RfU0VUX0lOUFVUOiB7CiAgICAgIExleGVyKiBvdGhlcjsKICAgICAgSW5wdXRCdWZmZXIgaW5wdXQ7CiAgICAgIExvY2F0aW9uIGxvYyA9IHswLCAwLCAwLCAtMSwgMH07CgogICAgICBpZigob3RoZXIgPSBKU19HZXRPcGFxdWUoYXJndlswXSwganNfbGV4ZXJfY2xhc3NfaWQpKSkgewogICAgICAgIGlucHV0ID0gaW5wdXRfYnVmZmVyX2Nsb25lKCZvdGhlci0+aW5wdXQsIGN0eCk7CiAgICAgICAgbG9jID0gb3RoZXItPmxvYzsKICAgICAgICAvLyBsZXgtPnN0YXJ0ID0gb3RoZXItPnN0YXJ0OwogICAgICB9IGVsc2UgewogICAgICAgIGlucHV0ID0ganNfaW5wdXRfY2hhcnMoY3R4LCBhcmd2WzBdKTsKICAgICAgfQoKICAgICAgaW5wdXRfYnVmZmVyX2ZyZWUoJmxleC0+aW5wdXQsIGN0eCk7CiAgICAgIGxleC0+aW5wdXQgPSBpbnB1dDsKICAgICAgbG9jYXRpb25fcmVsZWFzZV9ydCgmbGV4LT5sb2MsIEpTX0dldFJ1bnRpbWUoY3R4KSk7CiAgICAgIGxleC0+bG9jID0gbG9jOwoKICAgICAgaWYoYXJnYyA+IDEgJiYgSlNfSXNTdHJpbmcoYXJndlsxXSkpIHsKICAgICAgICBpZihsZXgtPmxvYy5maWxlID4gLTEpCiAgICAgICAgICBKU19GcmVlQXRvbShjdHgsIGxleC0+bG9jLmZpbGUpOwogICAgICAgIGxleC0+bG9jLmZpbGUgPSBKU19WYWx1ZVRvQXRvbShjdHgsIGFyZ3ZbMV0pOwogICAgICB9CgogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIE1FVEhPRF9TS0lQX0JZVEVTOiB7CiAgICAgIHVpbnQzMl90IG4gPSAwOwogICAgICBKU19Ub1VpbnQzMihjdHgsICZuLCBhcmd2WzBdKTsKCiAgICAgIGlmKG4gPiBsZXgtPmJ5dGVfbGVuZ3RoKQogICAgICAgIHJldCA9IEpTX1Rocm93SW50ZXJuYWxFcnJvcihjdHgsICJza2lwQnl0ZXMoKTogY291bnQgbiA+ICV6dSIsIGxleC0+Ynl0ZV9sZW5ndGgpOwogICAgICBlbHNlCiAgICAgICAgcmV0ID0gSlNfTmV3VWludDMyKGN0eCwgbGV4ZXJfc2tpcF9uKGxleCwgbikpOwogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIE1FVEhPRF9TS0lQX1RPS0VOOiB7CiAgICAgIGlmKGxleC0+dG9rZW5faWQgPT0gLTEpCiAgICAgICAgcmV0ID0gSlNfVGhyb3dJbnRlcm5hbEVycm9yKGN0eCwgInNraXBUb2tlbigpOiBsZXhlciB0b2tlbiBpZCBpcyAtMSIpOwogICAgICBlbHNlIGlmKGxleC0+Ynl0ZV9sZW5ndGggPT0gMCkKICAgICAgICByZXQgPSBKU19UaHJvd0ludGVybmFsRXJyb3IoY3R4LCAic2tpcFRva2VuKCk6IGxleGVyIHRva2VuIGxlbmd0aCBpcyAwIik7CiAgICAgIGVsc2UKICAgICAgICByZXQgPSBKU19OZXdVaW50MzIoY3R4LCBsZXhlcl9za2lwKGxleCkpOwogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIE1FVEhPRF9CQUNLOiB7CiAgICAgIGludCBpOwogICAgICBmb3IoaSA9IDA7IGkgPCBhcmdjOyBpKyspIHsKICAgICAgICBUb2tlbiogdG9rOwogICAgICAgIExvY2F0aW9uKiBsb2M7CiAgICAgICAgaWYoKGxvYyA9IGpzX2xvY2F0aW9uX2RhdGEyKGN0eCwgYXJndltpXSkpKSB7CiAgICAgICAgICBsZXhlcl9zZXRfbG9jYXRpb24obGV4LCBsb2MsIGN0eCk7CiAgICAgICAgICBpZihsZXgtPmJ5dGVfbGVuZ3RoID4gMCAmJiBsZXgtPnRva2VuX2lkICE9IC0xKQogICAgICAgICAgICBsZXhlcl9jbGVhcl90b2tlbihsZXgpOwogICAgICAgICAgcmV0ID0gSlNfTmV3SW50MzIoY3R4LCBsZXhlcl9wZWVrKGxleCwgLyoxIDw8IGxleC0+c3RhdGUsKi8gMCwgY3R4KSk7CiAgICAgICAgfSBlbHNlIGlmKCh0b2sgPSBqc190b2tlbl9kYXRhKGFyZ3ZbaV0pKSkgewogICAgICAgICAgbGV4ZXJfc2V0X2xvY2F0aW9uKGxleCwgdG9rLT5sb2MsIGN0eCk7CiAgICAgICAgICBsZXgtPmJ5dGVfbGVuZ3RoID0gdG9rLT5ieXRlX2xlbmd0aDsKICAgICAgICAgIGxleC0+c2VxID0gdG9rLT5zZXE7CiAgICAgICAgICByZXQgPSBKU19OZXdJbnQzMihjdHgsIHRvay0+aWQpOwogICAgICAgIH0gLyplbHNlIGlmKEpTX0lzU3RyaW5nKGFyZ3ZbaV0pKSB7CiAgICAgICAgICBzaXplX3QgbGVuOwogICAgICAgICAgY29uc3QgY2hhciogc3RyID0gSlNfVG9DU3RyaW5nTGVuKGN0eCwgJmxlbiwgYXJndltpXSk7CiAgICAgICAgICBpZihsZXgtPnBvcyA+PSBsZW4gJiYgIW1lbWNtcCgmbGV4LT5kYXRhW2xleC0+cG9zIC0gbGVuXSwgc3RyLCBsZW4pKSB7CiAgICAgICAgICAgIExvY2F0aW9uIGRpZmY7CiAgICAgICAgICAgIGxvY2F0aW9uX3plcm8oJmRpZmYpOwogICAgICAgICAgICBsb2NhdGlvbl9jb3VudCgmZGlmZiwgKGNvbnN0IHVpbnQ4X3QqKSZsZXgtPmRhdGFbbGV4LT5wb3MgLSBsZW5dLCBsZW4pOwogICAgICAgICAgICBsb2NhdGlvbl9zdWIoJmxleC0+bG9jLCAmZGlmZik7CiAgICAgICAgICAgIHJldCA9IEpTX05ld0ludDMyKGN0eCwgbGV4ZXJfcGVlayhsZXgsIDEgPDwgbGV4LT5zdGF0ZSwgMCwgY3R4KSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjaGFyKiBidWYgPSBieXRlX2VzY2FwZSgoY29uc3QgY2hhciopJmxleC0+ZGF0YVtsZXgtPnBvcyAtIGxlbl0sIGxlbik7CiAgICAgICAgICAgIHJldCA9IEpTX1Rocm93SW50ZXJuYWxFcnJvcihjdHgsICJMZXhlci5wcm90b3R5cGUuYmFjaygnJXMnKSBgJXNgIC4uLiIsIHN0ciwgYnVmKTsKICAgICAgICAgICAgZnJlZShidWYpOwogICAgICAgICAgfQogICAgICAgICAgSlNfRnJlZUNTdHJpbmcoY3R4LCBzdHIpOwogICAgICAgIH0qLwogICAgICAgIGVsc2UgewogICAgICAgICAgcmV0ID0gSlNfVGhyb3dUeXBlRXJyb3IoY3R4LCAiTGV4ZXIucHJvdG90eXBlLmJhY2soKSBuZWVkcyB0b2tlbiBvciBsb2NhdGlvbiIpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgYnJlYWs7CiAgICB9CgogICAgY2FzZSBNRVRIT0RfUEVFS0M6IHsKICAgICAgaWYoIWlucHV0X2J1ZmZlcl9lb2YoJmxleC0+aW5wdXQpKSB7CiAgICAgICAgc2l6ZV90IGxlbjsKICAgICAgICBjb25zdCB1aW50OF90KiBidWYgPSBpbnB1dF9idWZmZXJfcGVlaygmbGV4LT5pbnB1dCwgJmxlbik7CiAgICAgICAgcmV0ID0gSlNfTmV3U3RyaW5nTGVuKGN0eCwgKGNvbnN0IGNoYXIqKWJ1ZiwgbGVuKTsKICAgICAgfQogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIE1FVEhPRF9HRVRDOiB7CiAgICAgIGlmKCFpbnB1dF9idWZmZXJfZW9mKCZsZXgtPmlucHV0KSkgewogICAgICAgIHNpemVfdCBsZW47CiAgICAgICAgY29uc3QgdWludDhfdCogYnVmID0gaW5wdXRfYnVmZmVyX2dldCgmbGV4LT5pbnB1dCwgJmxlbik7CiAgICAgICAgcmV0ID0gSlNfTmV3U3RyaW5nTGVuKGN0eCwgKGNvbnN0IGNoYXIqKWJ1ZiwgbGVuKTsKICAgICAgfQogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIE1FVEhPRF9TS0lQX0NIQVJTOiB7CiAgICAgIGlmKCFpbnB1dF9idWZmZXJfZW9mKCZsZXgtPmlucHV0KSkgewogICAgICAgIGludDMyX3QgbnRpbWVzID0gMTsKICAgICAgICBjb25zdCB1aW50OF90KiBwID0gMDsKICAgICAgICBzaXplX3QgbjsKICAgICAgICBpZihhcmdjID4gMCkKICAgICAgICAgIEpTX1RvSW50MzIoY3R4LCAmbnRpbWVzLCBhcmd2WzBdKTsKICAgICAgICB3aGlsZShudGltZXMtLSA+IDApIHsgcCA9IGlucHV0X2J1ZmZlcl9nZXQoJmxleC0+aW5wdXQsICZuKTsgfQogICAgICAgIGlmKHApCiAgICAgICAgICByZXQgPSBKU19OZXdTdHJpbmdMZW4oY3R4LCAoY29uc3QgY2hhciopcCwgbik7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICB9CgogICAgY2FzZSBNRVRIT0RfU0tJUF9VTlRJTDogewogICAgICBpZighaW5wdXRfYnVmZmVyX2VvZigmbGV4LT5pbnB1dCkpIHsKICAgICAgICBKU1ZhbHVlQ29uc3QgcHJlZDsKICAgICAgICBpZighSlNfSXNGdW5jdGlvbihjdHgsIGFyZ3ZbMF0pKQogICAgICAgICAgcmV0dXJuIEpTX1Rocm93VHlwZUVycm9yKGN0eCwgImFyZ3VtZW50IDEgaXMgbm90IGEgZnVuY3Rpb24iKTsKICAgICAgICBwcmVkID0gYXJndlswXTsKICAgICAgICB3aGlsZShsZXgtPnBvcyA8IGxleC0+c2l6ZSkgewogICAgICAgICAgc2l6ZV90IG47CiAgICAgICAgICBjb25zdCB1aW50OF90KiBwID0gaW5wdXRfYnVmZmVyX3BlZWsoJmxleC0+aW5wdXQsICZuKTsKICAgICAgICAgIEpTVmFsdWUgc3RyID0gSlNfTmV3U3RyaW5nTGVuKGN0eCwgKGNvbnN0IGNoYXIqKXAsIG4pOwogICAgICAgICAgSlNWYWx1ZSByZXQgPSBKU19DYWxsKGN0eCwgcHJlZCwgdGhpc192YWwsIDEsICZzdHIpOwogICAgICAgICAgQk9PTCBiID0gSlNfVG9Cb29sKGN0eCwgcmV0KTsKICAgICAgICAgIEpTX0ZyZWVWYWx1ZShjdHgsIHJldCk7CiAgICAgICAgICBpZihiKSB7CiAgICAgICAgICAgIHJldCA9IHN0cjsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgICBKU19GcmVlVmFsdWUoY3R4LCBzdHIpOwogICAgICAgICAgaW5wdXRfYnVmZmVyX2dldGMoJmxleC0+aW5wdXQpOwogICAgICAgICAgLy8gbGV4LT5zdGFydCA9IGxleC0+cG9zOwogICAgICAgIH0KICAgICAgfQogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIE1FVEhPRF9HRVRfUkFOR0U6IHsKICAgICAgc2l6ZV90IHN0YXJ0LCBlbmQ7CiAgICAgIHN0YXJ0ID0gbGV4LT5wb3M7CiAgICAgIGVuZCA9IHN0YXJ0ICsgbGV4LT5ieXRlX2xlbmd0aDsKICAgICAgaWYoYXJnYyA+IDApIHsKICAgICAgICBqc192YWx1ZV90b3NpemUoY3R4LCAmc3RhcnQsIGFyZ3ZbMF0pOwogICAgICAgIGlmKGFyZ2MgPiAxKQogICAgICAgICAganNfdmFsdWVfdG9zaXplKGN0eCwgJmVuZCwgYXJndlsxXSk7CiAgICAgIH0KICAgICAgcmV0ID0gSlNfTmV3U3RyaW5nTGVuKGN0eCwgKGNvbnN0IGNoYXIqKSZsZXgtPmRhdGFbc3RhcnRdLCBlbmQgLSBzdGFydCk7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgTUVUSE9EX0NVUlJFTlRfTElORTogewogICAgICByZXQgPSBKU19OZXdTdHJpbmcoY3R4LCBsZXhlcl9jdXJyZW50X2xpbmUobGV4LCBjdHgpKTsKICAgICAgYnJlYWs7CiAgICB9CgogICAgY2FzZSBNRVRIT0RfVE9LRU5fQ0xBU1M6IHsKICAgICAgVG9rZW4qIHRvazsKICAgICAgTGV4ZXJSdWxlKiBydWxlOwogICAgICBpbnQzMl90IGlkID0gLTE7CgogICAgICBpZigodG9rID0gSlNfR2V0T3BhcXVlKGFyZ3ZbMF0sIGpzX3Rva2VuX2NsYXNzX2lkKSkpCiAgICAgICAgaWQgPSB0b2stPmlkOwogICAgICBlbHNlCiAgICAgICAgSlNfVG9JbnQzMihjdHgsICZpZCwgYXJndlswXSk7CgogICAgICBpZigocnVsZSA9IGxleGVyX3J1bGVfYXQobGV4LCBpZCkpKQogICAgICAgIHJldCA9IEpTX05ld1N0cmluZyhjdHgsIHJ1bGUtPm5hbWUpOwogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIE1FVEhPRF9HRVRfUlVMRTogewogICAgICBMZXhlclJ1bGUqIHJ1bGU7CgogICAgICBpZihKU19Jc1N0cmluZyhhcmd2WzBdKSkgewogICAgICAgIHNpemVfdCBsZW47CiAgICAgICAgY29uc3QgY2hhciogbmFtZSA9IEpTX1RvQ1N0cmluZ0xlbihjdHgsICZsZW4sIGFyZ3ZbMF0pOwogICAgICAgIGlmKCEocnVsZSA9IGxleGVyX3J1bGVfZmluZChsZXgsIG5hbWUpKSkKICAgICAgICAgIHJ1bGUgPSBsZXhlcl9maW5kX2RlZmluaXRpb24obGV4LCBuYW1lLCBsZW4pOwogICAgICAgIEpTX0ZyZWVDU3RyaW5nKGN0eCwgbmFtZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaW50MzJfdCBpZCA9IC0xOwogICAgICAgIEpTX1RvSW50MzIoY3R4LCAmaWQsIGFyZ3ZbMF0pOwogICAgICAgIHJ1bGUgPSBsZXhlcl9ydWxlX2F0KGxleCwgaWQpOwogICAgICB9CgogICAgICBpZihydWxlKSB7CiAgICAgICAgcmV0ID0ganNfbGV4ZXJfcnVsZV9uZXcoY3R4LCBsZXgsIHJ1bGUpOwogICAgICB9CgogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIE1FVEhPRF9FUlJPUjogewogICAgICBjb25zdCBjaGFyKiBtZXNzYWdlID0gSlNfVG9DU3RyaW5nKGN0eCwgYXJndlswXSk7CiAgICAgIGNoYXIqIGxvY2F0aW9uID0gbG9jYXRpb25fdG9zdHJpbmcoJmxleC0+bG9jLCBjdHgpOwoKICAgICAgcmV0ID0gSlNfVGhyb3dTeW50YXhFcnJvcihjdHgsICIlcyBhdCAlcyIsIG1lc3NhZ2UsIGxvY2F0aW9uKTsKCiAgICAgIEpTX0ZyZWVDU3RyaW5nKGN0eCwgbWVzc2FnZSk7CiAgICAgIGpzX2ZyZWUoY3R4LCBsb2NhdGlvbik7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgTUVUSE9EX1BVU0hfU1RBVEU6IHsKICAgICAgY29uc3QgY2hhciogc3RhdGUgPSBKU19Ub0NTdHJpbmcoY3R4LCBhcmd2WzBdKTsKICAgICAgaW50IGlkOwoKICAgICAgaWQgPSBsZXhlcl9zdGF0ZV9wdXNoKGxleCwgc3RhdGUpOwogICAgICAvLyBwcmludGYoIlslenVdIHB1c2hTdGF0ZSgnJXMnKVxuIiwgbGV4ZXJfc3RhdGVfZGVwdGgobGV4KSwgc3RhdGUpOwogICAgICByZXQgPSBKU19OZXdJbnQzMihjdHgsIGlkKTsKICAgICAgSlNfRnJlZUNTdHJpbmcoY3R4LCBzdGF0ZSk7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgTUVUSE9EX1BPUF9TVEFURTogewogICAgICBpbnQgaWQ7CiAgICAgIGlmKGxleGVyX3N0YXRlX2RlcHRoKGxleCkgPiAwKSB7CiAgICAgICAgaWQgPSBsZXhlcl9zdGF0ZV9wb3AobGV4KTsKICAgICAgICAvLyBwcmludGYoIlslenVdIHBvcFN0YXRlKCkgPSAnJXMnXG4iLCBsZXhlcl9zdGF0ZV9kZXB0aChsZXgpLAogICAgICAgIC8vIGxleGVyX3N0YXRlX25hbWUobGV4LCBpZCkpOwogICAgICAgIHJldCA9IEpTX05ld0ludDMyKGN0eCwgaWQpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldCA9IEpTX1Rocm93SW50ZXJuYWxFcnJvcihjdHgsICJsZXhlciAoJXMpIGRlcHRoICV6dSIsIGxleGVyX3N0YXRlX3RvcG5hbWUobGV4KSwgbGV4ZXJfc3RhdGVfZGVwdGgobGV4KSk7CiAgICAgIH0KCiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgTUVUSE9EX1RPUF9TVEFURTogewogICAgICBpbnQzMl90IGluZGV4ID0gMCwgaWQ7CiAgICAgIGlmKGFyZ2MgPiAwICYmIEpTX0lzTnVtYmVyKGFyZ3ZbMF0pKQogICAgICAgIEpTX1RvSW50MzIoY3R4LCAmaW5kZXgsIGFyZ3ZbMF0pOwoKICAgICAgaWYoKGlkID0gaW5kZXggPiAwID8gbGV4ZXJfc3RhdGVfdG9wKGxleCwgaW5kZXgpIDogbGV4LT5zdGF0ZSkgPj0gMCkKICAgICAgICByZXQgPSBKU19OZXdTdHJpbmcoY3R4LCBsZXhlcl9zdGF0ZV9uYW1lKGxleCwgaWQpKTsKICAgICAgYnJlYWs7CiAgICB9CiAgfQogIHJldHVybiByZXQ7Cn0KCmVudW0gewogIFBST1BfU0laRSA9IDAsCiAgUFJPUF9QT1MsCiAgUFJPUF9FT0YsCiAgUFJPUF9GSUxFTkFNRSwKICBQUk9QX0xPQywKICBQUk9QX1JVTEVOQU1FUywKICBQUk9QX1JVTEVTLAogIFBST1BfTU9ERSwKICBQUk9QX1NFUSwKICBQUk9QX0JZVEVfTEVOR1RILAogIFBST1BfQ0hBUl9MRU5HVEgsCiAgUFJPUF9TVEFURSwKICBQUk9QX1NUQVRFUywKICBQUk9QX1NUQVRFX0RFUFRILAogIFBST1BfU1RBVEVfU1RBQ0ssCiAgUFJPUF9TT1VSQ0UsCiAgUFJPUF9MRVhFTUUsCiAgUFJPUF9UT0tFTiwKfTsKCkpTVmFsdWUKanNfbGV4ZXJfZ2V0KEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBtYWdpYykgewogIExleGVyKiBsZXg7CiAgSlNWYWx1ZSByZXQgPSBKU19VTkRFRklORUQ7CgogIGlmKCEobGV4ID0ganNfbGV4ZXJfZGF0YTIoY3R4LCB0aGlzX3ZhbCkpKQogICAgcmV0dXJuIEpTX0VYQ0VQVElPTjsKCiAgc3dpdGNoKG1hZ2ljKSB7CiAgICBjYXNlIFBST1BfUE9TOiB7CiAgICAgIHJldCA9IEpTX05ld0ludDY0KGN0eCwgbGV4LT5wb3MpOwogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIFBST1BfU0laRTogewogICAgICByZXQgPSBKU19OZXdJbnQ2NChjdHgsIGxleC0+c2l6ZSk7CiAgICAgIGJyZWFrOwogICAgfQoKICAgICAgLyogICAgY2FzZSBQUk9QX1NUQVJUOiB7CiAgICAgICAgICAgIHJldCA9IEpTX05ld0ludDY0KGN0eCwgbGV4LT5zdGFydCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfSovCgogICAgY2FzZSBQUk9QX0VPRjogewogICAgICByZXQgPSBKU19OZXdCb29sKGN0eCwgaW5wdXRfYnVmZmVyX2VvZigmbGV4LT5pbnB1dCkpOwogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIFBST1BfRklMRU5BTUU6IHsKICAgICAgcmV0ID0gbGV4LT5sb2MuZmlsZSA+IC0xID8gSlNfQXRvbVRvVmFsdWUoY3R4LCBsZXgtPmxvYy5maWxlKSA6IEpTX1VOREVGSU5FRDsKICAgICAgYnJlYWs7CiAgICB9CgogICAgY2FzZSBQUk9QX0xPQzogewogICAgICBMb2NhdGlvbiogbG9jOwoKICAgICAgaWYoKGxvYyA9IGxvY2F0aW9uX25ldyhjdHgpKSkgewogICAgICAgIGxvY2F0aW9uX2NvcHkobG9jLCAmbGV4LT5sb2MsIGN0eCk7CiAgICAgICAgcmV0ID0ganNfbG9jYXRpb25fd3JhcChjdHgsIGxvYyk7CiAgICAgIH0KICAgICAgYnJlYWs7CiAgICB9CgogICAgY2FzZSBQUk9QX1JVTEVOQU1FUzogewogICAgICBMZXhlclJ1bGUqIHJ1bGU7CiAgICAgIHVpbnQzMl90IGkgPSAwOwogICAgICByZXQgPSBKU19OZXdBcnJheShjdHgpOwoKICAgICAgdmVjdG9yX2ZvcmVhY2hfdCgmbGV4LT5ydWxlcywgcnVsZSkgeyBKU19TZXRQcm9wZXJ0eVVpbnQzMihjdHgsIHJldCwgaSsrLCBKU19OZXdTdHJpbmcoY3R4LCBydWxlLT5uYW1lKSk7IH0KICAgICAgYnJlYWs7CiAgICB9CgogICAgY2FzZSBQUk9QX1JVTEVTOiB7CiAgICAgIExleGVyUnVsZSogcnVsZTsKICAgICAgdWludDMyX3QgaSA9IDA7CiAgICAgIHJldCA9IEpTX05ld09iamVjdChjdHgpOwoKICAgICAgdmVjdG9yX2ZvcmVhY2hfdCgmbGV4LT5ydWxlcywgcnVsZSkgewogICAgICAgIC8vIHByaW50ZigicnVsZSAjJSIgUFJJdTMyICIgJyVzJyAnJXMnXG4iLCBpLCBydWxlLT5uYW1lLCBydWxlLT5leHByKTsKICAgICAgICBKU19TZXRQcm9wZXJ0eVN0cihjdHgsIHJldCwgcnVsZS0+bmFtZSwgSlNfTmV3VWludDMyKGN0eCwgaSkpOwogICAgICAgIGkrKzsKICAgICAgfQogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIFBST1BfTU9ERTogewogICAgICByZXQgPSBKU19OZXdJbnQzMihjdHgsIGxleC0+bW9kZSk7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgUFJPUF9TRVE6IHsKICAgICAgcmV0ID0gSlNfTmV3SW50NjQoY3R4LCBsZXgtPnNlcSk7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgUFJPUF9CWVRFX0xFTkdUSDogewogICAgICByZXQgPSBKU19OZXdVaW50MzIoY3R4LCBsZXgtPmJ5dGVfbGVuZ3RoKTsKICAgICAgYnJlYWs7CiAgICB9CgogICAgY2FzZSBQUk9QX0NIQVJfTEVOR1RIOiB7CiAgICAgIHJldCA9IEpTX05ld1VpbnQzMihjdHgsIGxleGVyX2NoYXJsZW4obGV4KSk7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgUFJPUF9TVEFURTogewogICAgICByZXQgPSBKU19OZXdJbnQzMihjdHgsIGxleC0+c3RhdGUpOwogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIFBST1BfU1RBVEVTOiB7CiAgICAgIHNpemVfdCBpID0gMDsKICAgICAgcmV0ID0gSlNfTmV3QXJyYXkoY3R4KTsKICAgICAgZm9yKDs7KSB7CiAgICAgICAgY2hhciogbmFtZTsKICAgICAgICBpZigobmFtZSA9IGxleGVyX3N0YXRlX25hbWUobGV4LCBpKSkgPT0gMCkKICAgICAgICAgIGJyZWFrOwogICAgICAgIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgcmV0LCBpKyssIEpTX05ld1N0cmluZyhjdHgsIG5hbWUpKTsKICAgICAgfQogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIFBST1BfU1RBVEVfREVQVEg6IHsKICAgICAgcmV0ID0gSlNfTmV3VWludDMyKGN0eCwgbGV4ZXJfc3RhdGVfZGVwdGgobGV4KSk7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgUFJPUF9TVEFURV9TVEFDSzogewogICAgICBzaXplX3QgaSA9IDAsIG4gPSB2ZWN0b3Jfc2l6ZSgmbGV4LT5zdGF0ZV9zdGFjaywgc2l6ZW9mKGludDMyX3QpKTsKICAgICAgcmV0ID0gSlNfTmV3QXJyYXkoY3R4KTsKICAgICAgZm9yKDsgaSA8IG47IGkrKykgewogICAgICAgIGludDMyX3Qgc3RhdGUgPSAqKGludDMyX3QqKXZlY3Rvcl9hdCgmbGV4LT5zdGF0ZV9zdGFjaywgc2l6ZW9mKGludDMyX3QpLCBpKTsKICAgICAgICBjaGFyKiBuYW1lOwogICAgICAgIGlmKChuYW1lID0gbGV4ZXJfc3RhdGVfbmFtZShsZXgsIHN0YXRlKSkgPT0gMCkKICAgICAgICAgIGJyZWFrOwogICAgICAgIEpTX1NldFByb3BlcnR5VWludDMyKGN0eCwgcmV0LCBpLCBKU19OZXdTdHJpbmcoY3R4LCBuYW1lKSk7CiAgICAgIH0KICAgICAgSlNfU2V0UHJvcGVydHlVaW50MzIoY3R4LCByZXQsIGksIEpTX05ld1N0cmluZyhjdHgsIGxleGVyX3N0YXRlX25hbWUobGV4LCBsZXgtPnN0YXRlKSkpOwogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIFBST1BfU09VUkNFOiB7CiAgICAgIHJldCA9IEpTX05ld1N0cmluZ0xlbihjdHgsIChjb25zdCBjaGFyKilsZXgtPmRhdGEsIGxleC0+c2l6ZSk7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBQUk9QX0xFWEVNRTogewogICAgICByZXQgPSBKU19OZXdTdHJpbmdMZW4oY3R4LCAoY29uc3QgY2hhciopbGV4LT5kYXRhICsgbGV4LT5wb3MsIGxleC0+Ynl0ZV9sZW5ndGgpOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgUFJPUF9UT0tFTjogewogICAgICBUb2tlbiogdG9rOwoKICAgICAgaWYobGV4LT50b2tlbl9pZCA8IDApCiAgICAgICAgcmV0ID0gSlNfTlVMTDsKICAgICAgZWxzZSBpZigodG9rID0gbGV4ZXJfdG9rZW4obGV4LCBsZXgtPnRva2VuX2lkLCBjdHgpKSkKICAgICAgICByZXQgPSBqc190b2tlbl93cmFwKGN0eCwgdG9rKTsKCiAgICAgIGJyZWFrOwogICAgfQogIH0KICByZXR1cm4gcmV0Owp9CgpKU1ZhbHVlCmpzX2xleGVyX3NldChKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsLCBKU1ZhbHVlQ29uc3QgdmFsdWUsIGludCBtYWdpYykgewogIExleGVyKiBsZXg7CgogIGlmKCEobGV4ID0ganNfbGV4ZXJfZGF0YTIoY3R4LCB0aGlzX3ZhbCkpKQogICAgcmV0dXJuIEpTX0VYQ0VQVElPTjsKCiAgc3dpdGNoKG1hZ2ljKSB7CiAgICBjYXNlIFBST1BfUE9TOiB7CiAgICAgIFRva2VuKiB0b2s7CgogICAgICBpZigodG9rID0ganNfdG9rZW5fZGF0YSh2YWx1ZSkpKSB7CiAgICAgICAgbGV4LT5wb3MgPSB0b2stPmxvYy0+Y2hhcl9vZmZzZXQ7CgogICAgICAgIGxvY2F0aW9uX3JlbGVhc2UoJmxleC0+bG9jLCBjdHgpOwogICAgICAgIGxvY2F0aW9uX2NvcHkoJmxleC0+bG9jLCB0b2stPmxvYywgY3R4KTsKICAgICAgICAvLyAgICAgICAgbGV4LT5sb2MgPSB0b2stPmxvYzsKICAgICAgfSAvKiBlbHNlIGlmKEpTX0lzTnVtYmVyKHZhbHVlKSkgewogICAgICAgICB1aW50NjRfdCBuZXdwb3MgPSBsZXgtPnBvczsKICAgICAgICAgSlNfVG9JbmRleChjdHgsICZuZXdwb3MsIHZhbHVlKTsKICAgICAgICAgbGV4LT5wb3MgPSBuZXdwb3M7CiAgICAgICB9ICovCiAgICAgIGVsc2UgewogICAgICAgIHJldHVybiBKU19UaHJvd1R5cGVFcnJvcihjdHgsICJsZXhlci5wb3MgbXVzdCBiZSBhIExvY2F0aW9uIG9iamVjdCIpOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgUFJPUF9CWVRFX0xFTkdUSDogewogICAgICBUb2tlbiogdG9rOwogICAgICBpZihKU19Jc051bWJlcih2YWx1ZSkpIHsKICAgICAgICBqc192YWx1ZV90b3NpemUoY3R4LCAmbGV4LT5ieXRlX2xlbmd0aCwgdmFsdWUpOwogICAgICB9IGVsc2UgaWYoKHRvayA9IGpzX3Rva2VuX2RhdGEodmFsdWUpKSkgewogICAgICAgIGxleC0+Ynl0ZV9sZW5ndGggPSB0b2stPmJ5dGVfbGVuZ3RoOwogICAgICB9CiAgICAgIGJyZWFrOwogICAgfQoKICAgIGNhc2UgUFJPUF9GSUxFTkFNRTogewogICAgICBpZihsZXgtPmxvYy5maWxlID4gLTEpCiAgICAgICAgSlNfRnJlZUF0b20oY3R4LCBsZXgtPmxvYy5maWxlKTsKICAgICAgbGV4LT5sb2MuZmlsZSA9IEpTX1ZhbHVlVG9BdG9tKGN0eCwgdmFsdWUpOwogICAgICBicmVhazsKICAgIH0KCiAgICBjYXNlIFBST1BfTU9ERTogewogICAgICBpbnQzMl90IG07CiAgICAgIEpTX1RvSW50MzIoY3R4LCAmbSwgdmFsdWUpOwogICAgICBsZXgtPm1vZGUgPSBtOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgUFJPUF9TRVE6IHsKICAgICAgdWludDY0X3QgczsKICAgICAgSlNfVG9JbmRleChjdHgsICZzLCB2YWx1ZSk7CiAgICAgIGxleC0+c2VxID0gczsKICAgICAgYnJlYWs7CiAgICB9CiAgfQogIHJldHVybiBKU19VTkRFRklORUQ7Cn0KCkpTVmFsdWUKanNfbGV4ZXJfdG9rZW5zKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwpIHsKICBMZXhlciogbGV4OwogIExleGVyUnVsZSogcnVsZTsKICBpbnQgaSA9IDA7CiAgSlNWYWx1ZSByZXQgPSBKU19VTkRFRklORUQ7CgogIGlmKCEobGV4ID0ganNfbGV4ZXJfZGF0YTIoY3R4LCB0aGlzX3ZhbCkpKQogICAgcmV0dXJuIEpTX0VYQ0VQVElPTjsKCiAgcmV0ID0gSlNfTmV3QXJyYXkoY3R4KTsKCiAgdmVjdG9yX2ZvcmVhY2hfdCgmbGV4LT5ydWxlcywgcnVsZSkgewogICAgY29uc3QgY2hhciogbmFtZSA9IHJ1bGUtPm5hbWU7CgogICAgSlNfU2V0UHJvcGVydHlVaW50MzIoY3R4LCByZXQsIGkrKywgSlNfTmV3U3RyaW5nKGN0eCwgbmFtZSkpOwogIH0KICByZXR1cm4gcmV0Owp9CgpKU1ZhbHVlCmpzX2xleGVyX3N0YXRlcyhKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsKSB7CiAgTGV4ZXIqIGxleDsKICBjaGFyKiogY29uZDsKICB1aW50MzJfdCBpID0gMDsKICBKU1ZhbHVlIHJldCA9IEpTX1VOREVGSU5FRDsKCiAgaWYoIShsZXggPSBqc19sZXhlcl9kYXRhMihjdHgsIHRoaXNfdmFsKSkpCiAgICByZXR1cm4gSlNfRVhDRVBUSU9OOwoKICByZXQgPSBKU19OZXdBcnJheShjdHgpOwoKICB2ZWN0b3JfZm9yZWFjaF90KCZsZXgtPnN0YXRlcywgY29uZCkgeyBKU19TZXRQcm9wZXJ0eVVpbnQzMihjdHgsIHJldCwgaSsrLCBKU19OZXdTdHJpbmcoY3R4LCAqY29uZCkpOyB9CgogIHJldHVybiByZXQ7Cn0KCkpTVmFsdWUKanNfbGV4ZXJfc3RhdGVzdGFjayhKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsKSB7CiAgTGV4ZXIqIGxleDsKICBpbnQzMl90KiBzdGFjazsKICBzaXplX3Qgc2l6ZTsKICBKU1ZhbHVlIGN0b3IsIGJ1ZiwgcmV0ID0gSlNfVU5ERUZJTkVEOwoKICBpZighKGxleCA9IGpzX2xleGVyX2RhdGEyKGN0eCwgdGhpc192YWwpKSkKICAgIHJldHVybiBKU19FWENFUFRJT047CgogIHNpemUgPSB2ZWN0b3Jfc2l6ZSgmbGV4LT5zdGF0ZV9zdGFjaywgc2l6ZW9mKGludDMyX3QpKSArIDE7CiAgc3RhY2sgPSBqc19tYWxsb2NfcnQoSlNfR2V0UnVudGltZShjdHgpLCBzaXplb2YoaW50MzJfdCkgKiBzaXplKTsKCiAgbWVtY3B5KHN0YWNrLCB2ZWN0b3JfYmVnaW4oJmxleC0+c3RhdGVfc3RhY2spLCBzaXplb2YoaW50MzJfdCkgKiAoc2l6ZSAtIDEpKTsKCiAgc3RhY2tbc2l6ZSAtIDFdID0gbGV4LT5zdGF0ZTsKCiAgYnVmID0gSlNfTmV3QXJyYXlCdWZmZXIoY3R4LCAodm9pZCopc3RhY2ssIHNpemVvZihpbnQzMl90KSAqIHNpemUsIChKU0ZyZWVBcnJheUJ1ZmZlckRhdGFGdW5jKikmanNfZnJlZV9ydCwgc3RhY2ssIEZBTFNFKTsKCiAgY3RvciA9IGpzX2dsb2JhbF9nZXRfc3RyKGN0eCwgIkludDMyQXJyYXkiKTsKCiAgcmV0ID0gSlNfQ2FsbENvbnN0cnVjdG9yKGN0eCwgY3RvciwgMSwgJmJ1Zik7CgogIEpTX0ZyZWVWYWx1ZShjdHgsIGN0b3IpOwogIEpTX0ZyZWVWYWx1ZShjdHgsIGJ1Zik7CgogIHJldHVybiByZXQ7Cn0KCkpTVmFsdWUKanNfbGV4ZXJfZXNjYXBlKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdLCBpbnQgbWFnaWMpIHsKICBJbnB1dEJ1ZmZlciBpbnB1dCA9IGpzX2lucHV0X2NoYXJzKGN0eCwgYXJndlswXSk7CiAgRHluQnVmIG91dHB1dDsKICBqc19kYnVmX2luaXQoY3R4LCAmb3V0cHV0KTsKCiAgbWFnaWMgPyBkYnVmX3B1dF91bmVzY2FwZWRfcHJlZCgmb3V0cHV0LCAoY29uc3QgY2hhciopaW5wdXQuZGF0YSwgaW5wdXQuc2l6ZSwgbGV4ZXJfdW5lc2NhcGVfcHJlZCkKICAgICAgICA6IGRidWZfcHV0X2VzY2FwZWRfcHJlZCgmb3V0cHV0LCAoY29uc3QgY2hhciopaW5wdXQuZGF0YSwgaW5wdXQuc2l6ZSwgbGV4ZXJfZXNjYXBlX3ByZWQpOwoKICByZXR1cm4gZGJ1Zl90b3N0cmluZ19mcmVlKCZvdXRwdXQsIGN0eCk7Cn0KCkpTVmFsdWUKanNfbGV4ZXJfdG9zdHJpbmcoSlNDb250ZXh0KiBjdHgsIEpTVmFsdWVDb25zdCB0aGlzX3ZhbCwgaW50IGFyZ2MsIEpTVmFsdWVDb25zdCBhcmd2W10pIHsKICBKU1ZhbHVlIHJldCA9IEpTX1VOREVGSU5FRDsKCiAgaWYoanNfaXNfcmVnZXhwKGN0eCwgYXJndlswXSkgfHwgSlNfSXNTdHJpbmcoYXJndlswXSkpIHsKICAgIFJlZ0V4cCByZTsKICAgIHJlID0gcmVnZXhwX2Zyb21fYXJndihhcmdjLCBhcmd2LCBjdHgpOwogICAgcmV0ID0gSlNfTmV3U3RyaW5nKGN0eCwgcmUuc291cmNlKTsKICB9IGVsc2UgewogICAgSW5wdXRCdWZmZXIgaW5wdXQ7CiAgICBpbnB1dCA9IGpzX2lucHV0X2NoYXJzKGN0eCwgYXJndlswXSk7CiAgICByZXQgPSBKU19OZXdTdHJpbmdMZW4oY3R4LCAoY29uc3QgY2hhciopaW5wdXQuZGF0YSwgaW5wdXQuc2l6ZSk7CiAgICBpbnB1dF9idWZmZXJfZnJlZSgmaW5wdXQsIGN0eCk7CiAgfQogIHJldHVybiByZXQ7Cn0KCkpTVmFsdWUKanNfbGV4ZXJfbGV4KEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdKSB7CiAgSlNWYWx1ZSByZXQgPSBKU19VTkRFRklORUQ7CiAgTGV4ZXIqIGxleDsKICBpbnQgaWQsIHN0YXRlID0gLTE7CgogIGlmKCEobGV4ID0ganNfbGV4ZXJfZGF0YTIoY3R4LCB0aGlzX3ZhbCkpKQogICAgcmV0dXJuIEpTX0VYQ0VQVElPTjsKCiAgaWYoYXJnYyA+IDAgJiYgSlNfSXNTdHJpbmcoYXJndlswXSkpIHsKICAgIGNvbnN0IGNoYXIqIG5hbWUgPSBKU19Ub0NTdHJpbmcoY3R4LCBhcmd2WzBdKTsKICAgIHN0YXRlID0gbGV4ZXJfc3RhdGVfcHVzaChsZXgsIG5hbWUpOwogICAgSlNfRnJlZUNTdHJpbmcoY3R4LCBuYW1lKTsKICB9CgogIGlkID0gbGV4ZXJfbGV4KGxleCwgY3R4LCB0aGlzX3ZhbCwgYXJnYywgYXJndik7CgogIGlmKHN0YXRlID4gLTEpCiAgICBsZXhlcl9zdGF0ZV9wb3AobGV4KTsKCiAgc3dpdGNoKGlkKSB7CiAgICBjYXNlIExFWEVSX0VSUk9SX05PTUFUQ0g6IHsKICAgICAgY2hhciogbGV4ZW1lID0gbGV4ZXJfbGV4ZW1lX3MobGV4LCBjdHgpOwogICAgICBjaGFyKiBmaWxlID0gbG9jYXRpb25fZmlsZSgmbGV4LT5sb2MsIGN0eCk7CgogICAgICByZXQgPSBKU19UaHJvd0ludGVybmFsRXJyb3IoY3R4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiVzOiUiIFBSSXUzMiAiOiUiIFBSSXUzMiAiOiBObyBtYXRjaGluZyB0b2tlbiAoJWQ6ICVzKVxuJS4qc1xuJSpzIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXgtPmxvYy5saW5lICsgMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxleC0+bG9jLmNvbHVtbiArIDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXhlcl9zdGF0ZV90b3AobGV4LCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxleGVyX3N0YXRlX25hbWUobGV4LCBsZXhlcl9zdGF0ZV90b3AobGV4LCAwKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiAgIGxleGVtZSwqLwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGludCkoYnl0ZV9jaHIoKGNvbnN0IGNoYXIqKSZsZXgtPmRhdGFbbGV4LT5wb3NdLCBsZXgtPnNpemUgLSBsZXgtPnBvcywgJ1xuJykgKyBsZXgtPmxvYy5jb2x1bW4pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmxleC0+ZGF0YVtsZXgtPnBvcyAtIGxleC0+bG9jLmNvbHVtbl0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXgtPmxvYy5jb2x1bW4gKyAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIl4iKTsKICAgICAgaWYoZmlsZSkKICAgICAgICBqc19mcmVlKGN0eCwgZmlsZSk7CiAgICAgIGpzX2ZyZWUoY3R4LCBsZXhlbWUpOwogICAgICBicmVhazsKICAgIH0KICAgIGNhc2UgTEVYRVJfRU9GOiB7CiAgICAgIHJldCA9IEpTX05VTEw7CiAgICAgIGJyZWFrOwogICAgfQogICAgY2FzZSBMRVhFUl9FWENFUFRJT046IHsKICAgICAgcmV0ID0gSlNfRVhDRVBUSU9OOwogICAgICBicmVhazsKICAgIH0KICAgIGRlZmF1bHQ6IHsKICAgICAgcmV0ID0gSlNfTmV3SW50MzIoY3R4LCBpZCk7CiAgICAgIGJyZWFrOwogICAgfQogIH0KCiAgcmV0dXJuIHJldDsKfQoKZW51bSB7CiAgWUlFTERfSUQgPSAwLAogIFlJRUxEX09CSiA9IDEsCiAgWUlFTERfRE9ORV9WQUxVRSA9IDIsCn07CgpKU1ZhbHVlCmpzX2xleGVyX25leHRmbihKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsLCBpbnQgYXJnYywgSlNWYWx1ZUNvbnN0IGFyZ3ZbXSwgaW50IG1hZ2ljKSB7CiAgSlNWYWx1ZSByZXQsIHZhbHVlID0gSlNfVU5ERUZJTkVEOwogIExleGVyKiBsZXg7CgogIGlmKCEobGV4ID0ganNfbGV4ZXJfZGF0YTIoY3R4LCB0aGlzX3ZhbCkpKQogICAgcmV0dXJuIEpTX0VYQ0VQVElPTjsKCiAgcmV0ID0ganNfbGV4ZXJfbGV4KGN0eCwgdGhpc192YWwsIGFyZ2MsIGFyZ3YpOwoKICBpZihKU19Jc051bWJlcihyZXQpKSB7CiAgICBpbnQzMl90IGlkOwoKICAgIEpTX1RvSW50MzIoY3R4LCAmaWQsIHJldCk7CgogICAgaWYobWFnaWMgJiBZSUVMRF9PQkopIHsKICAgICAgVG9rZW4qIHRvayA9IGxleGVyX3Rva2VuKGxleCwgaWQsIGN0eCk7CiAgICAgIHZhbHVlID0ganNfdG9rZW5fd3JhcChjdHgsIHRvayk7CiAgICB9IGVsc2UgewogICAgICB2YWx1ZSA9IEpTX05ld0ludDMyKGN0eCwgaWQpOwogICAgfQogIH0gZWxzZSB7CiAgICB2YWx1ZSA9IEpTX0R1cFZhbHVlKGN0eCwgcmV0KTsKICB9CiAgSlNfRnJlZVZhbHVlKGN0eCwgcmV0KTsKCiAgaWYobWFnaWMgJiBZSUVMRF9ET05FX1ZBTFVFKSB7CiAgICBKU1ZhbHVlIHJldCA9IEpTX05ld09iamVjdChjdHgpOwogICAgSlNfU2V0UHJvcGVydHlTdHIoY3R4LCByZXQsICJ2YWx1ZSIsIHZhbHVlKTsKICAgIEpTX1NldFByb3BlcnR5U3RyKGN0eCwgcmV0LCAiZG9uZSIsIEpTX05ld0Jvb2woY3R4LCBKU19Jc1VuZGVmaW5lZCh2YWx1ZSkpKTsKICAgIHJldHVybiByZXQ7CiAgfQoKICByZXR1cm4gdmFsdWU7Cn0KCkpTVmFsdWUKanNfbGV4ZXJfbmV4dChKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsLCBpbnQgYXJnYywgSlNWYWx1ZUNvbnN0IGFyZ3ZbXSwgQk9PTCogcGRvbmUsIGludCBtYWdpYykgewogIEpTVmFsdWUgcmV0ID0ganNfbGV4ZXJfbmV4dGZuKGN0eCwgdGhpc192YWwsIGFyZ2MsIGFyZ3YsIG1hZ2ljKTsKCiAgKnBkb25lID0gSlNfSXNVbmRlZmluZWQocmV0KTsKCiAgcmV0dXJuIHJldDsKfQoKSlNWYWx1ZQpqc19sZXhlcl9jYWxsKEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgZnVuY19vYmosIEpTVmFsdWVDb25zdCB0aGlzX3ZhbCwgaW50IGFyZ2MsIEpTVmFsdWVDb25zdCBhcmd2W10sIGludCBmbGFncykgewogIExleGVyKiBsZXg7CiAgaW50MzJfdCByZXN1bHQ7CiAgSlNWYWx1ZSByZXQgPSBKU19VTkRFRklORUQ7CiAgSlNWYWx1ZUNvbnN0IGFyZyA9IGFyZ2MgPiAwID8gYXJndlswXSA6IEpTX1VOREVGSU5FRDsKCiAgaWYoIShsZXggPSBKU19HZXRPcGFxdWUyKGN0eCwgZnVuY19vYmosIGpzX2xleGVyX2NsYXNzX2lkKSkpCiAgICByZXR1cm4gSlNfRVhDRVBUSU9OOwoKICBpZihhcmdjID4gMCAmJiBKU19Jc051bWJlcihhcmd2WzBdKSkgewogICAgSlNfU2V0UHJvcGVydHlTdHIoY3R4LCBmdW5jX29iaiwgIm1hc2siLCBKU19EdXBWYWx1ZShjdHgsIGFyZ3ZbMF0pKTsKICB9CgogIC8qaWYoYXJnYyA+IDEgJiYgSlNfSXNOdW1iZXIoYXJndlsxXSkpIHsKICAgIEpTX1NldFByb3BlcnR5U3RyKGN0eCwgZnVuY19vYmosICJza2lwIiwgSlNfRHVwVmFsdWUoY3R4LCBhcmd2WzFdKSk7CiAgfSovCgogIHJldHVybiBKU19EdXBWYWx1ZShjdHgsIGZ1bmNfb2JqKTsKfQoKSlNWYWx1ZQpqc19sZXhlcl9pdGVyYXRvcihKU0NvbnRleHQqIGN0eCwgSlNWYWx1ZUNvbnN0IHRoaXNfdmFsLCBpbnQgYXJnYywgSlNWYWx1ZUNvbnN0IGFyZ3ZbXSkgewogIEpTVmFsdWUgbmV4dCwgcmV0ID0gSlNfTmV3T2JqZWN0KGN0eCk7CgogIG5leHQgPSBKU19OZXdDRnVuY3Rpb24yKGN0eCwgKEpTQ0Z1bmN0aW9uKikmanNfbGV4ZXJfbmV4dGZuLCAibmV4dCIsIDAsIEpTX0NGVU5DX2dlbmVyaWNfbWFnaWMsIFlJRUxEX0lEIHwgWUlFTERfRE9ORV9WQUxVRSk7CgogIEpTX1NldFByb3BlcnR5U3RyKGN0eCwgcmV0LCAibmV4dCIsIGpzX2Z1bmN0aW9uX2JpbmRfdGhpcyhjdHgsIG5leHQsIHRoaXNfdmFsKSk7CiAgcmV0dXJuIHJldDsKCiAgcmV0dXJuIEpTX0R1cFZhbHVlKGN0eCwgdGhpc192YWwpOwp9CgpzdGF0aWMgSlNWYWx1ZQpqc19sZXhlcl9pbnNwZWN0KEpTQ29udGV4dCogY3R4LCBKU1ZhbHVlQ29uc3QgdGhpc192YWwsIGludCBhcmdjLCBKU1ZhbHVlQ29uc3QgYXJndltdKSB7CiAgTGV4ZXIqIGxleDsKCiAgaWYoIShsZXggPSBqc19sZXhlcl9kYXRhMihjdHgsIHRoaXNfdmFsKSkpCiAgICByZXR1cm4gSlNfRVhDRVBUSU9OOwoKICBKU1ZhbHVlIG9iaiA9IEpTX05ld09iamVjdENsYXNzKGN0eCwganNfbGV4ZXJfY2xhc3NfaWQpOwoKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAiYnl0ZWxlbiIsIEpTX05ld1VpbnQzMihjdHgsIGxleC0+Ynl0ZV9sZW5ndGgpLCBKU19QUk9QX0VOVU1FUkFCTEUpOwogIEpTX0RlZmluZVByb3BlcnR5VmFsdWVTdHIoY3R4LCBvYmosICJ0b2tpZCIsIEpTX05ld0ludDMyKGN0eCwgbGV4LT50b2tlbl9pZCksIEpTX1BST1BfRU5VTUVSQUJMRSk7CiAgSlNfRGVmaW5lUHJvcGVydHlWYWx1ZVN0cihjdHgsIG9iaiwgInN0YXRlIiwgSlNfTmV3SW50MzIoY3R4LCBsZXgtPnN0YXRlKSwgSlNfUFJPUF9FTlVNRVJBQkxFKTsKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAiZW9mIiwgSlNfTmV3Qm9vbChjdHgsIGlucHV0X2J1ZmZlcl9lb2YoJmxleC0+aW5wdXQpKSwgSlNfUFJPUF9FTlVNRVJBQkxFKTsKICAvLyBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAibG9jIiwganNfbG9jYXRpb25fbmV3KGN0eCwgJmxleC0+bG9jKSwgSlNfUFJPUF9FTlVNRVJBQkxFKTsKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAicG9zIiwgSlNfTmV3VWludDMyKGN0eCwgbGV4LT5wb3MpLCBKU19QUk9QX0VOVU1FUkFCTEUpOwogIEpTX0RlZmluZVByb3BlcnR5VmFsdWVTdHIoY3R4LCBvYmosICJzaXplIiwgSlNfTmV3VWludDMyKGN0eCwgbGV4LT5zaXplKSwgSlNfUFJPUF9FTlVNRVJBQkxFKTsKICBKU19EZWZpbmVQcm9wZXJ0eVZhbHVlU3RyKGN0eCwgb2JqLCAic2VxIiwgSlNfTmV3SW50NjQoY3R4LCBsZXgtPnNlcSksIEpTX1BST1BfRU5VTUVSQUJMRSk7CgogIHJldHVybiBvYmo7Cn0KCnZvaWQKanNfbGV4ZXJfZmluYWxpemVyKEpTUnVudGltZSogcnQsIEpTVmFsdWUgdmFsKSB7CiAgTGV4ZXIqIGxleDsKCiAgaWYoKGxleCA9IEpTX0dldE9wYXF1ZSh2YWwsIGpzX2xleGVyX2NsYXNzX2lkKSkpIHsKICAgIGlmKC0tbGV4LT5yZWZfY291bnQgPT0gMCkKICAgICAgbG9jYXRpb25fcmVsZWFzZV9ydCgmbGV4LT5sb2MsIHJ0KTsKICAgIGxleGVyX3JlbGVhc2VfcnQobGV4LCBydCk7CgogICAgaWYobGV4LT5yZWZfY291bnQgPT0gMCkKICAgICAganNfZnJlZV9ydChydCwgbGV4KTsKICB9CiAgLy8gSlNfRnJlZVZhbHVlUlQocnQsIHZhbCk7Cn0KCnN0YXRpYyBKU0NsYXNzRGVmIGpzX2xleGVyX2NsYXNzID0gewogICAgLmNsYXNzX25hbWUgPSAiTGV4ZXIiLAogICAgLmZpbmFsaXplciA9IGpzX2xleGVyX2ZpbmFsaXplciwKICAgIC5jYWxsID0ganNfbGV4ZXJfY2FsbCwKfTsKCnN0YXRpYyBjb25zdCBKU0NGdW5jdGlvbkxpc3RFbnRyeSBqc19sZXhlcl9wcm90b19mdW5jc1tdID0gewogICAgLy8gSlNfSVRFUkFUT1JfTkVYVF9ERUYoIm5leHQiLCAwLCBqc19sZXhlcl9uZXh0LCBZSUVMRF9PQkopLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJuZXh0IiwgMCwganNfbGV4ZXJfbmV4dGZuLCBZSUVMRF9JRCksCiAgICBKU19DRlVOQ19NQUdJQ19ERUYoIm5leHRUb2tlbiIsIDAsIGpzX2xleGVyX25leHRmbiwgWUlFTERfT0JKKSwKICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJzaXplIiwganNfbGV4ZXJfZ2V0LCBqc19sZXhlcl9zZXQsIFBST1BfU0laRSksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigicG9zIiwganNfbGV4ZXJfZ2V0LCBqc19sZXhlcl9zZXQsIFBST1BfUE9TKSwKICAgIC8vIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJzdGFydCIsIGpzX2xleGVyX2dldCwgMCwgUFJPUF9TVEFSVCksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigibG9jIiwganNfbGV4ZXJfZ2V0LCAwLCBQUk9QX0xPQyksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigiZW9mIiwganNfbGV4ZXJfZ2V0LCAwLCBQUk9QX0VPRiksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigibW9kZSIsIGpzX2xleGVyX2dldCwganNfbGV4ZXJfc2V0LCBQUk9QX01PREUpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoInNlcSIsIGpzX2xleGVyX2dldCwganNfbGV4ZXJfc2V0LCBQUk9QX1NFUSksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigiYnl0ZUxlbmd0aCIsIGpzX2xleGVyX2dldCwgMCwgUFJPUF9CWVRFX0xFTkdUSCksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigiY2hhckxlbmd0aCIsIGpzX2xleGVyX2dldCwgMCwgUFJPUF9DSEFSX0xFTkdUSCksCiAgICBKU19DR0VUU0VUX01BR0lDX0RFRigic3RhdGUiLCBqc19sZXhlcl9nZXQsIDAsIFBST1BfU1RBVEUpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoInN0YXRlcyIsIGpzX2xleGVyX2dldCwgMCwgUFJPUF9TVEFURVMpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoInN0YXRlRGVwdGgiLCBqc19sZXhlcl9nZXQsIDAsIFBST1BfU1RBVEVfREVQVEgpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoInN0YXRlU3RhY2siLCBqc19sZXhlcl9nZXQsIDAsIFBST1BfU1RBVEVfU1RBQ0spLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoInNvdXJjZSIsIGpzX2xleGVyX2dldCwgMCwgUFJPUF9TT1VSQ0UpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoImxleGVtZSIsIGpzX2xleGVyX2dldCwgMCwgUFJPUF9MRVhFTUUpLAogICAgSlNfQ0dFVFNFVF9NQUdJQ19ERUYoInRva2VuIiwganNfbGV4ZXJfZ2V0LCAwLCBQUk9QX1RPS0VOKSwKICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJmaWxlTmFtZSIsIGpzX2xleGVyX2dldCwganNfbGV4ZXJfc2V0LCBQUk9QX0ZJTEVOQU1FKSwKICAgIEpTX0NGVU5DX01BR0lDX0RFRigic2V0SW5wdXQiLCAxLCBqc19sZXhlcl9tZXRob2QsIE1FVEhPRF9TRVRfSU5QVVQpLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJza2lwQnl0ZXMiLCAwLCBqc19sZXhlcl9tZXRob2QsIE1FVEhPRF9TS0lQX0JZVEVTKSwKICAgIEpTX0NGVU5DX01BR0lDX0RFRigic2tpcFRva2VuIiwgMCwganNfbGV4ZXJfbWV0aG9kLCBNRVRIT0RfU0tJUF9UT0tFTiksCiAgICBKU19DRlVOQ19NQUdJQ19ERUYoInNraXBDaGFycyIsIDAsIGpzX2xleGVyX21ldGhvZCwgTUVUSE9EX1NLSVBfQ0hBUlMpLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJza2lwVW50aWwiLCAxLCBqc19sZXhlcl9tZXRob2QsIE1FVEhPRF9TS0lQX1VOVElMKSwKICAgIEpTX0NGVU5DX01BR0lDX0RFRigidG9rZW5DbGFzcyIsIDEsIGpzX2xleGVyX21ldGhvZCwgTUVUSE9EX1RPS0VOX0NMQVNTKSwKICAgIEpTX0NGVU5DX01BR0lDX0RFRigiZGVmaW5lIiwgMiwganNfbGV4ZXJfYWRkX3J1bGUsIDApLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJhZGRSdWxlIiwgMiwganNfbGV4ZXJfYWRkX3J1bGUsIDEpLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJnZXRSdWxlIiwgMSwganNfbGV4ZXJfbWV0aG9kLCBNRVRIT0RfR0VUX1JVTEUpLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJwdXNoU3RhdGUiLCAxLCBqc19sZXhlcl9tZXRob2QsIE1FVEhPRF9QVVNIX1NUQVRFKSwKICAgIEpTX0FMSUFTX0RFRigiYmVnaW4iLCAicHVzaFN0YXRlIiksCiAgICBKU19DRlVOQ19NQUdJQ19ERUYoInBvcFN0YXRlIiwgMCwganNfbGV4ZXJfbWV0aG9kLCBNRVRIT0RfUE9QX1NUQVRFKSwKICAgIEpTX0NGVU5DX01BR0lDX0RFRigidG9wU3RhdGUiLCAwLCBqc19sZXhlcl9tZXRob2QsIE1FVEhPRF9UT1BfU1RBVEUpLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJjdXJyZW50TGluZSIsIDAsIGpzX2xleGVyX21ldGhvZCwgTUVUSE9EX0NVUlJFTlRfTElORSksCiAgICBKU19DRlVOQ19NQUdJQ19ERUYoImJhY2siLCAwLCBqc19sZXhlcl9tZXRob2QsIE1FVEhPRF9CQUNLKSwKICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJydWxlTmFtZXMiLCBqc19sZXhlcl9nZXQsIDAsIFBST1BfUlVMRU5BTUVTKSwKICAgIEpTX0NHRVRTRVRfTUFHSUNfREVGKCJydWxlcyIsIGpzX2xleGVyX2dldCwgMCwgUFJPUF9SVUxFUyksCiAgICBKU19DRlVOQ19ERUYoImxleCIsIDAsIGpzX2xleGVyX2xleCksCiAgICBKU19DRlVOQ19ERUYoImluc3BlY3QiLCAwLCBqc19sZXhlcl9pbnNwZWN0KSwKICAgIEpTX0NHRVRTRVRfREVGKCJ0b2tlbnMiLCBqc19sZXhlcl90b2tlbnMsIDApLAogICAgSlNfQ0dFVFNFVF9ERUYoInN0YXRlcyIsIGpzX2xleGVyX3N0YXRlcywgMCksCiAgICAvLyBKU19DR0VUU0VUX0RFRigic3RhdGVTdGFjayIsIGpzX2xleGVyX3N0YXRlc3RhY2ssIDApLAogICAgLy8gSlNfQUxJQVNfREVGKCJwb3NpdGlvbiIsICJsb2MiKSwKICAgIEpTX0NGVU5DX0RFRigiW1N5bWJvbC5pdGVyYXRvcl0iLCAwLCBqc19sZXhlcl9pdGVyYXRvciksCiAgICBKU19QUk9QX1NUUklOR19ERUYoIltTeW1ib2wudG9TdHJpbmdUYWddIiwgIkxleGVyIiwgSlNfUFJPUF9DT05GSUdVUkFCTEUpLAp9OwoKc3RhdGljIGNvbnN0IEpTQ0Z1bmN0aW9uTGlzdEVudHJ5IGpzX2xleGVyX3N0YXRpY19mdW5jc1tdID0gewogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJlc2NhcGUiLCAxLCBqc19sZXhlcl9lc2NhcGUsIDApLAogICAgSlNfQ0ZVTkNfTUFHSUNfREVGKCJ1bmVzY2FwZSIsIDEsIGpzX2xleGVyX2VzY2FwZSwgMSksCiAgICBKU19DRlVOQ19ERUYoInRvU3RyaW5nIiwgMSwganNfbGV4ZXJfdG9zdHJpbmcpLAogICAgSlNfUFJPUF9JTlQzMl9ERUYoIkZJUlNUIiwgTEVYRVJfRklSU1QsIEpTX1BST1BfRU5VTUVSQUJMRSksCiAgICBKU19QUk9QX0lOVDMyX0RFRigiTE9OR0VTVCIsIExFWEVSX0xPTkdFU1QsIEpTX1BST1BfRU5VTUVSQUJMRSksCiAgICBKU19QUk9QX0lOVDMyX0RFRigiTEFTVCIsIExFWEVSX0xBU1QsIEpTX1BST1BfRU5VTUVSQUJMRSksCiAgICBKU19QUk9QX0lOVDMyX0RFRigiWUlFTERfSUQiLCBZSUVMRF9JRCwgSlNfUFJPUF9FTlVNRVJBQkxFKSwKICAgIEpTX1BST1BfSU5UMzJfREVGKCJZSUVMRF9PQkoiLCBZSUVMRF9PQkosIEpTX1BST1BfRU5VTUVSQUJMRSksCn07CgppbnQKanNfbGV4ZXJfaW5pdChKU0NvbnRleHQqIGN0eCwgSlNNb2R1bGVEZWYqIG0pIHsKCiAganNfbG9jYXRpb25faW5pdChjdHgsIG0pOwoKICBKU19OZXdDbGFzc0lEKCZqc190b2tlbl9jbGFzc19pZCk7CiAgSlNfTmV3Q2xhc3MoSlNfR2V0UnVudGltZShjdHgpLCBqc190b2tlbl9jbGFzc19pZCwgJmpzX3Rva2VuX2NsYXNzKTsKCiAgdG9rZW5fcHJvdG8gPSBKU19OZXdPYmplY3QoY3R4KTsKICBKU19TZXRQcm9wZXJ0eUZ1bmN0aW9uTGlzdChjdHgsIHRva2VuX3Byb3RvLCBqc190b2tlbl9wcm90b19mdW5jcywgY291bnRvZihqc190b2tlbl9wcm90b19mdW5jcykpOwogIEpTX1NldENsYXNzUHJvdG8oY3R4LCBqc190b2tlbl9jbGFzc19pZCwgdG9rZW5fcHJvdG8pOwoKICB0b2tlbl9jdG9yID0gSlNfTmV3Q0Z1bmN0aW9uMihjdHgsIGpzX3Rva2VuX2NvbnN0cnVjdG9yLCAiVG9rZW4iLCAxLCBKU19DRlVOQ19jb25zdHJ1Y3RvciwgMCk7CgogIEpTX1NldENvbnN0cnVjdG9yKGN0eCwgdG9rZW5fY3RvciwgdG9rZW5fcHJvdG8pOwogIEpTX1NldFByb3BlcnR5RnVuY3Rpb25MaXN0KGN0eCwgdG9rZW5fY3RvciwganNfdG9rZW5fc3RhdGljX2Z1bmNzLCBjb3VudG9mKGpzX3Rva2VuX3N0YXRpY19mdW5jcykpOwoKICBqc19zZXRfaW5zcGVjdF9tZXRob2QoY3R4LCB0b2tlbl9wcm90bywganNfdG9rZW5faW5zcGVjdCk7CgogIEpTX05ld0NsYXNzSUQoJmpzX2xleGVyX2NsYXNzX2lkKTsKICBKU19OZXdDbGFzcyhKU19HZXRSdW50aW1lKGN0eCksIGpzX2xleGVyX2NsYXNzX2lkLCAmanNfbGV4ZXJfY2xhc3MpOwoKICBsZXhlcl9wcm90byA9IEpTX05ld09iamVjdChjdHgpOwogIEpTX1NldFByb3BlcnR5RnVuY3Rpb25MaXN0KGN0eCwgbGV4ZXJfcHJvdG8sIGpzX2xleGVyX3Byb3RvX2Z1bmNzLCBjb3VudG9mKGpzX2xleGVyX3Byb3RvX2Z1bmNzKSk7CiAgSlNfU2V0Q2xhc3NQcm90byhjdHgsIGpzX2xleGVyX2NsYXNzX2lkLCBsZXhlcl9wcm90byk7CgogIGpzX3NldF9pbnNwZWN0X21ldGhvZChjdHgsIGxleGVyX3Byb3RvLCBqc19sZXhlcl9pbnNwZWN0KTsKCiAgbGV4ZXJfY3RvciA9IEpTX05ld0NGdW5jdGlvbjIoY3R4LCBqc19sZXhlcl9jb25zdHJ1Y3RvciwgIkxleGVyIiwgMSwgSlNfQ0ZVTkNfY29uc3RydWN0b3IsIDApOwoKICBKU19TZXRDb25zdHJ1Y3RvcihjdHgsIGxleGVyX2N0b3IsIGxleGVyX3Byb3RvKTsKICBKU19TZXRQcm9wZXJ0eUZ1bmN0aW9uTGlzdChjdHgsIGxleGVyX2N0b3IsIGpzX2xleGVyX3N0YXRpY19mdW5jcywgY291bnRvZihqc19sZXhlcl9zdGF0aWNfZnVuY3MpKTsKCiAgaWYobSkgewogICAgSlNfU2V0TW9kdWxlRXhwb3J0KGN0eCwgbSwgIlRva2VuIiwgdG9rZW5fY3Rvcik7CiAgICBKU19TZXRNb2R1bGVFeHBvcnQoY3R4LCBtLCAiTGV4ZXIiLCBsZXhlcl9jdG9yKTsKICB9CgogIHJldHVybiAwOwp9CgojaWZkZWYgSlNfU0hBUkVEX0xJQlJBUlkKI2RlZmluZSBKU19JTklUX01PRFVMRSBqc19pbml0X21vZHVsZQojZWxzZQojZGVmaW5lIEpTX0lOSVRfTU9EVUxFIGpzX2luaXRfbW9kdWxlX2xleGVyCiNlbmRpZgoKVklTSUJMRSBKU01vZHVsZURlZioKSlNfSU5JVF9NT0RVTEUoSlNDb250ZXh0KiBjdHgsIGNvbnN0IGNoYXIqIG1vZHVsZV9uYW1lKSB7CiAgSlNNb2R1bGVEZWYqIG07CiAgaWYoIShtID0gSlNfTmV3Q01vZHVsZShjdHgsIG1vZHVsZV9uYW1lLCAmanNfbGV4ZXJfaW5pdCkpKQogICAgcmV0dXJuIG07CgogIEpTX0FkZE1vZHVsZUV4cG9ydChjdHgsIG0sICJMb2NhdGlvbiIpOwogIEpTX0FkZE1vZHVsZUV4cG9ydChjdHgsIG0sICJUb2tlbiIpOwogIEpTX0FkZE1vZHVsZUV4cG9ydChjdHgsIG0sICJMZXhlciIpOwogIHJldHVybiBtOwp9CgovKioKICogQH0KICovCgAAAAAAAAAAE6sAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAGIoAAAAAAABpigAAAAAAAAAAAAAAAPC/"
				]
			]
		},
		{
			"file": "quickjs/qjs-modules/src/lexer.c",
			"settings":
			{
				"buffer_size": 12658,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					11,
					1,
					"insert",
					{
						"characters": "x"
					},
					"AQAAAGQgAAAAAAAAZSAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAZCAAAAAAAABkIAAAAAAAAAAAAAAAAPC/"
				],
				[
					19,
					1,
					"left_delete",
					null,
					"AQAAALMgAAAAAAAAsyAAAAAAAAABAAAAOg",
					"AQAAAAAAAAABAAAAtCAAAAAAAAC0IAAAAAAAAAAAAAAAIGNA"
				],
				[
					20,
					1,
					"insert",
					{
						"characters": "%s"
					},
					"AgAAALMgAAAAAAAAtCAAAAAAAAAAAAAAtCAAAAAAAAC1IAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAsyAAAAAAAACzIAAAAAAAAAAAAAAAAPC/"
				],
				[
					26,
					1,
					"insert",
					{
						"characters": "filename"
					},
					"CAAAAAUhAAAAAAAABiEAAAAAAAAAAAAABiEAAAAAAAAHIQAAAAAAAAAAAAAHIQAAAAAAAAghAAAAAAAAAAAAAAghAAAAAAAACSEAAAAAAAAAAAAACSEAAAAAAAAKIQAAAAAAAAAAAAAKIQAAAAAAAAshAAAAAAAAAAAAAAshAAAAAAAADCEAAAAAAAAAAAAADCEAAAAAAAANIQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAABSEAAAAAAAAFIQAAAAAAAP///////+9/"
				],
				[
					27,
					1,
					"insert",
					{
						"characters": " ?"
					},
					"AgAAAA0hAAAAAAAADiEAAAAAAAAAAAAADiEAAAAAAAAPIQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAADSEAAAAAAAANIQAAAAAAAAAAAAAAAPC/"
				],
				[
					28,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAAA8hAAAAAAAAECEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAADyEAAAAAAAAPIQAAAAAAAAAAAAAAAPC/"
				],
				[
					29,
					1,
					"insert_snippet",
					{
						"contents": "\"$0\""
					},
					"AQAAABAhAAAAAAAAEiEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAECEAAAAAAAAQIQAAAAAAAAAAAAAAAPC/"
				],
				[
					30,
					1,
					"insert",
					{
						"characters": ":"
					},
					"AQAAABEhAAAAAAAAEiEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAESEAAAAAAAARIQAAAAAAAAAAAAAAAPC/"
				],
				[
					32,
					1,
					"insert",
					{
						"characters": " :"
					},
					"AgAAABMhAAAAAAAAFCEAAAAAAAAAAAAAFCEAAAAAAAAVIQAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAEyEAAAAAAAATIQAAAAAAAAAAAAAAAPC/"
				],
				[
					33,
					1,
					"insert",
					{
						"characters": " "
					},
					"AQAAABUhAAAAAAAAFiEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAFSEAAAAAAAAVIQAAAAAAAAAAAAAAAPC/"
				],
				[
					34,
					1,
					"insert_snippet",
					{
						"contents": "\"$0\""
					},
					"AQAAABYhAAAAAAAAGCEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAFiEAAAAAAAAWIQAAAAAAAAAAAAAAAPC/"
				],
				[
					36,
					1,
					"insert",
					{
						"characters": ","
					},
					"AQAAABghAAAAAAAAGSEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAGCEAAAAAAAAYIQAAAAAAAAAAAAAAAPC/"
				],
				[
					57,
					1,
					"cut",
					null,
					"AQAAAAUhAAAAAAAABSEAAAAAAAAUAAAAZmlsZW5hbWUgPyAiOiIgOiAiIiw",
					"AQAAAAAAAAABAAAABSEAAAAAAAAZIQAAAAAAAP///////+9/"
				],
				[
					58,
					1,
					"paste",
					null,
					"AQAAAAUhAAAAAAAAGSEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAABSEAAAAAAAAFIQAAAAAAAAAAAAAAAPC/"
				],
				[
					64,
					1,
					"paste",
					null,
					"AgAAAPwgAAAAAAAAECEAAAAAAAAAAAAAECEAAAAAAAAQIQAAAAAAAAgAAABmaWxlbmFtZQ",
					"AQAAAAAAAAABAAAABCEAAAAAAAD8IAAAAAAAAAAAAAAAQF1A"
				],
				[
					66,
					3,
					"left_delete",
					null,
					"AwAAAAkhAAAAAAAACSEAAAAAAAABAAAAIgghAAAAAAAACCEAAAAAAAABAAAAOgchAAAAAAAAByEAAAAAAAABAAAAIg",
					"AQAAAAAAAAABAAAACiEAAAAAAAAKIQAAAAAAAAAAAAAAAPC/"
				],
				[
					67,
					1,
					"insert",
					{
						"characters": "fioöle"
					},
					"BgAAAAchAAAAAAAACCEAAAAAAAAAAAAACCEAAAAAAAAJIQAAAAAAAAAAAAAJIQAAAAAAAAohAAAAAAAAAAAAAAohAAAAAAAACyEAAAAAAAAAAAAACyEAAAAAAAAMIQAAAAAAAAAAAAAMIQAAAAAAAA0hAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAByEAAAAAAAAHIQAAAAAAAAAAAAAAAPC/"
				],
				[
					68,
					4,
					"left_delete",
					null,
					"BAAAAAwhAAAAAAAADCEAAAAAAAABAAAAZQshAAAAAAAACyEAAAAAAAABAAAAbAohAAAAAAAACiEAAAAAAAACAAAAw7YJIQAAAAAAAAkhAAAAAAAAAQAAAG8",
					"AQAAAAAAAAABAAAADSEAAAAAAAANIQAAAAAAAAAAAAAAAPC/"
				],
				[
					69,
					1,
					"insert",
					{
						"characters": "lename"
					},
					"BgAAAAkhAAAAAAAACiEAAAAAAAAAAAAACiEAAAAAAAALIQAAAAAAAAAAAAALIQAAAAAAAAwhAAAAAAAAAAAAAAwhAAAAAAAADSEAAAAAAAAAAAAADSEAAAAAAAAOIQAAAAAAAAAAAAAOIQAAAAAAAA8hAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAACSEAAAAAAAAJIQAAAAAAAAAAAAAAAPC/"
				],
				[
					73,
					1,
					"left_delete",
					null,
					"AQAAABUhAAAAAAAAFSEAAAAAAAABAAAALA",
					"AQAAAAAAAAABAAAAFiEAAAAAAAAWIQAAAAAAAAAAAAAAAPC/"
				],
				[
					76,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAABdMQAAI2luY2x1ZGUgImxleGVyLmgiCiNpbmNsdWRlICJkZWJ1Zy5oIgojaW5jbHVkZSAibG9jYXRpb24uaCIKI2luY2x1ZGUgPGxpYnJlZ2V4cC5oPgojaW5jbHVkZSA8Y3R5cGUuaD4KI2luY2x1ZGUgImJ1ZmZlci11dGlscy5oIgoKLyoqCiAqIFxhZGR0b2dyb3VwIGxleGVyCiAqIEB7CiAqLwppbnQKbGV4ZXJfc3RhdGVfZmluZGIoTGV4ZXIqIGxleCwgY29uc3QgY2hhciogc3RhdGUsIHNpemVfdCBzbGVuKSB7CiAgaW50IHJldCA9IC0xOwogIGNoYXIqKiBzdGF0ZXA7CgogIHZlY3Rvcl9mb3JlYWNoX3QoJmxleC0+c3RhdGVzLCBzdGF0ZXApIHsKICAgICsrcmV0OwoKICAgIGlmKHN0cmxlbigoKnN0YXRlcCkpID09IHNsZW4gJiYgIXN0cm5jbXAoKCpzdGF0ZXApLCBzdGF0ZSwgc2xlbikpCiAgICAgIHJldHVybiByZXQ7CiAgfQoKICByZXR1cm4gLTE7Cn0KCmludApsZXhlcl9zdGF0ZV9uZXcoTGV4ZXIqIGxleCwgY29uc3QgY2hhciogbmFtZSwgc2l6ZV90IGxlbikgewogIGNoYXIqIHN0YXRlOwogIGludCByZXQ7CgogIGlmKChyZXQgPSBsZXhlcl9zdGF0ZV9maW5kYihsZXgsIG5hbWUsIGxlbikpICE9IC0xKQogICAgcmV0dXJuIHJldDsKCiAgc3RhdGUgPSBzdHJfbmR1cChuYW1lLCBsZW4pOwogIHJldCA9IHZlY3Rvcl9zaXplKCZsZXgtPnN0YXRlcywgc2l6ZW9mKGNoYXIqKSk7CiAgdmVjdG9yX3B1c2goJmxleC0+c3RhdGVzLCBzdGF0ZSk7CiAgcmV0dXJuIHJldDsKfQoKaW50CmxleGVyX3N0YXRlX3B1c2goTGV4ZXIqIGxleCwgY29uc3QgY2hhciogc3RhdGUpIHsKICBpbnQzMl90IGlkOwojaWZkZWYgREVCVUdfT1VUUFVUXwogIHByaW50ZigibGV4ZXJfc3RhdGVfcHVzaCglenUpOiAlc1xuIiwgdmVjdG9yX3NpemUoJmxleC0+c3RhdGVfc3RhY2ssIHNpemVvZihpbnQzMl90KSksIHN0YXRlKTsKI2VuZGlmCiAgaWYoKGlkID0gbGV4ZXJfc3RhdGVfZmluZGIobGV4LCBzdGF0ZSwgc3RybGVuKHN0YXRlKSkpID49IDApIHsKICAgIHZlY3Rvcl9wdXNoKCZsZXgtPnN0YXRlX3N0YWNrLCBsZXgtPnN0YXRlKTsKICAgIGxleC0+c3RhdGUgPSBpZDsKICB9CiAgYXNzZXJ0KGlkID49IDApOwogIHJldHVybiBpZDsKfQoKaW50CmxleGVyX3N0YXRlX3BvcChMZXhlciogbGV4KSB7CiAgaW50MzJfdCBpZDsKICBzaXplX3QgbiA9IHZlY3Rvcl9zaXplKCZsZXgtPnN0YXRlX3N0YWNrLCBzaXplb2YoaW50MzJfdCkpIC0gMTsKICBpZCA9IGxleC0+c3RhdGU7CiNpZmRlZiBERUJVR19PVVRQVVRfCiAgcHJpbnRmKCJsZXhlcl9zdGF0ZV9wb3AoJXp1KTogJXNcbiIsIG4sIGxleGVyX3N0YXRlX25hbWUobGV4LCBpZCkpOwojZW5kaWYKICBpZighdmVjdG9yX2VtcHR5KCZsZXgtPnN0YXRlX3N0YWNrKSkgewogICAgbGV4LT5zdGF0ZSA9ICooaW50MzJfdCopdmVjdG9yX2JhY2soJmxleC0+c3RhdGVfc3RhY2ssIHNpemVvZihpbnQzMl90KSk7CiAgICB2ZWN0b3JfcG9wKCZsZXgtPnN0YXRlX3N0YWNrLCBzaXplb2YoaW50MzJfdCkpOwogIH0gZWxzZSB7CiAgICBsZXgtPnN0YXRlID0gLTE7CiAgfQogIHJldHVybiBpZDsKfQoKaW50CmxleGVyX3N0YXRlX3RvcChMZXhlciogbGV4LCBpbnQgaSkgewogIGludCBzejsKICBpZihpID09IDApCiAgICByZXR1cm4gbGV4LT5zdGF0ZTsKICBzeiA9IHZlY3Rvcl9zaXplKCZsZXgtPnN0YXRlX3N0YWNrLCBzaXplb2YoaW50MzJfdCkpOwogIGlmKGkgLSAxID49IHN6KQogICAgcmV0dXJuIC0xOwoKICBhc3NlcnQoc3ogPj0gaSk7CiAgcmV0dXJuICooaW50MzJfdCopdmVjdG9yX2F0KCZsZXgtPnN0YXRlX3N0YWNrLCBzaXplb2YoaW50MzJfdCksIHN6IC0gaSk7Cn0KCmNoYXIqCmxleGVyX3N0YXRlc19za2lwKGNoYXIqIGV4cHIpIHsKICBjaGFyKiByZSA9IGV4cHI7CgogIGlmKCpyZSA9PSAnPCcpIHsKICAgIHNpemVfdCBvZmZzZXQgPSBzdHJfY2hyKHJlLCAnPicpOwoKICAgIGlmKHJlW29mZnNldF0pCiAgICAgIHJlICs9IG9mZnNldCArIDE7CiAgfQogIHJldHVybiByZTsKfQoKdm9pZApsZXhlcl9zdGF0ZXNfZHVtcChMZXhlciogbGV4LCB1aW50NjRfdCBtYXNrLCBEeW5CdWYqIGRidWYpIHsKICBpbnQgc3RhdGUgPSAwOwogIGNoYXIqKiBzdGF0ZXA7CiAgc2l6ZV90IG4gPSBkYnVmLT5zaXplOwoKICB2ZWN0b3JfZm9yZWFjaF90KCZsZXgtPnN0YXRlcywgc3RhdGVwKSB7CiAgICBpZihtYXNrICYgKDEgPDwgc3RhdGUpKSB7CgogICAgICBpZihkYnVmLT5zaXplID4gbikKICAgICAgICBkYnVmX3B1dGMoZGJ1ZiwgJywnKTsKICAgICAgZGJ1Zl9wdXRzdHIoZGJ1ZiwgKnN0YXRlcCk7CiAgICAgIHN0YXRlKys7CiAgICB9CiAgfQp9CgpjaGFyKgpsZXhlcl9ydWxlX3JlZ2V4KExleGVyUnVsZSogcnVsZSkgewogIHJldHVybiBsZXhlcl9zdGF0ZXNfc2tpcChydWxlLT5leHByKTsKfQoKQk9PTApsZXhlcl9ydWxlX2V4cGFuZChMZXhlciogbGV4LCBjaGFyKiBwLCBEeW5CdWYqIGRiKSB7CiAgc2l6ZV90IGxlbjsKCiAgZGJ1Zl96ZXJvKGRiKTsKCiAgZm9yKDsgKnA7IHArKykgewogICAgaWYoKnAgPT0gJ3snKSB7CiAgICAgIGlmKHBbbGVuID0gc3RyX2NocihwLCAnfScpXSkgewogICAgICAgIExleGVyUnVsZSogc3Vic3Q7CiAgICAgICAgaWYoKHN1YnN0ID0gbGV4ZXJfZmluZF9kZWZpbml0aW9uKGxleCwgcCArIDEsIGxlbiAtIDEpKSkgewogICAgICAgICAgbGV4ZXJfcnVsZV9leHBhbmQobGV4LCBzdWJzdC0+ZXhwciwgZGIpOwogICAgICAgICAgcCArPSBsZW47CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpZigqcCA9PSAnXFwnKQogICAgICBkYnVmX3B1dGMoZGIsICpwKyspOwogICAgZGJ1Zl9wdXRjKGRiLCAqcCk7CiAgfQogIGRidWZfMChkYik7CgogIC8vIHByaW50ZigiZXhwYW5kICVzICVzXG4iLCBwLCBkYi0+YnVmKTsKCiAgcmV0dXJuIFRSVUU7Cn0KCnN0YXRpYyBCT09MCmxleGVyX3J1bGVfY29tcGlsZShMZXhlciogbGV4LCBMZXhlclJ1bGUqIHJ1bGUsIEpTQ29udGV4dCogY3R4KSB7CiAgRHluQnVmIGRidWY7CiAgQk9PTCByZXQ7CgogIGlmKHJ1bGUtPmJ5dGVjb2RlKQogICAgcmV0dXJuIFRSVUU7CgogIGpzX2RidWZfaW5pdChjdHgsICZkYnVmKTsKCiAgaWYobGV4ZXJfcnVsZV9leHBhbmQobGV4LCBsZXhlcl9ydWxlX3JlZ2V4KHJ1bGUpLCAmZGJ1ZikpIHsKICAgIHJ1bGUtPmV4cGFuc2lvbiA9IGpzX3N0cm5kdXAoY3R4LCAoY29uc3QgY2hhciopZGJ1Zi5idWYsIGRidWYuc2l6ZSk7CiAgICBydWxlLT5ieXRlY29kZSA9IHJlZ2V4cF9jb21waWxlKHJlZ2V4cF9mcm9tX2RidWYoJmRidWYsIExSRV9GTEFHX0dMT0JBTCB8IExSRV9GTEFHX01VTFRJTElORSB8IExSRV9GTEFHX1NUSUNLWSksIGN0eCk7CiAgICByZXQgPSBydWxlLT5ieXRlY29kZSAhPSAwOwoKICB9IGVsc2UgewogICAgSlNfVGhyb3dJbnRlcm5hbEVycm9yKGN0eCwgIkVycm9yIGV4cGFuZGluZyBydWxlICclcyciLCBydWxlLT5uYW1lKTsKICAgIHJldCA9IEZBTFNFOwogIH0KCiAgZGJ1Zl9mcmVlKCZkYnVmKTsKICByZXR1cm4gcmV0Owp9CgpzdGF0aWMgaW50CmxleGVyX3J1bGVfbWF0Y2goTGV4ZXIqIGxleCwgTGV4ZXJSdWxlKiBydWxlLCB1aW50OF90KiogY2FwdHVyZSwgSlNDb250ZXh0KiBjdHgpIHsKCiAgaWYocnVsZS0+Ynl0ZWNvZGUgPT0gMCkgewogICAgaWYoIWxleGVyX3J1bGVfY29tcGlsZShsZXgsIHJ1bGUsIGN0eCkpCiAgICAgIHJldHVybiBMRVhFUl9FUlJPUl9DT01QSUxFOwogIH0KCiAgLy8gZnByaW50ZihzdGRlcnIsICJsZXhlcl9ydWxlX21hdGNoICVzICVzICVzXG4iLCBydWxlLT5uYW1lLCBydWxlLT5leHByLCBydWxlLT5leHBhbnNpb24pOwoKICByZXR1cm4gbHJlX2V4ZWMoY2FwdHVyZSwgcnVsZS0+Ynl0ZWNvZGUsICh1aW50OF90KilsZXgtPmRhdGEsIGxleC0+cG9zLCBsZXgtPnNpemUsIDAsIGN0eCk7Cn0KCmludApsZXhlcl9ydWxlX2FkZChMZXhlciogbGV4LCBjaGFyKiBuYW1lLCBjaGFyKiBleHByKSB7CiAgTGV4ZXJSdWxlIHJ1bGUgPSB7bmFtZSwgZXhwciwgMSwgMCwgMCwgMH0sICpwcmV2aW91czsKICBpbnQgcmV0OwoKICBpZigocHJldmlvdXMgPSBsZXhlcl9ydWxlX2ZpbmQobGV4LCBuYW1lKSkpIHsKICAgIHJldHVybiAtMTsKICB9CgogIGlmKHJ1bGUuZXhwclswXSA9PSAnPCcpIHsKICAgIGNoYXIqIHM7CiAgICBpbnQzMl90IGZsYWdzID0gMDsKCiAgICBmb3IocyA9ICZydWxlLmV4cHJbMV07ICpzICYmICpzICE9ICc+JzspIHsKICAgICAgc2l6ZV90IGxlbiA9IHN0cl9jaHJzKHMsICIsPiIsIDIpOwogICAgICBpbnQgaW5kZXg7CgogICAgICBpZihzW2xlbl0gPT0gJ1wwJykKICAgICAgICBicmVhazsKCiAgICAgIGlmKChpbmRleCA9IGxleGVyX3N0YXRlX2ZpbmRiKGxleCwgcywgbGVuKSkgPT0gLTEpCiAgICAgICAgaW5kZXggPSBsZXhlcl9zdGF0ZV9uZXcobGV4LCBzLCBsZW4pOwoKICAgICAgYXNzZXJ0KGluZGV4ICE9IC0xKTsKICAgICAgZmxhZ3MgfD0gMSA8PCBpbmRleDsKCiAgICAgIGlmKCoocyArPSBsZW4pID09ICcsJykKICAgICAgICBzKys7CiAgICB9CgogICAgaWYoKnMgPT0gJz4nKQogICAgICBydWxlLm1hc2sgPSBmbGFnczsKICB9CgogIC8vIGZwcmludGYoc3RkZXJyLCAibGV4ZXJfcnVsZV9hZGQgJXMgJXMgJTA4eFxuIiwgcnVsZS5uYW1lLCBydWxlLmV4cHIsIHJ1bGUubWFzayk7CiAgcmV0ID0gdmVjdG9yX3NpemUoJmxleC0+cnVsZXMsIHNpemVvZihMZXhlclJ1bGUpKTsKICB2ZWN0b3JfcHVzaCgmbGV4LT5ydWxlcywgcnVsZSk7CiAgcmV0dXJuIHJldDsKfQoKTGV4ZXJSdWxlKgpsZXhlcl9ydWxlX2ZpbmQoTGV4ZXIqIGxleCwgY29uc3QgY2hhciogbmFtZSkgewogIExleGVyUnVsZSogcnVsZTsKICBhc3NlcnQobmFtZSk7CiAgdmVjdG9yX2ZvcmVhY2hfdCgmbGV4LT5ydWxlcywgcnVsZSkgewogICAgYXNzZXJ0KHJ1bGUtPm5hbWUpOwogICAgaWYoIXN0cmNtcChydWxlLT5uYW1lLCBuYW1lKSkKICAgICAgcmV0dXJuIHJ1bGU7CiAgfQogIHJldHVybiAwOwp9Cgp2b2lkCmxleGVyX3J1bGVfZnJlZShMZXhlclJ1bGUqIHJ1bGUsIEpTQ29udGV4dCogY3R4KSB7CiAgaWYocnVsZS0+bmFtZSkKICAgIGpzX2ZyZWUoY3R4LCBydWxlLT5uYW1lKTsKICBqc19mcmVlKGN0eCwgcnVsZS0+ZXhwcik7CgogIGlmKHJ1bGUtPmJ5dGVjb2RlKQogICAganNfZnJlZShjdHgsIHJ1bGUtPmJ5dGVjb2RlKTsKfQoKdm9pZApsZXhlcl9ydWxlX2ZyZWVfcnQoTGV4ZXJSdWxlKiBydWxlLCBKU1J1bnRpbWUqIHJ0KSB7CiAgaWYocnVsZS0+bmFtZSkKICAgIGpzX2ZyZWVfcnQocnQsIHJ1bGUtPm5hbWUpOwogIGpzX2ZyZWVfcnQocnQsIHJ1bGUtPmV4cHIpOwoKICBpZihydWxlLT5ieXRlY29kZSkKICAgIG9yaWdfanNfZnJlZV9ydChydCwgcnVsZS0+Ynl0ZWNvZGUpOwp9Cgp2b2lkCmxleGVyX3J1bGVfZHVtcChMZXhlciogbGV4LCBMZXhlclJ1bGUqIHJ1bGUsIER5bkJ1ZiogZGJ1ZikgewogIC8qICBpZihydWxlLT5tYXNrICE9IDApIHsKICAgICAgZGJ1Zl9wdXRjKGRidWYsICc8Jyk7CiAgICAgIGxleGVyX3N0YXRlc19kdW1wKGxleCwgcnVsZS0+bWFzaywgZGJ1Zik7CiAgICAgIGRidWZfcHV0YyhkYnVmLCAnPicpOwogICAgfSovCiAgbGV4ZXJfcnVsZV9leHBhbmQobGV4LCBydWxlLT5leHByLCBkYnVmKTsKfQoKdm9pZApsZXhlcl9pbml0KExleGVyKiBsZXgsIGVudW0gbGV4ZXJfbW9kZSBtb2RlLCBKU0NvbnRleHQqIGN0eCkgewogIGNoYXIqIGluaXRpYWwgPSBqc19zdHJkdXAoY3R4LCAiSU5JVElBTCIpOwoKICBtZW1zZXQobGV4LCAwLCBzaXplb2YoTGV4ZXIpKTsKCiAgbGV4LT5yZWZfY291bnQgPSAxOwogIGxleC0+bW9kZSA9IG1vZGU7CiAgbGV4LT5zdGF0ZSA9IDA7CiAgbGV4LT5zZXEgPSAwOwoKICBsb2NhdGlvbl9pbml0KCZsZXgtPmxvYyk7CgogIHZlY3Rvcl9pbml0KCZsZXgtPmRlZmluZXMsIGN0eCk7CiAgdmVjdG9yX2luaXQoJmxleC0+cnVsZXMsIGN0eCk7CiAgdmVjdG9yX2luaXQoJmxleC0+c3RhdGVzLCBjdHgpOwogIHZlY3Rvcl9wdXNoKCZsZXgtPnN0YXRlcywgaW5pdGlhbCk7CiAgdmVjdG9yX2luaXQoJmxleC0+c3RhdGVfc3RhY2ssIGN0eCk7Cn0KCnZvaWQKbGV4ZXJfZGVmaW5lKExleGVyKiBsZXgsIGNoYXIqIG5hbWUsIGNoYXIqIGV4cHIpIHsKICBMZXhlclJ1bGUgZGVmaW5pdGlvbiA9IHtuYW1lLCBleHByLCBNQVNLX0FMTCwgMCwgMCwgMH07CiAgdmVjdG9yX3NpemUoJmxleC0+ZGVmaW5lcywgc2l6ZW9mKExleGVyUnVsZSkpOwogIHZlY3Rvcl9wdXNoKCZsZXgtPmRlZmluZXMsIGRlZmluaXRpb24pOwp9CgpMZXhlclJ1bGUqCmxleGVyX2ZpbmRfZGVmaW5pdGlvbihMZXhlciogbGV4LCBjb25zdCBjaGFyKiBuYW1lLCBzaXplX3QgbmFtZWxlbikgewogIExleGVyUnVsZSogZGVmaW5pdGlvbjsKICB2ZWN0b3JfZm9yZWFjaF90KCZsZXgtPmRlZmluZXMsIGRlZmluaXRpb24pIHsKICAgIGlmKCFzdHJuY21wKGRlZmluaXRpb24tPm5hbWUsIG5hbWUsIG5hbWVsZW4pICYmIGRlZmluaXRpb24tPm5hbWVbbmFtZWxlbl0gPT0gJ1wwJykKICAgICAgcmV0dXJuIGRlZmluaXRpb247CiAgfQogIHJldHVybiAwOwp9CgpCT09MCmxleGVyX2NvbXBpbGVfcnVsZXMoTGV4ZXIqIGxleCwgSlNDb250ZXh0KiBjdHgpIHsKICBMZXhlclJ1bGUqIHJ1bGU7CgogIHZlY3Rvcl9mb3JlYWNoX3QoJmxleC0+cnVsZXMsIHJ1bGUpIHsKICAgIGlmKCFsZXhlcl9ydWxlX2NvbXBpbGUobGV4LCBydWxlLCBjdHgpKQogICAgICByZXR1cm4gRkFMU0U7CiAgfQogIHJldHVybiBUUlVFOwp9CgppbnQKbGV4ZXJfcGVlayhMZXhlciogbGV4LCAvKnVpbnQ2NF90IF9fc3RhdGUsKi8gdW5zaWduZWQgc3RhcnRfcnVsZSwgSlNDb250ZXh0KiBjdHgpIHsKICBMZXhlclJ1bGUgKnJ1bGUsICpzdGFydCA9IHZlY3Rvcl9iZWdpbigmbGV4LT5ydWxlcyksICplbmQgPSB2ZWN0b3JfZW5kKCZsZXgtPnJ1bGVzKTsKICB1aW50OF90KiBjYXB0dXJlWzUxMl07CiAgaW50IHJldCA9IExFWEVSX0VSUk9SX05PTUFUQ0g7CiAgc2l6ZV90IGxlbiA9IDA7CgogIGlmKGlucHV0X2J1ZmZlcl9lb2YoJmxleC0+aW5wdXQpKQogICAgcmV0dXJuIExFWEVSX0VPRjsKCiAgYXNzZXJ0KHN0YXJ0X3J1bGUgPj0gMCk7CiAgYXNzZXJ0KHN0YXJ0X3J1bGUgPCB2ZWN0b3Jfc2l6ZSgmbGV4LT5ydWxlcywgc2l6ZW9mKExleGVyUnVsZSkpKTsKCiAgZm9yKHJ1bGUgPSBzdGFydCArIHN0YXJ0X3J1bGU7IHJ1bGUgPCBlbmQ7ICsrcnVsZSkgewogICAgZW51bSBsZXhlcl9yZXN1bHQgcmVzdWx0OwoKICAgIGlmKChydWxlLT5tYXNrICYgKDEgPDwgbGV4LT5zdGF0ZSkpID09IDApCiAgICAgIGNvbnRpbnVlOwoKICAgIHJlc3VsdCA9IGxleGVyX3J1bGVfbWF0Y2gobGV4LCBydWxlLCBjYXB0dXJlLCBjdHgpOwoKICAgIC8qc2l6ZV90IGVsZW4gPSBzdHJsZW4ocnVsZS0+ZXhwYW5zaW9uKTsKICAgIHByaW50ZigiJXMgcmVzdWx0ICVpIHN0YXRlICVpIHJ1bGUjJWxkICVzIChzdGFydD0lZCkgLyUuKnMlc1xuIiwKICAgICAgICAgICBfX2Z1bmNfXywKICAgICAgICAgICByZXN1bHQsCiAgICAgICAgICAgbGV4LT5zdGF0ZSwKICAgICAgICAgICBydWxlIC0gc3RhcnQsCiAgICAgICAgICAgcnVsZS0+bmFtZSwKICAgICAgICAgICBzdGFydF9ydWxlLAogICAgICAgICAgIChpbnQpKGVsZW4gPiAzMCA/IDMwIDogZWxlbiksCiAgICAgICAgICAgcnVsZS0+ZXhwYW5zaW9uLAogICAgICAgICAgIGVsZW4gPiAzMCA/ICIuLi4uIiA6ICIvIik7Ki8KCiAgICAvKmlmKHJlc3VsdCA9PSBMRVhFUl9FUlJPUl9DT01QSUxFKSB7CiAgICAgIHJldCA9IHJlc3VsdDsKICAgICAgYnJlYWs7CiAgICB9IGVsc2UgKi8KICAgIGlmKHJlc3VsdCA8IExFWEVSX0VSUk9SX05PTUFUQ0gpIHsKICAgICAgY29uc3QgY2hhciogdCA9ICgoY29uc3QgY2hhcipbXSl7CiAgICAgICAgICAiZXhlY3V0aW5nIiwKICAgICAgICAgICJjb21waWxpbmciLAogICAgICB9KVtyZXN1bHQgLSBMRVhFUl9FUlJPUl9FWEVDXTsKCiAgICAgIEpTX1Rocm93SW50ZXJuYWxFcnJvcihjdHgsICJFcnJvciAlcyByZWdleCAvJXMvIiwgdCwgcnVsZS0+ZXhwcik7CiAgICAgIGZwcmludGYoc3RkZXJyLCAiRXJyb3IgJXMgcmVnZXggLyVzL1xuIiwgdCwgcnVsZS0+ZXhwcik7CgogICAgICByZXQgPSByZXN1bHQ7CiAgICAgIGJyZWFrOwogICAgfSBlbHNlIGlmKHJlc3VsdCA+IDAgJiYgKGNhcHR1cmVbMV0gLSBjYXB0dXJlWzBdKSA+IDApIHsKI2lmZGVmIERFQlVHX09VVFBVVAogICAgICBjb25zdCBjaGFyKiBmaWxlbmFtZSA9IGxleC0+bG9jLmZpbGUgPT0gLTEgPyAwIDogSlNfQXRvbVRvQ1N0cmluZyhjdHgsIGxleC0+bG9jLmZpbGUpOwoKICAgICAgcHJpbnRmKCIlcyVzJSIgUFJJdTMyICI6JS00IiBQUkl1MzIgIiAjJWkgJS0yMHMgLSAvJXMvIFslenVdICUuKnNcbiIsCiAgICAgICAgICAgICBmaWxlbmFtZSA/IGZpbGVuYW1lIDogIiIsZmlsZW5hbWUgPyAiOiIgOiAiIiwKICAgICAgICAgICAgIGxleC0+bG9jLmxpbmUgKyAxLAogICAgICAgICAgICAgbGV4LT5sb2MuY29sdW1uICsgMSwKICAgICAgICAgICAgIChpbnQpKHJ1bGUgLSBzdGFydCksCiAgICAgICAgICAgICBydWxlLT5uYW1lLAogICAgICAgICAgICAgcnVsZS0+ZXhwciwKICAgICAgICAgICAgIGNhcHR1cmVbMV0gLSBjYXB0dXJlWzBdLAogICAgICAgICAgICAgKGludCkoY2FwdHVyZVsxXSAtIGNhcHR1cmVbMF0pLAogICAgICAgICAgICAgY2FwdHVyZVswXSk7CiAgICAgIEpTX0ZyZWVDU3RyaW5nKGN0eCwgZmlsZW5hbWUpOwojZW5kaWYKCiAgICAgIGlmKChsZXgtPm1vZGUgJiBMRVhFUl9MT05HRVNUKSA9PSAwIHx8IHJldCA8IDAgfHwgKHNpemVfdCkoY2FwdHVyZVsxXSAtIGNhcHR1cmVbMF0pID4gbGVuKSB7CiAgICAgICAgcmV0ID0gcnVsZSAtIHN0YXJ0OwogICAgICAgIGxlbiA9IGNhcHR1cmVbMV0gLSBjYXB0dXJlWzBdOwogICAgICAgIGlmKGxleC0+bW9kZSA9PSBMRVhFUl9GSVJTVCkKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQoKICBpZihyZXQgPj0gMCkgewogICAgbGV4LT5ieXRlX2xlbmd0aCA9IGxlbjsKICAgIGxleC0+dG9rZW5faWQgPSByZXQ7CiAgfSBlbHNlIHsKICAgIGxleC0+Ynl0ZV9sZW5ndGggPSAwOwogICAgbGV4LT50b2tlbl9pZCA9IC0xOwogIH0KCiAgcmV0dXJuIHJldDsKfQoKLypzdGF0aWMgaW5saW5lIHNpemVfdAppbnB1dF9za2lwKElucHV0QnVmZmVyKiBpbnB1dCwgc2l6ZV90IGVuZCwgTG9jYXRpb24qIGxvYykgewogIHNpemVfdCBuID0gMDsKICB3aGlsZShpbnB1dC0+cG9zIDwgZW5kKSB7CiAgICBzaXplX3QgcHJldiA9IGlucHV0LT5wb3M7CiAgICBpZihpbnB1dF9idWZmZXJfZ2V0YyhpbnB1dCkgPT0gJ1xuJykgewogICAgICBsb2MtPmxpbmUrKzsKICAgICAgbG9jLT5jb2x1bW4gPSAwOwogICAgfSBlbHNlIHsKICAgICAgbG9jLT5jb2x1bW4rKzsKICAgIH0KICAgIGxvYy0+Y2hhcl9vZmZzZXQrKzsKICAgIGxvYy0+Ynl0ZV9vZmZzZXQgKz0gaW5wdXQtPnBvcyAtIHByZXY7CiAgICBuKys7CiAgfQogIHJldHVybiBuOwp9Ki8KCnNpemVfdApsZXhlcl9za2lwX24oTGV4ZXIqIGxleCwgc2l6ZV90IGJ5dGVzKSB7CiAgc2l6ZV90IGxlbjsKCiAgYXNzZXJ0KGJ5dGVzIDw9IGxleC0+c2l6ZSAtIGxleC0+cG9zKTsKCiAgbGVuID0gbG9jYXRpb25fY291bnQoJmxleC0+bG9jLCAmbGV4LT5kYXRhW2xleC0+cG9zXSwgYnl0ZXMpOwogIGxleC0+cG9zICs9IGJ5dGVzOwoKICAvLyBsZXhlcl9jbGVhcl90b2tlbihsZXgpOwogIC8qIGxleC0+Ynl0ZV9sZW5ndGggPSAwOwogICBsZXgtPnRva2VuX2lkID0gLTE7Ki8KCiAgcmV0dXJuIGxlbjsKfQoKc2l6ZV90CmxleGVyX3NraXAoTGV4ZXIqIGxleCkgewogIHNpemVfdCBsZW47CgogIGxlbiA9IGxleGVyX3NraXBfbihsZXgsIGxleC0+Ynl0ZV9sZW5ndGgpOwoKICBsZXgtPnNlcSsrOwoKICBsZXhlcl9jbGVhcl90b2tlbihsZXgpOwoKICByZXR1cm4gbGVuOwp9Cgp2b2lkCmxleGVyX2NsZWFyX3Rva2VuKExleGVyKiBsZXgpIHsKICBhc3NlcnQobGV4LT5ieXRlX2xlbmd0aCk7CiAgYXNzZXJ0KGxleC0+dG9rZW5faWQgIT0gLTEpOwoKICBsZXgtPmJ5dGVfbGVuZ3RoID0gMDsKICBsZXgtPnRva2VuX2lkID0gLTE7Cn0KCnNpemVfdApsZXhlcl9jaGFybGVuKExleGVyKiBsZXgpIHsKICBpZihsZXgtPmJ5dGVfbGVuZ3RoID09IDApCiAgICByZXR1cm4gMDsKCiAgYXNzZXJ0KChsZXgtPnNpemUgLSBsZXgtPnBvcykgPj0gbGV4LT5ieXRlX2xlbmd0aCk7CgogIHJldHVybiB1dGY4X3N0cmxlbigmbGV4LT5kYXRhW2xleC0+cG9zXSwgbGV4LT5ieXRlX2xlbmd0aCk7Cn0KCmNoYXIqCmxleGVyX2xleGVtZShMZXhlciogbGV4LCBzaXplX3QqIGxlbnApIHsKICBjaGFyKiBzID0gKGNoYXIqKWxleC0+ZGF0YSArIGxleC0+cG9zOwoKICBpZihsZW5wKQogICAgKmxlbnAgPSBsZXgtPmJ5dGVfbGVuZ3RoOwoKICByZXR1cm4gczsKfQoKaW50CmxleGVyX25leHQoTGV4ZXIqIGxleCwgSlNDb250ZXh0KiBjdHgpIHsKICBpbnQgcmV0OwoKICBpZigocmV0ID0gbGV4ZXJfcGVlayhsZXgsIDAsIGN0eCkpID49IDApCiAgICBsZXhlcl9za2lwKGxleCk7CgogIHJldHVybiByZXQ7Cn0KCnZvaWQKbGV4ZXJfc2V0X2lucHV0KExleGVyKiBsZXgsIElucHV0QnVmZmVyIGlucHV0LCBpbnQzMl90IGZpbGVfYXRvbSkgewogIGxleC0+aW5wdXQgPSBpbnB1dDsKICBsZXgtPmxvYy5maWxlID0gZmlsZV9hdG9tOwp9Cgp2b2lkCmxleGVyX3NldF9sb2NhdGlvbihMZXhlciogbGV4LCBjb25zdCBMb2NhdGlvbiogbG9jLCBKU0NvbnRleHQqIGN0eCkgewogIC8vIGxleC0+c3RhcnQgPSBsb2MtPmNoYXJfb2Zmc2V0OwogIGxleC0+Ynl0ZV9sZW5ndGggPSAwOwogIGxleC0+cG9zID0gbG9jLT5jaGFyX29mZnNldDsKICBsb2NhdGlvbl9yZWxlYXNlKCZsZXgtPmxvYywgY3R4KTsKICBsb2NhdGlvbl9jb3B5KCZsZXgtPmxvYywgbG9jLCBjdHgpOwp9Cgp2b2lkCmxleGVyX3JlbGVhc2UoTGV4ZXIqIGxleCwgSlNDb250ZXh0KiBjdHgpIHsKICBpZigtLWxleC0+cmVmX2NvdW50ID09IDApIHsKICAgIExleGVyUnVsZSogcnVsZTsKICAgIGNoYXIqKiBzdGF0ZTsKCiAgICBpZighY3R4KQogICAgICBjdHggPSBsZXgtPnJ1bGVzLm9wYXF1ZTsKCiAgICBpbnB1dF9idWZmZXJfZnJlZSgmbGV4LT5pbnB1dCwgY3R4KTsKCiAgICB2ZWN0b3JfZm9yZWFjaF90KCZsZXgtPmRlZmluZXMsIHJ1bGUpIHsgbGV4ZXJfcnVsZV9mcmVlKHJ1bGUsIGN0eCk7IH0KICAgIHZlY3Rvcl9mb3JlYWNoX3QoJmxleC0+cnVsZXMsIHJ1bGUpIHsgbGV4ZXJfcnVsZV9mcmVlKHJ1bGUsIGN0eCk7IH0KICAgIHZlY3Rvcl9mb3JlYWNoX3QoJmxleC0+c3RhdGVzLCBzdGF0ZSkgeyBmcmVlKCpzdGF0ZSk7IH0KCiAgICB2ZWN0b3JfZnJlZSgmbGV4LT5kZWZpbmVzKTsKICAgIHZlY3Rvcl9mcmVlKCZsZXgtPnJ1bGVzKTsKICAgIHZlY3Rvcl9mcmVlKCZsZXgtPnN0YXRlcyk7CiAgICB2ZWN0b3JfZnJlZSgmbGV4LT5zdGF0ZV9zdGFjayk7CiAgfQp9Cgp2b2lkCmxleGVyX2ZyZWUoTGV4ZXIqIGxleCwgSlNDb250ZXh0KiBjdHgpIHsKICBsZXhlcl9yZWxlYXNlKGxleCwgY3R4KTsKICBpZihsZXgtPnJlZl9jb3VudCA8PSAwKQogICAganNfZnJlZShjdHgsIGxleCk7Cn0KCnZvaWQKbGV4ZXJfcmVsZWFzZV9ydChMZXhlciogbGV4LCBKU1J1bnRpbWUqIHJ0KSB7CiAgaWYoLS1sZXgtPnJlZl9jb3VudCA9PSAwKSB7CiAgICBjaGFyKiogc3RhdGVwOwogICAgTGV4ZXJSdWxlKiBydWxlOwogICAgdmVjdG9yX2ZvcmVhY2hfdCgmbGV4LT5zdGF0ZXMsIHN0YXRlcCkgeyBqc19mcmVlX3J0KHJ0LCAqc3RhdGVwKTsgfQogICAgdmVjdG9yX2ZyZWUoJmxleC0+c3RhdGVzKTsKICAgIHZlY3Rvcl9mb3JlYWNoX3QoJmxleC0+cnVsZXMsIHJ1bGUpIHsgbGV4ZXJfcnVsZV9mcmVlX3J0KHJ1bGUsIHJ0KTsgfQogICAgdmVjdG9yX2ZyZWUoJmxleC0+cnVsZXMpOwogICAgdmVjdG9yX2ZvcmVhY2hfdCgmbGV4LT5kZWZpbmVzLCBydWxlKSB7IGxleGVyX3J1bGVfZnJlZV9ydChydWxlLCBydCk7IH0KICAgIHZlY3Rvcl9mcmVlKCZsZXgtPmRlZmluZXMpOwogICAgdmVjdG9yX2ZyZWUoJmxleC0+c3RhdGVfc3RhY2spOwogIH0KfQp2b2lkCmxleGVyX2ZyZWVfcnQoTGV4ZXIqIGxleCwgSlNSdW50aW1lKiBydCkgewogIGxleGVyX3JlbGVhc2VfcnQobGV4LCBydCk7CiAgaWYobGV4LT5yZWZfY291bnQgPD0gMCkKICAgIGpzX2ZyZWVfcnQocnQsIGxleCk7Cn0KCnZvaWQKbGV4ZXJfZHVtcChMZXhlciogbGV4LCBEeW5CdWYqIGRidWYpIHsKICBkYnVmX3ByaW50ZihkYnVmLCAiTGV4ZXIge1xuICBtb2RlOiAleCxcbiAgc3RhdGU6ICVzIiwgbGV4LT5tb2RlLCBsZXhlcl9zdGF0ZV9uYW1lKGxleCwgbGV4LT5zdGF0ZSkpOwogIGRidWZfcHV0c3RyKGRidWYsICIsXG4gIGlucHV0OiAiKTsKICBpbnB1dF9idWZmZXJfZHVtcCgmbGV4LT5pbnB1dCwgZGJ1Zik7CiAgZGJ1Zl9wdXRzdHIoZGJ1ZiwgIixcbiAgbG9jYXRpb246ICIpOwogIGxvY2F0aW9uX3ByaW50KCZsZXgtPmxvYywgZGJ1ZiwgMCk7CiAgZGJ1Zl9wdXRzdHIoZGJ1ZiwgIlxufSIpOwp9CgovKioKICogQH0KICovCgAAAAAAAAAAazEAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAFSEAAAAAAAAVIQAAAAAAAAAAAAAAAPC/"
				],
				[
					90,
					1,
					"insert",
					{
						"characters": "\n"
					},
					"AwAAADAgAAAAAAAAMSAAAAAAAAAAAAAAMSAAAAAAAAA1IAAAAAAAAAAAAAA1IAAAAAAAADcgAAAAAAAAAAAAAA",
					"AQAAAAAAAAABAAAAMCAAAAAAAAAwIAAAAAAAAAAAAAAAkIJA"
				]
			]
		},
		{
			"file": "CMakeLists.txt",
			"settings":
			{
				"buffer_size": 14135,
				"line_ending": "Unix"
			},
			"undo_stack":
			[
			]
		},
		{
			"file": "lib/grammars/c11-scanner.l",
			"settings":
			{
				"buffer_size": 4198,
				"line_ending": "Unix"
			},
			"undo_stack":
			[
			]
		},
		{
			"file": "lib/ecmascript.js",
			"settings":
			{
				"buffer_size": 1743,
				"line_ending": "Unix"
			},
			"undo_stack":
			[
			]
		},
		{
			"file": "quickjs/qjs-modules/include/lexer.h",
			"redo_stack":
			[
				[
					18,
					1,
					"insert",
					{
						"characters": " q"
					},
					"AgAAAL4EAAAAAAAAvgQAAAAAAAABAAAAcb0EAAAAAAAAvQQAAAAAAAABAAAAIA",
					"AQAAAAAAAAABAAAAvwQAAAAAAAC/BAAAAAAAAAAAAAAAAPC/"
				]
			],
			"settings":
			{
				"buffer_size": 3431,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			},
			"undo_stack":
			[
			]
		},
		{
			"file": "quickjs/qjs-modules/src/buffer-utils.c",
			"settings":
			{
				"buffer_size": 18391,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			},
			"undo_stack":
			[
			]
		},
		{
			"file": "quickjs/qjs-modules/list-exports.js",
			"settings":
			{
				"buffer_size": 16213,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					5,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAABYPwAAIyEvdXNyL2Jpbi9lbnYgcWpzbQppbXBvcnQgKiBhcyBvcyBmcm9tICdvcyc7CmltcG9ydCAqIGFzIHN0ZCBmcm9tICdzdGQnOwppbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7CmltcG9ydCBpbnNwZWN0IGZyb20gJ2luc3BlY3QnOwppbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnOwppbXBvcnQgeyBMZXhlciwgVG9rZW4gfSBmcm9tICdsZXhlcic7CmltcG9ydCB7IENvbnNvbGUgfSBmcm9tICdjb25zb2xlJzsKaW1wb3J0IEVDTUFTY3JpcHRMZXhlciBmcm9tICdsaWIvbGV4ZXIvZWNtYXNjcmlwdC5qcyc7CmltcG9ydCB7IGVzY2FwZSwgdG9TdHJpbmcsIGRlZmluZSwgY3VycnksIHVuaXF1ZSwgc3BsaXQsIGV4dGVuZEFycmF5LCBjYW1lbGl6ZSwgZ2V0T3B0IH0gZnJvbSAndXRpbCc7CgpsZXQgYnVmZmVycyA9IHt9LAogIG1vZHVsZXMgPSB7fTsKbGV0IFQsCiAgY29kZSA9ICdjJywKICBkZWJ1ZywKICB2ZXJib3NlLAogIHNvcnQsCiAgcGFyYW1zLAogIGNhc2VTZW5zaXRpdmUsCiAgcXVpZXQsCiAgZXhwLAogIHJlbGF0aXZlVG8sCiAgcHJpbnRGaWxlcywKICBvbmx5VXBwZXJjYXNlLAogIGZpbHRlciA9IG51bGwsCiAgbWF0Y2ggPSBuZXcgU2V0KCksCiAgaWRlbnRpZmllcnM7CgooJ3VzZSBzdHJpY3QnKTsKKCd1c2UgbWF0aCcpOwoKZXh0ZW5kQXJyYXkoQXJyYXkucHJvdG90eXBlKTsKCmNvbnN0IEFkZFVuaXF1ZSA9IChhcnIsIGl0ZW0pID0+IChhcnIuaW5kZXhPZihpdGVtKSA9PSAtMSA/IGFyci5wdXNoKGl0ZW0pIDogbnVsbCk7Cgpjb25zdCBJbnRUb0RXb3JkID0gaXZhbCA9PiAoaXNOYU4oaXZhbCkgPT09IGZhbHNlICYmIGl2YWwgPCAwID8gaXZhbCArIDQyOTQ5NjcyOTYgOiBpdmFsKTsKY29uc3QgSW50VG9CaW5hcnkgPSBpID0+IChpID09IC0xIHx8IHR5cGVvZiBpICE9ICdudW1iZXInID8gaSA6ICcwYicgKyBJbnRUb0RXb3JkKGkpLnRvU3RyaW5nKDIpKTsKCmNvbnN0IGJ1ZmZlclJlZiA9IG5ldyBXZWFrTWFwKCk7CgpmdW5jdGlvbiBCdWZmZXJGaWxlKGZpbGUpIHsKICAvL2NvbnNvbGUubG9nKCdCdWZmZXJGaWxlJywgZmlsZSk7CiAgaWYoYnVmZmVyc1tmaWxlXSkgcmV0dXJuIGJ1ZmZlcnNbZmlsZV07CiAgbGV0IGIgPSAoYnVmZmVyc1tmaWxlXSA9IGZzLnJlYWRGaWxlU3luYyhmaWxlLCB7IGZsYWc6ICdyJyB9KSk7CiAgLy9jb25zb2xlLmxvZygnYnVmZmVyUmVmJywgYnVmZmVyUmVmLCBidWZmZXJSZWYuc2V0LCBiKTsKICBpZih0eXBlb2YgYiA9PSAnb2JqZWN0JyAmJiBiICE9PSBudWxsKSBidWZmZXJSZWYuc2V0KGIsIGZpbGUpOwogIHJldHVybiBiOwp9CgpmdW5jdGlvbiBCdWZmZXJMZW5ndGhzKGZpbGUpIHsKICByZXR1cm4gYnVmZmVyc1tmaWxlXS5tYXAoYiA9PiBiLmJ5dGVMZW5ndGgpOwp9CgpmdW5jdGlvbiBCdWZmZXJPZmZzZXRzKGZpbGUpIHsKICByZXR1cm4gYnVmZmVyc1tmaWxlXS5yZWR1Y2UoKFtwb3MsIGxpc3RdLCBiKSA9PiBbcG9zICsgYi5ieXRlTGVuZ3RoLCBsaXN0LmNvbmNhdChbcG9zXSldLCBbMCwgW11dKVsxXTsKfQoKZnVuY3Rpb24gQnVmZmVyUmFuZ2VzKGZpbGUpIHsKICByZXR1cm4gYnVmZmVyc1tmaWxlXS5yZWR1Y2UoKFtwb3MsIGxpc3RdLCBiKSA9PiBbcG9zICsgYi5ieXRlTGVuZ3RoLCBsaXN0LmNvbmNhdChbW3BvcywgYi5ieXRlTGVuZ3RoXV0pXSwgWzAsIFtdXSlbMV07Cn0KCmZ1bmN0aW9uIFdyaXRlRmlsZShmaWxlLCB0b2spIHsKICBsZXQgZiA9IHN0ZC5vcGVuKGZpbGUsICd3KycpOwogIGYucHV0cyh0b2spOwogIGNvbnNvbGUubG9nKCdXcm90ZSAiJyArIGZpbGUgKyAnIjogJyArIHRvay5sZW5ndGggKyAnIGJ5dGVzJyk7Cn0KCmZ1bmN0aW9uIER1bXBMZXhlcihsZXgpIHsKICBjb25zdCB7IHNpemUsIHBvcywgc3RhcnQsIGxpbmUsIGNvbHVtbiwgbGluZVN0YXJ0LCBsaW5lRW5kLCBjb2x1bW5JbmRleCB9ID0gbGV4OwoKICByZXR1cm4gJ0xleGVyICcgKyBpbnNwZWN0KHsgc3RhcnQsIHBvcywgc2l6ZSB9KTsKfQoKZnVuY3Rpb24gRHVtcFRva2VuKHRvaykgewogIGNvbnN0IHsgbGVuZ3RoLCBvZmZzZXQsIGNoYXJzLCBsb2MgfSA9IHRvazsKCiAgcmV0dXJuIGDimIUgVG9rZW4gJHtpbnNwZWN0KHsgY2hhcnMsIG9mZnNldCwgbGVuZ3RoLCBsb2MgfSwgeyBkZXB0aDogMSB9KX1gOwp9Cgpjb25zdCBXaGF0ID0gewogIElNUE9SVDogMCwKICBFWFBPUlQ6IDEKfTsKCmNvbnN0IEltcG9ydFR5cGVzID0gewogIElNUE9SVDogMCwKICBJTVBPUlRfREVGQVVMVDogMSwKICBJTVBPUlRfTkFNRVNQQUNFOiAyCn07Cgpjb25zdCBUb2tJcyA9IGN1cnJ5KCh0eXBlLCBsZXhlbWUsIHRvaykgPT4gewogIGlmKGxleGVtZSAhPSB1bmRlZmluZWQpIHsKICAgIGlmKHR5cGVvZiBsZXhlbWUgPT0gJ3N0cmluZycgJiYgdG9rLmxleGVtZSAhPSBsZXhlbWUpIHJldHVybiBmYWxzZTsKICAgIGVsc2UgaWYoQXJyYXkuaXNBcnJheShsZXhlbWUpICYmIGxleGVtZS5pbmRleE9mKHRvay5sZXhlbWUpID09IC0xKSByZXR1cm4gZmFsc2U7CiAgfQogIGlmKHR5cGUgIT0gdW5kZWZpbmVkKSB7CiAgICBpZih0eXBlb2YgdHlwZSA9PSAnc3RyaW5nJyAmJiB0b2sudHlwZSAhPSB0eXBlKSByZXR1cm4gZmFsc2U7CiAgICBpZih0eXBlb2YgdHlwZSA9PSAnbnVtYmVyJyAmJiB0b2suaWQgIT0gdHlwZSkgcmV0dXJuIGZhbHNlOwogIH0KICByZXR1cm4gdHJ1ZTsKfSk7Cgpjb25zdCBJc0tleXdvcmQgPSBUb2tJcygna2V5d29yZCcpOwpjb25zdCBJc1B1bmN0dWF0b3IgPSBUb2tJcygncHVuY3R1YXRvcicpOwpjb25zdCBJc0lkZW50aWZpZXIgPSBUb2tJcygnaWRlbnRpZmllcicpOwpjb25zdCBJc1N0cmluZ0xpdGVyYWwgPSBUb2tJcygnc3RyaW5nTGl0ZXJhbCcpOwoKZnVuY3Rpb24gSW1wb3J0VHlwZShzZXEpIHsKICBpZihJc0tleXdvcmQoJ2ltcG9ydCcsIHNlcVswXSkpIHNlcS5zaGlmdCgpOwogIGlmKElzUHVuY3R1YXRvcignKicsIHNlcVswXSkpIHsKICAgIGlmKElzS2V5d29yZCgnYXMnLCBzZXFbMV0pKSByZXR1cm4gSW1wb3J0VHlwZXMuSU1QT1JUX05BTUVTUEFDRTsKICB9IGVsc2UgaWYoSXNJZGVudGlmaWVyKHVuZGVmaW5lZCwgc2VxWzBdKSkgewogICAgaWYoSXNLZXl3b3JkKCdmcm9tJywgc2VxWzFdKSkgcmV0dXJuIEltcG9ydFR5cGVzLklNUE9SVF9ERUZBVUxUOwogIH0KICByZXR1cm4gSW1wb3J0VHlwZXMuSU1QT1JUOwp9CgpmdW5jdGlvbiBJbXBvcnRGaWxlKHNlcSkgewogIGxldCBpZHggPSBzZXEuZmluZEluZGV4KHRvayA9PiBJc0tleXdvcmQoJ2Zyb20nLCB0b2spKTsKICB3aGlsZShzZXFbaWR4XSAmJiBzZXFbaWR4XS50eXBlICE9ICdzdHJpbmdMaXRlcmFsJykgKytpZHg7CiAgcmV0dXJuIHNlcVtpZHhdLmxleGVtZS5yZXBsYWNlKC9eW1wnXCJcYF0oLiopW1wnXCJcYF0kL2csICckMScpOwp9CgpmdW5jdGlvbiBFeHBvcnROYW1lKHNlcSkgewogIHNlcSA9IHNlcS5maWx0ZXIoKHsgdHlwZSB9KSA9PiB0eXBlICE9ICd3aGl0ZXNwYWNlJyk7CiAgbGV0IGlkeCA9IHNlcS5maW5kSW5kZXgodG9rID0+IElzSWRlbnRpZmllcih1bmRlZmluZWQsIHRvaykgfHwgSXNLZXl3b3JkKCdkZWZhdWx0JywgdG9rKSk7CiAgaWYoc2VxW2lkeCArIDFdICYmIElzS2V5d29yZCgnYXMnLCBzZXFbaWR4ICsgMV0pKSBpZHggKz0gMjsKICBsZXQgcmV0ID0gc2VxW2lkeF0/LmxleGVtZTsKICByZXR1cm4gcmV0Owp9CgpmdW5jdGlvbiBBZGRFeHBvcnQodG9rZW5zKSB7CiAgbGV0IGNvZGUgPSB0b2tlbnMubWFwKHRvayA9PiB0b2subGV4ZW1lKS5qb2luKCcnKTsKICB0b2tlbnMgPSB0b2tlbnMuZmlsdGVyKHRvayA9PiB0b2sudHlwZSAhPSAnd2hpdGVzcGFjZScpOwogIGxldCBsZW4gPSB0b2tlbnMuZmluZEluZGV4KHRvayA9PiBJc0lkZW50aWZpZXIodW5kZWZpbmVkLCB0b2spIHx8IElzS2V5d29yZCgnZGVmYXVsdCcsIHRvaykpICsgMTsKICB0b2tlbnMgPSB0b2tlbnMuc2xpY2UoMCwgbGVuKTsKICBsZXQgZXhwID0gZGVmaW5lKAogICAgewogICAgICB0eXBlOiB0b2tlbnNbMV0/LmxleGVtZSwKICAgICAgdG9rZW5zLAogICAgICBleHBvcnRlZDogRXhwb3J0TmFtZSh0b2tlbnMpLAogICAgICByYW5nZTogWyt0b2tlbnNbMF0/LmxvYywgK3Rva2Vucy5sYXN0Py5sb2NdCiAgICB9LAogICAgeyBjb2RlLCBsb2M6IHRva2Vuc1swXT8ubG9jIH0KICApOwogIHJldHVybiBleHA7Cn0KCmZ1bmN0aW9uIEFkZEltcG9ydCh0b2tlbnMpIHsKICAvL2NvbnNvbGUubG9nKCd0b2tlbnM6JywgdG9rZW5zKTsKICBsZXQgcmFuZ2UgPSBbK3Rva2Vuc1swXS5sb2MsICt0b2tlbnMubGFzdC5sb2NdLAogICAgY29kZSA9IHRva2Vucy5tYXAodG9rID0+IHRvay5sZXhlbWUpLmpvaW4oJycpOwogIHRva2VucyA9IHRva2Vucy5maWx0ZXIodG9rID0+IHRvay50eXBlICE9ICd3aGl0ZXNwYWNlJyk7CiAgbGV0IHR5cGUgPSBJbXBvcnRUeXBlKHRva2VucyksCiAgICBmaWxlID0gSW1wb3J0RmlsZSh0b2tlbnMpOwogIGNvbnN0IHsgbG9jLCBzZXEgfSA9IHRva2Vuc1swXTsKICBsZXQgaW1wID0gZGVmaW5lKHsgdHlwZSwgZmlsZSwgbG9jLCBzZXEsIHJhbmdlIH0sIHsgdG9rZW5zLCBjb2RlIH0pOwogIGltcC5sb2NhbCA9IHsKICAgIFtJbXBvcnRUeXBlcy5JTVBPUlRfTkFNRVNQQUNFXTogKCkgPT4gewogICAgICBsZXQgaWR4ID0gdG9rZW5zLmZpbmRJbmRleCh0b2sgPT4gSXNLZXl3b3JkKCdhcycsIHRvaykpOwogICAgICByZXR1cm4gdG9rZW5zW2lkeCArIDFdLmxleGVtZTsKICAgIH0sCiAgICBbSW1wb3J0VHlwZXMuSU1QT1JUX0RFRkFVTFRdOiAoKSA9PiB7CiAgICAgIGxldCBpZHggPSB0b2tlbnMuZmluZEluZGV4KHRvayA9PiBJc0tleXdvcmQoJ2ltcG9ydCcsIHRvaykpOwogICAgICByZXR1cm4gdG9rZW5zW2lkeCArIDFdLmxleGVtZTsKICAgIH0sCiAgICBbSW1wb3J0VHlwZXMuSU1QT1JUXTogKCkgPT4gewogICAgICBsZXQgaWR4ID0gMCwKICAgICAgICBzcGVjaWZpZXIgPSBbXSwKICAgICAgICBzcGVjaWZpZXJzID0gW107CiAgICAgIGlmKElzS2V5d29yZCgnaW1wb3J0JywgdG9rZW5zW2lkeF0pKSArK2lkeDsKICAgICAgaWYoSXNQdW5jdHVhdG9yKCd7JywgdG9rZW5zW2lkeF0pKSArK2lkeDsKICAgICAgZm9yKDsgIUlzS2V5d29yZCgnZnJvbScsIHRva2Vuc1tpZHhdKTsgKytpZHgpIHsKICAgICAgICBpZihJc1B1bmN0dWF0b3IoWycsJywgJ30nXSwgdG9rZW5zW2lkeF0pKSB7CiAgICAgICAgICBpZihzcGVjaWZpZXIubGVuZ3RoKSBzcGVjaWZpZXJzLnB1c2goc3BlY2lmaWVyKTsKICAgICAgICAgIHNwZWNpZmllciA9IFtdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzcGVjaWZpZXIucHVzaCh0b2tlbnNbaWR4XS5sZXhlbWUpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gc3BlY2lmaWVyczsKICAgIH0KICB9W3R5cGVdKCk7CgogIHJldHVybiBpbXA7Cn0KCmZ1bmN0aW9uIFByaW50RVM2SW1wb3J0KGltcCkgewogIHJldHVybiB7CiAgICBbSW1wb3J0VHlwZXMuSU1QT1JUX05BTUVTUEFDRV06ICh7IGxvY2FsLCBmaWxlIH0pID0+IGBpbXBvcnQgKiBhcyAke2xvY2FsfSBmcm9tICcke2ZpbGV9JztgLAogICAgW0ltcG9ydFR5cGVzLklNUE9SVF9ERUZBVUxUXTogKHsgbG9jYWwsIGZpbGUgfSkgPT4gYGltcG9ydCAke2xvY2FsfSBmcm9tICcke2ZpbGV9JztgLAogICAgW0ltcG9ydFR5cGVzLklNUE9SVF06ICh7IGxvY2FsLCBmaWxlIH0pID0+IGBpbXBvcnQgeyAke2xvY2FsLmpvaW4oJywgJyl9IH0gZnJvbSAnJHtmaWxlfSc7YAogIH1baW1wLnR5cGVdKGltcCk7Cn0KCmZ1bmN0aW9uIFByaW50Q0pTSW1wb3J0KHsgdHlwZSwgbG9jYWwsIGZpbGUgfSkgewogIHJldHVybiB7CiAgICBbSW1wb3J0VHlwZXMuSU1QT1JUX05BTUVTUEFDRV06ICgpID0+IGBjb25zdCAke2xvY2FsfSA9IHJlcXVpcmUoJyR7ZmlsZX0nKTtgLAogICAgW0ltcG9ydFR5cGVzLklNUE9SVF9ERUZBVUxUXTogKCkgPT4gYGNvbnN0ICR7bG9jYWx9ID0gcmVxdWlyZSgnJHtmaWxlfScpO2AsCiAgICBbSW1wb3J0VHlwZXMuSU1QT1JUXTogKCkgPT4gYGNvbnN0IHsgJHtsb2NhbC5qb2luKCcsICcpfSB9ID0gcmVxdWlyZSgnJHtmaWxlfScpO2AKICB9W3R5cGVdKCk7Cn0KCmZ1bmN0aW9uKiBHZXRUb2tlbnMoZmlsZSwgcHJlZCA9ICh7IHR5cGUgfSkgPT4gdHlwZSA9PSAnaWRlbnRpZmllcicpIHsKICBjb25zb2xlLmxvZygnZmlsZScsIGZpbGUpOwoKICBsZXQgc3RyID0gQnVmZmVyRmlsZShmaWxlKTsKICBsZXQgdG9rLAogICAgbGV4ID0gbmV3IEVDTUFTY3JpcHRMZXhlcihzdHIsIGZpbGUpOwoKICB3aGlsZSgodG9rID0gbGV4Lm5leHQoKSkpIHsKICAgIGNvbnN0IHsgdG9rZW4gfSA9IGxleDsKCiAgICBpZihwcmVkKHRva2VuKSkgeWllbGQgdG9rZW47CiAgfQp9CgpmdW5jdGlvbiogVHJhbnNmb3JtTGV4ZW1lKGdlbikgewogIGZvcihsZXQgdG9rZW4gb2YgZ2VuKSB5aWVsZCB0b2tlbi5sZXhlbWU7Cn0KCmZ1bmN0aW9uKiBHZXRDb21tYW5kcyhmaWxlKSB7CiAgbGV0IGxleCA9IEdldFRva2VucyhmaWxlLCAoeyB0eXBlIH0pID0+IHR5cGUgIT0gJ3doaXRlc3BhY2UnKTsKICBsZXQgYSA9IFtdOwogIGZvcihsZXQgdG9rIG9mIGxleCkgewogICAgYS5wdXNoKHRvayk7CgogICAgaWYodG9rLnR5cGUgPT0gJ3B1bmN0dWF0b3InICYmIHRvay5sZXhlbWUgPT0gJzsnKSB7CiAgICAgIHlpZWxkIGE7CiAgICAgIGEgPSBbXTsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIExpc3RFeHBvcnRzKGZpbGUsIG91dHB1dCkgewogIGlmKHByaW50RmlsZXMpIHN0ZC5vdXQucHV0cyhgJHtmaWxlfVxuYCk7CgogIGNvbnN0IGxvZyA9IHF1aWV0ID8gKCkgPT4ge30gOiAoLi4uYXJncykgPT4gY29uc29sZS5sb2coYCR7ZmlsZX06YCwgLi4uYXJncyk7CgogIGxldCBzdHIgPSBmaWxlID8gQnVmZmVyRmlsZShmaWxlKSA6IGNvZGVbMV0sCiAgICBsZW4gPSBzdHIubGVuZ3RoLAogICAgdHlwZSA9IHBhdGguZXh0bmFtZShmaWxlKS5zdWJzdHJpbmcoMSksCiAgICBiYXNlID0gY2FtZWxpemUocGF0aC5iYXNlbmFtZShmaWxlLCAnLicgKyB0eXBlKS5yZXBsYWNlKC9bXjAtOUEtWmEtel9dL2csICdfJykpOwoKICBsZXQgbGV4ID0gewogICAganM6IG5ldyBFQ01BU2NyaXB0TGV4ZXIoc3RyLCBmaWxlKQogIH07CgogIGNvbnN0IGxleGVyID0gbGV4W3R5cGVdOwoKICBUID0gbGV4ZXIudG9rZW5zLnJlZHVjZSgoYWNjLCBuYW1lLCBpZCkgPT4gKHsgLi4uYWNjLCBbbmFtZV06IGlkIH0pLCB7fSk7CgogIGxldCBlID0gbmV3IFN5bnRheEVycm9yKCk7CgogIGxleGVyLmhhbmRsZXIgPSBsZXggPT4gewogICAgY29uc3QgeyBsb2MsIG1vZGUsIHBvcywgc3RhcnQsIGJ5dGVMZW5ndGgsIHN0YXRlIH0gPSBsZXg7CiAgICBsb2coJyAnLnJlcGVhdChsb2MuY29sdW1uIC0gMSkgKyAnXicpOwogIH07CiAgbGV0IHRva2VuTGlzdCA9IFtdLAogICAgZGVjbGFyYXRpb25zID0gW107CiAgY29uc3QgY29sU2l6ZXMgPSBbMTIsIDgsIDQsIDIwLCAzMiwgMTAsIDBdOwogIGNvbnN0IHByaW50VG9rID0KICAgIGRlYnVnID4gMgogICAgICA/ICh0b2ssIHByZWZpeCkgPT4gewogICAgICAgICAgY29uc3QgcmFuZ2UgPSB0b2suY2hhclJhbmdlOwogICAgICAgICAgY29uc3QgY29scyA9IFtwcmVmaXgsIGB0b2tbJHt0b2suYnl0ZUxlbmd0aH1dYCwgdG9rLmlkLCB0b2sudHlwZSwgdG9rLmxleGVtZSwgdG9rLmxleGVtZS5sZW5ndGgsIHRvay5sb2NdOwogICAgICAgICAgc3RkLmVyci5wdXRzKGNvbHMucmVkdWNlKChhY2MsIGNvbCwgaSkgPT4gYWNjICsgKGNvbCArICcnKS5yZXBsYWNlQWxsKCdcbicsICdcXG4nKS5wYWRFbmQoY29sU2l6ZXNbaV0pLCAnJykgKyAnXG4nKTsKICAgICAgICB9CiAgICAgIDogKCkgPT4ge307CgogIGxldCB0b2ssCiAgICBpID0gMCwKICAgIG1hc2sgPSBJbnRUb0JpbmFyeShsZXhlci5tYXNrKSwKICAgIHN0YXRlID0gbGV4ZXIudG9wU3RhdGUoKTsKICBsZXhlci5iZWdpbkNvZGUgPSAoKSA9PiAoY29kZSA9PSAnanMnID8gMGIxMDAwIDogMGIwMTAwKTsKICBsZXQgdG9rZW5zID0gW10sCiAgICBzdGFydCA9IERhdGUubm93KCk7CiAgY29uc3QgYmFsYW5jZXIgPSAoKSA9PiB7CiAgICBsZXQgc2VsZjsKICAgIGxldCBzdGFjayA9IFtdOwogICAgY29uc3QgdGFibGUgPSB7ICd9JzogJ3snLCAnXSc6ICdbJywgJyknOiAnKCcgfTsKICAgIHNlbGYgPSBmdW5jdGlvbiBQYXJlbnRoZXNlQmFsYW5jZXIodG9rKSB7CiAgICAgIHN3aXRjaCAodG9rPy5sZXhlbWUpIHsKICAgICAgICBjYXNlICd7JzoKICAgICAgICBjYXNlICdbJzoKICAgICAgICBjYXNlICcoJzogewogICAgICAgICAgc3RhY2sucHVzaCh0b2subGV4ZW1lKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjYXNlICd9JzoKICAgICAgICBjYXNlICddJzoKICAgICAgICBjYXNlICcpJzogewogICAgICAgICAgaWYoc3RhY2subGFzdCAhPSB0YWJsZVt0b2subGV4ZW1lXSkgdGhyb3cgbmV3IEVycm9yKGB0b3AgJyR7c3RhY2subGFzdH0nICE9ICcke3Rvay5sZXhlbWV9JyBbICR7c3RhY2subWFwKHMgPT4gYCcke3N9J2ApLmpvaW4oJywgJyl9IF1gKTsKCiAgICAgICAgICBzdGFjay5wb3AoKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICAgIE9iamVjdC5hc3NpZ24oc2VsZiwgewogICAgICBzdGFjaywKICAgICAgcmVzZXQoKSB7CiAgICAgICAgc3RhY2suY2xlYXIoKTsKICAgICAgfSwKICAgICAgLyogcHJldHRpZXItaWdub3JlICovIGdldCBkZXB0aCgpIHsKICAgICAgICByZXR1cm4gc3RhY2subGVuZ3RoOwogICAgICB9CiAgICB9KTsKCiAgICByZXR1cm4gc2VsZjsKICB9OwogIGxldCBiYWxhbmNlcnMgPSBbYmFsYW5jZXIoKV0sCiAgICBpbXBvcnRzID0gW10sCiAgICBleHBvcnRzID0gW10sCiAgICBpbXBleHAsCiAgICBjb25kLAogICAgaW1wID0gW10sCiAgICBzaG93VG9rZW4gPSB0b2sgPT4gewogICAgICBpZigobGV4ZXIuY29uc3RydWN0b3IgIT0gRUNNQVNjcmlwdExleGVyICYmIHRvay50eXBlICE9ICd3aGl0ZXNwYWNlJykgfHwgL14oKGltfGV4KXBvcnR8ZnJvbXxhcykkLy50ZXN0KHRvay5sZXhlbWUpKSB7CiAgICAgICAgbGV0IGEgPSBbLyooZmlsZSArICc6JyArIHRvay5sb2MpLnBhZEVuZChmaWxlLmxlbmd0aCsxMCksKi8gdG9rLnR5cGUucGFkRW5kKDIwLCAnICcpLCBlc2NhcGUodG9rLmxleGVtZSldOwogICAgICAgIHN0ZC5lcnIucHV0cyhhLmpvaW4oJycpICsgJ1xuJyk7CiAgICAgIH0KICAgIH07CgogIGZvcig7OykgewogICAgbGV0IHsgc3RhdGVEZXB0aCB9ID0gbGV4ZXI7CiAgICBsZXQgdmFsdWUgPSBsZXhlci5uZXh0KCk7CiAgICBsZXQgZG9uZSA9IHZhbHVlID09PSB1bmRlZmluZWQ7CgogICAgLy8gICAgY29uc29sZS5sb2coJ3ZhbHVlJyx7dmFsdWUsZG9uZX0pOwogICAgaWYoZG9uZSkgYnJlYWs7CiAgICBsZXQgbmV3U3RhdGUgPSBsZXhlci50b3BTdGF0ZSgpOwogICAgLy9zaG93VG9rZW4odG9rKTsKICAgIGlmKG5ld1N0YXRlICE9IHN0YXRlKSB7CiAgICAgIGlmKHN0YXRlID09ICdURU1QTEFURScgJiYgbGV4ZXIuc3RhdGVEZXB0aCA+IHN0YXRlRGVwdGgpIGJhbGFuY2Vycy5wdXNoKGJhbGFuY2VyKCkpOwogICAgICBpZihuZXdTdGF0ZSA9PSAnVEVNUExBVEUnICYmIGxleGVyLnN0YXRlRGVwdGggPCBzdGF0ZURlcHRoKSBiYWxhbmNlcnMucG9wKCk7CiAgICB9CiAgICBsZXQgbiA9IGJhbGFuY2Vycy5sYXN0LmRlcHRoOwogICAgdG9rID0gbGV4ZXIudG9rZW47CgogICAgaWYodG9rID09IG51bGwpIGJyZWFrOwoKICAgIGlmKG4gPT0gMCAmJiB0b2subGV4ZW1lID09ICd9JyAmJiBsZXhlci5zdGF0ZURlcHRoID4gMCkgewogICAgICBsZXhlci5wb3BTdGF0ZSgpOwogICAgfSBlbHNlIHsKICAgICAgYmFsYW5jZXIodG9rKTsKICAgICAgaWYobiA+IDAgJiYgYmFsYW5jZXJzLmxhc3QuZGVwdGggPT0gMCkgbG9nKCdiYWxhbmNlcicpOwogICAgICBpZihbJ2ltcG9ydCcsICdleHBvcnQnXS5pbmRleE9mKHRvay5sZXhlbWUpID49IDApIHsKICAgICAgICBpbXBleHAgPSBXaGF0W3Rvay5sZXhlbWUudG9VcHBlckNhc2UoKV07CiAgICAgICAgbGV0IHByZXYgPSB0b2tlbnNbdG9rZW5zLmxlbmd0aCAtIDFdOwogICAgICAgIGNvbmQgPSB0cnVlOwogICAgICAgIGltcCA9IFtdOwogICAgICB9CiAgICAgIGlmKGNvbmQgPT0gdHJ1ZSkgewogICAgICAgIGltcC5wdXNoKHRvayk7CiAgICAgICAgaWYoWyc7JywgJ1xuJ10uaW5kZXhPZih0b2subGV4ZW1lKSAhPSAtMSkgewogICAgICAgICAgY29uZCA9IGZhbHNlOwogICAgICAgICAgaWYoaW1wLnNvbWUoaSA9PiBpLmxleGVtZSA9PSAnZnJvbScpKSB7CiAgICAgICAgICAgIGlmKGltcGV4cCA9PSBXaGF0LklNUE9SVCkgaW1wb3J0cy5wdXNoKEFkZEltcG9ydChpbXApKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZihpbXBleHAgPT0gV2hhdC5FWFBPUlQpIGV4cG9ydHMucHVzaChBZGRFeHBvcnQoaW1wKSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHByaW50VG9rKHRvaywgbmV3U3RhdGUpOwogICAgICB0b2tlbnMucHVzaCh0b2spOwogICAgfQogICAgc3RhdGUgPSBuZXdTdGF0ZTsKICB9CgogIGNvbnN0IGV4cG9ydFRva2VucyA9IHRva2Vucy5yZWR1Y2UoKGFjYywgdG9rLCBpKSA9PiAodG9rLmxleGVtZSA9PSAnZXhwb3J0JyA/IGFjYy5jb25jYXQoW2ldKSA6IGFjYyksIFtdKTsKICAvL2xvZygnRXhwb3J0IHRva2VucycsIHRva2Vucy5tYXAodCA9PiB0LmxleGVtZSkpOwoKICBsZXQgZXhwb3J0TmFtZXMgPSBleHBvcnRUb2tlbnMubWFwKGluZGV4ID0+IEV4cG9ydE5hbWUodG9rZW5zLnNsaWNlKGluZGV4KSkpOwogIC8vbG9nKCdFeHBvcnQgbmFtZXMnLCBleHBvcnROYW1lcyk7CgogIC8qbG9nKCdFUzYgaW1wb3J0cycsIGltcG9ydHMubWFwKFByaW50RVM2SW1wb3J0KSk7CiAgICBsb2coJ0NKUyBpbXBvcnRzJywgaW1wb3J0cy5tYXAoUHJpbnRDSlNJbXBvcnQpKTsqLwogIGxldCBjb21wYXJlID0gKGEsIGIpID0+ICgnJyArIGEpLmxvY2FsZUNvbXBhcmUoJycgKyBiKTsKCiAgaWYoIWNhc2VTZW5zaXRpdmUpIHsKICAgIGxldCBmbiA9IGNvbXBhcmU7CiAgICBjb21wYXJlID0gKGEsIGIpID0+CiAgICAgIGZuLmFwcGx5KAogICAgICAgIG51bGwsCiAgICAgICAgW2EsIGJdLm1hcChzID0+ICgnJyArIHMpLnRvTG93ZXJDYXNlKCkpCiAgICAgICk7CiAgfQoKICBpZihzb3J0KSBleHBvcnROYW1lcy5zb3J0KGNvbXBhcmUpOwogIGlmKHBhcmFtcy5leGNsdWRlKSB7CiAgICBsZXQgcmUgPSBuZXcgUmVnRXhwKHBhcmFtcy5leGNsdWRlLCAnZycpOwogICAgZXhwb3J0TmFtZXMgPSBleHBvcnROYW1lcy5maWx0ZXIobiA9PiAhcmUudGVzdChuKSk7CiAgfQogIGlmKHBhcmFtcy5pbmNsdWRlKSB7CiAgICBsb2coJ3BhcmFtcy5pbmNsdWRlJywgcGFyYW1zLmluY2x1ZGUpOwogICAgbGV0IHJlID0gbmV3IFJlZ0V4cChwYXJhbXMuaW5jbHVkZSwgJ2cnKTsKICAgIGV4cG9ydE5hbWVzID0gZXhwb3J0TmFtZXMuZmlsdGVyKG4gPT4gcmUudGVzdChuKSk7CiAgfQoKICBpZihvbmx5VXBwZXJjYXNlKSBleHBvcnROYW1lcyA9IGV4cG9ydE5hbWVzLmZpbHRlcihuYW1lID0+IC9eW0EtWl0vLnRlc3QobmFtZSkpOwoKICBsZXQgaWR4OwogIGlmKChpZHggPSBleHBvcnROYW1lcy5pbmRleE9mKGJhc2UpKSAhPSAtMSAmJiBleHBvcnROYW1lcy5pbmRleE9mKCdkZWZhdWx0JykgIT0gLTEpIHsKICAgIGV4cG9ydE5hbWVzLnNwbGljZShpZHgsIDEpOwogICAgbG9nKGBceDFiWzE7MzFtcmVtb3ZpbmcgJyR7YmFzZX0nXHgxYlswbWApOwogIH0KCiAgbGV0IHNvdXJjZSA9IGZpbGU7CgogIGlmKHJlbGF0aXZlVG8pIHsKICAgIGxldCByZWwgPSBwYXRoLnJlc29sdmUocmVsYXRpdmVUbyk7CiAgICBzb3VyY2UgPSBwYXRoLmFic29sdXRlKHNvdXJjZSk7CgogICAgaWYocGF0aC5leGlzdHMocmVsKSAmJiAhcGF0aC5pc0RpcmVjdG9yeShyZWwpKSByZWwgPSBwYXRoLmRpcm5hbWUocmVsKTsKCiAgICBsb2coJ1x4MWJbMTszM21yZWxhdGl2ZVRvXHgxYlswbScsIHsgcmVsLCBzb3VyY2UgfSk7CgogICAgc291cmNlID0gcGF0aC5yZWxhdGl2ZShzb3VyY2UsIHJlbCk7CiAgfQoKICBpZihwYXRoLmlzUmVsYXRpdmUoc291cmNlKSAmJiAhL14oXC58XC5cLilcLy8udGVzdChzb3VyY2UpKSBzb3VyY2UgPSAnLi8nICsgc291cmNlOwoKICAgIGNvbnNvbGUubG9nKCdleHBvcnROYW1lcycsZXhwb3J0TmFtZXMpOwogIGlmKGV4cG9ydE5hbWVzLmxlbmd0aCkgewogICAgbGV0IG5hbWVzID0gZXhwb3J0TmFtZXMubWFwKHQgPT4gKHQgPT0gJ2RlZmF1bHQnID8gdCArICcgYXMgJyArIGJhc2UgOiB0KSk7CiAgICBjb25zdCBrZXl3b3JkID0gZXhwID8gJ2V4cG9ydCcgOiAnaW1wb3J0JzsKCiAgICBpZihmaWx0ZXIpIG5hbWVzID0gbmFtZXMuZmlsdGVyKGZpbHRlcik7CgogICAgaWYoaWRlbnRpZmllcnMpIHsKICAgICAgaWRlbnRpZmllcnMuZGVsZXRlKC4uLm5hbWVzKTsKICAgICAgbWF0Y2guYWRkKC4uLm5hbWVzKTsKICAgIH0KCiAgICBpZihwYXJhbXMucmF3KSBvdXRwdXQucHV0cyhuYW1lcy5qb2luKCdcbicpICsgJ1xuJyk7CiAgICBlbHNlIGlmKG5hbWVzLmxlbmd0aCA9PSAxICYmIC9eZGVmYXVsdCBhcy8udGVzdChuYW1lc1swXSkpIG91dHB1dC5wdXRzKGtleXdvcmQgKyBgICR7YmFzZX0gZnJvbSAnJHtzb3VyY2V9J1xuYCk7CiAgICBlbHNlIGlmKG5hbWVzLmxlbmd0aCA+IDApIG91dHB1dC5wdXRzKGtleXdvcmQgKyBgIHsgJHtuYW1lcy5qb2luKCcsICcpfSB9IGZyb20gJyR7c291cmNlfSdcbmApOwogIH0KCiAgbW9kdWxlc1tzb3VyY2VdID0geyBpbXBvcnRzLCBleHBvcnRzIH07CgogIGxldCBmaWxlSW1wb3J0cyA9IGltcG9ydHMuZmlsdGVyKGltcCA9PiAvXC5qcyQvaS50ZXN0KGltcC5zb3VyY2UpKTsKICBsZXQgc3BsaXRQb2ludHMgPSB1bmlxdWUoZmlsZUltcG9ydHMucmVkdWNlKChhY2MsIGltcCkgPT4gWy4uLmFjYywgLi4uaW1wLnJhbmdlXSwgW10pKTsKICBidWZmZXJzW3NvdXJjZV0gPSBbLi4uc3BsaXQoQnVmZmVyRmlsZShzb3VyY2UpLCAuLi5zcGxpdFBvaW50cyldLm1hcChiID0+IGIgPz8gdG9TdHJpbmcoYiwgMCwgYi5ieXRlTGVuZ3RoKSk7CgogIC8vbG9nKCdmaWxlSW1wb3J0cycsIGZpbGVJbXBvcnRzLm1hcChpbXAgPT4gaW1wLnNvdXJjZSkpOwoKICBsZXQgZGlyID0gcGF0aC5kaXJuYW1lKHNvdXJjZSk7CgogIGZpbGVJbXBvcnRzLmZvckVhY2goaW1wID0+IHsKICAgIGxldCBwID0gcGF0aC5jb2xsYXBzZShwYXRoLmpvaW4oZGlyLCBpbXAuZmlsZSkpOwogICAgLy9sb2coJ3AnLCBwKTsKCiAgICBBZGRVbmlxdWUoZmlsZXMsIHApOwogIH0pOwoKICBsZXQgZW5kID0gRGF0ZS5ub3coKTsKCiAgaWYodmVyYm9zZSkgbG9nKGB0b29rICR7ZW5kIC0gc3RhcnR9bXNgKTsKCiAgc3RkLmdjKCk7Cn0KCmZ1bmN0aW9uIG1haW4oLi4uYXJncykgewogIGdsb2JhbFRoaXMuY29uc29sZSA9IG5ldyBDb25zb2xlKHByb2Nlc3Muc3RkZXJyLCB7CiAgICBpbnNwZWN0T3B0aW9uczogewogICAgICBjb2xvcnM6IHRydWUsCiAgICAgIGRlcHRoOiA4LAogICAgICBicmVha0xlbmd0aDogMTYwLAogICAgICBtYXhTdHJpbmdMZW5ndGg6IEluZmluaXR5LAogICAgICBtYXhBcnJheUxlbmd0aDogSW5maW5pdHksCiAgICAgIGNvbXBhY3Q6IDAsCiAgICAgIHN0cmluZ0JyZWFrTmV3bGluZTogZmFsc2UsCiAgICAgIGhpZGVLZXlzOiBbU3ltYm9sLnRvU3RyaW5nVGFnIC8qLCAnY29kZScqL10KICAgIH0KICB9KTsKCiAgbGV0IG91dHB1dCA9IHN0ZC5vdXQ7CiAgbGV0IG91dHB1dEZpbGU7CgogIHBhcmFtcyA9IGdldE9wdCgKICAgIHsKICAgICAgaGVscDogWwogICAgICAgIGZhbHNlLAogICAgICAgIChfX2EsIF9feCwgcGFyYW1zKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZygnaGVscCcsIHsgX19hLCBfX3gsIHBhcmFtcyB9KTsKICAgICAgICAgIHN0ZC5wdXRzKGBVc2FnZTogJHtzY3JpcHRBcmdzWzBdfSBbT1BUSU9OU10gPGZpbGVzLi4uPlxuXG5gKTsKCiAgICAgICAgICBzdGQucHV0cyhwYXJhbXMubWFwKChbbmFtZSwgW2hhc0FyZywgLCBsZXR0ZXJdXSkgPT4gYCAgLSR7bGV0dGVyfSwgLS0ke25hbWV9ICR7KGhhc0FyZyA/ICc8QVJHPicgOiAnJykucGFkRW5kKDEwKX1cbmApLmpvaW4oJycpICsgJ1xuJyk7CiAgICAgICAgICBzdGQuZXhpdCgwKTsKICAgICAgICB9LAogICAgICAgICdoJwogICAgICBdLAogICAgICBkZWJ1ZzogW2ZhbHNlLCAoKSA9PiAoZGVidWcgPSAoZGVidWcgfCAwKSArIDEpLCAneCddLAogICAgICB2ZXJib3NlOiBbZmFsc2UsICgpID0+ICh2ZXJib3NlID0gKHZlcmJvc2UgfCAwKSArIDEpLCAndiddLAogICAgICBzb3J0OiBbZmFsc2UsICgpID0+IChzb3J0ID0gdHJ1ZSksICdzJ10sCiAgICAgIGluY2x1ZGU6IFt0cnVlLCBudWxsLCAnSSddLAogICAgICBleGNsdWRlOiBbdHJ1ZSwgbnVsbCwgJ1gnXSwKICAgICAgJ2Nhc2Utc2Vuc2l0aXZlJzogW2ZhbHNlLCAoKSA9PiAoY2FzZVNlbnNpdGl2ZSA9IHRydWUpLCAnYyddLAogICAgICByYXc6IFtmYWxzZSwgbnVsbCwgJ1InXSwKICAgICAgcXVpZXQ6IFtmYWxzZSwgKCkgPT4gKHF1aWV0ID0gdHJ1ZSksICdxJ10sCiAgICAgIGV4cG9ydDogW2ZhbHNlLCAoKSA9PiAoZXhwID0gdHJ1ZSksICdlJ10sCiAgICAgIGZvcjogW3RydWUsIG51bGwsICdmJ10sCiAgICAgICdwcmludC1maWxlcyc6IFtmYWxzZSwgKCkgPT4gKHByaW50RmlsZXMgPSB0cnVlKSwgJ3AnXSwKICAgICAgb3V0cHV0OiBbdHJ1ZSwgZmlsZW5hbWUgPT4gKG91dHB1dEZpbGUgPSBmaWxlbmFtZSkgLyogb3V0cHV0ID0gc3RkLm9wZW4oZmlsZW5hbWUsICd3KycpKi8sICdvJ10sCiAgICAgICdyZWxhdGl2ZS10byc6IFt0cnVlLCBhcmcgPT4gKHJlbGF0aXZlVG8gPSBwYXRoLmFic29sdXRlKGFyZykpLCAnciddLAogICAgICB1cHBlcmNhc2U6IFtmYWxzZSwgKCkgPT4gKG9ubHlVcHBlcmNhc2UgPSB0cnVlKSwgJ3UnXSwKICAgICAgJ0AnOiAnZmlsZXMnCiAgICB9LAogICAgYXJncwogICk7CiAgbGV0IGZpbGVzID0gcGFyYW1zWydAJ107CgogIGlmKG91dHB1dEZpbGUpIG91dHB1dCA9IHN0ZC5vcGVuKG91dHB1dEZpbGUsICd3KycpOwoKICBjb25zdCBSZWxhdGl2ZVBhdGggPSBmaWxlID0+IHBhdGguam9pbihwYXRoLmRpcm5hbWUocHJvY2Vzcy5hcmd2WzFdKSwgJy4uJywgZmlsZSk7CgogIGlmKCFmaWxlcy5sZW5ndGgpIGZpbGVzLnB1c2goUmVsYXRpdmVQYXRoKCcuL2xpYi91dGlsLmpzJykpOwoKICBpZihwYXJhbXNbJ2ZvciddKSB7CiAgICBpZGVudGlmaWVycyA9IG5ldyBTZXQoVHJhbnNmb3JtTGV4ZW1lKEdldFRva2VucyhwYXJhbXNbJ2ZvciddKSkpOwogICAgY29uc29sZS5sb2coJ2lkZW50aWZpZXJzJywgaWRlbnRpZmllcnMpOwoKICAgIGZpbHRlciA9ICgoKSA9PiB7CiAgICAgIGNvbnN0IHJlID0gbmV3IFJlZ0V4cCgnXignICsgWy4uLmlkZW50aWZpZXJzXS5qb2luKCd8JykgKyAnKSQnKTsKCiAgICAgIHJldHVybiBuYW1lID0+IHJlLnRlc3QobmFtZSk7CiAgICB9KSgpOwogIH0KCiAgY29uc29sZS5sb2coJ2ZpbGVzJywgZmlsZXMpOwoKICBmb3IobGV0IGZpbGUgb2YgZmlsZXMpIHsKICAgIGlmKDApCiAgICAgIGlmKCFmcy5leGlzdHNTeW5jKGZpbGUpIHx8IC9cLnNvJC8udGVzdChmaWxlKSkgewogICAgICAgIGxldCBtOwoKICAgICAgICB0cnkgewogICAgICAgICAgaWYoKG0gPSBsb2FkTW9kdWxlKGZpbGUpKSkgewogICAgICAgICAgICBsZXQgbGlzdCA9IGdldE1vZHVsZUV4cG9ydHMobSk7CgogICAgICAgICAgICBjb25zb2xlLmxvZygnRXhwb3J0cycsIGxpc3QpOwogICAgICAgICAgfQogICAgICAgICAgY29udGludWU7CiAgICAgICAgfSBjYXRjaChlKSB7fQogICAgICB9CiAgICBMaXN0RXhwb3J0cyhmaWxlLCBvdXRwdXQpOwogIH0KCiAgLyogIGlmKGlkZW50aWZpZXJzLnNpemUpIHsKICAgIHN0ZC5lcnIucHV0cyhgJHtpZGVudGlmaWVycy5zaXplfSBpZGVudGlmaWVycyBjb3VsZCBub3QgYmUgbWF0Y2hlZDpcbiR7Wy4uLmlkZW50aWZpZXJzXS5qb2luKCdcbicpfVxuYCk7CiAgfSovCn0KCnRyeSB7CiAgbWFpbiguLi5zY3JpcHRBcmdzLnNsaWNlKDEpKTsKfSBjYXRjaChlcnJvcikgewogIGNvbnNvbGUubG9nKGBGQUlMOiAke2Vycm9yLm1lc3NhZ2V9XG4ke2Vycm9yLnN0YWNrfWApOwogIHN0ZC5leGl0KDEpOwp9CgAAAAAAAAAAxz8AAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABWPwAAAAAAAFY/AAAAAAAAAAAAAAAA8L8"
				],
				[
					6,
					1,
					"revert",
					null,
					"AwAAAAAAAAAAAAAAAAAAAAAAAADJPwAAIyEvdXNyL2Jpbi9lbnYgcWpzbQppbXBvcnQgKiBhcyBvcyBmcm9tICdvcyc7CmltcG9ydCAqIGFzIHN0ZCBmcm9tICdzdGQnOwppbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7CmltcG9ydCBpbnNwZWN0IGZyb20gJ2luc3BlY3QnOwppbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnOwppbXBvcnQgeyBMZXhlciwgVG9rZW4gfSBmcm9tICdsZXhlcic7CmltcG9ydCB7IENvbnNvbGUgfSBmcm9tICdjb25zb2xlJzsKaW1wb3J0IEVDTUFTY3JpcHRMZXhlciBmcm9tICdsaWIvbGV4ZXIvZWNtYXNjcmlwdC5qcyc7CmltcG9ydCB7IGVzY2FwZSwgdG9TdHJpbmcsIGRlZmluZSwgY3VycnksIHVuaXF1ZSwgc3BsaXQsIGV4dGVuZEFycmF5LCBjYW1lbGl6ZSwgZ2V0T3B0IH0gZnJvbSAndXRpbCc7CgpsZXQgYnVmZmVycyA9IHt9LAogIG1vZHVsZXMgPSB7fTsKbGV0IFQsCiAgY29kZSA9ICdjJywKICBkZWJ1ZywKICB2ZXJib3NlLAogIHNvcnQsCiAgcGFyYW1zLAogIGNhc2VTZW5zaXRpdmUsCiAgcXVpZXQsCiAgZXhwLAogIHJlbGF0aXZlVG8sCiAgcHJpbnRGaWxlcywKICBvbmx5VXBwZXJjYXNlLAogIGZpbHRlciA9IG51bGwsCiAgbWF0Y2ggPSBuZXcgU2V0KCksCiAgaWRlbnRpZmllcnM7CgooJ3VzZSBzdHJpY3QnKTsKKCd1c2UgbWF0aCcpOwoKZXh0ZW5kQXJyYXkoQXJyYXkucHJvdG90eXBlKTsKCmNvbnN0IEFkZFVuaXF1ZSA9IChhcnIsIGl0ZW0pID0+IChhcnIuaW5kZXhPZihpdGVtKSA9PSAtMSA/IGFyci5wdXNoKGl0ZW0pIDogbnVsbCk7Cgpjb25zdCBJbnRUb0RXb3JkID0gaXZhbCA9PiAoaXNOYU4oaXZhbCkgPT09IGZhbHNlICYmIGl2YWwgPCAwID8gaXZhbCArIDQyOTQ5NjcyOTYgOiBpdmFsKTsKY29uc3QgSW50VG9CaW5hcnkgPSBpID0+IChpID09IC0xIHx8IHR5cGVvZiBpICE9ICdudW1iZXInID8gaSA6ICcwYicgKyBJbnRUb0RXb3JkKGkpLnRvU3RyaW5nKDIpKTsKCmNvbnN0IGJ1ZmZlclJlZiA9IG5ldyBXZWFrTWFwKCk7CgpmdW5jdGlvbiBCdWZmZXJGaWxlKGZpbGUpIHsKICAvL2NvbnNvbGUubG9nKCdCdWZmZXJGaWxlJywgZmlsZSk7CiAgaWYoYnVmZmVyc1tmaWxlXSkgcmV0dXJuIGJ1ZmZlcnNbZmlsZV07CiAgbGV0IGIgPSAoYnVmZmVyc1tmaWxlXSA9IGZzLnJlYWRGaWxlU3luYyhmaWxlLCB7IGZsYWc6ICdyJyB9KSk7CiAgLy9jb25zb2xlLmxvZygnYnVmZmVyUmVmJywgYnVmZmVyUmVmLCBidWZmZXJSZWYuc2V0LCBiKTsKICBpZih0eXBlb2YgYiA9PSAnb2JqZWN0JyAmJiBiICE9PSBudWxsKSBidWZmZXJSZWYuc2V0KGIsIGZpbGUpOwogIHJldHVybiBiOwp9CgpmdW5jdGlvbiBCdWZmZXJMZW5ndGhzKGZpbGUpIHsKICByZXR1cm4gYnVmZmVyc1tmaWxlXS5tYXAoYiA9PiBiLmJ5dGVMZW5ndGgpOwp9CgpmdW5jdGlvbiBCdWZmZXJPZmZzZXRzKGZpbGUpIHsKICByZXR1cm4gYnVmZmVyc1tmaWxlXS5yZWR1Y2UoKFtwb3MsIGxpc3RdLCBiKSA9PiBbcG9zICsgYi5ieXRlTGVuZ3RoLCBsaXN0LmNvbmNhdChbcG9zXSldLCBbMCwgW11dKVsxXTsKfQoKZnVuY3Rpb24gQnVmZmVyUmFuZ2VzKGZpbGUpIHsKICByZXR1cm4gYnVmZmVyc1tmaWxlXS5yZWR1Y2UoKFtwb3MsIGxpc3RdLCBiKSA9PiBbcG9zICsgYi5ieXRlTGVuZ3RoLCBsaXN0LmNvbmNhdChbW3BvcywgYi5ieXRlTGVuZ3RoXV0pXSwgWzAsIFtdXSlbMV07Cn0KCmZ1bmN0aW9uIFdyaXRlRmlsZShmaWxlLCB0b2spIHsKICBsZXQgZiA9IHN0ZC5vcGVuKGZpbGUsICd3KycpOwogIGYucHV0cyh0b2spOwogIGNvbnNvbGUubG9nKCdXcm90ZSAiJyArIGZpbGUgKyAnIjogJyArIHRvay5sZW5ndGggKyAnIGJ5dGVzJyk7Cn0KCmZ1bmN0aW9uIER1bXBMZXhlcihsZXgpIHsKICBjb25zdCB7IHNpemUsIHBvcywgc3RhcnQsIGxpbmUsIGNvbHVtbiwgbGluZVN0YXJ0LCBsaW5lRW5kLCBjb2x1bW5JbmRleCB9ID0gbGV4OwoKICByZXR1cm4gJ0xleGVyICcgKyBpbnNwZWN0KHsgc3RhcnQsIHBvcywgc2l6ZSB9KTsKfQoKZnVuY3Rpb24gRHVtcFRva2VuKHRvaykgewogIGNvbnN0IHsgbGVuZ3RoLCBvZmZzZXQsIGNoYXJzLCBsb2MgfSA9IHRvazsKCiAgcmV0dXJuIGDimIUgVG9rZW4gJHtpbnNwZWN0KHsgY2hhcnMsIG9mZnNldCwgbGVuZ3RoLCBsb2MgfSwgeyBkZXB0aDogMSB9KX1gOwp9Cgpjb25zdCBXaGF0ID0gewogIElNUE9SVDogMCwKICBFWFBPUlQ6IDEKfTsKCmNvbnN0IEltcG9ydFR5cGVzID0gewogIElNUE9SVDogMCwKICBJTVBPUlRfREVGQVVMVDogMSwKICBJTVBPUlRfTkFNRVNQQUNFOiAyCn07Cgpjb25zdCBUb2tJcyA9IGN1cnJ5KCh0eXBlLCBsZXhlbWUsIHRvaykgPT4gewogIGlmKGxleGVtZSAhPSB1bmRlZmluZWQpIHsKICAgIGlmKHR5cGVvZiBsZXhlbWUgPT0gJ3N0cmluZycgJiYgdG9rLmxleGVtZSAhPSBsZXhlbWUpIHJldHVybiBmYWxzZTsKICAgIGVsc2UgaWYoQXJyYXkuaXNBcnJheShsZXhlbWUpICYmIGxleGVtZS5pbmRleE9mKHRvay5sZXhlbWUpID09IC0xKSByZXR1cm4gZmFsc2U7CiAgfQogIGlmKHR5cGUgIT0gdW5kZWZpbmVkKSB7CiAgICBpZih0eXBlb2YgdHlwZSA9PSAnc3RyaW5nJyAmJiB0b2sudHlwZSAhPSB0eXBlKSByZXR1cm4gZmFsc2U7CiAgICBpZih0eXBlb2YgdHlwZSA9PSAnbnVtYmVyJyAmJiB0b2suaWQgIT0gdHlwZSkgcmV0dXJuIGZhbHNlOwogIH0KICByZXR1cm4gdHJ1ZTsKfSk7Cgpjb25zdCBJc0tleXdvcmQgPSBUb2tJcygna2V5d29yZCcpOwpjb25zdCBJc1B1bmN0dWF0b3IgPSBUb2tJcygncHVuY3R1YXRvcicpOwpjb25zdCBJc0lkZW50aWZpZXIgPSBUb2tJcygnaWRlbnRpZmllcicpOwpjb25zdCBJc1N0cmluZ0xpdGVyYWwgPSBUb2tJcygnc3RyaW5nTGl0ZXJhbCcpOwoKZnVuY3Rpb24gSW1wb3J0VHlwZShzZXEpIHsKICBpZihJc0tleXdvcmQoJ2ltcG9ydCcsIHNlcVswXSkpIHNlcS5zaGlmdCgpOwogIGlmKElzUHVuY3R1YXRvcignKicsIHNlcVswXSkpIHsKICAgIGlmKElzS2V5d29yZCgnYXMnLCBzZXFbMV0pKSByZXR1cm4gSW1wb3J0VHlwZXMuSU1QT1JUX05BTUVTUEFDRTsKICB9IGVsc2UgaWYoSXNJZGVudGlmaWVyKHVuZGVmaW5lZCwgc2VxWzBdKSkgewogICAgaWYoSXNLZXl3b3JkKCdmcm9tJywgc2VxWzFdKSkgcmV0dXJuIEltcG9ydFR5cGVzLklNUE9SVF9ERUZBVUxUOwogIH0KICByZXR1cm4gSW1wb3J0VHlwZXMuSU1QT1JUOwp9CgpmdW5jdGlvbiBJbXBvcnRGaWxlKHNlcSkgewogIGxldCBpZHggPSBzZXEuZmluZEluZGV4KHRvayA9PiBJc0tleXdvcmQoJ2Zyb20nLCB0b2spKTsKICB3aGlsZShzZXFbaWR4XSAmJiBzZXFbaWR4XS50eXBlICE9ICdzdHJpbmdMaXRlcmFsJykgKytpZHg7CiAgcmV0dXJuIHNlcVtpZHhdLmxleGVtZS5yZXBsYWNlKC9eW1wnXCJcYF0oLiopW1wnXCJcYF0kL2csICckMScpOwp9CgpmdW5jdGlvbiBFeHBvcnROYW1lKHNlcSkgewogIHNlcSA9IHNlcS5maWx0ZXIoKHsgdHlwZSB9KSA9PiB0eXBlICE9ICd3aGl0ZXNwYWNlJyk7CiAgbGV0IGlkeCA9IHNlcS5maW5kSW5kZXgodG9rID0+IElzSWRlbnRpZmllcih1bmRlZmluZWQsIHRvaykgfHwgSXNLZXl3b3JkKCdkZWZhdWx0JywgdG9rKSk7CiAgaWYoc2VxW2lkeCArIDFdICYmIElzS2V5d29yZCgnYXMnLCBzZXFbaWR4ICsgMV0pKSBpZHggKz0gMjsKICBsZXQgcmV0ID0gc2VxW2lkeF0/LmxleGVtZTsKICByZXR1cm4gcmV0Owp9CgpmdW5jdGlvbiBBZGRFeHBvcnQodG9rZW5zKSB7CiAgbGV0IGNvZGUgPSB0b2tlbnMubWFwKHRvayA9PiB0b2subGV4ZW1lKS5qb2luKCcnKTsKICB0b2tlbnMgPSB0b2tlbnMuZmlsdGVyKHRvayA9PiB0b2sudHlwZSAhPSAnd2hpdGVzcGFjZScpOwogIGxldCBsZW4gPSB0b2tlbnMuZmluZEluZGV4KHRvayA9PiBJc0lkZW50aWZpZXIodW5kZWZpbmVkLCB0b2spIHx8IElzS2V5d29yZCgnZGVmYXVsdCcsIHRvaykpICsgMTsKICB0b2tlbnMgPSB0b2tlbnMuc2xpY2UoMCwgbGVuKTsKICBsZXQgZXhwID0gZGVmaW5lKAogICAgewogICAgICB0eXBlOiB0b2tlbnNbMV0/LmxleGVtZSwKICAgICAgdG9rZW5zLAogICAgICBleHBvcnRlZDogRXhwb3J0TmFtZSh0b2tlbnMpLAogICAgICByYW5nZTogWyt0b2tlbnNbMF0/LmxvYywgK3Rva2Vucy5sYXN0Py5sb2NdCiAgICB9LAogICAgeyBjb2RlLCBsb2M6IHRva2Vuc1swXT8ubG9jIH0KICApOwogIHJldHVybiBleHA7Cn0KCmZ1bmN0aW9uIEFkZEltcG9ydCh0b2tlbnMpIHsKICAvL2NvbnNvbGUubG9nKCd0b2tlbnM6JywgdG9rZW5zKTsKICBsZXQgcmFuZ2UgPSBbK3Rva2Vuc1swXS5sb2MsICt0b2tlbnMubGFzdC5sb2NdLAogICAgY29kZSA9IHRva2Vucy5tYXAodG9rID0+IHRvay5sZXhlbWUpLmpvaW4oJycpOwogIHRva2VucyA9IHRva2Vucy5maWx0ZXIodG9rID0+IHRvay50eXBlICE9ICd3aGl0ZXNwYWNlJyk7CiAgbGV0IHR5cGUgPSBJbXBvcnRUeXBlKHRva2VucyksCiAgICBmaWxlID0gSW1wb3J0RmlsZSh0b2tlbnMpOwogIGNvbnN0IHsgbG9jLCBzZXEgfSA9IHRva2Vuc1swXTsKICBsZXQgaW1wID0gZGVmaW5lKHsgdHlwZSwgZmlsZSwgbG9jLCBzZXEsIHJhbmdlIH0sIHsgdG9rZW5zLCBjb2RlIH0pOwogIGltcC5sb2NhbCA9IHsKICAgIFtJbXBvcnRUeXBlcy5JTVBPUlRfTkFNRVNQQUNFXTogKCkgPT4gewogICAgICBsZXQgaWR4ID0gdG9rZW5zLmZpbmRJbmRleCh0b2sgPT4gSXNLZXl3b3JkKCdhcycsIHRvaykpOwogICAgICByZXR1cm4gdG9rZW5zW2lkeCArIDFdLmxleGVtZTsKICAgIH0sCiAgICBbSW1wb3J0VHlwZXMuSU1QT1JUX0RFRkFVTFRdOiAoKSA9PiB7CiAgICAgIGxldCBpZHggPSB0b2tlbnMuZmluZEluZGV4KHRvayA9PiBJc0tleXdvcmQoJ2ltcG9ydCcsIHRvaykpOwogICAgICByZXR1cm4gdG9rZW5zW2lkeCArIDFdLmxleGVtZTsKICAgIH0sCiAgICBbSW1wb3J0VHlwZXMuSU1QT1JUXTogKCkgPT4gewogICAgICBsZXQgaWR4ID0gMCwKICAgICAgICBzcGVjaWZpZXIgPSBbXSwKICAgICAgICBzcGVjaWZpZXJzID0gW107CiAgICAgIGlmKElzS2V5d29yZCgnaW1wb3J0JywgdG9rZW5zW2lkeF0pKSArK2lkeDsKICAgICAgaWYoSXNQdW5jdHVhdG9yKCd7JywgdG9rZW5zW2lkeF0pKSArK2lkeDsKICAgICAgZm9yKDsgIUlzS2V5d29yZCgnZnJvbScsIHRva2Vuc1tpZHhdKTsgKytpZHgpIHsKICAgICAgICBpZihJc1B1bmN0dWF0b3IoWycsJywgJ30nXSwgdG9rZW5zW2lkeF0pKSB7CiAgICAgICAgICBpZihzcGVjaWZpZXIubGVuZ3RoKSBzcGVjaWZpZXJzLnB1c2goc3BlY2lmaWVyKTsKICAgICAgICAgIHNwZWNpZmllciA9IFtdOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzcGVjaWZpZXIucHVzaCh0b2tlbnNbaWR4XS5sZXhlbWUpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gc3BlY2lmaWVyczsKICAgIH0KICB9W3R5cGVdKCk7CgogIHJldHVybiBpbXA7Cn0KCmZ1bmN0aW9uIFByaW50RVM2SW1wb3J0KGltcCkgewogIHJldHVybiB7CiAgICBbSW1wb3J0VHlwZXMuSU1QT1JUX05BTUVTUEFDRV06ICh7IGxvY2FsLCBmaWxlIH0pID0+IGBpbXBvcnQgKiBhcyAke2xvY2FsfSBmcm9tICcke2ZpbGV9JztgLAogICAgW0ltcG9ydFR5cGVzLklNUE9SVF9ERUZBVUxUXTogKHsgbG9jYWwsIGZpbGUgfSkgPT4gYGltcG9ydCAke2xvY2FsfSBmcm9tICcke2ZpbGV9JztgLAogICAgW0ltcG9ydFR5cGVzLklNUE9SVF06ICh7IGxvY2FsLCBmaWxlIH0pID0+IGBpbXBvcnQgeyAke2xvY2FsLmpvaW4oJywgJyl9IH0gZnJvbSAnJHtmaWxlfSc7YAogIH1baW1wLnR5cGVdKGltcCk7Cn0KCmZ1bmN0aW9uIFByaW50Q0pTSW1wb3J0KHsgdHlwZSwgbG9jYWwsIGZpbGUgfSkgewogIHJldHVybiB7CiAgICBbSW1wb3J0VHlwZXMuSU1QT1JUX05BTUVTUEFDRV06ICgpID0+IGBjb25zdCAke2xvY2FsfSA9IHJlcXVpcmUoJyR7ZmlsZX0nKTtgLAogICAgW0ltcG9ydFR5cGVzLklNUE9SVF9ERUZBVUxUXTogKCkgPT4gYGNvbnN0ICR7bG9jYWx9ID0gcmVxdWlyZSgnJHtmaWxlfScpO2AsCiAgICBbSW1wb3J0VHlwZXMuSU1QT1JUXTogKCkgPT4gYGNvbnN0IHsgJHtsb2NhbC5qb2luKCcsICcpfSB9ID0gcmVxdWlyZSgnJHtmaWxlfScpO2AKICB9W3R5cGVdKCk7Cn0KCmZ1bmN0aW9uKiBHZXRUb2tlbnMoZmlsZSwgcHJlZCA9ICh7IHR5cGUgfSkgPT4gdHlwZSA9PSAnaWRlbnRpZmllcicpIHsKICBjb25zb2xlLmxvZygnZmlsZScsIGZpbGUpOwoKICBsZXQgc3RyID0gQnVmZmVyRmlsZShmaWxlKTsKICBsZXQgdG9rLAogICAgbGV4ID0gbmV3IEVDTUFTY3JpcHRMZXhlcihzdHIsIGZpbGUpOwoKICB3aGlsZSgodG9rID0gbGV4Lm5leHQoKSkpIHsKICAgIGNvbnN0IHsgdG9rZW4gfSA9IGxleDsKCiAgICBpZihwcmVkKHRva2VuKSkgeWllbGQgdG9rZW47CiAgfQp9CgpmdW5jdGlvbiogVHJhbnNmb3JtTGV4ZW1lKGdlbikgewogIGZvcihsZXQgdG9rZW4gb2YgZ2VuKSB5aWVsZCB0b2tlbi5sZXhlbWU7Cn0KCmZ1bmN0aW9uKiBHZXRDb21tYW5kcyhmaWxlKSB7CiAgbGV0IGxleCA9IEdldFRva2VucyhmaWxlLCAoeyB0eXBlIH0pID0+IHR5cGUgIT0gJ3doaXRlc3BhY2UnKTsKICBsZXQgYSA9IFtdOwogIGZvcihsZXQgdG9rIG9mIGxleCkgewogICAgYS5wdXNoKHRvayk7CgogICAgaWYodG9rLnR5cGUgPT0gJ3B1bmN0dWF0b3InICYmIHRvay5sZXhlbWUgPT0gJzsnKSB7CiAgICAgIHlpZWxkIGE7CiAgICAgIGEgPSBbXTsKICAgIH0KICB9Cn0KCmZ1bmN0aW9uIExpc3RFeHBvcnRzKGZpbGUsIG91dHB1dCkgewogIGlmKHByaW50RmlsZXMpIHN0ZC5vdXQucHV0cyhgJHtmaWxlfVxuYCk7CgogIGNvbnN0IGxvZyA9IHF1aWV0ID8gKCkgPT4ge30gOiAoLi4uYXJncykgPT4gY29uc29sZS5sb2coYCR7ZmlsZX06YCwgLi4uYXJncyk7CgogIGxldCBzdHIgPSBmaWxlID8gQnVmZmVyRmlsZShmaWxlKSA6IGNvZGVbMV0sCiAgICBsZW4gPSBzdHIubGVuZ3RoLAogICAgdHlwZSA9IHBhdGguZXh0bmFtZShmaWxlKS5zdWJzdHJpbmcoMSksCiAgICBiYXNlID0gY2FtZWxpemUocGF0aC5iYXNlbmFtZShmaWxlLCAnLicgKyB0eXBlKS5yZXBsYWNlKC9bXjAtOUEtWmEtel9dL2csICdfJykpOwoKICBsZXQgbGV4ID0gewogICAganM6IG5ldyBFQ01BU2NyaXB0TGV4ZXIoc3RyLCBmaWxlKQogIH07CgogIGNvbnN0IGxleGVyID0gbGV4W3R5cGVdOwoKICBUID0gbGV4ZXIudG9rZW5zLnJlZHVjZSgoYWNjLCBuYW1lLCBpZCkgPT4gKHsgLi4uYWNjLCBbbmFtZV06IGlkIH0pLCB7fSk7CgogIGxldCBlID0gbmV3IFN5bnRheEVycm9yKCk7CgogIGxleGVyLmhhbmRsZXIgPSBsZXggPT4gewogICAgY29uc3QgeyBsb2MsIG1vZGUsIHBvcywgc3RhcnQsIGJ5dGVMZW5ndGgsIHN0YXRlIH0gPSBsZXg7CiAgICBsb2coJyAnLnJlcGVhdChsb2MuY29sdW1uIC0gMSkgKyAnXicpOwogIH07CiAgbGV0IHRva2VuTGlzdCA9IFtdLAogICAgZGVjbGFyYXRpb25zID0gW107CiAgY29uc3QgY29sU2l6ZXMgPSBbMTIsIDgsIDQsIDIwLCAzMiwgMTAsIDBdOwogIGNvbnN0IHByaW50VG9rID0KICAgIGRlYnVnID4gMgogICAgICA/ICh0b2ssIHByZWZpeCkgPT4gewogICAgICAgICAgY29uc3QgcmFuZ2UgPSB0b2suY2hhclJhbmdlOwogICAgICAgICAgY29uc3QgY29scyA9IFtwcmVmaXgsIGB0b2tbJHt0b2suYnl0ZUxlbmd0aH1dYCwgdG9rLmlkLCB0b2sudHlwZSwgdG9rLmxleGVtZSwgdG9rLmxleGVtZS5sZW5ndGgsIHRvay5sb2NdOwogICAgICAgICAgc3RkLmVyci5wdXRzKAogICAgICAgICAgICBjb2xzLnJlZHVjZSgoYWNjLCBjb2wsIGkpID0+IGFjYyArIChjb2wgKyAnJykucmVwbGFjZUFsbCgnXG4nLCAnXFxuJykucGFkRW5kKGNvbFNpemVzW2ldKSwgJycpICsgJ1xuJwogICAgICAgICAgKTsKICAgICAgICB9CiAgICAgIDogKCkgPT4ge307CgogIGxldCB0b2ssCiAgICBpID0gMCwKICAgIG1hc2sgPSBJbnRUb0JpbmFyeShsZXhlci5tYXNrKSwKICAgIHN0YXRlID0gbGV4ZXIudG9wU3RhdGUoKTsKICBsZXhlci5iZWdpbkNvZGUgPSAoKSA9PiAoY29kZSA9PSAnanMnID8gMGIxMDAwIDogMGIwMTAwKTsKICBsZXQgdG9rZW5zID0gW10sCiAgICBzdGFydCA9IERhdGUubm93KCk7CiAgY29uc3QgYmFsYW5jZXIgPSAoKSA9PiB7CiAgICBsZXQgc2VsZjsKICAgIGxldCBzdGFjayA9IFtdOwogICAgY29uc3QgdGFibGUgPSB7ICd9JzogJ3snLCAnXSc6ICdbJywgJyknOiAnKCcgfTsKICAgIHNlbGYgPSBmdW5jdGlvbiBQYXJlbnRoZXNlQmFsYW5jZXIodG9rKSB7CiAgICAgIHN3aXRjaCAodG9rPy5sZXhlbWUpIHsKICAgICAgICBjYXNlICd7JzoKICAgICAgICBjYXNlICdbJzoKICAgICAgICBjYXNlICcoJzogewogICAgICAgICAgc3RhY2sucHVzaCh0b2subGV4ZW1lKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBjYXNlICd9JzoKICAgICAgICBjYXNlICddJzoKICAgICAgICBjYXNlICcpJzogewogICAgICAgICAgaWYoc3RhY2subGFzdCAhPSB0YWJsZVt0b2subGV4ZW1lXSkKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGB0b3AgJyR7c3RhY2subGFzdH0nICE9ICcke3Rvay5sZXhlbWV9JyBbICR7c3RhY2subWFwKHMgPT4gYCcke3N9J2ApLmpvaW4oJywgJyl9IF1gKTsKCiAgICAgICAgICBzdGFjay5wb3AoKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICAgIE9iamVjdC5hc3NpZ24oc2VsZiwgewogICAgICBzdGFjaywKICAgICAgcmVzZXQoKSB7CiAgICAgICAgc3RhY2suY2xlYXIoKTsKICAgICAgfSwKICAgICAgLyogcHJldHRpZXItaWdub3JlICovIGdldCBkZXB0aCgpIHsKICAgICAgICByZXR1cm4gc3RhY2subGVuZ3RoOwogICAgICB9CiAgICB9KTsKCiAgICByZXR1cm4gc2VsZjsKICB9OwogIGxldCBiYWxhbmNlcnMgPSBbYmFsYW5jZXIoKV0sCiAgICBpbXBvcnRzID0gW10sCiAgICBleHBvcnRzID0gW10sCiAgICBpbXBleHAsCiAgICBjb25kLAogICAgaW1wID0gW10sCiAgICBzaG93VG9rZW4gPSB0b2sgPT4gewogICAgICBpZigKICAgICAgICAobGV4ZXIuY29uc3RydWN0b3IgIT0gRUNNQVNjcmlwdExleGVyICYmIHRvay50eXBlICE9ICd3aGl0ZXNwYWNlJykgfHwKICAgICAgICAvXigoaW18ZXgpcG9ydHxmcm9tfGFzKSQvLnRlc3QodG9rLmxleGVtZSkKICAgICAgKSB7CiAgICAgICAgbGV0IGEgPSBbLyooZmlsZSArICc6JyArIHRvay5sb2MpLnBhZEVuZChmaWxlLmxlbmd0aCsxMCksKi8gdG9rLnR5cGUucGFkRW5kKDIwLCAnICcpLCBlc2NhcGUodG9rLmxleGVtZSldOwogICAgICAgIHN0ZC5lcnIucHV0cyhhLmpvaW4oJycpICsgJ1xuJyk7CiAgICAgIH0KICAgIH07CgogIGZvcig7OykgewogICAgbGV0IHsgc3RhdGVEZXB0aCB9ID0gbGV4ZXI7CiAgICBsZXQgdmFsdWUgPSBsZXhlci5uZXh0KCk7CiAgICBsZXQgZG9uZSA9IHZhbHVlID09PSB1bmRlZmluZWQ7CgogICAgLy8gICAgY29uc29sZS5sb2coJ3ZhbHVlJyx7dmFsdWUsZG9uZX0pOwogICAgaWYoZG9uZSkgYnJlYWs7CiAgICBsZXQgbmV3U3RhdGUgPSBsZXhlci50b3BTdGF0ZSgpOwogICAgLy9zaG93VG9rZW4odG9rKTsKICAgIGlmKG5ld1N0YXRlICE9IHN0YXRlKSB7CiAgICAgIGlmKHN0YXRlID09ICdURU1QTEFURScgJiYgbGV4ZXIuc3RhdGVEZXB0aCA+IHN0YXRlRGVwdGgpIGJhbGFuY2Vycy5wdXNoKGJhbGFuY2VyKCkpOwogICAgICBpZihuZXdTdGF0ZSA9PSAnVEVNUExBVEUnICYmIGxleGVyLnN0YXRlRGVwdGggPCBzdGF0ZURlcHRoKSBiYWxhbmNlcnMucG9wKCk7CiAgICB9CiAgICBsZXQgbiA9IGJhbGFuY2Vycy5sYXN0LmRlcHRoOwogICAgdG9rID0gbGV4ZXIudG9rZW47CgogICAgaWYodG9rID09IG51bGwpIGJyZWFrOwoKICAgIGlmKG4gPT0gMCAmJiB0b2subGV4ZW1lID09ICd9JyAmJiBsZXhlci5zdGF0ZURlcHRoID4gMCkgewogICAgICBsZXhlci5wb3BTdGF0ZSgpOwogICAgfSBlbHNlIHsKICAgICAgYmFsYW5jZXIodG9rKTsKICAgICAgaWYobiA+IDAgJiYgYmFsYW5jZXJzLmxhc3QuZGVwdGggPT0gMCkgbG9nKCdiYWxhbmNlcicpOwogICAgICBpZihbJ2ltcG9ydCcsICdleHBvcnQnXS5pbmRleE9mKHRvay5sZXhlbWUpID49IDApIHsKICAgICAgICBpbXBleHAgPSBXaGF0W3Rvay5sZXhlbWUudG9VcHBlckNhc2UoKV07CiAgICAgICAgbGV0IHByZXYgPSB0b2tlbnNbdG9rZW5zLmxlbmd0aCAtIDFdOwogICAgICAgIGNvbmQgPSB0cnVlOwogICAgICAgIGltcCA9IFtdOwogICAgICB9CiAgICAgIGlmKGNvbmQgPT0gdHJ1ZSkgewogICAgICAgIGltcC5wdXNoKHRvayk7CiAgICAgICAgaWYoWyc7JywgJ1xuJ10uaW5kZXhPZih0b2subGV4ZW1lKSAhPSAtMSkgewogICAgICAgICAgY29uZCA9IGZhbHNlOwogICAgICAgICAgaWYoaW1wLnNvbWUoaSA9PiBpLmxleGVtZSA9PSAnZnJvbScpKSB7CiAgICAgICAgICAgIGlmKGltcGV4cCA9PSBXaGF0LklNUE9SVCkgaW1wb3J0cy5wdXNoKEFkZEltcG9ydChpbXApKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZihpbXBleHAgPT0gV2hhdC5FWFBPUlQpIGV4cG9ydHMucHVzaChBZGRFeHBvcnQoaW1wKSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHByaW50VG9rKHRvaywgbmV3U3RhdGUpOwogICAgICB0b2tlbnMucHVzaCh0b2spOwogICAgfQogICAgc3RhdGUgPSBuZXdTdGF0ZTsKICB9CgogIGNvbnN0IGV4cG9ydFRva2VucyA9IHRva2Vucy5yZWR1Y2UoKGFjYywgdG9rLCBpKSA9PiAodG9rLmxleGVtZSA9PSAnZXhwb3J0JyA/IGFjYy5jb25jYXQoW2ldKSA6IGFjYyksIFtdKTsKICAvL2xvZygnRXhwb3J0IHRva2VucycsIHRva2Vucy5tYXAodCA9PiB0LmxleGVtZSkpOwoKICBsZXQgZXhwb3J0TmFtZXMgPSBleHBvcnRUb2tlbnMubWFwKGluZGV4ID0+IEV4cG9ydE5hbWUodG9rZW5zLnNsaWNlKGluZGV4KSkpOwogIC8vbG9nKCdFeHBvcnQgbmFtZXMnLCBleHBvcnROYW1lcyk7CgogIC8qbG9nKCdFUzYgaW1wb3J0cycsIGltcG9ydHMubWFwKFByaW50RVM2SW1wb3J0KSk7CiAgICBsb2coJ0NKUyBpbXBvcnRzJywgaW1wb3J0cy5tYXAoUHJpbnRDSlNJbXBvcnQpKTsqLwogIGxldCBjb21wYXJlID0gKGEsIGIpID0+ICgnJyArIGEpLmxvY2FsZUNvbXBhcmUoJycgKyBiKTsKCiAgaWYoIWNhc2VTZW5zaXRpdmUpIHsKICAgIGxldCBmbiA9IGNvbXBhcmU7CiAgICBjb21wYXJlID0gKGEsIGIpID0+CiAgICAgIGZuLmFwcGx5KAogICAgICAgIG51bGwsCiAgICAgICAgW2EsIGJdLm1hcChzID0+ICgnJyArIHMpLnRvTG93ZXJDYXNlKCkpCiAgICAgICk7CiAgfQoKICBpZihzb3J0KSBleHBvcnROYW1lcy5zb3J0KGNvbXBhcmUpOwogIGlmKHBhcmFtcy5leGNsdWRlKSB7CiAgICBsZXQgcmUgPSBuZXcgUmVnRXhwKHBhcmFtcy5leGNsdWRlLCAnZycpOwogICAgZXhwb3J0TmFtZXMgPSBleHBvcnROYW1lcy5maWx0ZXIobiA9PiAhcmUudGVzdChuKSk7CiAgfQogIGlmKHBhcmFtcy5pbmNsdWRlKSB7CiAgICBsb2coJ3BhcmFtcy5pbmNsdWRlJywgcGFyYW1zLmluY2x1ZGUpOwogICAgbGV0IHJlID0gbmV3IFJlZ0V4cChwYXJhbXMuaW5jbHVkZSwgJ2cnKTsKICAgIGV4cG9ydE5hbWVzID0gZXhwb3J0TmFtZXMuZmlsdGVyKG4gPT4gcmUudGVzdChuKSk7CiAgfQoKICBpZihvbmx5VXBwZXJjYXNlKSBleHBvcnROYW1lcyA9IGV4cG9ydE5hbWVzLmZpbHRlcihuYW1lID0+IC9eW0EtWl0vLnRlc3QobmFtZSkpOwoKICBsZXQgaWR4OwogIGlmKChpZHggPSBleHBvcnROYW1lcy5pbmRleE9mKGJhc2UpKSAhPSAtMSAmJiBleHBvcnROYW1lcy5pbmRleE9mKCdkZWZhdWx0JykgIT0gLTEpIHsKICAgIGV4cG9ydE5hbWVzLnNwbGljZShpZHgsIDEpOwogICAgbG9nKGBceDFiWzE7MzFtcmVtb3ZpbmcgJyR7YmFzZX0nXHgxYlswbWApOwogIH0KCiAgbGV0IHNvdXJjZSA9IGZpbGU7CgogIGlmKHJlbGF0aXZlVG8pIHsKICAgIGxldCByZWwgPSBwYXRoLnJlc29sdmUocmVsYXRpdmVUbyk7CiAgICBzb3VyY2UgPSBwYXRoLmFic29sdXRlKHNvdXJjZSk7CgogICAgaWYocGF0aC5leGlzdHMocmVsKSAmJiAhcGF0aC5pc0RpcmVjdG9yeShyZWwpKSByZWwgPSBwYXRoLmRpcm5hbWUocmVsKTsKCiAgICBsb2coJ1x4MWJbMTszM21yZWxhdGl2ZVRvXHgxYlswbScsIHsgcmVsLCBzb3VyY2UgfSk7CgogICAgc291cmNlID0gcGF0aC5yZWxhdGl2ZShzb3VyY2UsIHJlbCk7CiAgfQoKICBpZihwYXRoLmlzUmVsYXRpdmUoc291cmNlKSAmJiAhL14oXC58XC5cLilcLy8udGVzdChzb3VyY2UpKSBzb3VyY2UgPSAnLi8nICsgc291cmNlOwoKICBjb25zb2xlLmxvZygnZXhwb3J0TmFtZXMnLCBleHBvcnROYW1lcyk7CiAgaWYoZXhwb3J0TmFtZXMubGVuZ3RoKSB7CiAgICBsZXQgbmFtZXMgPSBleHBvcnROYW1lcy5tYXAodCA9PiAodCA9PSAnZGVmYXVsdCcgPyB0ICsgJyBhcyAnICsgYmFzZSA6IHQpKTsKICAgIGNvbnN0IGtleXdvcmQgPSBleHAgPyAnZXhwb3J0JyA6ICdpbXBvcnQnOwoKICAgIGlmKGZpbHRlcikgbmFtZXMgPSBuYW1lcy5maWx0ZXIoZmlsdGVyKTsKCiAgICBpZihpZGVudGlmaWVycykgewogICAgICBpZGVudGlmaWVycy5kZWxldGUoLi4ubmFtZXMpOwogICAgICBtYXRjaC5hZGQoLi4ubmFtZXMpOwogICAgfQoKICAgIGlmKHBhcmFtcy5yYXcpIG91dHB1dC5wdXRzKG5hbWVzLmpvaW4oJ1xuJykgKyAnXG4nKTsKICAgIGVsc2UgaWYobmFtZXMubGVuZ3RoID09IDEgJiYgL15kZWZhdWx0IGFzLy50ZXN0KG5hbWVzWzBdKSkgb3V0cHV0LnB1dHMoa2V5d29yZCArIGAgJHtiYXNlfSBmcm9tICcke3NvdXJjZX0nXG5gKTsKICAgIGVsc2UgaWYobmFtZXMubGVuZ3RoID4gMCkgb3V0cHV0LnB1dHMoa2V5d29yZCArIGAgeyAke25hbWVzLmpvaW4oJywgJyl9IH0gZnJvbSAnJHtzb3VyY2V9J1xuYCk7CiAgfQoKICBtb2R1bGVzW3NvdXJjZV0gPSB7IGltcG9ydHMsIGV4cG9ydHMgfTsKCiAgbGV0IGZpbGVJbXBvcnRzID0gaW1wb3J0cy5maWx0ZXIoaW1wID0+IC9cLmpzJC9pLnRlc3QoaW1wLnNvdXJjZSkpOwogIGxldCBzcGxpdFBvaW50cyA9IHVuaXF1ZShmaWxlSW1wb3J0cy5yZWR1Y2UoKGFjYywgaW1wKSA9PiBbLi4uYWNjLCAuLi5pbXAucmFuZ2VdLCBbXSkpOwogIGJ1ZmZlcnNbc291cmNlXSA9IFsuLi5zcGxpdChCdWZmZXJGaWxlKHNvdXJjZSksIC4uLnNwbGl0UG9pbnRzKV0ubWFwKGIgPT4gYiA/PyB0b1N0cmluZyhiLCAwLCBiLmJ5dGVMZW5ndGgpKTsKCiAgLy9sb2coJ2ZpbGVJbXBvcnRzJywgZmlsZUltcG9ydHMubWFwKGltcCA9PiBpbXAuc291cmNlKSk7CgogIGxldCBkaXIgPSBwYXRoLmRpcm5hbWUoc291cmNlKTsKCiAgZmlsZUltcG9ydHMuZm9yRWFjaChpbXAgPT4gewogICAgbGV0IHAgPSBwYXRoLmNvbGxhcHNlKHBhdGguam9pbihkaXIsIGltcC5maWxlKSk7CiAgICAvL2xvZygncCcsIHApOwoKICAgIEFkZFVuaXF1ZShmaWxlcywgcCk7CiAgfSk7CgogIGxldCBlbmQgPSBEYXRlLm5vdygpOwoKICBpZih2ZXJib3NlKSBsb2coYHRvb2sgJHtlbmQgLSBzdGFydH1tc2ApOwoKICBzdGQuZ2MoKTsKfQoKZnVuY3Rpb24gbWFpbiguLi5hcmdzKSB7CiAgZ2xvYmFsVGhpcy5jb25zb2xlID0gbmV3IENvbnNvbGUocHJvY2Vzcy5zdGRlcnIsIHsKICAgIGluc3BlY3RPcHRpb25zOiB7CiAgICAgIGNvbG9yczogdHJ1ZSwKICAgICAgZGVwdGg6IDgsCiAgICAgIGJyZWFrTGVuZ3RoOiAxNjAsCiAgICAgIG1heFN0cmluZ0xlbmd0aDogSW5maW5pdHksCiAgICAgIG1heEFycmF5TGVuZ3RoOiBJbmZpbml0eSwKICAgICAgY29tcGFjdDogMCwKICAgICAgc3RyaW5nQnJlYWtOZXdsaW5lOiBmYWxzZSwKICAgICAgaGlkZUtleXM6IFtTeW1ib2wudG9TdHJpbmdUYWcgLyosICdjb2RlJyovXQogICAgfQogIH0pOwoKICBsZXQgb3V0cHV0ID0gc3RkLm91dDsKICBsZXQgb3V0cHV0RmlsZTsKCiAgcGFyYW1zID0gZ2V0T3B0KAogICAgewogICAgICBoZWxwOiBbCiAgICAgICAgZmFsc2UsCiAgICAgICAgKF9fYSwgX194LCBwYXJhbXMpID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdoZWxwJywgeyBfX2EsIF9feCwgcGFyYW1zIH0pOwogICAgICAgICAgc3RkLnB1dHMoYFVzYWdlOiAke3NjcmlwdEFyZ3NbMF19IFtPUFRJT05TXSA8ZmlsZXMuLi4+XG5cbmApOwoKICAgICAgICAgIHN0ZC5wdXRzKAogICAgICAgICAgICBwYXJhbXMKICAgICAgICAgICAgICAubWFwKChbbmFtZSwgW2hhc0FyZywgLCBsZXR0ZXJdXSkgPT4gYCAgLSR7bGV0dGVyfSwgLS0ke25hbWV9ICR7KGhhc0FyZyA/ICc8QVJHPicgOiAnJykucGFkRW5kKDEwKX1cbmApCiAgICAgICAgICAgICAgLmpvaW4oJycpICsgJ1xuJwogICAgICAgICAgKTsKICAgICAgICAgIHN0ZC5leGl0KDApOwogICAgICAgIH0sCiAgICAgICAgJ2gnCiAgICAgIF0sCiAgICAgIGRlYnVnOiBbZmFsc2UsICgpID0+IChkZWJ1ZyA9IChkZWJ1ZyB8IDApICsgMSksICd4J10sCiAgICAgIHZlcmJvc2U6IFtmYWxzZSwgKCkgPT4gKHZlcmJvc2UgPSAodmVyYm9zZSB8IDApICsgMSksICd2J10sCiAgICAgIHNvcnQ6IFtmYWxzZSwgKCkgPT4gKHNvcnQgPSB0cnVlKSwgJ3MnXSwKICAgICAgaW5jbHVkZTogW3RydWUsIG51bGwsICdJJ10sCiAgICAgIGV4Y2x1ZGU6IFt0cnVlLCBudWxsLCAnWCddLAogICAgICAnY2FzZS1zZW5zaXRpdmUnOiBbZmFsc2UsICgpID0+IChjYXNlU2Vuc2l0aXZlID0gdHJ1ZSksICdjJ10sCiAgICAgIHJhdzogW2ZhbHNlLCBudWxsLCAnUiddLAogICAgICBxdWlldDogW2ZhbHNlLCAoKSA9PiAocXVpZXQgPSB0cnVlKSwgJ3EnXSwKICAgICAgZXhwb3J0OiBbZmFsc2UsICgpID0+IChleHAgPSB0cnVlKSwgJ2UnXSwKICAgICAgZm9yOiBbdHJ1ZSwgbnVsbCwgJ2YnXSwKICAgICAgJ3ByaW50LWZpbGVzJzogW2ZhbHNlLCAoKSA9PiAocHJpbnRGaWxlcyA9IHRydWUpLCAncCddLAogICAgICBvdXRwdXQ6IFt0cnVlLCBmaWxlbmFtZSA9PiAob3V0cHV0RmlsZSA9IGZpbGVuYW1lKSAvKiBvdXRwdXQgPSBzdGQub3BlbihmaWxlbmFtZSwgJ3crJykqLywgJ28nXSwKICAgICAgJ3JlbGF0aXZlLXRvJzogW3RydWUsIGFyZyA9PiAocmVsYXRpdmVUbyA9IHBhdGguYWJzb2x1dGUoYXJnKSksICdyJ10sCiAgICAgIHVwcGVyY2FzZTogW2ZhbHNlLCAoKSA9PiAob25seVVwcGVyY2FzZSA9IHRydWUpLCAndSddLAogICAgICAnQCc6ICdmaWxlcycKICAgIH0sCiAgICBhcmdzCiAgKTsKICBsZXQgZmlsZXMgPSBwYXJhbXNbJ0AnXTsKCiAgaWYob3V0cHV0RmlsZSkgb3V0cHV0ID0gc3RkLm9wZW4ob3V0cHV0RmlsZSwgJ3crJyk7CgogIGNvbnN0IFJlbGF0aXZlUGF0aCA9IGZpbGUgPT4gcGF0aC5qb2luKHBhdGguZGlybmFtZShwcm9jZXNzLmFyZ3ZbMV0pLCAnLi4nLCBmaWxlKTsKCiAgaWYoIWZpbGVzLmxlbmd0aCkgZmlsZXMucHVzaChSZWxhdGl2ZVBhdGgoJy4vbGliL3V0aWwuanMnKSk7CgogIGlmKHBhcmFtc1snZm9yJ10pIHsKICAgIGlkZW50aWZpZXJzID0gbmV3IFNldChUcmFuc2Zvcm1MZXhlbWUoR2V0VG9rZW5zKHBhcmFtc1snZm9yJ10pKSk7CiAgICBjb25zb2xlLmxvZygnaWRlbnRpZmllcnMnLCBpZGVudGlmaWVycyk7CgogICAgZmlsdGVyID0gKCgpID0+IHsKICAgICAgY29uc3QgcmUgPSBuZXcgUmVnRXhwKCdeKCcgKyBbLi4uaWRlbnRpZmllcnNdLmpvaW4oJ3wnKSArICcpJCcpOwoKICAgICAgcmV0dXJuIG5hbWUgPT4gcmUudGVzdChuYW1lKTsKICAgIH0pKCk7CiAgfQoKICBjb25zb2xlLmxvZygnZmlsZXMnLCBmaWxlcyk7CgogIGZvcihsZXQgZmlsZSBvZiBmaWxlcykgewogICAgaWYoMCkKICAgICAgaWYoIWZzLmV4aXN0c1N5bmMoZmlsZSkgfHwgL1wuc28kLy50ZXN0KGZpbGUpKSB7CiAgICAgICAgbGV0IG07CgogICAgICAgIHRyeSB7CiAgICAgICAgICBpZigobSA9IGxvYWRNb2R1bGUoZmlsZSkpKSB7CiAgICAgICAgICAgIGxldCBsaXN0ID0gZ2V0TW9kdWxlRXhwb3J0cyhtKTsKCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdFeHBvcnRzJywgbGlzdCk7CiAgICAgICAgICB9CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9IGNhdGNoKGUpIHt9CiAgICAgIH0KICAgIExpc3RFeHBvcnRzKGZpbGUsIG91dHB1dCk7CiAgfQoKICAvKiAgaWYoaWRlbnRpZmllcnMuc2l6ZSkgewogICAgc3RkLmVyci5wdXRzKGAke2lkZW50aWZpZXJzLnNpemV9IGlkZW50aWZpZXJzIGNvdWxkIG5vdCBiZSBtYXRjaGVkOlxuJHtbLi4uaWRlbnRpZmllcnNdLmpvaW4oJ1xuJyl9XG5gKTsKICB9Ki8KfQoKdHJ5IHsKICBtYWluKC4uLnNjcmlwdEFyZ3Muc2xpY2UoMSkpOwp9IGNhdGNoKGVycm9yKSB7CiAgY29uc29sZS5sb2coYEZBSUw6ICR7ZXJyb3IubWVzc2FnZX1cbiR7ZXJyb3Iuc3RhY2t9YCk7CiAgc3RkLmV4aXQoMSk7Cn0KAAAAAAAAAABVPwAAAAAAAAAAAAAAAAAAAAAAAFU/AAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABWPwAAAAAAAFY/AAAAAAAAAAAAAAAA8L8"
				]
			]
		},
		{
			"file": "lib/misc.js",
			"settings":
			{
				"buffer_size": 47966,
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					13,
					1,
					"revert",
					null,
					"AgAAAAAAAAAAAAAAAAAAAAAAAAAJvAAALy9pbXBvcnQgVXRpbCBmcm9tICcuL3V0aWwuanMnOwovL2V4cG9ydCB7IHR5cGVzIH0gZnJvbSAgJy4uL3F1aWNranMvcWpzLW1vZHVsZXMvbGliL3V0aWwuanMnOwoKY29uc3Qgc2xpY2UgPSAoeCwgcywgZSkgPT4KICB0eXBlb2YgeCA9PSAnb2JqZWN0JwogICAgPyBpc0FycmF5QnVmZmVyKHgpCiAgICAgID8gZHVwQXJyYXlCdWZmZXIoeCwgcywgZSkKICAgICAgOiBBcnJheS5pc0FycmF5KHgpCiAgICAgID8gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoeCwgcywgZSkKICAgICAgOiB4LnNsaWNlKHMsIGUpCiAgICA6IFN0cmluZy5wcm90b3R5cGUuc2xpY2UuY2FsbCh4LCBzLCBlKTsKY29uc3Qgc3RyaW5naWZ5ID0gdiA9PiBgJHt2fWA7CmNvbnN0IHByb3RvT2YgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Y7CmNvbnN0IGZvcm1hdE51bWJlciA9IG4gPT4gKG4gPT09IC0wID8gJy0wJyA6IGAke259YCk7CmNvbnN0IGlzTmF0aXZlID0gZm4gPT4gL1xbbmF0aXZlXHNjb2RlXF0vLnRlc3Qoc3RyaW5naWZ5KGZuKSk7CgovKmV4cG9ydCBkZWZhdWx0Ki8gZnVuY3Rpb24gdXRpbCgpIHsKICByZXR1cm4gdXRpbDsKfQoKdXRpbC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSB1dGlsOwoKY29uc3QgQXN5bmNGdW5jdGlvbiA9IGFzeW5jIGZ1bmN0aW9uIHgoKSB7fS5jb25zdHJ1Y3RvcjsKY29uc3QgR2VuZXJhdG9yRnVuY3Rpb24gPSBmdW5jdGlvbiogKCkge30uY29uc3RydWN0b3I7CmNvbnN0IEFzeW5jR2VuZXJhdG9yRnVuY3Rpb24gPSBhc3luYyBmdW5jdGlvbiogKCkge30uY29uc3RydWN0b3I7CmNvbnN0IFR5cGVkQXJyYXkgPSBwcm90b09mKHByb3RvT2YobmV3IFVpbnQxNkFycmF5KDEwKSkpLmNvbnN0cnVjdG9yOwoKY29uc3QgU2V0SXRlcmF0b3JQcm90b3R5cGUgPSBwcm90b09mKG5ldyBTZXQoKS52YWx1ZXMoKSk7CmNvbnN0IE1hcEl0ZXJhdG9yUHJvdG90eXBlID0gcHJvdG9PZihuZXcgTWFwKCkuZW50cmllcygpKTsKLy9jb25zdCBHZW5lcmF0b3JQcm90b3R5cGUgPSBwcm90b09mKChmdW5jdGlvbiogKCkge30pKCkpOwoKLy8gcHJldHRpZXItaWdub3JlCmV4cG9ydCBjb25zdCBlcnJvcnMgPSBbbnVsbCwgJ0VQRVJNJywgJ0VOT0VOVCcsICdFU1JDSCcsICdFSU5UUicsICdFSU8nLCAnRU5YSU8nLCAnRTJCSUcnLCAnRU5PRVhFQycsICdFQkFERicsICdFQ0hJTEQnLCAnRUFHQUlOJywgJ0VOT01FTScsICdFQUNDRVMnLCAnRUZBVUxUJywgJ0VOT1RCTEsnLCAnRUJVU1knLCAnRUVYSVNUJywgJ0VYREVWJywgJ0VOT0RFVicsICdFTk9URElSJywgJ0VJU0RJUicsICdFSU5WQUwnLCAnRU5GSUxFJywgJ0VNRklMRScsICdFTk9UVFknLCAnRVRYVEJTWScsICdFRkJJRycsICdFTk9TUEMnLCAnRVNQSVBFJywgJ0VST0ZTJywgJ0VNTElOSycsICdFUElQRScsICdFRE9NJywgJ0VSQU5HRScsICdFREVBRExLJywgJ0VOQU1FVE9PTE9ORycsICdFTk9MQ0snLCAnRU5PU1lTJywgJ0VOT1RFTVBUWScsIG51bGwsIG51bGwsICdFTk9NU0cnLCAnRUlEUk0nLCAnRUNIUk5HJywgJ0VMMk5TWU5DJywgJ0VMM0hMVCcsICdFTDNSU1QnLCAnRUxOUk5HJywgJ0VVTkFUQ0gnLCAnRU5PQ1NJJywgJ0VMMkhMVCcsICdFQkFERScsICdFQkFEUicsICdFWEZVTEwnLCAnRU5PQU5PJywgJ0VCQURSUUMnLCBudWxsLCAnJywgJ0VCRk9OVCcsICdFTk9TVFInLCAnRU5PREFUQScsICdFVElNRScsICdFTk9TUicsICdFTk9ORVQnLCAnRU5PUEtHJywgJ0VSRU1PVEUnLCAnRU5PTElOSycsICdFQURWJywgJ0VTUk1OVCcsICdFQ09NTScsICdFUFJPVE8nLCAnRU1VTFRJSE9QJywgJ0VET1RET1QnLCAnRUJBRE1TRycsICdFT1ZFUkZMT1cnLCAnRU5PVFVOSVEnLCAnRUJBREZEJywgJ0VSRU1DSEcnLCAnRUxJQkFDQycsICdFTElCQkFEJywgJ0VMSUJTQ04nLCAnRUxJQk1BWCcsICdFTElCRVhFQycsICdFSUxTRVEnLCAnRVJFU1RBUlQnLCAnRVNUUlBJUEUnLCAnRVVTRVJTJywgJ0VOT1RTT0NLJywgJ0VERVNUQUREUlJFUScsICdFTVNHU0laRScsICdFUFJPVE9UWVBFJywgJ0VOT1BST1RPT1BUJywgJ0VQUk9UT05PU1VQUE9SVCcsICdFU09DS1ROT1NVUFBPUlQnLCAnRU9QTk9UU1VQUCcsICdFUEZOT1NVUFBPUlQnLCAnRUFGTk9TVVBQT1JUJywgJ0VBRERSSU5VU0UnLCAnRUFERFJOT1RBVkFJTCcsICdFTkVURE9XTicsICdFTkVUVU5SRUFDSCcsICdFTkVUUkVTRVQnLCAnRUNPTk5BQk9SVEVEJywgJ0VDT05OUkVTRVQnLCAnRU5PQlVGUycsICdFSVNDT05OJywgJ0VOT1RDT05OJywgJ0VTSFVURE9XTicsICdFVE9PTUFOWVJFRlMnLCAnRVRJTUVET1VUJywgJ0VDT05OUkVGVVNFRCcsICdFSE9TVERPV04nLCAnRUhPU1RVTlJFQUNIJywgJ0VBTFJFQURZJywgJ0VJTlBST0dSRVNTJywgJ0VTVEFMRScsICdFVUNMRUFOJywgJ0VOT1ROQU0nLCAnRU5BVkFJTCcsICdFSVNOQU0nLCAnRVJFTU9URUlPJywgJ0VEUVVPVCcsICdFTk9NRURJVU0nLCAnRU1FRElVTVRZUEUnLCAnRUNBTkNFTEVEJywgJ0VOT0tFWScsICdFS0VZRVhQSVJFRCcsICdFS0VZUkVWT0tFRCcsICdFS0VZUkVKRUNURUQnLCAnRU9XTkVSREVBRCcsICdFTk9UUkVDT1ZFUkFCTEUnLCAnRVJGS0lMTCddOwoKZXhwb3J0IGNvbnN0IHR5cGVzID0gewogIGlzQW55QXJyYXlCdWZmZXIodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmICh2IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIgfHwgdiBpbnN0YW5jZW9mIFNoYXJlZEFycmF5QnVmZmVyKTsKICB9LAogIGlzQXJyYXlCdWZmZXIodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcjsKICB9LAogIGlzQmlnSW50NjRBcnJheSh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIEJpZ0ludDY0QXJyYXk7CiAgfSwKICBpc0JpZ1VpbnQ2NEFycmF5KHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgQmlnVWludDY0QXJyYXk7CiAgfSwKICBpc0RhdGUodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBEYXRlOwogIH0sCiAgaXNGbG9hdDMyQXJyYXkodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXk7CiAgfSwKICBpc0Zsb2F0NjRBcnJheSh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIEZsb2F0NjRBcnJheTsKICB9LAogIGlzSW50OEFycmF5KHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgSW50OEFycmF5OwogIH0sCiAgaXNJbnQxNkFycmF5KHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgSW50MTZBcnJheTsKICB9LAogIGlzSW50MzJBcnJheSh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIEludDMyQXJyYXk7CiAgfSwKICBpc01hcCh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIE1hcDsKICB9LAogIGlzUHJvbWlzZSh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIFByb21pc2U7CiAgfSwKICBpc1Byb3h5KHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgUHJveHk7CiAgfSwKICBpc1JlZ0V4cCh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIFJlZ0V4cDsKICB9LAogIGlzU2V0KHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgU2V0OwogIH0sCiAgaXNTaGFyZWRBcnJheUJ1ZmZlcih2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIFNoYXJlZEFycmF5QnVmZmVyOwogIH0sCiAgaXNVaW50OEFycmF5KHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgVWludDhBcnJheTsKICB9LAogIGlzVWludDhDbGFtcGVkQXJyYXkodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBVaW50OENsYW1wZWRBcnJheTsKICB9LAogIGlzVWludDE2QXJyYXkodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBVaW50MTZBcnJheTsKICB9LAogIGlzVWludDMyQXJyYXkodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBVaW50MzJBcnJheTsKICB9LAogIGlzV2Vha01hcCh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIFdlYWtNYXA7CiAgfSwKICBpc1dlYWtTZXQodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBXZWFrU2V0OwogIH0sCiAgaXNEYXRhVmlldyh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIERhdGFWaWV3OwogIH0sCiAgaXNCb29sZWFuT2JqZWN0KHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgQm9vbGVhbjsKICB9LAogIGlzQXN5bmNGdW5jdGlvbih2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIEFzeW5jRnVuY3Rpb247CiAgfSwKICBpc0dlbmVyYXRvckZ1bmN0aW9uKHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgR2VuZXJhdG9yRnVuY3Rpb247CiAgfSwKICBpc0FzeW5jR2VuZXJhdG9yRnVuY3Rpb24odikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBBc3luY0dlbmVyYXRvckZ1bmN0aW9uOwogIH0sCiAgaXNOdW1iZXJPYmplY3QodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBOdW1iZXI7CiAgfSwKICBpc0JpZ0ludE9iamVjdCh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIEJpZ0ludDsKICB9LAogIGlzU3ltYm9sT2JqZWN0KHYpIHsKICAgIHJldHVybiB2ICYmIHYgaW5zdGFuY2VvZiBTeW1ib2w7CiAgfSwKICBpc05hdGl2ZUVycm9yKHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgRXJyb3IgJiYgaXNOYXRpdmUodi5jb25zdHJ1Y3Rvcik7CiAgfSwKICBpc01hcEl0ZXJhdG9yKHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiBwcm90b09mKHYpID09IE1hcEl0ZXJhdG9yUHJvdG90eXBlOwogIH0sCiAgaXNTZXRJdGVyYXRvcih2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgcHJvdG9PZih2KSA9PSBTZXRJdGVyYXRvclByb3RvdHlwZTsKICB9LAogIGlzU3RyaW5nT2JqZWN0KHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgU3RyaW5nOwogIH0sCiAgaXNBcnJheUJ1ZmZlclZpZXcodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIEFycmF5QnVmZmVyLmlzVmlldyh2KTsKICB9LAogIGlzQXJndW1lbnRzT2JqZWN0KHYpIHsKICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodikgPT0gJ1tvYmplY3QgQXJndW1lbnRzXSc7CiAgfSwKCiAgLyogaXNFeHRlcm5hbCh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIEV4dGVybmFsOwogIH0sKi8KCiAgaXNCb3hlZFByaW1pdGl2ZSh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgW051bWJlciwgU3RyaW5nLCBCb29sZWFuLCBCaWdJbnQsIFN5bWJvbF0uc29tZShjdG9yID0+IHYgaW5zdGFuY2VvZiBjdG9yKTsKICB9LAoKICBpc0dlbmVyYXRvck9iamVjdCh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgcHJvdG9PZih2KSA9PSBHZW5lcmF0b3JQcm90b3R5cGU7CiAgfSwKICBpc1R5cGVkQXJyYXkodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBUeXBlZEFycmF5OwogIH0sCiAgaXNNb2R1bGVOYW1lc3BhY2VPYmplY3QodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHZbU3ltYm9sLnRvU3RyaW5nVGFnXSA9PSAnTW9kdWxlJzsKICB9Cn07CgpleHBvcnQgZnVuY3Rpb24gaXNPYmplY3QoYXJnKSB7CiAgcmV0dXJuIHR5cGVvZiBhcmcgPT0gJ29iamVjdCcgJiYgYXJnICE9PSBudWxsOwp9Cgpjb25zdCBVVEY4Rmlyc3RDb2RlTWFzayA9IFsweDFmLCAweGYsIDB4NywgMHgzLCAweDFdOwpjb25zdCBVVEY4TWluQ29kZSA9IFsweDgwLCAweDgwMCwgMHgxMDAwMCwgMHgwMDIwMDAwMCwgMHgwNDAwMDAwMF07CgovKiBwcmV0dGllci1pZ25vcmUgKi8gY29uc3QgZXJyb3JTeW1ib2xzID0gWyAwLCAnRVBFUk0nLCAnRU5PRU5UJywgJ0VTUkNIJywgJ0VJTlRSJywgJ0VJTycsICdFTlhJTycsICdFMkJJRycsICdFTk9FWEVDJywgJ0VCQURGJywgJ0VDSElMRCcsICdFQUdBSU4nLCAnRU5PTUVNJywgJ0VBQ0NFUycsICdFRkFVTFQnLCAnRU5PVEJMSycsICdFQlVTWScsICdFRVhJU1QnLCAnRVhERVYnLCAnRU5PREVWJywgJ0VOT1RESVInLCAnRUlTRElSJywgJ0VJTlZBTCcsICdFTkZJTEUnLCAnRU1GSUxFJywgJ0VOT1RUWScsICdFVFhUQlNZJywgJ0VGQklHJywgJ0VOT1NQQycsICdFU1BJUEUnLCAnRVJPRlMnLCAnRU1MSU5LJywgJ0VQSVBFJywgJ0VET00nLCAnRVJBTkdFJywgJ0VERUFETEsnLCAnRU5BTUVUT09MT05HJywgJ0VOT0xDSycsICdFTk9TWVMnLCAnRU5PVEVNUFRZJywgMCwgMCwgJ0VOT01TRycsICdFSURSTScsICdFQ0hSTkcnLCAnRUwyTlNZTkMnLCAnRUwzSExUJywgJ0VMM1JTVCcsICdFTE5STkcnLCAnRVVOQVRDSCcsICdFTk9DU0knLCAnRUwySExUJywgJ0VCQURFJywgJ0VCQURSJywgJ0VYRlVMTCcsICdFTk9BTk8nLCAnRUJBRFJRQycsIDAsIDAsICdFQkZPTlQnLCAnRU5PU1RSJywgJ0VOT0RBVEEnLCAnRVRJTUUnLCAnRU5PU1InLCAnRU5PTkVUJywgJ0VOT1BLRycsICdFUkVNT1RFJywgJ0VOT0xJTksnLCAnRUFEVicsICdFU1JNTlQnLCAnRUNPTU0nLCAnRVBST1RPJywgJ0VNVUxUSUhPUCcsICdFRE9URE9UJywgJ0VCQURNU0cnLCAnRU9WRVJGTE9XJywgJ0VOT1RVTklRJywgJ0VCQURGRCcsICdFUkVNQ0hHJywgJ0VMSUJBQ0MnLCAnRUxJQkJBRCcsICdFTElCU0NOJywgJ0VMSUJNQVgnLCAnRUxJQkVYRUMnLCAnRUlMU0VRJywgJ0VSRVNUQVJUJywgJ0VTVFJQSVBFJywgJ0VVU0VSUycsICdFTk9UU09DSycsICdFREVTVEFERFJSRVEnLCAnRU1TR1NJWkUnLCAnRVBST1RPVFlQRScsICdFTk9QUk9UT09QVCcsICdFUFJPVE9OT1NVUFBPUlQnLCAnRVNPQ0tUTk9TVVBQT1JUJywgJ0VPUE5PVFNVUFAnLCAnRVBGTk9TVVBQT1JUJywgJ0VBRk5PU1VQUE9SVCcsICdFQUREUklOVVNFJywgJ0VBRERSTk9UQVZBSUwnLCAnRU5FVERPV04nLCAnRU5FVFVOUkVBQ0gnLCAnRU5FVFJFU0VUJywgJ0VDT05OQUJPUlRFRCcsICdFQ09OTlJFU0VUJywgJ0VOT0JVRlMnLCAnRUlTQ09OTicsICdFTk9UQ09OTicsICdFU0hVVERPV04nLCAnRVRPT01BTllSRUZTJywgJ0VUSU1FRE9VVCcsICdFQ09OTlJFRlVTRUQnLCAnRUhPU1RET1dOJywgJ0VIT1NUVU5SRUFDSCcsICdFQUxSRUFEWScsICdFSU5QUk9HUkVTUycsICdFU1RBTEUnLCAnRVVDTEVBTicsICdFTk9UTkFNJywgJ0VOQVZBSUwnLCAnRUlTTkFNJywgJ0VSRU1PVEVJTycsICdFRFFVT1QnLCAnRU5PTUVESVVNJywgJ0VNRURJVU1UWVBFJywgJ0VDQU5DRUxFRCcsICdFTk9LRVknLCAnRUtFWUVYUElSRUQnLCAnRUtFWVJFVk9LRUQnLCAnRUtFWVJFSkVDVEVEJywgJ0VPV05FUkRFQUQnLCAnRU5PVFJFQ09WRVJBQkxFJywgJ0VSRktJTEwnIF07CgpleHBvcnQgZnVuY3Rpb24gU3lzY2FsbEVycm9yKHN5c2NhbGwsIGVycm51bSkgewogIGxldCBvYmogPSBuZXcudGFyZ2V0ID8gdGhpcyA6IG5ldyBTeXNjYWxsRXJyb3IoKTsKICBpZihzeXNjYWxsKSBvYmouc3lzY2FsbCA9IHN5c2NhbGw7CiAgaWYoZXJybnVtICE9IHVuZGVmaW5lZCkgewogICAgaWYodHlwZW9mIGVycm51bSA9PSAnbnVtYmVyJykgewogICAgICBvYmouZXJybm8gPSBlcnJudW07CiAgICAgIG9iai5jb2RlID0gZXJyb3JTeW1ib2xzW2Vycm51bV07CiAgICB9IGVsc2UgewogICAgICBvYmouZXJybm8gPSBlcnJvclN5bWJvbHMuaW5kZXhPZihlcnJudW0pOwogICAgICBvYmouY29kZSA9IGVycm51bTsKICAgIH0KICB9CiAgRXJyb3IuY2FsbChvYmosIGBTeXNjYWxsRXJyb3I6ICcke29iai5zeXNjYWxsfScgZXJybm8gPSAke29iai5jb2RlfSAoJHtvYmouZXJybm99KWApOwogIHJldHVybiBvYmo7Cn0KClN5c2NhbGxFcnJvci5wcm90b3R5cGUgPSBuZXcgRXJyb3IoKTsKCmRlZmluZShTeXNjYWxsRXJyb3IucHJvdG90eXBlLCB7CiAgZ2V0IG1lc3NhZ2UoKSB7CiAgICByZXR1cm4gYFN5c2NhbGxFcnJvcjogJyR7dGhpcy5zeXNjYWxsfScgZXJybm8gPSAke3RoaXMuY29kZX0gKCR7dGhpcy5lcnJub30pYDsKICB9LAogIFtTeW1ib2wudG9TdHJpbmdUYWddOiAnU3lzY2FsbEVycm9yJwp9KTsKCmdsb2JhbFRoaXMuU3lzY2FsbEVycm9yID0gU3lzY2FsbEVycm9yOwpleHBvcnQgZnVuY3Rpb24gZXh0ZW5kQXJyYXkocHJvdG8gPSBBcnJheS5wcm90b3R5cGUpIHsKICBkZWZpbmUocHJvdG8sIHsKICAgIGdldCBsYXN0KCkgewogICAgICByZXR1cm4gdGhpc1t0aGlzLmxlbmd0aCAtIDFdOwogICAgfSwKICAgIGF0KGluZGV4KSB7CiAgICAgIGNvbnN0IHsgbGVuZ3RoIH0gPSB0aGlzOwogICAgICByZXR1cm4gdGhpc1soKGluZGV4ICUgbGVuZ3RoKSArIGxlbmd0aCkgJSBsZW5ndGhdOwogICAgfSwKICAgIGNsZWFyKCkgewogICAgICB0aGlzLnNwbGljZSgwLCB0aGlzLmxlbmd0aCk7CiAgICB9LAogICAgZmluZExhc3RJbmRleChwcmVkaWNhdGUpIHsKICAgICAgZm9yKGxldCBpID0gdGhpcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkgewogICAgICAgIGNvbnN0IHggPSB0aGlzW2ldOwogICAgICAgIGlmKHByZWRpY2F0ZSh4LCBpLCB0aGlzKSkgcmV0dXJuIGk7CiAgICAgIH0KICAgICAgcmV0dXJuIC0xOwogICAgfSwKICAgIGZpbmRMYXN0KHByZWRpY2F0ZSkgewogICAgICBsZXQgaTsKICAgICAgaWYoKGkgPSB0aGlzLmZpbmRMYXN0SW5kZXgocHJlZGljYXRlKSkgPT0gLTEpIHJldHVybiBudWxsOwogICAgICByZXR1cm4gdGhpc1tpXTsKICAgIH0sCiAgICB1bmlxdWUoKSB7CiAgICAgIHJldHVybiBbLi4ubmV3IFNldCh0aGlzKV07CiAgICB9LAogICAgcHVzaFVuaXF1ZSguLi5hcmdzKSB7CiAgICAgIGZvcihsZXQgYXJnIG9mIGFyZ3MpIGlmKHRoaXMuaW5kZXhPZihhcmcpID09PSAtMSkgdGhpcy5wdXNoKGFyZyk7CiAgICB9CiAgfSk7Cn0KCmV4cG9ydCBmdW5jdGlvbiB0b1N0cmluZyhhcnJheUJ1ZiwgZW5jb2RpbmcgPSAndXRmLTgnKSB7CiAgaWYoZ2xvYmFsVGhpcy5UZXh0RGVjb2RlcikgewogICAgbGV0IGRlYyA9IG5ldyBUZXh0RGVjb2RlcihlbmNvZGluZyk7CiAgICByZXR1cm4gZGVjLmRlY29kZShhcnJheUJ1Zik7CiAgfQoKICBpZihlbmNvZGluZyA9PSAnbGF0aW4xJykgewogICAgbGV0IGJpbmFyeSA9ICcnOwogICAgbGV0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWYpOwogICAgbGV0IGxlbiA9IGJ5dGVzLmJ5dGVMZW5ndGg7CiAgICBmb3IobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgICAgYmluYXJ5ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZXNbaV0pOwogICAgfQogICAgcmV0dXJuIGJpbmFyeTsKICB9CgogIGxldCBhID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWYpOwogIGxldCBwID0gMDsKICBsZXQgbyA9ICcnOwogIGxldCBsZW4gPSBhLmxlbmd0aDsKICBmb3IocCA9IDA7IHAgPCBsZW47ICkgewogICAgbGV0IG1heF9sZW4gPSBsZW4gLSBwOwogICAgbGV0IGwsIGMsIGIsIGk7CgogICAgYyA9IGFbcCsrXTsKICAgIGlmKGMgPCAweDgwKSB7CiAgICAgIG8gKz0gU3RyaW5nLmZyb21Db2RlUG9pbnQoYyk7CiAgICAgIGNvbnRpbnVlOwogICAgfQoKICAgIHN3aXRjaCAoYykgewogICAgICBjYXNlIDB4YzA6CiAgICAgIGNhc2UgMHhjMToKICAgICAgY2FzZSAweGMyOgogICAgICBjYXNlIDB4YzM6CiAgICAgIGNhc2UgMHhjNDoKICAgICAgY2FzZSAweGM1OgogICAgICBjYXNlIDB4YzY6CiAgICAgIGNhc2UgMHhjNzoKICAgICAgY2FzZSAweGM4OgogICAgICBjYXNlIDB4Yzk6CiAgICAgIGNhc2UgMHhjYToKICAgICAgY2FzZSAweGNiOgogICAgICBjYXNlIDB4Y2M6CiAgICAgIGNhc2UgMHhjZDoKICAgICAgY2FzZSAweGNlOgogICAgICBjYXNlIDB4Y2Y6CiAgICAgIGNhc2UgMHhkMDoKICAgICAgY2FzZSAweGQxOgogICAgICBjYXNlIDB4ZDI6CiAgICAgIGNhc2UgMHhkMzoKICAgICAgY2FzZSAweGQ0OgogICAgICBjYXNlIDB4ZDU6CiAgICAgIGNhc2UgMHhkNjoKICAgICAgY2FzZSAweGQ3OgogICAgICBjYXNlIDB4ZDg6CiAgICAgIGNhc2UgMHhkOToKICAgICAgY2FzZSAweGRhOgogICAgICBjYXNlIDB4ZGI6CiAgICAgIGNhc2UgMHhkYzoKICAgICAgY2FzZSAweGRkOgogICAgICBjYXNlIDB4ZGU6CiAgICAgIGNhc2UgMHhkZjoKICAgICAgICBsID0gMTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAweGUwOgogICAgICBjYXNlIDB4ZTE6CiAgICAgIGNhc2UgMHhlMjoKICAgICAgY2FzZSAweGUzOgogICAgICBjYXNlIDB4ZTQ6CiAgICAgIGNhc2UgMHhlNToKICAgICAgY2FzZSAweGU2OgogICAgICBjYXNlIDB4ZTc6CiAgICAgIGNhc2UgMHhlODoKICAgICAgY2FzZSAweGU5OgogICAgICBjYXNlIDB4ZWE6CiAgICAgIGNhc2UgMHhlYjoKICAgICAgY2FzZSAweGVjOgogICAgICBjYXNlIDB4ZWQ6CiAgICAgIGNhc2UgMHhlZToKICAgICAgY2FzZSAweGVmOgogICAgICAgIGwgPSAyOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIDB4ZjA6CiAgICAgIGNhc2UgMHhmMToKICAgICAgY2FzZSAweGYyOgogICAgICBjYXNlIDB4ZjM6CiAgICAgIGNhc2UgMHhmNDoKICAgICAgY2FzZSAweGY1OgogICAgICBjYXNlIDB4ZjY6CiAgICAgIGNhc2UgMHhmNzoKICAgICAgICBsID0gMzsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAweGY4OgogICAgICBjYXNlIDB4Zjk6CiAgICAgIGNhc2UgMHhmYToKICAgICAgY2FzZSAweGZiOgogICAgICAgIGwgPSA0OwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIDB4ZmM6CiAgICAgIGNhc2UgMHhmZDoKICAgICAgICBsID0gNTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIC8qIGNoZWNrIHRoYXQgd2UgaGF2ZSBlbm91Z2ggY2hhcmFjdGVycyAqLwogICAgaWYobCA+IG1heF9sZW4gLSAxKSByZXR1cm4gLTE7CgogICAgYyAmPSBVVEY4Rmlyc3RDb2RlTWFza1tsIC0gMV07CiAgICBmb3IoaSA9IDA7IGkgPCBsOyBpKyspIHsKICAgICAgYiA9IGFbcCsrXTsKICAgICAgaWYoYiA8IDB4ODAgfHwgYiA+PSAweGMwKSByZXR1cm4gLTE7CgogICAgICBjID0gKGMgPDwgNikgfCAoYiAmIDB4M2YpOwogICAgfQogICAgaWYoYyA8IFVURjhNaW5Db2RlW2wgLSAxXSkgcmV0dXJuIC0xOwogICAgbyArPSBTdHJpbmcuZnJvbUNvZGVQb2ludChjKTsKICB9CiAgcmV0dXJuIG87Cn0KCmNvbnN0IGI2NGNoID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89JzsKY29uc3QgYjY0Y2hzID0gWy4uLmI2NGNoXTsKY29uc3QgYjY0dGFiID0gKGEgPT4gewogIGxldCB0YWIgPSB7fTsKICBhLmZvckVhY2goKGMsIGkpID0+ICh0YWJbY10gPSBpKSk7CiAgcmV0dXJuIHRhYjsKfSkoYjY0Y2hzKTsKY29uc3QgYjY0cmUgPSAvXig/OltBLVphLXpcZCtcL117NH0pKj8oPzpbQS1aYS16XGQrXC9dezJ9KD86PT0pP3xbQS1aYS16XGQrXC9dezN9PT8pPyQvOwoKZXhwb3J0IGZ1bmN0aW9uIGJ0b2EoYmluKSB7CiAgbGV0IHUzMiwKICAgIGMwLAogICAgYzEsCiAgICBjMiwKICAgIGFzYyA9ICcnOwogIGNvbnN0IHBhZCA9IGJpbi5sZW5ndGggJSAzOwogIGZvcihsZXQgaSA9IDA7IGkgPCBiaW4ubGVuZ3RoOyBpICs9IDApIHsKICAgIGlmKChjMCA9IGJpbi5jaGFyQ29kZUF0KGkrKykpID4gMjU1IHx8IChjMSA9IGJpbi5jaGFyQ29kZUF0KGkrKykpID4gMjU1IHx8IChjMiA9IGJpbi5jaGFyQ29kZUF0KGkrKykpID4gMjU1KQogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdpbnZhbGlkIGNoYXJhY3RlciBmb3VuZCcpOwogICAgdTMyID0gKGMwIDw8IDE2KSB8IChjMSA8PCA4KSB8IGMyOwogICAgYXNjICs9IGI2NGNoc1sodTMyID4+IDE4KSAmIDYzXSArIGI2NGNoc1sodTMyID4+IDEyKSAmIDYzXSArIGI2NGNoc1sodTMyID4+IDYpICYgNjNdICsgYjY0Y2hzW3UzMiAmIDYzXTsKICB9CiAgcmV0dXJuIHBhZCA/IGFzYy5zbGljZSgwLCBwYWQgLSAzKSArICc9PT0nLnN1YnN0cmluZyhwYWQpIDogYXNjOwp9CgpleHBvcnQgZnVuY3Rpb24gYXRvYihhc2MpIHsKICBhc2MgPSBhc2MucmVwbGFjZSgvXHMrL2csICcnKTsKICBpZighYjY0cmUudGVzdChhc2MpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdtYWxmb3JtZWQgYmFzZTY0LicpOwogIGFzYyArPSAnPT0nLnNsaWNlKDIgLSAoYXNjLmxlbmd0aCAmIDMpKTsKICBsZXQgdTI0LAogICAgYmluID0gJycsCiAgICByMSwKICAgIHIyOwogIGZvcihsZXQgaSA9IDA7IGkgPCBhc2MubGVuZ3RoOyBpICs9IDApIHsKICAgIHUyNCA9CiAgICAgIChiNjR0YWJbYXNjLmNoYXJBdChpKyspXSA8PCAxOCkgfAogICAgICAoYjY0dGFiW2FzYy5jaGFyQXQoaSsrKV0gPDwgMTIpIHwKICAgICAgKChyMSA9IGI2NHRhYlthc2MuY2hhckF0KGkrKyldKSA8PCA2KSB8CiAgICAgIChyMiA9IGI2NHRhYlthc2MuY2hhckF0KGkrKyldKTsKICAgIGJpbiArPQogICAgICByMSA9PT0gNjQKICAgICAgICA/IFN0cmluZy5mcm9tQ2hhckNvZGUoKHUyNCA+PiAxNikgJiAyNTUpCiAgICAgICAgOiByMiA9PT0gNjQKICAgICAgICA/IFN0cmluZy5mcm9tQ2hhckNvZGUoKHUyNCA+PiAxNikgJiAyNTUsICh1MjQgPj4gOCkgJiAyNTUpCiAgICAgICAgOiBTdHJpbmcuZnJvbUNoYXJDb2RlKCh1MjQgPj4gMTYpICYgMjU1LCAodTI0ID4+IDgpICYgMjU1LCB1MjQgJiAyNTUpOwogIH0KICByZXR1cm4gYmluOwp9CmV4cG9ydCBmdW5jdGlvbiBhc3NlcnQoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSkgewogIGlmKGFyZ3VtZW50cy5sZW5ndGggPT0gMSkgZXhwZWN0ZWQgPSB0cnVlOwoKICBpZihhY3R1YWwgPT09IGV4cGVjdGVkKSByZXR1cm47CgogIGlmKAogICAgYWN0dWFsICE9PSBudWxsICYmCiAgICBleHBlY3RlZCAhPT0gbnVsbCAmJgogICAgdHlwZW9mIGFjdHVhbCA9PSAnb2JqZWN0JyAmJgogICAgdHlwZW9mIGV4cGVjdGVkID09ICdvYmplY3QnICYmCiAgICBhY3R1YWwudG9TdHJpbmcoKSA9PT0gZXhwZWN0ZWQudG9TdHJpbmcoKQogICkKICAgIHJldHVybjsKCiAgdGhyb3cgRXJyb3IoCiAgICAnYXNzZXJ0aW9uIGZhaWxlZDogZ290IHwnICsgYWN0dWFsICsgJ3wnICsgJywgZXhwZWN0ZWQgfCcgKyBleHBlY3RlZCArICd8JyArIChtZXNzYWdlID8gJyAoJyArIG1lc3NhZ2UgKyAnKScgOiAnJykKICApOwp9CgpleHBvcnQgZnVuY3Rpb24gZXNjYXBlKHN0ciwgY2hhcnMgPSBbXSkgewogIGNvbnN0IHRhYmxlID0gewogICAgWydcbiddOiAnbicsCiAgICBbJ1xyJ106ICdyJywKICAgIFsnXHQnXTogJ3QnLAogICAgWydcdiddOiAndicsCiAgICBbJ1xiJ106ICdiJwogIH07CiAgZm9yKGxldCBjaCBvZiBjaGFycykgdGFibGVbY2hdID0gY2g7CiAgbGV0IHMgPSAnJzsKICBmb3IobGV0IGNoIG9mIHN0cikgewogICAgaWYodGFibGVbY2hdKSBzICs9ICdcXCcgKyAodGFibGVbY2hdID8/IGNoKTsKICAgIGVsc2UgcyArPSBjaDsKICB9CiAgcmV0dXJuIHM7Cn0KCmV4cG9ydCBmdW5jdGlvbiBxdW90ZShzdHIsIHEgPSAnIicpIHsKICByZXR1cm4gcSArIGVzY2FwZShzdHIsIFtxXSkgKyBxOwp9CgpleHBvcnQgZnVuY3Rpb24gbWVtb2l6ZShmbikgewogIGxldCBjYWNoZSA9IHt9OwogIHJldHVybiAobiwgLi4ucmVzdCkgPT4gewogICAgaWYobiBpbiBjYWNoZSkgcmV0dXJuIGNhY2hlW25dOwogICAgcmV0dXJuIChjYWNoZVtuXSA9IGZuKG4sIC4uLnJlc3QpKTsKICB9Owp9CgpleHBvcnQgZnVuY3Rpb24gZ2V0c2V0KHRhcmdldCwgLi4uYXJncykgewogIGxldCByZXQgPSBbXTsKICBpZihpc0Z1bmN0aW9uKHRhcmdldCkpIHsKICAgIHJldCA9IFt0YXJnZXQsIHR5cGVvZiBhcmdzWzBdID09ICdmdW5jdGlvbicgPyBhcmdzWzBdIDogdGFyZ2V0XTsKICB9IGVsc2UgaWYoaGFzR2V0U2V0KHRhcmdldCkpIHsKICAgIGlmKHRhcmdldC5nZXQgPT09IHRhcmdldC5zZXQpIHsKICAgICAgY29uc3QgR2V0U2V0ID0gKC4uLmFyZ3MpID0+IHRhcmdldC5zZXQoLi4uYXJncyk7CiAgICAgIHJldCA9IFtHZXRTZXQsIEdldFNldF07CiAgICB9IGVsc2UgewogICAgICByZXQgPSBba2V5ID0+IHRhcmdldC5nZXQoa2V5KSwgKGtleSwgdmFsdWUpID0+IHRhcmdldC5zZXQoa2V5LCB2YWx1ZSldOwogICAgICAvL2NvbnNvbGUubG9nKCdnZXRzZXQnLCByZXRbMV0gKyAnJywgdGFyZ2V0LmdldCA9PT0gdGFyZ2V0LnNldCk7CiAgICB9CiAgfSBlbHNlIGlmKGlzT2JqZWN0KHRhcmdldCkpIHsKICAgIHJldCA9IFtrZXkgPT4gdGFyZ2V0W2tleV0sIChrZXksIHZhbHVlKSA9PiAodGFyZ2V0W2tleV0gPSB2YWx1ZSldOwogIH0gZWxzZSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBnZXRzZXQgdW5rbm93biBhcmd1bWVudCB0eXBlICcke3R5cGVvZiB0YXJnZXR9J2ApOwogIH0KICBpZihhcmdzLmxlbmd0aCkgewogICAgbGV0IFtnZXQsIHNldF0gPSByZXQ7CiAgICByZXQgPSBbKCkgPT4gZ2V0KC4uLmFyZ3MpLCB2YWx1ZSA9PiBzZXQoLi4uYXJncywgdmFsdWUpXTsKICB9CiAgcmV0dXJuIHJldDsKfQoKZXhwb3J0IGZ1bmN0aW9uIG1vZGlmaWVyKC4uLmFyZ3MpIHsKICBsZXQgZ3MgPSBnZXR0ZXJzZXR0ZXIoLi4uYXJncyk7CiAgcmV0dXJuIGZuID0+IHsKICAgIGxldCB2YWx1ZSA9IGdzKCk7CiAgICByZXR1cm4gZm4odmFsdWUsIG5ld1ZhbHVlID0+IGdzKG5ld1ZhbHVlKSk7CiAgfTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGdldHRlcih0YXJnZXQsIC4uLmFyZ3MpIHsKICBpZihpc09iamVjdCh0YXJnZXQpICYmIGlzRnVuY3Rpb24odGFyZ2V0LmdldCkpIHJldHVybiAoKSA9PiB0YXJnZXQuZ2V0KC4uLmFyZ3MpOwogIGxldCByZXQ7CiAgaWYoaXNGdW5jdGlvbih0YXJnZXQpKSB7CiAgICByZXQgPSB0YXJnZXQ7CiAgfSBlbHNlIGlmKGhhc0dldFNldCh0YXJnZXQpKSB7CiAgICByZXQgPSBrZXkgPT4gdGFyZ2V0LmdldChrZXkpOwogIH0gZWxzZSBpZihpc09iamVjdCh0YXJnZXQpKSB7CiAgICByZXQgPSBrZXkgPT4gdGFyZ2V0W2tleV07CiAgfSBlbHNlIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYGdldHRlciB1bmtub3duIGFyZ3VtZW50IHR5cGUgJyR7dHlwZW9mIHRhcmdldH0nYCk7CiAgfQogIGlmKGFyZ3MubGVuZ3RoKSB7CiAgICBsZXQgZ2V0ID0gcmV0OwogICAgcmV0ID0gKCkgPT4gZ2V0KC4uLmFyZ3MpOwogIH0KICByZXR1cm4gcmV0Owp9CgpleHBvcnQgZnVuY3Rpb24gc2V0dGVyKHRhcmdldCwgLi4uYXJncykgewogIGlmKGlzT2JqZWN0KHRhcmdldCkgJiYgaXNGdW5jdGlvbih0YXJnZXQuc2V0KSkgcmV0dXJuIHZhbHVlID0+IHRhcmdldC5zZXQoLi4uYXJncywgdmFsdWUpOwogIGxldCByZXQ7CiAgaWYoaXNGdW5jdGlvbih0YXJnZXQpKSB7CiAgICByZXQgPSB0YXJnZXQ7CiAgfSBlbHNlIGlmKGhhc0dldFNldCh0YXJnZXQpKSB7CiAgICByZXQgPSAoa2V5LCB2YWx1ZSkgPT4gdGFyZ2V0LnNldChrZXksIHZhbHVlKTsKICB9IGVsc2UgaWYoaXNPYmplY3QodGFyZ2V0KSkgewogICAgcmV0ID0gKGtleSwgdmFsdWUpID0+ICh0YXJnZXRba2V5XSA9IHZhbHVlKTsKICB9IGVsc2UgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgc2V0dGVyIHVua25vd24gYXJndW1lbnQgdHlwZSAnJHt0eXBlb2YgdGFyZ2V0fSdgKTsKICB9CiAgaWYoYXJncy5sZW5ndGgpIHsKICAgIGxldCBzZXQgPSByZXQ7CiAgICByZXQgPSB2YWx1ZSA9PiBzZXQoLi4uYXJncywgdmFsdWUpOwogIH0KICByZXR1cm4gcmV0Owp9CgpleHBvcnQgZnVuY3Rpb24gZ2V0dGVyc2V0dGVyKHRhcmdldCwgLi4uYXJncykgewogIGxldCBmbjsKICBpZihpc09iamVjdCh0YXJnZXQpICYmIGlzRnVuY3Rpb24odGFyZ2V0LnJlY2VpdmVyKSkgcmV0dXJuICguLi5hcmdzMikgPT4gdGFyZ2V0LnJlY2VpdmVyKC4uLmFyZ3MsIC4uLmFyZ3MyKTsKICBpZihpc0Z1bmN0aW9uKHRhcmdldCkpIHsKICAgIGlmKGlzRnVuY3Rpb24oYXJnc1swXSkgJiYgYXJnc1swXSAhPT0gdGFyZ2V0KSB7CiAgICAgIGxldCBzZXR0ZXIgPSBhcmdzLnNoaWZ0KCk7CiAgICAgIGZuID0gKC4uLmFyZ3MpID0+IChhcmdzLmxlbmd0aCA9PSAwID8gdGFyZ2V0KCkgOiBzZXR0ZXIoLi4uYXJncykpOwogICAgfSBlbHNlIGZuID0gdGFyZ2V0OwogIH0gZWxzZSBpZihoYXNHZXRTZXQodGFyZ2V0KSkgewogICAgaWYodGFyZ2V0LmdldCA9PT0gdGFyZ2V0LnNldCkgZm4gPSAoLi4uYXJncykgPT4gdGFyZ2V0LnNldCguLi5hcmdzKTsKICAgIGVsc2UgZm4gPSAoLi4uYXJncykgPT4gKGFyZ3MubGVuZ3RoIDwgMiA/IHRhcmdldC5nZXQoLi4uYXJncykgOiB0YXJnZXQuc2V0KC4uLmFyZ3MpKTsKICB9IGVsc2UgaWYoaXNPYmplY3QodGFyZ2V0KSkgewogICAgZm4gPSAoLi4uYXJncykgPT4gewogICAgICBjb25zdCBba2V5LCB2YWx1ZV0gPSBhcmdzOwogICAgICBpZihhcmdzLmxlbmd0aCA9PSAxKSByZXR1cm4gdGFyZ2V0W2tleV07CiAgICAgIHRhcmdldFtrZXldID0gdmFsdWU7CiAgICB9OwogIH0gZWxzZSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBnZXR0ZXJzZXR0ZXIgdW5rbm93biBhcmd1bWVudCB0eXBlICcke3R5cGVvZiB0YXJnZXR9J2ApOwogIH0KICBpZihmbiAhPT0gdGFyZ2V0KSBkZWZpbmUoZm4sIHsgcmVjZWl2ZXI6IHRhcmdldCB9KTsKICBpZihhcmdzLmxlbmd0aCkgcmV0dXJuICguLi5hcmdzMikgPT4gZm4oLi4uYXJncywgLi4uYXJnczIpOwogIHJldHVybiBmbjsKfQoKZXhwb3J0IGZ1bmN0aW9uIGhhc0dldFNldChvYmopIHsKICByZXR1cm4gaXNPYmplY3Qob2JqKSAmJiBbJ2dldCcsICdzZXQnXS5ldmVyeShtID0+IHR5cGVvZiBvYmpbbV0gPT0gJ2Z1bmN0aW9uJyk7Cn0KCmV4cG9ydCBmdW5jdGlvbiBtYXBPYmplY3QodGFyZ2V0KSB7CiAgbGV0IG9iajsKICBpZihoYXNHZXRTZXQodGFyZ2V0LnJlY2VpdmVyKSkgcmV0dXJuIHRhcmdldC5yZWNlaXZlcjsKICBpZihoYXNHZXRTZXQodGFyZ2V0KSkgb2JqID0gdGFyZ2V0OwogIGVsc2UgaWYodHlwZW9mIHRhcmdldCA9PSAnZnVuY3Rpb24nKSBvYmogPSB7IGdldDogdGFyZ2V0LCBzZXQ6IHRhcmdldCB9OwogIGVsc2UgaWYoaXNPYmplY3QodGFyZ2V0KSkKICAgIG9iaiA9IHsKICAgICAgc2V0OiAoa2V5LCB2YWx1ZSkgPT4gKHRhcmdldFtrZXldID0gdmFsdWUpLAogICAgICBnZXQ6IGtleSA9PiB0YXJnZXRba2V5XQogICAgfTsKICBpZihvYmogIT09IHRhcmdldCkgZGVmaW5lKG9iaiwgeyByZWNlaXZlcjogdGFyZ2V0IH0pOwogIHJldHVybiBvYmo7Cn0KCmV4cG9ydCBmdW5jdGlvbiBvbmNlKGZuLCB0aGlzQXJnLCBtZW1vRm4pIHsKICBsZXQgcmV0LAogICAgcmFuID0gZmFsc2U7CgogIHJldHVybiBmdW5jdGlvbiguLi5hcmdzKSB7CiAgICBpZighcmFuKSB7CiAgICAgIHJhbiA9IHRydWU7CiAgICAgIHJldCA9IGZuLmFwcGx5KHRoaXNBcmcgfHwgdGhpcywgYXJncyk7CiAgICB9IGVsc2UgaWYodHlwZW9mIG1lbW9GbiA9PSAnZnVuY3Rpb24nKSB7CiAgICAgIHJldCA9IG1lbW9GbihyZXQpOwogICAgfQogICAgcmV0dXJuIHJldDsKICB9Owp9Cgpjb25zdCBhdGV4aXRfZnVuY3Rpb25zID0gW107CmNvbnN0IGF0ZXhpdF9pbnN0YWxsID0gb25jZShjYWxsYmFjayA9PiB7CiAgLy8gYXR0YWNoIHVzZXIgY2FsbGJhY2sgdG8gdGhlIHByb2Nlc3MgZXZlbnQgZW1pdHRlcgogIC8vIGlmIG5vIGNhbGxiYWNrLCBpdCB3aWxsIHN0aWxsIGV4aXQgZ3JhY2VmdWxseSBvbiBDdHJsLUMKICBjYWxsYmFjayA9IGNhbGxiYWNrIHx8IG5vT3A7CiAgcHJvY2Vzcy5vbignY2xlYW51cCcsIGNhbGxiYWNrKTsKCiAgLy8gZG8gYXBwIHNwZWNpZmljIGNsZWFuaW5nIGJlZm9yZSBleGl0aW5nCiAgcHJvY2Vzcy5vbignZXhpdCcsIGZ1bmN0aW9uKCkgewogICAgcHJvY2Vzcy5lbWl0KCdjbGVhbnVwJyk7CiAgfSk7CgogIC8vIGNhdGNoIGN0cmwrYyBldmVudCBhbmQgZXhpdCBub3JtYWxseQogIHByb2Nlc3Mub24oJ1NJR0lOVCcsIGZ1bmN0aW9uKCkgewogICAgY29uc29sZS5sb2coJ0N0cmwtQy4uLicpOwogICAgcHJvY2Vzcy5leGl0KDIpOwogIH0pOwoKICAvL2NhdGNoIHVuY2F1Z2h0IGV4Y2VwdGlvbnMsIHRyYWNlLCB0aGVuIGV4aXQgbm9ybWFsbHkKICBwcm9jZXNzLm9uKCd1bmNhdWdodEV4Y2VwdGlvbicsIGZ1bmN0aW9uKGUpIHsKICAgIGNvbnNvbGUubG9nKCdVbmNhdWdodCBFeGNlcHRpb24uLi4nKTsKICAgIGNvbnNvbGUubG9nKGUuc3RhY2spOwogICAgcHJvY2Vzcy5leGl0KDk5KTsKICB9KTsKfSk7CgpleHBvcnQgZnVuY3Rpb24gYXRleGl0KGZuKSB7CiAgYXRleGl0X2Z1bmN0aW9ucy5wdXNoKGZuKTsKCiAgaWYoZ2xvYmFsVGhpcy5wcm9jZXNzICYmICdvbicgaW4gcHJvY2VzcykgewogICAgYXRleGl0X2luc3RhbGwoKCkgPT4gewogICAgICBmb3IobGV0IGZuIG9mIGF0ZXhpdF9mdW5jdGlvbnMpIGZuKCk7CiAgICB9KTsKICB9Cn0KCmV4cG9ydCBmdW5jdGlvbiB3YWl0Rm9yKG1zKSB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpOwp9CgpleHBvcnQgZnVuY3Rpb24gZGVmaW5lKG9iaiwgLi4uYXJncykgewogIGZvcihsZXQgcHJvcHMgb2YgYXJncykgewogICAgbGV0IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhwcm9wcyk7CiAgICBmb3IobGV0IHByb3AgaW4gZGVzYykgewogICAgICBjb25zdCB7IHZhbHVlIH0gPSBkZXNjW3Byb3BdOwogICAgICBkZXNjW3Byb3BdLmVudW1lcmFibGUgPSBmYWxzZTsKICAgICAgaWYodHlwZW9mIHZhbHVlID09ICdmdW5jdGlvbicpIGRlc2NbcHJvcF0ud3JpdGFibGUgPSBmYWxzZTsKICAgIH0KICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKG9iaiwgZGVzYyk7CiAgfQogIHJldHVybiBvYmo7Cn0KCmV4cG9ydCBmdW5jdGlvbiBrZXlzKG9iaiwgbWF4RGVwdGhPclByZWQgPSAxKSB7CiAgbGV0IGEgPSBbXSwKICAgIGRlcHRoID0gLTE7CiAgaWYodHlwZW9mIG1heERlcHRoT3JQcmVkICE9ICdmdW5jdGlvbicpIHsKICAgIGxldCBkID0gbWF4RGVwdGhPclByZWQ7CiAgICBtYXhEZXB0aE9yUHJlZCA9IChvYmosIGN1cnJlbnREZXB0aCkgPT4gY3VycmVudERlcHRoIDwgZDsKICB9CiAgd2hpbGUob2JqKSB7CiAgICBpZihtYXhEZXB0aE9yUHJlZChvYmosICsrZGVwdGgpICE9PSB0cnVlKSBicmVhazsKICAgIGEucHVzaCguLi5PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iaikuY29uY2F0KE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG9iaikpKTsKICAgIGxldCB0bXAgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqKTsKICAgIGlmKHRtcCA9PT0gb2JqKSB0bXAgPSBudWxsOwogICAgb2JqID0gdG1wOwogIH0KICByZXR1cm4gYTsKfQoKZXhwb3J0IGZ1bmN0aW9uIHByb3BlcnRpZXMob2JqLCBvcHRpb25zID0geyBlbnVtZXJhYmxlOiB0cnVlIH0pIHsKICBsZXQgZGVzYyA9IHt9OwogIGNvbnN0IHsgbWVtb2l6ZTogbWVtbyA9IGZhbHNlLCAuLi5vcHRzIH0gPSBvcHRpb25zOwogIGNvbnN0IG1mbiA9IG1lbW8gPyBmbiA9PiBtZW1vaXplKGZuKSA6IGZuID0+IGZuOwogIGZvcihsZXQgcHJvcCBvZiBrZXlzKG9iaikpIHsKICAgIGlmKEFycmF5LmlzQXJyYXkob2JqW3Byb3BdKSkgewogICAgICBjb25zdCBbZ2V0LCBzZXRdID0gb2JqW3Byb3BdOwogICAgICBkZXNjW3Byb3BdID0geyAuLi5vcHRzLCBnZXQsIHNldCB9OwogICAgfSBlbHNlIGlmKHR5cGVvZiBvYmpbcHJvcF0gPT0gJ2Z1bmN0aW9uJykgewogICAgICBkZXNjW3Byb3BdID0geyAuLi5vcHRzLCBnZXQ6IG1mbihvYmpbcHJvcF0pIH07CiAgICB9CiAgfQogIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh7fSwgZGVzYyk7Cn0KCmV4cG9ydCBmdW5jdGlvbiB3ZWFrQXNzaWduKG9iaiwgLi4uYXJncykgewogIGxldCBkZXNjID0ge307CiAgZm9yKGxldCBvdGhlciBvZiBhcmdzKSB7CiAgICBsZXQgb3RoZXJEZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMob3RoZXIpOwogICAgZm9yKGxldCBrZXkgaW4gb3RoZXJEZXNjKQogICAgICBpZighKGtleSBpbiBvYmopICYmIGRlc2Nba2V5XSA9PT0gdW5kZWZpbmVkICYmIG90aGVyRGVzY1trZXldICE9PSB1bmRlZmluZWQpIGRlc2Nba2V5XSA9IG90aGVyRGVzY1trZXldOwogIH0KICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMob2JqLCBkZXNjKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGdldENvbnN0cnVjdG9yQ2hhaW4ob2JqKSB7CiAgbGV0IHJldCA9IFtdOwogIGxldCBjaGFpbiA9IGdldFByb3RvdHlwZUNoYWluKG9iaik7CiAgaWYob2JqLmNvbnN0cnVjdG9yICYmIG9iai5jb25zdHJ1Y3RvciAhPSBjaGFpblswXS5jb25zdHJ1Y3RvcikgY2hhaW4udW5zaGlmdChvYmopOwogIGZvcihsZXQgcHJvdG8gb2YgY2hhaW4pIHJldC5wdXNoKHByb3RvLmNvbnN0cnVjdG9yKTsKICByZXR1cm4gcmV0Owp9CgpleHBvcnQgZnVuY3Rpb24gaGFzUHJvdG90eXBlKG9iaiwgcHJvdG8pIHsKICByZXR1cm4gZ2V0UHJvdG90eXBlQ2hhaW4ob2JqKS5pbmRleE9mKHByb3RvKSAhPSAtMTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGZpbHRlcihzZXEsIHByZWQsIHRoaXNBcmcpIHsKICBpZihpc09iamVjdChwcmVkKSAmJiBwcmVkIGluc3RhbmNlb2YgUmVnRXhwKSB7CiAgICBsZXQgcmUgPSBwcmVkOwogICAgcHJlZCA9IChlbCwgaSkgPT4gcmUudGVzdChlbCk7CiAgfQogIGxldCByID0gW10sCiAgICBpID0gMDsKICBmb3IobGV0IGVsIG9mIHNlcSkgewogICAgaWYocHJlZC5jYWxsKHRoaXNBcmcsIGVsLCBpKyssIHNlcSkpIHIucHVzaChlbCk7CiAgfQogIHJldHVybiByOwp9CgpleHBvcnQgY29uc3QgY3VycnkgPQogIChmLCBhcnIgPSBbXSwgbGVuZ3RoID0gZi5sZW5ndGgpID0+CiAgKC4uLmFyZ3MpID0+CiAgICAoYSA9PiAoYS5sZW5ndGggPT09IGxlbmd0aCA/IGYoLi4uYSkgOiBjdXJyeShmLCBhKSkpKFsuLi5hcnIsIC4uLmFyZ3NdKTsKCmV4cG9ydCBmdW5jdGlvbiogc3BsaXQoYnVmLCAuLi5wb2ludHMpIHsKICBwb2ludHMuc29ydCgpOwogIGNvbnN0IHNwbGl0QXQgPSAoYiwgcG9zLCBsZW4pID0+IHsKICAgIGxldCByID0gcG9zIDwgYi5ieXRlTGVuZ3RoID8gW3NsaWNlKGIsIDAsIHBvcyksIHNsaWNlKGIsIHBvcyldIDogW251bGwsIGJdOwogICAgcmV0dXJuIHI7CiAgfTsKICBsZXQgcHJldiwKICAgIGxlbiA9IDA7CiAgZm9yKGxldCBvZmZzZXQgb2YgcG9pbnRzKSB7CiAgICBsZXQgYXQgPSBvZmZzZXQgLSBsZW47CiAgICBbcHJldiwgYnVmXSA9IHNwbGl0QXQoYnVmLCBhdCwgbGVuKTsKICAgIGlmKHByZXYpIHsKICAgICAgeWllbGQgcHJldjsKICAgICAgbGVuID0gb2Zmc2V0OwogICAgfQogIH0KICBpZihidWYpIHlpZWxkIGJ1ZjsKfQoKZXhwb3J0IGNvbnN0IHVuaXF1ZSA9IChhcnIsIGNtcCkgPT4KICBhcnIuZmlsdGVyKAogICAgdHlwZW9mIGNtcCA9PSAnZnVuY3Rpb24nCiAgICAgID8gKGVsLCBpLCBhcnIpID0+IGFyci5maW5kSW5kZXgoaXRlbSA9PiBjbXAoZWwsIGl0ZW0pKSA9PSBpCiAgICAgIDogKGVsLCBpLCBhcnIpID0+IGFyci5pbmRleE9mKGVsKSA9PSBpCiAgKTsKCmV4cG9ydCBjb25zdCBnZXRGdW5jdGlvbkFyZ3VtZW50cyA9IGZuID0+CiAgKGZuICsgJycpCiAgICAucmVwbGFjZSgvXG4uKi9nLCAnJykKICAgIC5yZXBsYWNlKC8oPT58e3xcbikuKi9nLCAnJykKICAgIC5yZXBsYWNlKC9eZnVuY3Rpb25ccyovLCAnJykKICAgIC5yZXBsYWNlKC9eXCgoLiopXClccyokL2csICckMScpCiAgICAuc3BsaXQoLyxccyovZyk7Cgpjb25zdCBBTlNJX0JBQ0tHUk9VTkRfT0ZGU0VUID0gMTA7Cgpjb25zdCB3cmFwQW5zaTE2ID0KICAob2Zmc2V0ID0gMCkgPT4KICBjb2RlID0+CiAgICBgXHgxYlske2NvZGUgKyBvZmZzZXR9bWA7Cgpjb25zdCB3cmFwQW5zaTI1NiA9CiAgKG9mZnNldCA9IDApID0+CiAgY29kZSA9PgogICAgYFx4MWJbJHszOCArIG9mZnNldH07NTske2NvZGV9bWA7Cgpjb25zdCB3cmFwQW5zaTE2bSA9CiAgKG9mZnNldCA9IDApID0+CiAgKHJlZCwgZ3JlZW4sIGJsdWUpID0+CiAgICBgXHgxYlskezM4ICsgb2Zmc2V0fTsyOyR7cmVkfTske2dyZWVufTske2JsdWV9bWA7CgpmdW5jdGlvbiBnZXRBbnNpU3R5bGVzKCkgewogIGNvbnN0IGNvZGVzID0gbmV3IE1hcCgpOwogIGNvbnN0IHN0eWxlcyA9IHsKICAgIG1vZGlmaWVyOiB7CiAgICAgIHJlc2V0OiBbMCwgMF0sCiAgICAgIC8vIDIxIGlzbid0IHdpZGVseSBzdXBwb3J0ZWQgYW5kIDIyIGRvZXMgdGhlIHNhbWUgdGhpbmcKICAgICAgYm9sZDogWzEsIDIyXSwKICAgICAgZGltOiBbMiwgMjJdLAogICAgICBpdGFsaWM6IFszLCAyM10sCiAgICAgIHVuZGVybGluZTogWzQsIDI0XSwKICAgICAgb3ZlcmxpbmU6IFs1MywgNTVdLAogICAgICBpbnZlcnNlOiBbNywgMjddLAogICAgICBoaWRkZW46IFs4LCAyOF0sCiAgICAgIHN0cmlrZXRocm91Z2g6IFs5LCAyOV0KICAgIH0sCiAgICBjb2xvcjogewogICAgICBibGFjazogWzMwLCAzOV0sCiAgICAgIHJlZDogWzMxLCAzOV0sCiAgICAgIGdyZWVuOiBbMzIsIDM5XSwKICAgICAgeWVsbG93OiBbMzMsIDM5XSwKICAgICAgYmx1ZTogWzM0LCAzOV0sCiAgICAgIG1hZ2VudGE6IFszNSwgMzldLAogICAgICBjeWFuOiBbMzYsIDM5XSwKICAgICAgd2hpdGU6IFszNywgMzldLAoKICAgICAgLy8gQnJpZ2h0IGNvbG9yCiAgICAgIGJsYWNrQnJpZ2h0OiBbOTAsIDM5XSwKICAgICAgcmVkQnJpZ2h0OiBbOTEsIDM5XSwKICAgICAgZ3JlZW5CcmlnaHQ6IFs5MiwgMzldLAogICAgICB5ZWxsb3dCcmlnaHQ6IFs5MywgMzldLAogICAgICBibHVlQnJpZ2h0OiBbOTQsIDM5XSwKICAgICAgbWFnZW50YUJyaWdodDogWzk1LCAzOV0sCiAgICAgIGN5YW5CcmlnaHQ6IFs5NiwgMzldLAogICAgICB3aGl0ZUJyaWdodDogWzk3LCAzOV0KICAgIH0sCiAgICBiZ0NvbG9yOiB7CiAgICAgIGJnQmxhY2s6IFs0MCwgNDldLAogICAgICBiZ1JlZDogWzQxLCA0OV0sCiAgICAgIGJnR3JlZW46IFs0MiwgNDldLAogICAgICBiZ1llbGxvdzogWzQzLCA0OV0sCiAgICAgIGJnQmx1ZTogWzQ0LCA0OV0sCiAgICAgIGJnTWFnZW50YTogWzQ1LCA0OV0sCiAgICAgIGJnQ3lhbjogWzQ2LCA0OV0sCiAgICAgIGJnV2hpdGU6IFs0NywgNDldLAoKICAgICAgLy8gQnJpZ2h0IGNvbG9yCiAgICAgIGJnQmxhY2tCcmlnaHQ6IFsxMDAsIDQ5XSwKICAgICAgYmdSZWRCcmlnaHQ6IFsxMDEsIDQ5XSwKICAgICAgYmdHcmVlbkJyaWdodDogWzEwMiwgNDldLAogICAgICBiZ1llbGxvd0JyaWdodDogWzEwMywgNDldLAogICAgICBiZ0JsdWVCcmlnaHQ6IFsxMDQsIDQ5XSwKICAgICAgYmdNYWdlbnRhQnJpZ2h0OiBbMTA1LCA0OV0sCiAgICAgIGJnQ3lhbkJyaWdodDogWzEwNiwgNDldLAogICAgICBiZ1doaXRlQnJpZ2h0OiBbMTA3LCA0OV0KICAgIH0KICB9OwoKICAvLyBBbGlhcyBicmlnaHQgYmxhY2sgYXMgZ3JheSAoYW5kIGdyZXkpCiAgc3R5bGVzLmNvbG9yLmdyYXkgPSBzdHlsZXMuY29sb3IuYmxhY2tCcmlnaHQ7CiAgc3R5bGVzLmJnQ29sb3IuYmdHcmF5ID0gc3R5bGVzLmJnQ29sb3IuYmdCbGFja0JyaWdodDsKICBzdHlsZXMuY29sb3IuZ3JleSA9IHN0eWxlcy5jb2xvci5ibGFja0JyaWdodDsKICBzdHlsZXMuYmdDb2xvci5iZ0dyZXkgPSBzdHlsZXMuYmdDb2xvci5iZ0JsYWNrQnJpZ2h0OwoKICBmb3IoY29uc3QgW2dyb3VwTmFtZSwgZ3JvdXBdIG9mIE9iamVjdC5lbnRyaWVzKHN0eWxlcykpIHsKICAgIGZvcihjb25zdCBbc3R5bGVOYW1lLCBzdHlsZV0gb2YgT2JqZWN0LmVudHJpZXMoZ3JvdXApKSB7CiAgICAgIHN0eWxlc1tzdHlsZU5hbWVdID0gewogICAgICAgIG9wZW46IGBcdTAwMUJbJHtzdHlsZVswXX1tYCwKICAgICAgICBjbG9zZTogYFx1MDAxQlske3N0eWxlWzFdfW1gCiAgICAgIH07CgogICAgICBncm91cFtzdHlsZU5hbWVdID0gc3R5bGVzW3N0eWxlTmFtZV07CgogICAgICBjb2Rlcy5zZXQoc3R5bGVbMF0sIHN0eWxlWzFdKTsKICAgIH0KCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc3R5bGVzLCBncm91cE5hbWUsIHsKICAgICAgdmFsdWU6IGdyb3VwLAogICAgICBlbnVtZXJhYmxlOiBmYWxzZQogICAgfSk7CiAgfQoKICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc3R5bGVzLCAnY29kZXMnLCB7CiAgICB2YWx1ZTogY29kZXMsCiAgICBlbnVtZXJhYmxlOiBmYWxzZQogIH0pOwoKICBzdHlsZXMuY29sb3IuY2xvc2UgPSAnXHUwMDFCWzM5bSc7CiAgc3R5bGVzLmJnQ29sb3IuY2xvc2UgPSAnXHUwMDFCWzQ5bSc7CgogIHN0eWxlcy5jb2xvci5hbnNpID0gd3JhcEFuc2kxNigpOwogIHN0eWxlcy5jb2xvci5hbnNpMjU2ID0gd3JhcEFuc2kyNTYoKTsKICBzdHlsZXMuY29sb3IuYW5zaTE2bSA9IHdyYXBBbnNpMTZtKCk7CiAgc3R5bGVzLmJnQ29sb3IuYW5zaSA9IHdyYXBBbnNpMTYoQU5TSV9CQUNLR1JPVU5EX09GRlNFVCk7CiAgc3R5bGVzLmJnQ29sb3IuYW5zaTI1NiA9IHdyYXBBbnNpMjU2KEFOU0lfQkFDS0dST1VORF9PRkZTRVQpOwogIHN0eWxlcy5iZ0NvbG9yLmFuc2kxNm0gPSB3cmFwQW5zaTE2bShBTlNJX0JBQ0tHUk9VTkRfT0ZGU0VUKTsKCiAgLy8gRnJvbSBodHRwczovL2dpdGh1Yi5jb20vUWl4LS9jb2xvci1jb252ZXJ0L2Jsb2IvM2YwZTBkNGU5MmUyMzU3OTZjY2IxN2Y2ZTg1YzcyMDk0YTY1MWY0OS9jb252ZXJzaW9ucy5qcwogIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHN0eWxlcywgewogICAgcmdiVG9BbnNpMjU2OiB7CiAgICAgIHZhbHVlOiAocmVkLCBncmVlbiwgYmx1ZSkgPT4gewogICAgICAgIC8vIFdlIHVzZSB0aGUgZXh0ZW5kZWQgZ3JleXNjYWxlIHBhbGV0dGUgaGVyZSwgd2l0aCB0aGUgZXhjZXB0aW9uIG9mCiAgICAgICAgLy8gYmxhY2sgYW5kIHdoaXRlLiBub3JtYWwgcGFsZXR0ZSBvbmx5IGhhcyA0IGdyZXlzY2FsZSBzaGFkZXMuCiAgICAgICAgaWYocmVkID09PSBncmVlbiAmJiBncmVlbiA9PT0gYmx1ZSkgewogICAgICAgICAgaWYocmVkIDwgOCkgewogICAgICAgICAgICByZXR1cm4gMTY7CiAgICAgICAgICB9CgogICAgICAgICAgaWYocmVkID4gMjQ4KSB7CiAgICAgICAgICAgIHJldHVybiAyMzE7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoKChyZWQgLSA4KSAvIDI0NykgKiAyNCkgKyAyMzI7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGMgPSBbcmVkLCBncmVlbiwgYmx1ZV0ubWFwKGMgPT4gKGMgLyAyNTUpICogNSk7CiAgICAgICAgcmV0dXJuIDE2ICsgMzYgKiBjWzBdICsgNiAqIGNbMV0gKyBjWzJdOwogICAgICB9LAogICAgICBlbnVtZXJhYmxlOiBmYWxzZQogICAgfSwKICAgIGhleFRvUmdiOiB7CiAgICAgIHZhbHVlOiBoZXggPT4gewogICAgICAgIGNvbnN0IG1hdGNoZXMgPSAvKD88Y29sb3JTdHJpbmc+W2EtZlxkXXs2fXxbYS1mXGRdezN9KS9pLmV4ZWMoaGV4LnRvU3RyaW5nKDE2KSk7CiAgICAgICAgaWYoIW1hdGNoZXMpIHsKICAgICAgICAgIHJldHVybiBbMCwgMCwgMF07CiAgICAgICAgfQoKICAgICAgICBsZXQgeyBjb2xvclN0cmluZyB9ID0gbWF0Y2hlcy5ncm91cHM7CgogICAgICAgIGlmKGNvbG9yU3RyaW5nLmxlbmd0aCA9PT0gMykgewogICAgICAgICAgY29sb3JTdHJpbmcgPSBjb2xvclN0cmluZwogICAgICAgICAgICAuc3BsaXQoJycpCiAgICAgICAgICAgIC5tYXAoY2hhcmFjdGVyID0+IGNoYXJhY3RlciArIGNoYXJhY3RlcikKICAgICAgICAgICAgLmpvaW4oJycpOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgaW50ZWdlciA9IE51bWJlci5wYXJzZUludChjb2xvclN0cmluZywgMTYpOwoKICAgICAgICByZXR1cm4gWyhpbnRlZ2VyID4+IDE2KSAmIDB4ZmYsIChpbnRlZ2VyID4+IDgpICYgMHhmZiwgaW50ZWdlciAmIDB4ZmZdOwogICAgICB9LAogICAgICBlbnVtZXJhYmxlOiBmYWxzZQogICAgfSwKICAgIGhleFRvQW5zaTI1NjogewogICAgICB2YWx1ZTogaGV4ID0+IHN0eWxlcy5yZ2JUb0Fuc2kyNTYoLi4uc3R5bGVzLmhleFRvUmdiKGhleCkpLAogICAgICBlbnVtZXJhYmxlOiBmYWxzZQogICAgfSwKICAgIGFuc2kyNTZUb0Fuc2k6IHsKICAgICAgdmFsdWU6IGNvZGUgPT4gewogICAgICAgIGlmKGNvZGUgPCA4KSB7CiAgICAgICAgICByZXR1cm4gMzAgKyBjb2RlOwogICAgICAgIH0KCiAgICAgICAgaWYoY29kZSA8IDE2KSB7CiAgICAgICAgICByZXR1cm4gOTAgKyAoY29kZSAtIDgpOwogICAgICAgIH0KCiAgICAgICAgbGV0IHJlZDsKICAgICAgICBsZXQgZ3JlZW47CiAgICAgICAgbGV0IGJsdWU7CgogICAgICAgIGlmKGNvZGUgPj0gMjMyKSB7CiAgICAgICAgICByZWQgPSAoKGNvZGUgLSAyMzIpICogMTAgKyA4KSAvIDI1NTsKICAgICAgICAgIGdyZWVuID0gcmVkOwogICAgICAgICAgYmx1ZSA9IHJlZDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29kZSAtPSAxNjsKCiAgICAgICAgICBjb25zdCByZW1haW5kZXIgPSBjb2RlICUgMzY7CgogICAgICAgICAgcmVkID0gTWF0aC5mbG9vcihjb2RlIC8gMzYpICogMC4yOwogICAgICAgICAgZ3JlZW4gPSBNYXRoLmZsb29yKHJlbWFpbmRlciAvIDYpICogMC4yOwogICAgICAgICAgYmx1ZSA9IChyZW1haW5kZXIgJSA2KSAqIDAuMjsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHZhbHVlID0gTWF0aC5tYXgocmVkLCBncmVlbiwgYmx1ZSkgKiAyOwoKICAgICAgICBpZih2YWx1ZSA9PT0gMCkgewogICAgICAgICAgcmV0dXJuIDMwOwogICAgICAgIH0KCiAgICAgICAgbGV0IHJlc3VsdCA9IDMwICsgKChNYXRoLnJvdW5kKGJsdWUpIDw8IDIpIHwgKE1hdGgucm91bmQoZ3JlZW4pIDw8IDEpIHwgTWF0aC5yb3VuZChyZWQpKTsKCiAgICAgICAgaWYodmFsdWUgPT09IDIpIHsKICAgICAgICAgIHJlc3VsdCArPSA2MDsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgIH0sCiAgICAgIGVudW1lcmFibGU6IGZhbHNlCiAgICB9LAogICAgcmdiVG9BbnNpOiB7CiAgICAgIHZhbHVlOiAocmVkLCBncmVlbiwgYmx1ZSkgPT4gc3R5bGVzLmFuc2kyNTZUb0Fuc2koc3R5bGVzLnJnYlRvQW5zaTI1NihyZWQsIGdyZWVuLCBibHVlKSksCiAgICAgIGVudW1lcmFibGU6IGZhbHNlCiAgICB9LAogICAgaGV4VG9BbnNpOiB7CiAgICAgIHZhbHVlOiBoZXggPT4gc3R5bGVzLmFuc2kyNTZUb0Fuc2koc3R5bGVzLmhleFRvQW5zaTI1NihoZXgpKSwKICAgICAgZW51bWVyYWJsZTogZmFsc2UKICAgIH0KICB9KTsKCiAgcmV0dXJuIHN0eWxlczsKfQoKZXhwb3J0IGZ1bmN0aW9uIHJhbmRJbnQoLi4uYXJncykgewogIGxldCByYW5nZSA9IGFyZ3Muc3BsaWNlKDAsIDIpOwogIGxldCBybmcgPSBhcmdzLnNoaWZ0KCkgPz8gTWF0aC5yYW5kb207CiAgaWYocmFuZ2UubGVuZ3RoIDwgMikgcmFuZ2UudW5zaGlmdCgwKTsKICByZXR1cm4gTWF0aC5yb3VuZChtaXNjLnJhbmQocmFuZ2VbMV0gLSByYW5nZVswXSArIDEpICsgcmFuZ2VbMF0pOwp9CgpleHBvcnQgZnVuY3Rpb24gcmFuZEZsb2F0KG1pbiwgbWF4LCBybmcgPSBNYXRoLnJhbmRvbSkgewogIHJldHVybiBybmcoKSAqIChtYXggLSBtaW4pICsgbWluOwp9CgpleHBvcnQgZnVuY3Rpb24gcmFuZFN0cihuLCBzZXQgPSAnXzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6Jywgcm5nID0gTWF0aC5yYW5kb20pIHsKICBsZXQgbyA9ICcnOwoKICB3aGlsZSgtLW4gPj0gMCkgbyArPSBzZXRbTWF0aC5yb3VuZChybmcoKSAqIChzZXQubGVuZ3RoIC0gMSkpXTsKICByZXR1cm4gbzsKfQoKZXhwb3J0IGZ1bmN0aW9uIHRvQmlnSW50KGFyZykgewogIGlmKHR5cGVzLmlzQXJyYXlCdWZmZXIoYXJnKSkgewogICAgY29uc3QgYml0cyA9IG1pc2MuYml0cyhhcmcpLmpvaW4oJycpOwogICAgcmV0dXJuIGV2YWwoYDBiJHtiaXRzfW5gKTsKICB9CiAgcmV0dXJuIEJpZ0ludChhcmcpOwp9CgpleHBvcnQgZnVuY3Rpb24gcm91bmRUbyh2YWx1ZSwgcHJlYywgZGlnaXRzLCB0eXBlKSB7CiAgaWYoIU51bWJlci5pc0Zpbml0ZSh2YWx1ZSkpIHJldHVybiB2YWx1ZTsKICB0eXBlID0gdHlwZSA/PyAncm91bmQnOwogIGNvbnN0IGZuID0gTWF0aFt0eXBlXTsKICBpZihwcmVjID09IDEpIHJldHVybiBmbih2YWx1ZSk7CiAgbGV0IHJldCA9IHByZWMgPiBOdW1iZXIuRVBTSUxPTiA/IGZuKHZhbHVlIC8gcHJlYykgKiBwcmVjIDogdmFsdWU7CgogIGlmKGlzTnVtYmVyKGRpZ2l0cykgJiYgZGlnaXRzID49IDEgJiYgZGlnaXRzIDw9IDEwMCkgcmV0ID0gK3JldC50b0ZpeGVkKGRpZ2l0cyk7CiAgZWxzZSByZXQgPSBNYXRoW3R5cGVdKHJldCk7CiAgcmV0dXJuIHJldDsKfQoKZXhwb3J0IGZ1bmN0aW9uIGxhenlQcm9wZXJ0eShvYmosIG5hbWUsIGdldHRlciwgb3B0cyA9IHt9KSB7CiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIG5hbWUsIHsKICAgIGdldDogdHlwZXMuaXNBc3luY0Z1bmN0aW9uKGdldHRlcikKICAgICAgPyBhc3luYyBmdW5jdGlvbigpIHsKICAgICAgICAgIHJldHVybiByZXBsYWNlUHJvcGVydHkoYXdhaXQgZ2V0dGVyLmNhbGwodGhpcyA/PyBvYmosIG5hbWUpKTsKICAgICAgICB9CiAgICAgIDogZnVuY3Rpb24oKSB7CiAgICAgICAgICBjb25zdCB2YWx1ZSA9IGdldHRlci5jYWxsKHRoaXMgPz8gb2JqLCBuYW1lKTsKICAgICAgICAgIGlmKHR5cGVzLmlzUHJvbWlzZSh2YWx1ZSkpIHsKICAgICAgICAgICAgdmFsdWUudGhlbih2ID0+IHsKICAgICAgICAgICAgICByZXBsYWNlUHJvcGVydHkodik7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coYHV0aWwubGF6eVByb3BlcnR5IHJlc29sdmVkIGAsIG9ialtuYW1lXSk7CiAgICAgICAgICAgICAgcmV0dXJuIHY7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gcmVwbGFjZVByb3BlcnR5KHZhbHVlKTsKICAgICAgICB9LAogICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgLi4ub3B0cwogIH0pOwoKICBmdW5jdGlvbiByZXBsYWNlUHJvcGVydHkodmFsdWUpIHsKICAgIGRlbGV0ZSBvYmpbbmFtZV07CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBuYW1lLCB7IHZhbHVlLCAuLi5vcHRzIH0pOwogICAgcmV0dXJuIHZhbHVlOwogIH0KfQoKZXhwb3J0IGZ1bmN0aW9uIGxhenlQcm9wZXJ0aWVzKG9iaiwgZ2V0dGVyc09iaiwgb3B0cyA9IHt9KSB7CiAgb3B0cyA9IHsgZW51bWVyYWJsZTogZmFsc2UsIC4uLm9wdHMgfTsKICBmb3IobGV0IHByb3Agb2YgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoZ2V0dGVyc09iaikpIGxhenlQcm9wZXJ0eShvYmosIHByb3AsIGdldHRlcnNPYmpbcHJvcF0sIG9wdHMpOwogIHJldHVybiBvYmo7Cn0KCmV4cG9ydCBmdW5jdGlvbiBnZXRPcHQob3B0aW9ucyA9IHt9LCBhcmdzKSB7CiAgbGV0IHNob3J0LCBsb25nOwogIGxldCByZXN1bHQgPSB7fTsKICBsZXQgcG9zaXRpb25hbCA9IChyZXN1bHRbJ0AnXSA9IFtdKTsKICBpZighKG9wdGlvbnMgaW5zdGFuY2VvZiBBcnJheSkpIG9wdGlvbnMgPSBPYmplY3QuZW50cmllcyhvcHRpb25zKTsKICBjb25zdCBmaW5kT3B0ID0gYXJnID0+CiAgICBvcHRpb25zLmZpbmQoKFtvcHRuYW1lLCBvcHRpb25dKSA9PiAoQXJyYXkuaXNBcnJheShvcHRpb24pID8gb3B0aW9uLmluZGV4T2YoYXJnKSAhPSAtMSA6IGZhbHNlKSB8fCBhcmcgPT0gb3B0bmFtZSk7CiAgbGV0IFssIHBhcmFtc10gPSBvcHRpb25zLmZpbmQob3B0ID0+IG9wdFswXSA9PSAnQCcpIHx8IFtdOwogIGlmKHR5cGVvZiBwYXJhbXMgPT0gJ3N0cmluZycpIHBhcmFtcyA9IHBhcmFtcy5zcGxpdCgnLCcpOwogIGZvcihsZXQgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7CiAgICBjb25zdCBhcmcgPSBhcmdzW2ldOwogICAgbGV0IG9wdDsKICAgIGlmKGFyZ1swXSA9PSAnLScpIHsKICAgICAgbGV0IG5hbWUsIHZhbHVlLCBzdGFydCwgZW5kOwogICAgICBpZihhcmdbMV0gPT0gJy0nKSBsb25nID0gdHJ1ZTsKICAgICAgZWxzZSBzaG9ydCA9IHRydWU7CiAgICAgIHN0YXJ0ID0gc2hvcnQgPyAxIDogMjsKICAgICAgaWYoc2hvcnQpIGVuZCA9IDI7CiAgICAgIGVsc2UgaWYoKGVuZCA9IGFyZy5pbmRleE9mKCc9JykpID09IC0xKSBlbmQgPSBhcmcubGVuZ3RoOwogICAgICBuYW1lID0gYXJnLnN1YnN0cmluZyhzdGFydCwgZW5kKTsKICAgICAgaWYoKG9wdCA9IGZpbmRPcHQobmFtZSkpKSB7CiAgICAgICAgY29uc3QgW2hhc19hcmcsIGhhbmRsZXJdID0gb3B0WzFdOwogICAgICAgIGlmKGhhc19hcmcpIHsKICAgICAgICAgIGlmKGFyZy5sZW5ndGggPiBlbmQpIHZhbHVlID0gYXJnLnN1YnN0cmluZyhlbmQgKyAoYXJnW2VuZF0gPT0gJz0nKSk7CiAgICAgICAgICBlbHNlIHZhbHVlID0gYXJnc1srK2ldOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YWx1ZSA9IHRydWU7CiAgICAgICAgfQogICAgICAgIHRyeSB7CiAgICAgICAgICB2YWx1ZSA9IGhhbmRsZXIodmFsdWUsIHJlc3VsdFtvcHRbMF1dLCBvcHRpb25zLCByZXN1bHQpOwogICAgICAgIH0gY2F0Y2goZSkge30KICAgICAgICByZXN1bHRbb3B0WzBdXSA9IHZhbHVlOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICB9CiAgICBpZihwYXJhbXMubGVuZ3RoKSB7CiAgICAgIGNvbnN0IHBhcmFtID0gcGFyYW1zLnNoaWZ0KCk7CiAgICAgIGlmKChvcHQgPSBmaW5kT3B0KHBhcmFtKSkpIHsKICAgICAgICBjb25zdCBbLCBbLCBoYW5kbGVyXV0gPSBvcHQ7CiAgICAgICAgbGV0IHZhbHVlID0gYXJnOwogICAgICAgIGlmKHR5cGVvZiBoYW5kbGVyID09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIHZhbHVlID0gaGFuZGxlcih2YWx1ZSwgcmVzdWx0W29wdFswXV0sIG9wdGlvbnMsIHJlc3VsdCk7CiAgICAgICAgICB9IGNhdGNoKGUpIHt9CiAgICAgICAgfQogICAgICAgIGNvbnN0IG5hbWUgPSBvcHRbMF07CiAgICAgICAgcmVzdWx0W29wdFswXV0gPSB2YWx1ZTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgfQogICAgcmVzdWx0WydAJ10gPSBbLi4uKHJlc3VsdFsnQCddID8/IFtdKSwgYXJnXTsKICB9CiAgcmV0dXJuIHJlc3VsdDsKfQoKZXhwb3J0IGZ1bmN0aW9uIHRvVW5peFRpbWUoZGF0ZU9iaiwgdXRjID0gZmFsc2UpIHsKICBpZighKGRhdGVPYmogaW5zdGFuY2VvZiBEYXRlKSkgZGF0ZU9iaiA9IG5ldyBEYXRlKGRhdGVPYmopOwogIGxldCBlcG9jaCA9IE1hdGguZmxvb3IoZGF0ZU9iai5nZXRUaW1lKCkgLyAxMDAwKTsKICBpZih1dGMpIGVwb2NoICs9IGRhdGVPYmouZ2V0VGltZXpvbmVPZmZzZXQoKSAqIDYwOwogIHJldHVybiBlcG9jaDsKfQoKZXhwb3J0IGZ1bmN0aW9uIHVuaXhUaW1lKHV0YyA9IGZhbHNlKSB7CiAgcmV0dXJuIHRvVW5peFRpbWUobmV3IERhdGUoKSwgdXRjKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGZyb21Vbml4VGltZShlcG9jaCwgdXRjID0gZmFsc2UpIHsKICBsZXQgdCA9IHBhcnNlSW50KGVwb2NoKTsKICBsZXQgZCA9IG5ldyBEYXRlKDApOwogIHV0YyA/IGQuc2V0VVRDU2Vjb25kcyh0KSA6IGQuc2V0U2Vjb25kcyh0KTsKICByZXR1cm4gZDsKfQoKZXhwb3J0IGZ1bmN0aW9uIHJhbmdlKC4uLmFyZ3MpIHsKICBsZXQgW3N0YXJ0LCBlbmQsIHN0ZXAgPSAxXSA9IGFyZ3M7CiAgbGV0IHJldDsKICBzdGFydCAvPSBzdGVwOwogIGVuZCAvPSBzdGVwOwogIGlmKHN0YXJ0ID4gZW5kKSB7CiAgICByZXQgPSBbXTsKICAgIHdoaWxlKHN0YXJ0ID49IGVuZCkgcmV0LnB1c2goc3RhcnQtLSk7CiAgfSBlbHNlIHsKICAgIHJldCA9IEFycmF5LmZyb20oeyBsZW5ndGg6IGVuZCAtIHN0YXJ0ICsgMSB9LCAodiwgaykgPT4gayArIHN0YXJ0KTsKICB9CiAgaWYoc3RlcCAhPSAxKSB7CiAgICByZXQgPSByZXQubWFwKG4gPT4gbiAqIHN0ZXApOwogIH0KICByZXR1cm4gcmV0Owp9CgpleHBvcnQgZnVuY3Rpb24gcmVwZWF0ZXIobiwgd2hhdCkgewogIGlmKHR5cGVvZiB3aGF0ID09ICdmdW5jdGlvbicpCiAgICByZXR1cm4gKGZ1bmN0aW9uKiAoKSB7CiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHlpZWxkIHdoYXQoKTsKICAgIH0pKCk7CiAgcmV0dXJuIChmdW5jdGlvbiogKCkgewogICAgZm9yKGxldCBpID0gMDsgaSA8IG47IGkrKykgeWllbGQgd2hhdDsKICB9KSgpOwp9CgpleHBvcnQgZnVuY3Rpb24gcmVwZWF0KG4sIHdoYXQpIHsKICByZXR1cm4gWy4uLnJlcGVhdGVyKG4sIHdoYXQpXTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGNodW5rQXJyYXkoYXJyLCBzaXplKSB7CiAgY29uc3QgZm4gPSAoYSwgdiwgaSkgPT4gewogICAgY29uc3QgaiA9IGkgJSBzaXplOwogICAgaWYoaiA9PSAwKSBhLnB1c2goW10pOwogICAgYVthLmxlbmd0aCAtIDFdLnB1c2godik7CiAgICByZXR1cm4gYTsKICB9OwoKICByZXR1cm4gYXJyLnJlZHVjZShmbiwgW10pOwp9CgpleHBvcnQgZnVuY3Rpb24gdWNmaXJzdChzdHIpIHsKICBpZih0eXBlb2Ygc3RyICE9ICdzdHJpbmcnKSBzdHIgPSBzdHIgKyAnJzsKICByZXR1cm4gc3RyLnN1YnN0cmluZygwLCAxKS50b1VwcGVyQ2FzZSgpICsgc3RyLnN1YnN0cmluZygxKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGxjZmlyc3Qoc3RyKSB7CiAgaWYodHlwZW9mIHN0ciAhPSAnc3RyaW5nJykgc3RyID0gc3RyICsgJyc7CiAgcmV0dXJuIHN0ci5zdWJzdHJpbmcoMCwgMSkudG9Mb3dlckNhc2UoKSArIHN0ci5zdWJzdHJpbmcoMSk7Cn0KCmV4cG9ydCBmdW5jdGlvbiBjYW1lbGl6ZShzdHIsIGRlbGltID0gJycpIHsKICByZXR1cm4gc3RyLnJlcGxhY2UoL14oW0EtWl0pfFtccy1fXSsoXHcpL2csIChtYXRjaCwgcDEsIHAyLCBvZmZzZXQpID0+IHsKICAgIGlmKHAyKSByZXR1cm4gZGVsaW0gKyBwMi50b1VwcGVyQ2FzZSgpOwogICAgcmV0dXJuIHAxLnRvTG93ZXJDYXNlKCk7CiAgfSk7Cn0KCmV4cG9ydCBmdW5jdGlvbiBkZWNhbWVsaXplKHN0ciwgZGVsaW0gPSAnLScpIHsKICByZXR1cm4gLy5bQS1aXS8udGVzdChzdHIpCiAgICA/IHN0cgogICAgICAgIC5yZXBsYWNlKC8oW2EtelxkXSkoW0EtWl0pL2csICckMScgKyBkZWxpbSArICckMicpCiAgICAgICAgLnJlcGxhY2UoLyhbQS1aXSspKFtBLVpdW2EtelxkXSspL2csICckMScgKyBkZWxpbSArICckMicpCiAgICAgICAgLnRvTG93ZXJDYXNlKCkKICAgIDogc3RyOwp9CgpleHBvcnQgZnVuY3Rpb24gc2hvcnRlbihzdHIsIG1heCA9IDQwLCBzdWZmaXggPSAnLi4uJykgewogIG1heCA9ICttYXg7CiAgaWYoaXNOYU4obWF4KSkgbWF4ID0gSW5maW5pdHk7CiAgaWYoQXJyYXkuaXNBcnJheShzdHIpKSByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoc3RyLCAwLCBNYXRoLm1pbihzdHIubGVuZ3RoLCBtYXgpKS5jb25jYXQoW3N1ZmZpeF0pOwogIGlmKHR5cGVvZiBzdHIgIT0gJ3N0cmluZycgfHwgIU51bWJlci5pc0Zpbml0ZShtYXgpIHx8IG1heCA8IDApIHJldHVybiBzdHI7CiAgc3RyID0gJycgKyBzdHI7CgogIGlmKHN0ci5sZW5ndGggPiBtYXgpIHsKICAgIGxldCBuID0gTWF0aC5mbG9vcigobWF4IC0gKDIgKyBzdWZmaXgubGVuZ3RoKSkgLyAyKTsKICAgIGxldCB0YWlsID0gc3RyLmxlbmd0aCAtIG47CiAgICBsZXQgbGVuID0gTWF0aC5taW4obiwgdGFpbCk7CiAgICBsZXQgaW5zZXJ0ID0gJyAnICsgc3VmZml4ICsgJyAnICsgKHN0ci5sZW5ndGggLSAobGVuICsgbikpICsgJyBieXRlcyAnICsgc3VmZml4ICsgJyAnOwoKICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKDAsIGxlbikgKyBpbnNlcnQgKyBzdHIuc3Vic3RyaW5nKHRhaWwpOwogIH0KICByZXR1cm4gc3RyOwp9CgpleHBvcnQgZnVuY3Rpb24gYXJyYXlzSW5Db21tb24oYSkgewogIGxldCBpLAogICAgYywKICAgIG4gPSBhLmxlbmd0aCwKICAgIG1pbiA9IEluZmluaXR5OwogIHdoaWxlKG4pIHsKICAgIGlmKGFbLS1uXS5sZW5ndGggPCBtaW4pIHsKICAgICAgbWluID0gYVtuXS5sZW5ndGg7CiAgICAgIGkgPSBuOwogICAgfQogIH0KICBjID0gQXJyYXkuZnJvbShhLnNwbGljZShpLCAxKVswXSk7CiAgcmV0dXJuIGMuZmlsdGVyKChpdG0sIGluZHgpID0+IHsKICAgIGlmKGMuaW5kZXhPZihpdG0pID09IGluZHgpIHJldHVybiBhLmV2ZXJ5KGFyciA9PiBhcnIuaW5kZXhPZihpdG0pICE9IC0xKTsKICB9KTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGFycmF5RmFjYWRlKHByb3RvLCBpdGVtRm4gPSAoY29udGFpbmVyLCBpKSA9PiBjb250YWluZXIuYXQoaSkpIHsKICByZXR1cm4gZGVmaW5lKHByb3RvLCB7CiAgICAqW1N5bWJvbC5pdGVyYXRvcl0oKSB7CiAgICAgIGNvbnN0IHsgbGVuZ3RoIH0gPSB0aGlzOwogICAgICBmb3IobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHlpZWxkIGl0ZW1Gbih0aGlzLCBpKTsKICAgIH0sCiAgICAqa2V5cygpIHsKICAgICAgY29uc3QgeyBsZW5ndGggfSA9IHRoaXM7CiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgeWllbGQgaTsKICAgIH0sCiAgICAqZW50cmllcygpIHsKICAgICAgY29uc3QgeyBsZW5ndGggfSA9IHRoaXM7CiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgeWllbGQgW2ksIGl0ZW1Gbih0aGlzLCBpKV07CiAgICB9LAogICAgKnZhbHVlcygpIHsKICAgICAgY29uc3QgeyBsZW5ndGggfSA9IHRoaXM7CiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgeWllbGQgaXRlbUZuKHRoaXMsIGkpOwogICAgfSwKICAgIGZvckVhY2goY2FsbGJhY2ssIHRoaXNBcmcpIHsKICAgICAgY29uc3QgeyBsZW5ndGggfSA9IHRoaXM7CiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgY2FsbGJhY2suY2FsbCh0aGlzQXJnLCBpdGVtRm4odGhpcywgaSksIGksIHRoaXMpOwogICAgfSwKICAgIHJlZHVjZShjYWxsYmFjaywgYWNjdSwgdGhpc0FyZykgewogICAgICBjb25zdCB7IGxlbmd0aCB9ID0gdGhpczsKICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSBhY2N1ID0gY2FsbGJhY2suY2FsbCh0aGlzQXJnLCBhY2N1LCBpdGVtRm4odGhpcywgaSksIGksIHRoaXMpOwogICAgICByZXR1cm4gYWNjdTsKICAgIH0KICB9KTsKfQoKZXhwb3J0IGZ1bmN0aW9uIG1vZChhLCBiKSB7CiAgcmV0dXJuIHR5cGVvZiBiID09ICdudW1iZXInID8gKChhICUgYikgKyBiKSAlIGIgOiBuID0+ICgobiAlIGEpICsgYSkgJSBhOwp9CgpleHBvcnQgZnVuY3Rpb24gcHVzaFVuaXF1ZShhcnIsIC4uLmFyZ3MpIHsKICBsZXQgcmVqZWN0ID0gW107CiAgZm9yKGxldCBhcmcgb2YgYXJncykKICAgIGlmKGFyci5pbmRleE9mKGFyZykgPT0gLTEpIGFyci5wdXNoKGFyZyk7CiAgICBlbHNlIHJlamVjdC5wdXNoKGFyZyk7CiAgcmV0dXJuIHJlamVjdDsKfQoKZXhwb3J0IGZ1bmN0aW9uIGludGVyc2VjdChhLCBiKSB7CiAgaWYoIUFycmF5LmlzQXJyYXkoYSkpIGEgPSBbLi4uYV07CiAgcmV0dXJuIGEuZmlsdGVyKFNldC5wcm90b3R5cGUuaGFzLCBuZXcgU2V0KGIpKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIHN5bW1ldHJpY0RpZmZlcmVuY2UoYSwgYikgewogIHJldHVybiBbXS5jb25jYXQoLi4uZGlmZmVyZW5jZShhLCBiKSk7Cn0KCmV4cG9ydCBmdW5jdGlvbiogcGFydGl0aW9uQXJyYXkoYSwgc2l6ZSkgewogIGZvcihsZXQgaSA9IDA7IGkgPCBhLmxlbmd0aDsgaSArPSBzaXplKSB5aWVsZCBhLnNsaWNlKGksIGkgKyBzaXplKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGRpZmZlcmVuY2UoYSwgYiwgaW5jbHVkZXMpIHsKICBpZighQXJyYXkuaXNBcnJheShhKSkgYSA9IFsuLi5hXTsKICBpZighQXJyYXkuaXNBcnJheShiKSkgYiA9IFsuLi5iXTsKCiAgaWYodHlwZW9mIGluY2x1ZGVzICE9ICdmdW5jdGlvbicpIHJldHVybiBbYS5maWx0ZXIoeCA9PiAhYi5pbmNsdWRlcyh4KSksIGIuZmlsdGVyKHggPT4gIWEuaW5jbHVkZXMoeCkpXTsKCiAgcmV0dXJuIFthLmZpbHRlcih4ID0+ICFpbmNsdWRlcyhiLCB4KSksIGIuZmlsdGVyKHggPT4gIWluY2x1ZGVzKGEsIHgpKV07Cn0KCmV4cG9ydCBmdW5jdGlvbiBpbnRlcnNlY3Rpb24oYSwgYikgewogIGlmKCEoYSBpbnN0YW5jZW9mIFNldCkpIGEgPSBuZXcgU2V0KGEpOwogIGlmKCEoYiBpbnN0YW5jZW9mIFNldCkpIGIgPSBuZXcgU2V0KGIpOwogIGxldCBpbnRlcnNlY3Rpb24gPSBuZXcgU2V0KFsuLi5hXS5maWx0ZXIoeCA9PiBiLmhhcyh4KSkpOwogIHJldHVybiBBcnJheS5mcm9tKGludGVyc2VjdGlvbik7Cn0KCmV4cG9ydCBmdW5jdGlvbiB1bmlvbihhLCBiLCBlcXVhbGl0eSkgewogIGlmKGVxdWFsaXR5ID09PSB1bmRlZmluZWQpIHJldHVybiBbLi4ubmV3IFNldChbLi4uYSwgLi4uYl0pXTsKCiAgcmV0dXJuIHVuaXF1ZShbLi4uYSwgLi4uYl0sIGVxdWFsaXR5KTsKfQoKLyoqCiAqIGFjY2VwdHMgYXJyYXkgYW5kIGZ1bmN0aW9uIHJldHVybmluZyBgdHJ1ZWAgb3IgYGZhbHNlYCBmb3IgZWFjaCBlbGVtZW50CiAqCiAqIEBwYXJhbSAge1t0eXBlXX0gICBhcnJheSAgICBbZGVzY3JpcHRpb25dCiAqIEBwYXJhbSAge0Z1bmN0aW9ufSBjYWxsYmFjayBbZGVzY3JpcHRpb25dCiAqIEByZXR1cm4ge1t0eXBlXX0gICAgICAgICAgICBbZGVzY3JpcHRpb25dCiAqLwpleHBvcnQgZnVuY3Rpb24gcGFydGl0aW9uKGFycmF5LCBjYWxsYmFjaykgewogIGNvbnN0IG1hdGNoZXMgPSBbXSwKICAgIG5vbk1hdGNoZXMgPSBbXTsKCiAgLy8gcHVzaCBlYWNoIGVsZW1lbnQgaW50byBhcnJheSBkZXBlbmRpbmcgb24gcmV0dXJuIHZhbHVlIG9mIGBjYWxsYmFja2AKICBmb3IobGV0IGVsZW1lbnQgb2YgYXJyYXkpIChjYWxsYmFjayhlbGVtZW50KSA/IG1hdGNoZXMgOiBub25NYXRjaGVzKS5wdXNoKGVsZW1lbnQpOwoKICByZXR1cm4gW21hdGNoZXMsIG5vbk1hdGNoZXNdOwp9CgpleHBvcnQgZnVuY3Rpb24gTG9jYXRpb24obGluZSwgY29sdW1uLCBwb3MsIGZpbGUsIGZyZWV6ZSA9IHRydWUpIHsKICBsZXQgb2JqID0gdGhpcyB8fCBuZXcudGFyZ2V0LnRlc3QgfHwgdGhpcyA/IHRoaXMgOiB7fTsKCiAgLypjb25zb2xlLmxvZygib2JqLmNvbnN0cnVjdG9yOiIsb2JqLmNvbnN0cnVjdG9yKTsKICAvL2NvbnNvbGUubG9nKCJmcmVlemU6IixmcmVlemUpOyovCiAgT2JqZWN0LmFzc2lnbihvYmosIHsKICAgIGxpbmUsCiAgICBjb2x1bW4sCiAgICBwb3MsCiAgICBmaWxlCiAgfSk7CiAgaWYodGhpcyAhPT0gb2JqKSBPYmplY3Quc2V0UHJvdG90eXBlT2Yob2JqLCBMb2NhdGlvbi5wcm90b3R5cGUpOwoKICByZXR1cm4gZnJlZXplICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gTG9jYXRpb24gPyBPYmplY3QuZnJlZXplKG9iaikgOiBvYmo7Cn0KCmV4cG9ydCBmdW5jdGlvbiBmb3JtYXQoLi4uYXJncykgewogIHJldHVybiBmb3JtYXRXaXRoT3B0aW9uc0ludGVybmFsKHsgaGlkZUtleXM6IFsnY29uc3RydWN0b3InXSB9LCBhcmdzKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFdpdGhPcHRpb25zKG9wdHMsIC4uLmFyZ3MpIHsKICBpZighaXNPYmplY3Qob3B0cykpIHRocm93IG5ldyBUeXBlRXJyb3IoYG9wdGlvbnMgYXJndW1lbnQgaXMgbm90IGFuIG9iamVjdGApOwogIHJldHVybiBmb3JtYXRXaXRoT3B0aW9uc0ludGVybmFsKG9wdHMsIGFyZ3MpOwp9CgpmdW5jdGlvbiBmb3JtYXRXaXRoT3B0aW9uc0ludGVybmFsKG8sIHYpIHsKICBjb25zdCB4ID0gdlswXTsKICBsZXQgYSA9IDA7CiAgbGV0IHMgPSAnJzsKICBsZXQgaiA9ICcnOwogIGlmKHR5cGVvZiB4ID09PSAnc3RyaW5nJykgewogICAgaWYodi5sZW5ndGggPT09IDEpIHJldHVybiB4OwogICAgbGV0IHQ7CiAgICBsZXQgcCA9IDA7CiAgICBmb3IobGV0IGkgPSAwOyBpIDwgeC5sZW5ndGggLSAxOyBpKyspIHsKICAgICAgaWYoeFtpXSA9PSAnJScpIHsKICAgICAgICBsZXQgZiA9ICcnOwogICAgICAgIHdoaWxlKCdzanhkT29pZmMlJy5pbmRleE9mKHhbaSArIDFdKSA9PSAtMSkgewogICAgICAgICAgZiArPSB4W2kgKyAxXTsKICAgICAgICAgICsraTsKICAgICAgICB9CiAgICAgICAgaWYocCA8IGkpIHMgKz0gc2xpY2UoeCwgcCwgaSk7CiAgICAgICAgcCA9IGkgKyAxOwoKICAgICAgICBjb25zdCBjID0gU3RyaW5nLnByb3RvdHlwZS5jaGFyQ29kZUF0LmNhbGwoeCwgKytpKTsKICAgICAgICBpZihhICsgMSAhPT0gdi5sZW5ndGgpIHsKICAgICAgICAgIHN3aXRjaCAoYykgewogICAgICAgICAgICBjYXNlIDExNTogLy8gJXMKICAgICAgICAgICAgICBjb25zdCB5ID0gdlsrK2FdOwogICAgICAgICAgICAgIGlmKHR5cGVvZiB5ID09PSAnbnVtYmVyJykgdCA9IGZvcm1hdE51bWJlcih5KTsKICAgICAgICAgICAgICBlbHNlIGlmKHR5cGVvZiB5ID09PSAnYmlnaW50JykgdCA9IGAke3l9bmA7CiAgICAgICAgICAgICAgZWxzZSBpZih0eXBlb2YgeSAhPT0gJ29iamVjdCcgfHwgeSA9PT0gbnVsbCB8fCAhaGFzQnVpbHRJbih5LCAndG9TdHJpbmcnKSkgdCA9IFN0cmluZyh5KTsKICAgICAgICAgICAgICBlbHNlIHQgPSBpbnNwZWN0KHksIHsgLi4ubywgY29tcGFjdDogMywgY29sb3JzOiBmYWxzZSwgZGVwdGg6IDAgfSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMTA2OiAvLyAlagogICAgICAgICAgICAgIHQgPSBzdHJpbmdpZnkodlsrK2FdKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxMjA6IC8vICV4CiAgICAgICAgICAgIGNhc2UgMTAwOiAvLyAlZAogICAgICAgICAgICAgIGNvbnN0IG4gPSB2WysrYV07CiAgICAgICAgICAgICAgaWYodHlwZW9mIG4gPT09ICdiaWdpbnQnKSB0ID0gYCR7bn1uYDsKICAgICAgICAgICAgICBlbHNlIGlmKHR5cGVvZiBuID09PSAnc3ltYm9sJykgdCA9ICdOYU4nOwogICAgICAgICAgICAgIGVsc2UgdCA9IGZvcm1hdE51bWJlcihjID09IDEyMCA/IE51bWJlcihuKS50b1N0cmluZygxNikgOiBOdW1iZXIobikpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDc5OiAvLyAlTwogICAgICAgICAgICAgIHQgPSBpbnNwZWN0KHZbKythXSwgbyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMTExOiAvLyAlbwogICAgICAgICAgICAgIHQgPSAvKnZbKythXSsnJyA/PyAqLyBpbnNwZWN0KHZbKythXSwgewogICAgICAgICAgICAgICAgLi4ubywKICAgICAgICAgICAgICAgIHNob3dIaWRkZW46IHRydWUsCiAgICAgICAgICAgICAgICBzaG93UHJveHk6IHRydWUsCiAgICAgICAgICAgICAgICBkZXB0aDogMSwKICAgICAgICAgICAgICAgIHByb3RvQ2hhaW46IGZhbHNlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMTA1OiAvLyAlaQogICAgICAgICAgICAgIGNvbnN0IGsgPSB2WysrYV07CiAgICAgICAgICAgICAgaWYodHlwZW9mIGsgPT09ICdiaWdpbnQnKSB0ID0gYCR7a31gOwogICAgICAgICAgICAgIGVsc2UgaWYodHlwZW9mIGsgPT09ICdzeW1ib2wnKSB0ID0gJ05hTic7CiAgICAgICAgICAgICAgZWxzZSB0ID0gZm9ybWF0TnVtYmVyKHBhcnNlSW50KGspKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxMDI6IC8vICVmCiAgICAgICAgICAgICAgY29uc3QgZCA9IHZbKythXTsKICAgICAgICAgICAgICBpZih0eXBlb2YgZCA9PT0gJ3N5bWJvbCcpIHQgPSAnTmFOJzsKICAgICAgICAgICAgICBlbHNlIHQgPSBmb3JtYXROdW1iZXIocGFyc2VGbG9hdChkKSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgOTk6IC8vICVjCiAgICAgICAgICAgICAgYSArPSAxOwogICAgICAgICAgICAgIHQgPSAnJzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAzNzogLy8gJSUKICAgICAgICAgICAgICBzICs9IHNsaWNlKHgsIHAsIGkpOwogICAgICAgICAgICAgIHAgPSBpICsgMTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICAgIGlmKHAgIT09IGkgLSAxKSBzICs9IHNsaWNlKHgsIHAsIGkgLSAxKTsKICAgICAgICAgIGxldCBwYWQgPSBwYXJzZUludChmKTsKICAgICAgICAgIGlmKE1hdGguYWJzKHBhZCkgPiAwKSB0ID0gdFsncGFkJyArIChwYWQgPCAwID8gJ0VuZCcgOiAnU3RhcnQnKV0oTWF0aC5hYnMocGFkKSwgL14tPzAvLnRlc3QoZikgPyAnMCcgOiAnICcpOwogICAgICAgICAgcyArPSB0OwogICAgICAgICAgcCA9IGkgKyAxOwogICAgICAgIH0gZWxzZSBpZihjID09PSAzNykgewogICAgICAgICAgcyArPSBzbGljZSh4LCBwLCBpKTsKICAgICAgICAgIHAgPSBpICsgMTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIGlmKHAgIT09IDApIHsKICAgICAgYSsrOwogICAgICBqID0gJyAnOwogICAgICBpZihwIDwgeC5sZW5ndGgpIHMgKz0gc2xpY2UoeCwgcCk7CiAgICB9CiAgfQogIHdoaWxlKGEgPCB2Lmxlbmd0aCkgewogICAgY29uc3QgeSA9IHZbYV07CiAgICBzICs9IGo7CiAgICBzICs9IHR5cGVvZiB5ICE9PSAnc3RyaW5nJyA/IGluc3BlY3QoeSwgbykgOiB5OwogICAgaiA9ICcgJzsKICAgIGErKzsKICB9CiAgcmV0dXJuIHM7Cn0KCmV4cG9ydCBmdW5jdGlvbiBpc051bWVyaWModmFsdWUpIHsKICBmb3IobGV0IGYgb2YgW3YgPT4gK3YsIHBhcnNlSW50LCBwYXJzZUZsb2F0XSkgaWYoIWlzTmFOKGYodmFsdWUpKSkgcmV0dXJuIHRydWU7CiAgcmV0dXJuIGZhbHNlOwp9CgpleHBvcnQgZnVuY3Rpb24gZnVuY3Rpb25OYW1lKGZuKSB7CiAgaWYodHlwZW9mIGZuID09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGZuLm5hbWUgPT0gJ3N0cmluZycpIHJldHVybiBmbi5uYW1lOwogIHRyeSB7CiAgICBjb25zdCBtYXRjaGVzID0gL2Z1bmN0aW9uXHMqKFteKF0qKVwoLiovZy5leGVjKGZuICsgJycpOwogICAgaWYobWF0Y2hlcyAmJiBtYXRjaGVzWzFdKSByZXR1cm4gbWF0Y2hlc1sxXTsKICB9IGNhdGNoIHt9CiAgcmV0dXJuIG51bGw7Cn0KCmV4cG9ydCBmdW5jdGlvbiBjbGFzc05hbWUob2JqKSB7CiAgaWYoaXNPYmplY3Qob2JqKSkgewogICAgaWYoJ2NvbnN0cnVjdG9yJyBpbiBvYmopIHJldHVybiBmdW5jdGlvbk5hbWUob2JqLmNvbnN0cnVjdG9yKTsKICAgIGlmKFN5bWJvbC50b1N0cmluZ1RhZyBpbiBvYmopIHJldHVybiBvYmpbU3ltYm9sLnRvU3RyaW5nVGFnXTsKICB9CiAgcmV0dXJuIG51bGw7Cn0KCmV4cG9ydCBjb25zdCBpc0Fycm93RnVuY3Rpb24gPSBmbiA9PgogIChpc0Z1bmN0aW9uKGZuKSAmJiAhKCdwcm90b3R5cGUnIGluIGZuKSkgfHwgL1wgPT5cIC8udGVzdCgoJycgKyBmbikucmVwbGFjZSgvXG4uKi9nLCAnJykpOwoKZXhwb3J0IGZ1bmN0aW9uIGltbXV0YWJsZUNsYXNzKG9yaWcsIC4uLnByb3RvKSB7CiAgbGV0IG5hbWUgPSBmdW5jdGlvbk5hbWUob3JpZykucmVwbGFjZSgvTXV0YWJsZS9nLCAnJyk7CiAgbGV0IGltTmFtZSA9ICdJbW11dGFibGUnICsgbmFtZTsKICBwcm90byA9IHByb3RvIHx8IFtdOwogIGxldCBpbml0aWFsUHJvdG8gPSBwcm90by5tYXAocCA9PgogICAgaXNBcnJvd0Z1bmN0aW9uKHApCiAgICAgID8gcAogICAgICA6IGN0b3IgPT4gewogICAgICAgICAgZm9yKGxldCBuIGluIHApIGN0b3IucHJvdG90eXBlW25dID0gcFtuXTsKICAgICAgICB9CiAgKTsKICBsZXQgYm9keSA9IGBjbGFzcyAke2ltTmFtZX0gZXh0ZW5kcyAke25hbWV9IHtcbiAgY29uc3RydWN0b3IoLi4uYXJncykge1xuICAgIHN1cGVyKC4uLmFyZ3MpO1xuICAgIGlmKG5ldy50YXJnZXQgPT09ICR7aW1OYW1lfSlcbiAgICAgIHJldHVybiBPYmplY3QuZnJlZXplKHRoaXMpO1xuICB9XG59O1xuXG4ke2ltTmFtZX0ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gJHtpbU5hbWV9O1xuXG5yZXR1cm4gJHtpbU5hbWV9O2A7CiAgZm9yKGxldCBwIG9mIGluaXRpYWxQcm90bykgcChvcmlnKTsKICBsZXQgY3RvcjsgLy8gPSBuZXcgRnVuY3Rpb24obmFtZSwgYm9keSkob3JpZyk7CgogIGxldCBpbW0gPSBiYXNlID0+IHsKICAgIGxldCBjbHM7CiAgICBjbHMgPSBjbGFzcyBleHRlbmRzIGJhc2UgewogICAgICBjb25zdHJ1Y3RvciguLi5hcmdzKSB7CiAgICAgICAgc3VwZXIoLi4uYXJncyk7CiAgICAgICAgaWYobmV3LnRhcmdldCA9PT0gY2xzKSByZXR1cm4gT2JqZWN0LmZyZWV6ZSh0aGlzKTsKICAgICAgfQogICAgfTsKICAgIHJldHVybiBjbHM7CiAgfTsKICBjdG9yID0gaW1tKG9yaWcpOwogIGxldCBzcGVjaWVzID0gY3RvcjsKICByZXR1cm4gY3RvcjsKfQoKZXhwb3J0IGNvbnN0IGlzQXJyYXkgPSBhID0+IEFycmF5LmlzQXJyYXkoYSk7CgpleHBvcnQgY2xhc3MgQXJyYXlGYWNhZGUgewogICpbU3ltYm9sLml0ZXJhdG9yXSgpIHsKICAgIGNvbnN0IHsgbGVuZ3RoIH0gPSB0aGlzOwogICAgZm9yKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB5aWVsZCBpdGVtRm4odGhpcywgaSk7CiAgfQogICprZXlzKCkgewogICAgY29uc3QgeyBsZW5ndGggfSA9IHRoaXM7CiAgICBmb3IobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHlpZWxkIGk7CiAgfQogICplbnRyaWVzKCkgewogICAgY29uc3QgeyBsZW5ndGggfSA9IHRoaXM7CiAgICBmb3IobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHlpZWxkIFtpLCBpdGVtRm4odGhpcywgaSldOwogIH0KICAqdmFsdWVzKCkgewogICAgY29uc3QgeyBsZW5ndGggfSA9IHRoaXM7CiAgICBmb3IobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHlpZWxkIGl0ZW1Gbih0aGlzLCBpKTsKICB9CiAgZm9yRWFjaChjYWxsYmFjaywgdGhpc0FyZykgewogICAgY29uc3QgeyBsZW5ndGggfSA9IHRoaXM7CiAgICBmb3IobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIGNhbGxiYWNrLmNhbGwodGhpc0FyZywgaXRlbUZuKHRoaXMsIGkpLCBpLCB0aGlzKTsKICB9CiAgcmVkdWNlKGNhbGxiYWNrLCBhY2N1LCB0aGlzQXJnKSB7CiAgICBjb25zdCB7IGxlbmd0aCB9ID0gdGhpczsKICAgIGZvcihsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgYWNjdSA9IGNhbGxiYWNrLmNhbGwodGhpc0FyZywgYWNjdSwgaXRlbUZuKHRoaXMsIGkpLCBpLCB0aGlzKTsKICAgIHJldHVybiBhY2N1OwogIH0KfQoKLypleHBvcnQgZnVuY3Rpb24gYXJyYXlGYWNhZGUocHJvdG8sIGl0ZW1GbiA9IChjb250YWluZXIsIGkpID0+IGNvbnRhaW5lci5hdChpKSkgewogIHJldHVybiBkZWZpbmUocHJvdG8sIEFycmF5RmFjYWRlLnByb3RvdHlwZSk7Cn0qLwoKZXhwb3J0IGZ1bmN0aW9uIGJpdHMoYnVmZmVyKSB7CiAgbGV0IGEgPSBuZXcgVWludDhBcnJheShidWZmZXIpOwogIGxldCBiaXQsCiAgICBiaXRzID0gYnVmZmVyLmJ5dGVMZW5ndGggPDwgMzsKICBsZXQgcmV0ID0gW107CiAgZm9yKGJpdCA9IDA7IGJpdCA8IGJpdHM7IGJpdCsrKSB7CiAgICBsZXQgc2hpZnQgPSBiaXQgJiAweDc7CiAgICBsZXQgYnBvcyA9IGJpdCA+PiAzOwoKICAgIHJldC5wdXNoKGFbYml0ID4+IDNdICYgKDEgPDwgc2hpZnQpID8gMSA6IDApOwogIH0KICByZXR1cm4gcmV0Owp9CgpleHBvcnQgZnVuY3Rpb24gZHVwQXJyYXlCdWZmZXIoYnVmLCBzdGFydCwgbGVuZ3RoKSB7CiAgbGV0IGEgPSBuZXcgVWludDhBcnJheShidWYsIHN0YXJ0LCBsZW5ndGgpOwogIHJldHVybiBuZXcgVWludDhBcnJheShbLi4uYV0pOwp9CmV4cG9ydCBmdW5jdGlvbiBnZXRUeXBlTmFtZSh2KSB7CiAgcmV0dXJuIHR5cGVvZiB2Owp9CmV4cG9ydCBmdW5jdGlvbiBpc0FycmF5QnVmZmVyKGJ1ZikgewogIHJldHVybiBpc09iamVjdChidWYpICYmIGJ1ZiBpbnN0YW5jZW9mIEFycmF5QnVmZmVyOwp9CgpleHBvcnQgZnVuY3Rpb24gaXNCaWdEZWNpbWFsKG51bSkgewogIHJldHVybiB0eXBlb2YgbnVtID09ICdiaWdkZWNpbWFsJyB8fCBudW1bU3ltYm9sLnRvU3RyaW5nVGFnXSA9PSAnQmlnRGVjaW1hbCc7Cn0KCmV4cG9ydCBmdW5jdGlvbiBpc0JpZ0Zsb2F0KG51bSkgewogIHJldHVybiB0eXBlb2YgbnVtID09ICdiaWdmbG9hdCcgfHwgbnVtW1N5bWJvbC50b1N0cmluZ1RhZ10gPT0gJ0JpZ0Zsb2F0JzsKfQoKZXhwb3J0IGZ1bmN0aW9uIGlzQmlnSW50KG51bSkgewogIHJldHVybiB0eXBlb2YgbnVtID09ICdiaWdpbnQnIHx8IG51bVtTeW1ib2wudG9TdHJpbmdUYWddID09ICdpc0JpZ0ludCc7Cn0KCmV4cG9ydCBmdW5jdGlvbiBpc0Jvb2wodmFsdWUpIHsKICByZXR1cm4gdHlwZW9mIHZhbHVlID09ICdib29sZWFuJzsKfQoKZXhwb3J0IGZ1bmN0aW9uIGlzQ0Z1bmN0aW9uKGZuKSB7CiAgcmV0dXJuIGZhbHNlOwp9CgpleHBvcnQgZnVuY3Rpb24gaXNDb25zdHJ1Y3RvcihmbikgewogIHJldHVybiB0eXBlb2YgZm4gPT0gJ2Z1bmN0aW9uJyAmJiAncHJvdG90eXBlJyBpbiBmbjsKfQoKZXhwb3J0IGZ1bmN0aW9uIGlzRW1wdHlTdHJpbmcodmFsdWUpIHsKICByZXR1cm4gdmFsdWUgPT09ICcnOwp9CgpleHBvcnQgZnVuY3Rpb24gaXNFcnJvcih2YWx1ZSkgewogIHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIEVycm9yIHx8IHZhbHVlW1N5bWJvbC50b1N0cmluZ1RhZ10uZW5kc1dpdGgoJ0Vycm9yJyk7Cn0KCmV4cG9ydCBmdW5jdGlvbiBpc0V4Y2VwdGlvbih2YWx1ZSkgewogIHJldHVybiBmYWxzZTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGlzRXh0ZW5zaWJsZSh2YWx1ZSkgewogIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwgJiYgT2JqZWN0LmlzRXh0ZW5zaWJsZSh2YWx1ZSk7Cn0KCmV4cG9ydCBmdW5jdGlvbiBpc0Z1bmN0aW9uKHZhbHVlKSB7CiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnZnVuY3Rpb24nOwp9CgpleHBvcnQgZnVuY3Rpb24gaXNIVE1MRERBKHZhbHVlKSB7CiAgcmV0dXJuIGZhbHNlOwp9CgpleHBvcnQgZnVuY3Rpb24gaXNJbnN0YW5jZU9mKHZhbHVlLCBjdG9yKSB7CiAgaWYoY3RvcltTeW1ib2wuaGFzSW5zdGFuY2VdKSB7CiAgICByZXR1cm4gY3RvcltTeW1ib2wuaGFzSW5zdGFuY2VdKHZhbHVlKTsKICB9CiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnb2JqZWN0JyAmJiB2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSBpbnN0YW5jZW9mIGN0b3I7Cn0KCmV4cG9ydCBmdW5jdGlvbiBpc0ludGVnZXIodmFsdWUpIHsKICByZXR1cm4gTWF0aC5hYnModmFsdWUpICUgMSA9PSAwOwp9CgpleHBvcnQgZnVuY3Rpb24gaXNKb2JQZW5kaW5nKGlkKSB7CiAgcmV0dXJuIGZhbHNlOwp9CgpleHBvcnQgZnVuY3Rpb24gaXNMaXZlT2JqZWN0KG9iaikgewogIHJldHVybiB0cnVlOwp9CgpleHBvcnQgZnVuY3Rpb24gaXNOdWxsKHZhbHVlKSB7CiAgcmV0dXJuIHZhbHVlID09PSBudWxsOwp9CgpleHBvcnQgZnVuY3Rpb24gaXNOdW1iZXIodmFsdWUpIHsKICByZXR1cm4gdHlwZW9mIHZhbHVlID09ICdudW1iZXInOwp9CmV4cG9ydCBmdW5jdGlvbiBpc1VuZGVmaW5lZCh2YWx1ZSkgewogIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ3VuZGVmaW5lZCc7Cn0KCmV4cG9ydCBmdW5jdGlvbiBpc1N0cmluZyh2YWx1ZSkgewogIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ3N0cmluZyc7Cn0KZXhwb3J0IGZ1bmN0aW9uIGlzVW5pbml0aWFsaXplZCh2YWx1ZSkgewogIHJldHVybiBmYWxzZTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGlzU3ltYm9sKHZhbHVlKSB7CiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnc3ltYm9sJyB8fCB2YWx1ZVtTeW1ib2wudG9TdHJpbmdUYWddID09ICdTeW1ib2wnOwp9CgpleHBvcnQgZnVuY3Rpb24gaXNVbmNhdGNoYWJsZUVycm9yKHZhbHVlKSB7CiAgcmV0dXJuIGZhbHNlOwp9CgpleHBvcnQgZnVuY3Rpb24gaXNSZWdpc3RlcmVkQ2xhc3MoaWQpIHsKICByZXR1cm4gZmFsc2U7Cn0KZXhwb3J0IGZ1bmN0aW9uIHJhbmQoKSB7CiAgcmV0dXJuIE1hdGgucmFuZG9tKCkgKiAyICoqIDMyOwp9CgpleHBvcnQgZnVuY3Rpb24gcmFuZGkoKSB7CiAgcmV0dXJuIHJhbmQoKSAtIDIgKiogMzE7Cn0KCmV4cG9ydCBmdW5jdGlvbiByYW5kZigpIHsKICByZXR1cm4gTWF0aC5yYW5kb20oKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIHNyYW5kKHNlZWQpIHt9CgpleHBvcnQgZnVuY3Rpb24gdG9BcnJheUJ1ZmZlcih2YWx1ZSkgewogIGlmKHR5cGVvZiB2YWx1ZSA9PSAnb2JqZWN0JyAmJiB2YWx1ZSAhPT0gbnVsbCAmJiAnYnVmZmVyJyBpbiB2YWx1ZSAmJiBpc0FycmF5QnVmZmVyKHZhbHVlLmJ1ZmZlcikpCiAgICByZXR1cm4gdmFsdWUuYnVmZmVyOwoKICBpZih0eXBlb2YgdmFsdWUgPT0gJ3N0cmluZycpIHsKICAgIGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTsKICAgIGNvbnN0IHZpZXcgPSBlbmNvZGVyLmVuY29kZSh2YWx1ZSk7CiAgICByZXR1cm4gdmlldy5idWZmZXI7CiAgfQogIHJldHVybiB2YWx1ZTsKfQoKTG9jYXRpb24ucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24oZnJlZXplID0gZmFsc2UsIHdpdGhGaWxlbmFtZSA9IHRydWUpIHsKICBjb25zdCB7IGxpbmUsIGNvbHVtbiwgcG9zLCBmaWxlIH0gPSB0aGlzOwoKICByZXR1cm4gbmV3IExvY2F0aW9uKGxpbmUsIGNvbHVtbiwgcG9zLCB3aXRoRmlsZW5hbWUgPyBmaWxlIDogbnVsbCwgZnJlZXplKTsKfTsKTG9jYXRpb24ucHJvdG90eXBlW1N5bWJvbC50b1N0cmluZ1RhZ10gPSAnTG9jYXRpb24nOwoKLypmdW5jdGlvbihuLCBvcHRzKSB7CiAgY29uc3QgeyBzaG93RmlsZW5hbWUgPSB0cnVlLCBjb2xvcnMgPSBmYWxzZSB9ID0gb3B0cyB8fCB7fTsKICBsZXQgYyA9IFV0aWwuY29sb3JpbmcoY29sb3JzKTsKCiAgbGV0IHYgPQogICAgdHlwZW9mIHRoaXMuY29sdW1uID09ICdudW1iZXInID8gW3RoaXMuZmlsZSwgdGhpcy5saW5lLCB0aGlzLmNvbHVtbl0gOiBbdGhpcy5maWxlLCB0aGlzLmxpbmVdOwogIGlmKCghc2hvd0ZpbGVuYW1lIHx8IHZbMF0gPT0gdW5kZWZpbmVkKSAmJiB2Lmxlbmd0aCA+PSAzKSB2LnNoaWZ0KCk7CiAgdiA9IHYubWFwKChmLCBpKSA9PiBjLmNvZGUoLi4uKGkgPT0gMCA/IFszOCwgNSwgMzNdIHx8IFsxLCAzM10gOiBbMSwgIDM2XSkpICsgZik7CiAgcmV0dXJuIHYuam9pbihjLmNvZGUoLi4uKFsxLCAzMF0gfHwgWzEsIDM2XSkpICsgJzonKSArIGMuY29kZSgwKTsKfTsqLwoKTG9jYXRpb24ucHJvdG90eXBlW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiogKCkgewogIGxldCB7IGZpbGUsIGxpbmUsIGNvbHVtbiB9ID0gdGhpczsKICBsZXQgdiA9IGZpbGUgPyBbZmlsZSwgbGluZSwgY29sdW1uXSA6IFtsaW5lLCBjb2x1bW5dOwogIHlpZWxkKiB2Owp9OwpMb2NhdGlvbi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbihvcHRzID0ge30pIHsKICBjb25zdCB7IGxpbmUsIGNvbHVtbiwgZmlsZSB9ID0gdGhpczsKICByZXR1cm4gKGZpbGUgPyBmaWxlICsgJzonIDogJycpICsgbGluZSArICc6JyArIGNvbHVtbjsKfTsKTG9jYXRpb24ucHJvdG90eXBlLnZhbHVlT2YgPSBmdW5jdGlvbigpIHsKICByZXR1cm4gdGhpcy5wb3M7Cn07CkxvY2F0aW9uLnByb3RvdHlwZVtTeW1ib2wudG9QcmltaXRpdmVdID0gZnVuY3Rpb24oaGludCkgewogIGlmKGhpbnQgPT0gJ251bWJlcicpIHJldHVybiB0aGlzLnBvczsKICBpZihoaW50ID09ICdzdHJpbmcnKSByZXR1cm4gdGhpcy50b1N0cmluZygpOwp9OwpMb2NhdGlvbi5wcm90b3R5cGVbU3ltYm9sLmZvcignbm9kZWpzLnV0aWwuaW5zcGVjdC5jdXN0b20nKV0gPSBmdW5jdGlvbihuLCBvcHRzKSB7CiAgcmV0dXJuIHRoaXMudG9TdHJpbmcoeyBjb2xvcnM6IHRydWUgfSk7CiAgcmV0dXJuIGluc3BlY3QodGhpcywgewogICAgY29sb3JzOiB0cnVlLAogICAgLi4ub3B0cywKICAgIHRvU3RyaW5nOiBTeW1ib2wudG9TdHJpbmdUYWcKICB9KTsKfTsKLyoKTG9jYXRpb24ucHJvdG90eXBlLnZhbHVlT2YgPSBmdW5jdGlvbigpIHsKICByZXR1cm4gdGhpcy5wb3M7Cn07Ki8KCmRlZmluZShMb2NhdGlvbi5wcm90b3R5cGUsIHsKICAvKiBwcmV0dGllci1pZ25vcmUgKi8gZ2V0IG9mZnNldCgpIHsKICAgIHJldHVybiB0aGlzLnZhbHVlT2YoKTsKICB9Cn0pOwoAAAAAAAAAAGO7AAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACWbAAAAAAAAJ1sAAAAAAAAAAAAAAAA8L8"
				],
				[
					36,
					1,
					"insert",
					{
						"characters": "\nm"
					},
					"BgAAAFdrAAAAAAAAWGsAAAAAAAAAAAAAWGsAAAAAAABaawAAAAAAAAAAAABaawAAAAAAAFprAAAAAAAABAAAAG1pc2NYawAAAAAAAFhrAAAAAAAAAgAAACAgWGsAAAAAAABcawAAAAAAAAAAAABcawAAAAAAAF1rAAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABXawAAAAAAAFtrAAAAAAAAAAAAAAAA8L8"
				],
				[
					37,
					2,
					"left_delete",
					null,
					"AgAAAFxrAAAAAAAAXGsAAAAAAAABAAAAbVprAAAAAAAAWmsAAAAAAAACAAAAICA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABdawAAAAAAAF1rAAAAAAAAAAAAAAAA8L8"
				],
				[
					38,
					1,
					"right_delete",
					null,
					"AQAAAFprAAAAAAAAWmsAAAAAAAABAAAALg",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAABaawAAAAAAAFprAAAAAAAAAAAAAAAA8L8"
				],
				[
					42,
					1,
					"revert",
					null,
					"AwAAAAAAAAAAAAAAAAAAAAAAAABhuwAALy9pbXBvcnQgVXRpbCBmcm9tICcuL3V0aWwuanMnOwovL2V4cG9ydCB7IHR5cGVzIH0gZnJvbSAgJy4uL3F1aWNranMvcWpzLW1vZHVsZXMvbGliL3V0aWwuanMnOwoKY29uc3Qgc2xpY2UgPSAoeCwgcywgZSkgPT4KICB0eXBlb2YgeCA9PSAnb2JqZWN0JyA/IChpc0FycmF5QnVmZmVyKHgpID8gZHVwQXJyYXlCdWZmZXIoeCwgcywgZSkgOiBBcnJheS5pc0FycmF5KHgpID8gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoeCwgcywgZSkgOiB4LnNsaWNlKHMsIGUpKSA6IFN0cmluZy5wcm90b3R5cGUuc2xpY2UuY2FsbCh4LCBzLCBlKTsKY29uc3Qgc3RyaW5naWZ5ID0gdiA9PiBgJHt2fWA7CmNvbnN0IHByb3RvT2YgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Y7CmNvbnN0IGZvcm1hdE51bWJlciA9IG4gPT4gKG4gPT09IC0wID8gJy0wJyA6IGAke259YCk7CmNvbnN0IGlzTmF0aXZlID0gZm4gPT4gL1xbbmF0aXZlXHNjb2RlXF0vLnRlc3Qoc3RyaW5naWZ5KGZuKSk7CgovKmV4cG9ydCBkZWZhdWx0Ki8gZnVuY3Rpb24gdXRpbCgpIHsKICByZXR1cm4gdXRpbDsKfQoKdXRpbC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSB1dGlsOwoKY29uc3QgQXN5bmNGdW5jdGlvbiA9IGFzeW5jIGZ1bmN0aW9uIHgoKSB7fS5jb25zdHJ1Y3RvcjsKY29uc3QgR2VuZXJhdG9yRnVuY3Rpb24gPSBmdW5jdGlvbiogKCkge30uY29uc3RydWN0b3I7CmNvbnN0IEFzeW5jR2VuZXJhdG9yRnVuY3Rpb24gPSBhc3luYyBmdW5jdGlvbiogKCkge30uY29uc3RydWN0b3I7CmNvbnN0IFR5cGVkQXJyYXkgPSBwcm90b09mKHByb3RvT2YobmV3IFVpbnQxNkFycmF5KDEwKSkpLmNvbnN0cnVjdG9yOwoKY29uc3QgU2V0SXRlcmF0b3JQcm90b3R5cGUgPSBwcm90b09mKG5ldyBTZXQoKS52YWx1ZXMoKSk7CmNvbnN0IE1hcEl0ZXJhdG9yUHJvdG90eXBlID0gcHJvdG9PZihuZXcgTWFwKCkuZW50cmllcygpKTsKLy9jb25zdCBHZW5lcmF0b3JQcm90b3R5cGUgPSBwcm90b09mKChmdW5jdGlvbiogKCkge30pKCkpOwoKLy8gcHJldHRpZXItaWdub3JlCmV4cG9ydCBjb25zdCBlcnJvcnMgPSBbbnVsbCwgJ0VQRVJNJywgJ0VOT0VOVCcsICdFU1JDSCcsICdFSU5UUicsICdFSU8nLCAnRU5YSU8nLCAnRTJCSUcnLCAnRU5PRVhFQycsICdFQkFERicsICdFQ0hJTEQnLCAnRUFHQUlOJywgJ0VOT01FTScsICdFQUNDRVMnLCAnRUZBVUxUJywgJ0VOT1RCTEsnLCAnRUJVU1knLCAnRUVYSVNUJywgJ0VYREVWJywgJ0VOT0RFVicsICdFTk9URElSJywgJ0VJU0RJUicsICdFSU5WQUwnLCAnRU5GSUxFJywgJ0VNRklMRScsICdFTk9UVFknLCAnRVRYVEJTWScsICdFRkJJRycsICdFTk9TUEMnLCAnRVNQSVBFJywgJ0VST0ZTJywgJ0VNTElOSycsICdFUElQRScsICdFRE9NJywgJ0VSQU5HRScsICdFREVBRExLJywgJ0VOQU1FVE9PTE9ORycsICdFTk9MQ0snLCAnRU5PU1lTJywgJ0VOT1RFTVBUWScsIG51bGwsIG51bGwsICdFTk9NU0cnLCAnRUlEUk0nLCAnRUNIUk5HJywgJ0VMMk5TWU5DJywgJ0VMM0hMVCcsICdFTDNSU1QnLCAnRUxOUk5HJywgJ0VVTkFUQ0gnLCAnRU5PQ1NJJywgJ0VMMkhMVCcsICdFQkFERScsICdFQkFEUicsICdFWEZVTEwnLCAnRU5PQU5PJywgJ0VCQURSUUMnLCBudWxsLCAnJywgJ0VCRk9OVCcsICdFTk9TVFInLCAnRU5PREFUQScsICdFVElNRScsICdFTk9TUicsICdFTk9ORVQnLCAnRU5PUEtHJywgJ0VSRU1PVEUnLCAnRU5PTElOSycsICdFQURWJywgJ0VTUk1OVCcsICdFQ09NTScsICdFUFJPVE8nLCAnRU1VTFRJSE9QJywgJ0VET1RET1QnLCAnRUJBRE1TRycsICdFT1ZFUkZMT1cnLCAnRU5PVFVOSVEnLCAnRUJBREZEJywgJ0VSRU1DSEcnLCAnRUxJQkFDQycsICdFTElCQkFEJywgJ0VMSUJTQ04nLCAnRUxJQk1BWCcsICdFTElCRVhFQycsICdFSUxTRVEnLCAnRVJFU1RBUlQnLCAnRVNUUlBJUEUnLCAnRVVTRVJTJywgJ0VOT1RTT0NLJywgJ0VERVNUQUREUlJFUScsICdFTVNHU0laRScsICdFUFJPVE9UWVBFJywgJ0VOT1BST1RPT1BUJywgJ0VQUk9UT05PU1VQUE9SVCcsICdFU09DS1ROT1NVUFBPUlQnLCAnRU9QTk9UU1VQUCcsICdFUEZOT1NVUFBPUlQnLCAnRUFGTk9TVVBQT1JUJywgJ0VBRERSSU5VU0UnLCAnRUFERFJOT1RBVkFJTCcsICdFTkVURE9XTicsICdFTkVUVU5SRUFDSCcsICdFTkVUUkVTRVQnLCAnRUNPTk5BQk9SVEVEJywgJ0VDT05OUkVTRVQnLCAnRU5PQlVGUycsICdFSVNDT05OJywgJ0VOT1RDT05OJywgJ0VTSFVURE9XTicsICdFVE9PTUFOWVJFRlMnLCAnRVRJTUVET1VUJywgJ0VDT05OUkVGVVNFRCcsICdFSE9TVERPV04nLCAnRUhPU1RVTlJFQUNIJywgJ0VBTFJFQURZJywgJ0VJTlBST0dSRVNTJywgJ0VTVEFMRScsICdFVUNMRUFOJywgJ0VOT1ROQU0nLCAnRU5BVkFJTCcsICdFSVNOQU0nLCAnRVJFTU9URUlPJywgJ0VEUVVPVCcsICdFTk9NRURJVU0nLCAnRU1FRElVTVRZUEUnLCAnRUNBTkNFTEVEJywgJ0VOT0tFWScsICdFS0VZRVhQSVJFRCcsICdFS0VZUkVWT0tFRCcsICdFS0VZUkVKRUNURUQnLCAnRU9XTkVSREVBRCcsICdFTk9UUkVDT1ZFUkFCTEUnLCAnRVJGS0lMTCddOwoKZXhwb3J0IGNvbnN0IHR5cGVzID0gewogIGlzQW55QXJyYXlCdWZmZXIodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmICh2IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIgfHwgdiBpbnN0YW5jZW9mIFNoYXJlZEFycmF5QnVmZmVyKTsKICB9LAogIGlzQXJyYXlCdWZmZXIodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcjsKICB9LAogIGlzQmlnSW50NjRBcnJheSh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIEJpZ0ludDY0QXJyYXk7CiAgfSwKICBpc0JpZ1VpbnQ2NEFycmF5KHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgQmlnVWludDY0QXJyYXk7CiAgfSwKICBpc0RhdGUodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBEYXRlOwogIH0sCiAgaXNGbG9hdDMyQXJyYXkodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXk7CiAgfSwKICBpc0Zsb2F0NjRBcnJheSh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIEZsb2F0NjRBcnJheTsKICB9LAogIGlzSW50OEFycmF5KHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgSW50OEFycmF5OwogIH0sCiAgaXNJbnQxNkFycmF5KHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgSW50MTZBcnJheTsKICB9LAogIGlzSW50MzJBcnJheSh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIEludDMyQXJyYXk7CiAgfSwKICBpc01hcCh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIE1hcDsKICB9LAogIGlzUHJvbWlzZSh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIFByb21pc2U7CiAgfSwKICBpc1Byb3h5KHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgUHJveHk7CiAgfSwKICBpc1JlZ0V4cCh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIFJlZ0V4cDsKICB9LAogIGlzU2V0KHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgU2V0OwogIH0sCiAgaXNTaGFyZWRBcnJheUJ1ZmZlcih2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIFNoYXJlZEFycmF5QnVmZmVyOwogIH0sCiAgaXNVaW50OEFycmF5KHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgVWludDhBcnJheTsKICB9LAogIGlzVWludDhDbGFtcGVkQXJyYXkodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBVaW50OENsYW1wZWRBcnJheTsKICB9LAogIGlzVWludDE2QXJyYXkodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBVaW50MTZBcnJheTsKICB9LAogIGlzVWludDMyQXJyYXkodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBVaW50MzJBcnJheTsKICB9LAogIGlzV2Vha01hcCh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIFdlYWtNYXA7CiAgfSwKICBpc1dlYWtTZXQodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBXZWFrU2V0OwogIH0sCiAgaXNEYXRhVmlldyh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIERhdGFWaWV3OwogIH0sCiAgaXNCb29sZWFuT2JqZWN0KHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgQm9vbGVhbjsKICB9LAogIGlzQXN5bmNGdW5jdGlvbih2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIEFzeW5jRnVuY3Rpb247CiAgfSwKICBpc0dlbmVyYXRvckZ1bmN0aW9uKHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgR2VuZXJhdG9yRnVuY3Rpb247CiAgfSwKICBpc0FzeW5jR2VuZXJhdG9yRnVuY3Rpb24odikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBBc3luY0dlbmVyYXRvckZ1bmN0aW9uOwogIH0sCiAgaXNOdW1iZXJPYmplY3QodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBOdW1iZXI7CiAgfSwKICBpc0JpZ0ludE9iamVjdCh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIEJpZ0ludDsKICB9LAogIGlzU3ltYm9sT2JqZWN0KHYpIHsKICAgIHJldHVybiB2ICYmIHYgaW5zdGFuY2VvZiBTeW1ib2w7CiAgfSwKICBpc05hdGl2ZUVycm9yKHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgRXJyb3IgJiYgaXNOYXRpdmUodi5jb25zdHJ1Y3Rvcik7CiAgfSwKICBpc01hcEl0ZXJhdG9yKHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiBwcm90b09mKHYpID09IE1hcEl0ZXJhdG9yUHJvdG90eXBlOwogIH0sCiAgaXNTZXRJdGVyYXRvcih2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgcHJvdG9PZih2KSA9PSBTZXRJdGVyYXRvclByb3RvdHlwZTsKICB9LAogIGlzU3RyaW5nT2JqZWN0KHYpIHsKICAgIHJldHVybiBpc09iamVjdCh2KSAmJiB2IGluc3RhbmNlb2YgU3RyaW5nOwogIH0sCiAgaXNBcnJheUJ1ZmZlclZpZXcodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIEFycmF5QnVmZmVyLmlzVmlldyh2KTsKICB9LAogIGlzQXJndW1lbnRzT2JqZWN0KHYpIHsKICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodikgPT0gJ1tvYmplY3QgQXJndW1lbnRzXSc7CiAgfSwKCiAgLyogaXNFeHRlcm5hbCh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgdiBpbnN0YW5jZW9mIEV4dGVybmFsOwogIH0sKi8KCiAgaXNCb3hlZFByaW1pdGl2ZSh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgW051bWJlciwgU3RyaW5nLCBCb29sZWFuLCBCaWdJbnQsIFN5bWJvbF0uc29tZShjdG9yID0+IHYgaW5zdGFuY2VvZiBjdG9yKTsKICB9LAoKICBpc0dlbmVyYXRvck9iamVjdCh2KSB7CiAgICByZXR1cm4gaXNPYmplY3QodikgJiYgcHJvdG9PZih2KSA9PSBHZW5lcmF0b3JQcm90b3R5cGU7CiAgfSwKICBpc1R5cGVkQXJyYXkodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHYgaW5zdGFuY2VvZiBUeXBlZEFycmF5OwogIH0sCiAgaXNNb2R1bGVOYW1lc3BhY2VPYmplY3QodikgewogICAgcmV0dXJuIGlzT2JqZWN0KHYpICYmIHZbU3ltYm9sLnRvU3RyaW5nVGFnXSA9PSAnTW9kdWxlJzsKICB9Cn07CgpleHBvcnQgZnVuY3Rpb24gaXNPYmplY3QoYXJnKSB7CiAgcmV0dXJuIHR5cGVvZiBhcmcgPT0gJ29iamVjdCcgJiYgYXJnICE9PSBudWxsOwp9Cgpjb25zdCBVVEY4Rmlyc3RDb2RlTWFzayA9IFsweDFmLCAweGYsIDB4NywgMHgzLCAweDFdOwpjb25zdCBVVEY4TWluQ29kZSA9IFsweDgwLCAweDgwMCwgMHgxMDAwMCwgMHgwMDIwMDAwMCwgMHgwNDAwMDAwMF07CgovKiBwcmV0dGllci1pZ25vcmUgKi8gY29uc3QgZXJyb3JTeW1ib2xzID0gWyAwLCAnRVBFUk0nLCAnRU5PRU5UJywgJ0VTUkNIJywgJ0VJTlRSJywgJ0VJTycsICdFTlhJTycsICdFMkJJRycsICdFTk9FWEVDJywgJ0VCQURGJywgJ0VDSElMRCcsICdFQUdBSU4nLCAnRU5PTUVNJywgJ0VBQ0NFUycsICdFRkFVTFQnLCAnRU5PVEJMSycsICdFQlVTWScsICdFRVhJU1QnLCAnRVhERVYnLCAnRU5PREVWJywgJ0VOT1RESVInLCAnRUlTRElSJywgJ0VJTlZBTCcsICdFTkZJTEUnLCAnRU1GSUxFJywgJ0VOT1RUWScsICdFVFhUQlNZJywgJ0VGQklHJywgJ0VOT1NQQycsICdFU1BJUEUnLCAnRVJPRlMnLCAnRU1MSU5LJywgJ0VQSVBFJywgJ0VET00nLCAnRVJBTkdFJywgJ0VERUFETEsnLCAnRU5BTUVUT09MT05HJywgJ0VOT0xDSycsICdFTk9TWVMnLCAnRU5PVEVNUFRZJywgMCwgMCwgJ0VOT01TRycsICdFSURSTScsICdFQ0hSTkcnLCAnRUwyTlNZTkMnLCAnRUwzSExUJywgJ0VMM1JTVCcsICdFTE5STkcnLCAnRVVOQVRDSCcsICdFTk9DU0knLCAnRUwySExUJywgJ0VCQURFJywgJ0VCQURSJywgJ0VYRlVMTCcsICdFTk9BTk8nLCAnRUJBRFJRQycsIDAsIDAsICdFQkZPTlQnLCAnRU5PU1RSJywgJ0VOT0RBVEEnLCAnRVRJTUUnLCAnRU5PU1InLCAnRU5PTkVUJywgJ0VOT1BLRycsICdFUkVNT1RFJywgJ0VOT0xJTksnLCAnRUFEVicsICdFU1JNTlQnLCAnRUNPTU0nLCAnRVBST1RPJywgJ0VNVUxUSUhPUCcsICdFRE9URE9UJywgJ0VCQURNU0cnLCAnRU9WRVJGTE9XJywgJ0VOT1RVTklRJywgJ0VCQURGRCcsICdFUkVNQ0hHJywgJ0VMSUJBQ0MnLCAnRUxJQkJBRCcsICdFTElCU0NOJywgJ0VMSUJNQVgnLCAnRUxJQkVYRUMnLCAnRUlMU0VRJywgJ0VSRVNUQVJUJywgJ0VTVFJQSVBFJywgJ0VVU0VSUycsICdFTk9UU09DSycsICdFREVTVEFERFJSRVEnLCAnRU1TR1NJWkUnLCAnRVBST1RPVFlQRScsICdFTk9QUk9UT09QVCcsICdFUFJPVE9OT1NVUFBPUlQnLCAnRVNPQ0tUTk9TVVBQT1JUJywgJ0VPUE5PVFNVUFAnLCAnRVBGTk9TVVBQT1JUJywgJ0VBRk5PU1VQUE9SVCcsICdFQUREUklOVVNFJywgJ0VBRERSTk9UQVZBSUwnLCAnRU5FVERPV04nLCAnRU5FVFVOUkVBQ0gnLCAnRU5FVFJFU0VUJywgJ0VDT05OQUJPUlRFRCcsICdFQ09OTlJFU0VUJywgJ0VOT0JVRlMnLCAnRUlTQ09OTicsICdFTk9UQ09OTicsICdFU0hVVERPV04nLCAnRVRPT01BTllSRUZTJywgJ0VUSU1FRE9VVCcsICdFQ09OTlJFRlVTRUQnLCAnRUhPU1RET1dOJywgJ0VIT1NUVU5SRUFDSCcsICdFQUxSRUFEWScsICdFSU5QUk9HUkVTUycsICdFU1RBTEUnLCAnRVVDTEVBTicsICdFTk9UTkFNJywgJ0VOQVZBSUwnLCAnRUlTTkFNJywgJ0VSRU1PVEVJTycsICdFRFFVT1QnLCAnRU5PTUVESVVNJywgJ0VNRURJVU1UWVBFJywgJ0VDQU5DRUxFRCcsICdFTk9LRVknLCAnRUtFWUVYUElSRUQnLCAnRUtFWVJFVk9LRUQnLCAnRUtFWVJFSkVDVEVEJywgJ0VPV05FUkRFQUQnLCAnRU5PVFJFQ09WRVJBQkxFJywgJ0VSRktJTEwnIF07CgpleHBvcnQgZnVuY3Rpb24gU3lzY2FsbEVycm9yKHN5c2NhbGwsIGVycm51bSkgewogIGxldCBvYmogPSBuZXcudGFyZ2V0ID8gdGhpcyA6IG5ldyBTeXNjYWxsRXJyb3IoKTsKICBpZihzeXNjYWxsKSBvYmouc3lzY2FsbCA9IHN5c2NhbGw7CiAgaWYoZXJybnVtICE9IHVuZGVmaW5lZCkgewogICAgaWYodHlwZW9mIGVycm51bSA9PSAnbnVtYmVyJykgewogICAgICBvYmouZXJybm8gPSBlcnJudW07CiAgICAgIG9iai5jb2RlID0gZXJyb3JTeW1ib2xzW2Vycm51bV07CiAgICB9IGVsc2UgewogICAgICBvYmouZXJybm8gPSBlcnJvclN5bWJvbHMuaW5kZXhPZihlcnJudW0pOwogICAgICBvYmouY29kZSA9IGVycm51bTsKICAgIH0KICB9CiAgRXJyb3IuY2FsbChvYmosIGBTeXNjYWxsRXJyb3I6ICcke29iai5zeXNjYWxsfScgZXJybm8gPSAke29iai5jb2RlfSAoJHtvYmouZXJybm99KWApOwogIHJldHVybiBvYmo7Cn0KClN5c2NhbGxFcnJvci5wcm90b3R5cGUgPSBuZXcgRXJyb3IoKTsKCmRlZmluZShTeXNjYWxsRXJyb3IucHJvdG90eXBlLCB7CiAgZ2V0IG1lc3NhZ2UoKSB7CiAgICByZXR1cm4gYFN5c2NhbGxFcnJvcjogJyR7dGhpcy5zeXNjYWxsfScgZXJybm8gPSAke3RoaXMuY29kZX0gKCR7dGhpcy5lcnJub30pYDsKICB9LAogIFtTeW1ib2wudG9TdHJpbmdUYWddOiAnU3lzY2FsbEVycm9yJwp9KTsKCmdsb2JhbFRoaXMuU3lzY2FsbEVycm9yID0gU3lzY2FsbEVycm9yOwpleHBvcnQgZnVuY3Rpb24gZXh0ZW5kQXJyYXkocHJvdG8gPSBBcnJheS5wcm90b3R5cGUpIHsKICBkZWZpbmUocHJvdG8sIHsKICAgIGdldCBsYXN0KCkgewogICAgICByZXR1cm4gdGhpc1t0aGlzLmxlbmd0aCAtIDFdOwogICAgfSwKICAgIGF0KGluZGV4KSB7CiAgICAgIGNvbnN0IHsgbGVuZ3RoIH0gPSB0aGlzOwogICAgICByZXR1cm4gdGhpc1soKGluZGV4ICUgbGVuZ3RoKSArIGxlbmd0aCkgJSBsZW5ndGhdOwogICAgfSwKICAgIGNsZWFyKCkgewogICAgICB0aGlzLnNwbGljZSgwLCB0aGlzLmxlbmd0aCk7CiAgICB9LAogICAgZmluZExhc3RJbmRleChwcmVkaWNhdGUpIHsKICAgICAgZm9yKGxldCBpID0gdGhpcy5sZW5ndGggLSAxOyBpID49IDA7IC0taSkgewogICAgICAgIGNvbnN0IHggPSB0aGlzW2ldOwogICAgICAgIGlmKHByZWRpY2F0ZSh4LCBpLCB0aGlzKSkgcmV0dXJuIGk7CiAgICAgIH0KICAgICAgcmV0dXJuIC0xOwogICAgfSwKICAgIGZpbmRMYXN0KHByZWRpY2F0ZSkgewogICAgICBsZXQgaTsKICAgICAgaWYoKGkgPSB0aGlzLmZpbmRMYXN0SW5kZXgocHJlZGljYXRlKSkgPT0gLTEpIHJldHVybiBudWxsOwogICAgICByZXR1cm4gdGhpc1tpXTsKICAgIH0sCiAgICB1bmlxdWUoKSB7CiAgICAgIHJldHVybiBbLi4ubmV3IFNldCh0aGlzKV07CiAgICB9LAogICAgcHVzaFVuaXF1ZSguLi5hcmdzKSB7CiAgICAgIGZvcihsZXQgYXJnIG9mIGFyZ3MpIGlmKHRoaXMuaW5kZXhPZihhcmcpID09PSAtMSkgdGhpcy5wdXNoKGFyZyk7CiAgICB9CiAgfSk7Cn0KCmV4cG9ydCBmdW5jdGlvbiB0b1N0cmluZyhhcnJheUJ1ZiwgZW5jb2RpbmcgPSAndXRmLTgnKSB7CiAgaWYoZ2xvYmFsVGhpcy5UZXh0RGVjb2RlcikgewogICAgbGV0IGRlYyA9IG5ldyBUZXh0RGVjb2RlcihlbmNvZGluZyk7CiAgICByZXR1cm4gZGVjLmRlY29kZShhcnJheUJ1Zik7CiAgfQoKICBpZihlbmNvZGluZyA9PSAnbGF0aW4xJykgewogICAgbGV0IGJpbmFyeSA9ICcnOwogICAgbGV0IGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWYpOwogICAgbGV0IGxlbiA9IGJ5dGVzLmJ5dGVMZW5ndGg7CiAgICBmb3IobGV0IGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgICAgYmluYXJ5ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoYnl0ZXNbaV0pOwogICAgfQogICAgcmV0dXJuIGJpbmFyeTsKICB9CgogIGxldCBhID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWYpOwogIGxldCBwID0gMDsKICBsZXQgbyA9ICcnOwogIGxldCBsZW4gPSBhLmxlbmd0aDsKICBmb3IocCA9IDA7IHAgPCBsZW47ICkgewogICAgbGV0IG1heF9sZW4gPSBsZW4gLSBwOwogICAgbGV0IGwsIGMsIGIsIGk7CgogICAgYyA9IGFbcCsrXTsKICAgIGlmKGMgPCAweDgwKSB7CiAgICAgIG8gKz0gU3RyaW5nLmZyb21Db2RlUG9pbnQoYyk7CiAgICAgIGNvbnRpbnVlOwogICAgfQoKICAgIHN3aXRjaCAoYykgewogICAgICBjYXNlIDB4YzA6CiAgICAgIGNhc2UgMHhjMToKICAgICAgY2FzZSAweGMyOgogICAgICBjYXNlIDB4YzM6CiAgICAgIGNhc2UgMHhjNDoKICAgICAgY2FzZSAweGM1OgogICAgICBjYXNlIDB4YzY6CiAgICAgIGNhc2UgMHhjNzoKICAgICAgY2FzZSAweGM4OgogICAgICBjYXNlIDB4Yzk6CiAgICAgIGNhc2UgMHhjYToKICAgICAgY2FzZSAweGNiOgogICAgICBjYXNlIDB4Y2M6CiAgICAgIGNhc2UgMHhjZDoKICAgICAgY2FzZSAweGNlOgogICAgICBjYXNlIDB4Y2Y6CiAgICAgIGNhc2UgMHhkMDoKICAgICAgY2FzZSAweGQxOgogICAgICBjYXNlIDB4ZDI6CiAgICAgIGNhc2UgMHhkMzoKICAgICAgY2FzZSAweGQ0OgogICAgICBjYXNlIDB4ZDU6CiAgICAgIGNhc2UgMHhkNjoKICAgICAgY2FzZSAweGQ3OgogICAgICBjYXNlIDB4ZDg6CiAgICAgIGNhc2UgMHhkOToKICAgICAgY2FzZSAweGRhOgogICAgICBjYXNlIDB4ZGI6CiAgICAgIGNhc2UgMHhkYzoKICAgICAgY2FzZSAweGRkOgogICAgICBjYXNlIDB4ZGU6CiAgICAgIGNhc2UgMHhkZjoKICAgICAgICBsID0gMTsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAweGUwOgogICAgICBjYXNlIDB4ZTE6CiAgICAgIGNhc2UgMHhlMjoKICAgICAgY2FzZSAweGUzOgogICAgICBjYXNlIDB4ZTQ6CiAgICAgIGNhc2UgMHhlNToKICAgICAgY2FzZSAweGU2OgogICAgICBjYXNlIDB4ZTc6CiAgICAgIGNhc2UgMHhlODoKICAgICAgY2FzZSAweGU5OgogICAgICBjYXNlIDB4ZWE6CiAgICAgIGNhc2UgMHhlYjoKICAgICAgY2FzZSAweGVjOgogICAgICBjYXNlIDB4ZWQ6CiAgICAgIGNhc2UgMHhlZToKICAgICAgY2FzZSAweGVmOgogICAgICAgIGwgPSAyOwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIDB4ZjA6CiAgICAgIGNhc2UgMHhmMToKICAgICAgY2FzZSAweGYyOgogICAgICBjYXNlIDB4ZjM6CiAgICAgIGNhc2UgMHhmNDoKICAgICAgY2FzZSAweGY1OgogICAgICBjYXNlIDB4ZjY6CiAgICAgIGNhc2UgMHhmNzoKICAgICAgICBsID0gMzsKICAgICAgICBicmVhazsKICAgICAgY2FzZSAweGY4OgogICAgICBjYXNlIDB4Zjk6CiAgICAgIGNhc2UgMHhmYToKICAgICAgY2FzZSAweGZiOgogICAgICAgIGwgPSA0OwogICAgICAgIGJyZWFrOwogICAgICBjYXNlIDB4ZmM6CiAgICAgIGNhc2UgMHhmZDoKICAgICAgICBsID0gNTsKICAgICAgICBicmVhazsKICAgICAgZGVmYXVsdDoKICAgICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIC8qIGNoZWNrIHRoYXQgd2UgaGF2ZSBlbm91Z2ggY2hhcmFjdGVycyAqLwogICAgaWYobCA+IG1heF9sZW4gLSAxKSByZXR1cm4gLTE7CgogICAgYyAmPSBVVEY4Rmlyc3RDb2RlTWFza1tsIC0gMV07CiAgICBmb3IoaSA9IDA7IGkgPCBsOyBpKyspIHsKICAgICAgYiA9IGFbcCsrXTsKICAgICAgaWYoYiA8IDB4ODAgfHwgYiA+PSAweGMwKSByZXR1cm4gLTE7CgogICAgICBjID0gKGMgPDwgNikgfCAoYiAmIDB4M2YpOwogICAgfQogICAgaWYoYyA8IFVURjhNaW5Db2RlW2wgLSAxXSkgcmV0dXJuIC0xOwogICAgbyArPSBTdHJpbmcuZnJvbUNvZGVQb2ludChjKTsKICB9CiAgcmV0dXJuIG87Cn0KCmNvbnN0IGI2NGNoID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89JzsKY29uc3QgYjY0Y2hzID0gWy4uLmI2NGNoXTsKY29uc3QgYjY0dGFiID0gKGEgPT4gewogIGxldCB0YWIgPSB7fTsKICBhLmZvckVhY2goKGMsIGkpID0+ICh0YWJbY10gPSBpKSk7CiAgcmV0dXJuIHRhYjsKfSkoYjY0Y2hzKTsKY29uc3QgYjY0cmUgPSAvXig/OltBLVphLXpcZCtcL117NH0pKj8oPzpbQS1aYS16XGQrXC9dezJ9KD86PT0pP3xbQS1aYS16XGQrXC9dezN9PT8pPyQvOwoKZXhwb3J0IGZ1bmN0aW9uIGJ0b2EoYmluKSB7CiAgbGV0IHUzMiwKICAgIGMwLAogICAgYzEsCiAgICBjMiwKICAgIGFzYyA9ICcnOwogIGNvbnN0IHBhZCA9IGJpbi5sZW5ndGggJSAzOwogIGZvcihsZXQgaSA9IDA7IGkgPCBiaW4ubGVuZ3RoOyBpICs9IDApIHsKICAgIGlmKChjMCA9IGJpbi5jaGFyQ29kZUF0KGkrKykpID4gMjU1IHx8IChjMSA9IGJpbi5jaGFyQ29kZUF0KGkrKykpID4gMjU1IHx8IChjMiA9IGJpbi5jaGFyQ29kZUF0KGkrKykpID4gMjU1KSB0aHJvdyBuZXcgVHlwZUVycm9yKCdpbnZhbGlkIGNoYXJhY3RlciBmb3VuZCcpOwogICAgdTMyID0gKGMwIDw8IDE2KSB8IChjMSA8PCA4KSB8IGMyOwogICAgYXNjICs9IGI2NGNoc1sodTMyID4+IDE4KSAmIDYzXSArIGI2NGNoc1sodTMyID4+IDEyKSAmIDYzXSArIGI2NGNoc1sodTMyID4+IDYpICYgNjNdICsgYjY0Y2hzW3UzMiAmIDYzXTsKICB9CiAgcmV0dXJuIHBhZCA/IGFzYy5zbGljZSgwLCBwYWQgLSAzKSArICc9PT0nLnN1YnN0cmluZyhwYWQpIDogYXNjOwp9CgpleHBvcnQgZnVuY3Rpb24gYXRvYihhc2MpIHsKICBhc2MgPSBhc2MucmVwbGFjZSgvXHMrL2csICcnKTsKICBpZighYjY0cmUudGVzdChhc2MpKSB0aHJvdyBuZXcgVHlwZUVycm9yKCdtYWxmb3JtZWQgYmFzZTY0LicpOwogIGFzYyArPSAnPT0nLnNsaWNlKDIgLSAoYXNjLmxlbmd0aCAmIDMpKTsKICBsZXQgdTI0LAogICAgYmluID0gJycsCiAgICByMSwKICAgIHIyOwogIGZvcihsZXQgaSA9IDA7IGkgPCBhc2MubGVuZ3RoOyBpICs9IDApIHsKICAgIHUyNCA9IChiNjR0YWJbYXNjLmNoYXJBdChpKyspXSA8PCAxOCkgfCAoYjY0dGFiW2FzYy5jaGFyQXQoaSsrKV0gPDwgMTIpIHwgKChyMSA9IGI2NHRhYlthc2MuY2hhckF0KGkrKyldKSA8PCA2KSB8IChyMiA9IGI2NHRhYlthc2MuY2hhckF0KGkrKyldKTsKICAgIGJpbiArPQogICAgICByMSA9PT0gNjQgPyBTdHJpbmcuZnJvbUNoYXJDb2RlKCh1MjQgPj4gMTYpICYgMjU1KSA6IHIyID09PSA2NCA/IFN0cmluZy5mcm9tQ2hhckNvZGUoKHUyNCA+PiAxNikgJiAyNTUsICh1MjQgPj4gOCkgJiAyNTUpIDogU3RyaW5nLmZyb21DaGFyQ29kZSgodTI0ID4+IDE2KSAmIDI1NSwgKHUyNCA+PiA4KSAmIDI1NSwgdTI0ICYgMjU1KTsKICB9CiAgcmV0dXJuIGJpbjsKfQpleHBvcnQgZnVuY3Rpb24gYXNzZXJ0KGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2UpIHsKICBpZihhcmd1bWVudHMubGVuZ3RoID09IDEpIGV4cGVjdGVkID0gdHJ1ZTsKCiAgaWYoYWN0dWFsID09PSBleHBlY3RlZCkgcmV0dXJuOwoKICBpZihhY3R1YWwgIT09IG51bGwgJiYgZXhwZWN0ZWQgIT09IG51bGwgJiYgdHlwZW9mIGFjdHVhbCA9PSAnb2JqZWN0JyAmJiB0eXBlb2YgZXhwZWN0ZWQgPT0gJ29iamVjdCcgJiYgYWN0dWFsLnRvU3RyaW5nKCkgPT09IGV4cGVjdGVkLnRvU3RyaW5nKCkpIHJldHVybjsKCiAgdGhyb3cgRXJyb3IoJ2Fzc2VydGlvbiBmYWlsZWQ6IGdvdCB8JyArIGFjdHVhbCArICd8JyArICcsIGV4cGVjdGVkIHwnICsgZXhwZWN0ZWQgKyAnfCcgKyAobWVzc2FnZSA/ICcgKCcgKyBtZXNzYWdlICsgJyknIDogJycpKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGVzY2FwZShzdHIsIGNoYXJzID0gW10pIHsKICBjb25zdCB0YWJsZSA9IHsKICAgIFsnXG4nXTogJ24nLAogICAgWydcciddOiAncicsCiAgICBbJ1x0J106ICd0JywKICAgIFsnXHYnXTogJ3YnLAogICAgWydcYiddOiAnYicKICB9OwogIGZvcihsZXQgY2ggb2YgY2hhcnMpIHRhYmxlW2NoXSA9IGNoOwogIGxldCBzID0gJyc7CiAgZm9yKGxldCBjaCBvZiBzdHIpIHsKICAgIGlmKHRhYmxlW2NoXSkgcyArPSAnXFwnICsgKHRhYmxlW2NoXSA/PyBjaCk7CiAgICBlbHNlIHMgKz0gY2g7CiAgfQogIHJldHVybiBzOwp9CgpleHBvcnQgZnVuY3Rpb24gcXVvdGUoc3RyLCBxID0gJyInKSB7CiAgcmV0dXJuIHEgKyBlc2NhcGUoc3RyLCBbcV0pICsgcTsKfQoKZXhwb3J0IGZ1bmN0aW9uIG1lbW9pemUoZm4pIHsKICBsZXQgY2FjaGUgPSB7fTsKICByZXR1cm4gKG4sIC4uLnJlc3QpID0+IHsKICAgIGlmKG4gaW4gY2FjaGUpIHJldHVybiBjYWNoZVtuXTsKICAgIHJldHVybiAoY2FjaGVbbl0gPSBmbihuLCAuLi5yZXN0KSk7CiAgfTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGdldHNldCh0YXJnZXQsIC4uLmFyZ3MpIHsKICBsZXQgcmV0ID0gW107CiAgaWYoaXNGdW5jdGlvbih0YXJnZXQpKSB7CiAgICByZXQgPSBbdGFyZ2V0LCB0eXBlb2YgYXJnc1swXSA9PSAnZnVuY3Rpb24nID8gYXJnc1swXSA6IHRhcmdldF07CiAgfSBlbHNlIGlmKGhhc0dldFNldCh0YXJnZXQpKSB7CiAgICBpZih0YXJnZXQuZ2V0ID09PSB0YXJnZXQuc2V0KSB7CiAgICAgIGNvbnN0IEdldFNldCA9ICguLi5hcmdzKSA9PiB0YXJnZXQuc2V0KC4uLmFyZ3MpOwogICAgICByZXQgPSBbR2V0U2V0LCBHZXRTZXRdOwogICAgfSBlbHNlIHsKICAgICAgcmV0ID0gW2tleSA9PiB0YXJnZXQuZ2V0KGtleSksIChrZXksIHZhbHVlKSA9PiB0YXJnZXQuc2V0KGtleSwgdmFsdWUpXTsKICAgICAgLy9jb25zb2xlLmxvZygnZ2V0c2V0JywgcmV0WzFdICsgJycsIHRhcmdldC5nZXQgPT09IHRhcmdldC5zZXQpOwogICAgfQogIH0gZWxzZSBpZihpc09iamVjdCh0YXJnZXQpKSB7CiAgICByZXQgPSBba2V5ID0+IHRhcmdldFtrZXldLCAoa2V5LCB2YWx1ZSkgPT4gKHRhcmdldFtrZXldID0gdmFsdWUpXTsKICB9IGVsc2UgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgZ2V0c2V0IHVua25vd24gYXJndW1lbnQgdHlwZSAnJHt0eXBlb2YgdGFyZ2V0fSdgKTsKICB9CiAgaWYoYXJncy5sZW5ndGgpIHsKICAgIGxldCBbZ2V0LCBzZXRdID0gcmV0OwogICAgcmV0ID0gWygpID0+IGdldCguLi5hcmdzKSwgdmFsdWUgPT4gc2V0KC4uLmFyZ3MsIHZhbHVlKV07CiAgfQogIHJldHVybiByZXQ7Cn0KCmV4cG9ydCBmdW5jdGlvbiBtb2RpZmllciguLi5hcmdzKSB7CiAgbGV0IGdzID0gZ2V0dGVyc2V0dGVyKC4uLmFyZ3MpOwogIHJldHVybiBmbiA9PiB7CiAgICBsZXQgdmFsdWUgPSBncygpOwogICAgcmV0dXJuIGZuKHZhbHVlLCBuZXdWYWx1ZSA9PiBncyhuZXdWYWx1ZSkpOwogIH07Cn0KCmV4cG9ydCBmdW5jdGlvbiBnZXR0ZXIodGFyZ2V0LCAuLi5hcmdzKSB7CiAgaWYoaXNPYmplY3QodGFyZ2V0KSAmJiBpc0Z1bmN0aW9uKHRhcmdldC5nZXQpKSByZXR1cm4gKCkgPT4gdGFyZ2V0LmdldCguLi5hcmdzKTsKICBsZXQgcmV0OwogIGlmKGlzRnVuY3Rpb24odGFyZ2V0KSkgewogICAgcmV0ID0gdGFyZ2V0OwogIH0gZWxzZSBpZihoYXNHZXRTZXQodGFyZ2V0KSkgewogICAgcmV0ID0ga2V5ID0+IHRhcmdldC5nZXQoa2V5KTsKICB9IGVsc2UgaWYoaXNPYmplY3QodGFyZ2V0KSkgewogICAgcmV0ID0ga2V5ID0+IHRhcmdldFtrZXldOwogIH0gZWxzZSB7CiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBnZXR0ZXIgdW5rbm93biBhcmd1bWVudCB0eXBlICcke3R5cGVvZiB0YXJnZXR9J2ApOwogIH0KICBpZihhcmdzLmxlbmd0aCkgewogICAgbGV0IGdldCA9IHJldDsKICAgIHJldCA9ICgpID0+IGdldCguLi5hcmdzKTsKICB9CiAgcmV0dXJuIHJldDsKfQoKZXhwb3J0IGZ1bmN0aW9uIHNldHRlcih0YXJnZXQsIC4uLmFyZ3MpIHsKICBpZihpc09iamVjdCh0YXJnZXQpICYmIGlzRnVuY3Rpb24odGFyZ2V0LnNldCkpIHJldHVybiB2YWx1ZSA9PiB0YXJnZXQuc2V0KC4uLmFyZ3MsIHZhbHVlKTsKICBsZXQgcmV0OwogIGlmKGlzRnVuY3Rpb24odGFyZ2V0KSkgewogICAgcmV0ID0gdGFyZ2V0OwogIH0gZWxzZSBpZihoYXNHZXRTZXQodGFyZ2V0KSkgewogICAgcmV0ID0gKGtleSwgdmFsdWUpID0+IHRhcmdldC5zZXQoa2V5LCB2YWx1ZSk7CiAgfSBlbHNlIGlmKGlzT2JqZWN0KHRhcmdldCkpIHsKICAgIHJldCA9IChrZXksIHZhbHVlKSA9PiAodGFyZ2V0W2tleV0gPSB2YWx1ZSk7CiAgfSBlbHNlIHsKICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYHNldHRlciB1bmtub3duIGFyZ3VtZW50IHR5cGUgJyR7dHlwZW9mIHRhcmdldH0nYCk7CiAgfQogIGlmKGFyZ3MubGVuZ3RoKSB7CiAgICBsZXQgc2V0ID0gcmV0OwogICAgcmV0ID0gdmFsdWUgPT4gc2V0KC4uLmFyZ3MsIHZhbHVlKTsKICB9CiAgcmV0dXJuIHJldDsKfQoKZXhwb3J0IGZ1bmN0aW9uIGdldHRlcnNldHRlcih0YXJnZXQsIC4uLmFyZ3MpIHsKICBsZXQgZm47CiAgaWYoaXNPYmplY3QodGFyZ2V0KSAmJiBpc0Z1bmN0aW9uKHRhcmdldC5yZWNlaXZlcikpIHJldHVybiAoLi4uYXJnczIpID0+IHRhcmdldC5yZWNlaXZlciguLi5hcmdzLCAuLi5hcmdzMik7CiAgaWYoaXNGdW5jdGlvbih0YXJnZXQpKSB7CiAgICBpZihpc0Z1bmN0aW9uKGFyZ3NbMF0pICYmIGFyZ3NbMF0gIT09IHRhcmdldCkgewogICAgICBsZXQgc2V0dGVyID0gYXJncy5zaGlmdCgpOwogICAgICBmbiA9ICguLi5hcmdzKSA9PiAoYXJncy5sZW5ndGggPT0gMCA/IHRhcmdldCgpIDogc2V0dGVyKC4uLmFyZ3MpKTsKICAgIH0gZWxzZSBmbiA9IHRhcmdldDsKICB9IGVsc2UgaWYoaGFzR2V0U2V0KHRhcmdldCkpIHsKICAgIGlmKHRhcmdldC5nZXQgPT09IHRhcmdldC5zZXQpIGZuID0gKC4uLmFyZ3MpID0+IHRhcmdldC5zZXQoLi4uYXJncyk7CiAgICBlbHNlIGZuID0gKC4uLmFyZ3MpID0+IChhcmdzLmxlbmd0aCA8IDIgPyB0YXJnZXQuZ2V0KC4uLmFyZ3MpIDogdGFyZ2V0LnNldCguLi5hcmdzKSk7CiAgfSBlbHNlIGlmKGlzT2JqZWN0KHRhcmdldCkpIHsKICAgIGZuID0gKC4uLmFyZ3MpID0+IHsKICAgICAgY29uc3QgW2tleSwgdmFsdWVdID0gYXJnczsKICAgICAgaWYoYXJncy5sZW5ndGggPT0gMSkgcmV0dXJuIHRhcmdldFtrZXldOwogICAgICB0YXJnZXRba2V5XSA9IHZhbHVlOwogICAgfTsKICB9IGVsc2UgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgZ2V0dGVyc2V0dGVyIHVua25vd24gYXJndW1lbnQgdHlwZSAnJHt0eXBlb2YgdGFyZ2V0fSdgKTsKICB9CiAgaWYoZm4gIT09IHRhcmdldCkgZGVmaW5lKGZuLCB7IHJlY2VpdmVyOiB0YXJnZXQgfSk7CiAgaWYoYXJncy5sZW5ndGgpIHJldHVybiAoLi4uYXJnczIpID0+IGZuKC4uLmFyZ3MsIC4uLmFyZ3MyKTsKICByZXR1cm4gZm47Cn0KCmV4cG9ydCBmdW5jdGlvbiBoYXNHZXRTZXQob2JqKSB7CiAgcmV0dXJuIGlzT2JqZWN0KG9iaikgJiYgWydnZXQnLCAnc2V0J10uZXZlcnkobSA9PiB0eXBlb2Ygb2JqW21dID09ICdmdW5jdGlvbicpOwp9CgpleHBvcnQgZnVuY3Rpb24gbWFwT2JqZWN0KHRhcmdldCkgewogIGxldCBvYmo7CiAgaWYoaGFzR2V0U2V0KHRhcmdldC5yZWNlaXZlcikpIHJldHVybiB0YXJnZXQucmVjZWl2ZXI7CiAgaWYoaGFzR2V0U2V0KHRhcmdldCkpIG9iaiA9IHRhcmdldDsKICBlbHNlIGlmKHR5cGVvZiB0YXJnZXQgPT0gJ2Z1bmN0aW9uJykgb2JqID0geyBnZXQ6IHRhcmdldCwgc2V0OiB0YXJnZXQgfTsKICBlbHNlIGlmKGlzT2JqZWN0KHRhcmdldCkpCiAgICBvYmogPSB7CiAgICAgIHNldDogKGtleSwgdmFsdWUpID0+ICh0YXJnZXRba2V5XSA9IHZhbHVlKSwKICAgICAgZ2V0OiBrZXkgPT4gdGFyZ2V0W2tleV0KICAgIH07CiAgaWYob2JqICE9PSB0YXJnZXQpIGRlZmluZShvYmosIHsgcmVjZWl2ZXI6IHRhcmdldCB9KTsKICByZXR1cm4gb2JqOwp9CgpleHBvcnQgZnVuY3Rpb24gb25jZShmbiwgdGhpc0FyZywgbWVtb0ZuKSB7CiAgbGV0IHJldCwKICAgIHJhbiA9IGZhbHNlOwoKICByZXR1cm4gZnVuY3Rpb24oLi4uYXJncykgewogICAgaWYoIXJhbikgewogICAgICByYW4gPSB0cnVlOwogICAgICByZXQgPSBmbi5hcHBseSh0aGlzQXJnIHx8IHRoaXMsIGFyZ3MpOwogICAgfSBlbHNlIGlmKHR5cGVvZiBtZW1vRm4gPT0gJ2Z1bmN0aW9uJykgewogICAgICByZXQgPSBtZW1vRm4ocmV0KTsKICAgIH0KICAgIHJldHVybiByZXQ7CiAgfTsKfQoKY29uc3QgYXRleGl0X2Z1bmN0aW9ucyA9IFtdOwpjb25zdCBhdGV4aXRfaW5zdGFsbCA9IG9uY2UoY2FsbGJhY2sgPT4gewogIC8vIGF0dGFjaCB1c2VyIGNhbGxiYWNrIHRvIHRoZSBwcm9jZXNzIGV2ZW50IGVtaXR0ZXIKICAvLyBpZiBubyBjYWxsYmFjaywgaXQgd2lsbCBzdGlsbCBleGl0IGdyYWNlZnVsbHkgb24gQ3RybC1DCiAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBub09wOwogIHByb2Nlc3Mub24oJ2NsZWFudXAnLCBjYWxsYmFjayk7CgogIC8vIGRvIGFwcCBzcGVjaWZpYyBjbGVhbmluZyBiZWZvcmUgZXhpdGluZwogIHByb2Nlc3Mub24oJ2V4aXQnLCBmdW5jdGlvbigpIHsKICAgIHByb2Nlc3MuZW1pdCgnY2xlYW51cCcpOwogIH0pOwoKICAvLyBjYXRjaCBjdHJsK2MgZXZlbnQgYW5kIGV4aXQgbm9ybWFsbHkKICBwcm9jZXNzLm9uKCdTSUdJTlQnLCBmdW5jdGlvbigpIHsKICAgIGNvbnNvbGUubG9nKCdDdHJsLUMuLi4nKTsKICAgIHByb2Nlc3MuZXhpdCgyKTsKICB9KTsKCiAgLy9jYXRjaCB1bmNhdWdodCBleGNlcHRpb25zLCB0cmFjZSwgdGhlbiBleGl0IG5vcm1hbGx5CiAgcHJvY2Vzcy5vbigndW5jYXVnaHRFeGNlcHRpb24nLCBmdW5jdGlvbihlKSB7CiAgICBjb25zb2xlLmxvZygnVW5jYXVnaHQgRXhjZXB0aW9uLi4uJyk7CiAgICBjb25zb2xlLmxvZyhlLnN0YWNrKTsKICAgIHByb2Nlc3MuZXhpdCg5OSk7CiAgfSk7Cn0pOwoKZXhwb3J0IGZ1bmN0aW9uIGF0ZXhpdChmbikgewogIGF0ZXhpdF9mdW5jdGlvbnMucHVzaChmbik7CgogIGlmKGdsb2JhbFRoaXMucHJvY2VzcyAmJiAnb24nIGluIHByb2Nlc3MpIHsKICAgIGF0ZXhpdF9pbnN0YWxsKCgpID0+IHsKICAgICAgZm9yKGxldCBmbiBvZiBhdGV4aXRfZnVuY3Rpb25zKSBmbigpOwogICAgfSk7CiAgfQp9CgpleHBvcnQgZnVuY3Rpb24gd2FpdEZvcihtcykgewogIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGRlZmluZShvYmosIC4uLmFyZ3MpIHsKICBmb3IobGV0IHByb3BzIG9mIGFyZ3MpIHsKICAgIGxldCBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMocHJvcHMpOwogICAgZm9yKGxldCBwcm9wIGluIGRlc2MpIHsKICAgICAgY29uc3QgeyB2YWx1ZSB9ID0gZGVzY1twcm9wXTsKICAgICAgZGVzY1twcm9wXS5lbnVtZXJhYmxlID0gZmFsc2U7CiAgICAgIGlmKHR5cGVvZiB2YWx1ZSA9PSAnZnVuY3Rpb24nKSBkZXNjW3Byb3BdLndyaXRhYmxlID0gZmFsc2U7CiAgICB9CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhvYmosIGRlc2MpOwogIH0KICByZXR1cm4gb2JqOwp9CgpleHBvcnQgZnVuY3Rpb24ga2V5cyhvYmosIG1heERlcHRoT3JQcmVkID0gMSkgewogIGxldCBhID0gW10sCiAgICBkZXB0aCA9IC0xOwogIGlmKHR5cGVvZiBtYXhEZXB0aE9yUHJlZCAhPSAnZnVuY3Rpb24nKSB7CiAgICBsZXQgZCA9IG1heERlcHRoT3JQcmVkOwogICAgbWF4RGVwdGhPclByZWQgPSAob2JqLCBjdXJyZW50RGVwdGgpID0+IGN1cnJlbnREZXB0aCA8IGQ7CiAgfQogIHdoaWxlKG9iaikgewogICAgaWYobWF4RGVwdGhPclByZWQob2JqLCArK2RlcHRoKSAhPT0gdHJ1ZSkgYnJlYWs7CiAgICBhLnB1c2goLi4uT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmopLmNvbmNhdChPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhvYmopKSk7CiAgICBsZXQgdG1wID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iaik7CiAgICBpZih0bXAgPT09IG9iaikgdG1wID0gbnVsbDsKICAgIG9iaiA9IHRtcDsKICB9CiAgcmV0dXJuIGE7Cn0KCmV4cG9ydCBmdW5jdGlvbiBwcm9wZXJ0aWVzKG9iaiwgb3B0aW9ucyA9IHsgZW51bWVyYWJsZTogdHJ1ZSB9KSB7CiAgbGV0IGRlc2MgPSB7fTsKICBjb25zdCB7IG1lbW9pemU6IG1lbW8gPSBmYWxzZSwgLi4ub3B0cyB9ID0gb3B0aW9uczsKICBjb25zdCBtZm4gPSBtZW1vID8gZm4gPT4gbWVtb2l6ZShmbikgOiBmbiA9PiBmbjsKICBmb3IobGV0IHByb3Agb2Yga2V5cyhvYmopKSB7CiAgICBpZihBcnJheS5pc0FycmF5KG9ialtwcm9wXSkpIHsKICAgICAgY29uc3QgW2dldCwgc2V0XSA9IG9ialtwcm9wXTsKICAgICAgZGVzY1twcm9wXSA9IHsgLi4ub3B0cywgZ2V0LCBzZXQgfTsKICAgIH0gZWxzZSBpZih0eXBlb2Ygb2JqW3Byb3BdID09ICdmdW5jdGlvbicpIHsKICAgICAgZGVzY1twcm9wXSA9IHsgLi4ub3B0cywgZ2V0OiBtZm4ob2JqW3Byb3BdKSB9OwogICAgfQogIH0KICByZXR1cm4gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMoe30sIGRlc2MpOwp9CgpleHBvcnQgZnVuY3Rpb24gd2Vha0Fzc2lnbihvYmosIC4uLmFyZ3MpIHsKICBsZXQgZGVzYyA9IHt9OwogIGZvcihsZXQgb3RoZXIgb2YgYXJncykgewogICAgbGV0IG90aGVyRGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKG90aGVyKTsKICAgIGZvcihsZXQga2V5IGluIG90aGVyRGVzYykgaWYoIShrZXkgaW4gb2JqKSAmJiBkZXNjW2tleV0gPT09IHVuZGVmaW5lZCAmJiBvdGhlckRlc2Nba2V5XSAhPT0gdW5kZWZpbmVkKSBkZXNjW2tleV0gPSBvdGhlckRlc2Nba2V5XTsKICB9CiAgcmV0dXJuIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKG9iaiwgZGVzYyk7Cn0KCmV4cG9ydCBmdW5jdGlvbiBnZXRDb25zdHJ1Y3RvckNoYWluKG9iaikgewogIGxldCByZXQgPSBbXTsKICBsZXQgY2hhaW4gPSBnZXRQcm90b3R5cGVDaGFpbihvYmopOwogIGlmKG9iai5jb25zdHJ1Y3RvciAmJiBvYmouY29uc3RydWN0b3IgIT0gY2hhaW5bMF0uY29uc3RydWN0b3IpIGNoYWluLnVuc2hpZnQob2JqKTsKICBmb3IobGV0IHByb3RvIG9mIGNoYWluKSByZXQucHVzaChwcm90by5jb25zdHJ1Y3Rvcik7CiAgcmV0dXJuIHJldDsKfQoKZXhwb3J0IGZ1bmN0aW9uIGhhc1Byb3RvdHlwZShvYmosIHByb3RvKSB7CiAgcmV0dXJuIGdldFByb3RvdHlwZUNoYWluKG9iaikuaW5kZXhPZihwcm90bykgIT0gLTE7Cn0KCmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXIoc2VxLCBwcmVkLCB0aGlzQXJnKSB7CiAgaWYoaXNPYmplY3QocHJlZCkgJiYgcHJlZCBpbnN0YW5jZW9mIFJlZ0V4cCkgewogICAgbGV0IHJlID0gcHJlZDsKICAgIHByZWQgPSAoZWwsIGkpID0+IHJlLnRlc3QoZWwpOwogIH0KICBsZXQgciA9IFtdLAogICAgaSA9IDA7CiAgZm9yKGxldCBlbCBvZiBzZXEpIHsKICAgIGlmKHByZWQuY2FsbCh0aGlzQXJnLCBlbCwgaSsrLCBzZXEpKSByLnB1c2goZWwpOwogIH0KICByZXR1cm4gcjsKfQoKZXhwb3J0IGNvbnN0IGN1cnJ5ID0KICAoZiwgYXJyID0gW10sIGxlbmd0aCA9IGYubGVuZ3RoKSA9PgogICguLi5hcmdzKSA9PgogICAgKGEgPT4gKGEubGVuZ3RoID09PSBsZW5ndGggPyBmKC4uLmEpIDogY3VycnkoZiwgYSkpKShbLi4uYXJyLCAuLi5hcmdzXSk7CgpleHBvcnQgZnVuY3Rpb24qIHNwbGl0KGJ1ZiwgLi4ucG9pbnRzKSB7CiAgcG9pbnRzLnNvcnQoKTsKICBjb25zdCBzcGxpdEF0ID0gKGIsIHBvcywgbGVuKSA9PiB7CiAgICBsZXQgciA9IHBvcyA8IGIuYnl0ZUxlbmd0aCA/IFtzbGljZShiLCAwLCBwb3MpLCBzbGljZShiLCBwb3MpXSA6IFtudWxsLCBiXTsKICAgIHJldHVybiByOwogIH07CiAgbGV0IHByZXYsCiAgICBsZW4gPSAwOwogIGZvcihsZXQgb2Zmc2V0IG9mIHBvaW50cykgewogICAgbGV0IGF0ID0gb2Zmc2V0IC0gbGVuOwogICAgW3ByZXYsIGJ1Zl0gPSBzcGxpdEF0KGJ1ZiwgYXQsIGxlbik7CiAgICBpZihwcmV2KSB7CiAgICAgIHlpZWxkIHByZXY7CiAgICAgIGxlbiA9IG9mZnNldDsKICAgIH0KICB9CiAgaWYoYnVmKSB5aWVsZCBidWY7Cn0KCmV4cG9ydCBjb25zdCB1bmlxdWUgPSAoYXJyLCBjbXApID0+IGFyci5maWx0ZXIodHlwZW9mIGNtcCA9PSAnZnVuY3Rpb24nID8gKGVsLCBpLCBhcnIpID0+IGFyci5maW5kSW5kZXgoaXRlbSA9PiBjbXAoZWwsIGl0ZW0pKSA9PSBpIDogKGVsLCBpLCBhcnIpID0+IGFyci5pbmRleE9mKGVsKSA9PSBpKTsKCmV4cG9ydCBjb25zdCBnZXRGdW5jdGlvbkFyZ3VtZW50cyA9IGZuID0+CiAgKGZuICsgJycpCiAgICAucmVwbGFjZSgvXG4uKi9nLCAnJykKICAgIC5yZXBsYWNlKC8oPT58e3xcbikuKi9nLCAnJykKICAgIC5yZXBsYWNlKC9eZnVuY3Rpb25ccyovLCAnJykKICAgIC5yZXBsYWNlKC9eXCgoLiopXClccyokL2csICckMScpCiAgICAuc3BsaXQoLyxccyovZyk7Cgpjb25zdCBBTlNJX0JBQ0tHUk9VTkRfT0ZGU0VUID0gMTA7Cgpjb25zdCB3cmFwQW5zaTE2ID0KICAob2Zmc2V0ID0gMCkgPT4KICBjb2RlID0+CiAgICBgXHgxYlske2NvZGUgKyBvZmZzZXR9bWA7Cgpjb25zdCB3cmFwQW5zaTI1NiA9CiAgKG9mZnNldCA9IDApID0+CiAgY29kZSA9PgogICAgYFx4MWJbJHszOCArIG9mZnNldH07NTske2NvZGV9bWA7Cgpjb25zdCB3cmFwQW5zaTE2bSA9CiAgKG9mZnNldCA9IDApID0+CiAgKHJlZCwgZ3JlZW4sIGJsdWUpID0+CiAgICBgXHgxYlskezM4ICsgb2Zmc2V0fTsyOyR7cmVkfTske2dyZWVufTske2JsdWV9bWA7CgpmdW5jdGlvbiBnZXRBbnNpU3R5bGVzKCkgewogIGNvbnN0IGNvZGVzID0gbmV3IE1hcCgpOwogIGNvbnN0IHN0eWxlcyA9IHsKICAgIG1vZGlmaWVyOiB7CiAgICAgIHJlc2V0OiBbMCwgMF0sCiAgICAgIC8vIDIxIGlzbid0IHdpZGVseSBzdXBwb3J0ZWQgYW5kIDIyIGRvZXMgdGhlIHNhbWUgdGhpbmcKICAgICAgYm9sZDogWzEsIDIyXSwKICAgICAgZGltOiBbMiwgMjJdLAogICAgICBpdGFsaWM6IFszLCAyM10sCiAgICAgIHVuZGVybGluZTogWzQsIDI0XSwKICAgICAgb3ZlcmxpbmU6IFs1MywgNTVdLAogICAgICBpbnZlcnNlOiBbNywgMjddLAogICAgICBoaWRkZW46IFs4LCAyOF0sCiAgICAgIHN0cmlrZXRocm91Z2g6IFs5LCAyOV0KICAgIH0sCiAgICBjb2xvcjogewogICAgICBibGFjazogWzMwLCAzOV0sCiAgICAgIHJlZDogWzMxLCAzOV0sCiAgICAgIGdyZWVuOiBbMzIsIDM5XSwKICAgICAgeWVsbG93OiBbMzMsIDM5XSwKICAgICAgYmx1ZTogWzM0LCAzOV0sCiAgICAgIG1hZ2VudGE6IFszNSwgMzldLAogICAgICBjeWFuOiBbMzYsIDM5XSwKICAgICAgd2hpdGU6IFszNywgMzldLAoKICAgICAgLy8gQnJpZ2h0IGNvbG9yCiAgICAgIGJsYWNrQnJpZ2h0OiBbOTAsIDM5XSwKICAgICAgcmVkQnJpZ2h0OiBbOTEsIDM5XSwKICAgICAgZ3JlZW5CcmlnaHQ6IFs5MiwgMzldLAogICAgICB5ZWxsb3dCcmlnaHQ6IFs5MywgMzldLAogICAgICBibHVlQnJpZ2h0OiBbOTQsIDM5XSwKICAgICAgbWFnZW50YUJyaWdodDogWzk1LCAzOV0sCiAgICAgIGN5YW5CcmlnaHQ6IFs5NiwgMzldLAogICAgICB3aGl0ZUJyaWdodDogWzk3LCAzOV0KICAgIH0sCiAgICBiZ0NvbG9yOiB7CiAgICAgIGJnQmxhY2s6IFs0MCwgNDldLAogICAgICBiZ1JlZDogWzQxLCA0OV0sCiAgICAgIGJnR3JlZW46IFs0MiwgNDldLAogICAgICBiZ1llbGxvdzogWzQzLCA0OV0sCiAgICAgIGJnQmx1ZTogWzQ0LCA0OV0sCiAgICAgIGJnTWFnZW50YTogWzQ1LCA0OV0sCiAgICAgIGJnQ3lhbjogWzQ2LCA0OV0sCiAgICAgIGJnV2hpdGU6IFs0NywgNDldLAoKICAgICAgLy8gQnJpZ2h0IGNvbG9yCiAgICAgIGJnQmxhY2tCcmlnaHQ6IFsxMDAsIDQ5XSwKICAgICAgYmdSZWRCcmlnaHQ6IFsxMDEsIDQ5XSwKICAgICAgYmdHcmVlbkJyaWdodDogWzEwMiwgNDldLAogICAgICBiZ1llbGxvd0JyaWdodDogWzEwMywgNDldLAogICAgICBiZ0JsdWVCcmlnaHQ6IFsxMDQsIDQ5XSwKICAgICAgYmdNYWdlbnRhQnJpZ2h0OiBbMTA1LCA0OV0sCiAgICAgIGJnQ3lhbkJyaWdodDogWzEwNiwgNDldLAogICAgICBiZ1doaXRlQnJpZ2h0OiBbMTA3LCA0OV0KICAgIH0KICB9OwoKICAvLyBBbGlhcyBicmlnaHQgYmxhY2sgYXMgZ3JheSAoYW5kIGdyZXkpCiAgc3R5bGVzLmNvbG9yLmdyYXkgPSBzdHlsZXMuY29sb3IuYmxhY2tCcmlnaHQ7CiAgc3R5bGVzLmJnQ29sb3IuYmdHcmF5ID0gc3R5bGVzLmJnQ29sb3IuYmdCbGFja0JyaWdodDsKICBzdHlsZXMuY29sb3IuZ3JleSA9IHN0eWxlcy5jb2xvci5ibGFja0JyaWdodDsKICBzdHlsZXMuYmdDb2xvci5iZ0dyZXkgPSBzdHlsZXMuYmdDb2xvci5iZ0JsYWNrQnJpZ2h0OwoKICBmb3IoY29uc3QgW2dyb3VwTmFtZSwgZ3JvdXBdIG9mIE9iamVjdC5lbnRyaWVzKHN0eWxlcykpIHsKICAgIGZvcihjb25zdCBbc3R5bGVOYW1lLCBzdHlsZV0gb2YgT2JqZWN0LmVudHJpZXMoZ3JvdXApKSB7CiAgICAgIHN0eWxlc1tzdHlsZU5hbWVdID0gewogICAgICAgIG9wZW46IGBcdTAwMUJbJHtzdHlsZVswXX1tYCwKICAgICAgICBjbG9zZTogYFx1MDAxQlske3N0eWxlWzFdfW1gCiAgICAgIH07CgogICAgICBncm91cFtzdHlsZU5hbWVdID0gc3R5bGVzW3N0eWxlTmFtZV07CgogICAgICBjb2Rlcy5zZXQoc3R5bGVbMF0sIHN0eWxlWzFdKTsKICAgIH0KCiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc3R5bGVzLCBncm91cE5hbWUsIHsKICAgICAgdmFsdWU6IGdyb3VwLAogICAgICBlbnVtZXJhYmxlOiBmYWxzZQogICAgfSk7CiAgfQoKICBPYmplY3QuZGVmaW5lUHJvcGVydHkoc3R5bGVzLCAnY29kZXMnLCB7CiAgICB2YWx1ZTogY29kZXMsCiAgICBlbnVtZXJhYmxlOiBmYWxzZQogIH0pOwoKICBzdHlsZXMuY29sb3IuY2xvc2UgPSAnXHUwMDFCWzM5bSc7CiAgc3R5bGVzLmJnQ29sb3IuY2xvc2UgPSAnXHUwMDFCWzQ5bSc7CgogIHN0eWxlcy5jb2xvci5hbnNpID0gd3JhcEFuc2kxNigpOwogIHN0eWxlcy5jb2xvci5hbnNpMjU2ID0gd3JhcEFuc2kyNTYoKTsKICBzdHlsZXMuY29sb3IuYW5zaTE2bSA9IHdyYXBBbnNpMTZtKCk7CiAgc3R5bGVzLmJnQ29sb3IuYW5zaSA9IHdyYXBBbnNpMTYoQU5TSV9CQUNLR1JPVU5EX09GRlNFVCk7CiAgc3R5bGVzLmJnQ29sb3IuYW5zaTI1NiA9IHdyYXBBbnNpMjU2KEFOU0lfQkFDS0dST1VORF9PRkZTRVQpOwogIHN0eWxlcy5iZ0NvbG9yLmFuc2kxNm0gPSB3cmFwQW5zaTE2bShBTlNJX0JBQ0tHUk9VTkRfT0ZGU0VUKTsKCiAgLy8gRnJvbSBodHRwczovL2dpdGh1Yi5jb20vUWl4LS9jb2xvci1jb252ZXJ0L2Jsb2IvM2YwZTBkNGU5MmUyMzU3OTZjY2IxN2Y2ZTg1YzcyMDk0YTY1MWY0OS9jb252ZXJzaW9ucy5qcwogIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHN0eWxlcywgewogICAgcmdiVG9BbnNpMjU2OiB7CiAgICAgIHZhbHVlOiAocmVkLCBncmVlbiwgYmx1ZSkgPT4gewogICAgICAgIC8vIFdlIHVzZSB0aGUgZXh0ZW5kZWQgZ3JleXNjYWxlIHBhbGV0dGUgaGVyZSwgd2l0aCB0aGUgZXhjZXB0aW9uIG9mCiAgICAgICAgLy8gYmxhY2sgYW5kIHdoaXRlLiBub3JtYWwgcGFsZXR0ZSBvbmx5IGhhcyA0IGdyZXlzY2FsZSBzaGFkZXMuCiAgICAgICAgaWYocmVkID09PSBncmVlbiAmJiBncmVlbiA9PT0gYmx1ZSkgewogICAgICAgICAgaWYocmVkIDwgOCkgewogICAgICAgICAgICByZXR1cm4gMTY7CiAgICAgICAgICB9CgogICAgICAgICAgaWYocmVkID4gMjQ4KSB7CiAgICAgICAgICAgIHJldHVybiAyMzE7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIE1hdGgucm91bmQoKChyZWQgLSA4KSAvIDI0NykgKiAyNCkgKyAyMzI7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGMgPSBbcmVkLCBncmVlbiwgYmx1ZV0ubWFwKGMgPT4gKGMgLyAyNTUpICogNSk7CiAgICAgICAgcmV0dXJuIDE2ICsgMzYgKiBjWzBdICsgNiAqIGNbMV0gKyBjWzJdOwogICAgICB9LAogICAgICBlbnVtZXJhYmxlOiBmYWxzZQogICAgfSwKICAgIGhleFRvUmdiOiB7CiAgICAgIHZhbHVlOiBoZXggPT4gewogICAgICAgIGNvbnN0IG1hdGNoZXMgPSAvKD88Y29sb3JTdHJpbmc+W2EtZlxkXXs2fXxbYS1mXGRdezN9KS9pLmV4ZWMoaGV4LnRvU3RyaW5nKDE2KSk7CiAgICAgICAgaWYoIW1hdGNoZXMpIHsKICAgICAgICAgIHJldHVybiBbMCwgMCwgMF07CiAgICAgICAgfQoKICAgICAgICBsZXQgeyBjb2xvclN0cmluZyB9ID0gbWF0Y2hlcy5ncm91cHM7CgogICAgICAgIGlmKGNvbG9yU3RyaW5nLmxlbmd0aCA9PT0gMykgewogICAgICAgICAgY29sb3JTdHJpbmcgPSBjb2xvclN0cmluZwogICAgICAgICAgICAuc3BsaXQoJycpCiAgICAgICAgICAgIC5tYXAoY2hhcmFjdGVyID0+IGNoYXJhY3RlciArIGNoYXJhY3RlcikKICAgICAgICAgICAgLmpvaW4oJycpOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgaW50ZWdlciA9IE51bWJlci5wYXJzZUludChjb2xvclN0cmluZywgMTYpOwoKICAgICAgICByZXR1cm4gWyhpbnRlZ2VyID4+IDE2KSAmIDB4ZmYsIChpbnRlZ2VyID4+IDgpICYgMHhmZiwgaW50ZWdlciAmIDB4ZmZdOwogICAgICB9LAogICAgICBlbnVtZXJhYmxlOiBmYWxzZQogICAgfSwKICAgIGhleFRvQW5zaTI1NjogewogICAgICB2YWx1ZTogaGV4ID0+IHN0eWxlcy5yZ2JUb0Fuc2kyNTYoLi4uc3R5bGVzLmhleFRvUmdiKGhleCkpLAogICAgICBlbnVtZXJhYmxlOiBmYWxzZQogICAgfSwKICAgIGFuc2kyNTZUb0Fuc2k6IHsKICAgICAgdmFsdWU6IGNvZGUgPT4gewogICAgICAgIGlmKGNvZGUgPCA4KSB7CiAgICAgICAgICByZXR1cm4gMzAgKyBjb2RlOwogICAgICAgIH0KCiAgICAgICAgaWYoY29kZSA8IDE2KSB7CiAgICAgICAgICByZXR1cm4gOTAgKyAoY29kZSAtIDgpOwogICAgICAgIH0KCiAgICAgICAgbGV0IHJlZDsKICAgICAgICBsZXQgZ3JlZW47CiAgICAgICAgbGV0IGJsdWU7CgogICAgICAgIGlmKGNvZGUgPj0gMjMyKSB7CiAgICAgICAgICByZWQgPSAoKGNvZGUgLSAyMzIpICogMTAgKyA4KSAvIDI1NTsKICAgICAgICAgIGdyZWVuID0gcmVkOwogICAgICAgICAgYmx1ZSA9IHJlZDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29kZSAtPSAxNjsKCiAgICAgICAgICBjb25zdCByZW1haW5kZXIgPSBjb2RlICUgMzY7CgogICAgICAgICAgcmVkID0gTWF0aC5mbG9vcihjb2RlIC8gMzYpICogMC4yOwogICAgICAgICAgZ3JlZW4gPSBNYXRoLmZsb29yKHJlbWFpbmRlciAvIDYpICogMC4yOwogICAgICAgICAgYmx1ZSA9IChyZW1haW5kZXIgJSA2KSAqIDAuMjsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHZhbHVlID0gTWF0aC5tYXgocmVkLCBncmVlbiwgYmx1ZSkgKiAyOwoKICAgICAgICBpZih2YWx1ZSA9PT0gMCkgewogICAgICAgICAgcmV0dXJuIDMwOwogICAgICAgIH0KCiAgICAgICAgbGV0IHJlc3VsdCA9IDMwICsgKChNYXRoLnJvdW5kKGJsdWUpIDw8IDIpIHwgKE1hdGgucm91bmQoZ3JlZW4pIDw8IDEpIHwgTWF0aC5yb3VuZChyZWQpKTsKCiAgICAgICAgaWYodmFsdWUgPT09IDIpIHsKICAgICAgICAgIHJlc3VsdCArPSA2MDsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXN1bHQ7CiAgICAgIH0sCiAgICAgIGVudW1lcmFibGU6IGZhbHNlCiAgICB9LAogICAgcmdiVG9BbnNpOiB7CiAgICAgIHZhbHVlOiAocmVkLCBncmVlbiwgYmx1ZSkgPT4gc3R5bGVzLmFuc2kyNTZUb0Fuc2koc3R5bGVzLnJnYlRvQW5zaTI1NihyZWQsIGdyZWVuLCBibHVlKSksCiAgICAgIGVudW1lcmFibGU6IGZhbHNlCiAgICB9LAogICAgaGV4VG9BbnNpOiB7CiAgICAgIHZhbHVlOiBoZXggPT4gc3R5bGVzLmFuc2kyNTZUb0Fuc2koc3R5bGVzLmhleFRvQW5zaTI1NihoZXgpKSwKICAgICAgZW51bWVyYWJsZTogZmFsc2UKICAgIH0KICB9KTsKCiAgcmV0dXJuIHN0eWxlczsKfQoKZXhwb3J0IGZ1bmN0aW9uIHJhbmRJbnQoLi4uYXJncykgewogIGxldCByYW5nZSA9IGFyZ3Muc3BsaWNlKDAsIDIpOwogIGxldCBybmcgPSBhcmdzLnNoaWZ0KCkgPz8gTWF0aC5yYW5kb207CiAgaWYocmFuZ2UubGVuZ3RoIDwgMikgcmFuZ2UudW5zaGlmdCgwKTsKICByZXR1cm4gTWF0aC5yb3VuZCgKICByYW5kKHJhbmdlWzFdIC0gcmFuZ2VbMF0gKyAxKSArIHJhbmdlWzBdKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIHJhbmRGbG9hdChtaW4sIG1heCwgcm5nID0gTWF0aC5yYW5kb20pIHsKICByZXR1cm4gcm5nKCkgKiAobWF4IC0gbWluKSArIG1pbjsKfQoKZXhwb3J0IGZ1bmN0aW9uIHJhbmRTdHIobiwgc2V0ID0gJ18wMTIzNDU2Nzg5QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicsIHJuZyA9IE1hdGgucmFuZG9tKSB7CiAgbGV0IG8gPSAnJzsKCiAgd2hpbGUoLS1uID49IDApIG8gKz0gc2V0W01hdGgucm91bmQocm5nKCkgKiAoc2V0Lmxlbmd0aCAtIDEpKV07CiAgcmV0dXJuIG87Cn0KCmV4cG9ydCBmdW5jdGlvbiB0b0JpZ0ludChhcmcpIHsKICBpZih0eXBlcy5pc0FycmF5QnVmZmVyKGFyZykpIHsKICAgIGNvbnN0IGJpdHMgPSBtaXNjLmJpdHMoYXJnKS5qb2luKCcnKTsKICAgIHJldHVybiBldmFsKGAwYiR7Yml0c31uYCk7CiAgfQogIHJldHVybiBCaWdJbnQoYXJnKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIHJvdW5kVG8odmFsdWUsIHByZWMsIGRpZ2l0cywgdHlwZSkgewogIGlmKCFOdW1iZXIuaXNGaW5pdGUodmFsdWUpKSByZXR1cm4gdmFsdWU7CiAgdHlwZSA9IHR5cGUgPz8gJ3JvdW5kJzsKICBjb25zdCBmbiA9IE1hdGhbdHlwZV07CiAgaWYocHJlYyA9PSAxKSByZXR1cm4gZm4odmFsdWUpOwogIGxldCByZXQgPSBwcmVjID4gTnVtYmVyLkVQU0lMT04gPyBmbih2YWx1ZSAvIHByZWMpICogcHJlYyA6IHZhbHVlOwoKICBpZihpc051bWJlcihkaWdpdHMpICYmIGRpZ2l0cyA+PSAxICYmIGRpZ2l0cyA8PSAxMDApIHJldCA9ICtyZXQudG9GaXhlZChkaWdpdHMpOwogIGVsc2UgcmV0ID0gTWF0aFt0eXBlXShyZXQpOwogIHJldHVybiByZXQ7Cn0KCmV4cG9ydCBmdW5jdGlvbiBsYXp5UHJvcGVydHkob2JqLCBuYW1lLCBnZXR0ZXIsIG9wdHMgPSB7fSkgewogIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBuYW1lLCB7CiAgICBnZXQ6IHR5cGVzLmlzQXN5bmNGdW5jdGlvbihnZXR0ZXIpCiAgICAgID8gYXN5bmMgZnVuY3Rpb24oKSB7CiAgICAgICAgICByZXR1cm4gcmVwbGFjZVByb3BlcnR5KGF3YWl0IGdldHRlci5jYWxsKHRoaXMgPz8gb2JqLCBuYW1lKSk7CiAgICAgICAgfQogICAgICA6IGZ1bmN0aW9uKCkgewogICAgICAgICAgY29uc3QgdmFsdWUgPSBnZXR0ZXIuY2FsbCh0aGlzID8/IG9iaiwgbmFtZSk7CiAgICAgICAgICBpZih0eXBlcy5pc1Byb21pc2UodmFsdWUpKSB7CiAgICAgICAgICAgIHZhbHVlLnRoZW4odiA9PiB7CiAgICAgICAgICAgICAgcmVwbGFjZVByb3BlcnR5KHYpOwogICAgICAgICAgICAgIGNvbnNvbGUubG9nKGB1dGlsLmxhenlQcm9wZXJ0eSByZXNvbHZlZCBgLCBvYmpbbmFtZV0pOwogICAgICAgICAgICAgIHJldHVybiB2OwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIHJlcGxhY2VQcm9wZXJ0eSh2YWx1ZSk7CiAgICAgICAgfSwKICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgIC4uLm9wdHMKICB9KTsKCiAgZnVuY3Rpb24gcmVwbGFjZVByb3BlcnR5KHZhbHVlKSB7CiAgICBkZWxldGUgb2JqW25hbWVdOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwgbmFtZSwgeyB2YWx1ZSwgLi4ub3B0cyB9KTsKICAgIHJldHVybiB2YWx1ZTsKICB9Cn0KCmV4cG9ydCBmdW5jdGlvbiBsYXp5UHJvcGVydGllcyhvYmosIGdldHRlcnNPYmosIG9wdHMgPSB7fSkgewogIG9wdHMgPSB7IGVudW1lcmFibGU6IGZhbHNlLCAuLi5vcHRzIH07CiAgZm9yKGxldCBwcm9wIG9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGdldHRlcnNPYmopKSBsYXp5UHJvcGVydHkob2JqLCBwcm9wLCBnZXR0ZXJzT2JqW3Byb3BdLCBvcHRzKTsKICByZXR1cm4gb2JqOwp9CgpleHBvcnQgZnVuY3Rpb24gZ2V0T3B0KG9wdGlvbnMgPSB7fSwgYXJncykgewogIGxldCBzaG9ydCwgbG9uZzsKICBsZXQgcmVzdWx0ID0ge307CiAgbGV0IHBvc2l0aW9uYWwgPSAocmVzdWx0WydAJ10gPSBbXSk7CiAgaWYoIShvcHRpb25zIGluc3RhbmNlb2YgQXJyYXkpKSBvcHRpb25zID0gT2JqZWN0LmVudHJpZXMob3B0aW9ucyk7CiAgY29uc3QgZmluZE9wdCA9IGFyZyA9PiBvcHRpb25zLmZpbmQoKFtvcHRuYW1lLCBvcHRpb25dKSA9PiAoQXJyYXkuaXNBcnJheShvcHRpb24pID8gb3B0aW9uLmluZGV4T2YoYXJnKSAhPSAtMSA6IGZhbHNlKSB8fCBhcmcgPT0gb3B0bmFtZSk7CiAgbGV0IFssIHBhcmFtc10gPSBvcHRpb25zLmZpbmQob3B0ID0+IG9wdFswXSA9PSAnQCcpIHx8IFtdOwogIGlmKHR5cGVvZiBwYXJhbXMgPT0gJ3N0cmluZycpIHBhcmFtcyA9IHBhcmFtcy5zcGxpdCgnLCcpOwogIGZvcihsZXQgaSA9IDA7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7CiAgICBjb25zdCBhcmcgPSBhcmdzW2ldOwogICAgbGV0IG9wdDsKICAgIGlmKGFyZ1swXSA9PSAnLScpIHsKICAgICAgbGV0IG5hbWUsIHZhbHVlLCBzdGFydCwgZW5kOwogICAgICBpZihhcmdbMV0gPT0gJy0nKSBsb25nID0gdHJ1ZTsKICAgICAgZWxzZSBzaG9ydCA9IHRydWU7CiAgICAgIHN0YXJ0ID0gc2hvcnQgPyAxIDogMjsKICAgICAgaWYoc2hvcnQpIGVuZCA9IDI7CiAgICAgIGVsc2UgaWYoKGVuZCA9IGFyZy5pbmRleE9mKCc9JykpID09IC0xKSBlbmQgPSBhcmcubGVuZ3RoOwogICAgICBuYW1lID0gYXJnLnN1YnN0cmluZyhzdGFydCwgZW5kKTsKICAgICAgaWYoKG9wdCA9IGZpbmRPcHQobmFtZSkpKSB7CiAgICAgICAgY29uc3QgW2hhc19hcmcsIGhhbmRsZXJdID0gb3B0WzFdOwogICAgICAgIGlmKGhhc19hcmcpIHsKICAgICAgICAgIGlmKGFyZy5sZW5ndGggPiBlbmQpIHZhbHVlID0gYXJnLnN1YnN0cmluZyhlbmQgKyAoYXJnW2VuZF0gPT0gJz0nKSk7CiAgICAgICAgICBlbHNlIHZhbHVlID0gYXJnc1srK2ldOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YWx1ZSA9IHRydWU7CiAgICAgICAgfQogICAgICAgIHRyeSB7CiAgICAgICAgICB2YWx1ZSA9IGhhbmRsZXIodmFsdWUsIHJlc3VsdFtvcHRbMF1dLCBvcHRpb25zLCByZXN1bHQpOwogICAgICAgIH0gY2F0Y2goZSkge30KICAgICAgICByZXN1bHRbb3B0WzBdXSA9IHZhbHVlOwogICAgICAgIGNvbnRpbnVlOwogICAgICB9CiAgICB9CiAgICBpZihwYXJhbXMubGVuZ3RoKSB7CiAgICAgIGNvbnN0IHBhcmFtID0gcGFyYW1zLnNoaWZ0KCk7CiAgICAgIGlmKChvcHQgPSBmaW5kT3B0KHBhcmFtKSkpIHsKICAgICAgICBjb25zdCBbLCBbLCBoYW5kbGVyXV0gPSBvcHQ7CiAgICAgICAgbGV0IHZhbHVlID0gYXJnOwogICAgICAgIGlmKHR5cGVvZiBoYW5kbGVyID09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIHZhbHVlID0gaGFuZGxlcih2YWx1ZSwgcmVzdWx0W29wdFswXV0sIG9wdGlvbnMsIHJlc3VsdCk7CiAgICAgICAgICB9IGNhdGNoKGUpIHt9CiAgICAgICAgfQogICAgICAgIGNvbnN0IG5hbWUgPSBvcHRbMF07CiAgICAgICAgcmVzdWx0W29wdFswXV0gPSB2YWx1ZTsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgfQogICAgcmVzdWx0WydAJ10gPSBbLi4uKHJlc3VsdFsnQCddID8/IFtdKSwgYXJnXTsKICB9CiAgcmV0dXJuIHJlc3VsdDsKfQoKZXhwb3J0IGZ1bmN0aW9uIHRvVW5peFRpbWUoZGF0ZU9iaiwgdXRjID0gZmFsc2UpIHsKICBpZighKGRhdGVPYmogaW5zdGFuY2VvZiBEYXRlKSkgZGF0ZU9iaiA9IG5ldyBEYXRlKGRhdGVPYmopOwogIGxldCBlcG9jaCA9IE1hdGguZmxvb3IoZGF0ZU9iai5nZXRUaW1lKCkgLyAxMDAwKTsKICBpZih1dGMpIGVwb2NoICs9IGRhdGVPYmouZ2V0VGltZXpvbmVPZmZzZXQoKSAqIDYwOwogIHJldHVybiBlcG9jaDsKfQoKZXhwb3J0IGZ1bmN0aW9uIHVuaXhUaW1lKHV0YyA9IGZhbHNlKSB7CiAgcmV0dXJuIHRvVW5peFRpbWUobmV3IERhdGUoKSwgdXRjKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGZyb21Vbml4VGltZShlcG9jaCwgdXRjID0gZmFsc2UpIHsKICBsZXQgdCA9IHBhcnNlSW50KGVwb2NoKTsKICBsZXQgZCA9IG5ldyBEYXRlKDApOwogIHV0YyA/IGQuc2V0VVRDU2Vjb25kcyh0KSA6IGQuc2V0U2Vjb25kcyh0KTsKICByZXR1cm4gZDsKfQoKZXhwb3J0IGZ1bmN0aW9uIHJhbmdlKC4uLmFyZ3MpIHsKICBsZXQgW3N0YXJ0LCBlbmQsIHN0ZXAgPSAxXSA9IGFyZ3M7CiAgbGV0IHJldDsKICBzdGFydCAvPSBzdGVwOwogIGVuZCAvPSBzdGVwOwogIGlmKHN0YXJ0ID4gZW5kKSB7CiAgICByZXQgPSBbXTsKICAgIHdoaWxlKHN0YXJ0ID49IGVuZCkgcmV0LnB1c2goc3RhcnQtLSk7CiAgfSBlbHNlIHsKICAgIHJldCA9IEFycmF5LmZyb20oeyBsZW5ndGg6IGVuZCAtIHN0YXJ0ICsgMSB9LCAodiwgaykgPT4gayArIHN0YXJ0KTsKICB9CiAgaWYoc3RlcCAhPSAxKSB7CiAgICByZXQgPSByZXQubWFwKG4gPT4gbiAqIHN0ZXApOwogIH0KICByZXR1cm4gcmV0Owp9CgpleHBvcnQgZnVuY3Rpb24gcmVwZWF0ZXIobiwgd2hhdCkgewogIGlmKHR5cGVvZiB3aGF0ID09ICdmdW5jdGlvbicpCiAgICByZXR1cm4gKGZ1bmN0aW9uKiAoKSB7CiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBuOyBpKyspIHlpZWxkIHdoYXQoKTsKICAgIH0pKCk7CiAgcmV0dXJuIChmdW5jdGlvbiogKCkgewogICAgZm9yKGxldCBpID0gMDsgaSA8IG47IGkrKykgeWllbGQgd2hhdDsKICB9KSgpOwp9CgpleHBvcnQgZnVuY3Rpb24gcmVwZWF0KG4sIHdoYXQpIHsKICByZXR1cm4gWy4uLnJlcGVhdGVyKG4sIHdoYXQpXTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGNodW5rQXJyYXkoYXJyLCBzaXplKSB7CiAgY29uc3QgZm4gPSAoYSwgdiwgaSkgPT4gewogICAgY29uc3QgaiA9IGkgJSBzaXplOwogICAgaWYoaiA9PSAwKSBhLnB1c2goW10pOwogICAgYVthLmxlbmd0aCAtIDFdLnB1c2godik7CiAgICByZXR1cm4gYTsKICB9OwoKICByZXR1cm4gYXJyLnJlZHVjZShmbiwgW10pOwp9CgpleHBvcnQgZnVuY3Rpb24gdWNmaXJzdChzdHIpIHsKICBpZih0eXBlb2Ygc3RyICE9ICdzdHJpbmcnKSBzdHIgPSBzdHIgKyAnJzsKICByZXR1cm4gc3RyLnN1YnN0cmluZygwLCAxKS50b1VwcGVyQ2FzZSgpICsgc3RyLnN1YnN0cmluZygxKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGxjZmlyc3Qoc3RyKSB7CiAgaWYodHlwZW9mIHN0ciAhPSAnc3RyaW5nJykgc3RyID0gc3RyICsgJyc7CiAgcmV0dXJuIHN0ci5zdWJzdHJpbmcoMCwgMSkudG9Mb3dlckNhc2UoKSArIHN0ci5zdWJzdHJpbmcoMSk7Cn0KCmV4cG9ydCBmdW5jdGlvbiBjYW1lbGl6ZShzdHIsIGRlbGltID0gJycpIHsKICByZXR1cm4gc3RyLnJlcGxhY2UoL14oW0EtWl0pfFtccy1fXSsoXHcpL2csIChtYXRjaCwgcDEsIHAyLCBvZmZzZXQpID0+IHsKICAgIGlmKHAyKSByZXR1cm4gZGVsaW0gKyBwMi50b1VwcGVyQ2FzZSgpOwogICAgcmV0dXJuIHAxLnRvTG93ZXJDYXNlKCk7CiAgfSk7Cn0KCmV4cG9ydCBmdW5jdGlvbiBkZWNhbWVsaXplKHN0ciwgZGVsaW0gPSAnLScpIHsKICByZXR1cm4gLy5bQS1aXS8udGVzdChzdHIpCiAgICA/IHN0cgogICAgICAgIC5yZXBsYWNlKC8oW2EtelxkXSkoW0EtWl0pL2csICckMScgKyBkZWxpbSArICckMicpCiAgICAgICAgLnJlcGxhY2UoLyhbQS1aXSspKFtBLVpdW2EtelxkXSspL2csICckMScgKyBkZWxpbSArICckMicpCiAgICAgICAgLnRvTG93ZXJDYXNlKCkKICAgIDogc3RyOwp9CgpleHBvcnQgZnVuY3Rpb24gc2hvcnRlbihzdHIsIG1heCA9IDQwLCBzdWZmaXggPSAnLi4uJykgewogIG1heCA9ICttYXg7CiAgaWYoaXNOYU4obWF4KSkgbWF4ID0gSW5maW5pdHk7CiAgaWYoQXJyYXkuaXNBcnJheShzdHIpKSByZXR1cm4gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoc3RyLCAwLCBNYXRoLm1pbihzdHIubGVuZ3RoLCBtYXgpKS5jb25jYXQoW3N1ZmZpeF0pOwogIGlmKHR5cGVvZiBzdHIgIT0gJ3N0cmluZycgfHwgIU51bWJlci5pc0Zpbml0ZShtYXgpIHx8IG1heCA8IDApIHJldHVybiBzdHI7CiAgc3RyID0gJycgKyBzdHI7CgogIGlmKHN0ci5sZW5ndGggPiBtYXgpIHsKICAgIGxldCBuID0gTWF0aC5mbG9vcigobWF4IC0gKDIgKyBzdWZmaXgubGVuZ3RoKSkgLyAyKTsKICAgIGxldCB0YWlsID0gc3RyLmxlbmd0aCAtIG47CiAgICBsZXQgbGVuID0gTWF0aC5taW4obiwgdGFpbCk7CiAgICBsZXQgaW5zZXJ0ID0gJyAnICsgc3VmZml4ICsgJyAnICsgKHN0ci5sZW5ndGggLSAobGVuICsgbikpICsgJyBieXRlcyAnICsgc3VmZml4ICsgJyAnOwoKICAgIHJldHVybiBzdHIuc3Vic3RyaW5nKDAsIGxlbikgKyBpbnNlcnQgKyBzdHIuc3Vic3RyaW5nKHRhaWwpOwogIH0KICByZXR1cm4gc3RyOwp9CgpleHBvcnQgZnVuY3Rpb24gYXJyYXlzSW5Db21tb24oYSkgewogIGxldCBpLAogICAgYywKICAgIG4gPSBhLmxlbmd0aCwKICAgIG1pbiA9IEluZmluaXR5OwogIHdoaWxlKG4pIHsKICAgIGlmKGFbLS1uXS5sZW5ndGggPCBtaW4pIHsKICAgICAgbWluID0gYVtuXS5sZW5ndGg7CiAgICAgIGkgPSBuOwogICAgfQogIH0KICBjID0gQXJyYXkuZnJvbShhLnNwbGljZShpLCAxKVswXSk7CiAgcmV0dXJuIGMuZmlsdGVyKChpdG0sIGluZHgpID0+IHsKICAgIGlmKGMuaW5kZXhPZihpdG0pID09IGluZHgpIHJldHVybiBhLmV2ZXJ5KGFyciA9PiBhcnIuaW5kZXhPZihpdG0pICE9IC0xKTsKICB9KTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGFycmF5RmFjYWRlKHByb3RvLCBpdGVtRm4gPSAoY29udGFpbmVyLCBpKSA9PiBjb250YWluZXIuYXQoaSkpIHsKICByZXR1cm4gZGVmaW5lKHByb3RvLCB7CiAgICAqW1N5bWJvbC5pdGVyYXRvcl0oKSB7CiAgICAgIGNvbnN0IHsgbGVuZ3RoIH0gPSB0aGlzOwogICAgICBmb3IobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHlpZWxkIGl0ZW1Gbih0aGlzLCBpKTsKICAgIH0sCiAgICAqa2V5cygpIHsKICAgICAgY29uc3QgeyBsZW5ndGggfSA9IHRoaXM7CiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgeWllbGQgaTsKICAgIH0sCiAgICAqZW50cmllcygpIHsKICAgICAgY29uc3QgeyBsZW5ndGggfSA9IHRoaXM7CiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgeWllbGQgW2ksIGl0ZW1Gbih0aGlzLCBpKV07CiAgICB9LAogICAgKnZhbHVlcygpIHsKICAgICAgY29uc3QgeyBsZW5ndGggfSA9IHRoaXM7CiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgeWllbGQgaXRlbUZuKHRoaXMsIGkpOwogICAgfSwKICAgIGZvckVhY2goY2FsbGJhY2ssIHRoaXNBcmcpIHsKICAgICAgY29uc3QgeyBsZW5ndGggfSA9IHRoaXM7CiAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgY2FsbGJhY2suY2FsbCh0aGlzQXJnLCBpdGVtRm4odGhpcywgaSksIGksIHRoaXMpOwogICAgfSwKICAgIHJlZHVjZShjYWxsYmFjaywgYWNjdSwgdGhpc0FyZykgewogICAgICBjb25zdCB7IGxlbmd0aCB9ID0gdGhpczsKICAgICAgZm9yKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSBhY2N1ID0gY2FsbGJhY2suY2FsbCh0aGlzQXJnLCBhY2N1LCBpdGVtRm4odGhpcywgaSksIGksIHRoaXMpOwogICAgICByZXR1cm4gYWNjdTsKICAgIH0KICB9KTsKfQoKZXhwb3J0IGZ1bmN0aW9uIG1vZChhLCBiKSB7CiAgcmV0dXJuIHR5cGVvZiBiID09ICdudW1iZXInID8gKChhICUgYikgKyBiKSAlIGIgOiBuID0+ICgobiAlIGEpICsgYSkgJSBhOwp9CgpleHBvcnQgZnVuY3Rpb24gcHVzaFVuaXF1ZShhcnIsIC4uLmFyZ3MpIHsKICBsZXQgcmVqZWN0ID0gW107CiAgZm9yKGxldCBhcmcgb2YgYXJncykKICAgIGlmKGFyci5pbmRleE9mKGFyZykgPT0gLTEpIGFyci5wdXNoKGFyZyk7CiAgICBlbHNlIHJlamVjdC5wdXNoKGFyZyk7CiAgcmV0dXJuIHJlamVjdDsKfQoKZXhwb3J0IGZ1bmN0aW9uIGludGVyc2VjdChhLCBiKSB7CiAgaWYoIUFycmF5LmlzQXJyYXkoYSkpIGEgPSBbLi4uYV07CiAgcmV0dXJuIGEuZmlsdGVyKFNldC5wcm90b3R5cGUuaGFzLCBuZXcgU2V0KGIpKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIHN5bW1ldHJpY0RpZmZlcmVuY2UoYSwgYikgewogIHJldHVybiBbXS5jb25jYXQoLi4uZGlmZmVyZW5jZShhLCBiKSk7Cn0KCmV4cG9ydCBmdW5jdGlvbiogcGFydGl0aW9uQXJyYXkoYSwgc2l6ZSkgewogIGZvcihsZXQgaSA9IDA7IGkgPCBhLmxlbmd0aDsgaSArPSBzaXplKSB5aWVsZCBhLnNsaWNlKGksIGkgKyBzaXplKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGRpZmZlcmVuY2UoYSwgYiwgaW5jbHVkZXMpIHsKICBpZighQXJyYXkuaXNBcnJheShhKSkgYSA9IFsuLi5hXTsKICBpZighQXJyYXkuaXNBcnJheShiKSkgYiA9IFsuLi5iXTsKCiAgaWYodHlwZW9mIGluY2x1ZGVzICE9ICdmdW5jdGlvbicpIHJldHVybiBbYS5maWx0ZXIoeCA9PiAhYi5pbmNsdWRlcyh4KSksIGIuZmlsdGVyKHggPT4gIWEuaW5jbHVkZXMoeCkpXTsKCiAgcmV0dXJuIFthLmZpbHRlcih4ID0+ICFpbmNsdWRlcyhiLCB4KSksIGIuZmlsdGVyKHggPT4gIWluY2x1ZGVzKGEsIHgpKV07Cn0KCmV4cG9ydCBmdW5jdGlvbiBpbnRlcnNlY3Rpb24oYSwgYikgewogIGlmKCEoYSBpbnN0YW5jZW9mIFNldCkpIGEgPSBuZXcgU2V0KGEpOwogIGlmKCEoYiBpbnN0YW5jZW9mIFNldCkpIGIgPSBuZXcgU2V0KGIpOwogIGxldCBpbnRlcnNlY3Rpb24gPSBuZXcgU2V0KFsuLi5hXS5maWx0ZXIoeCA9PiBiLmhhcyh4KSkpOwogIHJldHVybiBBcnJheS5mcm9tKGludGVyc2VjdGlvbik7Cn0KCmV4cG9ydCBmdW5jdGlvbiB1bmlvbihhLCBiLCBlcXVhbGl0eSkgewogIGlmKGVxdWFsaXR5ID09PSB1bmRlZmluZWQpIHJldHVybiBbLi4ubmV3IFNldChbLi4uYSwgLi4uYl0pXTsKCiAgcmV0dXJuIHVuaXF1ZShbLi4uYSwgLi4uYl0sIGVxdWFsaXR5KTsKfQoKLyoqCiAqIGFjY2VwdHMgYXJyYXkgYW5kIGZ1bmN0aW9uIHJldHVybmluZyBgdHJ1ZWAgb3IgYGZhbHNlYCBmb3IgZWFjaCBlbGVtZW50CiAqCiAqIEBwYXJhbSAge1t0eXBlXX0gICBhcnJheSAgICBbZGVzY3JpcHRpb25dCiAqIEBwYXJhbSAge0Z1bmN0aW9ufSBjYWxsYmFjayBbZGVzY3JpcHRpb25dCiAqIEByZXR1cm4ge1t0eXBlXX0gICAgICAgICAgICBbZGVzY3JpcHRpb25dCiAqLwpleHBvcnQgZnVuY3Rpb24gcGFydGl0aW9uKGFycmF5LCBjYWxsYmFjaykgewogIGNvbnN0IG1hdGNoZXMgPSBbXSwKICAgIG5vbk1hdGNoZXMgPSBbXTsKCiAgLy8gcHVzaCBlYWNoIGVsZW1lbnQgaW50byBhcnJheSBkZXBlbmRpbmcgb24gcmV0dXJuIHZhbHVlIG9mIGBjYWxsYmFja2AKICBmb3IobGV0IGVsZW1lbnQgb2YgYXJyYXkpIChjYWxsYmFjayhlbGVtZW50KSA/IG1hdGNoZXMgOiBub25NYXRjaGVzKS5wdXNoKGVsZW1lbnQpOwoKICByZXR1cm4gW21hdGNoZXMsIG5vbk1hdGNoZXNdOwp9CgpleHBvcnQgZnVuY3Rpb24gTG9jYXRpb24obGluZSwgY29sdW1uLCBwb3MsIGZpbGUsIGZyZWV6ZSA9IHRydWUpIHsKICBsZXQgb2JqID0gdGhpcyB8fCBuZXcudGFyZ2V0LnRlc3QgfHwgdGhpcyA/IHRoaXMgOiB7fTsKCiAgLypjb25zb2xlLmxvZygib2JqLmNvbnN0cnVjdG9yOiIsb2JqLmNvbnN0cnVjdG9yKTsKICAvL2NvbnNvbGUubG9nKCJmcmVlemU6IixmcmVlemUpOyovCiAgT2JqZWN0LmFzc2lnbihvYmosIHsKICAgIGxpbmUsCiAgICBjb2x1bW4sCiAgICBwb3MsCiAgICBmaWxlCiAgfSk7CiAgaWYodGhpcyAhPT0gb2JqKSBPYmplY3Quc2V0UHJvdG90eXBlT2Yob2JqLCBMb2NhdGlvbi5wcm90b3R5cGUpOwoKICByZXR1cm4gZnJlZXplICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gTG9jYXRpb24gPyBPYmplY3QuZnJlZXplKG9iaikgOiBvYmo7Cn0KCmV4cG9ydCBmdW5jdGlvbiBmb3JtYXQoLi4uYXJncykgewogIHJldHVybiBmb3JtYXRXaXRoT3B0aW9uc0ludGVybmFsKHsgaGlkZUtleXM6IFsnY29uc3RydWN0b3InXSB9LCBhcmdzKTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdFdpdGhPcHRpb25zKG9wdHMsIC4uLmFyZ3MpIHsKICBpZighaXNPYmplY3Qob3B0cykpIHRocm93IG5ldyBUeXBlRXJyb3IoYG9wdGlvbnMgYXJndW1lbnQgaXMgbm90IGFuIG9iamVjdGApOwogIHJldHVybiBmb3JtYXRXaXRoT3B0aW9uc0ludGVybmFsKG9wdHMsIGFyZ3MpOwp9CgpmdW5jdGlvbiBmb3JtYXRXaXRoT3B0aW9uc0ludGVybmFsKG8sIHYpIHsKICBjb25zdCB4ID0gdlswXTsKICBsZXQgYSA9IDA7CiAgbGV0IHMgPSAnJzsKICBsZXQgaiA9ICcnOwogIGlmKHR5cGVvZiB4ID09PSAnc3RyaW5nJykgewogICAgaWYodi5sZW5ndGggPT09IDEpIHJldHVybiB4OwogICAgbGV0IHQ7CiAgICBsZXQgcCA9IDA7CiAgICBmb3IobGV0IGkgPSAwOyBpIDwgeC5sZW5ndGggLSAxOyBpKyspIHsKICAgICAgaWYoeFtpXSA9PSAnJScpIHsKICAgICAgICBsZXQgZiA9ICcnOwogICAgICAgIHdoaWxlKCdzanhkT29pZmMlJy5pbmRleE9mKHhbaSArIDFdKSA9PSAtMSkgewogICAgICAgICAgZiArPSB4W2kgKyAxXTsKICAgICAgICAgICsraTsKICAgICAgICB9CiAgICAgICAgaWYocCA8IGkpIHMgKz0gc2xpY2UoeCwgcCwgaSk7CiAgICAgICAgcCA9IGkgKyAxOwoKICAgICAgICBjb25zdCBjID0gU3RyaW5nLnByb3RvdHlwZS5jaGFyQ29kZUF0LmNhbGwoeCwgKytpKTsKICAgICAgICBpZihhICsgMSAhPT0gdi5sZW5ndGgpIHsKICAgICAgICAgIHN3aXRjaCAoYykgewogICAgICAgICAgICBjYXNlIDExNTogLy8gJXMKICAgICAgICAgICAgICBjb25zdCB5ID0gdlsrK2FdOwogICAgICAgICAgICAgIGlmKHR5cGVvZiB5ID09PSAnbnVtYmVyJykgdCA9IGZvcm1hdE51bWJlcih5KTsKICAgICAgICAgICAgICBlbHNlIGlmKHR5cGVvZiB5ID09PSAnYmlnaW50JykgdCA9IGAke3l9bmA7CiAgICAgICAgICAgICAgZWxzZSBpZih0eXBlb2YgeSAhPT0gJ29iamVjdCcgfHwgeSA9PT0gbnVsbCB8fCAhaGFzQnVpbHRJbih5LCAndG9TdHJpbmcnKSkgdCA9IFN0cmluZyh5KTsKICAgICAgICAgICAgICBlbHNlIHQgPSBpbnNwZWN0KHksIHsgLi4ubywgY29tcGFjdDogMywgY29sb3JzOiBmYWxzZSwgZGVwdGg6IDAgfSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMTA2OiAvLyAlagogICAgICAgICAgICAgIHQgPSBzdHJpbmdpZnkodlsrK2FdKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxMjA6IC8vICV4CiAgICAgICAgICAgIGNhc2UgMTAwOiAvLyAlZAogICAgICAgICAgICAgIGNvbnN0IG4gPSB2WysrYV07CiAgICAgICAgICAgICAgaWYodHlwZW9mIG4gPT09ICdiaWdpbnQnKSB0ID0gYCR7bn1uYDsKICAgICAgICAgICAgICBlbHNlIGlmKHR5cGVvZiBuID09PSAnc3ltYm9sJykgdCA9ICdOYU4nOwogICAgICAgICAgICAgIGVsc2UgdCA9IGZvcm1hdE51bWJlcihjID09IDEyMCA/IE51bWJlcihuKS50b1N0cmluZygxNikgOiBOdW1iZXIobikpOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIDc5OiAvLyAlTwogICAgICAgICAgICAgIHQgPSBpbnNwZWN0KHZbKythXSwgbyk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMTExOiAvLyAlbwogICAgICAgICAgICAgIHQgPSAvKnZbKythXSsnJyA/PyAqLyBpbnNwZWN0KHZbKythXSwgewogICAgICAgICAgICAgICAgLi4ubywKICAgICAgICAgICAgICAgIHNob3dIaWRkZW46IHRydWUsCiAgICAgICAgICAgICAgICBzaG93UHJveHk6IHRydWUsCiAgICAgICAgICAgICAgICBkZXB0aDogMSwKICAgICAgICAgICAgICAgIHByb3RvQ2hhaW46IGZhbHNlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgMTA1OiAvLyAlaQogICAgICAgICAgICAgIGNvbnN0IGsgPSB2WysrYV07CiAgICAgICAgICAgICAgaWYodHlwZW9mIGsgPT09ICdiaWdpbnQnKSB0ID0gYCR7a31gOwogICAgICAgICAgICAgIGVsc2UgaWYodHlwZW9mIGsgPT09ICdzeW1ib2wnKSB0ID0gJ05hTic7CiAgICAgICAgICAgICAgZWxzZSB0ID0gZm9ybWF0TnVtYmVyKHBhcnNlSW50KGspKTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAxMDI6IC8vICVmCiAgICAgICAgICAgICAgY29uc3QgZCA9IHZbKythXTsKICAgICAgICAgICAgICBpZih0eXBlb2YgZCA9PT0gJ3N5bWJvbCcpIHQgPSAnTmFOJzsKICAgICAgICAgICAgICBlbHNlIHQgPSBmb3JtYXROdW1iZXIocGFyc2VGbG9hdChkKSk7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgOTk6IC8vICVjCiAgICAgICAgICAgICAgYSArPSAxOwogICAgICAgICAgICAgIHQgPSAnJzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAzNzogLy8gJSUKICAgICAgICAgICAgICBzICs9IHNsaWNlKHgsIHAsIGkpOwogICAgICAgICAgICAgIHAgPSBpICsgMTsKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICAgIGlmKHAgIT09IGkgLSAxKSBzICs9IHNsaWNlKHgsIHAsIGkgLSAxKTsKICAgICAgICAgIGxldCBwYWQgPSBwYXJzZUludChmKTsKICAgICAgICAgIGlmKE1hdGguYWJzKHBhZCkgPiAwKSB0ID0gdFsncGFkJyArIChwYWQgPCAwID8gJ0VuZCcgOiAnU3RhcnQnKV0oTWF0aC5hYnMocGFkKSwgL14tPzAvLnRlc3QoZikgPyAnMCcgOiAnICcpOwogICAgICAgICAgcyArPSB0OwogICAgICAgICAgcCA9IGkgKyAxOwogICAgICAgIH0gZWxzZSBpZihjID09PSAzNykgewogICAgICAgICAgcyArPSBzbGljZSh4LCBwLCBpKTsKICAgICAgICAgIHAgPSBpICsgMTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIGlmKHAgIT09IDApIHsKICAgICAgYSsrOwogICAgICBqID0gJyAnOwogICAgICBpZihwIDwgeC5sZW5ndGgpIHMgKz0gc2xpY2UoeCwgcCk7CiAgICB9CiAgfQogIHdoaWxlKGEgPCB2Lmxlbmd0aCkgewogICAgY29uc3QgeSA9IHZbYV07CiAgICBzICs9IGo7CiAgICBzICs9IHR5cGVvZiB5ICE9PSAnc3RyaW5nJyA/IGluc3BlY3QoeSwgbykgOiB5OwogICAgaiA9ICcgJzsKICAgIGErKzsKICB9CiAgcmV0dXJuIHM7Cn0KCmV4cG9ydCBmdW5jdGlvbiBpc051bWVyaWModmFsdWUpIHsKICBmb3IobGV0IGYgb2YgW3YgPT4gK3YsIHBhcnNlSW50LCBwYXJzZUZsb2F0XSkgaWYoIWlzTmFOKGYodmFsdWUpKSkgcmV0dXJuIHRydWU7CiAgcmV0dXJuIGZhbHNlOwp9CgpleHBvcnQgZnVuY3Rpb24gZnVuY3Rpb25OYW1lKGZuKSB7CiAgaWYodHlwZW9mIGZuID09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGZuLm5hbWUgPT0gJ3N0cmluZycpIHJldHVybiBmbi5uYW1lOwogIHRyeSB7CiAgICBjb25zdCBtYXRjaGVzID0gL2Z1bmN0aW9uXHMqKFteKF0qKVwoLiovZy5leGVjKGZuICsgJycpOwogICAgaWYobWF0Y2hlcyAmJiBtYXRjaGVzWzFdKSByZXR1cm4gbWF0Y2hlc1sxXTsKICB9IGNhdGNoIHt9CiAgcmV0dXJuIG51bGw7Cn0KCmV4cG9ydCBmdW5jdGlvbiBjbGFzc05hbWUob2JqKSB7CiAgaWYoaXNPYmplY3Qob2JqKSkgewogICAgaWYoJ2NvbnN0cnVjdG9yJyBpbiBvYmopIHJldHVybiBmdW5jdGlvbk5hbWUob2JqLmNvbnN0cnVjdG9yKTsKICAgIGlmKFN5bWJvbC50b1N0cmluZ1RhZyBpbiBvYmopIHJldHVybiBvYmpbU3ltYm9sLnRvU3RyaW5nVGFnXTsKICB9CiAgcmV0dXJuIG51bGw7Cn0KCmV4cG9ydCBjb25zdCBpc0Fycm93RnVuY3Rpb24gPSBmbiA9PiAoaXNGdW5jdGlvbihmbikgJiYgISgncHJvdG90eXBlJyBpbiBmbikpIHx8IC9cID0+XCAvLnRlc3QoKCcnICsgZm4pLnJlcGxhY2UoL1xuLiovZywgJycpKTsKCmV4cG9ydCBmdW5jdGlvbiBpbW11dGFibGVDbGFzcyhvcmlnLCAuLi5wcm90bykgewogIGxldCBuYW1lID0gZnVuY3Rpb25OYW1lKG9yaWcpLnJlcGxhY2UoL011dGFibGUvZywgJycpOwogIGxldCBpbU5hbWUgPSAnSW1tdXRhYmxlJyArIG5hbWU7CiAgcHJvdG8gPSBwcm90byB8fCBbXTsKICBsZXQgaW5pdGlhbFByb3RvID0gcHJvdG8ubWFwKHAgPT4KICAgIGlzQXJyb3dGdW5jdGlvbihwKQogICAgICA/IHAKICAgICAgOiBjdG9yID0+IHsKICAgICAgICAgIGZvcihsZXQgbiBpbiBwKSBjdG9yLnByb3RvdHlwZVtuXSA9IHBbbl07CiAgICAgICAgfQogICk7CiAgbGV0IGJvZHkgPSBgY2xhc3MgJHtpbU5hbWV9IGV4dGVuZHMgJHtuYW1lfSB7XG4gIGNvbnN0cnVjdG9yKC4uLmFyZ3MpIHtcbiAgICBzdXBlciguLi5hcmdzKTtcbiAgICBpZihuZXcudGFyZ2V0ID09PSAke2ltTmFtZX0pXG4gICAgICByZXR1cm4gT2JqZWN0LmZyZWV6ZSh0aGlzKTtcbiAgfVxufTtcblxuJHtpbU5hbWV9LnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9ICR7aW1OYW1lfTtcblxucmV0dXJuICR7aW1OYW1lfTtgOwogIGZvcihsZXQgcCBvZiBpbml0aWFsUHJvdG8pIHAob3JpZyk7CiAgbGV0IGN0b3I7IC8vID0gbmV3IEZ1bmN0aW9uKG5hbWUsIGJvZHkpKG9yaWcpOwoKICBsZXQgaW1tID0gYmFzZSA9PiB7CiAgICBsZXQgY2xzOwogICAgY2xzID0gY2xhc3MgZXh0ZW5kcyBiYXNlIHsKICAgICAgY29uc3RydWN0b3IoLi4uYXJncykgewogICAgICAgIHN1cGVyKC4uLmFyZ3MpOwogICAgICAgIGlmKG5ldy50YXJnZXQgPT09IGNscykgcmV0dXJuIE9iamVjdC5mcmVlemUodGhpcyk7CiAgICAgIH0KICAgIH07CiAgICByZXR1cm4gY2xzOwogIH07CiAgY3RvciA9IGltbShvcmlnKTsKICBsZXQgc3BlY2llcyA9IGN0b3I7CiAgcmV0dXJuIGN0b3I7Cn0KCmV4cG9ydCBjb25zdCBpc0FycmF5ID0gYSA9PiBBcnJheS5pc0FycmF5KGEpOwoKZXhwb3J0IGNsYXNzIEFycmF5RmFjYWRlIHsKICAqW1N5bWJvbC5pdGVyYXRvcl0oKSB7CiAgICBjb25zdCB7IGxlbmd0aCB9ID0gdGhpczsKICAgIGZvcihsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgeWllbGQgaXRlbUZuKHRoaXMsIGkpOwogIH0KICAqa2V5cygpIHsKICAgIGNvbnN0IHsgbGVuZ3RoIH0gPSB0aGlzOwogICAgZm9yKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB5aWVsZCBpOwogIH0KICAqZW50cmllcygpIHsKICAgIGNvbnN0IHsgbGVuZ3RoIH0gPSB0aGlzOwogICAgZm9yKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB5aWVsZCBbaSwgaXRlbUZuKHRoaXMsIGkpXTsKICB9CiAgKnZhbHVlcygpIHsKICAgIGNvbnN0IHsgbGVuZ3RoIH0gPSB0aGlzOwogICAgZm9yKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB5aWVsZCBpdGVtRm4odGhpcywgaSk7CiAgfQogIGZvckVhY2goY2FsbGJhY2ssIHRoaXNBcmcpIHsKICAgIGNvbnN0IHsgbGVuZ3RoIH0gPSB0aGlzOwogICAgZm9yKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSBjYWxsYmFjay5jYWxsKHRoaXNBcmcsIGl0ZW1Gbih0aGlzLCBpKSwgaSwgdGhpcyk7CiAgfQogIHJlZHVjZShjYWxsYmFjaywgYWNjdSwgdGhpc0FyZykgewogICAgY29uc3QgeyBsZW5ndGggfSA9IHRoaXM7CiAgICBmb3IobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIGFjY3UgPSBjYWxsYmFjay5jYWxsKHRoaXNBcmcsIGFjY3UsIGl0ZW1Gbih0aGlzLCBpKSwgaSwgdGhpcyk7CiAgICByZXR1cm4gYWNjdTsKICB9Cn0KCi8qZXhwb3J0IGZ1bmN0aW9uIGFycmF5RmFjYWRlKHByb3RvLCBpdGVtRm4gPSAoY29udGFpbmVyLCBpKSA9PiBjb250YWluZXIuYXQoaSkpIHsKICByZXR1cm4gZGVmaW5lKHByb3RvLCBBcnJheUZhY2FkZS5wcm90b3R5cGUpOwp9Ki8KCmV4cG9ydCBmdW5jdGlvbiBiaXRzKGJ1ZmZlcikgewogIGxldCBhID0gbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKTsKICBsZXQgYml0LAogICAgYml0cyA9IGJ1ZmZlci5ieXRlTGVuZ3RoIDw8IDM7CiAgbGV0IHJldCA9IFtdOwogIGZvcihiaXQgPSAwOyBiaXQgPCBiaXRzOyBiaXQrKykgewogICAgbGV0IHNoaWZ0ID0gYml0ICYgMHg3OwogICAgbGV0IGJwb3MgPSBiaXQgPj4gMzsKCiAgICByZXQucHVzaChhW2JpdCA+PiAzXSAmICgxIDw8IHNoaWZ0KSA/IDEgOiAwKTsKICB9CiAgcmV0dXJuIHJldDsKfQoKZXhwb3J0IGZ1bmN0aW9uIGR1cEFycmF5QnVmZmVyKGJ1Ziwgc3RhcnQsIGxlbmd0aCkgewogIGxldCBhID0gbmV3IFVpbnQ4QXJyYXkoYnVmLCBzdGFydCwgbGVuZ3RoKTsKICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWy4uLmFdKTsKfQpleHBvcnQgZnVuY3Rpb24gZ2V0VHlwZU5hbWUodikgewogIHJldHVybiB0eXBlb2YgdjsKfQpleHBvcnQgZnVuY3Rpb24gaXNBcnJheUJ1ZmZlcihidWYpIHsKICByZXR1cm4gaXNPYmplY3QoYnVmKSAmJiBidWYgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcjsKfQoKZXhwb3J0IGZ1bmN0aW9uIGlzQmlnRGVjaW1hbChudW0pIHsKICByZXR1cm4gdHlwZW9mIG51bSA9PSAnYmlnZGVjaW1hbCcgfHwgbnVtW1N5bWJvbC50b1N0cmluZ1RhZ10gPT0gJ0JpZ0RlY2ltYWwnOwp9CgpleHBvcnQgZnVuY3Rpb24gaXNCaWdGbG9hdChudW0pIHsKICByZXR1cm4gdHlwZW9mIG51bSA9PSAnYmlnZmxvYXQnIHx8IG51bVtTeW1ib2wudG9TdHJpbmdUYWddID09ICdCaWdGbG9hdCc7Cn0KCmV4cG9ydCBmdW5jdGlvbiBpc0JpZ0ludChudW0pIHsKICByZXR1cm4gdHlwZW9mIG51bSA9PSAnYmlnaW50JyB8fCBudW1bU3ltYm9sLnRvU3RyaW5nVGFnXSA9PSAnaXNCaWdJbnQnOwp9CgpleHBvcnQgZnVuY3Rpb24gaXNCb29sKHZhbHVlKSB7CiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnYm9vbGVhbic7Cn0KCmV4cG9ydCBmdW5jdGlvbiBpc0NGdW5jdGlvbihmbikgewogIHJldHVybiBmYWxzZTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGlzQ29uc3RydWN0b3IoZm4pIHsKICByZXR1cm4gdHlwZW9mIGZuID09ICdmdW5jdGlvbicgJiYgJ3Byb3RvdHlwZScgaW4gZm47Cn0KCmV4cG9ydCBmdW5jdGlvbiBpc0VtcHR5U3RyaW5nKHZhbHVlKSB7CiAgcmV0dXJuIHZhbHVlID09PSAnJzsKfQoKZXhwb3J0IGZ1bmN0aW9uIGlzRXJyb3IodmFsdWUpIHsKICByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBFcnJvciB8fCB2YWx1ZVtTeW1ib2wudG9TdHJpbmdUYWddLmVuZHNXaXRoKCdFcnJvcicpOwp9CgpleHBvcnQgZnVuY3Rpb24gaXNFeGNlcHRpb24odmFsdWUpIHsKICByZXR1cm4gZmFsc2U7Cn0KCmV4cG9ydCBmdW5jdGlvbiBpc0V4dGVuc2libGUodmFsdWUpIHsKICByZXR1cm4gdHlwZW9mIHZhbHVlID09ICdvYmplY3QnICYmIHZhbHVlICE9PSBudWxsICYmIE9iamVjdC5pc0V4dGVuc2libGUodmFsdWUpOwp9CgpleHBvcnQgZnVuY3Rpb24gaXNGdW5jdGlvbih2YWx1ZSkgewogIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ2Z1bmN0aW9uJzsKfQoKZXhwb3J0IGZ1bmN0aW9uIGlzSFRNTEREQSh2YWx1ZSkgewogIHJldHVybiBmYWxzZTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGlzSW5zdGFuY2VPZih2YWx1ZSwgY3RvcikgewogIGlmKGN0b3JbU3ltYm9sLmhhc0luc3RhbmNlXSkgewogICAgcmV0dXJuIGN0b3JbU3ltYm9sLmhhc0luc3RhbmNlXSh2YWx1ZSk7CiAgfQogIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwgJiYgdmFsdWUgaW5zdGFuY2VvZiBjdG9yOwp9CgpleHBvcnQgZnVuY3Rpb24gaXNJbnRlZ2VyKHZhbHVlKSB7CiAgcmV0dXJuIE1hdGguYWJzKHZhbHVlKSAlIDEgPT0gMDsKfQoKZXhwb3J0IGZ1bmN0aW9uIGlzSm9iUGVuZGluZyhpZCkgewogIHJldHVybiBmYWxzZTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGlzTGl2ZU9iamVjdChvYmopIHsKICByZXR1cm4gdHJ1ZTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGlzTnVsbCh2YWx1ZSkgewogIHJldHVybiB2YWx1ZSA9PT0gbnVsbDsKfQoKZXhwb3J0IGZ1bmN0aW9uIGlzTnVtYmVyKHZhbHVlKSB7CiAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PSAnbnVtYmVyJzsKfQpleHBvcnQgZnVuY3Rpb24gaXNVbmRlZmluZWQodmFsdWUpIHsKICByZXR1cm4gdHlwZW9mIHZhbHVlID09ICd1bmRlZmluZWQnOwp9CgpleHBvcnQgZnVuY3Rpb24gaXNTdHJpbmcodmFsdWUpIHsKICByZXR1cm4gdHlwZW9mIHZhbHVlID09ICdzdHJpbmcnOwp9CmV4cG9ydCBmdW5jdGlvbiBpc1VuaW5pdGlhbGl6ZWQodmFsdWUpIHsKICByZXR1cm4gZmFsc2U7Cn0KCmV4cG9ydCBmdW5jdGlvbiBpc1N5bWJvbCh2YWx1ZSkgewogIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ3N5bWJvbCcgfHwgdmFsdWVbU3ltYm9sLnRvU3RyaW5nVGFnXSA9PSAnU3ltYm9sJzsKfQoKZXhwb3J0IGZ1bmN0aW9uIGlzVW5jYXRjaGFibGVFcnJvcih2YWx1ZSkgewogIHJldHVybiBmYWxzZTsKfQoKZXhwb3J0IGZ1bmN0aW9uIGlzUmVnaXN0ZXJlZENsYXNzKGlkKSB7CiAgcmV0dXJuIGZhbHNlOwp9CmV4cG9ydCBmdW5jdGlvbiByYW5kKCkgewogIHJldHVybiBNYXRoLnJhbmRvbSgpICogMiAqKiAzMjsKfQoKZXhwb3J0IGZ1bmN0aW9uIHJhbmRpKCkgewogIHJldHVybiByYW5kKCkgLSAyICoqIDMxOwp9CgpleHBvcnQgZnVuY3Rpb24gcmFuZGYoKSB7CiAgcmV0dXJuIE1hdGgucmFuZG9tKCk7Cn0KCmV4cG9ydCBmdW5jdGlvbiBzcmFuZChzZWVkKSB7fQoKZXhwb3J0IGZ1bmN0aW9uIHRvQXJyYXlCdWZmZXIodmFsdWUpIHsKICBpZih0eXBlb2YgdmFsdWUgPT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGwgJiYgJ2J1ZmZlcicgaW4gdmFsdWUgJiYgaXNBcnJheUJ1ZmZlcih2YWx1ZS5idWZmZXIpKSByZXR1cm4gdmFsdWUuYnVmZmVyOwoKICBpZih0eXBlb2YgdmFsdWUgPT0gJ3N0cmluZycpIHsKICAgIGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTsKICAgIGNvbnN0IHZpZXcgPSBlbmNvZGVyLmVuY29kZSh2YWx1ZSk7CiAgICByZXR1cm4gdmlldy5idWZmZXI7CiAgfQogIHJldHVybiB2YWx1ZTsKfQoKTG9jYXRpb24ucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24oZnJlZXplID0gZmFsc2UsIHdpdGhGaWxlbmFtZSA9IHRydWUpIHsKICBjb25zdCB7IGxpbmUsIGNvbHVtbiwgcG9zLCBmaWxlIH0gPSB0aGlzOwoKICByZXR1cm4gbmV3IExvY2F0aW9uKGxpbmUsIGNvbHVtbiwgcG9zLCB3aXRoRmlsZW5hbWUgPyBmaWxlIDogbnVsbCwgZnJlZXplKTsKfTsKTG9jYXRpb24ucHJvdG90eXBlW1N5bWJvbC50b1N0cmluZ1RhZ10gPSAnTG9jYXRpb24nOwoKLypmdW5jdGlvbihuLCBvcHRzKSB7CiAgY29uc3QgeyBzaG93RmlsZW5hbWUgPSB0cnVlLCBjb2xvcnMgPSBmYWxzZSB9ID0gb3B0cyB8fCB7fTsKICBsZXQgYyA9IFV0aWwuY29sb3JpbmcoY29sb3JzKTsKCiAgbGV0IHYgPQogICAgdHlwZW9mIHRoaXMuY29sdW1uID09ICdudW1iZXInID8gW3RoaXMuZmlsZSwgdGhpcy5saW5lLCB0aGlzLmNvbHVtbl0gOiBbdGhpcy5maWxlLCB0aGlzLmxpbmVdOwogIGlmKCghc2hvd0ZpbGVuYW1lIHx8IHZbMF0gPT0gdW5kZWZpbmVkKSAmJiB2Lmxlbmd0aCA+PSAzKSB2LnNoaWZ0KCk7CiAgdiA9IHYubWFwKChmLCBpKSA9PiBjLmNvZGUoLi4uKGkgPT0gMCA/IFszOCwgNSwgMzNdIHx8IFsxLCAzM10gOiBbMSwgIDM2XSkpICsgZik7CiAgcmV0dXJuIHYuam9pbihjLmNvZGUoLi4uKFsxLCAzMF0gfHwgWzEsIDM2XSkpICsgJzonKSArIGMuY29kZSgwKTsKfTsqLwoKTG9jYXRpb24ucHJvdG90eXBlW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbiogKCkgewogIGxldCB7IGZpbGUsIGxpbmUsIGNvbHVtbiB9ID0gdGhpczsKICBsZXQgdiA9IGZpbGUgPyBbZmlsZSwgbGluZSwgY29sdW1uXSA6IFtsaW5lLCBjb2x1bW5dOwogIHlpZWxkKiB2Owp9OwpMb2NhdGlvbi5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbihvcHRzID0ge30pIHsKICBjb25zdCB7IGxpbmUsIGNvbHVtbiwgZmlsZSB9ID0gdGhpczsKICByZXR1cm4gKGZpbGUgPyBmaWxlICsgJzonIDogJycpICsgbGluZSArICc6JyArIGNvbHVtbjsKfTsKTG9jYXRpb24ucHJvdG90eXBlLnZhbHVlT2YgPSBmdW5jdGlvbigpIHsKICByZXR1cm4gdGhpcy5wb3M7Cn07CkxvY2F0aW9uLnByb3RvdHlwZVtTeW1ib2wudG9QcmltaXRpdmVdID0gZnVuY3Rpb24oaGludCkgewogIGlmKGhpbnQgPT0gJ251bWJlcicpIHJldHVybiB0aGlzLnBvczsKICBpZihoaW50ID09ICdzdHJpbmcnKSByZXR1cm4gdGhpcy50b1N0cmluZygpOwp9OwpMb2NhdGlvbi5wcm90b3R5cGVbU3ltYm9sLmZvcignbm9kZWpzLnV0aWwuaW5zcGVjdC5jdXN0b20nKV0gPSBmdW5jdGlvbihuLCBvcHRzKSB7CiAgcmV0dXJuIHRoaXMudG9TdHJpbmcoeyBjb2xvcnM6IHRydWUgfSk7CiAgcmV0dXJuIGluc3BlY3QodGhpcywgewogICAgY29sb3JzOiB0cnVlLAogICAgLi4ub3B0cywKICAgIHRvU3RyaW5nOiBTeW1ib2wudG9TdHJpbmdUYWcKICB9KTsKfTsKLyoKTG9jYXRpb24ucHJvdG90eXBlLnZhbHVlT2YgPSBmdW5jdGlvbigpIHsKICByZXR1cm4gdGhpcy5wb3M7Cn07Ki8KCmRlZmluZShMb2NhdGlvbi5wcm90b3R5cGUsIHsKICAvKiBwcmV0dGllci1pZ25vcmUgKi8gZ2V0IG9mZnNldCgpIHsKICAgIHJldHVybiB0aGlzLnZhbHVlT2YoKTsKICB9Cn0pOwoAAAAAAAAAAF67AAAAAAAAAAAAAAAAAAAAAAAAXrsAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAAWYwAAAAAAABZjAAAAAAAAAAAAAAAANEA"
				]
			]
		},
		{
			"file": "quickjs/qjscalc.js",
			"settings":
			{
				"buffer_size": 58529,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			},
			"undo_stack":
			[
				[
					2,
					1,
					"revert",
					null,
					"AwAAAAAAAAAAAAAAAAAAAAAAAACh5AAALyoKICogUXVpY2tKUyBKYXZhc2NyaXB0IENhbGN1bGF0b3IKICoKICogQ29weXJpZ2h0IChjKSAyMDE3LTIwMjAgRmFicmljZSBCZWxsYXJkCiAqCiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkKICogb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksIHRvIGRlYWwKICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cwogKiB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsCiAqIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcwogKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgogKgogKiBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbgogKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4KICoKICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IKICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCiAqIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMCiAqIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSCiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sCiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4KICogVEhFIFNPRlRXQVJFLgogKi8KJ3VzZSBzdHJpY3QnOwondXNlIG1hdGgnOwoKdmFyIEludGVnZXIsIEZsb2F0LCBGcmFjdGlvbiwgQ29tcGxleCwgTW9kLCBQb2x5bm9taWFsLCBQb2x5TW9kLCBSYXRpb25hbEZ1bmN0aW9uLCBTZXJpZXMsIE1hdHJpeDsKCihmdW5jdGlvbiAoZ2xvYmFsKSB7CiAgZ2xvYmFsLkludGVnZXIgPSBnbG9iYWwuQmlnSW50OwogIGdsb2JhbC5GbG9hdCA9IGdsb2JhbC5CaWdGbG9hdDsKICBnbG9iYWwuYWxnZWJyYWljTW9kZSA9IHRydWU7CgogIC8qIGFkZCBub24gZW51bWVyYWJsZSBwcm9wZXJ0aWVzICovCiAgZnVuY3Rpb24gYWRkX3Byb3BzKG9iaiwgcHJvcHMpIHsKICAgIHZhciBpLCB2YWwsIHByb3AsIHRhYiwgZGVzYzsKICAgIHRhYiA9IFJlZmxlY3Qub3duS2V5cyhwcm9wcyk7CiAgICBmb3IoaSA9IDA7IGkgPCB0YWIubGVuZ3RoOyBpKyspIHsKICAgICAgcHJvcCA9IHRhYltpXTsKICAgICAgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocHJvcHMsIHByb3ApOwogICAgICBkZXNjLmVudW1lcmFibGUgPSBmYWxzZTsKICAgICAgaWYoJ3ZhbHVlJyBpbiBkZXNjKSB7CiAgICAgICAgaWYodHlwZW9mIGRlc2MudmFsdWUgIT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIGRlc2Mud3JpdGFibGUgPSBmYWxzZTsKICAgICAgICAgIGRlc2MuY29uZmlndXJhYmxlID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8qIGdldHRlci9zZXR0ZXIgKi8KICAgICAgICBkZXNjLmNvbmZpZ3VyYWJsZSA9IGZhbHNlOwogICAgICB9CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIHByb3AsIGRlc2MpOwogICAgfQogIH0KCiAgLyogc2FtZSBhcyBwcm90b1tTeW1ib2wub3BlcmF0b3JTZXRdID0gT3BlcmF0b3JzLmNyZWF0ZSguLm9wX2xpc3QpCiAgICAgICBidXQgYWxsb3cgc2hvcnRjdXRzOiBsZWZ0OiBbXSwgcmlnaHQ6IFtdIG9yIGJvdGgKICAgICovCiAgZnVuY3Rpb24gb3BlcmF0b3JzX3NldChwcm90bywgLi4ub3BfbGlzdCkgewogICAgdmFyIG5ld19vcF9saXN0LCBpLCBhLCBqLCBiLCBrLCBvYmosIHRhYjsKICAgIHZhciBmaWVsZHMgPSBbJ2xlZnQnLCAncmlnaHQnXTsKICAgIG5ld19vcF9saXN0ID0gW107CiAgICBmb3IoaSA9IDA7IGkgPCBvcF9saXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgIGEgPSBvcF9saXN0W2ldOwogICAgICBpZihhLmxlZnQgfHwgYS5yaWdodCkgewogICAgICAgIHRhYiA9IFthLmxlZnQsIGEucmlnaHRdOwogICAgICAgIGRlbGV0ZSBhLmxlZnQ7CiAgICAgICAgZGVsZXRlIGEucmlnaHQ7CiAgICAgICAgZm9yKGsgPSAwOyBrIDwgMjsgaysrKSB7CiAgICAgICAgICBvYmogPSB0YWJba107CiAgICAgICAgICBpZihvYmopIHsKICAgICAgICAgICAgaWYoIUFycmF5LmlzQXJyYXkob2JqKSkgewogICAgICAgICAgICAgIG9iaiA9IFtvYmpdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvcihqID0gMDsgaiA8IG9iai5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgIGIgPSB7fTsKICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGIsIGEpOwogICAgICAgICAgICAgIGJbZmllbGRzW2tdXSA9IG9ialtqXTsKICAgICAgICAgICAgICBuZXdfb3BfbGlzdC5wdXNoKGIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIG5ld19vcF9saXN0LnB1c2goYSk7CiAgICAgIH0KICAgIH0KICAgIHByb3RvW1N5bWJvbC5vcGVyYXRvclNldF0gPSBPcGVyYXRvcnMuY3JlYXRlLmNhbGwobnVsbCwgLi4ubmV3X29wX2xpc3QpOwogIH0KCiAgLyogSW50ZWdlciAqLwoKICBmdW5jdGlvbiBnZW5lcmljX3BvdyhhLCBiKSB7CiAgICB2YXIgciwgaXNfbmVnLCBpOwogICAgaWYoIUludGVnZXIuaXNJbnRlZ2VyKGIpKSB7CiAgICAgIHJldHVybiBleHAobG9nKGEpICogYik7CiAgICB9CiAgICBpZihBcnJheS5pc0FycmF5KGEpICYmICEoYSBpbnN0YW5jZW9mIFBvbHlub21pYWwgfHwgYSBpbnN0YW5jZW9mIFNlcmllcykpIHsKICAgICAgciA9IGlkbihNYXRyaXguY2hlY2tfc3F1YXJlKGEpKTsKICAgIH0gZWxzZSB7CiAgICAgIHIgPSAxOwogICAgfQogICAgaWYoYiA9PSAwKSByZXR1cm4gcjsKICAgIGlzX25lZyA9IGZhbHNlOwogICAgaWYoYiA8IDApIHsKICAgICAgaXNfbmVnID0gdHJ1ZTsKICAgICAgYiA9IC1iOwogICAgfQogICAgciA9IGE7CiAgICBmb3IoaSA9IEludGVnZXIuZmxvb3JMb2cyKGIpIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgciAqPSByOwogICAgICBpZigoYiA+PiBpKSAmIDEpIHIgKj0gYTsKICAgIH0KICAgIGlmKGlzX25lZykgewogICAgICBpZih0eXBlb2Ygci5pbnZlcnNlICE9ICdmdW5jdGlvbicpIHRocm93ICduZWdhdGl2ZSBwb3dlcnMgYXJlIG5vdCBzdXBwb3J0ZWQgZm9yIHRoaXMgdHlwZSc7CiAgICAgIHIgPSByLmludmVyc2UoKTsKICAgIH0KICAgIHJldHVybiByOwogIH0KCiAgdmFyIHNtYWxsX3ByaW1lcyA9IFsKICAgIDIsIDMsIDUsIDcsIDExLCAxMywgMTcsIDE5LCAyMywgMjksIDMxLCAzNywgNDEsIDQzLCA0NywgNTMsIDU5LCA2MSwgNjcsIDcxLCA3MywgNzksIDgzLCA4OSwgOTcsIDEwMSwgMTAzLCAxMDcsIDEwOSwgMTEzLCAxMjcsIDEzMSwgMTM3LCAxMzksIDE0OSwgMTUxLCAxNTcsIDE2MywgMTY3LCAxNzMsIDE3OSwgMTgxLCAxOTEsIDE5MywgMTk3LAogICAgMTk5LCAyMTEsIDIyMywgMjI3LCAyMjksIDIzMywgMjM5LCAyNDEsIDI1MSwgMjU3LCAyNjMsIDI2OSwgMjcxLCAyNzcsIDI4MSwgMjgzLCAyOTMsIDMwNywgMzExLCAzMTMsIDMxNywgMzMxLCAzMzcsIDM0NywgMzQ5LCAzNTMsIDM1OSwgMzY3LCAzNzMsIDM3OSwgMzgzLCAzODksIDM5NywgNDAxLCA0MDksIDQxOSwgNDIxLCA0MzEsIDQzMywKICAgIDQzOSwgNDQzLCA0NDksIDQ1NywgNDYxLCA0NjMsIDQ2NywgNDc5LCA0ODcsIDQ5MSwgNDk5CiAgXTsKCiAgZnVuY3Rpb24gbWlsbGVyX3JhYmluX3Rlc3QobiwgdCkgewogICAgdmFyIGQsIHIsIHMsIGksIGosIGE7CiAgICBkID0gbiAtIDE7CiAgICBzID0gMDsKICAgIHdoaWxlKChkICYgMSkgPT0gMCkgewogICAgICBkID4+PSAxOwogICAgICBzKys7CiAgICB9CiAgICBpZihzbWFsbF9wcmltZXMubGVuZ3RoIDwgdCkgdCA9IHNtYWxsX3ByaW1lcy5sZW5ndGg7CiAgICBsb29wOiBmb3IoaiA9IDA7IGogPCB0OyBqKyspIHsKICAgICAgYSA9IHNtYWxsX3ByaW1lc1tqXTsKICAgICAgciA9IEludGVnZXIucG1vZChhLCBkLCBuKTsKICAgICAgaWYociA9PSAxIHx8IHIgPT0gbiAtIDEpIGNvbnRpbnVlOwogICAgICBmb3IoaSA9IDE7IGkgPCBzOyBpKyspIHsKICAgICAgICByID0gKHIgKiByKSAlIG47CiAgICAgICAgaWYociA9PSAxKSByZXR1cm4gZmFsc2U7CiAgICAgICAgaWYociA9PSBuIC0gMSkgY29udGludWUgbG9vcDsKICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7IC8qIG4gaXMgY29tcG9zaXRlICovCiAgICB9CiAgICByZXR1cm4gdHJ1ZTsgLyogbiBpcyBwcm9iYWJseSBwcmltZSB3aXRoIHByb2JhYmlsaXR5ICgxLTAuNV50KSAqLwogIH0KCiAgZnVuY3Rpb24gZmFjdF9yZWMoYSwgYikgewogICAgLyogYXNzdW1lcyBhIDw9IGIgKi8KICAgIHZhciBpLCByOwogICAgaWYoYiAtIGEgPD0gNSkgewogICAgICByID0gYTsKICAgICAgZm9yKGkgPSBhICsgMTsgaSA8PSBiOyBpKyspIHIgKj0gaTsKICAgICAgcmV0dXJuIHI7CiAgICB9IGVsc2UgewogICAgICAvKiB0byBhdm9pZCBhIHF1YWRyYXRpYyBydW5uaW5nIHRpbWUgaXQgaXMgYmV0dGVyIHRvCiAgICAgICAgICAgICAgIG11bHRpcGx5IG51bWJlcnMgb2Ygc2ltaWxhciBzaXplICovCiAgICAgIGkgPSAoYSArIGIpID4+IDE7CiAgICAgIHJldHVybiBmYWN0X3JlYyhhLCBpKSAqIGZhY3RfcmVjKGkgKyAxLCBiKTsKICAgIH0KICB9CgogIC8qIG1hdGggbW9kZSBzcGVjaWZpYyBxdWlyayB0byBvdmVybG9hZCB0aGUgaW50ZWdlciBkaXZpc2lvbiBhbmQgcG93ZXIgKi8KICBPcGVyYXRvcnMudXBkYXRlQmlnSW50T3BlcmF0b3JzKHsKICAgICcvJyhhLCBiKSB7CiAgICAgIGlmKGFsZ2VicmFpY01vZGUpIHsKICAgICAgICByZXR1cm4gRnJhY3Rpb24udG9GcmFjdGlvbihhLCBiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gRmxvYXQoYSkgLyBGbG9hdChiKTsKICAgICAgfQogICAgfSwKICAgICcqKicoYSwgYikgewogICAgICBpZihhbGdlYnJhaWNNb2RlKSB7CiAgICAgICAgcmV0dXJuIGdlbmVyaWNfcG93KGEsIGIpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBGbG9hdChhKSAqKiBGbG9hdChiKTsKICAgICAgfQogICAgfQogIH0pOwoKICBhZGRfcHJvcHMoSW50ZWdlciwgewogICAgaXNJbnRlZ2VyKGEpIHsKICAgICAgLyogaW50ZWdlcnMgYXJlIHJlcHJlc2VudGVkIGVpdGhlciBhcyBiaWdpbnQgb3IgYXMgbnVtYmVyICovCiAgICAgIHJldHVybiB0eXBlb2YgYSA9PT0gJ2JpZ2ludCcgfHwgKHR5cGVvZiBhID09PSAnbnVtYmVyJyAmJiBOdW1iZXIuaXNTYWZlSW50ZWdlcihhKSk7CiAgICB9LAogICAgZ2NkKGEsIGIpIHsKICAgICAgdmFyIHI7CiAgICAgIHdoaWxlKGIgIT0gMCkgewogICAgICAgIHIgPSBhICUgYjsKICAgICAgICBhID0gYjsKICAgICAgICBiID0gcjsKICAgICAgfQogICAgICByZXR1cm4gYTsKICAgIH0sCiAgICBmYWN0KG4pIHsKICAgICAgcmV0dXJuIG4gPD0gMCA/IDEgOiBmYWN0X3JlYygxLCBuKTsKICAgIH0sCiAgICAvKiBiaW5vbWlhbCBjb2VmZmljaWVudCAqLwogICAgY29tYihuLCBrKSB7CiAgICAgIGlmKGsgPCAwIHx8IGsgPiBuKSByZXR1cm4gMDsKICAgICAgaWYoayA+IG4gLSBrKSBrID0gbiAtIGs7CiAgICAgIGlmKGsgPT0gMCkgcmV0dXJuIDE7CiAgICAgIHJldHVybiBJbnRlZ2VyLnRkaXYoZmFjdF9yZWMobiAtIGsgKyAxLCBuKSwgZmFjdF9yZWMoMSwgaykpOwogICAgfSwKICAgIC8qIGludmVyc2Ugb2YgeCBtb2R1bG8geSAqLwogICAgaW52bW9kKHgsIHkpIHsKICAgICAgdmFyIHEsIHUsIHYsIGEsIGMsIHQ7CiAgICAgIHUgPSB4OwogICAgICB2ID0geTsKICAgICAgYyA9IDE7CiAgICAgIGEgPSAwOwogICAgICB3aGlsZSh1ICE9IDApIHsKICAgICAgICB0ID0gSW50ZWdlci5mZGl2cmVtKHYsIHUpOwogICAgICAgIHEgPSB0WzBdOwogICAgICAgIHYgPSB1OwogICAgICAgIHUgPSB0WzFdOwogICAgICAgIHQgPSBjOwogICAgICAgIGMgPSBhIC0gcSAqIGM7CiAgICAgICAgYSA9IHQ7CiAgICAgIH0KICAgICAgLyogdiA9IGdjZCh4LCB5KSAqLwogICAgICBpZih2ICE9IDEpIHRocm93IFJhbmdlRXJyb3IoJ25vdCBpbnZlcnRpYmxlJyk7CiAgICAgIHJldHVybiBhICUgeTsKICAgIH0sCiAgICAvKiByZXR1cm4gYSBeIGIgbW9kdWxvIG0gKi8KICAgIHBtb2QoYSwgYiwgbSkgewogICAgICB2YXIgcjsKICAgICAgaWYoYiA9PSAwKSByZXR1cm4gMTsKICAgICAgaWYoYiA8IDApIHsKICAgICAgICBhID0gSW50ZWdlci5pbnZtb2QoYSwgbSk7CiAgICAgICAgYiA9IC1iOwogICAgICB9CiAgICAgIHIgPSAxOwogICAgICBmb3IoOzspIHsKICAgICAgICBpZihiICYgMSkgewogICAgICAgICAgciA9IChyICogYSkgJSBtOwogICAgICAgIH0KICAgICAgICBiID4+PSAxOwogICAgICAgIGlmKGIgPT0gMCkgYnJlYWs7CiAgICAgICAgYSA9IChhICogYSkgJSBtOwogICAgICB9CiAgICAgIHJldHVybiByOwogICAgfSwKCiAgICAvKiByZXR1cm4gdHJ1ZSBpZiBuIGlzIHByaW1lIChvciBwcm9iYWJseSBwcmltZSB3aXRoCiAgICAgICAgICAgcHJvYmFiaWxpdHkgMS0wLjVedCkgKi8KICAgIGlzUHJpbWUobiwgdCkgewogICAgICB2YXIgaSwgZCwgbjE7CiAgICAgIGlmKCFJbnRlZ2VyLmlzSW50ZWdlcihuKSkgdGhyb3cgVHlwZUVycm9yKCdpbnZhbGlkIHR5cGUnKTsKICAgICAgaWYobiA8PSAxKSByZXR1cm4gZmFsc2U7CiAgICAgIG4xID0gc21hbGxfcHJpbWVzLmxlbmd0aDsKICAgICAgLyogWFhYOiBuZWVkIEludGVnZXIuc3FydCgpICovCiAgICAgIGZvcihpID0gMDsgaSA8IG4xOyBpKyspIHsKICAgICAgICBkID0gc21hbGxfcHJpbWVzW2ldOwogICAgICAgIGlmKGQgPT0gbikgcmV0dXJuIHRydWU7CiAgICAgICAgaWYoZCA+IG4pIHJldHVybiBmYWxzZTsKICAgICAgICBpZihuICUgZCA9PSAwKSByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgaWYobiA8IGQgKiBkKSByZXR1cm4gdHJ1ZTsKICAgICAgaWYodHlwZW9mIHQgPT0gJ3VuZGVmaW5lZCcpIHQgPSA2NDsKICAgICAgcmV0dXJuIG1pbGxlcl9yYWJpbl90ZXN0KG4sIHQpOwogICAgfSwKICAgIG5leHRQcmltZShuKSB7CiAgICAgIGlmKCFJbnRlZ2VyLmlzSW50ZWdlcihuKSkgdGhyb3cgVHlwZUVycm9yKCdpbnZhbGlkIHR5cGUnKTsKICAgICAgaWYobiA8IDEpIG4gPSAxOwogICAgICBmb3IoOzspIHsKICAgICAgICBuKys7CiAgICAgICAgaWYoSW50ZWdlci5pc1ByaW1lKG4pKSByZXR1cm4gbjsKICAgICAgfQogICAgfSwKICAgIGZhY3RvcihuKSB7CiAgICAgIHZhciByLCBkOwogICAgICBpZighSW50ZWdlci5pc0ludGVnZXIobikpIHRocm93IFR5cGVFcnJvcignaW52YWxpZCB0eXBlJyk7CiAgICAgIHIgPSBbXTsKICAgICAgaWYoYWJzKG4pIDw9IDEpIHsKICAgICAgICByLnB1c2gobik7CiAgICAgICAgcmV0dXJuIHI7CiAgICAgIH0KICAgICAgaWYobiA8IDApIHsKICAgICAgICByLnB1c2goLTEpOwogICAgICAgIG4gPSAtbjsKICAgICAgfQoKICAgICAgd2hpbGUobiAlIDIgPT0gMCkgewogICAgICAgIG4gPj49IDE7CiAgICAgICAgci5wdXNoKDIpOwogICAgICB9CgogICAgICBkID0gMzsKICAgICAgd2hpbGUobiAhPSAxKSB7CiAgICAgICAgaWYoSW50ZWdlci5pc1ByaW1lKG4pKSB7CiAgICAgICAgICByLnB1c2gobik7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgLyogd2UgYXJlIHN1cmUgdGhlcmUgaXMgYXQgbGVhc3Qgb25lIGRpdmlzb3IsIHNvIG9uZSB0ZXN0ICovCiAgICAgICAgZm9yKDs7KSB7CiAgICAgICAgICBpZihuICUgZCA9PSAwKSBicmVhazsKICAgICAgICAgIGQgKz0gMjsKICAgICAgICB9CiAgICAgICAgZm9yKDs7KSB7CiAgICAgICAgICByLnB1c2goZCk7CiAgICAgICAgICBuID0gSW50ZWdlci50ZGl2KG4sIGQpOwogICAgICAgICAgaWYobiAlIGQgIT0gMCkgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiByOwogICAgfQogIH0pOwoKICBhZGRfcHJvcHMoSW50ZWdlci5wcm90b3R5cGUsIHsKICAgIGludmVyc2UoKSB7CiAgICAgIHJldHVybiAxIC8gdGhpczsKICAgIH0sCiAgICBub3JtMigpIHsKICAgICAgcmV0dXJuIHRoaXMgKiB0aGlzOwogICAgfSwKICAgIGFicygpIHsKICAgICAgdmFyIHYgPSB0aGlzOwogICAgICBpZih2IDwgMCkgdiA9IC12OwogICAgICByZXR1cm4gdjsKICAgIH0sCiAgICBjb25qKCkgewogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBhcmcoKSB7CiAgICAgIGlmKHRoaXMgPj0gMCkgcmV0dXJuIDA7CiAgICAgIGVsc2UgcmV0dXJuIEZsb2F0LlBJOwogICAgfSwKICAgIGV4cCgpIHsKICAgICAgaWYodGhpcyA9PSAwKSByZXR1cm4gMTsKICAgICAgZWxzZSByZXR1cm4gRmxvYXQuZXhwKHRoaXMpOwogICAgfSwKICAgIGxvZygpIHsKICAgICAgaWYodGhpcyA9PSAxKSByZXR1cm4gMDsKICAgICAgZWxzZSByZXR1cm4gRmxvYXQodGhpcykubG9nKCk7CiAgICB9CiAgfSk7CgogIC8qIEZyYWN0aW9uICovCgogIEZyYWN0aW9uID0gZnVuY3Rpb24gRnJhY3Rpb24oYSwgYikgewogICAgdmFyIGQsIHIsIG9iajsKCiAgICBpZihuZXcudGFyZ2V0KSB0aHJvdyBUeXBlRXJyb3IoJ25vdCBhIGNvbnN0cnVjdG9yJyk7CiAgICBpZihhIGluc3RhbmNlb2YgRnJhY3Rpb24pIHJldHVybiBhOwogICAgaWYoIUludGVnZXIuaXNJbnRlZ2VyKGEpKSB0aHJvdyBUeXBlRXJyb3IoJ2ludGVnZXIgZXhwZWN0ZWQnKTsKICAgIGlmKHR5cGVvZiBiID09PSAndW5kZWZpbmVkJykgewogICAgICBiID0gMTsKICAgIH0gZWxzZSB7CiAgICAgIGlmKCFJbnRlZ2VyLmlzSW50ZWdlcihiKSkgdGhyb3cgVHlwZUVycm9yKCdpbnRlZ2VyIGV4cGVjdGVkJyk7CiAgICAgIGlmKGIgPT0gMCkgdGhyb3cgUmFuZ2VFcnJvcignZGl2aXNpb24gYnkgemVybycpOwogICAgICBkID0gSW50ZWdlci5nY2QoYSwgYik7CiAgICAgIGlmKGQgIT0gMSkgewogICAgICAgIGEgPSBJbnRlZ2VyLnRkaXYoYSwgZCk7CiAgICAgICAgYiA9IEludGVnZXIudGRpdihiLCBkKTsKICAgICAgfQoKICAgICAgLyogdGhlIGZyYWN0aW9ucyBhcmUgbm9ybWFsaXplZCB3aXRoIGRlbiA+IDAgKi8KICAgICAgaWYoYiA8IDApIHsKICAgICAgICBhID0gLWE7CiAgICAgICAgYiA9IC1iOwogICAgICB9CiAgICB9CiAgICBvYmogPSBPYmplY3QuY3JlYXRlKEZyYWN0aW9uLnByb3RvdHlwZSk7CiAgICBvYmoubnVtID0gYTsKICAgIG9iai5kZW4gPSBiOwogICAgcmV0dXJuIG9iajsKICB9OwoKICBmdW5jdGlvbiBmcmFjdGlvbl9hZGQoYSwgYikgewogICAgYSA9IEZyYWN0aW9uKGEpOwogICAgYiA9IEZyYWN0aW9uKGIpOwogICAgcmV0dXJuIEZyYWN0aW9uLnRvRnJhY3Rpb24oYS5udW0gKiBiLmRlbiArIGEuZGVuICogYi5udW0sIGEuZGVuICogYi5kZW4pOwogIH0KICBmdW5jdGlvbiBmcmFjdGlvbl9zdWIoYSwgYikgewogICAgYSA9IEZyYWN0aW9uKGEpOwogICAgYiA9IEZyYWN0aW9uKGIpOwogICAgcmV0dXJuIEZyYWN0aW9uLnRvRnJhY3Rpb24oYS5udW0gKiBiLmRlbiAtIGEuZGVuICogYi5udW0sIGEuZGVuICogYi5kZW4pOwogIH0KICBmdW5jdGlvbiBmcmFjdGlvbl9tdWwoYSwgYikgewogICAgYSA9IEZyYWN0aW9uKGEpOwogICAgYiA9IEZyYWN0aW9uKGIpOwogICAgcmV0dXJuIEZyYWN0aW9uLnRvRnJhY3Rpb24oYS5udW0gKiBiLm51bSwgYS5kZW4gKiBiLmRlbik7CiAgfQogIGZ1bmN0aW9uIGZyYWN0aW9uX2RpdihhLCBiKSB7CiAgICBhID0gRnJhY3Rpb24oYSk7CiAgICBiID0gRnJhY3Rpb24oYik7CiAgICByZXR1cm4gRnJhY3Rpb24udG9GcmFjdGlvbihhLm51bSAqIGIuZGVuLCBhLmRlbiAqIGIubnVtKTsKICB9CiAgZnVuY3Rpb24gZnJhY3Rpb25fbW9kKGEsIGIpIHsKICAgIHZhciBhMSA9IEZyYWN0aW9uKGEpOwogICAgdmFyIGIxID0gRnJhY3Rpb24oYik7CiAgICByZXR1cm4gYSAtIEludGVnZXIuZWRpdihhMS5udW0gKiBiMS5kZW4sIGExLmRlbiAqIGIxLm51bSkgKiBiOwogIH0KICBmdW5jdGlvbiBmcmFjdGlvbl9lcShhLCBiKSB7CiAgICBhID0gRnJhY3Rpb24oYSk7CiAgICBiID0gRnJhY3Rpb24oYik7CiAgICAvKiB3ZSBhc3N1bWUgdGhlIGZyYWN0aW9ucyBhcmUgbm9ybWFsaXplZCAqLwogICAgcmV0dXJuIGEubnVtID09IGIubnVtICYmIGEuZGVuID09IGIuZGVuOwogIH0KICBmdW5jdGlvbiBmcmFjdGlvbl9sdChhLCBiKSB7CiAgICBhID0gRnJhY3Rpb24oYSk7CiAgICBiID0gRnJhY3Rpb24oYik7CiAgICByZXR1cm4gYS5udW0gKiBiLmRlbiA8IGIubnVtICogYS5kZW47CiAgfQoKICAvKiBvcGVyYXRvcnMgYXJlIG5lZWRlZCBmb3IgZnJhY3Rpb25zICovCiAgZnVuY3Rpb24gZmxvYXRfYWRkKGEsIGIpIHsKICAgIHJldHVybiBGbG9hdChhKSArIEZsb2F0KGIpOwogIH0KICBmdW5jdGlvbiBmbG9hdF9zdWIoYSwgYikgewogICAgcmV0dXJuIEZsb2F0KGEpIC0gRmxvYXQoYik7CiAgfQogIGZ1bmN0aW9uIGZsb2F0X211bChhLCBiKSB7CiAgICByZXR1cm4gRmxvYXQoYSkgKiBGbG9hdChiKTsKICB9CiAgZnVuY3Rpb24gZmxvYXRfZGl2KGEsIGIpIHsKICAgIHJldHVybiBGbG9hdChhKSAvIEZsb2F0KGIpOwogIH0KICBmdW5jdGlvbiBmbG9hdF9tb2QoYSwgYikgewogICAgcmV0dXJuIEZsb2F0KGEpICUgRmxvYXQoYik7CiAgfQogIGZ1bmN0aW9uIGZsb2F0X3BvdyhhLCBiKSB7CiAgICByZXR1cm4gRmxvYXQoYSkgKiogRmxvYXQoYik7CiAgfQogIGZ1bmN0aW9uIGZsb2F0X2VxKGEsIGIpIHsKICAgIC8qIFhYWDogbWF5IGJlIGJldHRlciB0byB1c2UgaW5maW5pdGUgcHJlY2lzaW9uIGZvciB0aGUgY29tcGFyaXNvbiAqLwogICAgcmV0dXJuIEZsb2F0KGEpID09PSBGbG9hdChiKTsKICB9CiAgZnVuY3Rpb24gZmxvYXRfbHQoYSwgYikgewogICAgYSA9IEZsb2F0KGEpOwogICAgYiA9IEZsb2F0KGIpOwogICAgLyogWFhYOiBtYXkgYmUgYmV0dGVyIHRvIHVzZSBpbmZpbml0ZSBwcmVjaXNpb24gZm9yIHRoZSBjb21wYXJpc29uICovCiAgICBpZihGbG9hdC5pc05hTihhKSB8fCBGbG9hdC5pc05hTihiKSkgcmV0dXJuIHVuZGVmaW5lZDsKICAgIGVsc2UgcmV0dXJuIGEgPCBiOwogIH0KCiAgb3BlcmF0b3JzX3NldCgKICAgIEZyYWN0aW9uLnByb3RvdHlwZSwKICAgIHsKICAgICAgJysnOiBmcmFjdGlvbl9hZGQsCiAgICAgICctJzogZnJhY3Rpb25fc3ViLAogICAgICAnKic6IGZyYWN0aW9uX211bCwKICAgICAgJy8nOiBmcmFjdGlvbl9kaXYsCiAgICAgICclJzogZnJhY3Rpb25fbW9kLAogICAgICAnKionOiBnZW5lcmljX3BvdywKICAgICAgJz09JzogZnJhY3Rpb25fZXEsCiAgICAgICc8JzogZnJhY3Rpb25fbHQsCiAgICAgIHBvcyhhKSB7CiAgICAgICAgcmV0dXJuIGE7CiAgICAgIH0sCiAgICAgIG5lZyhhKSB7CiAgICAgICAgcmV0dXJuIEZyYWN0aW9uKC1hLm51bSwgYS5kZW4pOwogICAgICB9CiAgICB9LAogICAgewogICAgICBsZWZ0OiBbTnVtYmVyLCBCaWdJbnRdLAogICAgICByaWdodDogW051bWJlciwgQmlnSW50XSwKICAgICAgJysnOiBmcmFjdGlvbl9hZGQsCiAgICAgICctJzogZnJhY3Rpb25fc3ViLAogICAgICAnKic6IGZyYWN0aW9uX211bCwKICAgICAgJy8nOiBmcmFjdGlvbl9kaXYsCiAgICAgICclJzogZnJhY3Rpb25fbW9kLAogICAgICAnKionOiBnZW5lcmljX3BvdywKICAgICAgJz09JzogZnJhY3Rpb25fZXEsCiAgICAgICc8JzogZnJhY3Rpb25fbHQKICAgIH0sCiAgICB7CiAgICAgIGxlZnQ6IEZsb2F0LAogICAgICByaWdodDogRmxvYXQsCiAgICAgICcrJzogZmxvYXRfYWRkLAogICAgICAnLSc6IGZsb2F0X3N1YiwKICAgICAgJyonOiBmbG9hdF9tdWwsCiAgICAgICcvJzogZmxvYXRfZGl2LAogICAgICAnJSc6IGZsb2F0X21vZCwKICAgICAgJyoqJzogZmxvYXRfcG93LAogICAgICAnPT0nOiBmbG9hdF9lcSwKICAgICAgJzwnOiBmbG9hdF9sdAogICAgfQogICk7CgogIGFkZF9wcm9wcyhGcmFjdGlvbiwgewogICAgLyogKGludGVybmFsIHVzZSkgc2ltcGxpZnkgJ2EnIHRvIGFuIGludGVnZXIgd2hlbiBwb3NzaWJsZSAqLwogICAgdG9GcmFjdGlvbihhLCBiKSB7CiAgICAgIHZhciByID0gRnJhY3Rpb24oYSwgYik7CiAgICAgIGlmKGFsZ2VicmFpY01vZGUgJiYgci5kZW4gPT0gMSkgcmV0dXJuIHIubnVtOwogICAgICBlbHNlIHJldHVybiByOwogICAgfQogIH0pOwoKICBhZGRfcHJvcHMoRnJhY3Rpb24ucHJvdG90eXBlLCB7CiAgICBbU3ltYm9sLnRvUHJpbWl0aXZlXShoaW50KSB7CiAgICAgIGlmKGhpbnQgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgcmV0dXJuIHRoaXMudG9TdHJpbmcoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gRmxvYXQodGhpcy5udW0pIC8gdGhpcy5kZW47CiAgICAgIH0KICAgIH0sCiAgICBpbnZlcnNlKCkgewogICAgICByZXR1cm4gRnJhY3Rpb24odGhpcy5kZW4sIHRoaXMubnVtKTsKICAgIH0sCiAgICB0b1N0cmluZygpIHsKICAgICAgcmV0dXJuIHRoaXMubnVtICsgJy8nICsgdGhpcy5kZW47CiAgICB9LAogICAgbm9ybTIoKSB7CiAgICAgIHJldHVybiB0aGlzICogdGhpczsKICAgIH0sCiAgICBhYnMoKSB7CiAgICAgIGlmKHRoaXMubnVtIDwgMCkgcmV0dXJuIC10aGlzOwogICAgICBlbHNlIHJldHVybiB0aGlzOwogICAgfSwKICAgIGNvbmooKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIGFyZygpIHsKICAgICAgaWYodGhpcy5udW0gPj0gMCkgcmV0dXJuIDA7CiAgICAgIGVsc2UgcmV0dXJuIEZsb2F0LlBJOwogICAgfSwKICAgIGV4cCgpIHsKICAgICAgcmV0dXJuIEZsb2F0LmV4cChGbG9hdCh0aGlzKSk7CiAgICB9LAogICAgbG9nKCkgewogICAgICByZXR1cm4gRmxvYXQodGhpcykubG9nKCk7CiAgICB9CiAgfSk7CgogIC8qIE51bWJlciAoRmxvYXQ2NCkgKi8KCiAgYWRkX3Byb3BzKE51bWJlci5wcm90b3R5cGUsIHsKICAgIGludmVyc2UoKSB7CiAgICAgIHJldHVybiAxIC8gdGhpczsKICAgIH0sCiAgICBub3JtMigpIHsKICAgICAgcmV0dXJuIHRoaXMgKiB0aGlzOwogICAgfSwKICAgIGFicygpIHsKICAgICAgcmV0dXJuIE1hdGguYWJzKHRoaXMpOwogICAgfSwKICAgIGNvbmooKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfSwKICAgIGFyZygpIHsKICAgICAgaWYodGhpcyA+PSAwKSByZXR1cm4gMDsKICAgICAgZWxzZSByZXR1cm4gRmxvYXQuUEk7CiAgICB9LAogICAgZXhwKCkgewogICAgICByZXR1cm4gRmxvYXQuZXhwKHRoaXMpOwogICAgfSwKICAgIGxvZygpIHsKICAgICAgaWYodGhpcyA8IDApIHsKICAgICAgICByZXR1cm4gQ29tcGxleCh0aGlzKS5sb2coKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gRmxvYXQubG9nKHRoaXMpOwogICAgICB9CiAgICB9CiAgfSk7CgogIC8qIEZsb2F0ICovCgogIHZhciBjb25zdF90YWIgPSBbXTsKCiAgLyogd2UgY2FjaGUgdGhlIGNvbnN0YW50cyBmb3Igc21hbGwgcHJlY2lzaW9ucyAqLwogIGZ1bmN0aW9uIGdldF9jb25zdChuKSB7CiAgICB2YXIgdCwgYywgcDsKICAgIHQgPSBjb25zdF90YWJbbl07CiAgICBwID0gQmlnRmxvYXRFbnYucHJlYzsKICAgIGlmKHQgJiYgdC5wcmVjID09IHApIHsKICAgICAgcmV0dXJuIHQudmFsOwogICAgfSBlbHNlIHsKICAgICAgc3dpdGNoIChuKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgYyA9IEZsb2F0LmV4cCgxKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgMToKICAgICAgICAgIGMgPSBGbG9hdC5sb2coMTApOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgLy8gICAgICAgICAgICBjYXNlIDI6IGMgPSBGbG9hdC5sb2coMik7IGJyZWFrOwogICAgICAgIGNhc2UgMzoKICAgICAgICAgIGMgPSAxIC8gRmxvYXQubG9nKDIpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSA0OgogICAgICAgICAgYyA9IDEgLyBGbG9hdC5sb2coMTApOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgLy8gICAgICAgICAgICBjYXNlIDU6IGMgPSBGbG9hdC5hdGFuKDEpICogNDsgYnJlYWs7CiAgICAgICAgY2FzZSA2OgogICAgICAgICAgYyA9IEZsb2F0LnNxcnQoMC41KTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgNzoKICAgICAgICAgIGMgPSBGbG9hdC5zcXJ0KDIpOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgaWYocCA8PSAxMDI0KSB7CiAgICAgICAgY29uc3RfdGFiW25dID0geyBwcmVjOiBwLCB2YWw6IGMgfTsKICAgICAgfQogICAgICByZXR1cm4gYzsKICAgIH0KICB9CgogIGFkZF9wcm9wcyhGbG9hdCwgewogICAgaXNGbG9hdChhKSB7CiAgICAgIHJldHVybiB0eXBlb2YgYSA9PT0gJ251bWJlcicgfHwgdHlwZW9mIGEgPT09ICdiaWdmbG9hdCc7CiAgICB9LAogICAgYmVzdGFwcHIodSwgYikgewogICAgICB2YXIgbnVtMSwgbnVtMCwgZGVuMSwgZGVuMCwgdSwgbnVtLCBkZW4sIG47CgogICAgICBpZih0eXBlb2YgYiA9PT0gJ3VuZGVmaW5lZCcpIHRocm93IFR5cGVFcnJvcignc2Vjb25kIGFyZ3VtZW50IGV4cGVjdGVkJyk7CiAgICAgIG51bTEgPSAxOwogICAgICBudW0wID0gMDsKICAgICAgZGVuMSA9IDA7CiAgICAgIGRlbjAgPSAxOwogICAgICBmb3IoOzspIHsKICAgICAgICBuID0gSW50ZWdlcihGbG9hdC5mbG9vcih1KSk7CiAgICAgICAgbnVtID0gbiAqIG51bTEgKyBudW0wOwogICAgICAgIGRlbiA9IG4gKiBkZW4xICsgZGVuMDsKICAgICAgICBpZihkZW4gPiBiKSBicmVhazsKICAgICAgICB1ID0gMS4wIC8gKHUgLSBuKTsKICAgICAgICBudW0wID0gbnVtMTsKICAgICAgICBudW0xID0gbnVtOwogICAgICAgIGRlbjAgPSBkZW4xOwogICAgICAgIGRlbjEgPSBkZW47CiAgICAgIH0KICAgICAgcmV0dXJuIEZyYWN0aW9uKG51bTEsIGRlbjEpOwogICAgfSwKICAgIC8qIHNpbWlsYXIgY29uc3RhbnRzIGFzIE1hdGgueCAqLwogICAgLyogcHJldHRpZXItaWdub3JlICovIGdldCBFKCkgeyByZXR1cm4gZ2V0X2NvbnN0KDApOyB9LAogICAgLyogcHJldHRpZXItaWdub3JlICovIGdldCBMTjEwKCkgeyByZXR1cm4gZ2V0X2NvbnN0KDEpOyB9LAogICAgLy8gICAgICAgIGdldCBMTjIoKSB7IHJldHVybiBnZXRfY29uc3QoMik7IH0sCiAgICAvKiBwcmV0dGllci1pZ25vcmUgKi8gZ2V0IExPRzJFKCkgeyByZXR1cm4gZ2V0X2NvbnN0KDMpOyB9LAogICAgLyogcHJldHRpZXItaWdub3JlICovIGdldCBMT0cxMEUoKSB7IHJldHVybiBnZXRfY29uc3QoNCk7IH0sCiAgICAvLyAgICAgICAgZ2V0IFBJKCkgeyByZXR1cm4gZ2V0X2NvbnN0KDUpOyB9LAogICAgLyogcHJldHRpZXItaWdub3JlICovIGdldCBTUVJUMV8yKCkgeyByZXR1cm4gZ2V0X2NvbnN0KDYpOyB9LAogICAgLyogcHJldHRpZXItaWdub3JlICovIGdldCBTUVJUMigpIHsgcmV0dXJuIGdldF9jb25zdCg3KTsgfQogIH0pOwoKICBhZGRfcHJvcHMoRmxvYXQucHJvdG90eXBlLCB7CiAgICBpbnZlcnNlKCkgewogICAgICByZXR1cm4gMS4wIC8gdGhpczsKICAgIH0sCiAgICBub3JtMigpIHsKICAgICAgcmV0dXJuIHRoaXMgKiB0aGlzOwogICAgfSwKICAgIGFicygpIHsKICAgICAgcmV0dXJuIEZsb2F0LmFicyh0aGlzKTsKICAgIH0sCiAgICBjb25qKCkgewogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICBhcmcoKSB7CiAgICAgIGlmKHRoaXMgPj0gMCkgcmV0dXJuIDA7CiAgICAgIGVsc2UgcmV0dXJuIEZsb2F0LlBJOwogICAgfSwKICAgIGV4cCgpIHsKICAgICAgcmV0dXJuIEZsb2F0LmV4cCh0aGlzKTsKICAgIH0sCiAgICBsb2coKSB7CiAgICAgIGlmKHRoaXMgPCAwKSB7CiAgICAgICAgcmV0dXJuIENvbXBsZXgodGhpcykubG9nKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIEZsb2F0LmxvZyh0aGlzKTsKICAgICAgfQogICAgfQogIH0pOwoKICAvKiBDb21wbGV4ICovCgogIENvbXBsZXggPSBmdW5jdGlvbiBDb21wbGV4KHJlLCBpbSkgewogICAgdmFyIG9iajsKICAgIGlmKG5ldy50YXJnZXQpIHRocm93IFR5cGVFcnJvcignbm90IGEgY29uc3RydWN0b3InKTsKICAgIGlmKHJlIGluc3RhbmNlb2YgQ29tcGxleCkgcmV0dXJuIHJlOwogICAgaWYodHlwZW9mIGltID09PSAndW5kZWZpbmVkJykgewogICAgICBpbSA9IDA7CiAgICB9CiAgICBvYmogPSBPYmplY3QuY3JlYXRlKENvbXBsZXgucHJvdG90eXBlKTsKICAgIG9iai5yZSA9IHJlOwogICAgb2JqLmltID0gaW07CiAgICByZXR1cm4gb2JqOwogIH07CgogIGZ1bmN0aW9uIGNvbXBsZXhfYWRkKGEsIGIpIHsKICAgIGEgPSBDb21wbGV4KGEpOwogICAgYiA9IENvbXBsZXgoYik7CiAgICByZXR1cm4gQ29tcGxleC50b0NvbXBsZXgoYS5yZSArIGIucmUsIGEuaW0gKyBiLmltKTsKICB9CiAgZnVuY3Rpb24gY29tcGxleF9zdWIoYSwgYikgewogICAgYSA9IENvbXBsZXgoYSk7CiAgICBiID0gQ29tcGxleChiKTsKICAgIHJldHVybiBDb21wbGV4LnRvQ29tcGxleChhLnJlIC0gYi5yZSwgYS5pbSAtIGIuaW0pOwogIH0KICBmdW5jdGlvbiBjb21wbGV4X211bChhLCBiKSB7CiAgICBhID0gQ29tcGxleChhKTsKICAgIGIgPSBDb21wbGV4KGIpOwogICAgcmV0dXJuIENvbXBsZXgudG9Db21wbGV4KGEucmUgKiBiLnJlIC0gYS5pbSAqIGIuaW0sIGEucmUgKiBiLmltICsgYS5pbSAqIGIucmUpOwogIH0KICBmdW5jdGlvbiBjb21wbGV4X2RpdihhLCBiKSB7CiAgICBhID0gQ29tcGxleChhKTsKICAgIGIgPSBDb21wbGV4KGIpOwogICAgcmV0dXJuIGEgKiBiLmludmVyc2UoKTsKICB9CiAgZnVuY3Rpb24gY29tcGxleF9lcShhLCBiKSB7CiAgICBhID0gQ29tcGxleChhKTsKICAgIGIgPSBDb21wbGV4KGIpOwogICAgcmV0dXJuIGEucmUgPT0gYi5yZSAmJiBhLmltID09IGIuaW07CiAgfQoKICBvcGVyYXRvcnNfc2V0KAogICAgQ29tcGxleC5wcm90b3R5cGUsCiAgICB7CiAgICAgICcrJzogY29tcGxleF9hZGQsCiAgICAgICctJzogY29tcGxleF9zdWIsCiAgICAgICcqJzogY29tcGxleF9tdWwsCiAgICAgICcvJzogY29tcGxleF9kaXYsCiAgICAgICcqKic6IGdlbmVyaWNfcG93LAogICAgICAnPT0nOiBjb21wbGV4X2VxLAogICAgICBwb3MoYSkgewogICAgICAgIHJldHVybiBhOwogICAgICB9LAogICAgICBuZWcoYSkgewogICAgICAgIHJldHVybiBDb21wbGV4KC1hLnJlLCAtYS5pbSk7CiAgICAgIH0KICAgIH0sCiAgICB7CiAgICAgIGxlZnQ6IFtOdW1iZXIsIEJpZ0ludCwgRmxvYXQsIEZyYWN0aW9uXSwKICAgICAgcmlnaHQ6IFtOdW1iZXIsIEJpZ0ludCwgRmxvYXQsIEZyYWN0aW9uXSwKICAgICAgJysnOiBjb21wbGV4X2FkZCwKICAgICAgJy0nOiBjb21wbGV4X3N1YiwKICAgICAgJyonOiBjb21wbGV4X211bCwKICAgICAgJy8nOiBjb21wbGV4X2RpdiwKICAgICAgJyoqJzogZ2VuZXJpY19wb3csCiAgICAgICc9PSc6IGNvbXBsZXhfZXEKICAgIH0KICApOwoKICBhZGRfcHJvcHMoQ29tcGxleCwgewogICAgLyogc2ltcGxpZnkgdG8gcmVhbCBudW1iZXIgd2hlbiBwb3NzaWJsZSAqLwogICAgdG9Db21wbGV4KHJlLCBpbSkgewogICAgICBpZihhbGdlYnJhaWNNb2RlICYmIGltID09IDApIHJldHVybiByZTsKICAgICAgZWxzZSByZXR1cm4gQ29tcGxleChyZSwgaW0pOwogICAgfQogIH0pOwoKICBhZGRfcHJvcHMoQ29tcGxleC5wcm90b3R5cGUsIHsKICAgIGludmVyc2UoKSB7CiAgICAgIHZhciBjID0gdGhpcy5ub3JtMigpOwogICAgICByZXR1cm4gQ29tcGxleCh0aGlzLnJlIC8gYywgLXRoaXMuaW0gLyBjKTsKICAgIH0sCiAgICB0b1N0cmluZygpIHsKICAgICAgdmFyIHYsCiAgICAgICAgcyA9ICcnLAogICAgICAgIGEgPSB0aGlzOwogICAgICBpZihhLnJlICE9IDApIHMgKz0gYS5yZS50b1N0cmluZygpOwogICAgICBpZihhLmltID09IDEpIHsKICAgICAgICBpZihzICE9ICcnKSBzICs9ICcrJzsKICAgICAgICBzICs9ICdJJzsKICAgICAgfSBlbHNlIGlmKGEuaW0gPT0gLTEpIHsKICAgICAgICBzICs9ICctSSc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdiA9IGEuaW0udG9TdHJpbmcoKTsKICAgICAgICBpZih2WzBdICE9ICctJyAmJiBzICE9ICcnKSBzICs9ICcrJzsKICAgICAgICBzICs9IHYgKyAnKkknOwogICAgICB9CiAgICAgIHJldHVybiBzOwogICAgfSwKICAgIG5vcm0yKCkgewogICAgICByZXR1cm4gdGhpcy5yZSAqIHRoaXMucmUgKyB0aGlzLmltICogdGhpcy5pbTsKICAgIH0sCiAgICBhYnMoKSB7CiAgICAgIHJldHVybiBGbG9hdC5zcXJ0KG5vcm0yKHRoaXMpKTsKICAgIH0sCiAgICBjb25qKCkgewogICAgICByZXR1cm4gQ29tcGxleCh0aGlzLnJlLCAtdGhpcy5pbSk7CiAgICB9LAogICAgYXJnKCkgewogICAgICByZXR1cm4gRmxvYXQuYXRhbjIodGhpcy5pbSwgdGhpcy5yZSk7CiAgICB9LAogICAgZXhwKCkgewogICAgICB2YXIgYXJnID0gdGhpcy5pbSwKICAgICAgICByID0gdGhpcy5yZS5leHAoKTsKICAgICAgcmV0dXJuIENvbXBsZXgociAqIGNvcyhhcmcpLCByICogc2luKGFyZykpOwogICAgfSwKICAgIGxvZygpIHsKICAgICAgcmV0dXJuIENvbXBsZXgoYWJzKHRoaXMpLmxvZygpLCBhdGFuMih0aGlzLmltLCB0aGlzLnJlKSk7CiAgICB9CiAgfSk7CgogIC8qIE1vZCAqLwoKICBNb2QgPSBmdW5jdGlvbiBNb2QoYSwgbSkgewogICAgdmFyIG9iaiwgdDsKICAgIGlmKG5ldy50YXJnZXQpIHRocm93IFR5cGVFcnJvcignbm90IGEgY29uc3RydWN0b3InKTsKICAgIG9iaiA9IE9iamVjdC5jcmVhdGUoTW9kLnByb3RvdHlwZSk7CiAgICBpZihJbnRlZ2VyLmlzSW50ZWdlcihtKSkgewogICAgICBpZihtIDw9IDApIHRocm93IFJhbmdlRXJyb3IoJ3RoZSBtb2R1bG8gY2Fubm90IGJlIDw9IDAnKTsKICAgICAgaWYoSW50ZWdlci5pc0ludGVnZXIoYSkpIHsKICAgICAgICBhICU9IG07CiAgICAgIH0gZWxzZSBpZihhIGluc3RhbmNlb2YgRnJhY3Rpb24pIHsKICAgICAgICByZXR1cm4gTW9kKGEubnVtLCBtKSAvIGEuZGVuOwogICAgICB9IGVsc2UgewogICAgICAgIHRocm93IFR5cGVFcnJvcignaW52YWxpZCB0eXBlcycpOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICB0aHJvdyBUeXBlRXJyb3IoJ2ludmFsaWQgdHlwZXMnKTsKICAgIH0KICAgIG9iai5yZXMgPSBhOwogICAgb2JqLm1vZCA9IG07CiAgICByZXR1cm4gb2JqOwogIH07CgogIGZ1bmN0aW9uIG1vZF9hZGQoYSwgYikgewogICAgaWYoIShhIGluc3RhbmNlb2YgTW9kKSkgewogICAgICByZXR1cm4gTW9kKGEgKyBiLnJlcywgYi5tb2QpOwogICAgfSBlbHNlIGlmKCEoYiBpbnN0YW5jZW9mIE1vZCkpIHsKICAgICAgcmV0dXJuIE1vZChhLnJlcyArIGIsIGEubW9kKTsKICAgIH0gZWxzZSB7CiAgICAgIGlmKGEubW9kICE9IGIubW9kKSB0aHJvdyBUeXBlRXJyb3IoJ2RpZmZlcmVudCBtb2R1bG8gZm9yIGJpbmFyeSBvcGVyYXRvcicpOwogICAgICByZXR1cm4gTW9kKGEucmVzICsgYi5yZXMsIGEubW9kKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gbW9kX3N1YihhLCBiKSB7CiAgICBpZighKGEgaW5zdGFuY2VvZiBNb2QpKSB7CiAgICAgIHJldHVybiBNb2QoYSAtIGIucmVzLCBiLm1vZCk7CiAgICB9IGVsc2UgaWYoIShiIGluc3RhbmNlb2YgTW9kKSkgewogICAgICByZXR1cm4gTW9kKGEucmVzIC0gYiwgYS5tb2QpOwogICAgfSBlbHNlIHsKICAgICAgaWYoYS5tb2QgIT0gYi5tb2QpIHRocm93IFR5cGVFcnJvcignZGlmZmVyZW50IG1vZHVsbyBmb3IgYmluYXJ5IG9wZXJhdG9yJyk7CiAgICAgIHJldHVybiBNb2QoYS5yZXMgLSBiLnJlcywgYS5tb2QpOwogICAgfQogIH0KICBmdW5jdGlvbiBtb2RfbXVsKGEsIGIpIHsKICAgIGlmKCEoYSBpbnN0YW5jZW9mIE1vZCkpIHsKICAgICAgcmV0dXJuIE1vZChhICogYi5yZXMsIGIubW9kKTsKICAgIH0gZWxzZSBpZighKGIgaW5zdGFuY2VvZiBNb2QpKSB7CiAgICAgIHJldHVybiBNb2QoYS5yZXMgKiBiLCBhLm1vZCk7CiAgICB9IGVsc2UgewogICAgICBpZihhLm1vZCAhPSBiLm1vZCkgdGhyb3cgVHlwZUVycm9yKCdkaWZmZXJlbnQgbW9kdWxvIGZvciBiaW5hcnkgb3BlcmF0b3InKTsKICAgICAgcmV0dXJuIE1vZChhLnJlcyAqIGIucmVzLCBhLm1vZCk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIG1vZF9kaXYoYSwgYikgewogICAgaWYoIShiIGluc3RhbmNlb2YgTW9kKSkgYiA9IE1vZChiLCBhLm1vZCk7CiAgICByZXR1cm4gbW9kX211bChhLCBiLmludmVyc2UoKSk7CiAgfQogIGZ1bmN0aW9uIG1vZF9lcShhLCBiKSB7CiAgICByZXR1cm4gYS5tb2QgPT0gYi5tb2QgJiYgYS5yZXMgPT0gYi5yZXM7CiAgfQoKICBvcGVyYXRvcnNfc2V0KAogICAgTW9kLnByb3RvdHlwZSwKICAgIHsKICAgICAgJysnOiBtb2RfYWRkLAogICAgICAnLSc6IG1vZF9zdWIsCiAgICAgICcqJzogbW9kX211bCwKICAgICAgJy8nOiBtb2RfZGl2LAogICAgICAnKionOiBnZW5lcmljX3BvdywKICAgICAgJz09JzogbW9kX2VxLAogICAgICBwb3MoYSkgewogICAgICAgIHJldHVybiBhOwogICAgICB9LAogICAgICBuZWcoYSkgewogICAgICAgIHJldHVybiBNb2QoLWEucmVzLCBhLm1vZCk7CiAgICAgIH0KICAgIH0sCiAgICB7CiAgICAgIGxlZnQ6IFtOdW1iZXIsIEJpZ0ludCwgRmxvYXQsIEZyYWN0aW9uXSwKICAgICAgcmlnaHQ6IFtOdW1iZXIsIEJpZ0ludCwgRmxvYXQsIEZyYWN0aW9uXSwKICAgICAgJysnOiBtb2RfYWRkLAogICAgICAnLSc6IG1vZF9zdWIsCiAgICAgICcqJzogbW9kX211bCwKICAgICAgJy8nOiBtb2RfZGl2LAogICAgICAnKionOiBnZW5lcmljX3BvdwogICAgfQogICk7CgogIGFkZF9wcm9wcyhNb2QucHJvdG90eXBlLCB7CiAgICBpbnZlcnNlKCkgewogICAgICB2YXIgYSA9IHRoaXMsCiAgICAgICAgbSA9IGEubW9kOwogICAgICBpZihJbnRlZ2VyLmlzSW50ZWdlcihtKSkgewogICAgICAgIHJldHVybiBNb2QoSW50ZWdlci5pbnZtb2QoYS5yZXMsIG0pLCBtKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aHJvdyBUeXBlRXJyb3IoJ3Vuc3VwcG9ydGVkIHR5cGUnKTsKICAgICAgfQogICAgfSwKICAgIHRvU3RyaW5nKCkgewogICAgICByZXR1cm4gJ01vZCgnICsgdGhpcy5yZXMgKyAnLCcgKyB0aGlzLm1vZCArICcpJzsKICAgIH0KICB9KTsKCiAgLyogUG9seW5vbWlhbCAqLwoKICBmdW5jdGlvbiBwb2x5bm9taWFsX2lzX3NjYWxhcihhKSB7CiAgICBpZih0eXBlb2YgYSA9PT0gJ251bWJlcicgfHwgdHlwZW9mIGEgPT09ICdiaWdpbnQnIHx8IHR5cGVvZiBhID09PSAnYmlnZmxvYXQnKSByZXR1cm4gdHJ1ZTsKICAgIGlmKGEgaW5zdGFuY2VvZiBGcmFjdGlvbiB8fCBhIGluc3RhbmNlb2YgQ29tcGxleCB8fCBhIGluc3RhbmNlb2YgTW9kKSByZXR1cm4gdHJ1ZTsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIFBvbHlub21pYWwgPSBmdW5jdGlvbiBQb2x5bm9taWFsKGEpIHsKICAgIGlmKG5ldy50YXJnZXQpIHRocm93IFR5cGVFcnJvcignbm90IGEgY29uc3RydWN0b3InKTsKICAgIGlmKGEgaW5zdGFuY2VvZiBQb2x5bm9taWFsKSB7CiAgICAgIHJldHVybiBhOwogICAgfSBlbHNlIGlmKEFycmF5LmlzQXJyYXkoYSkpIHsKICAgICAgaWYoYS5sZW5ndGggPT0gMCkgYSA9IFswXTsKICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGEsIFBvbHlub21pYWwucHJvdG90eXBlKTsKICAgICAgcmV0dXJuIGEudHJpbSgpOwogICAgfSBlbHNlIGlmKHBvbHlub21pYWxfaXNfc2NhbGFyKGEpKSB7CiAgICAgIGEgPSBbYV07CiAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihhLCBQb2x5bm9taWFsLnByb3RvdHlwZSk7CiAgICAgIHJldHVybiBhOwogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgVHlwZUVycm9yKCdpbnZhbGlkIHR5cGUnKTsKICAgIH0KICB9OwoKICBmdW5jdGlvbiBudW1iZXJfbmVlZF9wYXJlbihjKSB7CiAgICByZXR1cm4gIShJbnRlZ2VyLmlzSW50ZWdlcihjKSB8fCBGbG9hdC5pc0Zsb2F0KGMpIHx8IGMgaW5zdGFuY2VvZiBGcmFjdGlvbiB8fCAoYyBpbnN0YW5jZW9mIENvbXBsZXggJiYgYy5yZSA9PSAwKSk7CiAgfQoKICAvKiBzdHJpbmcgZm9yIGMqWF5pICovCiAgZnVuY3Rpb24gbW9ub21pYWxfdG9TdHJpbmcoYywgaSkgewogICAgdmFyIHN0cjE7CiAgICBpZihpID09IDApIHsKICAgICAgc3RyMSA9IGMudG9TdHJpbmcoKTsKICAgIH0gZWxzZSB7CiAgICAgIGlmKGMgPT0gMSkgewogICAgICAgIHN0cjEgPSAnJzsKICAgICAgfSBlbHNlIGlmKGMgPT0gLTEpIHsKICAgICAgICBzdHIxID0gJy0nOwogICAgICB9IGVsc2UgewogICAgICAgIGlmKG51bWJlcl9uZWVkX3BhcmVuKGMpKSB7CiAgICAgICAgICBzdHIxID0gJygnICsgYyArICcpJzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc3RyMSA9IFN0cmluZyhjKTsKICAgICAgICB9CiAgICAgICAgc3RyMSArPSAnKic7CiAgICAgIH0KICAgICAgc3RyMSArPSAnWCc7CiAgICAgIGlmKGkgIT0gMSkgewogICAgICAgIHN0cjEgKz0gJ14nICsgaTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIHN0cjE7CiAgfQoKICAvKiBmaW5kIG9uZSBjb21wbGV4IHJvb3Qgb2YgJ3AnIHN0YXJ0aW5nIGZyb20geiBhdCBwcmVjaXNpb24gZXBzIHVzaW5nCiAgICAgICBhdCBtb3N0IG1heF9pdCBpdGVyYXRpb25zLiBSZXR1cm4gbnVsbCBpZiBjb3VsZCBub3QgZmluZCByb290LiAqLwogIGZ1bmN0aW9uIHBvbHlfcm9vdF9sYWd1ZXJyZTEocCwgeiwgbWF4X2l0KSB7CiAgICB2YXIgcDEsIHAyLCBpLCB6MCwgejEsIHoyLCBkLCB0MCwgdDEsIGQxLCBkMiwgZSwgZWwsIHpsOwoKICAgIGQgPSBwLmRlZygpOwogICAgaWYoZCA9PSAxKSB7CiAgICAgIC8qIG1vbm9taWFsIGNhc2UgKi8KICAgICAgcmV0dXJuIC1wWzBdIC8gcFsxXTsKICAgIH0KICAgIC8qIHRyaXZpYWwgemVybyAqLwogICAgaWYocFswXSA9PSAwKSByZXR1cm4gMC4wOwoKICAgIHAxID0gcC5kZXJpdigpOwogICAgcDIgPSBwMS5kZXJpdigpOwogICAgZWwgPSAwLjA7CiAgICB6bCA9IDAuMDsKICAgIGZvcihpID0gMDsgaSA8IG1heF9pdDsgaSsrKSB7CiAgICAgIHowID0gcC5hcHBseSh6KTsKICAgICAgaWYoejAgPT0gMCkgcmV0dXJuIHo7IC8qIHNpbXBsZSBleGl0IGNhc2UgKi8KCiAgICAgIC8qIFdhcmQgc3RvcHBpbmcgY3JpdGVyaWEgKi8KICAgICAgZSA9IGFicyh6IC0gemwpOwogICAgICAvLyAgICAgICAgICAgIHByaW50KCJlIiwgaSwgZSk7CiAgICAgIGlmKGkgPj0gMiAmJiBlID49IGVsKSB7CiAgICAgICAgaWYoYWJzKHpsKSA8IDFlLTQpIHsKICAgICAgICAgIGlmKGUgPCAxZS03KSByZXR1cm4gemw7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmKGUgPCBhYnMoemwpICogMWUtMykgcmV0dXJuIHpsOwogICAgICAgIH0KICAgICAgfQogICAgICBlbCA9IGU7CiAgICAgIHpsID0gejsKCiAgICAgIHoxID0gcDEuYXBwbHkoeik7CiAgICAgIHoyID0gcDIuYXBwbHkoeik7CiAgICAgIHQwID0gKGQgLSAxKSAqIHoxOwogICAgICB0MCA9IHQwICogdDA7CiAgICAgIHQxID0gZCAqIChkIC0gMSkgKiB6MCAqIHoyOwogICAgICB0MCA9IHNxcnQodDAgLSB0MSk7CiAgICAgIGQxID0gejEgKyB0MDsKICAgICAgZDIgPSB6MSAtIHQwOwogICAgICBpZihub3JtMihkMikgPiBub3JtMihkMSkpIGQxID0gZDI7CiAgICAgIGlmKGQxID09IDApIHJldHVybiBudWxsOwogICAgICB6ID0geiAtIChkICogejApIC8gZDE7CiAgICB9CiAgICByZXR1cm4gbnVsbDsKICB9CgogIGZ1bmN0aW9uIHBvbHlfcm9vdHMocCkgewogICAgdmFyIGQsIGksIHJvb3RzLCBqLCB6LCBlcHM7CiAgICB2YXIgc3RhcnRfcG9pbnRzID0gWzAuMSwgLTEuNCwgMS43XTsKCiAgICBpZighKHAgaW5zdGFuY2VvZiBQb2x5bm9taWFsKSkgdGhyb3cgVHlwZUVycm9yKCdwb2x5bm9taWFsIGV4cGVjdGVkJyk7CiAgICBkID0gcC5kZWcoKTsKICAgIGlmKGQgPD0gMCkgcmV0dXJuIFtdOwogICAgZXBzID0gMi4wIF4gLUJpZ0Zsb2F0RW52LnByZWM7CiAgICByb290cyA9IFtdOwogICAgZm9yKGkgPSAwOyBpIDwgZDsgaSsrKSB7CiAgICAgIC8qIFhYWDogc2hvdWxkIHNlbGVjdCBhbm90aGVyIHN0YXJ0IHBvaW50IGlmIGVycm9yICovCiAgICAgIGZvcihqID0gMDsgaiA8IDM7IGorKykgewogICAgICAgIHogPSBwb2x5X3Jvb3RfbGFndWVycmUxKHAsIHN0YXJ0X3BvaW50c1tqXSwgMTAwKTsKICAgICAgICBpZih6ICE9PSBudWxsKSBicmVhazsKICAgICAgfQogICAgICBpZihqID09IDMpIHRocm93IFJhbmdlRXJyb3IoJ2Vycm9yIGluIHJvb3QgZmluZGluZyBhbGdvcml0aG0nKTsKICAgICAgcm9vdHNbaV0gPSB6OwogICAgICBwID0gUG9seW5vbWlhbC5kaXZyZW0ocCwgWCAtIHopWzBdOwogICAgfQogICAgcmV0dXJuIHJvb3RzOwogIH0KCiAgYWRkX3Byb3BzKFBvbHlub21pYWwucHJvdG90eXBlLCB7CiAgICB0cmltKCkgewogICAgICB2YXIgYSA9IHRoaXMsCiAgICAgICAgaTsKICAgICAgaSA9IGEubGVuZ3RoOwogICAgICB3aGlsZShpID4gMSAmJiBhW2kgLSAxXSA9PSAwKSBpLS07CiAgICAgIGEubGVuZ3RoID0gaTsKICAgICAgcmV0dXJuIGE7CiAgICB9LAogICAgY29uaigpIHsKICAgICAgdmFyIHIsIGksIG4sIGE7CiAgICAgIGEgPSB0aGlzOwogICAgICBuID0gYS5sZW5ndGg7CiAgICAgIHIgPSBbXTsKICAgICAgZm9yKGkgPSAwOyBpIDwgbjsgaSsrKSByW2ldID0gYVtpXS5jb25qKCk7CiAgICAgIHJldHVybiBQb2x5bm9taWFsKHIpOwogICAgfSwKICAgIGludmVyc2UoKSB7CiAgICAgIHJldHVybiBSYXRpb25hbEZ1bmN0aW9uKFBvbHlub21pYWwoWzFdKSwgdGhpcyk7CiAgICB9LAogICAgdG9TdHJpbmcoKSB7CiAgICAgIHZhciBpLAogICAgICAgIHN0ciwKICAgICAgICBzdHIxLAogICAgICAgIGMsCiAgICAgICAgYSA9IHRoaXM7CiAgICAgIGlmKGEubGVuZ3RoID09IDEpIHsKICAgICAgICByZXR1cm4gYVswXS50b1N0cmluZygpOwogICAgICB9CiAgICAgIHN0ciA9ICcnOwogICAgICBmb3IoaSA9IGEubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICBjID0gYVtpXTsKICAgICAgICBpZihjID09IDAgfHwgKGMgaW5zdGFuY2VvZiBNb2QgJiYgYy5yZXMgPT0gMCkpIGNvbnRpbnVlOwogICAgICAgIHN0cjEgPSBtb25vbWlhbF90b1N0cmluZyhjLCBpKTsKICAgICAgICBpZihzdHIxWzBdICE9ICctJykgewogICAgICAgICAgaWYoc3RyICE9ICcnKSBzdHIgKz0gJysnOwogICAgICAgIH0KICAgICAgICBzdHIgKz0gc3RyMTsKICAgICAgfQogICAgICByZXR1cm4gc3RyOwogICAgfSwKICAgIGRlZygpIHsKICAgICAgaWYodGhpcy5sZW5ndGggPT0gMSAmJiB0aGlzWzBdID09IDApIHJldHVybiAtSW5maW5pdHk7CiAgICAgIGVsc2UgcmV0dXJuIHRoaXMubGVuZ3RoIC0gMTsKICAgIH0sCiAgICBhcHBseShiKSB7CiAgICAgIHZhciBpLAogICAgICAgIG4sCiAgICAgICAgciwKICAgICAgICBhID0gdGhpczsKICAgICAgbiA9IGEubGVuZ3RoIC0gMTsKICAgICAgciA9IGFbbl07CiAgICAgIHdoaWxlKG4gPiAwKSB7CiAgICAgICAgbi0tOwogICAgICAgIHIgPSByICogYiArIGFbbl07CiAgICAgIH0KICAgICAgcmV0dXJuIHI7CiAgICB9LAogICAgZGVyaXYoKSB7CiAgICAgIHZhciBhID0gdGhpcywKICAgICAgICBuLAogICAgICAgIHIsCiAgICAgICAgaTsKICAgICAgbiA9IGEubGVuZ3RoOwogICAgICBpZihuID09IDEpIHsKICAgICAgICByZXR1cm4gUG9seW5vbWlhbCgwKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByID0gW107CiAgICAgICAgZm9yKGkgPSAxOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICByW2kgLSAxXSA9IGkgKiBhW2ldOwogICAgICAgIH0KICAgICAgICByZXR1cm4gUG9seW5vbWlhbChyKTsKICAgICAgfQogICAgfSwKICAgIGludGVnKCkgewogICAgICB2YXIgYSA9IHRoaXMsCiAgICAgICAgbiwKICAgICAgICByLAogICAgICAgIGk7CiAgICAgIG4gPSBhLmxlbmd0aDsKICAgICAgciA9IFswXTsKICAgICAgZm9yKGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgcltpICsgMV0gPSBhW2ldIC8gKGkgKyAxKTsKICAgICAgfQogICAgICByZXR1cm4gUG9seW5vbWlhbChyKTsKICAgIH0sCiAgICBub3JtMigpIHsKICAgICAgdmFyIGEgPSB0aGlzLAogICAgICAgIG4sCiAgICAgICAgciwKICAgICAgICBpOwogICAgICBuID0gYS5sZW5ndGg7CiAgICAgIHIgPSAwOwogICAgICBmb3IoaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICByICs9IGFbaV0ubm9ybTIoKTsKICAgICAgfQogICAgICByZXR1cm4gcjsKICAgIH0KICB9KTsKCiAgZnVuY3Rpb24gcG9seW5vbWlhbF9hZGQoYSwgYikgewogICAgdmFyIHRtcCwgciwgaSwgbjEsIG4yOwogICAgYSA9IFBvbHlub21pYWwoYSk7CiAgICBiID0gUG9seW5vbWlhbChiKTsKICAgIGlmKGEubGVuZ3RoIDwgYi5sZW5ndGgpIHsKICAgICAgdG1wID0gYTsKICAgICAgYSA9IGI7CiAgICAgIGIgPSB0bXA7CiAgICB9CiAgICBuMSA9IGIubGVuZ3RoOwogICAgbjIgPSBhLmxlbmd0aDsKICAgIHIgPSBbXTsKICAgIGZvcihpID0gMDsgaSA8IG4xOyBpKyspIHJbaV0gPSBhW2ldICsgYltpXTsKICAgIGZvcihpID0gbjE7IGkgPCBuMjsgaSsrKSByW2ldID0gYVtpXTsKICAgIHJldHVybiBQb2x5bm9taWFsKHIpOwogIH0KICBmdW5jdGlvbiBwb2x5bm9taWFsX3N1YihhLCBiKSB7CiAgICByZXR1cm4gcG9seW5vbWlhbF9hZGQoYSwgLWIpOwogIH0KICBmdW5jdGlvbiBwb2x5bm9taWFsX211bChhLCBiKSB7CiAgICB2YXIgaSwgaiwgbjEsIG4yLCBuLCByOwogICAgYSA9IFBvbHlub21pYWwoYSk7CiAgICBiID0gUG9seW5vbWlhbChiKTsKICAgIG4xID0gYS5sZW5ndGg7CiAgICBuMiA9IGIubGVuZ3RoOwogICAgbiA9IG4xICsgbjIgLSAxOwogICAgciA9IFtdOwogICAgZm9yKGkgPSAwOyBpIDwgbjsgaSsrKSByW2ldID0gMDsKICAgIGZvcihpID0gMDsgaSA8IG4xOyBpKyspIHsKICAgICAgZm9yKGogPSAwOyBqIDwgbjI7IGorKykgewogICAgICAgIHJbaSArIGpdICs9IGFbaV0gKiBiW2pdOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gUG9seW5vbWlhbChyKTsKICB9CiAgZnVuY3Rpb24gcG9seW5vbWlhbF9kaXZfc2NhbGFyKGEsIGIpIHsKICAgIHJldHVybiBhICogKDEgLyBiKTsKICB9CiAgZnVuY3Rpb24gcG9seW5vbWlhbF9kaXYoYSwgYikgewogICAgcmV0dXJuIFJhdGlvbmFsRnVuY3Rpb24oUG9seW5vbWlhbChhKSwgUG9seW5vbWlhbChiKSk7CiAgfQogIGZ1bmN0aW9uIHBvbHlub21pYWxfbW9kKGEsIGIpIHsKICAgIHJldHVybiBQb2x5bm9taWFsLmRpdnJlbShhLCBiKVsxXTsKICB9CiAgZnVuY3Rpb24gcG9seW5vbWlhbF9lcShhLCBiKSB7CiAgICB2YXIgbiwgaTsKICAgIG4gPSBhLmxlbmd0aDsKICAgIGlmKG4gIT0gYi5sZW5ndGgpIHJldHVybiBmYWxzZTsKICAgIGZvcihpID0gMDsgaSA8IG47IGkrKykgewogICAgICBpZihhW2ldICE9IGJbaV0pIHJldHVybiBmYWxzZTsKICAgIH0KICAgIHJldHVybiB0cnVlOwogIH0KCiAgb3BlcmF0b3JzX3NldCgKICAgIFBvbHlub21pYWwucHJvdG90eXBlLAogICAgewogICAgICAnKyc6IHBvbHlub21pYWxfYWRkLAogICAgICAnLSc6IHBvbHlub21pYWxfc3ViLAogICAgICAnKic6IHBvbHlub21pYWxfbXVsLAogICAgICAnLyc6IHBvbHlub21pYWxfZGl2LAogICAgICAnKionOiBnZW5lcmljX3BvdywKICAgICAgJz09JzogcG9seW5vbWlhbF9lcSwKICAgICAgcG9zKGEpIHsKICAgICAgICByZXR1cm4gYTsKICAgICAgfSwKICAgICAgbmVnKGEpIHsKICAgICAgICB2YXIgciwgaSwgbiwgYTsKICAgICAgICBuID0gYS5sZW5ndGg7CiAgICAgICAgciA9IFtdOwogICAgICAgIGZvcihpID0gMDsgaSA8IG47IGkrKykgcltpXSA9IC1hW2ldOwogICAgICAgIHJldHVybiBQb2x5bm9taWFsKHIpOwogICAgICB9CiAgICB9LAogICAgewogICAgICBsZWZ0OiBbTnVtYmVyLCBCaWdJbnQsIEZsb2F0LCBGcmFjdGlvbiwgQ29tcGxleCwgTW9kXSwKICAgICAgJysnOiBwb2x5bm9taWFsX2FkZCwKICAgICAgJy0nOiBwb2x5bm9taWFsX3N1YiwKICAgICAgJyonOiBwb2x5bm9taWFsX211bCwKICAgICAgJy8nOiBwb2x5bm9taWFsX2RpdiwKICAgICAgJyoqJzogZ2VuZXJpY19wb3cgLyogWFhYOiBvbmx5IGZvciBpbnRlZ2VyICovCiAgICB9LAogICAgewogICAgICByaWdodDogW051bWJlciwgQmlnSW50LCBGbG9hdCwgRnJhY3Rpb24sIENvbXBsZXgsIE1vZF0sCiAgICAgICcrJzogcG9seW5vbWlhbF9hZGQsCiAgICAgICctJzogcG9seW5vbWlhbF9zdWIsCiAgICAgICcqJzogcG9seW5vbWlhbF9tdWwsCiAgICAgICcvJzogcG9seW5vbWlhbF9kaXZfc2NhbGFyLAogICAgICAnKionOiBnZW5lcmljX3BvdyAvKiBYWFg6IG9ubHkgZm9yIGludGVnZXIgKi8KICAgIH0KICApOwoKICBhZGRfcHJvcHMoUG9seW5vbWlhbCwgewogICAgZGl2cmVtKGEsIGIpIHsKICAgICAgdmFyIG4xLCBuMiwgaSwgaiwgcSwgciwgbiwgYzsKICAgICAgaWYoYi5kZWcoKSA8IDApIHRocm93IFJhbmdlRXJyb3IoJ2RpdmlzaW9uIGJ5IHplcm8nKTsKICAgICAgbjEgPSBhLmxlbmd0aDsKICAgICAgbjIgPSBiLmxlbmd0aDsKICAgICAgaWYobjEgPCBuMikgcmV0dXJuIFtQb2x5bm9taWFsKFswXSksIGFdOwogICAgICByID0gQXJyYXkucHJvdG90eXBlLmR1cC5jYWxsKGEpOwogICAgICBxID0gW107CiAgICAgIG4yLS07CiAgICAgIG4gPSBuMSAtIG4yOwogICAgICBmb3IoaSA9IDA7IGkgPCBuOyBpKyspIHFbaV0gPSAwOwogICAgICBmb3IoaSA9IG4gLSAxOyBpID49IDA7IGktLSkgewogICAgICAgIGMgPSByW2kgKyBuMl07CiAgICAgICAgaWYoYyAhPSAwKSB7CiAgICAgICAgICBjID0gYyAvIGJbbjJdOwogICAgICAgICAgcltpICsgbjJdID0gMDsKICAgICAgICAgIGZvcihqID0gMDsgaiA8IG4yOyBqKyspIHsKICAgICAgICAgICAgcltpICsgal0gLT0gYltqXSAqIGM7CiAgICAgICAgICB9CiAgICAgICAgICBxW2ldID0gYzsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIFtQb2x5bm9taWFsKHEpLCBQb2x5bm9taWFsKHIpXTsKICAgIH0sCiAgICBnY2QoYSwgYikgewogICAgICB2YXIgdDsKICAgICAgd2hpbGUoYi5kZWcoKSA+PSAwKSB7CiAgICAgICAgdCA9IFBvbHlub21pYWwuZGl2cmVtKGEsIGIpOwogICAgICAgIGEgPSBiOwogICAgICAgIGIgPSB0WzFdOwogICAgICB9CiAgICAgIC8qIGNvbnZlcnQgdG8gbW9uaWMgZm9ybSAqLwogICAgICByZXR1cm4gYSAvIGFbYS5sZW5ndGggLSAxXTsKICAgIH0sCiAgICBpbnZtb2QoeCwgeSkgewogICAgICB2YXIgcSwgdSwgdiwgYSwgYywgdDsKICAgICAgdSA9IHg7CiAgICAgIHYgPSB5OwogICAgICBjID0gUG9seW5vbWlhbChbMV0pOwogICAgICBhID0gUG9seW5vbWlhbChbMF0pOwogICAgICB3aGlsZSh1LmRlZygpID49IDApIHsKICAgICAgICB0ID0gUG9seW5vbWlhbC5kaXZyZW0odiwgdSk7CiAgICAgICAgcSA9IHRbMF07CiAgICAgICAgdiA9IHU7CiAgICAgICAgdSA9IHRbMV07CiAgICAgICAgdCA9IGM7CiAgICAgICAgYyA9IGEgLSBxICogYzsKICAgICAgICBhID0gdDsKICAgICAgfQogICAgICAvKiB2ID0gZ2NkKHgsIHkpICovCiAgICAgIGlmKHYuZGVnKCkgPiAwKSB0aHJvdyBSYW5nZUVycm9yKCdub3QgaW52ZXJ0aWJsZScpOwogICAgICByZXR1cm4gUG9seW5vbWlhbC5kaXZyZW0oYSwgeSlbMV07CiAgICB9LAogICAgcm9vdHMocCkgewogICAgICByZXR1cm4gcG9seV9yb290cyhwKTsKICAgIH0KICB9KTsKCiAgLyogUG9seW5vbWlhbCBNb2R1bG8gUSAqLwoKICBQb2x5TW9kID0gZnVuY3Rpb24gUG9seU1vZChhLCBtKSB7CiAgICB2YXIgb2JqLCB0OwogICAgaWYobmV3LnRhcmdldCkgdGhyb3cgVHlwZUVycm9yKCdub3QgYSBjb25zdHJ1Y3RvcicpOwogICAgb2JqID0gT2JqZWN0LmNyZWF0ZShQb2x5TW9kLnByb3RvdHlwZSk7CiAgICBpZihtIGluc3RhbmNlb2YgUG9seW5vbWlhbCkgewogICAgICBpZihtLmRlZygpIDw9IDApIHRocm93IFJhbmdlRXJyb3IoJ3RoZSBtb2R1bG8gY2Fubm90IGhhdmUgYSBkZWdyZWUgPD0gMCcpOwogICAgICBpZihhIGluc3RhbmNlb2YgUmF0aW9uYWxGdW5jdGlvbikgewogICAgICAgIHJldHVybiBQb2x5TW9kKGEubnVtLCBtKSAvIGEuZGVuOwogICAgICB9IGVsc2UgewogICAgICAgIGEgPSBQb2x5bm9taWFsKGEpOwogICAgICAgIHQgPSBQb2x5bm9taWFsLmRpdnJlbShhLCBtKTsKICAgICAgICBhID0gdFsxXTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgVHlwZUVycm9yKCdpbnZhbGlkIHR5cGVzJyk7CiAgICB9CiAgICBvYmoucmVzID0gYTsKICAgIG9iai5tb2QgPSBtOwogICAgcmV0dXJuIG9iajsKICB9OwoKICBmdW5jdGlvbiBwb2x5bW9kX2FkZChhLCBiKSB7CiAgICBpZighKGEgaW5zdGFuY2VvZiBQb2x5TW9kKSkgewogICAgICByZXR1cm4gUG9seU1vZChhICsgYi5yZXMsIGIubW9kKTsKICAgIH0gZWxzZSBpZighKGIgaW5zdGFuY2VvZiBQb2x5TW9kKSkgewogICAgICByZXR1cm4gUG9seU1vZChhLnJlcyArIGIsIGEubW9kKTsKICAgIH0gZWxzZSB7CiAgICAgIGlmKGEubW9kICE9IGIubW9kKSB0aHJvdyBUeXBlRXJyb3IoJ2RpZmZlcmVudCBtb2R1bG8gZm9yIGJpbmFyeSBvcGVyYXRvcicpOwogICAgICByZXR1cm4gUG9seU1vZChhLnJlcyArIGIucmVzLCBhLm1vZCk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHBvbHltb2Rfc3ViKGEsIGIpIHsKICAgIHJldHVybiBwb2x5bW9kX2FkZChhLCAtYik7CiAgfQogIGZ1bmN0aW9uIHBvbHltb2RfbXVsKGEsIGIpIHsKICAgIGlmKCEoYSBpbnN0YW5jZW9mIFBvbHlNb2QpKSB7CiAgICAgIHJldHVybiBQb2x5TW9kKGEgKiBiLnJlcywgYi5tb2QpOwogICAgfSBlbHNlIGlmKCEoYiBpbnN0YW5jZW9mIFBvbHlNb2QpKSB7CiAgICAgIHJldHVybiBQb2x5TW9kKGEucmVzICogYiwgYS5tb2QpOwogICAgfSBlbHNlIHsKICAgICAgaWYoYS5tb2QgIT0gYi5tb2QpIHRocm93IFR5cGVFcnJvcignZGlmZmVyZW50IG1vZHVsbyBmb3IgYmluYXJ5IG9wZXJhdG9yJyk7CiAgICAgIHJldHVybiBQb2x5TW9kKGEucmVzICogYi5yZXMsIGEubW9kKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gcG9seW1vZF9kaXYoYSwgYikgewogICAgaWYoIShiIGluc3RhbmNlb2YgUG9seU1vZCkpIGIgPSBQb2x5TW9kKGIsIGEubW9kKTsKICAgIHJldHVybiBwb2x5bW9kX211bChhLCBiLmludmVyc2UoKSk7CiAgfQogIGZ1bmN0aW9uIHBvbHltb2RfZXEoYSwgYikgewogICAgcmV0dXJuIGEubW9kID09IGIubW9kICYmIGEucmVzID09IGIucmVzOwogIH0KCiAgb3BlcmF0b3JzX3NldCgKICAgIFBvbHlNb2QucHJvdG90eXBlLAogICAgewogICAgICAnKyc6IHBvbHltb2RfYWRkLAogICAgICAnLSc6IHBvbHltb2Rfc3ViLAogICAgICAnKic6IHBvbHltb2RfbXVsLAogICAgICAnLyc6IHBvbHltb2RfZGl2LAogICAgICAnKionOiBnZW5lcmljX3BvdywKICAgICAgJz09JzogcG9seW1vZF9lcSwKICAgICAgcG9zKGEpIHsKICAgICAgICByZXR1cm4gYTsKICAgICAgfSwKICAgICAgbmVnKGEpIHsKICAgICAgICByZXR1cm4gUG9seU1vZCgtYS5yZXMsIGEubW9kKTsKICAgICAgfQogICAgfSwKICAgIHsKICAgICAgbGVmdDogW051bWJlciwgQmlnSW50LCBGbG9hdCwgRnJhY3Rpb24sIENvbXBsZXgsIE1vZCwgUG9seW5vbWlhbF0sCiAgICAgIHJpZ2h0OiBbTnVtYmVyLCBCaWdJbnQsIEZsb2F0LCBGcmFjdGlvbiwgQ29tcGxleCwgTW9kLCBQb2x5bm9taWFsXSwKICAgICAgJysnOiBwb2x5bW9kX2FkZCwKICAgICAgJy0nOiBwb2x5bW9kX3N1YiwKICAgICAgJyonOiBwb2x5bW9kX211bCwKICAgICAgJy8nOiBwb2x5bW9kX2RpdiwKICAgICAgJyoqJzogZ2VuZXJpY19wb3cgLyogWFhYOiBvbmx5IGZvciBpbnRlZ2VyICovCiAgICB9CiAgKTsKCiAgYWRkX3Byb3BzKFBvbHlNb2QucHJvdG90eXBlLCB7CiAgICBpbnZlcnNlKCkgewogICAgICB2YXIgYSA9IHRoaXMsCiAgICAgICAgbSA9IGEubW9kOwogICAgICBpZihtIGluc3RhbmNlb2YgUG9seW5vbWlhbCkgewogICAgICAgIHJldHVybiBQb2x5TW9kKFBvbHlub21pYWwuaW52bW9kKGEucmVzLCBtKSwgbSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgVHlwZUVycm9yKCd1bnN1cHBvcnRlZCB0eXBlJyk7CiAgICAgIH0KICAgIH0sCiAgICB0b1N0cmluZygpIHsKICAgICAgcmV0dXJuICdQb2x5TW9kKCcgKyB0aGlzLnJlcyArICcsJyArIHRoaXMubW9kICsgJyknOwogICAgfQogIH0pOwoKICAvKiBSYXRpb25hbCBmdW5jdGlvbiAqLwoKICBSYXRpb25hbEZ1bmN0aW9uID0gZnVuY3Rpb24gUmF0aW9uYWxGdW5jdGlvbihhLCBiKSB7CiAgICB2YXIgdCwgciwgZCwgb2JqOwogICAgaWYobmV3LnRhcmdldCkgdGhyb3cgVHlwZUVycm9yKCdub3QgYSBjb25zdHJ1Y3RvcicpOwogICAgaWYoIShhIGluc3RhbmNlb2YgUG9seW5vbWlhbCkgfHwgIShiIGluc3RhbmNlb2YgUG9seW5vbWlhbCkpIHRocm93IFR5cGVFcnJvcigncG9seW5vbWlhbCBleHBlY3RlZCcpOwogICAgdCA9IFBvbHlub21pYWwuZGl2cmVtKGEsIGIpOwogICAgciA9IHRbMV07CiAgICBpZihyLmRlZygpIDwgMCkgcmV0dXJuIHRbMF07IC8qIG5vIG5lZWQgZm9yIGEgZnJhY3Rpb24gKi8KICAgIGQgPSBQb2x5bm9taWFsLmdjZChiLCByKTsKICAgIGlmKGQuZGVnKCkgPiAwKSB7CiAgICAgIGEgPSBQb2x5bm9taWFsLmRpdnJlbShhLCBkKVswXTsKICAgICAgYiA9IFBvbHlub21pYWwuZGl2cmVtKGIsIGQpWzBdOwogICAgfQogICAgb2JqID0gT2JqZWN0LmNyZWF0ZShSYXRpb25hbEZ1bmN0aW9uLnByb3RvdHlwZSk7CiAgICBvYmoubnVtID0gYTsKICAgIG9iai5kZW4gPSBiOwogICAgcmV0dXJuIG9iajsKICB9OwoKICBhZGRfcHJvcHMoUmF0aW9uYWxGdW5jdGlvbi5wcm90b3R5cGUsIHsKICAgIGludmVyc2UoKSB7CiAgICAgIHJldHVybiBSYXRpb25hbEZ1bmN0aW9uKHRoaXMuZGVuLCB0aGlzLm51bSk7CiAgICB9LAogICAgY29uaigpIHsKICAgICAgcmV0dXJuIFJhdGlvbmFsRnVuY3Rpb24odGhpcy5udW0uY29uaigpLCB0aGlzLmRlbi5jb25qKCkpOwogICAgfSwKICAgIHRvU3RyaW5nKCkgewogICAgICB2YXIgc3RyOwogICAgICBpZih0aGlzLm51bS5kZWcoKSA8PSAwICYmICFudW1iZXJfbmVlZF9wYXJlbih0aGlzLm51bVswXSkpIHN0ciA9IHRoaXMubnVtLnRvU3RyaW5nKCk7CiAgICAgIGVsc2Ugc3RyID0gJygnICsgdGhpcy5udW0udG9TdHJpbmcoKSArICcpJzsKICAgICAgc3RyICs9ICcvKCcgKyB0aGlzLmRlbi50b1N0cmluZygpICsgJyknOwogICAgICByZXR1cm4gc3RyOwogICAgfSwKICAgIGFwcGx5KGIpIHsKICAgICAgcmV0dXJuIHRoaXMubnVtLmFwcGx5KGIpIC8gdGhpcy5kZW4uYXBwbHkoYik7CiAgICB9LAogICAgZGVyaXYoKSB7CiAgICAgIHZhciBuID0gdGhpcy5udW0sCiAgICAgICAgZCA9IHRoaXMuZGVuOwogICAgICByZXR1cm4gUmF0aW9uYWxGdW5jdGlvbihuLmRlcml2KCkgKiBkIC0gbiAqIGQuZGVyaXYoKSwgZCAqIGQpOwogICAgfQogIH0pOwoKICBmdW5jdGlvbiByYXRmdW5jX2FkZChhLCBiKSB7CiAgICBhID0gUmF0aW9uYWxGdW5jdGlvbi50b1JhdGlvbmFsRnVuY3Rpb24oYSk7CiAgICBiID0gUmF0aW9uYWxGdW5jdGlvbi50b1JhdGlvbmFsRnVuY3Rpb24oYik7CiAgICByZXR1cm4gUmF0aW9uYWxGdW5jdGlvbihhLm51bSAqIGIuZGVuICsgYS5kZW4gKiBiLm51bSwgYS5kZW4gKiBiLmRlbik7CiAgfQogIGZ1bmN0aW9uIHJhdGZ1bmNfc3ViKGEsIGIpIHsKICAgIGEgPSBSYXRpb25hbEZ1bmN0aW9uLnRvUmF0aW9uYWxGdW5jdGlvbihhKTsKICAgIGIgPSBSYXRpb25hbEZ1bmN0aW9uLnRvUmF0aW9uYWxGdW5jdGlvbihiKTsKICAgIHJldHVybiBSYXRpb25hbEZ1bmN0aW9uKGEubnVtICogYi5kZW4gLSBhLmRlbiAqIGIubnVtLCBhLmRlbiAqIGIuZGVuKTsKICB9CiAgZnVuY3Rpb24gcmF0ZnVuY19tdWwoYSwgYikgewogICAgYSA9IFJhdGlvbmFsRnVuY3Rpb24udG9SYXRpb25hbEZ1bmN0aW9uKGEpOwogICAgYiA9IFJhdGlvbmFsRnVuY3Rpb24udG9SYXRpb25hbEZ1bmN0aW9uKGIpOwogICAgcmV0dXJuIFJhdGlvbmFsRnVuY3Rpb24oYS5udW0gKiBiLm51bSwgYS5kZW4gKiBiLmRlbik7CiAgfQogIGZ1bmN0aW9uIHJhdGZ1bmNfZGl2KGEsIGIpIHsKICAgIGEgPSBSYXRpb25hbEZ1bmN0aW9uLnRvUmF0aW9uYWxGdW5jdGlvbihhKTsKICAgIGIgPSBSYXRpb25hbEZ1bmN0aW9uLnRvUmF0aW9uYWxGdW5jdGlvbihiKTsKICAgIHJldHVybiBSYXRpb25hbEZ1bmN0aW9uKGEubnVtICogYi5kZW4sIGEuZGVuICogYi5udW0pOwogIH0KICBmdW5jdGlvbiByYXRmdW5jX2VxKGEsIGIpIHsKICAgIGEgPSBSYXRpb25hbEZ1bmN0aW9uLnRvUmF0aW9uYWxGdW5jdGlvbihhKTsKICAgIGIgPSBSYXRpb25hbEZ1bmN0aW9uLnRvUmF0aW9uYWxGdW5jdGlvbihiKTsKICAgIC8qIHdlIGFzc3VtZSB0aGUgZnJhY3Rpb25zIGFyZSBub3JtYWxpemVkICovCiAgICByZXR1cm4gYS5udW0gPT0gYi5udW0gJiYgYS5kZW4gPT0gYi5kZW47CiAgfQoKICBvcGVyYXRvcnNfc2V0KAogICAgUmF0aW9uYWxGdW5jdGlvbi5wcm90b3R5cGUsCiAgICB7CiAgICAgICcrJzogcmF0ZnVuY19hZGQsCiAgICAgICctJzogcmF0ZnVuY19zdWIsCiAgICAgICcqJzogcmF0ZnVuY19tdWwsCiAgICAgICcvJzogcmF0ZnVuY19kaXYsCiAgICAgICcqKic6IGdlbmVyaWNfcG93LAogICAgICAnPT0nOiByYXRmdW5jX2VxLAogICAgICBwb3MoYSkgewogICAgICAgIHJldHVybiBhOwogICAgICB9LAogICAgICBuZWcoYSkgewogICAgICAgIHJldHVybiBSYXRpb25hbEZ1bmN0aW9uKC10aGlzLm51bSwgdGhpcy5kZW4pOwogICAgICB9CiAgICB9LAogICAgewogICAgICBsZWZ0OiBbTnVtYmVyLCBCaWdJbnQsIEZsb2F0LCBGcmFjdGlvbiwgQ29tcGxleCwgTW9kLCBQb2x5bm9taWFsXSwKICAgICAgcmlnaHQ6IFtOdW1iZXIsIEJpZ0ludCwgRmxvYXQsIEZyYWN0aW9uLCBDb21wbGV4LCBNb2QsIFBvbHlub21pYWxdLAogICAgICAnKyc6IHJhdGZ1bmNfYWRkLAogICAgICAnLSc6IHJhdGZ1bmNfc3ViLAogICAgICAnKic6IHJhdGZ1bmNfbXVsLAogICAgICAnLyc6IHJhdGZ1bmNfZGl2LAogICAgICAnKionOiBnZW5lcmljX3BvdyAvKiBzaG91bGQgb25seSBiZSB1c2VkIHdpdGggaW50ZWdlcnMgKi8KICAgIH0KICApOwoKICBhZGRfcHJvcHMoUmF0aW9uYWxGdW5jdGlvbiwgewogICAgLyogVGhpcyBmdW5jdGlvbiBhbHdheXMgcmV0dXJuIGEgUmF0aW9uYWxGdW5jdGlvbiBvYmplY3QgZXZlbgogICAgICAgICAgIGlmIGl0IGNvdWxkIHNpbXBsaWZpZWQgdG8gYSBwb2x5bm9taWFsLCBzbyBpdCBpcyBub3QKICAgICAgICAgICBlcXVpdmFsZW50IHRvIFJhdGlvbmFsRnVuY3Rpb24oYSkgKi8KICAgIHRvUmF0aW9uYWxGdW5jdGlvbihhKSB7CiAgICAgIHZhciBvYmo7CiAgICAgIGlmKGEgaW5zdGFuY2VvZiBSYXRpb25hbEZ1bmN0aW9uKSB7CiAgICAgICAgcmV0dXJuIGE7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgb2JqID0gT2JqZWN0LmNyZWF0ZShSYXRpb25hbEZ1bmN0aW9uLnByb3RvdHlwZSk7CiAgICAgICAgb2JqLm51bSA9IFBvbHlub21pYWwoYSk7CiAgICAgICAgb2JqLmRlbiA9IFBvbHlub21pYWwoMSk7CiAgICAgICAgcmV0dXJuIG9iajsKICAgICAgfQogICAgfQogIH0pOwoKICAvKiBQb3dlciBzZXJpZXMgKi8KCiAgLyogJ2EnIGlzIGFuIGFycmF5ICovCiAgZnVuY3Rpb24gZ2V0X2VtaW4oYSkgewogICAgdmFyIGksIG47CiAgICBuID0gYS5sZW5ndGg7CiAgICBmb3IoaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgaWYoYVtpXSAhPSAwKSByZXR1cm4gaTsKICAgIH0KICAgIHJldHVybiBuOwogIH0KCiAgZnVuY3Rpb24gc2VyaWVzX2lzX3NjYWxhcl9vcl9wb2x5bm9taWFsKGEpIHsKICAgIHJldHVybiBwb2x5bm9taWFsX2lzX3NjYWxhcihhKSB8fCBhIGluc3RhbmNlb2YgUG9seW5vbWlhbDsKICB9CgogIC8qIG4gaXMgdGhlIG1heGltdW0gbnVtYmVyIG9mIHRlcm1zIGlmICdhJyBpcyBub3QgYSBzZXJpZSAqLwogIFNlcmllcyA9IGZ1bmN0aW9uIFNlcmllcyhhLCBuKSB7CiAgICB2YXIgZW1pbiwgciwgaTsKCiAgICBpZihhIGluc3RhbmNlb2YgU2VyaWVzKSB7CiAgICAgIHJldHVybiBhOwogICAgfSBlbHNlIGlmKHNlcmllc19pc19zY2FsYXJfb3JfcG9seW5vbWlhbChhKSkgewogICAgICBpZihuIDw9IDApIHsKICAgICAgICAvKiBYWFg6IHNob3VsZCBzdGlsbCB1c2UgdGhlIHBvbHlub21pYWwgZGVncmVlICovCiAgICAgICAgcmV0dXJuIFNlcmllcy56ZXJvKDAsIDApOwogICAgICB9IGVsc2UgewogICAgICAgIGEgPSBQb2x5bm9taWFsKGEpOwogICAgICAgIGVtaW4gPSBnZXRfZW1pbihhKTsKICAgICAgICByID0gU2VyaWVzLnplcm8obiwgZW1pbik7CiAgICAgICAgbiA9IE1hdGgubWluKGEubGVuZ3RoIC0gZW1pbiwgbik7CiAgICAgICAgZm9yKGkgPSAwOyBpIDwgbjsgaSsrKSByW2ldID0gYVtpICsgZW1pbl07CiAgICAgICAgcmV0dXJuIHI7CiAgICAgIH0KICAgIH0gZWxzZSBpZihhIGluc3RhbmNlb2YgUmF0aW9uYWxGdW5jdGlvbikgewogICAgICByZXR1cm4gU2VyaWVzKGEubnVtLCBuKSAvIGEuZGVuOwogICAgfSBlbHNlIHsKICAgICAgdGhyb3cgVHlwZUVycm9yKCdpbnZhbGlkIHR5cGUnKTsKICAgIH0KICB9OwoKICBmdW5jdGlvbiBzZXJpZXNfYWRkKHYxLCB2MikgewogICAgdmFyIHRtcCwgZCwgZW1pbiwgbiwgciwgaSwgaiwgdjJfZW1pbiwgYzEsIGMyOwogICAgaWYoISh2MSBpbnN0YW5jZW9mIFNlcmllcykpIHsKICAgICAgdG1wID0gdjE7CiAgICAgIHYxID0gdjI7CiAgICAgIHYyID0gdG1wOwogICAgfQogICAgZCA9IHYxLmVtaW4gKyB2MS5sZW5ndGg7CiAgICBpZihzZXJpZXNfaXNfc2NhbGFyX29yX3BvbHlub21pYWwodjIpKSB7CiAgICAgIHYyID0gUG9seW5vbWlhbCh2Mik7CiAgICAgIGlmKGQgPD0gMCkgcmV0dXJuIHYxOwogICAgICB2Ml9lbWluID0gMDsKICAgIH0gZWxzZSBpZih2MiBpbnN0YW5jZW9mIFJhdGlvbmFsRnVuY3Rpb24pIHsKICAgICAgLyogY29tcHV0ZSB0aGUgZW1pbiBvZiB0aGUgcmF0aW9uYWwgZm9uY3Rpb24gKi8KICAgICAgaSA9IGdldF9lbWluKHYyLm51bSkgLSBnZXRfZW1pbih2Mi5kZW4pOwogICAgICBpZihkIDw9IGkpIHJldHVybiB2MTsKICAgICAgLyogY29tcHV0ZSB0aGUgc2VyaWUgd2l0aCB0aGUgcmVxdWlyZWQgdGVybXMgKi8KICAgICAgdjIgPSBTZXJpZXModjIsIGQgLSBpKTsKICAgICAgdjJfZW1pbiA9IHYyLmVtaW47CiAgICB9IGVsc2UgewogICAgICB2Ml9lbWluID0gdjIuZW1pbjsKICAgICAgZCA9IE1hdGgubWluKGQsIHYyX2VtaW4gKyB2Mi5sZW5ndGgpOwogICAgfQogICAgZW1pbiA9IE1hdGgubWluKHYxLmVtaW4sIHYyX2VtaW4pOwogICAgbiA9IGQgLSBlbWluOwogICAgciA9IFNlcmllcy56ZXJvKG4sIGVtaW4pOwogICAgLyogWFhYOiBzbG93ICovCiAgICBmb3IoaSA9IGVtaW47IGkgPCBkOyBpKyspIHsKICAgICAgaiA9IGkgLSB2MS5lbWluOwogICAgICBpZihqID49IDAgJiYgaiA8IHYxLmxlbmd0aCkgYzEgPSB2MVtqXTsKICAgICAgZWxzZSBjMSA9IDA7CiAgICAgIGogPSBpIC0gdjJfZW1pbjsKICAgICAgaWYoaiA+PSAwICYmIGogPCB2Mi5sZW5ndGgpIGMyID0gdjJbal07CiAgICAgIGVsc2UgYzIgPSAwOwogICAgICByW2kgLSBlbWluXSA9IGMxICsgYzI7CiAgICB9CiAgICByZXR1cm4gci50cmltKCk7CiAgfQogIGZ1bmN0aW9uIHNlcmllc19zdWIoYSwgYikgewogICAgcmV0dXJuIHNlcmllc19hZGQoYSwgLWIpOwogIH0KICBmdW5jdGlvbiBzZXJpZXNfbXVsKHYxLCB2MikgewogICAgdmFyIG4sIGksIGosIHIsIG4sIGVtaW4sIG4xLCBuMiwgazsKICAgIGlmKCEodjEgaW5zdGFuY2VvZiBTZXJpZXMpKSB2MSA9IFNlcmllcyh2MSwgdjIubGVuZ3RoKTsKICAgIGVsc2UgaWYoISh2MiBpbnN0YW5jZW9mIFNlcmllcykpIHYyID0gU2VyaWVzKHYyLCB2MS5sZW5ndGgpOwogICAgZW1pbiA9IHYxLmVtaW4gKyB2Mi5lbWluOwogICAgbiA9IE1hdGgubWluKHYxLmxlbmd0aCwgdjIubGVuZ3RoKTsKICAgIG4xID0gdjEubGVuZ3RoOwogICAgbjIgPSB2Mi5sZW5ndGg7CiAgICByID0gU2VyaWVzLnplcm8obiwgZW1pbik7CiAgICBmb3IoaSA9IDA7IGkgPCBuMTsgaSsrKSB7CiAgICAgIGsgPSBNYXRoLm1pbihuMiwgbiAtIGkpOwogICAgICBmb3IoaiA9IDA7IGogPCBrOyBqKyspIHsKICAgICAgICByW2kgKyBqXSArPSB2MVtpXSAqIHYyW2pdOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gci50cmltKCk7CiAgfQogIGZ1bmN0aW9uIHNlcmllc19kaXYodjEsIHYyKSB7CiAgICBpZighKHYyIGluc3RhbmNlb2YgU2VyaWVzKSkgdjIgPSBTZXJpZXModjIsIHYxLmxlbmd0aCk7CiAgICByZXR1cm4gc2VyaWVzX211bCh2MSwgdjIuaW52ZXJzZSgpKTsKICB9CiAgZnVuY3Rpb24gc2VyaWVzX3BvdyhhLCBiKSB7CiAgICBpZihJbnRlZ2VyLmlzSW50ZWdlcihiKSkgewogICAgICByZXR1cm4gZ2VuZXJpY19wb3coYSwgYik7CiAgICB9IGVsc2UgewogICAgICBpZighKGEgaW5zdGFuY2VvZiBTZXJpZXMpKSBhID0gU2VyaWVzKGEsIGIubGVuZ3RoKTsKICAgICAgcmV0dXJuIGV4cChsb2coYSkgKiBiKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gc2VyaWVzX2VxKGEsIGIpIHsKICAgIHZhciBuLCBpOwogICAgaWYoYS5lbWluICE9IGIuZW1pbikgcmV0dXJuIGZhbHNlOwogICAgbiA9IGEubGVuZ3RoOwogICAgaWYobiAhPSBiLmxlbmd0aCkgcmV0dXJuIGZhbHNlOwogICAgZm9yKGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgIGlmKGFbaV0gIT0gYltpXSkgcmV0dXJuIGZhbHNlOwogICAgfQogICAgcmV0dXJuIHRydWU7CiAgfQoKICBvcGVyYXRvcnNfc2V0KAogICAgU2VyaWVzLnByb3RvdHlwZSwKICAgIHsKICAgICAgJysnOiBzZXJpZXNfYWRkLAogICAgICAnLSc6IHNlcmllc19zdWIsCiAgICAgICcqJzogc2VyaWVzX211bCwKICAgICAgJy8nOiBzZXJpZXNfZGl2LAogICAgICAnKionOiBzZXJpZXNfcG93LAogICAgICAnPT0nOiBzZXJpZXNfZXEsCiAgICAgIHBvcyhhKSB7CiAgICAgICAgcmV0dXJuIGE7CiAgICAgIH0sCiAgICAgIG5lZyhhKSB7CiAgICAgICAgdmFyIG9iaiwgbiwgaTsKICAgICAgICBuID0gYS5sZW5ndGg7CiAgICAgICAgb2JqID0gU2VyaWVzLnplcm8oYS5sZW5ndGgsIGEuZW1pbik7CiAgICAgICAgZm9yKGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgICBvYmpbaV0gPSAtYVtpXTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG9iajsKICAgICAgfQogICAgfSwKICAgIHsKICAgICAgbGVmdDogW051bWJlciwgQmlnSW50LCBGbG9hdCwgRnJhY3Rpb24sIENvbXBsZXgsIE1vZCwgUG9seW5vbWlhbF0sCiAgICAgIHJpZ2h0OiBbTnVtYmVyLCBCaWdJbnQsIEZsb2F0LCBGcmFjdGlvbiwgQ29tcGxleCwgTW9kLCBQb2x5bm9taWFsXSwKICAgICAgJysnOiBzZXJpZXNfYWRkLAogICAgICAnLSc6IHNlcmllc19zdWIsCiAgICAgICcqJzogc2VyaWVzX211bCwKICAgICAgJy8nOiBzZXJpZXNfZGl2LAogICAgICAnKionOiBzZXJpZXNfcG93CiAgICB9CiAgKTsKCiAgYWRkX3Byb3BzKFNlcmllcy5wcm90b3R5cGUsIHsKICAgIGNvbmooKSB7CiAgICAgIHZhciBvYmosIG4sIGk7CiAgICAgIG4gPSB0aGlzLmxlbmd0aDsKICAgICAgb2JqID0gU2VyaWVzLnplcm8odGhpcy5sZW5ndGgsIHRoaXMuZW1pbik7CiAgICAgIGZvcihpID0gMDsgaSA8IG47IGkrKykgewogICAgICAgIG9ialtpXSA9IHRoaXNbaV0uY29uaigpOwogICAgICB9CiAgICAgIHJldHVybiBvYmo7CiAgICB9LAogICAgaW52ZXJzZSgpIHsKICAgICAgdmFyIHIsCiAgICAgICAgbiwKICAgICAgICBpLAogICAgICAgIGosCiAgICAgICAgc3VtLAogICAgICAgIHYxID0gdGhpczsKICAgICAgbiA9IHYxLmxlbmd0aDsKICAgICAgaWYobiA9PSAwKSB0aHJvdyBSYW5nZUVycm9yKCdkaXZpc2lvbiBieSB6ZXJvJyk7CiAgICAgIHIgPSBTZXJpZXMuemVybyhuLCAtdjEuZW1pbik7CiAgICAgIHJbMF0gPSAxIC8gdjFbMF07CiAgICAgIGZvcihpID0gMTsgaSA8IG47IGkrKykgewogICAgICAgIHN1bSA9IDA7CiAgICAgICAgZm9yKGogPSAxOyBqIDw9IGk7IGorKykgewogICAgICAgICAgc3VtICs9IHYxW2pdICogcltpIC0gal07CiAgICAgICAgfQogICAgICAgIHJbaV0gPSAtc3VtICogclswXTsKICAgICAgfQogICAgICByZXR1cm4gcjsKICAgIH0sCiAgICAvKiByZW1vdmUgbGVhZGluZyB6ZXJvIHRlcm1zICovCiAgICB0cmltKCkgewogICAgICB2YXIgaSwKICAgICAgICBqLAogICAgICAgIG4sCiAgICAgICAgciwKICAgICAgICB2MSA9IHRoaXM7CiAgICAgIG4gPSB2MS5sZW5ndGg7CiAgICAgIGkgPSAwOwogICAgICB3aGlsZShpIDwgbiAmJiB2MVtpXSA9PSAwKSBpKys7CiAgICAgIGlmKGkgPT0gMCkgcmV0dXJuIHYxOwogICAgICBmb3IoaiA9IGk7IGogPCBuOyBqKyspIHYxW2ogLSBpXSA9IHYxW2pdOwogICAgICB2MS5sZW5ndGggPSBuIC0gaTsKICAgICAgdjEuX19wcm90b19fLmVtaW4gKz0gaTsKICAgICAgcmV0dXJuIHYxOwogICAgfSwKICAgIHRvU3RyaW5nKCkgewogICAgICB2YXIgaSwKICAgICAgICBqLAogICAgICAgIHN0ciwKICAgICAgICBzdHIxLAogICAgICAgIGMsCiAgICAgICAgYSA9IHRoaXMsCiAgICAgICAgZW1pbiwKICAgICAgICBuOwogICAgICBzdHIgPSAnJzsKICAgICAgZW1pbiA9IHRoaXMuZW1pbjsKICAgICAgbiA9IHRoaXMubGVuZ3RoOwogICAgICBmb3IoaiA9IDA7IGogPCBuOyBqKyspIHsKICAgICAgICBpID0gaiArIGVtaW47CiAgICAgICAgYyA9IGFbal07CiAgICAgICAgaWYoYyAhPSAwKSB7CiAgICAgICAgICBzdHIxID0gbW9ub21pYWxfdG9TdHJpbmcoYywgaSk7CiAgICAgICAgICBpZihzdHIxWzBdICE9ICctJykgewogICAgICAgICAgICBpZihzdHIgIT0gJycpIHN0ciArPSAnKyc7CiAgICAgICAgICB9CiAgICAgICAgICBzdHIgKz0gc3RyMTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYoc3RyICE9ICcnKSBzdHIgKz0gJysnOwogICAgICBzdHIgKz0gJ08oJyArIG1vbm9taWFsX3RvU3RyaW5nKDEsIG4gKyBlbWluKSArICcpJzsKICAgICAgcmV0dXJuIHN0cjsKICAgIH0sCiAgICBhcHBseShiKSB7CiAgICAgIHZhciBpLAogICAgICAgIG4sCiAgICAgICAgciwKICAgICAgICBhID0gdGhpczsKICAgICAgbiA9IGEubGVuZ3RoOwogICAgICBpZihuID09IDApIHJldHVybiAwOwogICAgICByID0gYVstLW5dOwogICAgICB3aGlsZShuID4gMCkgewogICAgICAgIG4tLTsKICAgICAgICByID0gciAqIGIgKyBhW25dOwogICAgICB9CiAgICAgIGlmKGEuZW1pbiAhPSAwKSByICo9IGIgXiBhLmVtaW47CiAgICAgIHJldHVybiByOwogICAgfSwKICAgIGRlcml2KCkgewogICAgICB2YXIgYSA9IHRoaXMsCiAgICAgICAgbiA9IGEubGVuZ3RoLAogICAgICAgIGVtaW4gPSBhLmVtaW4sCiAgICAgICAgciwKICAgICAgICBpLAogICAgICAgIGo7CiAgICAgIGlmKG4gPT0gMCAmJiBlbWluID09IDApIHsKICAgICAgICByZXR1cm4gU2VyaWVzLnplcm8oMCwgMCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgciA9IFNlcmllcy56ZXJvKG4sIGVtaW4gLSAxKTsKICAgICAgICBmb3IoaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICAgIGogPSBlbWluICsgaTsKICAgICAgICAgIGlmKGogPT0gMCkgcltpXSA9IDA7CiAgICAgICAgICBlbHNlIHJbaV0gPSBqICogYVtpXTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHIudHJpbSgpOwogICAgICB9CiAgICB9LAogICAgaW50ZWcoKSB7CiAgICAgIHZhciBhID0gdGhpcywKICAgICAgICBuID0gYS5sZW5ndGgsCiAgICAgICAgZW1pbiA9IGEuZW1pbiwKICAgICAgICBpLAogICAgICAgIGosCiAgICAgICAgcjsKICAgICAgciA9IFNlcmllcy56ZXJvKG4sIGVtaW4gKyAxKTsKICAgICAgZm9yKGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgaiA9IGVtaW4gKyBpOwogICAgICAgIGlmKGogPT0gLTEpIHsKICAgICAgICAgIGlmKGFbaV0gIT0gMCkgdGhyb3cgUmFuZ2VFcnJvcignY2Fubm90IHJlcHJlc2VudCBpbnRlZygxL1gpJyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJbaV0gPSBhW2ldIC8gKGogKyAxKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHIudHJpbSgpOwogICAgfSwKICAgIGV4cCgpIHsKICAgICAgdmFyIGMsCiAgICAgICAgaSwKICAgICAgICByLAogICAgICAgIG4sCiAgICAgICAgYSA9IHRoaXM7CiAgICAgIGlmKGEuZW1pbiA8IDApIHRocm93IFJhbmdlRXJyb3IoJ25lZ2F0aXZlIGV4cG9uZW50IGluIGV4cCcpOwogICAgICBuID0gYS5lbWluICsgYS5sZW5ndGg7CiAgICAgIGlmKGEuZW1pbiA+IDAgfHwgYVswXSA9PSAwKSB7CiAgICAgICAgYyA9IDE7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYyA9IGdsb2JhbC5leHAoYVswXSk7CiAgICAgICAgYSAtPSBhWzBdOwogICAgICB9CiAgICAgIHIgPSBTZXJpZXMuemVybyhuLCAwKTsKICAgICAgZm9yKGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgcltpXSA9IGMgLyBmYWN0KGkpOwogICAgICB9CiAgICAgIHJldHVybiByLmFwcGx5KGEpOwogICAgfSwKICAgIGxvZygpIHsKICAgICAgdmFyIGEgPSB0aGlzLAogICAgICAgIHI7CiAgICAgIGlmKGEuZW1pbiAhPSAwKSB0aHJvdyBSYW5nZUVycm9yKCdsb2cgYXJndW1lbnQgbXVzdCBoYXZlIGEgbm9uIHplcm8gY29uc3RhbnQgdGVybScpOwogICAgICByID0gaW50ZWcoZGVyaXYoYSkgLyBhKTsKICAgICAgLyogYWRkIHRoZSBjb25zdGFudCB0ZXJtICovCiAgICAgIHIgKz0gZ2xvYmFsLmxvZyhhWzBdKTsKICAgICAgcmV0dXJuIHI7CiAgICB9CiAgfSk7CgogIGFkZF9wcm9wcyhTZXJpZXMsIHsKICAgIC8qIG5ldyBzZXJpZXMgb2YgbGVuZ3RoIG4gYW5kIGZpcnN0IGV4cG9uZW50IGVtaW4gKi8KICAgIHplcm8obiwgZW1pbikgewogICAgICB2YXIgciwgaSwgb2JqOwoKICAgICAgciA9IFtdOwogICAgICBmb3IoaSA9IDA7IGkgPCBuOyBpKyspIHJbaV0gPSAwOwogICAgICAvKiB3ZSByZXR1cm4gYW4gYXJyYXkgYW5kIHN0b3JlIGVtaW4gaW4gaXRzIHByb3RvdHlwZSAqLwogICAgICBvYmogPSBPYmplY3QuY3JlYXRlKFNlcmllcy5wcm90b3R5cGUpOwogICAgICBvYmouZW1pbiA9IGVtaW47CiAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihyLCBvYmopOwogICAgICByZXR1cm4gcjsKICAgIH0sCiAgICBPKGEpIHsKICAgICAgZnVuY3Rpb24gRXJyb3JPKCkgewogICAgICAgIHJldHVybiBUeXBlRXJyb3IoJ2ludmFsaWQgTygpIGFyZ3VtZW50Jyk7CiAgICAgIH0KICAgICAgdmFyIG47CiAgICAgIGlmKHNlcmllc19pc19zY2FsYXJfb3JfcG9seW5vbWlhbChhKSkgewogICAgICAgIGEgPSBQb2x5bm9taWFsKGEpOwogICAgICAgIG4gPSBhLmRlZygpOwogICAgICAgIGlmKG4gPCAwKSB0aHJvdyBFcnJvck8oKTsKICAgICAgfSBlbHNlIGlmKGEgaW5zdGFuY2VvZiBSYXRpb25hbEZ1bmN0aW9uKSB7CiAgICAgICAgaWYoYS5udW0uZGVnKCkgIT0gMCkgdGhyb3cgRXJyb3JPKCk7CiAgICAgICAgbiA9IGEuZGVuLmRlZygpOwogICAgICAgIGlmKG4gPCAwKSB0aHJvdyBFcnJvck8oKTsKICAgICAgICBuID0gLW47CiAgICAgIH0gZWxzZSB0aHJvdyBFcnJvck8oKTsKICAgICAgcmV0dXJuIFNlcmllcy56ZXJvKDAsIG4pOwogICAgfQogIH0pOwoKICAvKiBBcnJheSAoTWF0cml4KSAqLwoKICBNYXRyaXggPSBmdW5jdGlvbiBNYXRyaXgoaCwgdykgewogICAgdmFyIGksIGosIHIsIHJsOwogICAgaWYodHlwZW9mIHcgPT09ICd1bmRlZmluZWQnKSB3ID0gaDsKICAgIHIgPSBbXTsKICAgIGZvcihpID0gMDsgaSA8IGg7IGkrKykgewogICAgICBybCA9IFtdOwogICAgICBmb3IoaiA9IDA7IGogPCB3OyBqKyspIHJsW2pdID0gMDsKICAgICAgcltpXSA9IHJsOwogICAgfQogICAgcmV0dXJuIHI7CiAgfTsKCiAgYWRkX3Byb3BzKE1hdHJpeCwgewogICAgaWRuKG4pIHsKICAgICAgdmFyIHIsIGk7CiAgICAgIHIgPSBNYXRyaXgobiwgbik7CiAgICAgIGZvcihpID0gMDsgaSA8IG47IGkrKykgcltpXVtpXSA9IDE7CiAgICAgIHJldHVybiByOwogICAgfSwKICAgIGRpYWcoYSkgewogICAgICB2YXIgciwgaSwgbjsKICAgICAgbiA9IGEubGVuZ3RoOwogICAgICByID0gTWF0cml4KG4sIG4pOwogICAgICBmb3IoaSA9IDA7IGkgPCBuOyBpKyspIHJbaV1baV0gPSBhW2ldOwogICAgICByZXR1cm4gcjsKICAgIH0sCiAgICBoaWxiZXJ0KG4pIHsKICAgICAgdmFyIGksIGosIHI7CiAgICAgIHIgPSBNYXRyaXgobik7CiAgICAgIGZvcihpID0gMDsgaSA8IG47IGkrKykgewogICAgICAgIGZvcihqID0gMDsgaiA8IG47IGorKykgewogICAgICAgICAgcltpXVtqXSA9IDEgLyAoMSArIGkgKyBqKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHI7CiAgICB9LAogICAgdHJhbnMoYSkgewogICAgICB2YXIgaCwgdywgciwgaSwgajsKICAgICAgaWYoIUFycmF5LmlzQXJyYXkoYSkpIHRocm93IFR5cGVFcnJvcignbWF0cml4IGV4cGVjdGVkJyk7CiAgICAgIGggPSBhLmxlbmd0aDsKICAgICAgaWYoIUFycmF5LmlzQXJyYXkoYVswXSkpIHsKICAgICAgICB3ID0gMTsKICAgICAgICByID0gTWF0cml4KHcsIGgpOwogICAgICAgIGZvcihpID0gMDsgaSA8IGg7IGkrKykgewogICAgICAgICAgclswXVtpXSA9IGFbaV07CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHcgPSBhWzBdLmxlbmd0aDsKICAgICAgICByID0gTWF0cml4KHcsIGgpOwogICAgICAgIGZvcihpID0gMDsgaSA8IGg7IGkrKykgewogICAgICAgICAgZm9yKGogPSAwOyBqIDwgdzsgaisrKSB7CiAgICAgICAgICAgIHJbal1baV0gPSBhW2ldW2pdOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcjsKICAgIH0sCiAgICBjaGVja19zcXVhcmUoYSkgewogICAgICB2YXIgYSwgbjsKICAgICAgaWYoIUFycmF5LmlzQXJyYXkoYSkpIHRocm93IFR5cGVFcnJvcignYXJyYXkgZXhwZWN0ZWQnKTsKICAgICAgbiA9IGEubGVuZ3RoOwogICAgICBpZighQXJyYXkuaXNBcnJheShhWzBdKSB8fCBuICE9IGFbMF0ubGVuZ3RoKSB0aHJvdyBUeXBlRXJyb3IoJ3NxdWFyZSBtYXRyaXggZXhwZWN0ZWQnKTsKICAgICAgcmV0dXJuIG47CiAgICB9LAogICAgdHJhY2UoYSkgewogICAgICB2YXIgbiwgciwgaTsKICAgICAgbiA9IE1hdHJpeC5jaGVja19zcXVhcmUoYSk7CiAgICAgIHIgPSBhWzBdWzBdOwogICAgICBmb3IoaSA9IDE7IGkgPCBuOyBpKyspIHsKICAgICAgICByICs9IGFbaV1baV07CiAgICAgIH0KICAgICAgcmV0dXJuIHI7CiAgICB9LAogICAgY2hhcnBvbHkoYSkgewogICAgICB2YXIgbiwgcCwgYywgaSwgaiwgY29lZjsKICAgICAgbiA9IE1hdHJpeC5jaGVja19zcXVhcmUoYSk7CiAgICAgIHAgPSBbXTsKICAgICAgZm9yKGkgPSAwOyBpIDwgbiArIDE7IGkrKykgcFtpXSA9IDA7CiAgICAgIHBbbl0gPSAxOwogICAgICBjID0gTWF0cml4LmlkbihuKTsKICAgICAgZm9yKGkgPSAwOyBpIDwgbjsgaSsrKSB7CiAgICAgICAgYyA9IGMgKiBhOwogICAgICAgIGNvZWYgPSAtdHJhY2UoYykgLyAoaSArIDEpOwogICAgICAgIHBbbiAtIGkgLSAxXSA9IGNvZWY7CiAgICAgICAgZm9yKGogPSAwOyBqIDwgbjsgaisrKSBjW2pdW2pdICs9IGNvZWY7CiAgICAgIH0KICAgICAgcmV0dXJuIFBvbHlub21pYWwocCk7CiAgICB9LAogICAgZWlnZW52YWxzKGEpIHsKICAgICAgcmV0dXJuIFBvbHlub21pYWwucm9vdHMoTWF0cml4LmNoYXJwb2x5KGEpKTsKICAgIH0sCiAgICBkZXQoYSkgewogICAgICB2YXIgbiwgaSwgaiwgaywgcywgc3JjLCB2LCBjOwoKICAgICAgbiA9IE1hdHJpeC5jaGVja19zcXVhcmUoYSk7CiAgICAgIHMgPSAxOwogICAgICBzcmMgPSBhLmR1cCgpOwogICAgICBmb3IoaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICBmb3IoaiA9IGk7IGogPCBuOyBqKyspIHsKICAgICAgICAgIGlmKHNyY1tqXVtpXSAhPSAwKSBicmVhazsKICAgICAgICB9CiAgICAgICAgaWYoaiA9PSBuKSByZXR1cm4gMDsKICAgICAgICBpZihqICE9IGkpIHsKICAgICAgICAgIGZvcihrID0gMDsgayA8IG47IGsrKykgewogICAgICAgICAgICB2ID0gc3JjW2pdW2tdOwogICAgICAgICAgICBzcmNbal1ba10gPSBzcmNbaV1ba107CiAgICAgICAgICAgIHNyY1tpXVtrXSA9IHY7CiAgICAgICAgICB9CiAgICAgICAgICBzID0gLXM7CiAgICAgICAgfQogICAgICAgIGMgPSBzcmNbaV1baV0uaW52ZXJzZSgpOwogICAgICAgIGZvcihqID0gaSArIDE7IGogPCBuOyBqKyspIHsKICAgICAgICAgIHYgPSBjICogc3JjW2pdW2ldOwogICAgICAgICAgZm9yKGsgPSAwOyBrIDwgbjsgaysrKSB7CiAgICAgICAgICAgIHNyY1tqXVtrXSAtPSBzcmNbaV1ba10gKiB2OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICBjID0gczsKICAgICAgZm9yKGkgPSAwOyBpIDwgbjsgaSsrKSBjICo9IHNyY1tpXVtpXTsKICAgICAgcmV0dXJuIGM7CiAgICB9LAogICAgaW52ZXJzZShhKSB7CiAgICAgIHZhciBuLCBkc3QsIHNyYywgaSwgaiwgaywgbjIsIHIsIGMsIHY7CiAgICAgIG4gPSBNYXRyaXguY2hlY2tfc3F1YXJlKGEpOwogICAgICBzcmMgPSBhLmR1cCgpOwogICAgICBkc3QgPSBNYXRyaXguaWRuKG4pOwogICAgICBmb3IoaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICBmb3IoaiA9IGk7IGogPCBuOyBqKyspIHsKICAgICAgICAgIGlmKHNyY1tqXVtpXSAhPSAwKSBicmVhazsKICAgICAgICB9CiAgICAgICAgaWYoaiA9PSBuKSB0aHJvdyBSYW5nZUVycm9yKCdtYXRyaXggaXMgbm90IGludmVydGlibGUnKTsKICAgICAgICBpZihqICE9IGkpIHsKICAgICAgICAgIC8qIHN3YXAgbGluZXMgaW4gc3JjIGFuZCBkc3QgKi8KICAgICAgICAgIHYgPSBzcmNbal07CiAgICAgICAgICBzcmNbal0gPSBzcmNbaV07CiAgICAgICAgICBzcmNbaV0gPSB2OwogICAgICAgICAgdiA9IGRzdFtqXTsKICAgICAgICAgIGRzdFtqXSA9IGRzdFtpXTsKICAgICAgICAgIGRzdFtpXSA9IHY7CiAgICAgICAgfQoKICAgICAgICBjID0gc3JjW2ldW2ldLmludmVyc2UoKTsKICAgICAgICBmb3IoayA9IDA7IGsgPCBuOyBrKyspIHsKICAgICAgICAgIHNyY1tpXVtrXSAqPSBjOwogICAgICAgICAgZHN0W2ldW2tdICo9IGM7CiAgICAgICAgfQoKICAgICAgICBmb3IoaiA9IDA7IGogPCBuOyBqKyspIHsKICAgICAgICAgIGlmKGogIT0gaSkgewogICAgICAgICAgICBjID0gc3JjW2pdW2ldOwogICAgICAgICAgICBmb3IoayA9IGk7IGsgPCBuOyBrKyspIHsKICAgICAgICAgICAgICBzcmNbal1ba10gLT0gc3JjW2ldW2tdICogYzsKICAgICAgICAgICAgfQogICAgICAgICAgICBmb3IoayA9IDA7IGsgPCBuOyBrKyspIHsKICAgICAgICAgICAgICBkc3Rbal1ba10gLT0gZHN0W2ldW2tdICogYzsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gZHN0OwogICAgfSwKICAgIHJhbmsoYSkgewogICAgICB2YXIgc3JjLCBpLCBqLCBrLCB3LCBoLCBsLCBjOwoKICAgICAgaWYoIUFycmF5LmlzQXJyYXkoYSkgfHwgIUFycmF5LmlzQXJyYXkoYVswXSkpIHRocm93IFR5cGVFcnJvcignbWF0cml4IGV4cGVjdGVkJyk7CiAgICAgIGggPSBhLmxlbmd0aDsKICAgICAgdyA9IGFbMF0ubGVuZ3RoOwogICAgICBzcmMgPSBhLmR1cCgpOwogICAgICBsID0gMDsKICAgICAgZm9yKGkgPSAwOyBpIDwgdzsgaSsrKSB7CiAgICAgICAgZm9yKGogPSBsOyBqIDwgaDsgaisrKSB7CiAgICAgICAgICBpZihzcmNbal1baV0gIT0gMCkgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGlmKGogPT0gaCkgY29udGludWU7CiAgICAgICAgaWYoaiAhPSBsKSB7CiAgICAgICAgICAvKiBzd2FwIGxpbmVzICovCiAgICAgICAgICBmb3IoayA9IDA7IGsgPCB3OyBrKyspIHsKICAgICAgICAgICAgdiA9IHNyY1tqXVtrXTsKICAgICAgICAgICAgc3JjW2pdW2tdID0gc3JjW2xdW2tdOwogICAgICAgICAgICBzcmNbbF1ba10gPSB2OwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgYyA9IHNyY1tsXVtpXS5pbnZlcnNlKCk7CiAgICAgICAgZm9yKGsgPSAwOyBrIDwgdzsgaysrKSB7CiAgICAgICAgICBzcmNbbF1ba10gKj0gYzsKICAgICAgICB9CgogICAgICAgIGZvcihqID0gbCArIDE7IGogPCBoOyBqKyspIHsKICAgICAgICAgIGMgPSBzcmNbal1baV07CiAgICAgICAgICBmb3IoayA9IGk7IGsgPCB3OyBrKyspIHsKICAgICAgICAgICAgc3JjW2pdW2tdIC09IHNyY1tsXVtrXSAqIGM7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGwrKzsKICAgICAgfQogICAgICByZXR1cm4gbDsKICAgIH0sCiAgICBrZXIoYSkgewogICAgICB2YXIgc3JjLCBpLCBqLCBrLCB3LCBoLCBsLCBtLCByLCBpbV9jb2xzLCBrZXJfZGltLCBjOwoKICAgICAgaWYoIUFycmF5LmlzQXJyYXkoYSkgfHwgIUFycmF5LmlzQXJyYXkoYVswXSkpIHRocm93IFR5cGVFcnJvcignbWF0cml4IGV4cGVjdGVkJyk7CiAgICAgIGggPSBhLmxlbmd0aDsKICAgICAgdyA9IGFbMF0ubGVuZ3RoOwogICAgICBzcmMgPSBhLmR1cCgpOwogICAgICBpbV9jb2xzID0gW107CiAgICAgIGwgPSAwOwogICAgICBmb3IoaSA9IDA7IGkgPCB3OyBpKyspIHsKICAgICAgICBpbV9jb2xzW2ldID0gZmFsc2U7CiAgICAgICAgZm9yKGogPSBsOyBqIDwgaDsgaisrKSB7CiAgICAgICAgICBpZihzcmNbal1baV0gIT0gMCkgYnJlYWs7CiAgICAgICAgfQogICAgICAgIGlmKGogPT0gaCkgY29udGludWU7CiAgICAgICAgaW1fY29sc1tpXSA9IHRydWU7CiAgICAgICAgaWYoaiAhPSBsKSB7CiAgICAgICAgICAvKiBzd2FwIGxpbmVzICovCiAgICAgICAgICBmb3IoayA9IDA7IGsgPCB3OyBrKyspIHsKICAgICAgICAgICAgdiA9IHNyY1tqXVtrXTsKICAgICAgICAgICAgc3JjW2pdW2tdID0gc3JjW2xdW2tdOwogICAgICAgICAgICBzcmNbbF1ba10gPSB2OwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgYyA9IHNyY1tsXVtpXS5pbnZlcnNlKCk7CiAgICAgICAgZm9yKGsgPSAwOyBrIDwgdzsgaysrKSB7CiAgICAgICAgICBzcmNbbF1ba10gKj0gYzsKICAgICAgICB9CgogICAgICAgIGZvcihqID0gMDsgaiA8IGg7IGorKykgewogICAgICAgICAgaWYoaiAhPSBsKSB7CiAgICAgICAgICAgIGMgPSBzcmNbal1baV07CiAgICAgICAgICAgIGZvcihrID0gaTsgayA8IHc7IGsrKykgewogICAgICAgICAgICAgIHNyY1tqXVtrXSAtPSBzcmNbbF1ba10gKiBjOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGwrKzsKICAgICAgICAvLyAgICAgICAgbG9nX3N0cigibT0iICsgY3ZhbF90b1N0cmluZyh2MSkgKyAiXG4iKTsKICAgICAgfQogICAgICAvLyAgICBsb2dfc3RyKCJpbSBjb2xzPSIraW1fY29scysiXG4iKTsKCiAgICAgIC8qIGJ1aWxkIHRoZSBrZXJuZWwgdmVjdG9ycyAqLwogICAgICBrZXJfZGltID0gdyAtIGw7CiAgICAgIHIgPSBNYXRyaXgodywga2VyX2RpbSk7CiAgICAgIGsgPSAwOwogICAgICBmb3IoaSA9IDA7IGkgPCB3OyBpKyspIHsKICAgICAgICBpZighaW1fY29sc1tpXSkgewogICAgICAgICAgLyogc2VsZWN0IHRoaXMgY29sdW1uIGZyb20gdGhlIG1hdHJpeCAqLwogICAgICAgICAgbCA9IDA7CiAgICAgICAgICBtID0gMDsKICAgICAgICAgIGZvcihqID0gMDsgaiA8IHc7IGorKykgewogICAgICAgICAgICBpZihpbV9jb2xzW2pdKSB7CiAgICAgICAgICAgICAgcltqXVtrXSA9IC1zcmNbbV1baV07CiAgICAgICAgICAgICAgbSsrOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGlmKGwgPT0gaykgewogICAgICAgICAgICAgICAgcltqXVtrXSA9IDE7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJbal1ba10gPSAwOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBsKys7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGsrKzsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHI7CiAgICB9LAogICAgZHAoYSwgYikgewogICAgICB2YXIgaSwgbiwgcjsKICAgICAgbiA9IGEubGVuZ3RoOwogICAgICBpZihuICE9IGIubGVuZ3RoKSB0aHJvdyBUeXBlRXJyb3IoJ2luY29tcGF0aWJsZSBhcnJheSBsZW5ndGgnKTsKICAgICAgLyogWFhYOiBjb3VsZCBkbyBjb21wbGV4IHByb2R1Y3QgKi8KICAgICAgciA9IDA7CiAgICAgIGZvcihpID0gMDsgaSA8IG47IGkrKykgewogICAgICAgIHIgKz0gYVtpXSAqIGJbaV07CiAgICAgIH0KICAgICAgcmV0dXJuIHI7CiAgICB9LAogICAgLyogY3Jvc3MgcHJvZHVjdCAqLwogICAgY3AodjEsIHYyKSB7CiAgICAgIHZhciByOwogICAgICBpZih2MS5sZW5ndGggIT0gMyB8fCB2Mi5sZW5ndGggIT0gMykgdGhyb3cgVHlwZUVycm9yKCd2ZWN0b3JzIG11c3QgaGF2ZSAzIGVsZW1lbnRzJyk7CiAgICAgIHIgPSBbXTsKICAgICAgclswXSA9IHYxWzFdICogdjJbMl0gLSB2MVsyXSAqIHYyWzFdOwogICAgICByWzFdID0gdjFbMl0gKiB2MlswXSAtIHYxWzBdICogdjJbMl07CiAgICAgIHJbMl0gPSB2MVswXSAqIHYyWzFdIC0gdjFbMV0gKiB2MlswXTsKICAgICAgcmV0dXJuIHI7CiAgICB9CiAgfSk7CgogIGZ1bmN0aW9uIGFycmF5X2FkZChhLCBiKSB7CiAgICB2YXIgciwgaSwgbjsKICAgIG4gPSBhLmxlbmd0aDsKICAgIGlmKG4gIT0gYi5sZW5ndGgpIHRocm93IFR5cGVFcnJvcignaW5jb21wYXRpYmxlIGFycmF5IHNpemUnKTsKICAgIHIgPSBbXTsKICAgIGZvcihpID0gMDsgaSA8IG47IGkrKykgcltpXSA9IGFbaV0gKyBiW2ldOwogICAgcmV0dXJuIHI7CiAgfQogIGZ1bmN0aW9uIGFycmF5X3N1YihhLCBiKSB7CiAgICB2YXIgciwgaSwgbjsKICAgIG4gPSBhLmxlbmd0aDsKICAgIGlmKG4gIT0gYi5sZW5ndGgpIHRocm93IFR5cGVFcnJvcignaW5jb21wYXRpYmxlIGFycmF5IHNpemUnKTsKICAgIHIgPSBbXTsKICAgIGZvcihpID0gMDsgaSA8IG47IGkrKykgcltpXSA9IGFbaV0gLSBiW2ldOwogICAgcmV0dXJuIHI7CiAgfQogIGZ1bmN0aW9uIGFycmF5X3NjYWxhcl9tdWwoYSwgYikgewogICAgdmFyIHIsIGksIG47CiAgICBuID0gYS5sZW5ndGg7CiAgICByID0gW107CiAgICBmb3IoaSA9IDA7IGkgPCBuOyBpKyspIHJbaV0gPSBhW2ldICogYjsKICAgIHJldHVybiByOwogIH0KICBmdW5jdGlvbiBhcnJheV9tdWwoYSwgYikgewogICAgdmFyIGgsIHcsIGwsIGksIGosIGssIHIsIHJsLCBzdW0sIGFfbWF0LCBiX21hdDsKICAgIGggPSBhLmxlbmd0aDsKICAgIGFfbWF0ID0gQXJyYXkuaXNBcnJheShhWzBdKTsKICAgIGlmKGFfbWF0KSB7CiAgICAgIGwgPSBhWzBdLmxlbmd0aDsKICAgIH0gZWxzZSB7CiAgICAgIGwgPSAxOwogICAgfQogICAgaWYobCAhPSBiLmxlbmd0aCkgdGhyb3cgUmFuZ2VFcnJvcignaW5jb21wYXRpYmxlIG1hdHJpeCBzaXplJyk7CiAgICBiX21hdCA9IEFycmF5LmlzQXJyYXkoYlswXSk7CiAgICBpZihiX21hdCkgdyA9IGJbMF0ubGVuZ3RoOwogICAgZWxzZSB3ID0gMTsKICAgIHIgPSBbXTsKICAgIGlmKGFfbWF0ICYmIGJfbWF0KSB7CiAgICAgIGZvcihpID0gMDsgaSA8IGg7IGkrKykgewogICAgICAgIHJsID0gW107CiAgICAgICAgZm9yKGogPSAwOyBqIDwgdzsgaisrKSB7CiAgICAgICAgICBzdW0gPSAwOwogICAgICAgICAgZm9yKGsgPSAwOyBrIDwgbDsgaysrKSB7CiAgICAgICAgICAgIHN1bSArPSBhW2ldW2tdICogYltrXVtqXTsKICAgICAgICAgIH0KICAgICAgICAgIHJsW2pdID0gc3VtOwogICAgICAgIH0KICAgICAgICByW2ldID0gcmw7CiAgICAgIH0KICAgIH0gZWxzZSBpZihhX21hdCAmJiAhYl9tYXQpIHsKICAgICAgZm9yKGkgPSAwOyBpIDwgaDsgaSsrKSB7CiAgICAgICAgc3VtID0gMDsKICAgICAgICBmb3IoayA9IDA7IGsgPCBsOyBrKyspIHsKICAgICAgICAgIHN1bSArPSBhW2ldW2tdICogYltrXTsKICAgICAgICB9CiAgICAgICAgcltpXSA9IHN1bTsKICAgICAgfQogICAgfSBlbHNlIGlmKCFhX21hdCAmJiBiX21hdCkgewogICAgICBmb3IoaSA9IDA7IGkgPCBoOyBpKyspIHsKICAgICAgICBybCA9IFtdOwogICAgICAgIGZvcihqID0gMDsgaiA8IHc7IGorKykgewogICAgICAgICAgcmxbal0gPSBhW2ldICogYlswXVtqXTsKICAgICAgICB9CiAgICAgICAgcltpXSA9IHJsOwogICAgICB9CiAgICB9IGVsc2UgewogICAgICBmb3IoaSA9IDA7IGkgPCBoOyBpKyspIHsKICAgICAgICByW2ldID0gYVtpXSAqIGJbMF07CiAgICAgIH0KICAgIH0KICAgIHJldHVybiByOwogIH0KICBmdW5jdGlvbiBhcnJheV9kaXYoYSwgYikgewogICAgcmV0dXJuIGFycmF5X211bChhLCBiLmludmVyc2UoKSk7CiAgfQogIGZ1bmN0aW9uIGFycmF5X2VsZW1lbnRfd2lzZV9pbnZlcnNlKGEpIHsKICAgIHZhciByLCBpLCBuOwogICAgbiA9IGEubGVuZ3RoOwogICAgciA9IFtdOwogICAgZm9yKGkgPSAwOyBpIDwgbjsgaSsrKSByW2ldID0gYVtpXS5pbnZlcnNlKCk7CiAgICByZXR1cm4gcjsKICB9CiAgZnVuY3Rpb24gYXJyYXlfZXEoYSwgYikgewogICAgdmFyIG4sIGk7CiAgICBuID0gYS5sZW5ndGg7CiAgICBpZihuICE9IGIubGVuZ3RoKSByZXR1cm4gZmFsc2U7CiAgICBmb3IoaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgaWYoYVtpXSAhPSBiW2ldKSByZXR1cm4gZmFsc2U7CiAgICB9CiAgICByZXR1cm4gdHJ1ZTsKICB9CgogIG9wZXJhdG9yc19zZXQoCiAgICBBcnJheS5wcm90b3R5cGUsCiAgICB7CiAgICAgICcrJzogYXJyYXlfYWRkLAogICAgICAnLSc6IGFycmF5X3N1YiwKICAgICAgJyonOiBhcnJheV9tdWwsCiAgICAgICcvJzogYXJyYXlfZGl2LAogICAgICAnPT0nOiBhcnJheV9lcSwKICAgICAgcG9zKGEpIHsKICAgICAgICByZXR1cm4gYTsKICAgICAgfSwKICAgICAgbmVnKGEpIHsKICAgICAgICB2YXIgaSwgbiwgcjsKICAgICAgICBuID0gYS5sZW5ndGg7CiAgICAgICAgciA9IFtdOwogICAgICAgIGZvcihpID0gMDsgaSA8IG47IGkrKykgcltpXSA9IC1hW2ldOwogICAgICAgIHJldHVybiByOwogICAgICB9CiAgICB9LAogICAgewogICAgICByaWdodDogW051bWJlciwgQmlnSW50LCBGbG9hdCwgRnJhY3Rpb24sIENvbXBsZXgsIE1vZCwgUG9seW5vbWlhbCwgUG9seU1vZCwgUmF0aW9uYWxGdW5jdGlvbiwgU2VyaWVzXSwKICAgICAgJyonOiBhcnJheV9zY2FsYXJfbXVsLAogICAgICAnLycoYSwgYikgewogICAgICAgIHJldHVybiBhICogYi5pbnZlcnNlKCk7CiAgICAgIH0sCiAgICAgICcqKic6IGdlbmVyaWNfcG93IC8qIFhYWDogb25seSBmb3IgaW50ZWdlciAqLwogICAgfSwKICAgIHsKICAgICAgbGVmdDogW051bWJlciwgQmlnSW50LCBGbG9hdCwgRnJhY3Rpb24sIENvbXBsZXgsIE1vZCwgUG9seW5vbWlhbCwgUG9seU1vZCwgUmF0aW9uYWxGdW5jdGlvbiwgU2VyaWVzXSwKICAgICAgJyonKGEsIGIpIHsKICAgICAgICByZXR1cm4gYXJyYXlfc2NhbGFyX211bChiLCBhKTsKICAgICAgfSwKICAgICAgJy8nKGEsIGIpIHsKICAgICAgICByZXR1cm4gYSAqIGFycmF5X2VsZW1lbnRfd2lzZV9pbnZlcnNlKGIpOwogICAgICB9CiAgICB9CiAgKTsKCiAgYWRkX3Byb3BzKEFycmF5LnByb3RvdHlwZSwgewogICAgY29uaigpIHsKICAgICAgdmFyIGksIG4sIHI7CiAgICAgIG4gPSB0aGlzLmxlbmd0aDsKICAgICAgciA9IFtdOwogICAgICBmb3IoaSA9IDA7IGkgPCBuOyBpKyspIHJbaV0gPSB0aGlzW2ldLmNvbmooKTsKICAgICAgcmV0dXJuIHI7CiAgICB9LAogICAgZHVwKCkgewogICAgICB2YXIgciwKICAgICAgICBpLAogICAgICAgIG4sCiAgICAgICAgZWwsCiAgICAgICAgYSA9IHRoaXM7CiAgICAgIHIgPSBbXTsKICAgICAgbiA9IGEubGVuZ3RoOwogICAgICBmb3IoaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgICBlbCA9IGFbaV07CiAgICAgICAgaWYoQXJyYXkuaXNBcnJheShlbCkpIGVsID0gZWwuZHVwKCk7CiAgICAgICAgcltpXSA9IGVsOwogICAgICB9CiAgICAgIHJldHVybiByOwogICAgfSwKICAgIGludmVyc2UoKSB7CiAgICAgIHJldHVybiBNYXRyaXguaW52ZXJzZSh0aGlzKTsKICAgIH0sCiAgICBub3JtMjogUG9seW5vbWlhbC5wcm90b3R5cGUubm9ybTIKICB9KTsKfSkodGhpcyk7CgovKiBnbG9iYWwgZGVmaW5pdGlvbnMgKi8KdmFyIEkgPSBDb21wbGV4KDAsIDEpOwp2YXIgWCA9IFBvbHlub21pYWwoWzAsIDFdKTsKdmFyIE8gPSBTZXJpZXMuTzsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnUEknLCB7CiAgZ2V0OiBmdW5jdGlvbigpIHsKICAgIHJldHVybiBGbG9hdC5QSTsKICB9Cn0pOwoKLyogcHV0IGZyZXF1ZW50bHkgdXNlZCBmdW5jdGlvbnMgaW4gdGhlIGdsb2JhbCBjb250ZXh0ICovCnZhciBnY2QgPSBJbnRlZ2VyLmdjZDsKdmFyIGZhY3QgPSBJbnRlZ2VyLmZhY3Q7CnZhciBjb21iID0gSW50ZWdlci5jb21iOwp2YXIgcG1vZCA9IEludGVnZXIucG1vZDsKdmFyIGludm1vZCA9IEludGVnZXIuaW52bW9kOwp2YXIgZmFjdG9yID0gSW50ZWdlci5mYWN0b3I7CnZhciBpc3ByaW1lID0gSW50ZWdlci5pc1ByaW1lOwp2YXIgbmV4dHByaW1lID0gSW50ZWdlci5uZXh0UHJpbWU7CgpmdW5jdGlvbiBkZXJpdihhKSB7CiAgcmV0dXJuIGEuZGVyaXYoKTsKfQoKZnVuY3Rpb24gaW50ZWcoYSkgewogIHJldHVybiBhLmludGVnKCk7Cn0KCmZ1bmN0aW9uIG5vcm0yKGEpIHsKICByZXR1cm4gYS5ub3JtMigpOwp9CgpmdW5jdGlvbiBhYnMoYSkgewogIHJldHVybiBhLmFicygpOwp9CgpmdW5jdGlvbiBjb25qKGEpIHsKICByZXR1cm4gYS5jb25qKCk7Cn0KCmZ1bmN0aW9uIGFyZyhhKSB7CiAgcmV0dXJuIGEuYXJnKCk7Cn0KCmZ1bmN0aW9uIGludmVyc2UoYSkgewogIHJldHVybiBhLmludmVyc2UoKTsKfQoKZnVuY3Rpb24gdHJ1bmMoYSkgewogIGlmKEludGVnZXIuaXNJbnRlZ2VyKGEpKSB7CiAgICByZXR1cm4gYTsKICB9IGVsc2UgaWYoYSBpbnN0YW5jZW9mIEZyYWN0aW9uKSB7CiAgICByZXR1cm4gSW50ZWdlci50ZGl2KGEubnVtLCBhLmRlbik7CiAgfSBlbHNlIGlmKGEgaW5zdGFuY2VvZiBQb2x5bm9taWFsKSB7CiAgICByZXR1cm4gYTsKICB9IGVsc2UgaWYoYSBpbnN0YW5jZW9mIFJhdGlvbmFsRnVuY3Rpb24pIHsKICAgIHJldHVybiBQb2x5bm9taWFsLmRpdnJlbShhLm51bSwgYS5kZW4pWzBdOwogIH0gZWxzZSB7CiAgICByZXR1cm4gRmxvYXQuY2VpbChhKTsKICB9Cn0KCmZ1bmN0aW9uIGZsb29yKGEpIHsKICBpZihJbnRlZ2VyLmlzSW50ZWdlcihhKSkgewogICAgcmV0dXJuIGE7CiAgfSBlbHNlIGlmKGEgaW5zdGFuY2VvZiBGcmFjdGlvbikgewogICAgcmV0dXJuIEludGVnZXIuZmRpdihhLm51bSwgYS5kZW4pOwogIH0gZWxzZSB7CiAgICByZXR1cm4gRmxvYXQuZmxvb3IoYSk7CiAgfQp9CgpmdW5jdGlvbiBjZWlsKGEpIHsKICBpZihJbnRlZ2VyLmlzSW50ZWdlcihhKSkgewogICAgcmV0dXJuIGE7CiAgfSBlbHNlIGlmKGEgaW5zdGFuY2VvZiBGcmFjdGlvbikgewogICAgcmV0dXJuIEludGVnZXIuY2RpdihhLm51bSwgYS5kZW4pOwogIH0gZWxzZSB7CiAgICByZXR1cm4gRmxvYXQuY2VpbChhKTsKICB9Cn0KCmZ1bmN0aW9uIHNxcnQoYSkgewogIHZhciB0LCB1LCByZSwgaW07CiAgaWYoYSBpbnN0YW5jZW9mIFNlcmllcykgewogICAgcmV0dXJuIGEgXiAoMSAvIDIpOwogIH0gZWxzZSBpZihhIGluc3RhbmNlb2YgQ29tcGxleCkgewogICAgdCA9IGFicyhhKTsKICAgIHUgPSBhLnJlOwogICAgcmUgPSBzcXJ0KCh0ICsgdSkgLyAyKTsKICAgIGltID0gc3FydCgodCAtIHUpIC8gMik7CiAgICBpZihhLmltIDwgMCkgaW0gPSAtaW07CiAgICByZXR1cm4gQ29tcGxleC50b0NvbXBsZXgocmUsIGltKTsKICB9IGVsc2UgewogICAgYSA9IEZsb2F0KGEpOwogICAgaWYoYSA8IDApIHsKICAgICAgcmV0dXJuIENvbXBsZXgoMCwgRmxvYXQuc3FydCgtYSkpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIEZsb2F0LnNxcnQoYSk7CiAgICB9CiAgfQp9CgpmdW5jdGlvbiBleHAoYSkgewogIHJldHVybiBhLmV4cCgpOwp9CgpmdW5jdGlvbiBsb2coYSkgewogIHJldHVybiBhLmxvZygpOwp9CgpmdW5jdGlvbiBsb2cyKGEpIHsKICByZXR1cm4gbG9nKGEpICogRmxvYXQuTE9HMkU7Cn0KCmZ1bmN0aW9uIGxvZzEwKGEpIHsKICByZXR1cm4gbG9nKGEpICogRmxvYXQuTE9HMTBFOwp9CgpmdW5jdGlvbiB0b2RiKGEpIHsKICByZXR1cm4gbG9nMTAoYSkgKiAxMDsKfQoKZnVuY3Rpb24gZnJvbWRiKGEpIHsKICByZXR1cm4gMTAgXiAoYSAvIDEwKTsKfQoKZnVuY3Rpb24gc2luKGEpIHsKICB2YXIgdDsKICBpZihhIGluc3RhbmNlb2YgQ29tcGxleCB8fCBhIGluc3RhbmNlb2YgU2VyaWVzKSB7CiAgICB0ID0gZXhwKGEgKiBJKTsKICAgIHJldHVybiAodCAtIDEgLyB0KSAvICgyICogSSk7CiAgfSBlbHNlIHsKICAgIHJldHVybiBGbG9hdC5zaW4oRmxvYXQoYSkpOwogIH0KfQoKZnVuY3Rpb24gY29zKGEpIHsKICB2YXIgdDsKICBpZihhIGluc3RhbmNlb2YgQ29tcGxleCB8fCBhIGluc3RhbmNlb2YgU2VyaWVzKSB7CiAgICB0ID0gZXhwKGEgKiBJKTsKICAgIHJldHVybiAodCArIDEgLyB0KSAvIDI7CiAgfSBlbHNlIHsKICAgIHJldHVybiBGbG9hdC5jb3MoRmxvYXQoYSkpOwogIH0KfQoKZnVuY3Rpb24gdGFuKGEpIHsKICBpZihhIGluc3RhbmNlb2YgQ29tcGxleCB8fCBhIGluc3RhbmNlb2YgU2VyaWVzKSB7CiAgICByZXR1cm4gc2luKGEpIC8gY29zKGEpOwogIH0gZWxzZSB7CiAgICByZXR1cm4gRmxvYXQudGFuKEZsb2F0KGEpKTsKICB9Cn0KCmZ1bmN0aW9uIGFzaW4oYSkgewogIHJldHVybiBGbG9hdC5hc2luKEZsb2F0KGEpKTsKfQoKZnVuY3Rpb24gYWNvcyhhKSB7CiAgcmV0dXJuIEZsb2F0LmFjb3MoRmxvYXQoYSkpOwp9CgpmdW5jdGlvbiBhdGFuKGEpIHsKICByZXR1cm4gRmxvYXQuYXRhbihGbG9hdChhKSk7Cn0KCmZ1bmN0aW9uIGF0YW4yKGEsIGIpIHsKICByZXR1cm4gRmxvYXQuYXRhbjIoRmxvYXQoYSksIEZsb2F0KGIpKTsKfQoKZnVuY3Rpb24gc2luYyhhKSB7CiAgaWYoYSA9PSAwKSB7CiAgICByZXR1cm4gMTsKICB9IGVsc2UgewogICAgYSAqPSBGbG9hdC5QSTsKICAgIHJldHVybiBzaW4oYSkgLyBhOwogIH0KfQoKZnVuY3Rpb24gdG9kZWcoYSkgewogIHJldHVybiAoYSAqIDE4MCkgLyBGbG9hdC5QSTsKfQoKZnVuY3Rpb24gZnJvbWRlZyhhKSB7CiAgcmV0dXJuIChhICogRmxvYXQuUEkpIC8gMTgwOwp9CgpmdW5jdGlvbiBzaW5oKGEpIHsKICB2YXIgZSA9IEZsb2F0LmV4cChGbG9hdChhKSk7CiAgcmV0dXJuIChlIC0gMSAvIGUpICogMC41Owp9CgpmdW5jdGlvbiBjb3NoKGEpIHsKICB2YXIgZSA9IEZsb2F0LmV4cChGbG9hdChhKSk7CiAgcmV0dXJuIChlICsgMSAvIGUpICogMC41Owp9CgpmdW5jdGlvbiB0YW5oKGEpIHsKICB2YXIgZSA9IEZsb2F0LmV4cChGbG9hdChhKSAqIDIpOwogIHJldHVybiAoZSAtIDEpIC8gKGUgKyAxKTsKfQoKZnVuY3Rpb24gYXNpbmgoYSkgewogIHZhciB4ID0gRmxvYXQoYSk7CiAgcmV0dXJuIGxvZyhzcXJ0KHggKiB4ICsgMSkgKyB4KTsKfQoKZnVuY3Rpb24gYWNvc2goYSkgewogIHZhciB4ID0gRmxvYXQoYSk7CiAgcmV0dXJuIGxvZyhzcXJ0KHggKiB4IC0gMSkgKyB4KTsKfQoKZnVuY3Rpb24gYXRhbmgoYSkgewogIHZhciB4ID0gRmxvYXQoYSk7CiAgcmV0dXJuIDAuNSAqIGxvZygoMSArIHgpIC8gKDEgLSB4KSk7Cn0KCmZ1bmN0aW9uIHNpZ21vaWQoeCkgewogIHggPSBGbG9hdCh4KTsKICByZXR1cm4gMSAvICgxICsgZXhwKC14KSk7Cn0KCmZ1bmN0aW9uIGxlcnAoYSwgYiwgdCkgewogIHJldHVybiBhICsgKGIgLSBhKSAqIHQ7Cn0KCnZhciBpZG4gPSBNYXRyaXguaWRuOwp2YXIgZGlhZyA9IE1hdHJpeC5kaWFnOwp2YXIgdHJhbnMgPSBNYXRyaXgudHJhbnM7CnZhciB0cmFjZSA9IE1hdHJpeC50cmFjZTsKdmFyIGNoYXJwb2x5ID0gTWF0cml4LmNoYXJwb2x5Owp2YXIgZWlnZW52YWxzID0gTWF0cml4LmVpZ2VudmFsczsKdmFyIGRldCA9IE1hdHJpeC5kZXQ7CnZhciByYW5rID0gTWF0cml4LnJhbms7CnZhciBrZXIgPSBNYXRyaXgua2VyOwp2YXIgY3AgPSBNYXRyaXguY3A7CnZhciBkcCA9IE1hdHJpeC5kcDsKCnZhciBwb2xyb290cyA9IFBvbHlub21pYWwucm9vdHM7CnZhciBiZXN0YXBwciA9IEZsb2F0LmJlc3RhcHByOwoAAAAAAAAAAKXkAAAAAAAAAAAAAAAAAAAAAAAAoeQAAAAAAAAAAAAA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAAD6pgAAAAAAAPqmAAAAAAAAAAAAAAAA8L8"
				]
			]
		},
		{
			"file": "quickjs/quickjs.c",
			"redo_stack":
			[
				[
					46,
					1,
					"insert",
					{
						"characters": "\t"
					},
					"AQAAAKsIAQAAAAAAqwgBAAAAAAACAAAAICA",
					"AgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPC/AAAAAAEAAACtCAEAAAAAAK0IAQAAAAAAAAAAAAAA8L8"
				]
			],
			"settings":
			{
				"buffer_size": 1770607,
				"line_ending": "Unix"
			}
		},
		{
			"file": "quickjs/quickjs-libc.c",
			"settings":
			{
				"buffer_size": 97640,
				"encoding": "UTF-8",
				"line_ending": "Unix"
			}
		}
	],
	"build_system": "",
	"build_system_choices":
	[
	],
	"build_varint": "",
	"command_palette":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
			[
				"outline",
				"Browse Mode: Outline (Right)"
			],
			[
				"prettier",
				"JsPrettier: Format Code"
			],
			[
				"pre",
				"Project: Edit Project"
			],
			[
				"prett",
				"JsPrettier: Format Code"
			],
			[
				"",
				"Auto indent"
			],
			[
				"out",
				"Browse Mode: Outline (Right)"
			],
			[
				"list pack",
				"Package Control: List Packages"
			],
			[
				"install",
				"Package Control: Install Package"
			],
			[
				"edit ",
				"Color Scheme Editor: Edit current color scheme"
			],
			[
				"edit",
				"Color Scheme Editor: Edit current color scheme"
			],
			[
				"remove",
				"Package Control: Remove Package"
			],
			[
				"outli",
				"Browse Mode: Outline (Right)"
			],
			[
				"debugger",
				"Preferences: Debugger Settings"
			],
			[
				"add re",
				"Package Control: Add Repository"
			],
			[
				"scheme",
				"Color Scheme Editor: Edit current color scheme"
			],
			[
				"outlin",
				"Browse Mode: Outline (Right)"
			],
			[
				"INSTALL",
				"Package Control: Install Package"
			],
			[
				"disable",
				"Package Control: Disable Package"
			],
			[
				"Package Control: disable",
				"Package Control: Disable Package"
			],
			[
				"Package Control: ",
				"Package Control: Disable Package"
			],
			[
				"adap",
				"Debugger: Install Adapters"
			],
			[
				"install ada",
				"Debugger: Install Adapters"
			],
			[
				"adapter",
				"Debugger: Install Adapters"
			],
			[
				"debug",
				"Debugger: Install Adapters"
			],
			[
				"Package Control: remove",
				"Package Control: Remove Package"
			],
			[
				"debu",
				"Debugger: Install Adapters"
			],
			[
				"instal",
				"Package Control: Install Package"
			]
		],
		"width": 0.0
	},
	"console":
	{
		"height": 289.0,
		"history":
		[
		]
	},
	"distraction_free":
	{
		"menu_visible": true,
		"show_minimap": false,
		"show_open_files": false,
		"show_tabs": false,
		"side_bar_visible": false,
		"status_bar_visible": false
	},
	"expanded_folders":
	[
		"/home/roman/Projects/plot-cv",
		"/home/roman/Projects/plot-cv/lib",
		"/home/roman/Projects/plot-cv/lib/grammars",
		"/home/roman/Projects/plot-cv/react-sortable-hoc"
	],
	"file_history":
	[
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/src/lexer.c",
		"/home/roman/Projects/plot-cv/fire.js",
		"/home/roman/Projects/plot-cv/getModuleProps.js",
		"/home/roman/Projects/plot-cv/test-operators.js",
		"/home/roman/Projects/plot-cv/data/test-websocket.functions.js",
		"/home/roman/Projects/plot-cv/plot-cv.sublime-project",
		"/home/roman/Projects/plot-cv/test-nanovg.js",
		"/home/roman/Projects/plot-cv/lib/alea.js",
		"/home/roman/Projects/plot-cv/upload.js",
		"/home/roman/Projects/plot-cv/io-helpers.js",
		"/usr/include/sqlite3.h",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/src/utils.c",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/src/js-utils.c",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/quickjs-internal.h",
		"/home/roman/Projects/plot-cv/quickjs/quickjs.c",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/src/qjsm.c",
		"/home/roman/Projects/plot-cv/test-sqlite3.js",
		"/home/roman/Projects/plot-cv/sqlite3.js",
		"/home/roman/Projects/plot-cv/ast-shell.js",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/lib/util.js",
		"/home/roman/Projects/plot-cv/clang-ast.js",
		"/home/roman/Projects/mariadb-10.3-10.3.38/scripts/mysql_system_tables.sql",
		"/home/roman/Projects/plot-cv/test-bjson.js",
		"/home/roman/Projects/plot-cv/upload-server.js",
		"/home/roman/Projects/mariadb-10.3-10.3.38/scripts/fill_help_tables.sql",
		"/home/roman/Projects/plot-cv/quickjs/run-test262.c",
		"/home/roman/Projects/plot-cv/quickjs/quickjs.h",
		"/home/roman/Projects/plot-cv/quickjs/qjs-net/build-libwebsockets.sh",
		"/home/roman/Projects/plot-cv/quickjs/qjs-net/build/build.ninja",
		"/home/roman/Projects/plot-cv/lib/misc.js",
		"/home/roman/Projects/plot-cv/lib/util.js",
		"/home/roman/Projects/plot-cv/lib/fd-graph.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/textElement.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/symbol.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/pin.js",
		"/home/roman/Projects/plot-cv/555-PWM-Motor-Speed-Controller-alt-schematic.svg",
		"/home/roman/Projects/plot-cv/555-PWM-Motor-Speed-Controller-alt-board.svg",
		"/home/roman/Projects/an-tronics/eagle/555-PWM-Motor-Speed-Controller-alt.brd",
		"/home/roman/Projects/an-tronics/eagle/555-PWM-Motor-Speed-Controller-alt.sch",
		"/home/roman/Projects/plot-cv/lib/geom/matrix.js",
		"/home/roman/Projects/plot-cv/draw.js",
		"/home/roman/Projects/plot-cv/lib/eagle/renderUtils.js",
		"/home/roman/Projects/plot-cv/lib/geom/transformation.js",
		"/home/roman/Projects/plot-cv/lib/dsp/util.js",
		"/home/roman/Projects/plot-cv/Zeichnung.svg",
		"/home/roman/Projects/plot-cv/lib/eagle/svg/ZoomRedraw.svg",
		"/home/roman/Projects/plot-cv/eagle-shell.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/text.js",
		"/home/roman/Projects/plot-cv/lib/eagle/schematicRenderer.js",
		"/home/roman/Projects/plot-cv/lib/eagle/svgRenderer.js",
		"/home/roman/Projects/plot-cv/lib/geom/size.js",
		"/home/roman/Projects/plot-cv/lib/eagle/document.js",
		"/home/roman/Projects/plot-cv/lib/geom/point.js",
		"/home/roman/Projects/plot-cv/lib/geom/line.js",
		"/home/roman/Projects/plot-cv/qjs-opencv/line.js",
		"/home/roman/Projects/plot-cv/lib/geom/rect.js",
		"/home/roman/Projects/plot-cv/lib/eagle/boardRenderer.js",
		"/home/roman/Projects/plot-cv/eagle2svg.js",
		"/home/roman/Projects/plot-cv/lib/eagle/project.js",
		"/home/roman/Projects/plot-cv/lib/eagle/nodeList.js",
		"/home/roman/Projects/plot-cv/lib/eagle/element.js",
		"/home/roman/Projects/plot-cv/lib/eagle/common.js",
		"/home/roman/Projects/plot-cv/lib/dom/preactComponent.js",
		"/home/roman/Projects/plot-cv/lib/eagle/node.js",
		"/home/roman/Projects/plot-cv/lib/eagle/ref.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/grid.js",
		"/home/roman/Projects/plot-cv/lib/eagle/elementProxy.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/smd.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/wirePath.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/wire.js",
		"/home/roman/Projects/plot-cv/lib/eagle/nodeMap.js",
		"/home/roman/Projects/plot-cv/lib/eagle/renderer.js",
		"/home/roman/Projects/plot-cv/resolve-imports.js",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/resolve-imports.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/circle.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/pad.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/via.js",
		"/home/roman/Projects/plot-cv/lib/eagle/libraryRenderer.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components.js",
		"/home/roman/Projects/plot-cv/quickjs/cmake/functions.cmake",
		"/home/roman/Projects/plot-cv/qjs-opencv/cmake/functions.cmake",
		"/home/roman/Projects/plot-cv/cmake/functions.cmake",
		"/home/roman/Projects/plot-cv/lib/container/spatial-hash.js",
		"/home/roman/Projects/plot-cv/lib/container/Hash-Multimap.js",
		"/home/roman/Projects/plot-cv/lib/container/componentMap.js",
		"/home/roman/Projects/plot-cv/lib/container/multikeymap.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/drawing.js",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/quickjs-misc.c",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/util-w-2.diff",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/new.diff",
		"/home/roman/Projects/plot-cv/lib/eda/colorCoding.js",
		"/home/roman/Projects/plot-cv/eagle-commands.js",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/xml-shell.js",
		"/home/roman/Projects/plot-cv/lib/color/rgba.js",
		"/home/roman/Projects/plot-cv/lib/delegate.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/package.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/element.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/origin.js",
		"/home/roman/Projects/plot-cv/lib/eagle/components/board.js",
		"/home/roman/Projects/plot-cv/lib/json/pathMapper.js",
		"/home/roman/Projects/plot-cv/eagle-query.js",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/lib/xpath.js",
		"/home/roman/Dokumente/Electronics/example.circuit",
		"/home/roman/Projects/plot-cv/circuit.js",
		"/home/roman/Projects/pictest/eagle/OpenProg-18F2550.brd",
		"/home/roman/Projects/plot-cv/OpenProg-18F2550.circuit",
		"/home/roman/Projects/plot-cv/read.hex",
		"/home/roman/Projects/plot-cv/test-bitset.js",
		"/home/roman/Projects/plot-cv/example.circuit",
		"/home/roman/Projects/plot-cv/test-circuit.js",
		"/home/roman/Projects/plot-cv/OProg-18F2550.hex",
		"/home/roman/Projects/plot-cv/lib/async/events.js",
		"/home/roman/Projects/plot-cv/lib/async/websocket.js",
		"/home/roman/Projects/plot-cv/lib/repeater/repeater.js",
		"/home/roman/Projects/plot-cv/eagle2gerber.js",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/tests/test_treewalker.js",
		"/home/roman/Projects/plot-cv/lib/geom/bbox.js",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/lib/fs.js",
		"/home/roman/Projects/plot-cv/svg-crop-pad.js",
		"/home/roman/Projects/plot-cv/quickjs/qjs-net/src/plugins/mirror.c",
		"/home/roman/Projects/plot-cv/fire.html",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/list-exports.js",
		"/home/roman/Projects/plot-cv/lib/stream/utils.js",
		"/home/roman/Projects/plot-cv/string-helpers.js",
		"/home/roman/Projects/plot-cv/bjson.js",
		"/home/roman/Projects/plot-cv/openlayers/examples/wms-tiled-wrap-180.html",
		"/home/roman/Projects/plot-cv/quickjs/qjs-modules/quickjs-pointer.c",
		"/home/roman/Projects/plot-cv/test-debuggerprotocol.js"
	],
	"find":
	{
		"height": 38.0
	},
	"find_in_files":
	{
		"height": 142.0,
		"where_history":
		[
			"/home/roman/Projects/plot-cv,*.c,*.h,*.js,-*/build/*,-*/inst/*",
			"/home/roman/Projects/plot-cv/lib/eagle,*.js,-*/build/*,-*/inst/*",
			"<open files>,/home/roman/Projects/plot-cv,*.js,-*/build/*,-*/inst/*",
			"/home/roman/Projects/plot-cv,*.js,-*/build/*,-*/inst/*",
			"/home/roman/Projects/plot-cv,*.js,-*/build/*",
			"/home/roman/Projects/plot-cv,*.js",
			""
		]
	},
	"find_state":
	{
		"case_sensitive": true,
		"find_history":
		[
			"DEBUG_OUTPUT",
			"nextfn",
			"^lexer_lex",
			"rule_add",
			"%\\.\\*s",
			"lexer_rule_match",
			"regexp",
			"lex.js",
			"FAIL:",
			"^js_is_arraybuffer",
			"JS_IsInstanceOf",
			"InstanceOf",
			"^js_is_arraybuffer",
			"js_is_arraybuffer",
			"^js_lexer_constructor",
			"_constructor",
			"new .*Lexer",
			"#!/",
			"MovementIterator",
			"'onFd'",
			"},/*\n",
			"canvas",
			"width",
			"ResizeHandler",
			"h;",
			"h\\(",
			"canvasRect",
			"canvasRec",
			"Reparent",
			"SVG",
			"Element",
			"'svg'",
			"onMessage",
			"connect",
			"globalThis",
			"StartREPL",
			"StartRPL",
			"createWS",
			"StartREPL",
			"repl.start",
			"StartREPL",
			"$",
			"StartREPL",
			"REPL",
			"^(\\s*)console\\.log",
			"onHttp",
			"9000",
			"js_poll_inter",
			"js_poll_intter",
			"js_poll_",
			"__js_poll",
			"interrupt_handler",
			"interrupt_ha",
			"interrupt_handler",
			"JSOSTimer",
			"timer",
			"Timer",
			"cid",
			"uuid",
			"MakeUUID",
			"MakeClientId",
			"randStr",
			"MakeUUID",
			"$",
			"MakeUUID",
			"uuid ",
			"setTimer",
			"ws.send",
			"MakeUUID",
			"ws",
			"ws.ws",
			"MakeUUID",
			"EventPositions",
			"mouseTransform",
			"PositionProcessor",
			"rect",
			"rect.inside",
			"rect =",
			"\\.client",
			"MovementIterator",
			"MouseIter",
			"console.log",
			"Token",
			"console.log",
			"Token",
			"showToken",
			"showToken\n",
			"showToken",
			"Lexer",
			"Kexer",
			"exportedNames",
			"\\.(read)",
			"\\.(read|get)",
			"\\.(read|gets)",
			"ArrayBuffer",
			"FileMap",
			"written to",
			"\\.(write|puts)",
			"$",
			"\\.(write|puts)",
			"FdWriter",
			"os\\.write",
			"\\.write",
			"puts\\(",
			"stream =",
			"written to",
			"isArray",
			"PutsF",
			"PutsFunction",
			"PutsFunc",
			"PutsFuc",
			"PutsFunction",
			"write:",
			"written to",
			"viewBox",
			"'svg'",
			"mouse pos",
			"randStr",
			"MouseIterator",
			"mousePos",
			"mouseEven",
			"mouseEvent",
			"MouseIterator",
			"MouseIter",
			"Mouse",
			"send\\(",
			"NewWS",
			"WebSock"
		],
		"highlight": true,
		"in_selection": false,
		"preserve_case": false,
		"regex": true,
		"replace_history":
		[
			"\\1//console.log",
			"8998",
			"cid",
			"MovementIter",
			"3.0.2",
			"$srcdir/",
			"",
			"'EagleSVGRenderer",
			"this.debug",
			"\\1//console.",
			"isFunction(\\1)",
			"",
			"\\1",
			"is",
			"define",
			"!isString(\\1)",
			"!isFunction(\\1)",
			"isObject(\\1)",
			"isFunction(\\1)",
			"diff --git a/lib/util.js b/lib/util.js\nindex ab76720..001e53e 100644\n--- a/lib/util.js\n+++ b/lib/util.js\n@@",
			"function \\1(\\2) {",
			"function \\1(\\2)",
			"!isString(\\1)",
			"types.isBigInt(\\1)",
			"!isObject(\\1)",
			"isSymbol(\\1)",
			"isString(\\1)",
			"isObject(\\1)",
			"isNumber(\\1)",
			"!isFunction(\\1)",
			"!isString(\\1)",
			"isNumber(\\1)",
			"isString(\\1)",
			"isObject(\\1)",
			"isFunction(\\1)",
			"",
			"^\\1//this.debug",
			"'./components",
			"}\\n\\n\\1",
			"this.circuit",
			"",
			"\\1//console",
			"packageToPosMap",
			"(this.parse",
			"line",
			"maxDepthOrPred",
			"define",
			"isObject",
			"\\1//\\2",
			""
		],
		"reverse": false,
		"scrollbar_highlights": true,
		"show_context": true,
		"use_buffer2": true,
		"use_gitignore": true,
		"whole_word": false,
		"wrap": true
	},
	"groups":
	[
		{
			"sheets":
			[
				{
					"buffer": 0,
					"selected": true,
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 94,
						"regions":
						{
						},
						"selection":
						[
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"current_file": "/home/roman/Projects/plot-cv/lib/grammars/c11-scanner.l",
							"function_name_status_row": 10,
							"outline_rename_mode": false,
							"symkeys":
							[
								[
									74,
									76
								],
								[
									3789,
									3794
								],
								[
									3982,
									3992
								]
							],
							"symlist":
							[
								"—Ⓕ– IS ( ) { … } — function",
								"—Ⓕ– count ( ) { … } — function",
								"—Ⓕ– check_type ( ) { … } — function"
							],
							"syntax": "Packages/Outline/outline.hidden-tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680110344.58,
							"tabs_extra_last_activated_sheet_index": 0,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 0,
					"stack_multiselect": false,
					"type": "text"
				}
			]
		},
		{
			"sheets":
			[
				{
					"buffer": 1,
					"file": "upload-server.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 34102,
						"regions":
						{
						},
						"selection":
						[
							[
								30589,
								30589
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 890,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680107940.32,
							"tabs_extra_last_activated_sheet_index": 0,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 14297.0,
						"zoom_level": 1.0
					},
					"stack_index": 16,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 2,
					"file": "fire.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 14472,
						"regions":
						{
						},
						"selection":
						[
							[
								13322,
								13322
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 477,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680107939.85,
							"tabs_extra_last_activated_sheet_index": 1,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 7221.0,
						"zoom_level": 1.0
					},
					"stack_index": 15,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 3,
					"file": "lib/dom.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 6598,
						"regions":
						{
						},
						"selection":
						[
							[
								518,
								518
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 11,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680107942.78,
							"tabs_extra_last_activated_sheet_index": 3,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 17,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 4,
					"file": "lib/dom/element.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 36040,
						"regions":
						{
						},
						"selection":
						[
							[
								1440,
								1462
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 53,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680107943.01,
							"tabs_extra_last_activated_sheet_index": 4,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 476.0,
						"zoom_level": 1.0
					},
					"stack_index": 18,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 5,
					"file": "debugger-server.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 15241,
						"regions":
						{
						},
						"selection":
						[
							[
								7344,
								7344
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 217,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680078816.46,
							"tabs_extra_last_activated_sheet_index": 2,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 3600.0,
						"zoom_level": 1.0
					},
					"stack_index": 21,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 6,
					"file": "debugger-client.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 14360,
						"regions":
						{
						},
						"selection":
						[
							[
								8125,
								8132
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 158,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680075553.97,
							"tabs_extra_last_activated_sheet_index": 3,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 2240.0,
						"zoom_level": 1.0
					},
					"stack_index": 20,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 7,
					"file": "draw.html",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 500,
						"regions":
						{
						},
						"selection":
						[
							[
								0,
								0
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 0,
							"syntax": "Packages/HTML/HTML.sublime-syntax",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680107950.64,
							"tabs_extra_last_activated_sheet_index": 7,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 13,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 8,
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 7109,
						"regions":
						{
							"match":
							{
								"flags": 112,
								"regions":
								[
									[
										160,
										180
									],
									[
										477,
										494
									],
									[
										659,
										676
									],
									[
										998,
										1015
									],
									[
										1383,
										1400
									],
									[
										1573,
										1590
									],
									[
										1781,
										1798
									],
									[
										2075,
										2092
									],
									[
										2180,
										2197
									],
									[
										2440,
										2457
									],
									[
										2723,
										2740
									],
									[
										2945,
										2962
									],
									[
										3181,
										3198
									],
									[
										3377,
										3394
									],
									[
										3762,
										3779
									],
									[
										3926,
										3943
									],
									[
										4133,
										4150
									],
									[
										4275,
										4292
									],
									[
										4479,
										4496
									],
									[
										4596,
										4613
									],
									[
										4808,
										4825
									],
									[
										5024,
										5041
									],
									[
										5198,
										5215
									],
									[
										5436,
										5453
									],
									[
										5668,
										5685
									],
									[
										5962,
										5979
									],
									[
										6289,
										6306
									],
									[
										6482,
										6499
									],
									[
										6774,
										6791
									],
									[
										6967,
										6984
									]
								],
								"scope": ""
							}
						},
						"selection":
						[
							[
								6785,
								6785
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"detect_indentation": false,
							"function_name_status_row": 201,
							"line_numbers": false,
							"output_tag": 4,
							"result_base_dir": "",
							"result_file_regex": "^([^ \t].*):$",
							"result_line_regex": "^ +([0-9]+):",
							"scroll_past_end": true,
							"syntax": "Packages/Default/Find Results.hidden-tmLanguage",
							"tabs_extra_last_activated": 1680108551.46,
							"tabs_extra_last_activated_sheet_index": 8,
							"translate_tabs_to_spaces": false
						},
						"translation.x": 0.0,
						"translation.y": 3332.0,
						"zoom_level": 1.0
					},
					"stack_index": 9,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 9,
					"file": "quickjs/qjs-net/lib/jsutils.c",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 25008,
						"regions":
						{
						},
						"selection":
						[
							[
								21149,
								21149
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 842,
							"syntax": "Packages/C Improved/C Improved.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680108550.52,
							"tabs_extra_last_activated_sheet_index": 9,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 13785.0,
						"zoom_level": 1.0
					},
					"stack_index": 8,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 10,
					"file": "quickjs/qjs-modules/src/utils.c",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 93368,
						"regions":
						{
						},
						"selection":
						[
							[
								77978,
								77978
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 0,
							"syntax": "Packages/C Improved/C Improved.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680113190.89,
							"tabs_extra_last_activated_sheet_index": 9,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 47736.0,
						"zoom_level": 1.0
					},
					"stack_index": 4,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 11,
					"file": "quickjs/qjs-modules/tests/test_lexer.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 14983,
						"regions":
						{
						},
						"selection":
						[
							[
								8262,
								8262
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 262,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680108548.6,
							"tabs_extra_last_activated_sheet_index": 11,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 3927.0,
						"zoom_level": 1.0
					},
					"stack_index": 7,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 12,
					"file": "quickjs/quickjs.h",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 42139,
						"regions":
						{
						},
						"selection":
						[
							[
								28415,
								28430
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 788,
							"syntax": "Packages/C++11/C++11.tmLanguage",
							"tab_size": 4,
							"tabs_extra_last_activated": 1680108236.18,
							"tabs_extra_last_activated_sheet_index": 10,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 12971.0,
						"zoom_level": 1.0
					},
					"stack_index": 11,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 13,
					"file": "draw.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 13788,
						"regions":
						{
						},
						"selection":
						[
							[
								8329,
								8329
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 307,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680107943.44,
							"tabs_extra_last_activated_sheet_index": 8,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 4722.0,
						"zoom_level": 1.0
					},
					"stack_index": 19,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 14,
					"file": "quickjs/qjs-modules/resolve-imports.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 46874,
						"regions":
						{
						},
						"selection":
						[
							[
								8561,
								8561
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 313,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680107937.18,
							"tabs_extra_last_activated_sheet_index": 9,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 4981.0,
						"zoom_level": 1.0
					},
					"stack_index": 14,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 15,
					"file": "quickjs/qjs-modules/quickjs-lexer.c",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 43795,
						"regions":
						{
						},
						"selection":
						[
							[
								35352,
								35433
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 1355,
							"syntax": "Packages/C Improved/C Improved.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680211845.39,
							"tabs_extra_last_activated_sheet_index": 14,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 22508.0,
						"zoom_level": 1.0
					},
					"stack_index": 3,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 16,
					"file": "quickjs/qjs-modules/src/lexer.c",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 12658,
						"regions":
						{
						},
						"selection":
						[
							[
								8248,
								8248
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 365,
							"syntax": "Packages/C Improved/C Improved.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680212314.2,
							"tabs_extra_last_activated_sheet_index": 15,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 5780.0,
						"zoom_level": 1.0
					},
					"stack_index": 2,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 17,
					"file": "CMakeLists.txt",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 14135,
						"regions":
						{
						},
						"selection":
						[
							[
								8577,
								8624
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 261,
							"syntax": "Packages/User/Themes/CMake.sublime-syntax",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680217086.26,
							"tabs_extra_last_activated_sheet_index": 16,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 3689.0,
						"zoom_level": 1.0
					},
					"stack_index": 1,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 18,
					"file": "lib/grammars/c11-scanner.l",
					"selected": true,
					"semi_transient": true,
					"settings":
					{
						"buffer_size": 4198,
						"regions":
						{
						},
						"selection":
						[
							[
								3481,
								2655
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 85,
							"syntax": "Packages/C++/C.sublime-syntax",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680217287.35,
							"tabs_extra_last_activated_sheet_index": 17,
							"translate_tabs_to_spaces": false
						},
						"translation.x": 0.0,
						"translation.y": 1173.0,
						"zoom_level": 1.0
					},
					"stack_index": 0,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 19,
					"file": "lib/ecmascript.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 1743,
						"regions":
						{
						},
						"selection":
						[
							[
								1743,
								1743
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 80,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680110192.52,
							"tabs_extra_last_activated_sheet_index": 17,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 935.0,
						"zoom_level": 1.0
					},
					"stack_index": 6,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 20,
					"file": "quickjs/qjs-modules/include/lexer.h",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 3431,
						"regions":
						{
						},
						"selection":
						[
							[
								304,
								313
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 18,
							"syntax": "Packages/C++11/C++11.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680113191.73,
							"tabs_extra_last_activated_sheet_index": 17,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 0.0,
						"zoom_level": 1.0
					},
					"stack_index": 5,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 21,
					"file": "quickjs/qjs-modules/src/buffer-utils.c",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 18391,
						"regions":
						{
						},
						"selection":
						[
							[
								12464,
								12481
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 485,
							"syntax": "Packages/C Improved/C Improved.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680108103.97,
							"tabs_extra_last_activated_sheet_index": 12,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 8073.0,
						"zoom_level": 1.0
					},
					"stack_index": 12,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 22,
					"file": "quickjs/qjs-modules/list-exports.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 16213,
						"regions":
						{
						},
						"selection":
						[
							[
								16213,
								16213
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 567,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680015515.78,
							"tabs_extra_last_activated_sheet_index": 5,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 10336.0,
						"zoom_level": 1.0
					},
					"stack_index": 24,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 23,
					"file": "lib/misc.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 47966,
						"regions":
						{
						},
						"selection":
						[
							[
								25366,
								25366
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 839,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680075240.18,
							"tabs_extra_last_activated_sheet_index": 8,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 15499.0,
						"zoom_level": 1.0
					},
					"stack_index": 23,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 24,
					"file": "quickjs/qjscalc.js",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 58529,
						"regions":
						{
						},
						"selection":
						[
							[
								0,
								0
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 1766,
							"syntax": "Packages/JavaScriptNext - ES6 Syntax/JavaScriptNext.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680011534.04,
							"tabs_extra_last_activated_sheet_index": 1,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 29665.0,
						"zoom_level": 1.0
					},
					"stack_index": 25,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 25,
					"file": "quickjs/quickjs.c",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 1770607,
						"regions":
						{
						},
						"selection":
						[
							[
								223016,
								223039
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 7038,
							"syntax": "Packages/C++/C.sublime-syntax",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680108263.72,
							"tabs_extra_last_activated_sheet_index": 18,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 118524.0,
						"zoom_level": 1.0
					},
					"stack_index": 10,
					"stack_multiselect": false,
					"type": "text"
				},
				{
					"buffer": 26,
					"file": "quickjs/quickjs-libc.c",
					"semi_transient": false,
					"settings":
					{
						"buffer_size": 97640,
						"regions":
						{
						},
						"selection":
						[
							[
								19260,
								19265
							]
						],
						"settings":
						{
							"auto_complete_triggers":
							[
								{
									"characters": "./",
									"selector": "text.html, text.xml"
								},
								{
									"rhs_empty": true,
									"selector": "punctuation.accessor"
								}
							],
							"function_name_status_row": 741,
							"syntax": "Packages/C Improved/C Improved.tmLanguage",
							"tab_size": 2,
							"tabs_extra_last_activated": 1680075239.69,
							"tabs_extra_last_activated_sheet_index": 11,
							"translate_tabs_to_spaces": true
						},
						"translation.x": 0.0,
						"translation.y": 13813.0,
						"zoom_level": 1.0
					},
					"stack_index": 22,
					"stack_multiselect": false,
					"type": "text"
				}
			]
		}
	],
	"incremental_find":
	{
		"height": 26.0
	},
	"input":
	{
		"height": 42.0
	},
	"layout":
	{
		"cells":
		[
			[
				2,
				0,
				3,
				2
			],
			[
				0,
				0,
				2,
				2
			]
		],
		"cols":
		[
			0.0,
			0.2,
			0.8,
			1.0
		],
		"rows":
		[
			0.0,
			0.5,
			1.0
		]
	},
	"menu_visible": true,
	"output.Debugger":
	{
		"height": 0.0
	},
	"output.Debugger Console":
	{
		"height": 0.0
	},
	"output.exec":
	{
		"height": 303.0
	},
	"output.find_results":
	{
		"height": 0.0
	},
	"pinned_build_system": "Run with qjsm",
	"project": "plot-cv.sublime-project",
	"replace":
	{
		"height": 68.0
	},
	"save_all_on_build": false,
	"select_file":
	{
		"height": 0.0,
		"last_filter": "",
		"selected_items":
		[
			[
				"cmakelists",
				"CMakeLists.txt"
			],
			[
				"lexer.c",
				"quickjs/qjs-modules/src/lexer.c"
			],
			[
				"-lexer.c",
				"quickjs/qjs-modules/quickjs-lexer.c"
			],
			[
				"utils.c",
				"quickjs/qjs-modules/src/utils.c"
			],
			[
				"ecma",
				"lib/ecmascript.js"
			],
			[
				"lexer.c ",
				"quickjs/qjs-modules/src/lexer.c"
			],
			[
				"lexer.h",
				"quickjs/qjs-modules/include/lexer.h"
			],
			[
				"quickjs-lex",
				"quickjs/qjs-modules/quickjs-lexer.c"
			],
			[
				"test_lexer",
				"quickjs/qjs-modules/tests/test_lexer.js"
			],
			[
				"buffer-u",
				"quickjs/qjs-modules/src/buffer-utils.c"
			],
			[
				"resolve-im",
				"quickjs/qjs-modules/resolve-imports.js"
			],
			[
				"upload-server",
				"upload-server.js"
			],
			[
				"dom.js",
				"lib/dom.js"
			],
			[
				"fire.js",
				"fire.js"
			],
			[
				"debugger-cli",
				"debugger-client.js"
			],
			[
				"debugger-ser",
				"debugger-server.js"
			],
			[
				"upload-ser",
				"upload-server.js"
			],
			[
				"debugger-server",
				"debugger-server.js"
			],
			[
				"quickjs-libc",
				"quickjs/quickjs-libc.c"
			],
			[
				"quickjs.c",
				"quickjs/quickjs.c"
			],
			[
				"quickjs-lib",
				"quickjs/quickjs-libc.c"
			],
			[
				"misc.js",
				"lib/misc.js"
			],
			[
				"list-ex",
				"quickjs/qjs-modules/list-exports.js"
			],
			[
				"draw.js",
				"draw.js"
			],
			[
				"draw.html",
				"draw.html"
			],
			[
				"getMod",
				"getModuleProps.js"
			],
			[
				"test-op",
				"test-operators.js"
			],
			[
				"nanovg",
				"test-nanovg.js"
			],
			[
				"alea",
				"lib/alea.js"
			],
			[
				"upload.js",
				"upload.js"
			],
			[
				"io-help",
				"io-helpers.js"
			],
			[
				"fire",
				"fire.js"
			],
			[
				"util.js",
				"quickjs/qjs-modules/lib/util.js"
			],
			[
				"clang-as",
				"clang-ast.js"
			],
			[
				"jsut",
				"quickjs/qjs-modules/src/js-utils.c"
			],
			[
				"qjsm.c",
				"quickjs/qjs-modules/src/qjsm.c"
			],
			[
				"ast-shell",
				"ast-shell.js"
			],
			[
				"quickjs-in",
				"quickjs/qjs-modules/quickjs-internal.h"
			],
			[
				"run-test",
				"quickjs/run-test262.c"
			],
			[
				"quickjs.h",
				"quickjs/quickjs.h"
			],
			[
				"build-libwe",
				"quickjs/qjs-net/build-libwebsockets.sh"
			],
			[
				"ast-she",
				"ast-shell.js"
			],
			[
				"eagle-she",
				"eagle-shell.js"
			],
			[
				"matrix.js",
				"lib/geom/matrix.js"
			],
			[
				"transform",
				"lib/geom/transformation.js"
			],
			[
				"pin.js",
				"lib/eagle/components/pin.js"
			],
			[
				"",
				"~/Projects/an-tronics/eagle/555-PWM-Motor-Speed-Controller-alt.sch"
			],
			[
				"preactCom",
				"lib/dom/preactComponent.js"
			],
			[
				"symb",
				"lib/eagle/components/symbol.js"
			],
			[
				"schematicren",
				"lib/eagle/schematicRenderer.js"
			],
			[
				"svgre",
				"lib/eagle/svgRenderer.js"
			],
			[
				"boardren",
				"lib/eagle/boardRenderer.js"
			],
			[
				"element",
				"lib/eagle/element.js"
			],
			[
				"svgRend",
				"lib/eagle/svgRenderer.js"
			],
			[
				"boardRen",
				"lib/eagle/boardRenderer.js"
			],
			[
				"rect.js",
				"lib/geom/rect.js"
			],
			[
				"line.js",
				"lib/geom/line.js"
			],
			[
				"point.js",
				"lib/geom/point.js"
			],
			[
				"document",
				"lib/eagle/document.js"
			],
			[
				"boardRe",
				"lib/eagle/boardRenderer.js"
			],
			[
				"renderUtil",
				"lib/eagle/renderUtils.js"
			],
			[
				"eagle2sv",
				"eagle2svg.js"
			],
			[
				"project.js",
				"lib/eagle/project.js"
			],
			[
				"text.js",
				"lib/eagle/components/text.js"
			],
			[
				"project",
				"lib/eagle/project.js"
			],
			[
				"nodeList",
				"lib/eagle/nodeList.js"
			],
			[
				"lib/util.js",
				"lib/util.js"
			],
			[
				"elemen",
				"lib/eagle/element.js"
			],
			[
				"svgRe",
				"lib/eagle/svgRenderer.js"
			],
			[
				"common",
				"lib/eagle/common.js"
			],
			[
				"ref.js",
				"lib/eagle/ref.js"
			],
			[
				"node.js",
				"lib/eagle/node.js"
			],
			[
				"element.js",
				"lib/eagle/element.js"
			],
			[
				"common.j",
				"lib/eagle/common.js"
			],
			[
				"nodeLi",
				"lib/eagle/nodeList.js"
			],
			[
				"common.js",
				"lib/eagle/common.js"
			],
			[
				"elementP",
				"lib/eagle/elementProxy.js"
			],
			[
				"smd.js",
				"lib/eagle/components/smd.js"
			],
			[
				"wirePa",
				"lib/eagle/components/wirePath.js"
			],
			[
				"wire.js",
				"lib/eagle/components/wire.js"
			],
			[
				"nodeMap",
				"lib/eagle/nodeMap.js"
			],
			[
				"renderer.js",
				"lib/eagle/renderer.js"
			],
			[
				"functions.cmake",
				"qjs-opencv/cmake/functions.cmake"
			],
			[
				"textEle",
				"lib/eagle/components/textElement.js"
			],
			[
				"quickjs-misc",
				"quickjs/qjs-modules/quickjs-misc.c"
			],
			[
				"drawing",
				"lib/eagle/components/drawing.js"
			],
			[
				"pathMapper",
				"lib/json/pathMapper.js"
			],
			[
				"xml-shell",
				"quickjs/qjs-modules/xml-shell.js"
			],
			[
				"server.js",
				"upload-server.js"
			],
			[
				"delega",
				"lib/delegate.js"
			],
			[
				"rgba",
				"lib/color/rgba.js"
			],
			[
				"eagle-com",
				"eagle-commands.js"
			],
			[
				"colorCod",
				"lib/eda/colorCoding.js"
			],
			[
				"eagle-qu",
				"eagle-query.js"
			],
			[
				"eagle-q",
				"eagle-query.js"
			],
			[
				"read.hex",
				"read.hex"
			],
			[
				"exam",
				"example.circuit"
			],
			[
				"xpath.js",
				"quickjs/qjs-modules/lib/xpath.js"
			],
			[
				"Document",
				"lib/eagle/document.js"
			],
			[
				"test-",
				"test-bitset.js"
			],
			[
				"circuit",
				"circuit.js"
			],
			[
				"fs.js",
				"quickjs/qjs-modules/lib/fs.js"
			],
			[
				"eagle2ger",
				"eagle2gerber.js"
			],
			[
				"repeater.js",
				"lib/repeater/repeater.js"
			],
			[
				"websock",
				"lib/async/websocket.js"
			],
			[
				"websocket.js",
				"lib/async/websocket.js"
			],
			[
				"test-bj",
				"test-bjson.js"
			],
			[
				"bjson",
				"bjson.js"
			],
			[
				"string-he",
				"string-helpers.js"
			],
			[
				"quickjs-po",
				"quickjs/qjs-modules/quickjs-pointer.c"
			],
			[
				"list-exp",
				"quickjs/qjs-modules/list-exports.js"
			],
			[
				"clang-ast",
				"clang-ast.js"
			],
			[
				"utils.js",
				"lib/stream/utils.js"
			],
			[
				"mirror",
				"quickjs/qjs-net/src/plugins/mirror.c"
			],
			[
				"fire.html",
				"fire.html"
			],
			[
				"server-htt",
				"quickjs/qjs-net/minnet-server-http.c"
			],
			[
				"-ws.c",
				"quickjs/qjs-net/minnet-server-ws.c"
			],
			[
				"filelist",
				"filelist.js"
			],
			[
				"filelist.js",
				"filelist.js"
			],
			[
				"extendGe",
				"quickjs/qjs-modules/lib/extendGenerator.js"
			],
			[
				"test-debugger",
				"test-debuggerprotocol.js"
			],
			[
				"fire.htm",
				"fire.html"
			],
			[
				"test-opencv",
				"test-opencv.js"
			],
			[
				"fontsample",
				"fontsample.js"
			],
			[
				"upload.htm",
				"upload.html"
			],
			[
				"main.js",
				"main.js"
			],
			[
				"test-gpio",
				"test-gpio.js"
			],
			[
				"index.html",
				"index.html"
			]
		],
		"width": 0.0
	},
	"select_project":
	{
		"height": 500.0,
		"last_filter": "",
		"selected_items":
		[
			[
				"",
				"~/Projects/plot-cv/plot-cv.sublime-project"
			]
		],
		"width": 380.0
	},
	"select_symbol":
	{
		"height": 309.0,
		"last_filter": "",
		"selected_items":
		[
			[
				"",
				"WS"
			]
		],
		"width": 784.0
	},
	"selected_group": 1,
	"settings":
	{
	},
	"show_minimap": true,
	"show_open_files": false,
	"show_tabs": true,
	"side_bar_visible": true,
	"side_bar_width": 248.0,
	"status_bar_visible": true,
	"template_settings":
	{
	}
}
